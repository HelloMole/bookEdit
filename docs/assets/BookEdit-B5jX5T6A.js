var _o=Object.defineProperty;var Vs=L=>{throw TypeError(L)};var mo=(L,S,T)=>S in L?_o(L,S,{enumerable:!0,configurable:!0,writable:!0,value:T}):L[S]=T;var St=(L,S,T)=>mo(L,typeof S!="symbol"?S+"":S,T),Nn=(L,S,T)=>S.has(L)||Vs("Cannot "+T);var Ut=(L,S,T)=>(Nn(L,S,"read from private field"),T?T.call(L):S.get(L)),dr=(L,S,T)=>S.has(L)?Vs("Cannot add the same private member more than once"):S instanceof WeakSet?S.add(L):S.set(L,T),_r=(L,S,T,_)=>(Nn(L,S,"write to private field"),_?_.call(L,T):S.set(L,T),T),Zt=(L,S,T)=>(Nn(L,S,"access private method"),T);var Gs=(L,S,T,_)=>({set _(w){_r(L,S,w,T)},get _(){return Ut(L,S,_)}});import{_ as _extends,P as Pagination,r as ref,o as onMounted,w as watch,c as createElementBlock,a as createVNode,i as isRef,u as unref,b as resolveComponent,d as withCtx,e as openBlock,f as createBaseVNode,g as createTextVNode,t as toDisplayString,h as getDefaultExportFromCjs,j as __vitePreload,k as _export_sfc,l as getAugmentedNamespace,m as commonjsGlobal,n as resolveDirective,p as createBlock,q as createCommentVNode,F as Fragment,s as renderList,v as withDirectives,x as normalizeStyle,U as UseElementSize,y as h$1,T as Tag,C as CloseOutlined,A as ApiFilled,z as api,B as api$1,D as hooks,E as ToolOutlined,G as BuildOutlined,L as LoginOutlined,H as LogoutOutlined,I as ApiOutlined,J as resolveDynamicComponent,K as vShow,M as withModifiers}from"./index-bF7nhJqO.js";function clone(L){if(L==null||typeof L!="object")return L;if(L instanceof Date){var S=new Date;return S.setTime(L.getTime()),S}if(L instanceof Array){for(var S=[],T=L.length,_=0;_<T;++_)S[_]=clone(L[_]);return S}if(L instanceof Object){var S={};for(var w in L)L.hasOwnProperty(w)&&(S[w]=clone(L[w]));return S}}function arrToDit(L,S,T){if(!Array.isArray(L))return L;for(var _={},w=0;w<L.length;w++)_[L[w][S]]=L[w][T];return _}function bind(L,S){return function(){return L.apply(S,arguments)}}const{toString:toString$1}=Object.prototype,{getPrototypeOf}=Object,kindOf=(L=>S=>{const T=toString$1.call(S);return L[T]||(L[T]=T.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=L=>(L=L.toLowerCase(),S=>kindOf(S)===L),typeOfTest=L=>S=>typeof S===L,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(L){return L!==null&&!isUndefined(L)&&L.constructor!==null&&!isUndefined(L.constructor)&&isFunction(L.constructor.isBuffer)&&L.constructor.isBuffer(L)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(L){let S;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?S=ArrayBuffer.isView(L):S=L&&L.buffer&&isArrayBuffer(L.buffer),S}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=L=>L!==null&&typeof L=="object",isBoolean=L=>L===!0||L===!1,isPlainObject=L=>{if(kindOf(L)!=="object")return!1;const S=getPrototypeOf(L);return(S===null||S===Object.prototype||Object.getPrototypeOf(S)===null)&&!(Symbol.toStringTag in L)&&!(Symbol.iterator in L)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=L=>isObject(L)&&isFunction(L.pipe),isFormData=L=>{let S;return L&&(typeof FormData=="function"&&L instanceof FormData||isFunction(L.append)&&((S=kindOf(L))==="formdata"||S==="object"&&isFunction(L.toString)&&L.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=L=>L.trim?L.trim():L.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(L,S,{allOwnKeys:T=!1}={}){if(L===null||typeof L>"u")return;let _,w;if(typeof L!="object"&&(L=[L]),isArray(L))for(_=0,w=L.length;_<w;_++)S.call(null,L[_],_,L);else{const B=T?Object.getOwnPropertyNames(L):Object.keys(L),A=B.length;let O;for(_=0;_<A;_++)O=B[_],S.call(null,L[O],O,L)}}function findKey(L,S){S=S.toLowerCase();const T=Object.keys(L);let _=T.length,w;for(;_-- >0;)if(w=T[_],S===w.toLowerCase())return w;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=L=>!isUndefined(L)&&L!==_global;function merge$1(){const{caseless:L}=isContextDefined(this)&&this||{},S={},T=(_,w)=>{const B=L&&findKey(S,w)||w;isPlainObject(S[B])&&isPlainObject(_)?S[B]=merge$1(S[B],_):isPlainObject(_)?S[B]=merge$1({},_):isArray(_)?S[B]=_.slice():S[B]=_};for(let _=0,w=arguments.length;_<w;_++)arguments[_]&&forEach(arguments[_],T);return S}const extend=(L,S,T,{allOwnKeys:_}={})=>(forEach(S,(w,B)=>{T&&isFunction(w)?L[B]=bind(w,T):L[B]=w},{allOwnKeys:_}),L),stripBOM=L=>(L.charCodeAt(0)===65279&&(L=L.slice(1)),L),inherits=(L,S,T,_)=>{L.prototype=Object.create(S.prototype,_),L.prototype.constructor=L,Object.defineProperty(L,"super",{value:S.prototype}),T&&Object.assign(L.prototype,T)},toFlatObject=(L,S,T,_)=>{let w,B,A;const O={};if(S=S||{},L==null)return S;do{for(w=Object.getOwnPropertyNames(L),B=w.length;B-- >0;)A=w[B],(!_||_(A,L,S))&&!O[A]&&(S[A]=L[A],O[A]=!0);L=T!==!1&&getPrototypeOf(L)}while(L&&(!T||T(L,S))&&L!==Object.prototype);return S},endsWith=(L,S,T)=>{L=String(L),(T===void 0||T>L.length)&&(T=L.length),T-=S.length;const _=L.indexOf(S,T);return _!==-1&&_===T},toArray=L=>{if(!L)return null;if(isArray(L))return L;let S=L.length;if(!isNumber(S))return null;const T=new Array(S);for(;S-- >0;)T[S]=L[S];return T},isTypedArray=(L=>S=>L&&S instanceof L)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(L,S)=>{const _=(L&&L[Symbol.iterator]).call(L);let w;for(;(w=_.next())&&!w.done;){const B=w.value;S.call(L,B[0],B[1])}},matchAll=(L,S)=>{let T;const _=[];for(;(T=L.exec(S))!==null;)_.push(T);return _},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=L=>L.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(T,_,w){return _.toUpperCase()+w}),hasOwnProperty=(({hasOwnProperty:L})=>(S,T)=>L.call(S,T))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(L,S)=>{const T=Object.getOwnPropertyDescriptors(L),_={};forEach(T,(w,B)=>{let A;(A=S(w,B,L))!==!1&&(_[B]=A||w)}),Object.defineProperties(L,_)},freezeMethods=L=>{reduceDescriptors(L,(S,T)=>{if(isFunction(L)&&["arguments","caller","callee"].indexOf(T)!==-1)return!1;const _=L[T];if(isFunction(_)){if(S.enumerable=!1,"writable"in S){S.writable=!1;return}S.set||(S.set=()=>{throw Error("Can not rewrite read-only method '"+T+"'")})}})},toObjectSet=(L,S)=>{const T={},_=w=>{w.forEach(B=>{T[B]=!0})};return isArray(L)?_(L):_(String(L).split(S)),T},noop=()=>{},toFiniteNumber=(L,S)=>L!=null&&Number.isFinite(L=+L)?L:S;function isSpecCompliantForm(L){return!!(L&&isFunction(L.append)&&L[Symbol.toStringTag]==="FormData"&&L[Symbol.iterator])}const toJSONObject=L=>{const S=new Array(10),T=(_,w)=>{if(isObject(_)){if(S.indexOf(_)>=0)return;if(!("toJSON"in _)){S[w]=_;const B=isArray(_)?[]:{};return forEach(_,(A,O)=>{const R=T(A,w+1);!isUndefined(R)&&(B[O]=R)}),S[w]=void 0,B}}return _};return T(L,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=L=>L&&(isObject(L)||isFunction(L))&&isFunction(L.then)&&isFunction(L.catch),_setImmediate=((L,S)=>L?setImmediate:S?((T,_)=>(_global.addEventListener("message",({source:w,data:B})=>{w===_global&&B===T&&_.length&&_.shift()()},!1),w=>{_.push(w),_global.postMessage(T,"*")}))("axios@".concat(Math.random()),[]):T=>setTimeout(T))(typeof setImmediate=="function",isFunction(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$4={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge:merge$1,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError$1(L,S,T,_,w){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=L,this.name="AxiosError",S&&(this.code=S),T&&(this.config=T),_&&(this.request=_),w&&(this.response=w,this.status=w.status?w.status:null)}utils$4.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$4.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(L=>{descriptors[L]={value:L}});Object.defineProperties(AxiosError$1,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(L,S,T,_,w,B)=>{const A=Object.create(prototype$1);return utils$4.toFlatObject(L,A,function(R){return R!==Error.prototype},O=>O!=="isAxiosError"),AxiosError$1.call(A,L.message,S,T,_,w),A.cause=L,A.name=L.name,B&&Object.assign(A,B),A};const httpAdapter=null;function isVisitable(L){return utils$4.isPlainObject(L)||utils$4.isArray(L)}function removeBrackets(L){return utils$4.endsWith(L,"[]")?L.slice(0,-2):L}function renderKey(L,S,T){return L?L.concat(S).map(function(w,B){return w=removeBrackets(w),!T&&B?"["+w+"]":w}).join(T?".":""):S}function isFlatArray(L){return utils$4.isArray(L)&&!L.some(isVisitable)}const predicates=utils$4.toFlatObject(utils$4,{},null,function(S){return/^is[A-Z]/.test(S)});function toFormData$1(L,S,T){if(!utils$4.isObject(L))throw new TypeError("target must be an object");S=S||new FormData,T=utils$4.toFlatObject(T,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,F){return!utils$4.isUndefined(F[k])});const _=T.metaTokens,w=T.visitor||E,B=T.dots,A=T.indexes,R=(T.Blob||typeof Blob<"u"&&Blob)&&utils$4.isSpecCompliantForm(S);if(!utils$4.isFunction(w))throw new TypeError("visitor must be a function");function P(N){if(N===null)return"";if(utils$4.isDate(N))return N.toISOString();if(!R&&utils$4.isBlob(N))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$4.isArrayBuffer(N)||utils$4.isTypedArray(N)?R&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function E(N,k,F){let G=N;if(N&&!F&&typeof N=="object"){if(utils$4.endsWith(k,"{}"))k=_?k:k.slice(0,-2),N=JSON.stringify(N);else if(utils$4.isArray(N)&&isFlatArray(N)||(utils$4.isFileList(N)||utils$4.endsWith(k,"[]"))&&(G=utils$4.toArray(N)))return k=removeBrackets(k),G.forEach(function(j,H){!(utils$4.isUndefined(j)||j===null)&&S.append(A===!0?renderKey([k],H,B):A===null?k:k+"[]",P(j))}),!1}return isVisitable(N)?!0:(S.append(renderKey(F,k,B),P(N)),!1)}const D=[],I=Object.assign(predicates,{defaultVisitor:E,convertValue:P,isVisitable});function M(N,k){if(!utils$4.isUndefined(N)){if(D.indexOf(N)!==-1)throw Error("Circular reference detected in "+k.join("."));D.push(N),utils$4.forEach(N,function(G,V){(!(utils$4.isUndefined(G)||G===null)&&w.call(S,G,utils$4.isString(V)?V.trim():V,k,I))===!0&&M(G,k?k.concat(V):[V])}),D.pop()}}if(!utils$4.isObject(L))throw new TypeError("data must be an object");return M(L),S}function encode$1(L){const S={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(L).replace(/[!'()~]|%20|%00/g,function(_){return S[_]})}function AxiosURLSearchParams(L,S){this._pairs=[],L&&toFormData$1(L,this,S)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(S,T){this._pairs.push([S,T])};prototype.toString=function(S){const T=S?function(_){return S.call(this,_,encode$1)}:encode$1;return this._pairs.map(function(w){return T(w[0])+"="+T(w[1])},"").join("&")};function encode(L){return encodeURIComponent(L).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(L,S,T){if(!S)return L;const _=T&&T.encode||encode;utils$4.isFunction(T)&&(T={serialize:T});const w=T&&T.serialize;let B;if(w?B=w(S,T):B=utils$4.isURLSearchParams(S)?S.toString():new AxiosURLSearchParams(S,T).toString(_),B){const A=L.indexOf("#");A!==-1&&(L=L.slice(0,A)),L+=(L.indexOf("?")===-1?"?":"&")+B}return L}class InterceptorManager{constructor(){this.handlers=[]}use(S,T,_){return this.handlers.push({fulfilled:S,rejected:T,synchronous:_?_.synchronous:!1,runWhen:_?_.runWhen:null}),this.handlers.length-1}eject(S){this.handlers[S]&&(this.handlers[S]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(S){utils$4.forEach(this.handlers,function(_){_!==null&&S(_)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils$3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils$3,...platform$1};function toURLEncodedForm(L,S){return toFormData$1(L,new platform.classes.URLSearchParams,Object.assign({visitor:function(T,_,w,B){return platform.isNode&&utils$4.isBuffer(T)?(this.append(_,T.toString("base64")),!1):B.defaultVisitor.apply(this,arguments)}},S))}function parsePropPath(L){return utils$4.matchAll(/\w+|\[(\w*)]/g,L).map(S=>S[0]==="[]"?"":S[1]||S[0])}function arrayToObject(L){const S={},T=Object.keys(L);let _;const w=T.length;let B;for(_=0;_<w;_++)B=T[_],S[B]=L[B];return S}function formDataToJSON(L){function S(T,_,w,B){let A=T[B++];if(A==="__proto__")return!0;const O=Number.isFinite(+A),R=B>=T.length;return A=!A&&utils$4.isArray(w)?w.length:A,R?(utils$4.hasOwnProp(w,A)?w[A]=[w[A],_]:w[A]=_,!O):((!w[A]||!utils$4.isObject(w[A]))&&(w[A]=[]),S(T,_,w[A],B)&&utils$4.isArray(w[A])&&(w[A]=arrayToObject(w[A])),!O)}if(utils$4.isFormData(L)&&utils$4.isFunction(L.entries)){const T={};return utils$4.forEachEntry(L,(_,w)=>{S(parsePropPath(_),w,T,0)}),T}return null}function stringifySafely(L,S,T){if(utils$4.isString(L))try{return(S||JSON.parse)(L),utils$4.trim(L)}catch(_){if(_.name!=="SyntaxError")throw _}return(T||JSON.stringify)(L)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(S,T){const _=T.getContentType()||"",w=_.indexOf("application/json")>-1,B=utils$4.isObject(S);if(B&&utils$4.isHTMLForm(S)&&(S=new FormData(S)),utils$4.isFormData(S))return w?JSON.stringify(formDataToJSON(S)):S;if(utils$4.isArrayBuffer(S)||utils$4.isBuffer(S)||utils$4.isStream(S)||utils$4.isFile(S)||utils$4.isBlob(S)||utils$4.isReadableStream(S))return S;if(utils$4.isArrayBufferView(S))return S.buffer;if(utils$4.isURLSearchParams(S))return T.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),S.toString();let O;if(B){if(_.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(S,this.formSerializer).toString();if((O=utils$4.isFileList(S))||_.indexOf("multipart/form-data")>-1){const R=this.env&&this.env.FormData;return toFormData$1(O?{"files[]":S}:S,R&&new R,this.formSerializer)}}return B||w?(T.setContentType("application/json",!1),stringifySafely(S)):S}],transformResponse:[function(S){const T=this.transitional||defaults.transitional,_=T&&T.forcedJSONParsing,w=this.responseType==="json";if(utils$4.isResponse(S)||utils$4.isReadableStream(S))return S;if(S&&utils$4.isString(S)&&(_&&!this.responseType||w)){const A=!(T&&T.silentJSONParsing)&&w;try{return JSON.parse(S)}catch(O){if(A)throw O.name==="SyntaxError"?AxiosError$1.from(O,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):O}}return S}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(S){return S>=200&&S<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$4.forEach(["delete","get","head","post","put","patch"],L=>{defaults.headers[L]={}});const ignoreDuplicateOf=utils$4.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=L=>{const S={};let T,_,w;return L&&L.split("\n").forEach(function(A){w=A.indexOf(":"),T=A.substring(0,w).trim().toLowerCase(),_=A.substring(w+1).trim(),!(!T||S[T]&&ignoreDuplicateOf[T])&&(T==="set-cookie"?S[T]?S[T].push(_):S[T]=[_]:S[T]=S[T]?S[T]+", "+_:_)}),S},$internals=Symbol("internals");function normalizeHeader(L){return L&&String(L).trim().toLowerCase()}function normalizeValue(L){return L===!1||L==null?L:utils$4.isArray(L)?L.map(normalizeValue):String(L)}function parseTokens(L){const S=Object.create(null),T=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let _;for(;_=T.exec(L);)S[_[1]]=_[2];return S}const isValidHeaderName=L=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(L.trim());function matchHeaderValue(L,S,T,_,w){if(utils$4.isFunction(_))return _.call(this,S,T);if(w&&(S=T),!!utils$4.isString(S)){if(utils$4.isString(_))return S.indexOf(_)!==-1;if(utils$4.isRegExp(_))return _.test(S)}}function formatHeader(L){return L.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(S,T,_)=>T.toUpperCase()+_)}function buildAccessors(L,S){const T=utils$4.toCamelCase(" "+S);["get","set","has"].forEach(_=>{Object.defineProperty(L,_+T,{value:function(w,B,A){return this[_].call(this,S,w,B,A)},configurable:!0})})}let AxiosHeaders$1=class{constructor(S){S&&this.set(S)}set(S,T,_){const w=this;function B(O,R,P){const E=normalizeHeader(R);if(!E)throw new Error("header name must be a non-empty string");const D=utils$4.findKey(w,E);(!D||w[D]===void 0||P===!0||P===void 0&&w[D]!==!1)&&(w[D||R]=normalizeValue(O))}const A=(O,R)=>utils$4.forEach(O,(P,E)=>B(P,E,R));if(utils$4.isPlainObject(S)||S instanceof this.constructor)A(S,T);else if(utils$4.isString(S)&&(S=S.trim())&&!isValidHeaderName(S))A(parseHeaders(S),T);else if(utils$4.isHeaders(S))for(const[O,R]of S.entries())B(R,O,_);else S!=null&&B(T,S,_);return this}get(S,T){if(S=normalizeHeader(S),S){const _=utils$4.findKey(this,S);if(_){const w=this[_];if(!T)return w;if(T===!0)return parseTokens(w);if(utils$4.isFunction(T))return T.call(this,w,_);if(utils$4.isRegExp(T))return T.exec(w);throw new TypeError("parser must be boolean|regexp|function")}}}has(S,T){if(S=normalizeHeader(S),S){const _=utils$4.findKey(this,S);return!!(_&&this[_]!==void 0&&(!T||matchHeaderValue(this,this[_],_,T)))}return!1}delete(S,T){const _=this;let w=!1;function B(A){if(A=normalizeHeader(A),A){const O=utils$4.findKey(_,A);O&&(!T||matchHeaderValue(_,_[O],O,T))&&(delete _[O],w=!0)}}return utils$4.isArray(S)?S.forEach(B):B(S),w}clear(S){const T=Object.keys(this);let _=T.length,w=!1;for(;_--;){const B=T[_];(!S||matchHeaderValue(this,this[B],B,S,!0))&&(delete this[B],w=!0)}return w}normalize(S){const T=this,_={};return utils$4.forEach(this,(w,B)=>{const A=utils$4.findKey(_,B);if(A){T[A]=normalizeValue(w),delete T[B];return}const O=S?formatHeader(B):String(B).trim();O!==B&&delete T[B],T[O]=normalizeValue(w),_[O]=!0}),this}concat(...S){return this.constructor.concat(this,...S)}toJSON(S){const T=Object.create(null);return utils$4.forEach(this,(_,w)=>{_!=null&&_!==!1&&(T[w]=S&&utils$4.isArray(_)?_.join(", "):_)}),T}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([S,T])=>S+": "+T).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(S){return S instanceof this?S:new this(S)}static concat(S,...T){const _=new this(S);return T.forEach(w=>_.set(w)),_}static accessor(S){const _=(this[$internals]=this[$internals]={accessors:{}}).accessors,w=this.prototype;function B(A){const O=normalizeHeader(A);_[O]||(buildAccessors(w,A),_[O]=!0)}return utils$4.isArray(S)?S.forEach(B):B(S),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$4.reduceDescriptors(AxiosHeaders$1.prototype,({value:L},S)=>{let T=S[0].toUpperCase()+S.slice(1);return{get:()=>L,set(_){this[T]=_}}});utils$4.freezeMethods(AxiosHeaders$1);function transformData(L,S){const T=this||defaults,_=S||T,w=AxiosHeaders$1.from(_.headers);let B=_.data;return utils$4.forEach(L,function(O){B=O.call(T,B,w.normalize(),S?S.status:void 0)}),w.normalize(),B}function isCancel$1(L){return!!(L&&L.__CANCEL__)}function CanceledError$1(L,S,T){AxiosError$1.call(this,L==null?"canceled":L,AxiosError$1.ERR_CANCELED,S,T),this.name="CanceledError"}utils$4.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(L,S,T){const _=T.config.validateStatus;!T.status||!_||_(T.status)?L(T):S(new AxiosError$1("Request failed with status code "+T.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(T.status/100)-4],T.config,T.request,T))}function parseProtocol(L){const S=/^([-+\w]{1,25})(:?\/\/|:)/.exec(L);return S&&S[1]||""}function speedometer(L,S){L=L||10;const T=new Array(L),_=new Array(L);let w=0,B=0,A;return S=S!==void 0?S:1e3,function(R){const P=Date.now(),E=_[B];A||(A=P),T[w]=R,_[w]=P;let D=B,I=0;for(;D!==w;)I+=T[D++],D=D%L;if(w=(w+1)%L,w===B&&(B=(B+1)%L),P-A<S)return;const M=E&&P-E;return M?Math.round(I*1e3/M):void 0}}function throttle(L,S){let T=0,_=1e3/S,w,B;const A=(P,E=Date.now())=>{T=E,w=null,B&&(clearTimeout(B),B=null),L.apply(null,P)};return[(...P)=>{const E=Date.now(),D=E-T;D>=_?A(P,E):(w=P,B||(B=setTimeout(()=>{B=null,A(w)},_-D)))},()=>w&&A(w)]}const progressEventReducer=(L,S,T=3)=>{let _=0;const w=speedometer(50,250);return throttle(B=>{const A=B.loaded,O=B.lengthComputable?B.total:void 0,R=A-_,P=w(R),E=A<=O;_=A;const D={loaded:A,total:O,progress:O?A/O:void 0,bytes:R,rate:P||void 0,estimated:P&&O&&E?(O-A)/P:void 0,event:B,lengthComputable:O!=null,[S?"download":"upload"]:!0};L(D)},T)},progressEventDecorator=(L,S)=>{const T=L!=null;return[_=>S[0]({lengthComputable:T,total:L,loaded:_}),S[1]]},asyncDecorator=L=>(...S)=>utils$4.asap(()=>L(...S)),isURLSameOrigin=platform.hasStandardBrowserEnv?((L,S)=>T=>(T=new URL(T,platform.origin),L.protocol===T.protocol&&L.host===T.host&&(S||L.port===T.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(L,S,T,_,w,B){const A=[L+"="+encodeURIComponent(S)];utils$4.isNumber(T)&&A.push("expires="+new Date(T).toGMTString()),utils$4.isString(_)&&A.push("path="+_),utils$4.isString(w)&&A.push("domain="+w),B===!0&&A.push("secure"),document.cookie=A.join("; ")},read(L){const S=document.cookie.match(new RegExp("(^|;\\s*)("+L+")=([^;]*)"));return S?decodeURIComponent(S[3]):null},remove(L){this.write(L,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(L){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(L)}function combineURLs(L,S){return S?L.replace(/\/?\/$/,"")+"/"+S.replace(/^\/+/,""):L}function buildFullPath(L,S,T){let _=!isAbsoluteURL(S);return L&&_||T==!1?combineURLs(L,S):S}const headersToObject=L=>L instanceof AxiosHeaders$1?{...L}:L;function mergeConfig$1(L,S){S=S||{};const T={};function _(P,E,D,I){return utils$4.isPlainObject(P)&&utils$4.isPlainObject(E)?utils$4.merge.call({caseless:I},P,E):utils$4.isPlainObject(E)?utils$4.merge({},E):utils$4.isArray(E)?E.slice():E}function w(P,E,D,I){if(utils$4.isUndefined(E)){if(!utils$4.isUndefined(P))return _(void 0,P,D,I)}else return _(P,E,D,I)}function B(P,E){if(!utils$4.isUndefined(E))return _(void 0,E)}function A(P,E){if(utils$4.isUndefined(E)){if(!utils$4.isUndefined(P))return _(void 0,P)}else return _(void 0,E)}function O(P,E,D){if(D in S)return _(P,E);if(D in L)return _(void 0,P)}const R={url:B,method:B,data:B,baseURL:A,transformRequest:A,transformResponse:A,paramsSerializer:A,timeout:A,timeoutMessage:A,withCredentials:A,withXSRFToken:A,adapter:A,responseType:A,xsrfCookieName:A,xsrfHeaderName:A,onUploadProgress:A,onDownloadProgress:A,decompress:A,maxContentLength:A,maxBodyLength:A,beforeRedirect:A,transport:A,httpAgent:A,httpsAgent:A,cancelToken:A,socketPath:A,responseEncoding:A,validateStatus:O,headers:(P,E,D)=>w(headersToObject(P),headersToObject(E),D,!0)};return utils$4.forEach(Object.keys(Object.assign({},L,S)),function(E){const D=R[E]||w,I=D(L[E],S[E],E);utils$4.isUndefined(I)&&D!==O||(T[E]=I)}),T}const resolveConfig=L=>{const S=mergeConfig$1({},L);let{data:T,withXSRFToken:_,xsrfHeaderName:w,xsrfCookieName:B,headers:A,auth:O}=S;S.headers=A=AxiosHeaders$1.from(A),S.url=buildURL(buildFullPath(S.baseURL,S.url),L.params,L.paramsSerializer),O&&A.set("Authorization","Basic "+btoa((O.username||"")+":"+(O.password?unescape(encodeURIComponent(O.password)):"")));let R;if(utils$4.isFormData(T)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)A.setContentType(void 0);else if((R=A.getContentType())!==!1){const[P,...E]=R?R.split(";").map(D=>D.trim()).filter(Boolean):[];A.setContentType([P||"multipart/form-data",...E].join("; "))}}if(platform.hasStandardBrowserEnv&&(_&&utils$4.isFunction(_)&&(_=_(S)),_||_!==!1&&isURLSameOrigin(S.url))){const P=w&&B&&cookies.read(B);P&&A.set(w,P)}return S},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(L){return new Promise(function(T,_){const w=resolveConfig(L);let B=w.data;const A=AxiosHeaders$1.from(w.headers).normalize();let{responseType:O,onUploadProgress:R,onDownloadProgress:P}=w,E,D,I,M,N;function k(){M&&M(),N&&N(),w.cancelToken&&w.cancelToken.unsubscribe(E),w.signal&&w.signal.removeEventListener("abort",E)}let F=new XMLHttpRequest;F.open(w.method.toUpperCase(),w.url,!0),F.timeout=w.timeout;function G(){if(!F)return;const j=AxiosHeaders$1.from("getAllResponseHeaders"in F&&F.getAllResponseHeaders()),U={data:!O||O==="text"||O==="json"?F.responseText:F.response,status:F.status,statusText:F.statusText,headers:j,config:L,request:F};settle(function(Y){T(Y),k()},function(Y){_(Y),k()},U),F=null}"onloadend"in F?F.onloadend=G:F.onreadystatechange=function(){!F||F.readyState!==4||F.status===0&&!(F.responseURL&&F.responseURL.indexOf("file:")===0)||setTimeout(G)},F.onabort=function(){F&&(_(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,L,F)),F=null)},F.onerror=function(){_(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,L,F)),F=null},F.ontimeout=function(){let H=w.timeout?"timeout of "+w.timeout+"ms exceeded":"timeout exceeded";const U=w.transitional||transitionalDefaults;w.timeoutErrorMessage&&(H=w.timeoutErrorMessage),_(new AxiosError$1(H,U.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,L,F)),F=null},B===void 0&&A.setContentType(null),"setRequestHeader"in F&&utils$4.forEach(A.toJSON(),function(H,U){F.setRequestHeader(U,H)}),utils$4.isUndefined(w.withCredentials)||(F.withCredentials=!!w.withCredentials),O&&O!=="json"&&(F.responseType=w.responseType),P&&([I,N]=progressEventReducer(P,!0),F.addEventListener("progress",I)),R&&F.upload&&([D,M]=progressEventReducer(R),F.upload.addEventListener("progress",D),F.upload.addEventListener("loadend",M)),(w.cancelToken||w.signal)&&(E=j=>{F&&(_(!j||j.type?new CanceledError$1(null,L,F):j),F.abort(),F=null)},w.cancelToken&&w.cancelToken.subscribe(E),w.signal&&(w.signal.aborted?E():w.signal.addEventListener("abort",E)));const V=parseProtocol(w.url);if(V&&platform.protocols.indexOf(V)===-1){_(new AxiosError$1("Unsupported protocol "+V+":",AxiosError$1.ERR_BAD_REQUEST,L));return}F.send(B||null)})},composeSignals=(L,S)=>{const{length:T}=L=L?L.filter(Boolean):[];if(S||T){let _=new AbortController,w;const B=function(P){if(!w){w=!0,O();const E=P instanceof Error?P:this.reason;_.abort(E instanceof AxiosError$1?E:new CanceledError$1(E instanceof Error?E.message:E))}};let A=S&&setTimeout(()=>{A=null,B(new AxiosError$1("timeout ".concat(S," of ms exceeded"),AxiosError$1.ETIMEDOUT))},S);const O=()=>{L&&(A&&clearTimeout(A),A=null,L.forEach(P=>{P.unsubscribe?P.unsubscribe(B):P.removeEventListener("abort",B)}),L=null)};L.forEach(P=>P.addEventListener("abort",B));const{signal:R}=_;return R.unsubscribe=()=>utils$4.asap(O),R}},streamChunk=function*(L,S){let T=L.byteLength;if(T<S){yield L;return}let _=0,w;for(;_<T;)w=_+S,yield L.slice(_,w),_=w},readBytes=async function*(L,S){for await(const T of readStream(L))yield*streamChunk(T,S)},readStream=async function*(L){if(L[Symbol.asyncIterator]){yield*L;return}const S=L.getReader();try{for(;;){const{done:T,value:_}=await S.read();if(T)break;yield _}}finally{await S.cancel()}},trackStream=(L,S,T,_)=>{const w=readBytes(L,S);let B=0,A,O=R=>{A||(A=!0,_&&_(R))};return new ReadableStream({async pull(R){try{const{done:P,value:E}=await w.next();if(P){O(),R.close();return}let D=E.byteLength;if(T){let I=B+=D;T(I)}R.enqueue(new Uint8Array(E))}catch(P){throw O(P),P}},cancel(R){return O(R),w.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(L=>S=>L.encode(S))(new TextEncoder):async L=>new Uint8Array(await new Response(L).arrayBuffer())),test=(L,...S)=>{try{return!!L(...S)}catch(T){return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let L=!1;const S=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return L=!0,"half"}}).headers.has("Content-Type");return L&&!S}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$4.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(L=>L.body)};isFetchSupported&&(L=>{["text","arrayBuffer","blob","formData","stream"].forEach(S=>{!resolvers[S]&&(resolvers[S]=utils$4.isFunction(L[S])?T=>T[S]():(T,_)=>{throw new AxiosError$1("Response type '".concat(S,"' is not supported"),AxiosError$1.ERR_NOT_SUPPORT,_)})})})(new Response);const getBodyLength=async L=>{if(L==null)return 0;if(utils$4.isBlob(L))return L.size;if(utils$4.isSpecCompliantForm(L))return(await new Request(platform.origin,{method:"POST",body:L}).arrayBuffer()).byteLength;if(utils$4.isArrayBufferView(L)||utils$4.isArrayBuffer(L))return L.byteLength;if(utils$4.isURLSearchParams(L)&&(L=L+""),utils$4.isString(L))return(await encodeText(L)).byteLength},resolveBodyLength=async(L,S)=>{const T=utils$4.toFiniteNumber(L.getContentLength());return T==null?getBodyLength(S):T},fetchAdapter=isFetchSupported&&(async L=>{let{url:S,method:T,data:_,signal:w,cancelToken:B,timeout:A,onDownloadProgress:O,onUploadProgress:R,responseType:P,headers:E,withCredentials:D="same-origin",fetchOptions:I}=resolveConfig(L);P=P?(P+"").toLowerCase():"text";let M=composeSignals([w,B&&B.toAbortSignal()],A),N;const k=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let F;try{if(R&&supportsRequestStream&&T!=="get"&&T!=="head"&&(F=await resolveBodyLength(E,_))!==0){let U=new Request(S,{method:"POST",body:_,duplex:"half"}),X;if(utils$4.isFormData(_)&&(X=U.headers.get("content-type"))&&E.setContentType(X),U.body){const[Y,z]=progressEventDecorator(F,progressEventReducer(asyncDecorator(R)));_=trackStream(U.body,DEFAULT_CHUNK_SIZE,Y,z)}}utils$4.isString(D)||(D=D?"include":"omit");const G="credentials"in Request.prototype;N=new Request(S,{...I,signal:M,method:T.toUpperCase(),headers:E.normalize().toJSON(),body:_,duplex:"half",credentials:G?D:void 0});let V=await fetch(N);const j=supportsResponseStream&&(P==="stream"||P==="response");if(supportsResponseStream&&(O||j&&k)){const U={};["status","statusText","headers"].forEach(W=>{U[W]=V[W]});const X=utils$4.toFiniteNumber(V.headers.get("content-length")),[Y,z]=O&&progressEventDecorator(X,progressEventReducer(asyncDecorator(O),!0))||[];V=new Response(trackStream(V.body,DEFAULT_CHUNK_SIZE,Y,()=>{z&&z(),k&&k()}),U)}P=P||"text";let H=await resolvers[utils$4.findKey(resolvers,P)||"text"](V,L);return!j&&k&&k(),await new Promise((U,X)=>{settle(U,X,{data:H,headers:AxiosHeaders$1.from(V.headers),status:V.status,statusText:V.statusText,config:L,request:N})})}catch(G){throw k&&k(),G&&G.name==="TypeError"&&/fetch/i.test(G.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,L,N),{cause:G.cause||G}):AxiosError$1.from(G,G&&G.code,L,N)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$4.forEach(knownAdapters,(L,S)=>{if(L){try{Object.defineProperty(L,"name",{value:S})}catch(T){}Object.defineProperty(L,"adapterName",{value:S})}});const renderReason=L=>"- ".concat(L),isResolvedHandle=L=>utils$4.isFunction(L)||L===null||L===!1,adapters={getAdapter:L=>{L=utils$4.isArray(L)?L:[L];const{length:S}=L;let T,_;const w={};for(let B=0;B<S;B++){T=L[B];let A;if(_=T,!isResolvedHandle(T)&&(_=knownAdapters[(A=String(T)).toLowerCase()],_===void 0))throw new AxiosError$1("Unknown adapter '".concat(A,"'"));if(_)break;w[A||"#"+B]=_}if(!_){const B=Object.entries(w).map(([O,R])=>"adapter ".concat(O," ")+(R===!1?"is not supported by the environment":"is not available in the build"));let A=S?B.length>1?"since :\n"+B.map(renderReason).join("\n"):" "+renderReason(B[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+A,"ERR_NOT_SUPPORT")}return _},adapters:knownAdapters};function throwIfCancellationRequested(L){if(L.cancelToken&&L.cancelToken.throwIfRequested(),L.signal&&L.signal.aborted)throw new CanceledError$1(null,L)}function dispatchRequest(L){return throwIfCancellationRequested(L),L.headers=AxiosHeaders$1.from(L.headers),L.data=transformData.call(L,L.transformRequest),["post","put","patch"].indexOf(L.method)!==-1&&L.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(L.adapter||defaults.adapter)(L).then(function(_){return throwIfCancellationRequested(L),_.data=transformData.call(L,L.transformResponse,_),_.headers=AxiosHeaders$1.from(_.headers),_},function(_){return isCancel$1(_)||(throwIfCancellationRequested(L),_&&_.response&&(_.response.data=transformData.call(L,L.transformResponse,_.response),_.response.headers=AxiosHeaders$1.from(_.response.headers))),Promise.reject(_)})}const VERSION$1="1.8.1",validators$1={};["object","boolean","number","function","string","symbol"].forEach((L,S)=>{validators$1[L]=function(_){return typeof _===L||"a"+(S<1?"n ":" ")+L}});const deprecatedWarnings={};validators$1.transitional=function(S,T,_){function w(B,A){return"[Axios v"+VERSION$1+"] Transitional option '"+B+"'"+A+(_?". "+_:"")}return(B,A,O)=>{if(S===!1)throw new AxiosError$1(w(A," has been removed"+(T?" in "+T:"")),AxiosError$1.ERR_DEPRECATED);return T&&!deprecatedWarnings[A]&&(deprecatedWarnings[A]=!0,console.warn(w(A," has been deprecated since v"+T+" and will be removed in the near future"))),S?S(B,A,O):!0}};validators$1.spelling=function(S){return(T,_)=>(console.warn("".concat(_," is likely a misspelling of ").concat(S)),!0)};function assertOptions(L,S,T){if(typeof L!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const _=Object.keys(L);let w=_.length;for(;w-- >0;){const B=_[w],A=S[B];if(A){const O=L[B],R=O===void 0||A(O,B,L);if(R!==!0)throw new AxiosError$1("option "+B+" must be "+R,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(T!==!0)throw new AxiosError$1("Unknown option "+B,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(S){this.defaults=S,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(S,T){try{return await this._request(S,T)}catch(_){if(_ instanceof Error){let w={};Error.captureStackTrace?Error.captureStackTrace(w):w=new Error;const B=w.stack?w.stack.replace(/^.+\n/,""):"";try{_.stack?B&&!String(_.stack).endsWith(B.replace(/^.+\n.+\n/,""))&&(_.stack+="\n"+B):_.stack=B}catch(A){}}throw _}}_request(S,T){typeof S=="string"?(T=T||{},T.url=S):T=S||{},T=mergeConfig$1(this.defaults,T);const{transitional:_,paramsSerializer:w,headers:B}=T;_!==void 0&&validator.assertOptions(_,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),w!=null&&(utils$4.isFunction(w)?T.paramsSerializer={serialize:w}:validator.assertOptions(w,{encode:validators.function,serialize:validators.function},!0)),T.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?T.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:T.allowAbsoluteUrls=!0),validator.assertOptions(T,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),T.method=(T.method||this.defaults.method||"get").toLowerCase();let A=B&&utils$4.merge(B.common,B[T.method]);B&&utils$4.forEach(["delete","get","head","post","put","patch","common"],N=>{delete B[N]}),T.headers=AxiosHeaders$1.concat(A,B);const O=[];let R=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(T)===!1||(R=R&&k.synchronous,O.unshift(k.fulfilled,k.rejected))});const P=[];this.interceptors.response.forEach(function(k){P.push(k.fulfilled,k.rejected)});let E,D=0,I;if(!R){const N=[dispatchRequest.bind(this),void 0];for(N.unshift.apply(N,O),N.push.apply(N,P),I=N.length,E=Promise.resolve(T);D<I;)E=E.then(N[D++],N[D++]);return E}I=O.length;let M=T;for(D=0;D<I;){const N=O[D++],k=O[D++];try{M=N(M)}catch(F){k.call(this,F);break}}try{E=dispatchRequest.call(this,M)}catch(N){return Promise.reject(N)}for(D=0,I=P.length;D<I;)E=E.then(P[D++],P[D++]);return E}getUri(S){S=mergeConfig$1(this.defaults,S);const T=buildFullPath(S.baseURL,S.url,S.allowAbsoluteUrls);return buildURL(T,S.params,S.paramsSerializer)}};utils$4.forEach(["delete","get","head","options"],function(S){Axios$1.prototype[S]=function(T,_){return this.request(mergeConfig$1(_||{},{method:S,url:T,data:(_||{}).data}))}});utils$4.forEach(["post","put","patch"],function(S){function T(_){return function(B,A,O){return this.request(mergeConfig$1(O||{},{method:S,headers:_?{"Content-Type":"multipart/form-data"}:{},url:B,data:A}))}}Axios$1.prototype[S]=T(),Axios$1.prototype[S+"Form"]=T(!0)});let CancelToken$1=class Hs{constructor(S){if(typeof S!="function")throw new TypeError("executor must be a function.");let T;this.promise=new Promise(function(B){T=B});const _=this;this.promise.then(w=>{if(!_._listeners)return;let B=_._listeners.length;for(;B-- >0;)_._listeners[B](w);_._listeners=null}),this.promise.then=w=>{let B;const A=new Promise(O=>{_.subscribe(O),B=O}).then(w);return A.cancel=function(){_.unsubscribe(B)},A},S(function(B,A,O){_.reason||(_.reason=new CanceledError$1(B,A,O),T(_.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(S){if(this.reason){S(this.reason);return}this._listeners?this._listeners.push(S):this._listeners=[S]}unsubscribe(S){if(!this._listeners)return;const T=this._listeners.indexOf(S);T!==-1&&this._listeners.splice(T,1)}toAbortSignal(){const S=new AbortController,T=_=>{S.abort(_)};return this.subscribe(T),S.signal.unsubscribe=()=>this.unsubscribe(T),S.signal}static source(){let S;return{token:new Hs(function(w){S=w}),cancel:S}}};function spread$1(L){return function(T){return L.apply(null,T)}}function isAxiosError$1(L){return utils$4.isObject(L)&&L.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([L,S])=>{HttpStatusCode$1[S]=L});function createInstance(L){const S=new Axios$1(L),T=bind(Axios$1.prototype.request,S);return utils$4.extend(T,Axios$1.prototype,S,{allOwnKeys:!0}),utils$4.extend(T,S,null,{allOwnKeys:!0}),T.create=function(w){return createInstance(mergeConfig$1(L,w))},T}const axios=createInstance(defaults);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$1;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(S){return Promise.all(S)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=L=>formDataToJSON(utils$4.isHTMLForm(L)?new FormData(L):L);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,locale$2={locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",yearFormat:"YYYY年",dayFormat:"D日",dateFormat:"YYYY年M月D日",dateTimeFormat:"YYYY年M月D日 HH时mm分ss秒",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪"},locale$1={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]},locale={lang:_extends({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},locale$2),timePickerLocale:_extends({},locale$1)};locale.lang.ok="确定";const typeTemplate="${label}不是一个有效的${type}",localeValues={locale:"zh-cn",Pagination,DatePicker:locale,TimePicker:locale$1,Calendar:locale,global:{placeholder:"请选择"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckall:"全选",filterSearchPlaceholder:"在筛选项中搜索",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开"},PageHeader:{back:"返回"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:typeTemplate,method:typeTemplate,array:typeTemplate,object:typeTemplate,number:typeTemplate,date:typeTemplate,boolean:typeTemplate,integer:typeTemplate,float:typeTemplate,regexp:typeTemplate,email:typeTemplate,url:typeTemplate,hex:typeTemplate},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码已过期",refresh:"点击刷新",scanned:"已扫描"}},_hoisted_1$4=["onMouseenter"],_hoisted_2$3={key:0,style:{display:"flex"}},_hoisted_3$3={style:{color:"#f50"}},_hoisted_4$3={key:1},__default__$1={name:"Tree"},_sfc_main$4=Object.assign(__default__$1,{props:["data"],emits:["mouseenter","node-click"],setup(L,{emit:S}){const T=L,_=S,w=(M,N)=>{_("mouseenter",M)};var B=ref(""),A=ref(!0);const O=(M,N)=>{console.log("onSelectNode",M,N.node.dataRef),_("node-click",N.node.dataRef)};var R=ref([]);onMounted(()=>{console.log("the component is now mounted.",T.data)});const P=(M,N)=>{let k;for(let F=0;F<N.length;F++){const G=N[F];G.children&&(G.children.some(V=>V.key===M)?k=G.key:P(M,G.children)&&(k=P(M,G.children)))}return k},E=M=>{R.value=M,A.value=!1},D=[],I=M=>{for(let N=0;N<M.length;N++){const k=M[N],F=k.key;D.push({key:F,title:k.title}),k.children&&I(k.children)}};return I(T.data),watch(B,M=>{M=M.toUpperCase(),console.log("props.data",T.data,D);const N=D.map(k=>k.title.indexOf(M)>-1?P(k.key,T.data):null).filter((k,F,G)=>k&&G.indexOf(k)===F);R.value=N,B.value=M,A.value=!0}),(M,N)=>{const k=resolveComponent("a-input-search"),F=resolveComponent("a-tree");return openBlock(),createElementBlock("div",null,[createVNode(k,{value:unref(B),"onUpdate:value":N[0]||(N[0]=G=>isRef(B)?B.value=G:B=G),style:{"margin-bottom":"8px"},placeholder:"Search"},null,8,["value"]),createVNode(F,{style:{"max-width":"600px"},"tree-data":T.data,expandedKeys:unref(R),"onUpdate:expandedKeys":N[1]||(N[1]=G=>isRef(R)?R.value=G:R=G),onSelect:O,"auto-expand-parent":unref(A),onExpand:E},{title:withCtx(({title:G,key:V})=>[createBaseVNode("div",{class:"tree-node",onMouseenter:j=>w(G,V)},[G.indexOf(unref(B))>-1?(openBlock(),createElementBlock("div",_hoisted_2$3,[createTextVNode(toDisplayString(G.substring(0,G.indexOf(unref(B))))+" ",1),createBaseVNode("div",_hoisted_3$3,toDisplayString(unref(B)),1),createTextVNode(" "+toDisplayString(G.substring(G.indexOf(unref(B))+unref(B).length)),1)])):(openBlock(),createElementBlock("div",_hoisted_4$3,toDisplayString(G),1))],40,_hoisted_1$4)]),_:1},8,["tree-data","expandedKeys","auto-expand-parent"])])}}}),_hoisted_1$3={class:"desc"},_hoisted_2$2={class:"title"},_hoisted_3$2={class:"example"},_hoisted_4$2={class:"description"},__default__={name:"Desc"},_sfc_main$3=Object.assign(__default__,{props:{title:{type:String,default:""},example:{type:String,default:""},description:{type:String,default:""}},setup(L){const S=L;return(T,_)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("h4",_hoisted_2$2,toDisplayString(S.title),1),createBaseVNode("p",_hoisted_3$2,toDisplayString(S.example),1),createBaseVNode("p",_hoisted_4$2,toDisplayString(S.description),1)]))}});class Observer{constructor(){this.observerListeners={},this.observerToken=0}publish(S,...T){if(!S||!this.observerListeners[S])return!1;let _=this.observerListeners[S];for(let w=0;w<_.length;w++)_[w].context?_[w].fn.apply(_[w].context,T):_[w].fn.apply(_[w].fn,T)}subscribe(S,T){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return this.observerListeners[S]||(this.observerListeners[S]=[]),this.observerToken++,this.observerListeners[S].push({fn:T,context:_,token:this.observerToken}),this.observerToken}unsubscribe(S){if(!S)return!1;for(let T in this.observerListeners)if(this.observerListeners.hasOwnProperty(T))for(let _=0;_<this.observerListeners[T].length;_++)this.observerListeners[T][_].token===S&&this.observerListeners[T].splice(_,1)}clearTopic(S){if(!S)return!1;for(let T in this.observerListeners)this.observerListeners.hasOwnProperty(T)&&T===S&&delete this.observerListeners[T]}clearAll(){this.observerListeners={},this.observerToken=0}}function checkLineSegmentCross(L,S,T,_){let w=!1,B=[S.x-L.x,S.y-L.y],A=[T.x-L.x,T.y-L.y],O=[_.x-L.x,_.y-L.y],R=B[0]*A[1]-B[1]*A[0],P=B[0]*O[1]-B[1]*O[0],E=[T.x-_.x,T.y-_.y],D=[L.x-_.x,L.y-_.y],I=[S.x-_.x,S.y-_.y],M=E[0]*D[1]-E[1]*D[0],N=E[0]*I[1]-E[1]*I[0];return R*P<0&&M*N<0&&(w=!0),w}function getLinePointDistance(L,S,T,_,w,B){if(L===T)return Math.abs(w-L);{let A=1,O,R;return O=(S-_)/(T-L),R=0-A*S-O*L,Math.abs((O*w+A*B+R)/Math.sqrt(O*O+A*A))}}function getAngle(L,S,T,_){let w=Math.atan2(_-S,T-L)*180/Math.PI;return w>0?w-360:w}function getLinePointYByX(L,S,T,_,w){if(L===T)return Math.min(S,_);{let B=1,A,O;return A=(S-_)/(T-L),O=0-B*S-A*L,(P=>(0-O-A*P)/B)(w)}}function getLineAllPoint(L,S,T,_){let w=[];if(L===T){let B=Math.abs(_-S),A=Math.min(S,_);for(let O=0;O<=B;O++)w.push([L,A+O])}else{let B=1,A,O;A=(S-_)/(T-L),O=0-B*S-A*L;const R=D=>(0-O-A*D)/B;let P=Math.abs(T-L),E=Math.min(L,T);for(let D=0;D<=P;D++)w.push([E+D,R(E+D)])}return w}function getTwoPointDistance(L,S,T,_){return Math.sqrt(Math.pow(L-T,2)+Math.pow(S-_,2))}function getNearestPointFromLine(L,S,T,_,w,B){let A=getLineAllPoint(L,S,T,_),O=1/0,R=null;return A.forEach(P=>{let E=getTwoPointDistance(P[0],P[1],w,B);E<O&&(O=E,R=P)}),R}function loadImage(L){return new Promise((S,T)=>{let _=new Image;_.onload=()=>{S(_)},_.onerror=w=>{T(w)},_.src=L})}const utils$2={checkLineSegmentCross,loadImage,getTwoPointDistance,getLinePointYByX,getLineAllPoint,getLinePointDistance,getAngle,getNearestPointFromLine},defaultStrokeStyle={lineWidth:3,strokeColor:"rgba(0, 136, 255, 1)",lineJoin:"round",frontLineWidth:3,frontStrokeColor:"rgba(0, 136, 255, 1)",frontLineJoin:"round"},defaultFillColor="rgba(0, 136, 255, 0.5)",defaultPointStyle={lineWidth:3,strokeColor:"rgba(0, 136, 255, 1)",fillColor:"rgba(0, 136, 255, 0.5)"},defaultOpt$3={showPoint:!0,pointType:"square",pointWidth:3,lineType:"line"};class MarkItem{constructor(S=null,T={}){this.ctx=S,this.updateOpt(T),this.updatePointFn=T.updatePoint,this.pointArr=T.pointArr||[],this.isClosePath=!1,this.isEditing=!1,this.isDragging=!1,this.dragPointIndex=-1,this.dragCachePointArr=[],this.hoverActive=!1,this.areaToPointPos=null}updateOpt(S){this.opt={...defaultOpt$3,...S},this.data=S.data||null,this.strokeStyle=S.strokeStyle?{...defaultStrokeStyle,...S.strokeStyle}:defaultStrokeStyle,this.fillColor=S.fillColor||defaultFillColor,this.pointStyle=S.pointStyle?{...defaultPointStyle,...S.pointStyle}:defaultPointStyle,this.area=S.area||!1,this.enableAddPoint=S.enableAddPoint||!1}enable(){this.isEditing=!0,this.insertFictitiousPoints()}disable(){this.isEditing=!1,this.removeFictitiousPoints()}getTruePointArr(){return this.pointArr.filter(S=>!S.fictitious)}getPointLength(){return this.getTruePointArr().length}pushPoint(S,T){!this.isEditing||this.isClosePath||this.pointArr.push({x:S,y:T})}removePoint(S){this.pointArr[S].fictitious||(this.pointArr.splice(S,1),this.removeFictitiousPoints(),this.insertFictitiousPoints())}areaToPoint(S,T){this.areaToPointPos={x:S,y:T}}render(){(this.isClosePath||this.area)&&this.renderArea(),this.opt.lineType==="custom"?this.opt.customRenderLine&&this.opt.customRenderLine(this):this.opt.lineType==="borderLine"?(this.renderLines(this.strokeStyle),this.renderLines({...this.strokeStyle,lineWidth:this.strokeStyle.frontLineWidth,strokeColor:this.strokeStyle.frontStrokeColor,lineJoin:this.strokeStyle.frontLineJoin})):this.renderLines(this.strokeStyle),this.renderPoints()}renderArea(){this.ctx.save(),this.ctx.fillStyle=this.fillColor,this.ctx.beginPath();let S=this.pointArr.concat(this.area?this.areaToPointPos?[this.areaToPointPos]:[]:[]);for(let T=0;T<S.length;T++){let _=S[T].x,w=S[T].y;T===0?this.ctx.moveTo(_,w):this.ctx.lineTo(_,w)}this.ctx.closePath(),this.ctx.fill(),this.ctx.restore()}renderLines({lineWidth:S,strokeColor:T,lineJoin:_},w){this.ctx.save(),this.ctx.lineWidth=S,this.ctx.strokeStyle=T,this.ctx.lineJoin=_,this.ctx.beginPath();let B=this.pointArr.concat(this.area?this.areaToPointPos?[this.areaToPointPos]:[]:[]);for(let A=0;A<B.length;A++){let O=B[A].x,R=B[A].y;A===0?this.ctx.moveTo(O,R):this.ctx.lineTo(O,R)}(this.isClosePath||this.area)&&this.ctx.closePath(),w||this.ctx.stroke(),this.ctx.restore()}renderPoints(S,T){for(let _=0;_<this.pointArr.length;_++){this.ctx.beginPath();let w=this.pointArr[_].x,B=this.pointArr[_].y;(this.isEditing||S||this.hoverActive)&&(this.drawPoint(w,B,S,!1,this.pointArr[_].fictitious),T&&T(_))}}insertFictitiousPoints(){if(!this.isEditing||!this.isClosePath||!this.enableAddPoint)return;this.removeFictitiousPoints();let S=[],T=this.pointArr,_=T.length;for(let B=0;B<_-1;B++){let A=T[B],O=T[B+1];S.push({x:(A.x+O.x)/2,y:(A.y+O.y)/2,fictitious:!0})}S.push({x:(T[_-1].x+T[0].x)/2,y:(T[_-1].y+T[0].y)/2,fictitious:!0});let w=[];for(let B=0;B<this.pointArr.length;B++)w.push(this.pointArr[B]),w.push(S.shift());this.pointArr=w}removeFictitiousPoints(){this.pointArr=this.getTruePointArr()}drawPoint(S,T,_,w,B){let{customRenderPoint:A,showPoint:O,pointType:R,pointWidth:P}=this.opt;if(w&&this.ctx.beginPath(),A)A(this.ctx,S,T,_,this.pointStyle);else{switch(this.ctx.save(),this.ctx.lineWidth=this.pointStyle.lineWidth,this.ctx.strokeStyle=this.pointStyle.strokeColor,this.ctx.fillStyle=this.pointStyle.fillColor,B&&(this.ctx.strokeStyle=this.pointStyle.fillColor,this.ctx.fillStyle=this.pointStyle.strokeColor),R){case"square":this.ctx.rect(S-P,T-P,P*2,P*2);break;case"circle":this.ctx.arc(S,T,P*2,0,2*Math.PI);break}_||O&&(this.ctx.fill(),this.ctx.stroke()),this.ctx.restore()}}checkInPath(S,T){return this.renderLines(this.strokeStyle,!0),this.ctx.isPointInPath(S,T)}checkInPoints(S,T){let _=-1;return this.renderPoints(!0,w=>{this.ctx.isPointInPath(S,T)&&(_=w)}),_}closePath(){this.areaToPointPos=null,this.isClosePath=!0}enableDrag(S=-1){this.isDragging=!0,this.dragPointIndex=S,this.dragCachePointArr=JSON.parse(JSON.stringify(this.pointArr))}getTruePointIndex(S){if(S===-1||this.pointArr[S].fictitious)return S;let T=0;for(let _=0;_<S;_++)this.pointArr[_].fictitious&&T++;return S-T}disableDrag(){this.isDragging=!1,this.dragPointIndex=-1,this.dragCachePointArr=[],this.insertFictitiousPoints()}dragPoint(S,T,..._){!this.isDragging||this.dragPointIndex===-1||(this.pointArr[this.dragPointIndex].fictitious&&delete this.pointArr[this.dragPointIndex].fictitious,this.dragPointIndex=this.getTruePointIndex(this.dragPointIndex),this.removeFictitiousPoints(),this.updatePointFn?this.updatePointFn(this,S,T,..._):this.pointArr.splice(this.dragPointIndex,1,{...this.pointArr[this.dragPointIndex],x:S,y:T}))}dragAll(S,T){this.isDragging&&(this.pointArr=this.dragCachePointArr.map(_=>({..._,x:_.x+S,y:_.y+T})))}enableHoverActive(){this.hoverActive=!0}disableHoverActive(){this.hoverActive=!1}checkLineSegmentCross(){if(!this.checkCrossPrevCheck())return!1;let S=this.createLineSegments(!0),T=S.length,_=!1;for(let w=0;w<T;w++){let B=S[w];this.checkCrossWithLineSegments(B[0],B[1],!0)&&(_=!0)}return _}checkNextLineSegmentCross(S,T){if(!this.checkCrossPrevCheck())return!1;let _=this.getTruePointArr(),w=_.length,B={x:S,y:T},A=_[w-1];return this.checkCrossWithLineSegments(B,A)}checkEndLineSegmentCross(){if(!this.checkCrossPrevCheck())return!1;let S=this.getTruePointArr(),T=S.length,_=S[T-1],w=S[0];return this.checkCrossWithLineSegments(_,w)}checkCrossWithLineSegments(S,T,_){let w=this.createLineSegments(_),B=!1;for(let A=0;A<w.length;A++){let O=w[A],R=O[0],P=O[1];utils$2.checkLineSegmentCross(R,P,S,T)&&(B=!0)}return B}createLineSegments(S){let T=this.getTruePointArr(),_=T.length,w=[];for(let B=0;B<_-1;B++)w.push([T[B],T[B+1]]);return S&&w.push([T[_-1],T[0]]),w}checkCrossPrevCheck(){return!(this.getTruePointArr().length<=2)}getPintNearestLine(S,T){let _=this.createLineSegments(this.isClosePath);if(_.length<=0)return null;this.dragPointIndex!==-1&&(this.dragPointIndex===0?(_.splice(0,1),_.splice(-1,1)):_.splice(this.dragPointIndex-1,2));let w=1/0,B;for(let A=0;A<_.length;A++){let O=_[A],R=O[0],P=O[1],E=utils$2.getLinePointDistance(R.x,R.y,P.x,P.y,S,T);E<w&&(w=E,B=O)}return[w,B]}}const defaultOpt$2={value:[],max:-1,hoverActive:!1,readonly:!1,single:!1,noCrossing:!1,dbClickRemovePoint:!1,area:!1,adsorbent:!0,adsorbentNum:5,adsorbentLine:!0,dbClickActive:!1,singleClickComplete:!0,enableAddPoint:!1};function EditPlugin(L,S){let T=null,_=new Promise(me=>{T=me}),w={...defaultOpt$2,...L.opt};w.dbClickActive&&(L.opt.cursorTips?L.opt.cursorTips.HOVER||(L.opt.cursorTips.HOVER="双击激活该区域并进入编辑状态"):L.opt.cursorTips={HOVER:"双击激活该区域并进入编辑状态"});let B=[],A=null,O={x:0,y:0},R={x:0,y:0},P=w.readonly,E=!1,D=null,I=null,M=0,N=null,k=[0,0],F={x:0,y:0},G=!1,V=Y(),j={x:0,y:0},H={x:0,y:0};L.on("UPDATED_OPT",me=>{w={...defaultOpt$2,...L.opt},L.clearCanvas(),B.forEach(ye=>{ye.updateOpt(w),ye.render()})});function U(){w.value.length>0&&(w.value.forEach(me=>{let ye=new MarkItem(L.ctx,{id:M++,...w,...me,pointArr:me.pointArr.map(ge=>({x:ge.x*L.canvasEleRectInfo.width,y:ge.y*L.canvasEleRectInfo.height}))});ye.closePath(),B.push(ye)}),z())}U();function X(){return{markItemList:B,curEditingMarkItem:A,isReadonly:P,isCreateMarking:E}}function Y(me={}){return new MarkItem(L.ctx,{id:M++,...w,...D,...me,area:w.area})}function z(){L.clearCanvas(),w.single&&(A||E)?A&&A.render():B.forEach(me=>{me.render()}),N&&V.drawPoint(N[0],N[1],!1,!0)}function W(){B.forEach(me=>{me.disable()})}function Z(){B.forEach(me=>{me.disableHoverActive()})}function Q(me,ye){for(let ge=B.length-1;ge>=0;ge--){let we=B[ge];if(we.checkInPath(me,ye)||we.checkInPoints(me,ye)!==-1)return we}}function ee(me,ye){let ge=[];for(let we=B.length-1;we>=0;we--){let Te=B[we];(Te.checkInPath(me,ye)||Te.checkInPoints(me,ye)!==-1)&&ge.push(Te)}return ge}function te(){return B.map(me=>{let ye=me.pointArr.map(ge=>({x:ge.x/L.canvasEleRectInfo.width,y:ge.y/L.canvasEleRectInfo.height}));return{data:me.data,pointArr:ye}})}function re(){return A&&!A.isClosePath}function ie(){P=!1}function ne(){Z(),W(),le(null),z()}function he(){return re()?!1:(ne(),P=!0,!0)}function pe(me){return P?!1:(E=me,L.emit("IS-CREATE-MARKING-CHANGE",me),!0)}function K(me=null){if(re()||P)return!1;if(ne(),D=me,D&&D.pointArr&&D.pointArr.length>0){let ye=Y({pointArr:D.pointArr.map(ge=>({x:ge.x*L.canvasEleRectInfo.width,y:ge.y*L.canvasEleRectInfo.height}))});ye.closePath(),B.push(ye),z()}else pe(!0);return w.single&&L.clearCanvas(),!0}function ue(){if(!E)return!1;if(pe(!1),re()){let me=B.findIndex(ye=>ye===A);B.splice(me,1)}ne()}function le(me){return P?!1:(A=me,L.emit("CURRENT-MARK-ITEM-CHANGE",me),!0)}function ce(me){if(!me)return!1;let ye=B.findIndex(ge=>ge.opt.id===me.opt.id);if(ye!==-1){A.opt.id===me.opt.id&&le(null);let ge=B.splice(ye,1);return z(),L.emit("DELETE-MARKING-ITEM",ge[0],ye),!0}return!1}function _e(){B=[],le(null),z(),L.emit("DELETE-ALL-MARKING-ITEM")}function oe(me,ye){if(!w.adsorbent)return[me,ye];let ge=1/0,we=me,Te=ye,Ee=null;return B.forEach(De=>{if(De.pointArr.forEach((fe,Ce)=>{if(A&&De===A&&De.dragPointIndex===Ce)return;let Se=S.getTwoPointDistance(fe.x,fe.y,me,ye);Se<=w.adsorbentNum&&Se<ge&&(ge=Se,we=fe.x,Te=fe.y,Ee=[we,Te])}),w.adsorbentLine){let fe=De.getPintNearestLine(me,ye);if(fe&&fe[0]<=w.adsorbentNum){let Ce=fe[1],Se=Ce[0],be=Ce[1],Re=Math.min(Se.x,be.x),Ve=Math.max(Se.x,be.x);if(me>=Re&&me<=Ve){let Pe=S.getNearestPointFromLine(Se.x,Se.y,be.x,be.y,me,ye);we=Pe[0],Te=Pe[1],Ee=[we,Te]}}}}),N=Ee,[we,Te]}function de(me,ye){if(!w.adsorbent)return[me,ye];let ge=1/0,we=null,Te=null;A.pointArr.forEach(Ee=>{B.forEach(De=>{De!==A&&De.pointArr.forEach(fe=>{let Ce=S.getTwoPointDistance(Ee.x,Ee.y,fe.x,fe.y);Ce<ge&&(ge=Ce,we=Ee,Te=fe)})})}),ge<=w.adsorbentNum&&(k=[Te.x-we.x,Te.y-we.y],O.x-=k[0],O.y-=k[1])}return L.on("CLICK",me=>{if(!w.mobile&&(Math.abs(H.x-j.x)>=5||Math.abs(H.y-j.y)>=5)||P)return;if(!w.mobile&&G){G=!1;return}let{x:ye,y:ge}=L.toCanvasPos(me),we=null;if(E){let Te=ye,Ee=ge;N&&(Te=N[0],Ee=N[1],N=null),A?w.noCrossing&&A.checkNextLineSegmentCross(Te,Ee)?L.emit("LINE-CROSS",A):A.pushPoint(Te,Ee):w.max===-1||B.length<w.max?(W(),le(Y()),A.enable(),A.pushPoint(Te,Ee),B.push(A)):(L.emit("COUNT-LIMIT",A),pe(!1))}else(we=Q(ye,ge))?!w.dbClickActive&&!ee(ye,ge).includes(A)&&(!w.single||w.single&&!A)&&(W(),we.enable(),le(we)):!w.single&&w.singleClickComplete&&ne();z()}),L.on("DOUBLE-CLICK",me=>{if(P)return;let{x:ye,y:ge}=L.toCanvasPos(me),we=!0,Te=Q(ye,ge),Ee=Te&&A?Te===A:!1;if(A){let De=A.checkInPoints(ye,ge);w.dbClickRemovePoint&&De!==-1?(we=!1,A.getPointLength()>3?(A.removePoint(De),z()):L.emit("NOT-ENOUGH-POINTS-REMOVE",A)):A.getPointLength()<3?(we=!1,L.emit("NOT-ENOUGH-END-POINTS",A)):w.noCrossing&&A.checkEndLineSegmentCross()?(we=!1,L.emit("LINE-CROSS",A)):(E&&L.emit("COMPLETE-CREATE-ITEM",A,me),pe(!1),A.closePath(),A.disable(),N=null,le(null),z(),L.emit("COMPLETE-EDIT-ITEM",A,me))}w.dbClickActive&&!E&&we&&Te&&!Ee&&(W(),Te.enable(),le(Te),z())}),L.on("MOUSEDOWN",me=>{if(j={x:me.clientX,y:me.clientY},P)return;let{x:ye,y:ge}=L.toCanvasPos(me);if(!A||!A.isEditing||!A.isClosePath)return;let we=A.checkInPoints(ye,ge);(A.checkInPath(ye,ge)||we!==-1)&&(w.noCrossing&&(I=JSON.parse(JSON.stringify(A.pointArr))),O.x=ye,O.y=ge,R.x=ye,R.y=ge,A.enableDrag(we))}),L.on("MOUSEMOVE",(me,ye)=>{if(P)return;let{x:ge,y:we}=L.toCanvasPos(me);if(A&&A.isDragging){if(L.opt.mobile?(ye.stopPropagation(),ye.preventDefault()):(me.stopPropagation(),me.preventDefault()),A.dragPointIndex!==-1)A.dragPoint(...oe(ge,we),L);else{de(),k[0]!==0&&k[1]!==0&&F.x===0&&F.y===0&&(F.x=ge,F.y=we),F.x!==0&&F.y!==0&&S.getTwoPointDistance(F.x,F.y,ge,we)>w.adsorbentNum&&(k=[0,0],O.x=R.x,O.y=R.y,F.x=0,F.y=0);let Ee=ge-O.x,De=we-O.y;A.dragAll(Ee,De)}z();let Te=A.checkInPoints(ge,we);L.emit("HOVER-ITEM",A,A,ee(ge,we),me,Te)}else if(E){let Te=ge-O.x,Ee=we-O.y,De=oe(Te,Ee);w.area&&A&&A.areaToPoint(...De),z()}else if(!E){let Te=Q(ge,we);if(w.hoverActive&&(!A||A.isClosePath)&&(Z(),Te&&Te.enableHoverActive(),z()),Te&&Te.isClosePath){let Ee=Te.checkInPoints(ge,we);L.emit("HOVER-ITEM",Te,A,ee(ge,we),me,Ee)}}}),L.on("MOUSEUP",me=>{H={x:me.clientX,y:me.clientY},!P&&A&&A.isDragging&&(G=!0,A.disableDrag(),O.x=0,O.y=0,R.x=0,R.y=0,w.noCrossing&&A.checkLineSegmentCross()&&(L.emit("LINE-CROSS",A),A.pointArr=I,I=null),z())}),L._disableAllItemsEdit=W,L._setMarkEditItem=le,L._createNewMarkItem=Y,L._setIsCreateMarking=pe,L._render=z,L._disableAllItemsHoverActive=Z,L._checkInPathItem=Q,L._checkInPathAllItems=ee,L._getIsCreateIngMarkItem=re,L.getState=X,L.getMarkData=te,L.enableEdit=ie,L.disableEdit=he,L.deleteMarkItem=ce,L.deleteAllMarkItem=_e,L.createMarkItem=K,L.exitCreate=ue,L.reset=ne,T(),_}var cjs,hasRequiredCjs;function requireCjs(){if(hasRequiredCjs)return cjs;hasRequiredCjs=1;var L=function(V){return S(V)&&!T(V)};function S(G){return!!G&&typeof G=="object"}function T(G){var V=Object.prototype.toString.call(G);return V==="[object RegExp]"||V==="[object Date]"||B(G)}var _=typeof Symbol=="function"&&Symbol.for,w=_?Symbol.for("react.element"):60103;function B(G){return G.$$typeof===w}function A(G){return Array.isArray(G)?[]:{}}function O(G,V){return V.clone!==!1&&V.isMergeableObject(G)?k(A(G),G,V):G}function R(G,V,j){return G.concat(V).map(function(H){return O(H,j)})}function P(G,V){if(!V.customMerge)return k;var j=V.customMerge(G);return typeof j=="function"?j:k}function E(G){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(G).filter(function(V){return Object.propertyIsEnumerable.call(G,V)}):[]}function D(G){return Object.keys(G).concat(E(G))}function I(G,V){try{return V in G}catch(j){return!1}}function M(G,V){return I(G,V)&&!(Object.hasOwnProperty.call(G,V)&&Object.propertyIsEnumerable.call(G,V))}function N(G,V,j){var H={};return j.isMergeableObject(G)&&D(G).forEach(function(U){H[U]=O(G[U],j)}),D(V).forEach(function(U){M(G,U)||(I(G,U)&&j.isMergeableObject(V[U])?H[U]=P(U,j)(G[U],V[U],j):H[U]=O(V[U],j))}),H}function k(G,V,j){j=j||{},j.arrayMerge=j.arrayMerge||R,j.isMergeableObject=j.isMergeableObject||L,j.cloneUnlessOtherwiseSpecified=O;var H=Array.isArray(V),U=Array.isArray(G),X=H===U;return X?H?j.arrayMerge(G,V,j):N(G,V,j):O(V,j)}k.all=function(V,j){if(!Array.isArray(V))throw new Error("first argument should be an array");return V.reduce(function(H,U){return k(H,U,j)},{})};var F=k;return cjs=F,cjs}var cjsExports=requireCjs();const merge=getDefaultExportFromCjs(cjsExports),defaultOpt$1={dbClickTime:200},mi=class mi{static use(S,T=-1){if(S){if(S.used)return this;S.used=!0,T===-1?mi.pluginList.push(S):mi.pluginList.splice(T,0,S)}}constructor(S={}){if(!S.el)throw new Error("el属性为空");if(this.opt={...defaultOpt$1,...S},this.el=this.originEl=typeof S.el=="string"?document.querySelector(S.el):S.el,!this.el)throw new Error("容器元素获取失败");this.crateContainer(),this.elRectInfo=null,this.canvasEle=null,this.canvasEleRectInfo=null,this.ctx=null,this.clickTimer=null,this.observer=new Observer,this.mousedownPos={x:0,y:0},this.mouseupPos={x:0,y:0},this.lastClickTime=0,this.bindEventCallback(),this.init(),this.usePlugins()}updateOpt(S){this.opt=merge(this.opt,S),this.emit("UPDATED_OPT",this.opt),S.scale!=null&&this.emit("UPDATED_IMG",S)}usePlugins(){let S=0,T=mi.pluginList.length,_=()=>{if(S>=T){this.emit("PLUGINS_LOADED");return}let w=mi.pluginList[S];w(this,utils$2).then(()=>{S++,_()})};_()}emit(S,...T){this.observer.publish(S,...T)}on(S,T){return this.observer.subscribe(S,T)}off(S){this.observer.unsubscribe(S)}crateContainer(){let S=document.createElement("div");S.className="markjsContainer",S.style.cssText="\n            position: relative;\n            width: 100%;\n            height: 100%;\n        ",this.el.style.overflow="hidden",this.el.appendChild(S),this.el=S}init(){this.createElement(),this.ctx=this.canvasEle.getContext("2d"),this.bindEvent()}destroy(){this.unbindEvent(),this.el.removeChild(this.canvasEle),this.emit("DESTORY"),this.observer.clearAll()}createElement(){this.elRectInfo=this.el.getBoundingClientRect();let{width:S,height:T}=this.elRectInfo;this.canvasEle=document.createElement("canvas"),this.canvasEle.width=S,this.canvasEle.height=T,this.canvasEleRectInfo={width:S,height:T},this.el.appendChild(this.canvasEle)}bindEventCallback(){this.onclick=this.onclick.bind(this),this.onmousedown=this.onmousedown.bind(this),this.onmousemove=this.onmousemove.bind(this),this.onmouseup=this.onmouseup.bind(this),this.onmouseenter=this.onmouseenter.bind(this),this.onmouseleave=this.onmouseleave.bind(this),this.onWindowClick=this.onWindowClick.bind(this)}bindEvent(){let S=this.opt.mobile;this.canvasEle.addEventListener("click",this.onclick),this.canvasEle.addEventListener(S?"touchstart":"mousedown",this.onmousedown),this.canvasEle.addEventListener(S?"touchmove":"mousemove",this.onmousemove),window.addEventListener(S?"touchend":"mouseup",this.onmouseup),this.canvasEle.addEventListener("mouseenter",this.onmouseenter),this.canvasEle.addEventListener("mouseleave",this.onmouseleave),window.addEventListener("click",this.onWindowClick)}unbindEvent(){let S=this.opt.mobile;this.canvasEle.removeEventListener("click",this.onclick),this.canvasEle.removeEventListener(S?"touchstart":"mousedown",this.onmousedown),this.canvasEle.removeEventListener(S?"touchmove":"mousemove",this.onmousemove),window.removeEventListener(S?"touchend":"mouseup",this.onmouseup),this.canvasEle.removeEventListener("mouseenter",this.onmouseenter),this.canvasEle.removeEventListener("mouseleave",this.onmouseleave),window.removeEventListener("click",this.onWindowClick)}onclick(S){this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.clickTimer=setTimeout(()=>{this.emit("CLICK",S)},this.opt.dbClickTime),Date.now()-this.lastClickTime<=this.opt.dbClickTime&&(clearTimeout(this.clickTimer),this.clickTimer=null,this.lastClickTime=0,this.emit("DOUBLE-CLICK",S)),this.lastClickTime=Date.now()}onmousedown(S){let T=null;this.opt.mobile&&(T=S,S=S.touches[0]),this.mousedownPos={x:S.clientX,y:S.clientY},this.emit("MOUSEDOWN",S,T)}onmousemove(S){let T=null;this.opt.mobile&&(T=S,S=S.touches[0]),this.emit("MOUSEMOVE",S,T)}onmouseup(S){let T=null;this.opt.mobile&&(T=S,S=S.touches[0]),S||(S={clientX:0,clientY:0}),this.mouseupPos={x:S.clientX,y:S.clientY},this.emit("MOUSEUP",S,T)}onmouseenter(S){this.emit("MOUSEENTER",S)}onmouseleave(S){this.emit("MOUSELEAVE",S)}onWindowClick(S){this.emit("WINDOW-CLICK",S)}clearCanvas(){this.ctx.clearRect(0,0,this.canvasEle.width,this.canvasEle.height)}toCanvasPos(S){let T=S.clientX,_=S.clientY,{left:w,top:B,width:A,height:O}=this.canvasEle.getBoundingClientRect();const R=A/this.canvasEle.offsetWidth,P=O/this.canvasEle.offsetHeight;let E=(T-w)/R,D=(_-B)/P;return{x:E,y:D}}};St(mi,"pluginList",[]);let Markjs=mi;Markjs.use(EditPlugin);__vitePreload(()=>import("./pen-DuzPQm6w.js"),[],import.meta.url);const defaultOpt={elBg:"",bg:""};function ImgPlugin(L){let S=null,T=new Promise(U=>{S=U}),_={...defaultOpt,...L.opt};if(!_.img)return S(),T;let w=L.elRectInfo,B=L.canvasEle,A=null,O=null,R=0,P=0,E=0,D=0,I=0,M=!1;L.on("DESTORY",()=>{A&&L.el.removeChild(A)}),L.on("UPDATED_IMG",U=>{_.scale=U.scale,H()});function N(){utils$2.loadImage(_.img).then(U=>{O=U,R=O.width,P=O.height,F(),M||S()}).catch(U=>{L.observer.publish("IMG-LOAD-ERROR",U),M||S()})}N();function k(U){U&&(M=!0,L.opt.img=U,_.img=U,N())}function F(){G(),L.canvasEleRectInfo={width:E,height:D,left:(w.width-E)/2,top:(w.height-D)/2},V(),j(B,{zIndex:2}),H(),M&&L._render()}function G(){if(w.width>=R&&w.height>=P)I=1,E=R,D=P;else{let U=R/P;w.width/w.height>U?(I=P/w.height,E=R/I,D=w.height):(I=R/w.width,E=w.width,D=P/I)}}function V(){window.getComputedStyle(L.el).position==="static"&&(L.el.style.position="relative"),_.elBg&&(L.originEl.style.background=_.elBg,L.el.style.background=_.elBg)}function j(U,X={}){U.width=E,U.height=D,U.style.position="absolute",U.style.left=L.canvasEleRectInfo.left+"px",U.style.top=L.canvasEleRectInfo.top+"px",Object.keys(X).forEach(Y=>{U.style[Y]=X[Y]})}function H(){A=A||document.createElement("canvas");let U={zIndex:1};_.bg&&(U.background=_.bg);let X=_.scale||1;j(A,U),L.el.appendChild(A);let Y=A.getContext("2d");Y.lineWidth=5,Y.strokeRect(0,0,E,D),Y.drawImage(O,(1-X)*.5*E,(1-X)*.5*D,E*X,D*X)}return L.image=O,L.ratio=I,L.refreshImage=k,T}Markjs.use(ImgPlugin,0);let mark2=null;const _sfc_main$2={name:"MarkEdit",props:{img:{type:String,required:!1},pointArr:{type:Array,default:[],required:!1},imgScale:{type:Number,default:1,required:!1}},data(){return{dataSource:[],editing2:!0,curEditMarkItem2:null,isCreateMarking2:!1,scale:this.imgScale}},watch:{scale(L,S){mark2!=null&&mark2.updateOpt({scale:L})}},mounted(){console.log("当前的scale",this.imgScale),mark2=new Markjs({el:this.$refs.markBox2,hoverActive:!0,img:this.img,scale:this.scale}),console.log("mark2",mark2);let L=()=>{if(this.timeOutInt=null,mark2.createMarkItem!=null)for(var S=0;S<this.pointArr.length;S++)mark2.createMarkItem({pointArr:this.pointArr[S]});else this.timeOutInt=setTimeout(()=>{L()},10)};L(),mark2.on("CURRENT-MARK-ITEM-CHANGE",S=>{this.curEditMarkItem2=S}),mark2.on("IS-CREATE-MARKING-CHANGE",S=>{this.isCreateMarking2=S}),mark2.on("LINE-CROSS",S=>{this.$message.warning("线段不允许交叉")}),mark2.on("NOT-ENOUGH-END-POINTS",S=>{this.$message.warning("至少需要绘制三个端点")}),mark2.on("COUNT-LIMIT",S=>{this.$message.warning("最多只能绘制三个区域")})},unmounted(){this.timeOutInt!=null&&clearTimeout(this.timeOutInt)},methods:{getMarkData2(){let L=mark2.getMarkData();L.length==0?this.$emit("onChange",[],this.scale):this.$emit("onChange",L.map(S=>S.pointArr),this.scale)},deleteItem2(){console.log("删除了选中的碰撞框",this.curEditMarkItem2),mark2.deleteMarkItem(this.curEditMarkItem2)},deleteAll2(){mark2.deleteAllMarkItem()},create2(){mark2.createMarkItem()},exit2(){mark2.exitCreate()}}},_hoisted_1$2={class:"markBox",ref:"markBox2",style:{width:"100%",height:"600px","margin-bottom":"10px",border:"solid 1px gray"}};function _sfc_render$2(L,S,T,_,w,B){const A=resolveComponent("a-button"),O=resolveComponent("a-slider"),R=resolveComponent("a-flex");return openBlock(),createElementBlock("div",null,[createBaseVNode("div",_hoisted_1$2,null,512),createVNode(R,{gap:"small",align:"center"},{default:withCtx(()=>[createVNode(A,{onClick:B.create2,disabled:!w.editing2||!!w.curEditMarkItem2},{default:withCtx(()=>[...S[1]||(S[1]=[createTextVNode("新增碰撞框",-1)])]),_:1},8,["onClick","disabled"]),createVNode(A,{onClick:B.exit2,disabled:!w.isCreateMarking2},{default:withCtx(()=>[...S[2]||(S[2]=[createTextVNode("退出新增",-1)])]),_:1},8,["onClick","disabled"]),createVNode(A,{onClick:B.deleteItem2,disabled:!w.curEditMarkItem2},{default:withCtx(()=>[...S[3]||(S[3]=[createTextVNode("删除选中",-1)])]),_:1},8,["onClick","disabled"]),createVNode(A,{onClick:B.deleteAll2},{default:withCtx(()=>[...S[4]||(S[4]=[createTextVNode("清空",-1)])]),_:1},8,["onClick"]),S[6]||(S[6]=createBaseVNode("div",{style:{"flex-grow":"1"}},null,-1)),S[7]||(S[7]=createBaseVNode("div",null,"缩放",-1)),createVNode(O,{style:{width:"100px"},value:w.scale,"onUpdate:value":S[0]||(S[0]=P=>w.scale=P),max:1,min:.1,step:.01},null,8,["value"]),S[8]||(S[8]=createBaseVNode("div",{style:{"flex-grow":"1"}},null,-1)),createVNode(A,{type:"primary",onClick:B.getMarkData2},{default:withCtx(()=>[...S[5]||(S[5]=[createTextVNode("保存",-1)])]),_:1},8,["onClick"])]),_:1})])}const MarkEdit=_export_sfc(_sfc_main$2,[["render",_sfc_render$2]]);var cryptoJs$1={exports:{}};function commonjsRequire(L){throw new Error('Could not dynamically require "'+L+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var core$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);var core=core$1.exports,hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,function(L,S){(function(T,_){L.exports=_()})(core,function(){var T=T||function(_,w){var B;if(typeof window<"u"&&window.crypto&&(B=window.crypto),typeof self<"u"&&self.crypto&&(B=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(B=globalThis.crypto),!B&&typeof window<"u"&&window.msCrypto&&(B=window.msCrypto),!B&&typeof commonjsGlobal<"u"&&commonjsGlobal.crypto&&(B=commonjsGlobal.crypto),!B&&typeof commonjsRequire=="function")try{B=require$$0}catch(V){}var A=function(){if(B){if(typeof B.getRandomValues=="function")try{return B.getRandomValues(new Uint32Array(1))[0]}catch(V){}if(typeof B.randomBytes=="function")try{return B.randomBytes(4).readInt32LE()}catch(V){}}throw new Error("Native crypto module could not be used to get secure random number.")},O=Object.create||function(){function V(){}return function(j){var H;return V.prototype=j,H=new V,V.prototype=null,H}}(),R={},P=R.lib={},E=P.Base=function(){return{extend:function(V){var j=O(this);return V&&j.mixIn(V),(!j.hasOwnProperty("init")||this.init===j.init)&&(j.init=function(){j.$super.init.apply(this,arguments)}),j.init.prototype=j,j.$super=this,j},create:function(){var V=this.extend();return V.init.apply(V,arguments),V},init:function(){},mixIn:function(V){for(var j in V)V.hasOwnProperty(j)&&(this[j]=V[j]);V.hasOwnProperty("toString")&&(this.toString=V.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),D=P.WordArray=E.extend({init:function(V,j){V=this.words=V||[],j!=w?this.sigBytes=j:this.sigBytes=V.length*4},toString:function(V){return(V||M).stringify(this)},concat:function(V){var j=this.words,H=V.words,U=this.sigBytes,X=V.sigBytes;if(this.clamp(),U%4)for(var Y=0;Y<X;Y++){var z=H[Y>>>2]>>>24-Y%4*8&255;j[U+Y>>>2]|=z<<24-(U+Y)%4*8}else for(var W=0;W<X;W+=4)j[U+W>>>2]=H[W>>>2];return this.sigBytes+=X,this},clamp:function(){var V=this.words,j=this.sigBytes;V[j>>>2]&=4294967295<<32-j%4*8,V.length=_.ceil(j/4)},clone:function(){var V=E.clone.call(this);return V.words=this.words.slice(0),V},random:function(V){for(var j=[],H=0;H<V;H+=4)j.push(A());return new D.init(j,V)}}),I=R.enc={},M=I.Hex={stringify:function(V){for(var j=V.words,H=V.sigBytes,U=[],X=0;X<H;X++){var Y=j[X>>>2]>>>24-X%4*8&255;U.push((Y>>>4).toString(16)),U.push((Y&15).toString(16))}return U.join("")},parse:function(V){for(var j=V.length,H=[],U=0;U<j;U+=2)H[U>>>3]|=parseInt(V.substr(U,2),16)<<24-U%8*4;return new D.init(H,j/2)}},N=I.Latin1={stringify:function(V){for(var j=V.words,H=V.sigBytes,U=[],X=0;X<H;X++){var Y=j[X>>>2]>>>24-X%4*8&255;U.push(String.fromCharCode(Y))}return U.join("")},parse:function(V){for(var j=V.length,H=[],U=0;U<j;U++)H[U>>>2]|=(V.charCodeAt(U)&255)<<24-U%4*8;return new D.init(H,j)}},k=I.Utf8={stringify:function(V){try{return decodeURIComponent(escape(N.stringify(V)))}catch(j){throw new Error("Malformed UTF-8 data")}},parse:function(V){return N.parse(unescape(encodeURIComponent(V)))}},F=P.BufferedBlockAlgorithm=E.extend({reset:function(){this._data=new D.init,this._nDataBytes=0},_append:function(V){typeof V=="string"&&(V=k.parse(V)),this._data.concat(V),this._nDataBytes+=V.sigBytes},_process:function(V){var j,H=this._data,U=H.words,X=H.sigBytes,Y=this.blockSize,z=Y*4,W=X/z;V?W=_.ceil(W):W=_.max((W|0)-this._minBufferSize,0);var Z=W*Y,Q=_.min(Z*4,X);if(Z){for(var ee=0;ee<Z;ee+=Y)this._doProcessBlock(U,ee);j=U.splice(0,Z),H.sigBytes-=Q}return new D.init(j,Q)},clone:function(){var V=E.clone.call(this);return V._data=this._data.clone(),V},_minBufferSize:0});P.Hasher=F.extend({cfg:E.extend(),init:function(V){this.cfg=this.cfg.extend(V),this.reset()},reset:function(){F.reset.call(this),this._doReset()},update:function(V){return this._append(V),this._process(),this},finalize:function(V){V&&this._append(V);var j=this._doFinalize();return j},blockSize:16,_createHelper:function(V){return function(j,H){return new V.init(H).finalize(j)}},_createHmacHelper:function(V){return function(j,H){return new G.HMAC.init(V,H).finalize(j)}}});var G=R.algo={};return R}(Math);return T})}(core$1)),core$1.exports}var x64Core$1={exports:{}},x64Core=x64Core$1.exports,hasRequiredX64Core;function requireX64Core(){return hasRequiredX64Core||(hasRequiredX64Core=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(x64Core,function(T){return function(_){var w=T,B=w.lib,A=B.Base,O=B.WordArray,R=w.x64={};R.Word=A.extend({init:function(P,E){this.high=P,this.low=E}}),R.WordArray=A.extend({init:function(P,E){P=this.words=P||[],E!=_?this.sigBytes=E:this.sigBytes=P.length*8},toX32:function(){for(var P=this.words,E=P.length,D=[],I=0;I<E;I++){var M=P[I];D.push(M.high),D.push(M.low)}return O.create(D,this.sigBytes)},clone:function(){for(var P=A.clone.call(this),E=P.words=this.words.slice(0),D=E.length,I=0;I<D;I++)E[I]=E[I].clone();return P}})}(),T})}(x64Core$1)),x64Core$1.exports}var libTypedarrays$1={exports:{}},libTypedarrays=libTypedarrays$1.exports,hasRequiredLibTypedarrays;function requireLibTypedarrays(){return hasRequiredLibTypedarrays||(hasRequiredLibTypedarrays=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(libTypedarrays,function(T){return function(){if(typeof ArrayBuffer=="function"){var _=T,w=_.lib,B=w.WordArray,A=B.init,O=B.init=function(R){if(R instanceof ArrayBuffer&&(R=new Uint8Array(R)),(R instanceof Int8Array||typeof Uint8ClampedArray<"u"&&R instanceof Uint8ClampedArray||R instanceof Int16Array||R instanceof Uint16Array||R instanceof Int32Array||R instanceof Uint32Array||R instanceof Float32Array||R instanceof Float64Array)&&(R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength)),R instanceof Uint8Array){for(var P=R.byteLength,E=[],D=0;D<P;D++)E[D>>>2]|=R[D]<<24-D%4*8;A.call(this,E,P)}else A.apply(this,arguments)};O.prototype=B}}(),T.lib.WordArray})}(libTypedarrays$1)),libTypedarrays$1.exports}var encUtf16$1={exports:{}},encUtf16=encUtf16$1.exports,hasRequiredEncUtf16;function requireEncUtf16(){return hasRequiredEncUtf16||(hasRequiredEncUtf16=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(encUtf16,function(T){return function(){var _=T,w=_.lib,B=w.WordArray,A=_.enc;A.Utf16=A.Utf16BE={stringify:function(R){for(var P=R.words,E=R.sigBytes,D=[],I=0;I<E;I+=2){var M=P[I>>>2]>>>16-I%4*8&65535;D.push(String.fromCharCode(M))}return D.join("")},parse:function(R){for(var P=R.length,E=[],D=0;D<P;D++)E[D>>>1]|=R.charCodeAt(D)<<16-D%2*16;return B.create(E,P*2)}},A.Utf16LE={stringify:function(R){for(var P=R.words,E=R.sigBytes,D=[],I=0;I<E;I+=2){var M=O(P[I>>>2]>>>16-I%4*8&65535);D.push(String.fromCharCode(M))}return D.join("")},parse:function(R){for(var P=R.length,E=[],D=0;D<P;D++)E[D>>>1]|=O(R.charCodeAt(D)<<16-D%2*16);return B.create(E,P*2)}};function O(R){return R<<8&4278255360|R>>>8&16711935}}(),T.enc.Utf16})}(encUtf16$1)),encUtf16$1.exports}var encBase64$1={exports:{}},encBase64=encBase64$1.exports,hasRequiredEncBase64;function requireEncBase64(){return hasRequiredEncBase64||(hasRequiredEncBase64=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(encBase64,function(T){return function(){var _=T,w=_.lib,B=w.WordArray,A=_.enc;A.Base64={stringify:function(R){var P=R.words,E=R.sigBytes,D=this._map;R.clamp();for(var I=[],M=0;M<E;M+=3)for(var N=P[M>>>2]>>>24-M%4*8&255,k=P[M+1>>>2]>>>24-(M+1)%4*8&255,F=P[M+2>>>2]>>>24-(M+2)%4*8&255,G=N<<16|k<<8|F,V=0;V<4&&M+V*.75<E;V++)I.push(D.charAt(G>>>6*(3-V)&63));var j=D.charAt(64);if(j)for(;I.length%4;)I.push(j);return I.join("")},parse:function(R){var P=R.length,E=this._map,D=this._reverseMap;if(!D){D=this._reverseMap=[];for(var I=0;I<E.length;I++)D[E.charCodeAt(I)]=I}var M=E.charAt(64);if(M){var N=R.indexOf(M);N!==-1&&(P=N)}return O(R,P,D)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function O(R,P,E){for(var D=[],I=0,M=0;M<P;M++)if(M%4){var N=E[R.charCodeAt(M-1)]<<M%4*2,k=E[R.charCodeAt(M)]>>>6-M%4*2,F=N|k;D[I>>>2]|=F<<24-I%4*8,I++}return B.create(D,I)}}(),T.enc.Base64})}(encBase64$1)),encBase64$1.exports}var encBase64url$1={exports:{}},encBase64url=encBase64url$1.exports,hasRequiredEncBase64url;function requireEncBase64url(){return hasRequiredEncBase64url||(hasRequiredEncBase64url=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(encBase64url,function(T){return function(){var _=T,w=_.lib,B=w.WordArray,A=_.enc;A.Base64url={stringify:function(R,P){P===void 0&&(P=!0);var E=R.words,D=R.sigBytes,I=P?this._safe_map:this._map;R.clamp();for(var M=[],N=0;N<D;N+=3)for(var k=E[N>>>2]>>>24-N%4*8&255,F=E[N+1>>>2]>>>24-(N+1)%4*8&255,G=E[N+2>>>2]>>>24-(N+2)%4*8&255,V=k<<16|F<<8|G,j=0;j<4&&N+j*.75<D;j++)M.push(I.charAt(V>>>6*(3-j)&63));var H=I.charAt(64);if(H)for(;M.length%4;)M.push(H);return M.join("")},parse:function(R,P){P===void 0&&(P=!0);var E=R.length,D=P?this._safe_map:this._map,I=this._reverseMap;if(!I){I=this._reverseMap=[];for(var M=0;M<D.length;M++)I[D.charCodeAt(M)]=M}var N=D.charAt(64);if(N){var k=R.indexOf(N);k!==-1&&(E=k)}return O(R,E,I)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function O(R,P,E){for(var D=[],I=0,M=0;M<P;M++)if(M%4){var N=E[R.charCodeAt(M-1)]<<M%4*2,k=E[R.charCodeAt(M)]>>>6-M%4*2,F=N|k;D[I>>>2]|=F<<24-I%4*8,I++}return B.create(D,I)}}(),T.enc.Base64url})}(encBase64url$1)),encBase64url$1.exports}var md5$1={exports:{}},md5=md5$1.exports,hasRequiredMd5;function requireMd5(){return hasRequiredMd5||(hasRequiredMd5=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(md5,function(T){return function(_){var w=T,B=w.lib,A=B.WordArray,O=B.Hasher,R=w.algo,P=[];(function(){for(var k=0;k<64;k++)P[k]=_.abs(_.sin(k+1))*4294967296|0})();var E=R.MD5=O.extend({_doReset:function(){this._hash=new A.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(k,F){for(var G=0;G<16;G++){var V=F+G,j=k[V];k[V]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360}var H=this._hash.words,U=k[F+0],X=k[F+1],Y=k[F+2],z=k[F+3],W=k[F+4],Z=k[F+5],Q=k[F+6],ee=k[F+7],te=k[F+8],re=k[F+9],ie=k[F+10],ne=k[F+11],he=k[F+12],pe=k[F+13],K=k[F+14],ue=k[F+15],le=H[0],ce=H[1],_e=H[2],oe=H[3];le=D(le,ce,_e,oe,U,7,P[0]),oe=D(oe,le,ce,_e,X,12,P[1]),_e=D(_e,oe,le,ce,Y,17,P[2]),ce=D(ce,_e,oe,le,z,22,P[3]),le=D(le,ce,_e,oe,W,7,P[4]),oe=D(oe,le,ce,_e,Z,12,P[5]),_e=D(_e,oe,le,ce,Q,17,P[6]),ce=D(ce,_e,oe,le,ee,22,P[7]),le=D(le,ce,_e,oe,te,7,P[8]),oe=D(oe,le,ce,_e,re,12,P[9]),_e=D(_e,oe,le,ce,ie,17,P[10]),ce=D(ce,_e,oe,le,ne,22,P[11]),le=D(le,ce,_e,oe,he,7,P[12]),oe=D(oe,le,ce,_e,pe,12,P[13]),_e=D(_e,oe,le,ce,K,17,P[14]),ce=D(ce,_e,oe,le,ue,22,P[15]),le=I(le,ce,_e,oe,X,5,P[16]),oe=I(oe,le,ce,_e,Q,9,P[17]),_e=I(_e,oe,le,ce,ne,14,P[18]),ce=I(ce,_e,oe,le,U,20,P[19]),le=I(le,ce,_e,oe,Z,5,P[20]),oe=I(oe,le,ce,_e,ie,9,P[21]),_e=I(_e,oe,le,ce,ue,14,P[22]),ce=I(ce,_e,oe,le,W,20,P[23]),le=I(le,ce,_e,oe,re,5,P[24]),oe=I(oe,le,ce,_e,K,9,P[25]),_e=I(_e,oe,le,ce,z,14,P[26]),ce=I(ce,_e,oe,le,te,20,P[27]),le=I(le,ce,_e,oe,pe,5,P[28]),oe=I(oe,le,ce,_e,Y,9,P[29]),_e=I(_e,oe,le,ce,ee,14,P[30]),ce=I(ce,_e,oe,le,he,20,P[31]),le=M(le,ce,_e,oe,Z,4,P[32]),oe=M(oe,le,ce,_e,te,11,P[33]),_e=M(_e,oe,le,ce,ne,16,P[34]),ce=M(ce,_e,oe,le,K,23,P[35]),le=M(le,ce,_e,oe,X,4,P[36]),oe=M(oe,le,ce,_e,W,11,P[37]),_e=M(_e,oe,le,ce,ee,16,P[38]),ce=M(ce,_e,oe,le,ie,23,P[39]),le=M(le,ce,_e,oe,pe,4,P[40]),oe=M(oe,le,ce,_e,U,11,P[41]),_e=M(_e,oe,le,ce,z,16,P[42]),ce=M(ce,_e,oe,le,Q,23,P[43]),le=M(le,ce,_e,oe,re,4,P[44]),oe=M(oe,le,ce,_e,he,11,P[45]),_e=M(_e,oe,le,ce,ue,16,P[46]),ce=M(ce,_e,oe,le,Y,23,P[47]),le=N(le,ce,_e,oe,U,6,P[48]),oe=N(oe,le,ce,_e,ee,10,P[49]),_e=N(_e,oe,le,ce,K,15,P[50]),ce=N(ce,_e,oe,le,Z,21,P[51]),le=N(le,ce,_e,oe,he,6,P[52]),oe=N(oe,le,ce,_e,z,10,P[53]),_e=N(_e,oe,le,ce,ie,15,P[54]),ce=N(ce,_e,oe,le,X,21,P[55]),le=N(le,ce,_e,oe,te,6,P[56]),oe=N(oe,le,ce,_e,ue,10,P[57]),_e=N(_e,oe,le,ce,Q,15,P[58]),ce=N(ce,_e,oe,le,pe,21,P[59]),le=N(le,ce,_e,oe,W,6,P[60]),oe=N(oe,le,ce,_e,ne,10,P[61]),_e=N(_e,oe,le,ce,Y,15,P[62]),ce=N(ce,_e,oe,le,re,21,P[63]),H[0]=H[0]+le|0,H[1]=H[1]+ce|0,H[2]=H[2]+_e|0,H[3]=H[3]+oe|0},_doFinalize:function(){var k=this._data,F=k.words,G=this._nDataBytes*8,V=k.sigBytes*8;F[V>>>5]|=128<<24-V%32;var j=_.floor(G/4294967296),H=G;F[(V+64>>>9<<4)+15]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,F[(V+64>>>9<<4)+14]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,k.sigBytes=(F.length+1)*4,this._process();for(var U=this._hash,X=U.words,Y=0;Y<4;Y++){var z=X[Y];X[Y]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360}return U},clone:function(){var k=O.clone.call(this);return k._hash=this._hash.clone(),k}});function D(k,F,G,V,j,H,U){var X=k+(F&G|~F&V)+j+U;return(X<<H|X>>>32-H)+F}function I(k,F,G,V,j,H,U){var X=k+(F&V|G&~V)+j+U;return(X<<H|X>>>32-H)+F}function M(k,F,G,V,j,H,U){var X=k+(F^G^V)+j+U;return(X<<H|X>>>32-H)+F}function N(k,F,G,V,j,H,U){var X=k+(G^(F|~V))+j+U;return(X<<H|X>>>32-H)+F}w.MD5=O._createHelper(E),w.HmacMD5=O._createHmacHelper(E)}(Math),T.MD5})}(md5$1)),md5$1.exports}var sha1$1={exports:{}},sha1=sha1$1.exports,hasRequiredSha1;function requireSha1(){return hasRequiredSha1||(hasRequiredSha1=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(sha1,function(T){return function(){var _=T,w=_.lib,B=w.WordArray,A=w.Hasher,O=_.algo,R=[],P=O.SHA1=A.extend({_doReset:function(){this._hash=new B.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,D){for(var I=this._hash.words,M=I[0],N=I[1],k=I[2],F=I[3],G=I[4],V=0;V<80;V++){if(V<16)R[V]=E[D+V]|0;else{var j=R[V-3]^R[V-8]^R[V-14]^R[V-16];R[V]=j<<1|j>>>31}var H=(M<<5|M>>>27)+G+R[V];V<20?H+=(N&k|~N&F)+1518500249:V<40?H+=(N^k^F)+1859775393:V<60?H+=(N&k|N&F|k&F)-1894007588:H+=(N^k^F)-899497514,G=F,F=k,k=N<<30|N>>>2,N=M,M=H}I[0]=I[0]+M|0,I[1]=I[1]+N|0,I[2]=I[2]+k|0,I[3]=I[3]+F|0,I[4]=I[4]+G|0},_doFinalize:function(){var E=this._data,D=E.words,I=this._nDataBytes*8,M=E.sigBytes*8;return D[M>>>5]|=128<<24-M%32,D[(M+64>>>9<<4)+14]=Math.floor(I/4294967296),D[(M+64>>>9<<4)+15]=I,E.sigBytes=D.length*4,this._process(),this._hash},clone:function(){var E=A.clone.call(this);return E._hash=this._hash.clone(),E}});_.SHA1=A._createHelper(P),_.HmacSHA1=A._createHmacHelper(P)}(),T.SHA1})}(sha1$1)),sha1$1.exports}var sha256$1={exports:{}},sha256=sha256$1.exports,hasRequiredSha256;function requireSha256(){return hasRequiredSha256||(hasRequiredSha256=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(sha256,function(T){return function(_){var w=T,B=w.lib,A=B.WordArray,O=B.Hasher,R=w.algo,P=[],E=[];(function(){function M(G){for(var V=_.sqrt(G),j=2;j<=V;j++)if(!(G%j))return!1;return!0}function N(G){return(G-(G|0))*4294967296|0}for(var k=2,F=0;F<64;)M(k)&&(F<8&&(P[F]=N(_.pow(k,1/2))),E[F]=N(_.pow(k,1/3)),F++),k++})();var D=[],I=R.SHA256=O.extend({_doReset:function(){this._hash=new A.init(P.slice(0))},_doProcessBlock:function(M,N){for(var k=this._hash.words,F=k[0],G=k[1],V=k[2],j=k[3],H=k[4],U=k[5],X=k[6],Y=k[7],z=0;z<64;z++){if(z<16)D[z]=M[N+z]|0;else{var W=D[z-15],Z=(W<<25|W>>>7)^(W<<14|W>>>18)^W>>>3,Q=D[z-2],ee=(Q<<15|Q>>>17)^(Q<<13|Q>>>19)^Q>>>10;D[z]=Z+D[z-7]+ee+D[z-16]}var te=H&U^~H&X,re=F&G^F&V^G&V,ie=(F<<30|F>>>2)^(F<<19|F>>>13)^(F<<10|F>>>22),ne=(H<<26|H>>>6)^(H<<21|H>>>11)^(H<<7|H>>>25),he=Y+ne+te+E[z]+D[z],pe=ie+re;Y=X,X=U,U=H,H=j+he|0,j=V,V=G,G=F,F=he+pe|0}k[0]=k[0]+F|0,k[1]=k[1]+G|0,k[2]=k[2]+V|0,k[3]=k[3]+j|0,k[4]=k[4]+H|0,k[5]=k[5]+U|0,k[6]=k[6]+X|0,k[7]=k[7]+Y|0},_doFinalize:function(){var M=this._data,N=M.words,k=this._nDataBytes*8,F=M.sigBytes*8;return N[F>>>5]|=128<<24-F%32,N[(F+64>>>9<<4)+14]=_.floor(k/4294967296),N[(F+64>>>9<<4)+15]=k,M.sigBytes=N.length*4,this._process(),this._hash},clone:function(){var M=O.clone.call(this);return M._hash=this._hash.clone(),M}});w.SHA256=O._createHelper(I),w.HmacSHA256=O._createHmacHelper(I)}(Math),T.SHA256})}(sha256$1)),sha256$1.exports}var sha224$1={exports:{}},sha224=sha224$1.exports,hasRequiredSha224;function requireSha224(){return hasRequiredSha224||(hasRequiredSha224=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireSha256())})(sha224,function(T){return function(){var _=T,w=_.lib,B=w.WordArray,A=_.algo,O=A.SHA256,R=A.SHA224=O.extend({_doReset:function(){this._hash=new B.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var P=O._doFinalize.call(this);return P.sigBytes-=4,P}});_.SHA224=O._createHelper(R),_.HmacSHA224=O._createHmacHelper(R)}(),T.SHA224})}(sha224$1)),sha224$1.exports}var sha512$1={exports:{}},sha512=sha512$1.exports,hasRequiredSha512;function requireSha512(){return hasRequiredSha512||(hasRequiredSha512=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireX64Core())})(sha512,function(T){return function(){var _=T,w=_.lib,B=w.Hasher,A=_.x64,O=A.Word,R=A.WordArray,P=_.algo;function E(){return O.create.apply(O,arguments)}var D=[E(1116352408,3609767458),E(1899447441,602891725),E(3049323471,3964484399),E(3921009573,2173295548),E(961987163,4081628472),E(1508970993,3053834265),E(2453635748,2937671579),E(2870763221,3664609560),E(3624381080,2734883394),E(310598401,1164996542),E(607225278,1323610764),E(1426881987,3590304994),E(1925078388,4068182383),E(2162078206,991336113),E(2614888103,633803317),E(3248222580,3479774868),E(3835390401,2666613458),E(4022224774,944711139),E(264347078,2341262773),E(604807628,2007800933),E(770255983,1495990901),E(1249150122,1856431235),E(1555081692,3175218132),E(1996064986,2198950837),E(2554220882,3999719339),E(2821834349,766784016),E(2952996808,2566594879),E(3210313671,3203337956),E(3336571891,1034457026),E(3584528711,2466948901),E(113926993,3758326383),E(338241895,168717936),E(666307205,1188179964),E(773529912,1546045734),E(1294757372,1522805485),E(1396182291,2643833823),E(1695183700,2343527390),E(1986661051,1014477480),E(2177026350,1206759142),E(2456956037,344077627),E(2730485921,1290863460),E(2820302411,3158454273),E(3259730800,3505952657),E(3345764771,106217008),E(3516065817,3606008344),E(3600352804,1432725776),E(4094571909,1467031594),E(275423344,851169720),E(430227734,3100823752),E(506948616,1363258195),E(659060556,3750685593),E(883997877,3785050280),E(958139571,3318307427),E(1322822218,3812723403),E(1537002063,2003034995),E(1747873779,3602036899),E(1955562222,1575990012),E(2024104815,1125592928),E(2227730452,2716904306),E(2361852424,442776044),E(2428436474,593698344),E(2756734187,3733110249),E(3204031479,2999351573),E(3329325298,3815920427),E(3391569614,3928383900),E(3515267271,566280711),E(3940187606,3454069534),E(4118630271,4000239992),E(116418474,1914138554),E(174292421,2731055270),E(289380356,3203993006),E(460393269,320620315),E(685471733,587496836),E(852142971,1086792851),E(1017036298,365543100),E(1126000580,2618297676),E(1288033470,3409855158),E(1501505948,4234509866),E(1607167915,987167468),E(1816402316,1246189591)],I=[];(function(){for(var N=0;N<80;N++)I[N]=E()})();var M=P.SHA512=B.extend({_doReset:function(){this._hash=new R.init([new O.init(1779033703,4089235720),new O.init(3144134277,2227873595),new O.init(1013904242,4271175723),new O.init(2773480762,1595750129),new O.init(1359893119,2917565137),new O.init(2600822924,725511199),new O.init(528734635,4215389547),new O.init(1541459225,327033209)])},_doProcessBlock:function(N,k){for(var F=this._hash.words,G=F[0],V=F[1],j=F[2],H=F[3],U=F[4],X=F[5],Y=F[6],z=F[7],W=G.high,Z=G.low,Q=V.high,ee=V.low,te=j.high,re=j.low,ie=H.high,ne=H.low,he=U.high,pe=U.low,K=X.high,ue=X.low,le=Y.high,ce=Y.low,_e=z.high,oe=z.low,de=W,me=Z,ye=Q,ge=ee,we=te,Te=re,Ee=ie,De=ne,fe=he,Ce=pe,Se=K,be=ue,Re=le,Ve=ce,Pe=_e,ke=oe,Ne=0;Ne<80;Ne++){var Ae,Oe,Fe=I[Ne];if(Ne<16)Oe=Fe.high=N[k+Ne*2]|0,Ae=Fe.low=N[k+Ne*2+1]|0;else{var nt=I[Ne-15],Ze=nt.high,Xe=nt.low,$e=(Ze>>>1|Xe<<31)^(Ze>>>8|Xe<<24)^Ze>>>7,ot=(Xe>>>1|Ze<<31)^(Xe>>>8|Ze<<24)^(Xe>>>7|Ze<<25),ut=I[Ne-2],gt=ut.high,Ue=ut.low,We=(gt>>>19|Ue<<13)^(gt<<3|Ue>>>29)^gt>>>6,ht=(Ue>>>19|gt<<13)^(Ue<<3|gt>>>29)^(Ue>>>6|gt<<26),Be=I[Ne-7],je=Be.high,Qe=Be.low,st=I[Ne-16],pt=st.high,qe=st.low;Ae=ot+Qe,Oe=$e+je+(Ae>>>0<ot>>>0?1:0),Ae=Ae+ht,Oe=Oe+We+(Ae>>>0<ht>>>0?1:0),Ae=Ae+qe,Oe=Oe+pt+(Ae>>>0<qe>>>0?1:0),Fe.high=Oe,Fe.low=Ae}var rt=fe&Se^~fe&Re,bt=Ce&be^~Ce&Ve,Dt=de&ye^de&we^ye&we,Et=me&ge^me&Te^ge&Te,Lt=(de>>>28|me<<4)^(de<<30|me>>>2)^(de<<25|me>>>7),Ot=(me>>>28|de<<4)^(me<<30|de>>>2)^(me<<25|de>>>7),Kt=(fe>>>14|Ce<<18)^(fe>>>18|Ce<<14)^(fe<<23|Ce>>>9),Jt=(Ce>>>14|fe<<18)^(Ce>>>18|fe<<14)^(Ce<<23|fe>>>9),Yt=D[Ne],Wt=Yt.high,rr=Yt.low,Ft=ke+Jt,zt=Pe+Kt+(Ft>>>0<ke>>>0?1:0),Ft=Ft+bt,zt=zt+rt+(Ft>>>0<bt>>>0?1:0),Ft=Ft+rr,zt=zt+Wt+(Ft>>>0<rr>>>0?1:0),Ft=Ft+Ae,zt=zt+Oe+(Ft>>>0<Ae>>>0?1:0),lr=Ot+Et,nr=Lt+Dt+(lr>>>0<Ot>>>0?1:0);Pe=Re,ke=Ve,Re=Se,Ve=be,Se=fe,be=Ce,Ce=De+Ft|0,fe=Ee+zt+(Ce>>>0<De>>>0?1:0)|0,Ee=we,De=Te,we=ye,Te=ge,ye=de,ge=me,me=Ft+lr|0,de=zt+nr+(me>>>0<Ft>>>0?1:0)|0}Z=G.low=Z+me,G.high=W+de+(Z>>>0<me>>>0?1:0),ee=V.low=ee+ge,V.high=Q+ye+(ee>>>0<ge>>>0?1:0),re=j.low=re+Te,j.high=te+we+(re>>>0<Te>>>0?1:0),ne=H.low=ne+De,H.high=ie+Ee+(ne>>>0<De>>>0?1:0),pe=U.low=pe+Ce,U.high=he+fe+(pe>>>0<Ce>>>0?1:0),ue=X.low=ue+be,X.high=K+Se+(ue>>>0<be>>>0?1:0),ce=Y.low=ce+Ve,Y.high=le+Re+(ce>>>0<Ve>>>0?1:0),oe=z.low=oe+ke,z.high=_e+Pe+(oe>>>0<ke>>>0?1:0)},_doFinalize:function(){var N=this._data,k=N.words,F=this._nDataBytes*8,G=N.sigBytes*8;k[G>>>5]|=128<<24-G%32,k[(G+128>>>10<<5)+30]=Math.floor(F/4294967296),k[(G+128>>>10<<5)+31]=F,N.sigBytes=k.length*4,this._process();var V=this._hash.toX32();return V},clone:function(){var N=B.clone.call(this);return N._hash=this._hash.clone(),N},blockSize:1024/32});_.SHA512=B._createHelper(M),_.HmacSHA512=B._createHmacHelper(M)}(),T.SHA512})}(sha512$1)),sha512$1.exports}var sha384$1={exports:{}},sha384=sha384$1.exports,hasRequiredSha384;function requireSha384(){return hasRequiredSha384||(hasRequiredSha384=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireX64Core(),requireSha512())})(sha384,function(T){return function(){var _=T,w=_.x64,B=w.Word,A=w.WordArray,O=_.algo,R=O.SHA512,P=O.SHA384=R.extend({_doReset:function(){this._hash=new A.init([new B.init(3418070365,3238371032),new B.init(1654270250,914150663),new B.init(2438529370,812702999),new B.init(355462360,4144912697),new B.init(1731405415,4290775857),new B.init(2394180231,1750603025),new B.init(3675008525,1694076839),new B.init(1203062813,3204075428)])},_doFinalize:function(){var E=R._doFinalize.call(this);return E.sigBytes-=16,E}});_.SHA384=R._createHelper(P),_.HmacSHA384=R._createHmacHelper(P)}(),T.SHA384})}(sha384$1)),sha384$1.exports}var sha3$1={exports:{}},sha3=sha3$1.exports,hasRequiredSha3;function requireSha3(){return hasRequiredSha3||(hasRequiredSha3=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireX64Core())})(sha3,function(T){return function(_){var w=T,B=w.lib,A=B.WordArray,O=B.Hasher,R=w.x64,P=R.Word,E=w.algo,D=[],I=[],M=[];(function(){for(var F=1,G=0,V=0;V<24;V++){D[F+5*G]=(V+1)*(V+2)/2%64;var j=G%5,H=(2*F+3*G)%5;F=j,G=H}for(var F=0;F<5;F++)for(var G=0;G<5;G++)I[F+5*G]=G+(2*F+3*G)%5*5;for(var U=1,X=0;X<24;X++){for(var Y=0,z=0,W=0;W<7;W++){if(U&1){var Z=(1<<W)-1;Z<32?z^=1<<Z:Y^=1<<Z-32}U&128?U=U<<1^113:U<<=1}M[X]=P.create(Y,z)}})();var N=[];(function(){for(var F=0;F<25;F++)N[F]=P.create()})();var k=E.SHA3=O.extend({cfg:O.cfg.extend({outputLength:512}),_doReset:function(){for(var F=this._state=[],G=0;G<25;G++)F[G]=new P.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(F,G){for(var V=this._state,j=this.blockSize/2,H=0;H<j;H++){var U=F[G+2*H],X=F[G+2*H+1];U=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360,X=(X<<8|X>>>24)&16711935|(X<<24|X>>>8)&4278255360;var Y=V[H];Y.high^=X,Y.low^=U}for(var z=0;z<24;z++){for(var W=0;W<5;W++){for(var Z=0,Q=0,ee=0;ee<5;ee++){var Y=V[W+5*ee];Z^=Y.high,Q^=Y.low}var te=N[W];te.high=Z,te.low=Q}for(var W=0;W<5;W++)for(var re=N[(W+4)%5],ie=N[(W+1)%5],ne=ie.high,he=ie.low,Z=re.high^(ne<<1|he>>>31),Q=re.low^(he<<1|ne>>>31),ee=0;ee<5;ee++){var Y=V[W+5*ee];Y.high^=Z,Y.low^=Q}for(var pe=1;pe<25;pe++){var Z,Q,Y=V[pe],K=Y.high,ue=Y.low,le=D[pe];le<32?(Z=K<<le|ue>>>32-le,Q=ue<<le|K>>>32-le):(Z=ue<<le-32|K>>>64-le,Q=K<<le-32|ue>>>64-le);var ce=N[I[pe]];ce.high=Z,ce.low=Q}var _e=N[0],oe=V[0];_e.high=oe.high,_e.low=oe.low;for(var W=0;W<5;W++)for(var ee=0;ee<5;ee++){var pe=W+5*ee,Y=V[pe],de=N[pe],me=N[(W+1)%5+5*ee],ye=N[(W+2)%5+5*ee];Y.high=de.high^~me.high&ye.high,Y.low=de.low^~me.low&ye.low}var Y=V[0],ge=M[z];Y.high^=ge.high,Y.low^=ge.low}},_doFinalize:function(){var F=this._data,G=F.words;this._nDataBytes*8;var V=F.sigBytes*8,j=this.blockSize*32;G[V>>>5]|=1<<24-V%32,G[(_.ceil((V+1)/j)*j>>>5)-1]|=128,F.sigBytes=G.length*4,this._process();for(var H=this._state,U=this.cfg.outputLength/8,X=U/8,Y=[],z=0;z<X;z++){var W=H[z],Z=W.high,Q=W.low;Z=(Z<<8|Z>>>24)&16711935|(Z<<24|Z>>>8)&4278255360,Q=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360,Y.push(Q),Y.push(Z)}return new A.init(Y,U)},clone:function(){for(var F=O.clone.call(this),G=F._state=this._state.slice(0),V=0;V<25;V++)G[V]=G[V].clone();return F}});w.SHA3=O._createHelper(k),w.HmacSHA3=O._createHmacHelper(k)}(Math),T.SHA3})}(sha3$1)),sha3$1.exports}var ripemd160$1={exports:{}},ripemd160=ripemd160$1.exports,hasRequiredRipemd160;function requireRipemd160(){return hasRequiredRipemd160||(hasRequiredRipemd160=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(ripemd160,function(T){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(_){var w=T,B=w.lib,A=B.WordArray,O=B.Hasher,R=w.algo,P=A.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),E=A.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),D=A.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),I=A.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),M=A.create([0,1518500249,1859775393,2400959708,2840853838]),N=A.create([1352829926,1548603684,1836072691,2053994217,0]),k=R.RIPEMD160=O.extend({_doReset:function(){this._hash=A.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(X,Y){for(var z=0;z<16;z++){var W=Y+z,Z=X[W];X[W]=(Z<<8|Z>>>24)&16711935|(Z<<24|Z>>>8)&4278255360}var Q=this._hash.words,ee=M.words,te=N.words,re=P.words,ie=E.words,ne=D.words,he=I.words,pe,K,ue,le,ce,_e,oe,de,me,ye;_e=pe=Q[0],oe=K=Q[1],de=ue=Q[2],me=le=Q[3],ye=ce=Q[4];for(var ge,z=0;z<80;z+=1)ge=pe+X[Y+re[z]]|0,z<16?ge+=F(K,ue,le)+ee[0]:z<32?ge+=G(K,ue,le)+ee[1]:z<48?ge+=V(K,ue,le)+ee[2]:z<64?ge+=j(K,ue,le)+ee[3]:ge+=H(K,ue,le)+ee[4],ge=ge|0,ge=U(ge,ne[z]),ge=ge+ce|0,pe=ce,ce=le,le=U(ue,10),ue=K,K=ge,ge=_e+X[Y+ie[z]]|0,z<16?ge+=H(oe,de,me)+te[0]:z<32?ge+=j(oe,de,me)+te[1]:z<48?ge+=V(oe,de,me)+te[2]:z<64?ge+=G(oe,de,me)+te[3]:ge+=F(oe,de,me)+te[4],ge=ge|0,ge=U(ge,he[z]),ge=ge+ye|0,_e=ye,ye=me,me=U(de,10),de=oe,oe=ge;ge=Q[1]+ue+me|0,Q[1]=Q[2]+le+ye|0,Q[2]=Q[3]+ce+_e|0,Q[3]=Q[4]+pe+oe|0,Q[4]=Q[0]+K+de|0,Q[0]=ge},_doFinalize:function(){var X=this._data,Y=X.words,z=this._nDataBytes*8,W=X.sigBytes*8;Y[W>>>5]|=128<<24-W%32,Y[(W+64>>>9<<4)+14]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360,X.sigBytes=(Y.length+1)*4,this._process();for(var Z=this._hash,Q=Z.words,ee=0;ee<5;ee++){var te=Q[ee];Q[ee]=(te<<8|te>>>24)&16711935|(te<<24|te>>>8)&4278255360}return Z},clone:function(){var X=O.clone.call(this);return X._hash=this._hash.clone(),X}});function F(X,Y,z){return X^Y^z}function G(X,Y,z){return X&Y|~X&z}function V(X,Y,z){return(X|~Y)^z}function j(X,Y,z){return X&z|Y&~z}function H(X,Y,z){return X^(Y|~z)}function U(X,Y){return X<<Y|X>>>32-Y}w.RIPEMD160=O._createHelper(k),w.HmacRIPEMD160=O._createHmacHelper(k)}(),T.RIPEMD160})}(ripemd160$1)),ripemd160$1.exports}var hmac$1={exports:{}},hmac=hmac$1.exports,hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,function(L,S){(function(T,_){L.exports=_(requireCore())})(hmac,function(T){(function(){var _=T,w=_.lib,B=w.Base,A=_.enc,O=A.Utf8,R=_.algo;R.HMAC=B.extend({init:function(P,E){P=this._hasher=new P.init,typeof E=="string"&&(E=O.parse(E));var D=P.blockSize,I=D*4;E.sigBytes>I&&(E=P.finalize(E)),E.clamp();for(var M=this._oKey=E.clone(),N=this._iKey=E.clone(),k=M.words,F=N.words,G=0;G<D;G++)k[G]^=1549556828,F[G]^=909522486;M.sigBytes=N.sigBytes=I,this.reset()},reset:function(){var P=this._hasher;P.reset(),P.update(this._iKey)},update:function(P){return this._hasher.update(P),this},finalize:function(P){var E=this._hasher,D=E.finalize(P);E.reset();var I=E.finalize(this._oKey.clone().concat(D));return I}})})()})}(hmac$1)),hmac$1.exports}var pbkdf2$1={exports:{}},pbkdf2=pbkdf2$1.exports,hasRequiredPbkdf2;function requirePbkdf2(){return hasRequiredPbkdf2||(hasRequiredPbkdf2=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireSha256(),requireHmac())})(pbkdf2,function(T){return function(){var _=T,w=_.lib,B=w.Base,A=w.WordArray,O=_.algo,R=O.SHA256,P=O.HMAC,E=O.PBKDF2=B.extend({cfg:B.extend({keySize:128/32,hasher:R,iterations:25e4}),init:function(D){this.cfg=this.cfg.extend(D)},compute:function(D,I){for(var M=this.cfg,N=P.create(M.hasher,D),k=A.create(),F=A.create([1]),G=k.words,V=F.words,j=M.keySize,H=M.iterations;G.length<j;){var U=N.update(I).finalize(F);N.reset();for(var X=U.words,Y=X.length,z=U,W=1;W<H;W++){z=N.finalize(z),N.reset();for(var Z=z.words,Q=0;Q<Y;Q++)X[Q]^=Z[Q]}k.concat(U),V[0]++}return k.sigBytes=j*4,k}});_.PBKDF2=function(D,I,M){return E.create(M).compute(D,I)}}(),T.PBKDF2})}(pbkdf2$1)),pbkdf2$1.exports}var evpkdf$1={exports:{}},evpkdf=evpkdf$1.exports,hasRequiredEvpkdf;function requireEvpkdf(){return hasRequiredEvpkdf||(hasRequiredEvpkdf=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireSha1(),requireHmac())})(evpkdf,function(T){return function(){var _=T,w=_.lib,B=w.Base,A=w.WordArray,O=_.algo,R=O.MD5,P=O.EvpKDF=B.extend({cfg:B.extend({keySize:128/32,hasher:R,iterations:1}),init:function(E){this.cfg=this.cfg.extend(E)},compute:function(E,D){for(var I,M=this.cfg,N=M.hasher.create(),k=A.create(),F=k.words,G=M.keySize,V=M.iterations;F.length<G;){I&&N.update(I),I=N.update(E).finalize(D),N.reset();for(var j=1;j<V;j++)I=N.finalize(I),N.reset();k.concat(I)}return k.sigBytes=G*4,k}});_.EvpKDF=function(E,D,I){return P.create(I).compute(E,D)}}(),T.EvpKDF})}(evpkdf$1)),evpkdf$1.exports}var cipherCore$1={exports:{}},cipherCore=cipherCore$1.exports,hasRequiredCipherCore;function requireCipherCore(){return hasRequiredCipherCore||(hasRequiredCipherCore=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireEvpkdf())})(cipherCore,function(T){T.lib.Cipher||function(_){var w=T,B=w.lib,A=B.Base,O=B.WordArray,R=B.BufferedBlockAlgorithm,P=w.enc;P.Utf8;var E=P.Base64,D=w.algo,I=D.EvpKDF,M=B.Cipher=R.extend({cfg:A.extend(),createEncryptor:function(Z,Q){return this.create(this._ENC_XFORM_MODE,Z,Q)},createDecryptor:function(Z,Q){return this.create(this._DEC_XFORM_MODE,Z,Q)},init:function(Z,Q,ee){this.cfg=this.cfg.extend(ee),this._xformMode=Z,this._key=Q,this.reset()},reset:function(){R.reset.call(this),this._doReset()},process:function(Z){return this._append(Z),this._process()},finalize:function(Z){Z&&this._append(Z);var Q=this._doFinalize();return Q},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Z(Q){return typeof Q=="string"?W:X}return function(Q){return{encrypt:function(ee,te,re){return Z(te).encrypt(Q,ee,te,re)},decrypt:function(ee,te,re){return Z(te).decrypt(Q,ee,te,re)}}}}()});B.StreamCipher=M.extend({_doFinalize:function(){var Z=this._process(!0);return Z},blockSize:1});var N=w.mode={},k=B.BlockCipherMode=A.extend({createEncryptor:function(Z,Q){return this.Encryptor.create(Z,Q)},createDecryptor:function(Z,Q){return this.Decryptor.create(Z,Q)},init:function(Z,Q){this._cipher=Z,this._iv=Q}}),F=N.CBC=function(){var Z=k.extend();Z.Encryptor=Z.extend({processBlock:function(ee,te){var re=this._cipher,ie=re.blockSize;Q.call(this,ee,te,ie),re.encryptBlock(ee,te),this._prevBlock=ee.slice(te,te+ie)}}),Z.Decryptor=Z.extend({processBlock:function(ee,te){var re=this._cipher,ie=re.blockSize,ne=ee.slice(te,te+ie);re.decryptBlock(ee,te),Q.call(this,ee,te,ie),this._prevBlock=ne}});function Q(ee,te,re){var ie,ne=this._iv;ne?(ie=ne,this._iv=_):ie=this._prevBlock;for(var he=0;he<re;he++)ee[te+he]^=ie[he]}return Z}(),G=w.pad={},V=G.Pkcs7={pad:function(Z,Q){for(var ee=Q*4,te=ee-Z.sigBytes%ee,re=te<<24|te<<16|te<<8|te,ie=[],ne=0;ne<te;ne+=4)ie.push(re);var he=O.create(ie,te);Z.concat(he)},unpad:function(Z){var Q=Z.words[Z.sigBytes-1>>>2]&255;Z.sigBytes-=Q}};B.BlockCipher=M.extend({cfg:M.cfg.extend({mode:F,padding:V}),reset:function(){var Z;M.reset.call(this);var Q=this.cfg,ee=Q.iv,te=Q.mode;this._xformMode==this._ENC_XFORM_MODE?Z=te.createEncryptor:(Z=te.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Z?this._mode.init(this,ee&&ee.words):(this._mode=Z.call(te,this,ee&&ee.words),this._mode.__creator=Z)},_doProcessBlock:function(Z,Q){this._mode.processBlock(Z,Q)},_doFinalize:function(){var Z,Q=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Q.pad(this._data,this.blockSize),Z=this._process(!0)):(Z=this._process(!0),Q.unpad(Z)),Z},blockSize:128/32});var j=B.CipherParams=A.extend({init:function(Z){this.mixIn(Z)},toString:function(Z){return(Z||this.formatter).stringify(this)}}),H=w.format={},U=H.OpenSSL={stringify:function(Z){var Q,ee=Z.ciphertext,te=Z.salt;return te?Q=O.create([1398893684,1701076831]).concat(te).concat(ee):Q=ee,Q.toString(E)},parse:function(Z){var Q,ee=E.parse(Z),te=ee.words;return te[0]==1398893684&&te[1]==1701076831&&(Q=O.create(te.slice(2,4)),te.splice(0,4),ee.sigBytes-=16),j.create({ciphertext:ee,salt:Q})}},X=B.SerializableCipher=A.extend({cfg:A.extend({format:U}),encrypt:function(Z,Q,ee,te){te=this.cfg.extend(te);var re=Z.createEncryptor(ee,te),ie=re.finalize(Q),ne=re.cfg;return j.create({ciphertext:ie,key:ee,iv:ne.iv,algorithm:Z,mode:ne.mode,padding:ne.padding,blockSize:Z.blockSize,formatter:te.format})},decrypt:function(Z,Q,ee,te){te=this.cfg.extend(te),Q=this._parse(Q,te.format);var re=Z.createDecryptor(ee,te).finalize(Q.ciphertext);return re},_parse:function(Z,Q){return typeof Z=="string"?Q.parse(Z,this):Z}}),Y=w.kdf={},z=Y.OpenSSL={execute:function(Z,Q,ee,te,re){if(te||(te=O.random(64/8)),re)var ie=I.create({keySize:Q+ee,hasher:re}).compute(Z,te);else var ie=I.create({keySize:Q+ee}).compute(Z,te);var ne=O.create(ie.words.slice(Q),ee*4);return ie.sigBytes=Q*4,j.create({key:ie,iv:ne,salt:te})}},W=B.PasswordBasedCipher=X.extend({cfg:X.cfg.extend({kdf:z}),encrypt:function(Z,Q,ee,te){te=this.cfg.extend(te);var re=te.kdf.execute(ee,Z.keySize,Z.ivSize,te.salt,te.hasher);te.iv=re.iv;var ie=X.encrypt.call(this,Z,Q,re.key,te);return ie.mixIn(re),ie},decrypt:function(Z,Q,ee,te){te=this.cfg.extend(te),Q=this._parse(Q,te.format);var re=te.kdf.execute(ee,Z.keySize,Z.ivSize,Q.salt,te.hasher);te.iv=re.iv;var ie=X.decrypt.call(this,Z,Q,re.key,te);return ie}})}()})}(cipherCore$1)),cipherCore$1.exports}var modeCfb$1={exports:{}},modeCfb=modeCfb$1.exports,hasRequiredModeCfb;function requireModeCfb(){return hasRequiredModeCfb||(hasRequiredModeCfb=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(modeCfb,function(T){return T.mode.CFB=function(){var _=T.lib.BlockCipherMode.extend();_.Encryptor=_.extend({processBlock:function(B,A){var O=this._cipher,R=O.blockSize;w.call(this,B,A,R,O),this._prevBlock=B.slice(A,A+R)}}),_.Decryptor=_.extend({processBlock:function(B,A){var O=this._cipher,R=O.blockSize,P=B.slice(A,A+R);w.call(this,B,A,R,O),this._prevBlock=P}});function w(B,A,O,R){var P,E=this._iv;E?(P=E.slice(0),this._iv=void 0):P=this._prevBlock,R.encryptBlock(P,0);for(var D=0;D<O;D++)B[A+D]^=P[D]}return _}(),T.mode.CFB})}(modeCfb$1)),modeCfb$1.exports}var modeCtr$1={exports:{}},modeCtr=modeCtr$1.exports,hasRequiredModeCtr;function requireModeCtr(){return hasRequiredModeCtr||(hasRequiredModeCtr=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(modeCtr,function(T){return T.mode.CTR=function(){var _=T.lib.BlockCipherMode.extend(),w=_.Encryptor=_.extend({processBlock:function(B,A){var O=this._cipher,R=O.blockSize,P=this._iv,E=this._counter;P&&(E=this._counter=P.slice(0),this._iv=void 0);var D=E.slice(0);O.encryptBlock(D,0),E[R-1]=E[R-1]+1|0;for(var I=0;I<R;I++)B[A+I]^=D[I]}});return _.Decryptor=w,_}(),T.mode.CTR})}(modeCtr$1)),modeCtr$1.exports}var modeCtrGladman$1={exports:{}},modeCtrGladman=modeCtrGladman$1.exports,hasRequiredModeCtrGladman;function requireModeCtrGladman(){return hasRequiredModeCtrGladman||(hasRequiredModeCtrGladman=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(modeCtrGladman,function(T){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return T.mode.CTRGladman=function(){var _=T.lib.BlockCipherMode.extend();function w(O){if((O>>24&255)===255){var R=O>>16&255,P=O>>8&255,E=O&255;R===255?(R=0,P===255?(P=0,E===255?E=0:++E):++P):++R,O=0,O+=R<<16,O+=P<<8,O+=E}else O+=1<<24;return O}function B(O){return(O[0]=w(O[0]))===0&&(O[1]=w(O[1])),O}var A=_.Encryptor=_.extend({processBlock:function(O,R){var P=this._cipher,E=P.blockSize,D=this._iv,I=this._counter;D&&(I=this._counter=D.slice(0),this._iv=void 0),B(I);var M=I.slice(0);P.encryptBlock(M,0);for(var N=0;N<E;N++)O[R+N]^=M[N]}});return _.Decryptor=A,_}(),T.mode.CTRGladman})}(modeCtrGladman$1)),modeCtrGladman$1.exports}var modeOfb$1={exports:{}},modeOfb=modeOfb$1.exports,hasRequiredModeOfb;function requireModeOfb(){return hasRequiredModeOfb||(hasRequiredModeOfb=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(modeOfb,function(T){return T.mode.OFB=function(){var _=T.lib.BlockCipherMode.extend(),w=_.Encryptor=_.extend({processBlock:function(B,A){var O=this._cipher,R=O.blockSize,P=this._iv,E=this._keystream;P&&(E=this._keystream=P.slice(0),this._iv=void 0),O.encryptBlock(E,0);for(var D=0;D<R;D++)B[A+D]^=E[D]}});return _.Decryptor=w,_}(),T.mode.OFB})}(modeOfb$1)),modeOfb$1.exports}var modeEcb$1={exports:{}},modeEcb=modeEcb$1.exports,hasRequiredModeEcb;function requireModeEcb(){return hasRequiredModeEcb||(hasRequiredModeEcb=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(modeEcb,function(T){return T.mode.ECB=function(){var _=T.lib.BlockCipherMode.extend();return _.Encryptor=_.extend({processBlock:function(w,B){this._cipher.encryptBlock(w,B)}}),_.Decryptor=_.extend({processBlock:function(w,B){this._cipher.decryptBlock(w,B)}}),_}(),T.mode.ECB})}(modeEcb$1)),modeEcb$1.exports}var padAnsix923$1={exports:{}},padAnsix923=padAnsix923$1.exports,hasRequiredPadAnsix923;function requirePadAnsix923(){return hasRequiredPadAnsix923||(hasRequiredPadAnsix923=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(padAnsix923,function(T){return T.pad.AnsiX923={pad:function(_,w){var B=_.sigBytes,A=w*4,O=A-B%A,R=B+O-1;_.clamp(),_.words[R>>>2]|=O<<24-R%4*8,_.sigBytes+=O},unpad:function(_){var w=_.words[_.sigBytes-1>>>2]&255;_.sigBytes-=w}},T.pad.Ansix923})}(padAnsix923$1)),padAnsix923$1.exports}var padIso10126$1={exports:{}},padIso10126=padIso10126$1.exports,hasRequiredPadIso10126;function requirePadIso10126(){return hasRequiredPadIso10126||(hasRequiredPadIso10126=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(padIso10126,function(T){return T.pad.Iso10126={pad:function(_,w){var B=w*4,A=B-_.sigBytes%B;_.concat(T.lib.WordArray.random(A-1)).concat(T.lib.WordArray.create([A<<24],1))},unpad:function(_){var w=_.words[_.sigBytes-1>>>2]&255;_.sigBytes-=w}},T.pad.Iso10126})}(padIso10126$1)),padIso10126$1.exports}var padIso97971$1={exports:{}},padIso97971=padIso97971$1.exports,hasRequiredPadIso97971;function requirePadIso97971(){return hasRequiredPadIso97971||(hasRequiredPadIso97971=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(padIso97971,function(T){return T.pad.Iso97971={pad:function(_,w){_.concat(T.lib.WordArray.create([2147483648],1)),T.pad.ZeroPadding.pad(_,w)},unpad:function(_){T.pad.ZeroPadding.unpad(_),_.sigBytes--}},T.pad.Iso97971})}(padIso97971$1)),padIso97971$1.exports}var padZeropadding$1={exports:{}},padZeropadding=padZeropadding$1.exports,hasRequiredPadZeropadding;function requirePadZeropadding(){return hasRequiredPadZeropadding||(hasRequiredPadZeropadding=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(padZeropadding,function(T){return T.pad.ZeroPadding={pad:function(_,w){var B=w*4;_.clamp(),_.sigBytes+=B-(_.sigBytes%B||B)},unpad:function(_){for(var w=_.words,B=_.sigBytes-1,B=_.sigBytes-1;B>=0;B--)if(w[B>>>2]>>>24-B%4*8&255){_.sigBytes=B+1;break}}},T.pad.ZeroPadding})}(padZeropadding$1)),padZeropadding$1.exports}var padNopadding$1={exports:{}},padNopadding=padNopadding$1.exports,hasRequiredPadNopadding;function requirePadNopadding(){return hasRequiredPadNopadding||(hasRequiredPadNopadding=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(padNopadding,function(T){return T.pad.NoPadding={pad:function(){},unpad:function(){}},T.pad.NoPadding})}(padNopadding$1)),padNopadding$1.exports}var formatHex$1={exports:{}},formatHex=formatHex$1.exports,hasRequiredFormatHex;function requireFormatHex(){return hasRequiredFormatHex||(hasRequiredFormatHex=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireCipherCore())})(formatHex,function(T){return function(_){var w=T,B=w.lib,A=B.CipherParams,O=w.enc,R=O.Hex,P=w.format;P.Hex={stringify:function(E){return E.ciphertext.toString(R)},parse:function(E){var D=R.parse(E);return A.create({ciphertext:D})}}}(),T.format.Hex})}(formatHex$1)),formatHex$1.exports}var aes$1={exports:{}},aes=aes$1.exports,hasRequiredAes;function requireAes(){return hasRequiredAes||(hasRequiredAes=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(aes,function(T){return function(){var _=T,w=_.lib,B=w.BlockCipher,A=_.algo,O=[],R=[],P=[],E=[],D=[],I=[],M=[],N=[],k=[],F=[];(function(){for(var j=[],H=0;H<256;H++)H<128?j[H]=H<<1:j[H]=H<<1^283;for(var U=0,X=0,H=0;H<256;H++){var Y=X^X<<1^X<<2^X<<3^X<<4;Y=Y>>>8^Y&255^99,O[U]=Y,R[Y]=U;var z=j[U],W=j[z],Z=j[W],Q=j[Y]*257^Y*16843008;P[U]=Q<<24|Q>>>8,E[U]=Q<<16|Q>>>16,D[U]=Q<<8|Q>>>24,I[U]=Q;var Q=Z*16843009^W*65537^z*257^U*16843008;M[Y]=Q<<24|Q>>>8,N[Y]=Q<<16|Q>>>16,k[Y]=Q<<8|Q>>>24,F[Y]=Q,U?(U=z^j[j[j[Z^z]]],X^=j[j[X]]):U=X=1}})();var G=[0,1,2,4,8,16,32,64,128,27,54],V=A.AES=B.extend({_doReset:function(){var j;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var H=this._keyPriorReset=this._key,U=H.words,X=H.sigBytes/4,Y=this._nRounds=X+6,z=(Y+1)*4,W=this._keySchedule=[],Z=0;Z<z;Z++)Z<X?W[Z]=U[Z]:(j=W[Z-1],Z%X?X>6&&Z%X==4&&(j=O[j>>>24]<<24|O[j>>>16&255]<<16|O[j>>>8&255]<<8|O[j&255]):(j=j<<8|j>>>24,j=O[j>>>24]<<24|O[j>>>16&255]<<16|O[j>>>8&255]<<8|O[j&255],j^=G[Z/X|0]<<24),W[Z]=W[Z-X]^j);for(var Q=this._invKeySchedule=[],ee=0;ee<z;ee++){var Z=z-ee;if(ee%4)var j=W[Z];else var j=W[Z-4];ee<4||Z<=4?Q[ee]=j:Q[ee]=M[O[j>>>24]]^N[O[j>>>16&255]]^k[O[j>>>8&255]]^F[O[j&255]]}}},encryptBlock:function(j,H){this._doCryptBlock(j,H,this._keySchedule,P,E,D,I,O)},decryptBlock:function(j,H){var U=j[H+1];j[H+1]=j[H+3],j[H+3]=U,this._doCryptBlock(j,H,this._invKeySchedule,M,N,k,F,R);var U=j[H+1];j[H+1]=j[H+3],j[H+3]=U},_doCryptBlock:function(j,H,U,X,Y,z,W,Z){for(var Q=this._nRounds,ee=j[H]^U[0],te=j[H+1]^U[1],re=j[H+2]^U[2],ie=j[H+3]^U[3],ne=4,he=1;he<Q;he++){var pe=X[ee>>>24]^Y[te>>>16&255]^z[re>>>8&255]^W[ie&255]^U[ne++],K=X[te>>>24]^Y[re>>>16&255]^z[ie>>>8&255]^W[ee&255]^U[ne++],ue=X[re>>>24]^Y[ie>>>16&255]^z[ee>>>8&255]^W[te&255]^U[ne++],le=X[ie>>>24]^Y[ee>>>16&255]^z[te>>>8&255]^W[re&255]^U[ne++];ee=pe,te=K,re=ue,ie=le}var pe=(Z[ee>>>24]<<24|Z[te>>>16&255]<<16|Z[re>>>8&255]<<8|Z[ie&255])^U[ne++],K=(Z[te>>>24]<<24|Z[re>>>16&255]<<16|Z[ie>>>8&255]<<8|Z[ee&255])^U[ne++],ue=(Z[re>>>24]<<24|Z[ie>>>16&255]<<16|Z[ee>>>8&255]<<8|Z[te&255])^U[ne++],le=(Z[ie>>>24]<<24|Z[ee>>>16&255]<<16|Z[te>>>8&255]<<8|Z[re&255])^U[ne++];j[H]=pe,j[H+1]=K,j[H+2]=ue,j[H+3]=le},keySize:256/32});_.AES=B._createHelper(V)}(),T.AES})}(aes$1)),aes$1.exports}var tripledes$1={exports:{}},tripledes=tripledes$1.exports,hasRequiredTripledes;function requireTripledes(){return hasRequiredTripledes||(hasRequiredTripledes=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(tripledes,function(T){return function(){var _=T,w=_.lib,B=w.WordArray,A=w.BlockCipher,O=_.algo,R=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],P=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],E=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],D=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],I=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],M=O.DES=A.extend({_doReset:function(){for(var G=this._key,V=G.words,j=[],H=0;H<56;H++){var U=R[H]-1;j[H]=V[U>>>5]>>>31-U%32&1}for(var X=this._subKeys=[],Y=0;Y<16;Y++){for(var z=X[Y]=[],W=E[Y],H=0;H<24;H++)z[H/6|0]|=j[(P[H]-1+W)%28]<<31-H%6,z[4+(H/6|0)]|=j[28+(P[H+24]-1+W)%28]<<31-H%6;z[0]=z[0]<<1|z[0]>>>31;for(var H=1;H<7;H++)z[H]=z[H]>>>(H-1)*4+3;z[7]=z[7]<<5|z[7]>>>27}for(var Z=this._invSubKeys=[],H=0;H<16;H++)Z[H]=X[15-H]},encryptBlock:function(G,V){this._doCryptBlock(G,V,this._subKeys)},decryptBlock:function(G,V){this._doCryptBlock(G,V,this._invSubKeys)},_doCryptBlock:function(G,V,j){this._lBlock=G[V],this._rBlock=G[V+1],N.call(this,4,252645135),N.call(this,16,65535),k.call(this,2,858993459),k.call(this,8,16711935),N.call(this,1,1431655765);for(var H=0;H<16;H++){for(var U=j[H],X=this._lBlock,Y=this._rBlock,z=0,W=0;W<8;W++)z|=D[W][((Y^U[W])&I[W])>>>0];this._lBlock=Y,this._rBlock=X^z}var Z=this._lBlock;this._lBlock=this._rBlock,this._rBlock=Z,N.call(this,1,1431655765),k.call(this,8,16711935),k.call(this,2,858993459),N.call(this,16,65535),N.call(this,4,252645135),G[V]=this._lBlock,G[V+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function N(G,V){var j=(this._lBlock>>>G^this._rBlock)&V;this._rBlock^=j,this._lBlock^=j<<G}function k(G,V){var j=(this._rBlock>>>G^this._lBlock)&V;this._lBlock^=j,this._rBlock^=j<<G}_.DES=A._createHelper(M);var F=O.TripleDES=A.extend({_doReset:function(){var G=this._key,V=G.words;if(V.length!==2&&V.length!==4&&V.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var j=V.slice(0,2),H=V.length<4?V.slice(0,2):V.slice(2,4),U=V.length<6?V.slice(0,2):V.slice(4,6);this._des1=M.createEncryptor(B.create(j)),this._des2=M.createEncryptor(B.create(H)),this._des3=M.createEncryptor(B.create(U))},encryptBlock:function(G,V){this._des1.encryptBlock(G,V),this._des2.decryptBlock(G,V),this._des3.encryptBlock(G,V)},decryptBlock:function(G,V){this._des3.decryptBlock(G,V),this._des2.encryptBlock(G,V),this._des1.decryptBlock(G,V)},keySize:192/32,ivSize:64/32,blockSize:64/32});_.TripleDES=A._createHelper(F)}(),T.TripleDES})}(tripledes$1)),tripledes$1.exports}var rc4$1={exports:{}},rc4=rc4$1.exports,hasRequiredRc4;function requireRc4(){return hasRequiredRc4||(hasRequiredRc4=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(rc4,function(T){return function(){var _=T,w=_.lib,B=w.StreamCipher,A=_.algo,O=A.RC4=B.extend({_doReset:function(){for(var E=this._key,D=E.words,I=E.sigBytes,M=this._S=[],N=0;N<256;N++)M[N]=N;for(var N=0,k=0;N<256;N++){var F=N%I,G=D[F>>>2]>>>24-F%4*8&255;k=(k+M[N]+G)%256;var V=M[N];M[N]=M[k],M[k]=V}this._i=this._j=0},_doProcessBlock:function(E,D){E[D]^=R.call(this)},keySize:256/32,ivSize:0});function R(){for(var E=this._S,D=this._i,I=this._j,M=0,N=0;N<4;N++){D=(D+1)%256,I=(I+E[D])%256;var k=E[D];E[D]=E[I],E[I]=k,M|=E[(E[D]+E[I])%256]<<24-N*8}return this._i=D,this._j=I,M}_.RC4=B._createHelper(O);var P=A.RC4Drop=O.extend({cfg:O.cfg.extend({drop:192}),_doReset:function(){O._doReset.call(this);for(var E=this.cfg.drop;E>0;E--)R.call(this)}});_.RC4Drop=B._createHelper(P)}(),T.RC4})}(rc4$1)),rc4$1.exports}var rabbit$1={exports:{}},rabbit=rabbit$1.exports,hasRequiredRabbit;function requireRabbit(){return hasRequiredRabbit||(hasRequiredRabbit=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(rabbit,function(T){return function(){var _=T,w=_.lib,B=w.StreamCipher,A=_.algo,O=[],R=[],P=[],E=A.Rabbit=B.extend({_doReset:function(){for(var I=this._key.words,M=this.cfg.iv,N=0;N<4;N++)I[N]=(I[N]<<8|I[N]>>>24)&16711935|(I[N]<<24|I[N]>>>8)&4278255360;var k=this._X=[I[0],I[3]<<16|I[2]>>>16,I[1],I[0]<<16|I[3]>>>16,I[2],I[1]<<16|I[0]>>>16,I[3],I[2]<<16|I[1]>>>16],F=this._C=[I[2]<<16|I[2]>>>16,I[0]&4294901760|I[1]&65535,I[3]<<16|I[3]>>>16,I[1]&4294901760|I[2]&65535,I[0]<<16|I[0]>>>16,I[2]&4294901760|I[3]&65535,I[1]<<16|I[1]>>>16,I[3]&4294901760|I[0]&65535];this._b=0;for(var N=0;N<4;N++)D.call(this);for(var N=0;N<8;N++)F[N]^=k[N+4&7];if(M){var G=M.words,V=G[0],j=G[1],H=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,U=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,X=H>>>16|U&4294901760,Y=U<<16|H&65535;F[0]^=H,F[1]^=X,F[2]^=U,F[3]^=Y,F[4]^=H,F[5]^=X,F[6]^=U,F[7]^=Y;for(var N=0;N<4;N++)D.call(this)}},_doProcessBlock:function(I,M){var N=this._X;D.call(this),O[0]=N[0]^N[5]>>>16^N[3]<<16,O[1]=N[2]^N[7]>>>16^N[5]<<16,O[2]=N[4]^N[1]>>>16^N[7]<<16,O[3]=N[6]^N[3]>>>16^N[1]<<16;for(var k=0;k<4;k++)O[k]=(O[k]<<8|O[k]>>>24)&16711935|(O[k]<<24|O[k]>>>8)&4278255360,I[M+k]^=O[k]},blockSize:128/32,ivSize:64/32});function D(){for(var I=this._X,M=this._C,N=0;N<8;N++)R[N]=M[N];M[0]=M[0]+1295307597+this._b|0,M[1]=M[1]+3545052371+(M[0]>>>0<R[0]>>>0?1:0)|0,M[2]=M[2]+886263092+(M[1]>>>0<R[1]>>>0?1:0)|0,M[3]=M[3]+1295307597+(M[2]>>>0<R[2]>>>0?1:0)|0,M[4]=M[4]+3545052371+(M[3]>>>0<R[3]>>>0?1:0)|0,M[5]=M[5]+886263092+(M[4]>>>0<R[4]>>>0?1:0)|0,M[6]=M[6]+1295307597+(M[5]>>>0<R[5]>>>0?1:0)|0,M[7]=M[7]+3545052371+(M[6]>>>0<R[6]>>>0?1:0)|0,this._b=M[7]>>>0<R[7]>>>0?1:0;for(var N=0;N<8;N++){var k=I[N]+M[N],F=k&65535,G=k>>>16,V=((F*F>>>17)+F*G>>>15)+G*G,j=((k&4294901760)*k|0)+((k&65535)*k|0);P[N]=V^j}I[0]=P[0]+(P[7]<<16|P[7]>>>16)+(P[6]<<16|P[6]>>>16)|0,I[1]=P[1]+(P[0]<<8|P[0]>>>24)+P[7]|0,I[2]=P[2]+(P[1]<<16|P[1]>>>16)+(P[0]<<16|P[0]>>>16)|0,I[3]=P[3]+(P[2]<<8|P[2]>>>24)+P[1]|0,I[4]=P[4]+(P[3]<<16|P[3]>>>16)+(P[2]<<16|P[2]>>>16)|0,I[5]=P[5]+(P[4]<<8|P[4]>>>24)+P[3]|0,I[6]=P[6]+(P[5]<<16|P[5]>>>16)+(P[4]<<16|P[4]>>>16)|0,I[7]=P[7]+(P[6]<<8|P[6]>>>24)+P[5]|0}_.Rabbit=B._createHelper(E)}(),T.Rabbit})}(rabbit$1)),rabbit$1.exports}var rabbitLegacy$1={exports:{}},rabbitLegacy=rabbitLegacy$1.exports,hasRequiredRabbitLegacy;function requireRabbitLegacy(){return hasRequiredRabbitLegacy||(hasRequiredRabbitLegacy=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(rabbitLegacy,function(T){return function(){var _=T,w=_.lib,B=w.StreamCipher,A=_.algo,O=[],R=[],P=[],E=A.RabbitLegacy=B.extend({_doReset:function(){var I=this._key.words,M=this.cfg.iv,N=this._X=[I[0],I[3]<<16|I[2]>>>16,I[1],I[0]<<16|I[3]>>>16,I[2],I[1]<<16|I[0]>>>16,I[3],I[2]<<16|I[1]>>>16],k=this._C=[I[2]<<16|I[2]>>>16,I[0]&4294901760|I[1]&65535,I[3]<<16|I[3]>>>16,I[1]&4294901760|I[2]&65535,I[0]<<16|I[0]>>>16,I[2]&4294901760|I[3]&65535,I[1]<<16|I[1]>>>16,I[3]&4294901760|I[0]&65535];this._b=0;for(var F=0;F<4;F++)D.call(this);for(var F=0;F<8;F++)k[F]^=N[F+4&7];if(M){var G=M.words,V=G[0],j=G[1],H=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,U=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,X=H>>>16|U&4294901760,Y=U<<16|H&65535;k[0]^=H,k[1]^=X,k[2]^=U,k[3]^=Y,k[4]^=H,k[5]^=X,k[6]^=U,k[7]^=Y;for(var F=0;F<4;F++)D.call(this)}},_doProcessBlock:function(I,M){var N=this._X;D.call(this),O[0]=N[0]^N[5]>>>16^N[3]<<16,O[1]=N[2]^N[7]>>>16^N[5]<<16,O[2]=N[4]^N[1]>>>16^N[7]<<16,O[3]=N[6]^N[3]>>>16^N[1]<<16;for(var k=0;k<4;k++)O[k]=(O[k]<<8|O[k]>>>24)&16711935|(O[k]<<24|O[k]>>>8)&4278255360,I[M+k]^=O[k]},blockSize:128/32,ivSize:64/32});function D(){for(var I=this._X,M=this._C,N=0;N<8;N++)R[N]=M[N];M[0]=M[0]+1295307597+this._b|0,M[1]=M[1]+3545052371+(M[0]>>>0<R[0]>>>0?1:0)|0,M[2]=M[2]+886263092+(M[1]>>>0<R[1]>>>0?1:0)|0,M[3]=M[3]+1295307597+(M[2]>>>0<R[2]>>>0?1:0)|0,M[4]=M[4]+3545052371+(M[3]>>>0<R[3]>>>0?1:0)|0,M[5]=M[5]+886263092+(M[4]>>>0<R[4]>>>0?1:0)|0,M[6]=M[6]+1295307597+(M[5]>>>0<R[5]>>>0?1:0)|0,M[7]=M[7]+3545052371+(M[6]>>>0<R[6]>>>0?1:0)|0,this._b=M[7]>>>0<R[7]>>>0?1:0;for(var N=0;N<8;N++){var k=I[N]+M[N],F=k&65535,G=k>>>16,V=((F*F>>>17)+F*G>>>15)+G*G,j=((k&4294901760)*k|0)+((k&65535)*k|0);P[N]=V^j}I[0]=P[0]+(P[7]<<16|P[7]>>>16)+(P[6]<<16|P[6]>>>16)|0,I[1]=P[1]+(P[0]<<8|P[0]>>>24)+P[7]|0,I[2]=P[2]+(P[1]<<16|P[1]>>>16)+(P[0]<<16|P[0]>>>16)|0,I[3]=P[3]+(P[2]<<8|P[2]>>>24)+P[1]|0,I[4]=P[4]+(P[3]<<16|P[3]>>>16)+(P[2]<<16|P[2]>>>16)|0,I[5]=P[5]+(P[4]<<8|P[4]>>>24)+P[3]|0,I[6]=P[6]+(P[5]<<16|P[5]>>>16)+(P[4]<<16|P[4]>>>16)|0,I[7]=P[7]+(P[6]<<8|P[6]>>>24)+P[5]|0}_.RabbitLegacy=B._createHelper(E)}(),T.RabbitLegacy})}(rabbitLegacy$1)),rabbitLegacy$1.exports}var blowfish$1={exports:{}},blowfish=blowfish$1.exports,hasRequiredBlowfish;function requireBlowfish(){return hasRequiredBlowfish||(hasRequiredBlowfish=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(blowfish,function(T){return function(){var _=T,w=_.lib,B=w.BlockCipher,A=_.algo;const O=16,R=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],P=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var E={pbox:[],sbox:[]};function D(F,G){let V=G>>24&255,j=G>>16&255,H=G>>8&255,U=G&255,X=F.sbox[0][V]+F.sbox[1][j];return X=X^F.sbox[2][H],X=X+F.sbox[3][U],X}function I(F,G,V){let j=G,H=V,U;for(let X=0;X<O;++X)j=j^F.pbox[X],H=D(F,j)^H,U=j,j=H,H=U;return U=j,j=H,H=U,H=H^F.pbox[O],j=j^F.pbox[O+1],{left:j,right:H}}function M(F,G,V){let j=G,H=V,U;for(let X=O+1;X>1;--X)j=j^F.pbox[X],H=D(F,j)^H,U=j,j=H,H=U;return U=j,j=H,H=U,H=H^F.pbox[1],j=j^F.pbox[0],{left:j,right:H}}function N(F,G,V){for(let Y=0;Y<4;Y++){F.sbox[Y]=[];for(let z=0;z<256;z++)F.sbox[Y][z]=P[Y][z]}let j=0;for(let Y=0;Y<O+2;Y++)F.pbox[Y]=R[Y]^G[j],j++,j>=V&&(j=0);let H=0,U=0,X=0;for(let Y=0;Y<O+2;Y+=2)X=I(F,H,U),H=X.left,U=X.right,F.pbox[Y]=H,F.pbox[Y+1]=U;for(let Y=0;Y<4;Y++)for(let z=0;z<256;z+=2)X=I(F,H,U),H=X.left,U=X.right,F.sbox[Y][z]=H,F.sbox[Y][z+1]=U;return!0}var k=A.Blowfish=B.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var F=this._keyPriorReset=this._key,G=F.words,V=F.sigBytes/4;N(E,G,V)}},encryptBlock:function(F,G){var V=I(E,F[G],F[G+1]);F[G]=V.left,F[G+1]=V.right},decryptBlock:function(F,G){var V=M(E,F[G],F[G+1]);F[G]=V.left,F[G+1]=V.right},blockSize:64/32,keySize:128/32,ivSize:64/32});_.Blowfish=B._createHelper(k)}(),T.Blowfish})}(blowfish$1)),blowfish$1.exports}var cryptoJs=cryptoJs$1.exports,hasRequiredCryptoJs;function requireCryptoJs(){return hasRequiredCryptoJs||(hasRequiredCryptoJs=1,function(L,S){(function(T,_,w){L.exports=_(requireCore(),requireX64Core(),requireLibTypedarrays(),requireEncUtf16(),requireEncBase64(),requireEncBase64url(),requireMd5(),requireSha1(),requireSha256(),requireSha224(),requireSha512(),requireSha384(),requireSha3(),requireRipemd160(),requireHmac(),requirePbkdf2(),requireEvpkdf(),requireCipherCore(),requireModeCfb(),requireModeCtr(),requireModeCtrGladman(),requireModeOfb(),requireModeEcb(),requirePadAnsix923(),requirePadIso10126(),requirePadIso97971(),requirePadZeropadding(),requirePadNopadding(),requireFormatHex(),requireAes(),requireTripledes(),requireRc4(),requireRabbit(),requireRabbitLegacy(),requireBlowfish())})(cryptoJs,function(T){return T})}(cryptoJs$1)),cryptoJs$1.exports}var cryptoJsExports=requireCryptoJs();let iatWS,lastWsData=[],resultHandle=null;const config$1={appid:"145d2560",apiSecret:"MTM3ZWQ2Y2Y4ZmEyMTEwYWVmMDg3NmRk",apiKey:"4c75d2411acf143f4145ba8b72a03bdc"};function getWebSocketUrl(){var L="wss://iat-api.xfyun.cn/v2/iat",S="iat-api.xfyun.cn",T=config$1.apiKey,_=config$1.apiSecret,w=new Date().toGMTString(),B="hmac-sha256",A="host date request-line",O="host: ".concat(S,"\ndate: ").concat(w,"\nGET /v2/iat HTTP/1.1"),R=cryptoJsExports.HmacSHA256(O,_),P=cryptoJsExports.enc.Base64.stringify(R),E='api_key="'.concat(T,'", algorithm="').concat(B,'", headers="').concat(A,'", signature="').concat(P,'"'),D=btoa(E);return L="".concat(L,"?authorization=").concat(D,"&date=").concat(w,"&host=").concat(S),L}function toString(L){for(var S="",T=new Uint8Array(L),_=T.byteLength,w=0;w<_;w++)S+=String.fromCharCode(T[w]);return S}function renderResult(L){let S=JSON.parse(L);if(S.data&&S.data.result){let T=S.data.result,_="",w=T.ws;for(let B=0;B<w.length;B++)_=_+w[B].cw[0].w;T.pgs&&(T.pgs==="apd"||T.rst=="rlt"&&(console.log("有时间点的识别结果",T),lastWsData=lastWsData.concat(T.ws)))}S.code===0&&S.data.status===2&&(iatWS.close(),resultHandle!=null&&resultHandle(lastWsData)),S.code!==0&&(iatWS.close(),console.error(S),resultHandle!=null&&resultHandle(lastWsData))}function connectWebSocket(L){const S=getWebSocketUrl();if("WebSocket"in window)iatWS=new WebSocket(S);else if("MozWebSocket"in window)iatWS=new MozWebSocket(S);else{alert("浏览器不支持WebSocket");return}iatWS.onopen=T=>{var _={common:{app_id:config$1.appid},business:{language:"zh_cn",domain:"iat",accent:"mandarin",vad_eos:5e3,dwa:"wpgs"},data:{status:0,format:"audio/L16;rate=16000",encoding:"raw"}};iatWS.send(JSON.stringify(_)),L()},iatWS.onmessage=T=>{renderResult(T.data)},iatWS.onerror=T=>{console.error(T)}}async function convertAudio(L,S){var T="https://cdn.goowee.cn/src/otplib/ffmpeg_asm.js";function _(){var O=URL.createObjectURL(new Blob(['importScripts("'+T+'");var now = Date.now;function print(text) {postMessage({"type" : "stdout","data" : text});};onmessage = function(event) {var message = event.data;if (message.type === "command") {var Module = {print: print,printErr: print,files: message.files || [],arguments: message.arguments || [],TOTAL_MEMORY: message.TOTAL_MEMORY || false};postMessage({"type" : "start","data" : Module.arguments.join(" ")});postMessage({"type" : "stdout","data" : "Received command: " +Module.arguments.join(" ") +((Module.TOTAL_MEMORY) ? ".  Processing with " + Module.TOTAL_MEMORY + " bits." : "")});var time = now();var result = ffmpeg_run(Module);var totalTime = now() - time;postMessage({"type" : "stdout","data" : "Finished processing (took " + totalTime + "ms)"});postMessage({"type" : "done","data" : result,"time" : totalTime});}};postMessage({"type" : "ready"});'],{type:"application/javascript"})),R=new Worker(O);return URL.revokeObjectURL(O),R}var w;function B(O){}function A(O){var R,P=new FileReader;P.onload=function(){R=this.result,E()},P.readAsArrayBuffer(O),w||(w=_()),w.onmessage=function(D){var I=D.data;if(I.type!="ready"){if(I.type=="stdout")I.data;else if(I.type!="start"){if(I.type=="done"){var M=I.data[0],N=new File([M.data],"test.pcm",{type:"audio/pcm"});S!=null&&S(N)}}}};var E=function(){w.postMessage({type:"command",arguments:"-i audio.mp3 -acodec pcm_s16le -f s16le -ac 1 -ar 16000 test.pcm".split(" "),files:[{data:new Uint8Array(R),name:"audio.mp3"}]})}}A(L)}let VoiceCheck$1=class{static setConfig(S,T,_){S!=null&&(config$1.appid=S),T!=null&&(config$1.apiSecret=T),_!=null&&(config$1.apiKey=_)}static async startTestByUrl(S,T){lastWsData=[],resultHandle=T,connectWebSocket(()=>{axios({url:S,method:"GET",responseType:"arraybuffer"}).then(_=>{let w=_.data;var B=new Blob([w],{type:"audio/mp3"});convertAudio(B,async A=>{let O=await A.arrayBuffer();const R=toString(O);let P=0;for(;P<R.length;){const E=R.substring(P,P+1280);P+=1280;const D=P>=R.length;iatWS.send(JSON.stringify({data:{status:D?2:1,format:"audio/L16;rate=16000",encoding:"raw",audio:window.btoa(E)}}))}})})})}};function t$2(L,S,T,_){return new(T||(T=Promise))(function(w,B){function A(P){try{R(_.next(P))}catch(E){B(E)}}function O(P){try{R(_.throw(P))}catch(E){B(E)}}function R(P){var E;P.done?w(P.value):(E=P.value,E instanceof T?E:new T(function(D){D(E)})).then(A,O)}R((_=_.apply(L,S||[])).next())})}let e$1=class{constructor(){this.listeners={}}on(S,T,_){if(this.listeners[S]||(this.listeners[S]=new Set),_==null?void 0:_.once){const w=(...B)=>{this.un(S,w),T(...B)};return this.listeners[S].add(w),()=>this.un(S,w)}return this.listeners[S].add(T),()=>this.un(S,T)}un(S,T){var _;(_=this.listeners[S])===null||_===void 0||_.delete(T)}once(S,T){return this.on(S,T,{once:!0})}unAll(){this.listeners={}}emit(S,...T){this.listeners[S]&&this.listeners[S].forEach(_=>_(...T))}};const i$1={decode:function(L,S){return t$2(this,void 0,void 0,function*(){const T=new AudioContext({sampleRate:S});try{return yield T.decodeAudioData(L)}finally{T.close()}})},createBuffer:function(L,S){if(!L||L.length===0)throw new Error("channelData must be a non-empty array");if(S<=0)throw new Error("duration must be greater than 0");if(typeof L[0]=="number"&&(L=[L]),!L[0]||L[0].length===0)throw new Error("channelData must contain non-empty channel arrays");(function(_){const w=_[0];if(w.some(B=>B>1||B<-1)){const B=w.length;let A=0;for(let O=0;O<B;O++){const R=Math.abs(w[O]);R>A&&(A=R)}for(const O of _)for(let R=0;R<B;R++)O[R]/=A}})(L);const T=L.map(_=>_ instanceof Float32Array?_:Float32Array.from(_));return{duration:S,length:T[0].length,sampleRate:T[0].length/S,numberOfChannels:T.length,getChannelData:_=>{const w=T[_];if(!w)throw new Error("Channel ".concat(_," not found"));return w},copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function n$1(L,S){const T=S.xmlns?document.createElementNS(S.xmlns,L):document.createElement(L);for(const[_,w]of Object.entries(S))if(_==="children"&&w)for(const[B,A]of Object.entries(w))A instanceof Node?T.appendChild(A):typeof A=="string"?T.appendChild(document.createTextNode(A)):T.appendChild(n$1(B,A));else _==="style"?Object.assign(T.style,w):_==="textContent"?T.textContent=w:T.setAttribute(_,w.toString());return T}function s$1(L,S,T){const _=n$1(L,S||{});return T==null||T.appendChild(_),_}var r=Object.freeze({__proto__:null,createElement:s$1,default:s$1});const o$1={fetchBlob:function(L,S,T){return t$2(this,void 0,void 0,function*(){const _=yield fetch(L,T);if(_.status>=400)throw new Error("Failed to fetch ".concat(L,": ").concat(_.status," (").concat(_.statusText,")"));return function(w,B){t$2(this,void 0,void 0,function*(){if(!w.body||!w.headers)return;const A=w.body.getReader(),O=Number(w.headers.get("Content-Length"))||0;let R=0;const P=E=>{R+=(E==null?void 0:E.length)||0;const D=Math.round(R/O*100);B(D)};try{for(;;){const E=yield A.read();if(E.done)break;P(E.value)}}catch(E){console.warn("Progress tracking error:",E)}})}(_.clone(),S),_.blob()})}};class a extends e$1{constructor(S){super(),this.isExternalMedia=!1,S.media?(this.media=S.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),S.mediaControls&&(this.media.controls=!0),S.autoplay&&(this.media.autoplay=!0),S.playbackRate!=null&&this.onMediaEvent("canplay",()=>{S.playbackRate!=null&&(this.media.playbackRate=S.playbackRate)},{once:!0})}onMediaEvent(S,T,_){return this.media.addEventListener(S,T,_),()=>this.media.removeEventListener(S,T,_)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const S=this.getSrc();S.startsWith("blob:")&&URL.revokeObjectURL(S)}canPlayType(S){return this.media.canPlayType(S)!==""}setSrc(S,T){const _=this.getSrc();if(S&&_===S)return;this.revokeSrc();const w=T instanceof Blob&&(this.canPlayType(T.type)||!S)?URL.createObjectURL(T):S;if(_&&this.media.removeAttribute("src"),w||S)try{this.media.src=w}catch(B){this.media.src=S}}destroy(){this.isExternalMedia||(this.media.pause(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load(),this.media.remove())}setMediaElement(S){this.media=S}play(){return t$2(this,void 0,void 0,function*(){try{return yield this.media.play()}catch(S){if(S instanceof DOMException&&S.name==="AbortError")return;throw S}})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(S){this.media.currentTime=Math.max(0,Math.min(S,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(S){this.media.volume=S}getMuted(){return this.media.muted}setMuted(S){this.media.muted=S}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(S,T){T!=null&&(this.media.preservesPitch=T),this.media.playbackRate=S}getMediaElement(){return this.media}setSinkId(S){return this.media.setSinkId(S)}}function h(L){return L<0?0:L>1?1:L}function l({maxTop:L,maxBottom:S,halfHeight:T,vScale:_}){const w=Math.round(L*T*_);return{topHeight:w,totalHeight:w+Math.round(S*T*_)||1}}function c({barAlign:L,halfHeight:S,topHeight:T,totalHeight:_,canvasHeight:w}){return L==="top"?0:L==="bottom"?w-_:S-T}function d(L,S,T){const _=S-L.left,w=T-L.top;return[_/L.width,w/L.height]}function u(L){return!!(L.barWidth||L.barGap||L.barAlign)}function p(L,S){if(!u(S))return L;const T=S.barWidth||.5,_=T+(S.barGap||T/2);return _===0?L:Math.floor(L/_)*_}function m({scrollLeft:L,totalWidth:S,numCanvases:T}){if(S===0)return[0];const _=L/S,w=Math.floor(_*T);return[w-1,w,w+1]}function f({scrollLeft:L,clientWidth:S,scrollWidth:T}){return T===0?{startX:0,endX:0}:{startX:L/T,endX:(L+S)/T}}class g extends e$1{constructor(S,T){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.dragUnsubscribe=null,this.subscriptions=[],this.options=S;const _=this.parentFromOptionsContainer(S.container);this.parent=_;const[w,B]=this.initHtml();_.appendChild(w),this.container=w,this.scrollContainer=B.querySelector(".scroll"),this.wrapper=B.querySelector(".wrapper"),this.canvasWrapper=B.querySelector(".canvases"),this.progressWrapper=B.querySelector(".progress"),this.cursor=B.querySelector(".cursor"),T&&B.appendChild(T),this.initEvents()}parentFromOptionsContainer(S){let T;if(typeof S=="string"?T=document.querySelector(S):S instanceof HTMLElement&&(T=S),!T)throw new Error("Container not found");return T}initEvents(){if(this.wrapper.addEventListener("click",S=>{const T=this.wrapper.getBoundingClientRect(),[_,w]=d(T,S.clientX,S.clientY);this.emit("click",_,w)}),this.wrapper.addEventListener("dblclick",S=>{const T=this.wrapper.getBoundingClientRect(),[_,w]=d(T,S.clientX,S.clientY);this.emit("dblclick",_,w)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:S,scrollWidth:T,clientWidth:_}=this.scrollContainer,{startX:w,endX:B}=f({scrollLeft:S,scrollWidth:T,clientWidth:_});this.emit("scroll",w,B,S,S+_)}),typeof ResizeObserver=="function"){const S=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{S().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const S=this.parent.clientWidth;S===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=S,this.reRender(),this.emit("resize"))}initDrag(){this.dragUnsubscribe||(this.dragUnsubscribe=function(S,T,_,w,B=3,A=0,O=100){if(!S)return()=>{};const R=new Map,P=matchMedia("(pointer: coarse)").matches;let E=()=>{};const D=I=>{if(I.button!==A||(R.set(I.pointerId,I),R.size>1))return;let M=I.clientX,N=I.clientY,k=!1;const F=Date.now(),G=X=>{if(X.defaultPrevented||R.size>1||P&&Date.now()-F<O)return;const Y=X.clientX,z=X.clientY,W=Y-M,Z=z-N;if(k||Math.abs(W)>B||Math.abs(Z)>B){X.preventDefault(),X.stopPropagation();const Q=S.getBoundingClientRect(),{left:ee,top:te}=Q;k||(_==null||_(M-ee,N-te),k=!0),T(W,Z,Y-ee,z-te),M=Y,N=z}},V=X=>{if(R.delete(X.pointerId),k){const Y=X.clientX,z=X.clientY,W=S.getBoundingClientRect(),{left:Z,top:Q}=W;w==null||w(Y-Z,z-Q)}E()},j=X=>{R.delete(X.pointerId),X.relatedTarget&&X.relatedTarget!==document.documentElement||V(X)},H=X=>{k&&(X.stopPropagation(),X.preventDefault())},U=X=>{X.defaultPrevented||R.size>1||k&&X.preventDefault()};document.addEventListener("pointermove",G),document.addEventListener("pointerup",V),document.addEventListener("pointerout",j),document.addEventListener("pointercancel",j),document.addEventListener("touchmove",U,{passive:!1}),document.addEventListener("click",H,{capture:!0}),E=()=>{document.removeEventListener("pointermove",G),document.removeEventListener("pointerup",V),document.removeEventListener("pointerout",j),document.removeEventListener("pointercancel",j),document.removeEventListener("touchmove",U),setTimeout(()=>{document.removeEventListener("click",H,{capture:!0})},10)}};return S.addEventListener("pointerdown",D),()=>{E(),S.removeEventListener("pointerdown",D),R.clear()}}(this.wrapper,(S,T,_)=>{const w=this.wrapper.getBoundingClientRect().width;this.emit("drag",h(_/w))},S=>{this.isDragging=!0;const T=this.wrapper.getBoundingClientRect().width;this.emit("dragstart",h(S/T))},S=>{this.isDragging=!1;const T=this.wrapper.getBoundingClientRect().width;this.emit("dragend",h(S/T))}),this.subscriptions.push(this.dragUnsubscribe))}initHtml(){const S=document.createElement("div"),T=S.attachShadow({mode:"open"}),_=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return T.innerHTML="\n      <style".concat(_?' nonce="'.concat(_,'"'):"",">\n        :host {\n          user-select: none;\n          min-width: 1px;\n        }\n        :host audio {\n          display: block;\n          width: 100%;\n        }\n        :host .scroll {\n          overflow-x: auto;\n          overflow-y: hidden;\n          width: 100%;\n          position: relative;\n        }\n        :host .noScrollbar {\n          scrollbar-color: transparent;\n          scrollbar-width: none;\n        }\n        :host .noScrollbar::-webkit-scrollbar {\n          display: none;\n          -webkit-appearance: none;\n        }\n        :host .wrapper {\n          position: relative;\n          overflow: visible;\n          z-index: 2;\n        }\n        :host .canvases {\n          min-height: ").concat(this.getHeight(this.options.height,this.options.splitChannels),'px;\n          pointer-events: none;\n        }\n        :host .canvases > div {\n          position: relative;\n        }\n        :host canvas {\n          display: block;\n          position: absolute;\n          top: 0;\n          image-rendering: pixelated;\n        }\n        :host .progress {\n          pointer-events: none;\n          position: absolute;\n          z-index: 2;\n          top: 0;\n          left: 0;\n          width: 0;\n          height: 100%;\n          overflow: hidden;\n        }\n        :host .progress > div {\n          position: relative;\n        }\n        :host .cursor {\n          pointer-events: none;\n          position: absolute;\n          z-index: 5;\n          top: 0;\n          left: 0;\n          height: 100%;\n          border-radius: 2px;\n        }\n      </style>\n\n      <div class="scroll" part="scroll">\n        <div class="wrapper" part="wrapper">\n          <div class="canvases" part="canvases"></div>\n          <div class="progress" part="progress"></div>\n          <div class="cursor" part="cursor"></div>\n        </div>\n      </div>\n    '),[S,T]}setOptions(S){if(this.options.container!==S.container){const T=this.parentFromOptionsContainer(S.container);T.appendChild(this.container),this.parent=T}S.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=S,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(S){this.scrollContainer.scrollLeft=S}setScrollPercentage(S){const{scrollWidth:T}=this.scrollContainer,_=T*S;this.setScroll(_)}destroy(){var S;this.subscriptions.forEach(T=>T()),this.container.remove(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),(S=this.unsubscribeOnScroll)===null||S===void 0||S.forEach(T=>T()),this.unsubscribeOnScroll=[]}createDelay(S=10){let T,_;const w=()=>{T&&(clearTimeout(T),T=void 0),_&&(_(),_=void 0)};return this.timeouts.push(w),()=>new Promise((B,A)=>{w(),_=A,T=setTimeout(()=>{T=void 0,_=void 0,B()},S)})}getHeight(S,T){var _;const w=((_=this.audioData)===null||_===void 0?void 0:_.numberOfChannels)||1;return function({optionsHeight:B,optionsSplitChannels:A,parentHeight:O,numberOfChannels:R,defaultHeight:P=128}){if(B==null)return P;const E=Number(B);if(!isNaN(E))return E;if(B==="auto"){const D=O||P;return A!=null&&A.every(I=>!I.overlay)?D/R:D}return P}({optionsHeight:S,optionsSplitChannels:T,parentHeight:this.parent.clientHeight,numberOfChannels:w,defaultHeight:128})}convertColorValues(S){return function(T,_){if(!Array.isArray(T))return T||"";if(T.length===0)return"#999";if(T.length<2)return T[0]||"";const w=document.createElement("canvas"),B=w.getContext("2d"),A=w.height*_,O=B.createLinearGradient(0,0,0,A||_),R=1/(T.length-1);return T.forEach((P,E)=>{O.addColorStop(E*R,P)}),O}(S,this.getPixelRatio())}getPixelRatio(){return S=window.devicePixelRatio,Math.max(1,S||1);var S}renderBarWaveform(S,T,_,w){const{width:B,height:A}=_.canvas,{halfHeight:O,barWidth:R,barRadius:P,barIndexScale:E,barSpacing:D}=function({width:M,height:N,length:k,options:F,pixelRatio:G}){const V=N/2,j=F.barWidth?F.barWidth*G:1,H=F.barGap?F.barGap*G:F.barWidth?j/2:0,U=j+H||1;return{halfHeight:V,barWidth:j,barGap:H,barRadius:F.barRadius||0,barIndexScale:k>0?M/U/k:0,barSpacing:U}}({width:B,height:A,length:(S[0]||[]).length,options:T,pixelRatio:this.getPixelRatio()}),I=function({channelData:M,barIndexScale:N,barSpacing:k,barWidth:F,halfHeight:G,vScale:V,canvasHeight:j,barAlign:H}){const U=M[0]||[],X=M[1]||U,Y=U.length,z=[];let W=0,Z=0,Q=0;for(let ee=0;ee<=Y;ee++){const te=Math.round(ee*N);if(te>W){const{topHeight:ne,totalHeight:he}=l({maxTop:Z,maxBottom:Q,halfHeight:G,vScale:V}),pe=c({barAlign:H,halfHeight:G,topHeight:ne,totalHeight:he,canvasHeight:j});z.push({x:W*k,y:pe,width:F,height:he}),W=te,Z=0,Q=0}const re=Math.abs(U[ee]||0),ie=Math.abs(X[ee]||0);re>Z&&(Z=re),ie>Q&&(Q=ie)}return z}({channelData:S,barIndexScale:E,barSpacing:D,barWidth:R,halfHeight:O,vScale:w,canvasHeight:A,barAlign:T.barAlign});_.beginPath();for(const M of I)P&&"roundRect"in _?_.roundRect(M.x,M.y,M.width,M.height,P):_.rect(M.x,M.y,M.width,M.height);_.fill(),_.closePath()}renderLineWaveform(S,T,_,w){const{width:B,height:A}=_.canvas,O=function({channelData:R,width:P,height:E,vScale:D}){const I=E/2,M=R[0]||[];return[M,R[1]||M].map((N,k)=>{const F=N.length,G=F?P/F:0,V=I,j=k===0?-1:1,H=[{x:0,y:V}];let U=0,X=0;for(let Y=0;Y<=F;Y++){const z=Math.round(Y*G);if(z>U){const Z=V+(Math.round(X*I*D)||1)*j;H.push({x:U,y:Z}),U=z,X=0}const W=Math.abs(N[Y]||0);W>X&&(X=W)}return H.push({x:U,y:V}),H})}({channelData:S,width:B,height:A,vScale:w});_.beginPath();for(const R of O)if(R.length){_.moveTo(R[0].x,R[0].y);for(let P=1;P<R.length;P++){const E=R[P];_.lineTo(E.x,E.y)}}_.fill(),_.closePath()}renderWaveform(S,T,_){if(_.fillStyle=this.convertColorValues(T.waveColor),T.renderFunction)return void T.renderFunction(S,_);const w=function({channelData:B,barHeight:A,normalize:O}){var R;const P=A||1;if(!O)return P;const E=B[0];if(!E||E.length===0)return P;let D=0;for(let I=0;I<E.length;I++){const M=(R=E[I])!==null&&R!==void 0?R:0,N=Math.abs(M);N>D&&(D=N)}return D?P/D:P}({channelData:S,barHeight:T.barHeight,normalize:T.normalize});u(T)?this.renderBarWaveform(S,T,_,w):this.renderLineWaveform(S,T,_,w)}renderSingleCanvas(S,T,_,w,B,A,O){const R=this.getPixelRatio(),P=document.createElement("canvas");P.width=Math.round(_*R),P.height=Math.round(w*R),P.style.width="".concat(_,"px"),P.style.height="".concat(w,"px"),P.style.left="".concat(Math.round(B),"px"),A.appendChild(P);const E=P.getContext("2d");if(T.renderFunction?(E.fillStyle=this.convertColorValues(T.waveColor),T.renderFunction(S,E)):this.renderWaveform(S,T,E),P.width>0&&P.height>0){const D=P.cloneNode(),I=D.getContext("2d");I.drawImage(P,0,0),I.globalCompositeOperation="source-in",I.fillStyle=this.convertColorValues(T.progressColor),I.fillRect(0,0,P.width,P.height),O.appendChild(D)}}renderMultiCanvas(S,T,_,w,B,A){const O=this.getPixelRatio(),{clientWidth:R}=this.scrollContainer,P=_/O,E=function({clientWidth:N,totalWidth:k,options:F}){return p(Math.min(8e3,N,k),F)}({clientWidth:R,totalWidth:P,options:T});let D={};if(E===0)return;const I=N=>{if(N<0||N>=M||D[N])return;D[N]=!0;const k=N*E;let F=Math.min(P-k,E);if(F=p(F,T),F<=0)return;const G=function({channelData:V,offset:j,clampedWidth:H,totalWidth:U}){return V.map(X=>{const Y=Math.floor(j/U*X.length),z=Math.floor((j+H)/U*X.length);return X.slice(Y,z)})}({channelData:S,offset:k,clampedWidth:F,totalWidth:P});this.renderSingleCanvas(G,T,F,w,k,B,A)},M=Math.ceil(P/E);if(!this.isScrollable){for(let N=0;N<M;N++)I(N);return}if(m({scrollLeft:this.scrollContainer.scrollLeft,totalWidth:P,numCanvases:M}).forEach(N=>I(N)),M>1){const N=this.on("scroll",()=>{const{scrollLeft:k}=this.scrollContainer;Object.keys(D).length>10&&(B.innerHTML="",A.innerHTML="",D={}),m({scrollLeft:k,totalWidth:P,numCanvases:M}).forEach(F=>I(F))});this.unsubscribeOnScroll.push(N)}}renderChannel(S,T,_,w){var{overlay:B}=T,A=function(E,D){var I={};for(var M in E)Object.prototype.hasOwnProperty.call(E,M)&&D.indexOf(M)<0&&(I[M]=E[M]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function"){var N=0;for(M=Object.getOwnPropertySymbols(E);N<M.length;N++)D.indexOf(M[N])<0&&Object.prototype.propertyIsEnumerable.call(E,M[N])&&(I[M[N]]=E[M[N]])}return I}(T,["overlay"]);const O=document.createElement("div"),R=this.getHeight(A.height,A.splitChannels);O.style.height="".concat(R,"px"),B&&w>0&&(O.style.marginTop="-".concat(R,"px")),this.canvasWrapper.style.minHeight="".concat(R,"px"),this.canvasWrapper.appendChild(O);const P=O.cloneNode();this.progressWrapper.appendChild(P),this.renderMultiCanvas(S,A,_,R,O,P)}render(S){return t$2(this,void 0,void 0,function*(){var T;this.timeouts.forEach(P=>P()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?"".concat(this.options.width,"px"):this.options.width);const _=this.getPixelRatio(),w=this.scrollContainer.clientWidth,{scrollWidth:B,isScrollable:A,useParentWidth:O,width:R}=function({duration:P,minPxPerSec:E=0,parentWidth:D,fillParent:I,pixelRatio:M}){const N=Math.ceil(P*E),k=N>D,F=!!(I&&!k);return{scrollWidth:N,isScrollable:k,useParentWidth:F,width:(F?D:N)*M}}({duration:S.duration,minPxPerSec:this.options.minPxPerSec||0,parentWidth:w,fillParent:this.options.fillParent,pixelRatio:_});if(this.isScrollable=A,this.wrapper.style.width=O?"100%":"".concat(B,"px"),this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor="".concat(this.options.cursorColor||this.options.progressColor),this.cursor.style.width="".concat(this.options.cursorWidth,"px"),this.audioData=S,this.emit("render"),this.options.splitChannels)for(let P=0;P<S.numberOfChannels;P++){const E=Object.assign(Object.assign({},this.options),(T=this.options.splitChannels)===null||T===void 0?void 0:T[P]);this.renderChannel([S.getChannelData(P)],E,R,P)}else{const P=[S.getChannelData(0)];S.numberOfChannels>1&&P.push(S.getChannelData(1)),this.renderChannel(P,this.options,R,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(_=>_()),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:S}=this.scrollContainer,{right:T}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&S!==this.scrollContainer.scrollWidth){const{right:_}=this.progressWrapper.getBoundingClientRect(),w=function(B){const A=2*B;return(A<0?Math.floor(A):Math.ceil(A))/2}(_-T);this.scrollContainer.scrollLeft+=w}}zoom(S){this.options.minPxPerSec=S,this.reRender()}scrollIntoView(S,T=!1){const{scrollLeft:_,scrollWidth:w,clientWidth:B}=this.scrollContainer,A=S*w,O=_,R=_+B,P=B/2;if(this.isDragging)A+30>R?this.scrollContainer.scrollLeft+=30:A-30<O&&(this.scrollContainer.scrollLeft-=30);else{(A<O||A>R)&&(this.scrollContainer.scrollLeft=A-(this.options.autoCenter?P:0));const E=A-_-P;T&&this.options.autoCenter&&E>0&&(this.scrollContainer.scrollLeft+=E)}{const E=this.scrollContainer.scrollLeft,{startX:D,endX:I}=f({scrollLeft:E,scrollWidth:w,clientWidth:B});this.emit("scroll",D,I,E,E+B)}}renderProgress(S,T){if(isNaN(S))return;const _=100*S;this.canvasWrapper.style.clipPath="polygon(".concat(_,"% 0%, 100% 0%, 100% 100%, ").concat(_,"% 100%)"),this.progressWrapper.style.width="".concat(_,"%"),this.cursor.style.left="".concat(_,"%"),this.cursor.style.transform=this.options.cursorWidth?"translateX(-".concat(S*this.options.cursorWidth,"px)"):"",this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(S,T)}exportImage(S,T,_){return t$2(this,void 0,void 0,function*(){const w=this.canvasWrapper.querySelectorAll("canvas");if(!w.length)throw new Error("No waveform data");if(_==="dataURL"){const B=Array.from(w).map(A=>A.toDataURL(S,T));return Promise.resolve(B)}return Promise.all(Array.from(w).map(B=>new Promise((A,O)=>{B.toBlob(R=>{R?A(R):O(new Error("Could not export image"))},S,T)})))})}}class v extends e$1{constructor(){super(...arguments),this.animationFrameId=null,this.isRunning=!1}start(){if(this.isRunning)return;this.isRunning=!0;const S=()=>{this.isRunning&&(this.emit("tick"),this.animationFrameId=requestAnimationFrame(S))};S()}stop(){this.isRunning=!1,this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop()}}class b extends e$1{constructor(S=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=S,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return t$2(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(S){if(this.currentSrc=S,this._duration=void 0,!S)return this.buffer=null,void this.emit("emptied");fetch(S).then(T=>{if(T.status>=400)throw new Error("Failed to fetch ".concat(S,": ").concat(T.status," (").concat(T.statusText,")"));return T.arrayBuffer()}).then(T=>this.currentSrc!==S?null:this.audioContext.decodeAudioData(T)).then(T=>{this.currentSrc===S&&(this.buffer=T,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())}).catch(T=>{console.error("WebAudioPlayer load error:",T)})}_play(){if(!this.paused)return;this.paused=!1,this.bufferNode&&(this.bufferNode.onended=null,this.bufferNode.disconnect()),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let S=this.playedDuration*this._playbackRate;(S>=this.duration||S<0)&&(S=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,S),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var S;this.paused=!0,(S=this.bufferNode)===null||S===void 0||S.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return t$2(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(S){const T=S-this.currentTime,_=this.bufferNode;_==null||_.stop(this.audioContext.currentTime+T),_==null||_.addEventListener("ended",()=>{_===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(S){return t$2(this,void 0,void 0,function*(){return this.audioContext.setSinkId(S)})}get playbackRate(){return this._playbackRate}set playbackRate(S){this._playbackRate=S,this.bufferNode&&(this.bufferNode.playbackRate.value=S)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(S){const T=!this.paused;T&&this._pause(),this.playedDuration=S/this._playbackRate,T&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var S,T;return(S=this._duration)!==null&&S!==void 0?S:((T=this.buffer)===null||T===void 0?void 0:T.duration)||0}set duration(S){this._duration=S}get volume(){return this.gainNode.gain.value}set volume(S){this.gainNode.gain.value=S,this.emit("volumechange")}get muted(){return this._muted}set muted(S){this._muted!==S&&(this._muted=S,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(S){return/^(audio|video)\//.test(S)}getGainNode(){return this.gainNode}getChannelData(){const S=[];if(!this.buffer)return S;const T=this.buffer.numberOfChannels;for(let _=0;_<T;_++)S.push(this.buffer.getChannelData(_));return S}removeAttribute(S){switch(S){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}const y={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class C extends a{static create(S){return new C(S)}constructor(S){const T=S.media||(S.backend==="WebAudio"?new b:void 0);super({media:T,mediaControls:S.mediaControls,autoplay:S.autoplay,playbackRate:S.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},y,S),this.timer=new v;const _=T?void 0:this.getMediaElement();this.renderer=new g(this.options,_),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const w=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:B,duration:A}=this.options;(w||B&&A)&&this.load(w,B,A).catch(O=>{this.emit("error",O instanceof Error?O:new Error(String(O)))})})}updateProgress(S=this.getCurrentTime()){return this.renderer.renderProgress(S/this.getDuration(),this.isPlaying()),S}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const S=this.updateProgress();this.emit("timeupdate",S),this.emit("audioprocess",S),this.stopAtPosition!=null&&this.isPlaying()&&S>=this.stopAtPosition&&this.pause()}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const S=this.updateProgress();this.emit("timeupdate",S)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var S;this.emit("error",(S=this.getMediaElement().error)!==null&&S!==void 0?S:new Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(S,T)=>{this.options.interact&&(this.seekTo(S),this.emit("interaction",S*this.getDuration()),this.emit("click",S,T))}),this.renderer.on("dblclick",(S,T)=>{this.emit("dblclick",S,T)}),this.renderer.on("scroll",(S,T,_,w)=>{const B=this.getDuration();this.emit("scroll",S*B,T*B,_,w)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",S=>{this.emit("dragstart",S)}),this.renderer.on("dragend",S=>{this.emit("dragend",S)}),this.renderer.on("resize",()=>{this.emit("resize")}));{let S;const T=this.renderer.on("drag",_=>{var w;if(!this.options.interact)return;this.renderer.renderProgress(_),clearTimeout(S);let B=0;const A=this.options.dragToSeek;this.isPlaying()?B=0:A===!0?B=200:A&&typeof A=="object"&&(B=(w=A.debounceTime)!==null&&w!==void 0?w:200),S=setTimeout(()=>{this.seekTo(_)},B),this.emit("interaction",_*this.getDuration()),this.emit("drag",_)});this.subscriptions.push(()=>{clearTimeout(S),T()})}}initPlugins(){var S;!((S=this.options.plugins)===null||S===void 0)&&S.length&&this.options.plugins.forEach(T=>{this.registerPlugin(T)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(S=>S()),this.mediaSubscriptions=[]}setOptions(S){this.options=Object.assign({},this.options,S),S.duration&&!S.peaks&&(this.decodedData=i$1.createBuffer(this.exportPeaks(),S.duration)),S.peaks&&S.duration&&(this.decodedData=i$1.createBuffer(S.peaks,S.duration)),this.renderer.setOptions(this.options),S.audioRate&&this.setPlaybackRate(S.audioRate),S.mediaControls!=null&&(this.getMediaElement().controls=S.mediaControls)}registerPlugin(S){if(this.plugins.includes(S))return S;S._init(this),this.plugins.push(S);const T=S.once("destroy",()=>{this.plugins=this.plugins.filter(_=>_!==S),this.subscriptions=this.subscriptions.filter(_=>_!==T)});return this.subscriptions.push(T),S}unregisterPlugin(S){this.plugins=this.plugins.filter(T=>T!==S),S.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(S){return this.renderer.setScroll(S)}setScrollTime(S){const T=S/this.getDuration();this.renderer.setScrollPercentage(T)}getActivePlugins(){return this.plugins}loadAudio(S,T,_,w){return t$2(this,void 0,void 0,function*(){var B;if(this.emit("load",S),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,(B=this.abortController)===null||B===void 0||B.abort(),this.abortController=null,!T&&!_){const O=this.options.fetchParams||{};window.AbortController&&!O.signal&&(this.abortController=new AbortController,O.signal=this.abortController.signal);const R=E=>this.emit("loading",E);T=yield o$1.fetchBlob(S,R,O);const P=this.options.blobMimeType;P&&(T=new Blob([T],{type:P}))}this.setSrc(S,T);const A=yield new Promise(O=>{const R=w||this.getDuration();R?O(R):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>O(this.getDuration()),{once:!0}))});if(!S&&!T){const O=this.getMediaElement();O instanceof b&&(O.duration=A)}if(_)this.decodedData=i$1.createBuffer(_,A||0);else if(T){const O=yield T.arrayBuffer();this.decodedData=yield i$1.decode(O,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(S,T,_){return t$2(this,void 0,void 0,function*(){try{return yield this.loadAudio(S,void 0,T,_)}catch(w){throw this.emit("error",w),w}})}loadBlob(S,T,_){return t$2(this,void 0,void 0,function*(){try{return yield this.loadAudio("",S,T,_)}catch(w){throw this.emit("error",w),w}})}zoom(S){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(S),this.emit("zoom",S)}getDecodedData(){return this.decodedData}exportPeaks({channels:S=2,maxLength:T=8e3,precision:_=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const w=Math.min(S,this.decodedData.numberOfChannels),B=[];for(let A=0;A<w;A++){const O=this.decodedData.getChannelData(A),R=[],P=O.length/T;for(let E=0;E<T;E++){const D=O.slice(Math.floor(E*P),Math.ceil((E+1)*P));let I=0;for(let M=0;M<D.length;M++){const N=D[M];Math.abs(N)>Math.abs(I)&&(I=N)}R.push(Math.round(I*_)/_)}B.push(R)}return B}getDuration(){let S=super.getDuration()||0;return S!==0&&S!==1/0||!this.decodedData||(S=this.decodedData.duration),S}toggleInteraction(S){this.options.interact=S}setTime(S){this.stopAtPosition=null,super.setTime(S),this.updateProgress(S),this.emit("timeupdate",S)}seekTo(S){const T=this.getDuration()*S;this.setTime(T)}play(S,T){const _=Object.create(null,{play:{get:()=>super.play}});return t$2(this,void 0,void 0,function*(){S!=null&&this.setTime(S);const w=yield _.play.call(this);return T!=null&&(this.media instanceof b?this.media.stopAt(T):this.stopAtPosition=T),w})}playPause(){return t$2(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(S){this.setTime(this.getCurrentTime()+S)}empty(){this.load("",[[0]],.001)}setMediaElement(S){this.unsubscribePlayerEvents(),super.setMediaElement(S),this.initPlayerEvents()}exportImage(){return t$2(this,arguments,void 0,function*(S="image/png",T=1,_="dataURL"){return this.renderer.exportImage(S,T,_)})}destroy(){var S;this.emit("destroy"),(S=this.abortController)===null||S===void 0||S.abort(),this.plugins.forEach(T=>T.destroy()),this.subscriptions.forEach(T=>T()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}C.BasePlugin=class extends e$1{constructor(L){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=L}onInit(){}_init(L){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=L,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(L=>L()),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},C.dom=r;let t$1=class{constructor(){this.listeners={}}on(S,T,_){if(this.listeners[S]||(this.listeners[S]=new Set),_==null?void 0:_.once){const w=(...B)=>{this.un(S,w),T(...B)};return this.listeners[S].add(w),()=>this.un(S,w)}return this.listeners[S].add(T),()=>this.un(S,T)}un(S,T){var _;(_=this.listeners[S])===null||_===void 0||_.delete(T)}once(S,T){return this.on(S,T,{once:!0})}unAll(){this.listeners={}}emit(S,...T){this.listeners[S]&&this.listeners[S].forEach(_=>_(...T))}};class e extends t$1{constructor(S){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=S}onInit(){}_init(S){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=S,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(S=>S()),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}}function s(L,S){const T=S.xmlns?document.createElementNS(S.xmlns,L):document.createElement(L);for(const[_,w]of Object.entries(S))if(_==="children"&&w)for(const[B,A]of Object.entries(w))A instanceof Node?T.appendChild(A):typeof A=="string"?T.appendChild(document.createTextNode(A)):T.appendChild(s(B,A));else _==="style"?Object.assign(T.style,w):_==="textContent"?T.textContent=w:T.setAttribute(_,w.toString());return T}function i(L,S,T){const _=s(L,S||{});return T==null||T.appendChild(_),_}const n={lineWidth:1,labelSize:11,labelPreferLeft:!1,formatTimeCallback:L=>"".concat(Math.floor(L/60),":").concat("0".concat(Math.floor(L)%60).slice(-2))};class o extends e{constructor(S){super(S||{}),this.lastPointerPosition=null,this.unsubscribe=()=>{},this.onPointerMove=T=>{if(!this.wavesurfer)return;this.lastPointerPosition={clientX:T.clientX,clientY:T.clientY};const _=this.wavesurfer.getWrapper().getBoundingClientRect(),{width:w}=_,B=T.clientX-_.left,A=Math.min(1,Math.max(0,B/w)),O=Math.min(w-this.options.lineWidth-1,B);this.wrapper.style.transform="translateX(".concat(O,"px)"),this.wrapper.style.opacity="1";const R=this.wavesurfer.getDuration()||0;this.label.textContent=this.options.formatTimeCallback(R*A);const P=this.label.offsetWidth,E=this.options.labelPreferLeft?O-P>0:O+P>w;this.label.style.transform=E?"translateX(-".concat(P+this.options.lineWidth,"px)"):"",this.emit("hover",A)},this.onPointerLeave=()=>{this.wrapper.style.opacity="0",this.lastPointerPosition=null},this.options=Object.assign({},n,S),this.wrapper=i("div",{part:"hover"}),this.label=i("span",{part:"hover-label"},this.wrapper)}static create(S){return new o(S)}addUnits(S){return"".concat(S).concat(typeof S=="number"?"px":"")}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const S=this.wavesurfer.options,T=this.options.lineColor||S.cursorColor||S.progressColor;Object.assign(this.wrapper.style,{position:"absolute",zIndex:10,left:0,top:0,height:"100%",pointerEvents:"none",borderLeft:"".concat(this.addUnits(this.options.lineWidth)," solid ").concat(T),opacity:"0",transition:"opacity .1s ease-in"}),Object.assign(this.label.style,{display:"block",backgroundColor:this.options.labelBackground,color:this.options.labelColor,fontSize:"".concat(this.addUnits(this.options.labelSize)),transition:"transform .1s ease-in",padding:"2px 3px"});const _=this.wavesurfer.getWrapper();_.appendChild(this.wrapper);const w=()=>{this.lastPointerPosition&&this.onPointerMove(this.lastPointerPosition)},B=this.wavesurfer.on("zoom",w),A=this.wavesurfer.on("scroll",w);_.addEventListener("pointermove",this.onPointerMove),_.addEventListener("pointerleave",this.onPointerLeave),this.unsubscribe=()=>{_.removeEventListener("pointermove",this.onPointerMove),_.removeEventListener("pointerleave",this.onPointerLeave),B(),A()}}destroy(){super.destroy(),this.unsubscribe(),this.wrapper.remove()}}const _sfc_main$1={name:"SoundTextEdit",props:{audioUrl:{type:String,required:!0},config:{type:Object,required:!1}},data(){return{inLoading:!1,dataSource:[],wsArr:[],curTouchCwIndex:-1}},mounted(){console.log("初始化时的配置",this.config),this.dataSource=this.config,this.wavesurfer=C.create({container:document.getElementById("wavesurferParent"),waveColor:"rgb(77, 150, 253)",progressColor:"rgb(253, 165, 77)",url:this.audioUrl,audioRate:1,plugins:[o.create({lineColor:"#ff0000",lineWidth:2,labelBackground:"#555",labelColor:"#fff",labelSize:"11px",labelPreferLeft:!1,formatTimeCallback:L=>L.toFixed(3)+"s"})]})},unmounted(){},methods:{onClickPlayOrPause(){this.wavesurfer!=null&&this.wavesurfer.playPause()},startRun(){cc.Tween.stopAllByTarget(this.node.children[0])},onClickAuto(){this.inLoading=!0,VoiceCheck$1.startTestByUrl(this.audioUrl,L=>{this.inLoading=!1,console.log("我获取到了字幕结果",L),this.wsArr=L})},onClickPreview(){this.wavesurfer!=null&&(this.wavesurfer.stop(),setTimeout(()=>{this.wavesurfer.play()},10));let L=T=>{var _=T.times[T.curTimeIndex]-T.times[T.curTimeIndex-1];let w=T.position[T.curTimeIndex],B=0;T.curTimeIndex==1&&(B=T.times[0]),cc.tween(T).delay(B).to(_,{curProgress:w}).call(()=>{T.position[T.curTimeIndex+1]!=null&&(T.curTimeIndex+=1,L(T))}).start()};for(var S=0;S<this.dataSource.length;S++){let T=this.dataSource[S];T.times.length>1&&(T.curTimeIndex=1,T.curProgress=T.position[0],L(T))}},onClickAddOneText(){this.dataSource.push({text:"",position:[],times:[],width:0,curProgress:0,curTimeIndex:0})},onClickDelOneText(L){this.dataSource.splice(L,1)},onClickAddTimePos(L){L.times.push(this.wavesurfer.getCurrentTime()),L.position.push(L.curProgress),L.curTimeIndex=L.times.length-1},onClickResetTimePos(L){L.times[L.curTimeIndex]!=null&&(L.times[L.curTimeIndex]=this.wavesurfer.getCurrentTime(),L.position[L.curTimeIndex]=L.curProgress)},onClickDeleteTimePos(L){if(L.times[L.curTimeIndex]==null)return;L.times.splice(L.curTimeIndex,1),L.position.splice(L.curTimeIndex,1);let S=L.curTimeIndex-1;S<0&&(S=0),L.curTimeIndex=S,this.onPosChange(L)},onPosChange(L){let S=L.times[L.curTimeIndex],T=L.position[L.curTimeIndex];L.times[L.curTimeIndex]==null&&(S=0,T=0),this.wavesurfer!=null&&this.wavesurfer.setTime(S),console.log("设置了时间",S),L.curProgress=T},onClickCwTag(L){if(this.wsArr[L+1]!=null){if(this.wsArr[L+1].isSplit)return}else return;this.wsArr.splice(L+1,0,{isSplit:!0}),this.curTouchCwIndex=-1},onClickDelSplite(L){this.wsArr.splice(L,1)},onTouchCwTag(L){this.wsArr[L+1]!=null?this.wsArr[L+1].isSplit?this.curTouchCwIndex=-1:this.curTouchCwIndex=L:this.curTouchCwIndex=-1},onLeaveCwTag(L){this.curTouchCwIndex=-1},onClickWsToText(){this.dataSource.push({text:"",position:[],times:[],width:0,curProgress:0,curTimeIndex:0});for(var L=0;L<this.wsArr.length;L++){let w=this.wsArr[L];if(w.isSplit==!0)this.dataSource.push({text:"",position:[],times:[],width:0,curProgress:0,curTimeIndex:0});else{let B=this.dataSource[this.dataSource.length-1];B.text+=w.cw[0].w}}let S=0,T="";for(var L=0;L<this.wsArr.length;L++){let B=this.wsArr[L],A=this.dataSource[S];B.isSplit==!0?(A.position.push(100),this.wsArr[L+1]!=null?A.times.push(this.wsArr[L+1].bg/100):A.times.push(this.wavesurfer.getDuration()),S+=1,T=""):(A.position.push(T.length/A.text.length*100),T+=B.cw[0].w,A.times.push(B.bg/100))}let _=this.dataSource[S];_.position[_.position.length-1]!=100&&(_.position.push(100),_.times.push(this.wavesurfer.getDuration()))},onClickSave(){this.$emit("onChange",this.dataSource)}}},_hoisted_1$1={style:{width:"100%",height:"100%"}},_hoisted_2$1={style:{"max-width":"300px",overflow:"scroll"}},_hoisted_3$1={style:{"font-size":"20px",color:"#4D96FD"}},_hoisted_4$1={style:{"font-size":"20px",color:"#FDA54D",width:"999px"}};function _sfc_render$1(L,S,T,_,w,B){const A=resolveComponent("a-button"),O=resolveComponent("a-input"),R=resolveComponent("a-flex"),P=resolveComponent("a-radio-button"),E=resolveComponent("a-radio-group"),D=resolveComponent("a-slider"),I=resolveComponent("a-card"),M=resolveComponent("a-tag"),N=resolveComponent("icon-oblique-line"),k=resolveDirective("element-size");return openBlock(),createElementBlock("div",_hoisted_1$1,[S[11]||(S[11]=createBaseVNode("div",{id:"wavesurferParent",style:{width:"100%"}},null,-1)),createVNode(R,{vertical:"",gap:"small",style:{"margin-top":"10px"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(w.dataSource,(F,G)=>(openBlock(),createBlock(I,{size:"small"},{title:withCtx(()=>[createVNode(R,{gap:"small",style:{"margin-right":"10px"}},{default:withCtx(()=>[createVNode(A,{danger:"",onClick:V=>B.onClickDelOneText(G)},{default:withCtx(()=>[...S[0]||(S[0]=[createTextVNode("删除字幕",-1)])]),_:1},8,["onClick"]),createVNode(O,{value:F.text,"onUpdate:value":V=>F.text=V,placeholder:"输入字幕内容"},null,8,["value","onUpdate:value"])]),_:2},1024)]),extra:withCtx(()=>[createVNode(R,{gap:"small"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1,[createVNode(E,{value:F.curTimeIndex,"onUpdate:value":V=>F.curTimeIndex=V,onChange:V=>B.onPosChange(F),"button-style":"solid",style:{width:"max-content"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(F.times,(V,j)=>(openBlock(),createBlock(P,{value:j},{default:withCtx(()=>[createTextVNode(toDisplayString(j+1),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["value","onUpdate:value","onChange"])]),createVNode(A,{onClick:V=>B.onClickAddTimePos(F)},{default:withCtx(()=>[...S[1]||(S[1]=[createTextVNode("打点",-1)])]),_:1},8,["onClick"]),createVNode(A,{onClick:V=>B.onClickResetTimePos(F)},{default:withCtx(()=>[...S[2]||(S[2]=[createTextVNode("修改",-1)])]),_:1},8,["onClick"]),createVNode(A,{danger:"",onClick:V=>B.onClickDeleteTimePos(F)},{default:withCtx(()=>[...S[3]||(S[3]=[createTextVNode("删除选中时间点",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),default:withCtx(()=>[createVNode(R,{gap:"small",vertical:""},{default:withCtx(()=>[createVNode(R,null,{default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("div",_hoisted_3$1,[createTextVNode(toDisplayString(F.text),1)])),[[k,V=>{F.width=V.width}]])]),_:2},1024),createBaseVNode("div",{style:normalizeStyle([{position:"absolute",overflow:"hidden"},{width:F.width*F.curProgress*.01+"px"}])},[createBaseVNode("div",_hoisted_4$1,toDisplayString(F.text),1)],4),createVNode(D,{id:"test",style:normalizeStyle({width:F.width+"px"}),value:F.curProgress,"onUpdate:value":V=>F.curProgress=V,step:.01,tipFormatter:null},null,8,["style","value","onUpdate:value"])]),_:2},1024)]),_:2},1024))),256)),w.wsArr.length>0?(openBlock(),createBlock(R,{key:0,gap:"small",wrap:"wrap",style:{"margin-top":"10px"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(w.wsArr,(F,G)=>(openBlock(),createElementBlock(Fragment,null,[F.cw!=null?(openBlock(),createBlock(M,{key:0,style:{cursor:"pointer","margin-right":"0"},onClick:V=>B.onClickCwTag(G),onMouseenter:V=>B.onTouchCwTag(G),onMouseleave:V=>B.onLeaveCwTag(G)},{default:withCtx(()=>[createTextVNode(toDisplayString(F.cw[0].w),1)]),_:2},1032,["onClick","onMouseenter","onMouseleave"])):createCommentVNode("",!0),F.isSplit||G==w.curTouchCwIndex?(openBlock(),createBlock(N,{key:1,onClick:V=>B.onClickDelSplite(G),style:{cursor:"pointer",color:"#4D96FD","font-size":"22","stroke-linecap":"round","stroke-linejoin":"miter-clip","stroke-width":"5"}},null,8,["onClick"])):createCommentVNode("",!0)],64))),256)),createVNode(A,{type:"primary",style:{"margin-left":"20px"},onClick:B.onClickWsToText},{default:withCtx(()=>[...S[4]||(S[4]=[createTextVNode("生成字幕",-1)])]),_:1},8,["onClick"])]),_:1})):createCommentVNode("",!0),createVNode(R,{gap:"small",style:{"margin-top":"10px"}},{default:withCtx(()=>[createVNode(A,{type:"primary",onClick:B.onClickPlayOrPause},{default:withCtx(()=>[...S[5]||(S[5]=[createTextVNode("播放/暂停",-1)])]),_:1},8,["onClick"]),createVNode(A,{type:"primary",onClick:B.onClickAddOneText},{default:withCtx(()=>[...S[6]||(S[6]=[createTextVNode("增加一行字幕",-1)])]),_:1},8,["onClick"]),S[10]||(S[10]=createBaseVNode("div",{style:{height:"1px","flex-grow":"1"}},null,-1)),createVNode(A,{type:"primary",loading:w.inLoading,onClick:B.onClickAuto},{default:withCtx(()=>[...S[7]||(S[7]=[createTextVNode("自动识别",-1)])]),_:1},8,["loading","onClick"]),createVNode(A,{type:"primary",onClick:B.onClickPreview},{default:withCtx(()=>[...S[8]||(S[8]=[createTextVNode("预览",-1)])]),_:1},8,["onClick"]),createVNode(A,{type:"primary",onClick:B.onClickSave},{default:withCtx(()=>[...S[9]||(S[9]=[createTextVNode("保存",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})])}const SoundTextEdit=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]),fnData=[{title:"常用函数",key:"1",children:[{title:"MOD",desc:"求余数",ex:"MOD(3, -2)",key:"1-1",enCode:"MOD"},{title:"ABS",desc:"绝对值",key:"1-2",enCode:"ABS"},{title:"RAND",desc:"[0,1]区间的随机数",key:"1-3",enCode:"RAND"},{title:"ROUND",desc:"四舍五入取整",key:"1-4",enCode:"ROUND"},{title:"ROUNDDOWN",desc:"向下取整",key:"1-5",enCode:"ROUNDDOWN"},{title:"ROUNDUP",desc:"向上取整",ex:"ROUNDUP(-3.14159, 2)",key:"1-6",enCode:"ROUNDUP"},{title:"SQRT",desc:"平方根",key:"1-7",enCode:"SQRT"},{title:"SUM",desc:"求和",ex:"SUM(-5, 15, 32, 'Hello World!')",key:"1-8",enCode:"SUM"},{title:"SUMIF",desc:"对满足条件的值求和",ex:"SUMIF([2,4,8,16], '>5')",key:"1-9",enCode:"SUMIF"}]},{title:"日期转换",key:"2",children:[{title:"DAY",desc:"获取日期中的天",key:"2-1",enCode:"DAY"},{title:"HOUR",desc:"获取日期中的小时",key:"2-2",enCode:"HOUR"},{title:"MINUTE",desc:"获取日期中的分钟",key:"2-3",enCode:"MINUTE"},{title:"SECOND",desc:"获取日期中的秒数",key:"2-4",enCode:"SECOND"},{title:"MONTH",desc:"获取日期中的月份",key:"2-5",enCode:"MONTH"},{title:"YEAR",desc:"获取日期中的年份",key:"2-6",enCode:"YEAR"},{title:"NOW",desc:"获取当前日期，包含时间",key:"2-7",enCode:"NOW"},{title:"DAYS",desc:"返回两个日期相差的天数",key:"2-8",enCode:"DAYS"},{title:"DATE",desc:"通过输入年月日生成时间",key:"2-9",enCode:"DATE"},{title:"DATEVALUE",desc:"通过输入日期字符串生成时间",key:"2-10",enCode:"DATEVALUE"}]},{title:"逻辑运算",key:"3",children:[{title:"AND",desc:"所有输入满足True时输出True",key:"3-1",enCode:"AND"},{title:"IF",desc:"条件判断",key:"3-2",enCode:"IF"},{title:"NOT",desc:"输出相反的True或者False",key:"3-3",enCode:"NOT"},{title:"OR",desc:"任意条件为真则返回真",key:"3-4",enCode:"OR"},{title:"TRUE",desc:"返回true",key:"3-5",enCode:"TRUE"},{title:"FALSE",desc:"返回false",key:"3-6",enCode:"FALSE"},{title:"SWITCH",desc:"多条件判断",key:"3-7",enCode:"SWITCH"}]},{title:"统计运算",key:"4",children:[{title:"MAX",desc:"获取一组输入中最大的数",key:"4-1",enCode:"MAX"},{title:"MIN",desc:"获取一组输入中最小的数",key:"4-2",enCode:"MIN"},{title:"AVERAGE",desc:"求平均数",key:"4-3",enCode:"AVERAGE"},{title:"AVEDEV",desc:"求平均数偏差平均值",key:"4-4",enCode:"AVEDEV"},{title:"COUNT",desc:"返回输入的数量",key:"4-5",enCode:"COUNT"},{title:"COUNTIF",desc:"返回满足条件的输入数量",key:"4-6",enCode:"COUNTIF"}]}],functionDescription={SUM:{title:"求和",example:"SUM(数值1,数值2,...)",description:"SUM(数学成绩,语文成绩,英语成绩,...) = 各科总成绩"},SUMIF:{title:"对满足条件的值求和",example:"SUM([数值1,数值2,...], '>数值')",description:"SUMIF([2,4,8,16], '>5') = 24"},AVERAGE:{title:"平均数",example:"AVERAGE(数值1,数值2,...)",description:"AVERAGE(数学成绩,语文成绩,英语成绩,...) = 平均成绩"},IF:{title:"条件判断",example:"IF(条件,真值,假值)",description:"IF(数学成绩>90,优秀,良好)"},MOD:{title:"求余数",example:"MOD(3, -2)",description:"返回第一个数除第二数的余数,结果：-1"},ABS:{title:"绝对值",example:"ABS(-2)",description:"返回结果：2"},RAND:{title:"随机数",example:"RAND()",description:"返回[0,1]区间的随机数"},ROUND:{title:"四舍五入取整",example:"ROUND(626.3, -3)",description:"四舍五入取整，第二个参数控制保留到小数点后几位，如果是负数则向小数点前保留，上面例子返回1000，相当于在百位上四舍五入"},ROUNDDOWN:{title:"向下取整",example:"ROUNDDOWN(-3.14159, 2)",description:"向下取整，第二个参数控制保留到小数点后几位，如果是负数则向小数点前保留，上面例子返回-3.14"},ROUNDUP:{title:"向上取整",example:"ROUNDUP(-3.14159, 2)",description:"第二个参数控制保留到小数点后几位，如果是负数则向小数点前保留，上面例子返回-3.15"},SQRT:{title:"平方根",example:"SQRT(16)",description:"返回一个数的平方根，上面例子返回4"},DAY:{title:"获取日期中的天",example:"DAY('2025-02-25')",description:"返回一个日期的天，上面例子返回25"},HOUR:{title:"获取日期中的小时",example:"HOUR('7/18/2011 7:45:00 AM')",description:"返回一个日期的小时，上面例子返回7"},MINUTE:{title:"获取日期中的分钟",example:"MINUTE('7/18/2011 7:45:00 AM')",description:"返回一个日期的分钟，上面例子返回45"},SECOND:{title:"获取日期中的秒数",example:"SECOND('2/1/2011 4:48:18 PM')",description:"返回一个日期的秒数，上面例子返回18"},MONTH:{title:"获取日期中的月份",example:"MONTH('2025-02-25')",description:"返回一个日期的秒数，上面例子返回2"},YEAR:{title:"获取日期中的年份",example:"YEAR('2025-02-25')",description:"返回一个日期的秒数，上面例子返回2025"},NOW:{title:"获取当前日期，包含时间",example:"NOW()",description:"返回当前系统时间，Wed Mar 19 2025 17:27:49 GMT+0800 (中国标准时间)"},DATE:{title:"通过输入年月日生成时间",example:"DATE(2025, 9, 10)",description:"生成时间：Wed Sep 10 2025 00:00:00 GMT+0800 (中国标准时间)"},DATEVALUE:{title:"通过输入日期字符串生成时间",example:"DATEVALUE('8/22/2011')",description:"生成时间：Mon Aug 22 2011 00:00:00 GMT+0800 (中国标准时间)"},DAYS:{title:"返回两个日期相差的天数",example:"DAYS('2025-02-25', '2025-04-25')",description:"如果第一个日期小于第二个日期，则返回的是负数，上面的例子返回-59"},AND:{title:"且运算",example:"AND(true, false, true)",description:"所有输入满足True时输出True，上述例子返回false"},OR:{title:"或运算",example:"OR(true, false, true)",description:"任意输入满足True时输出True，上述例子返回true"},IF:{title:"条件判断",example:"IF(true, 'Hello!', 'Goodbye!')",description:"如果为true返回第一个结果，否则返回第二个，上述例子返回Hello!"},NOT:{title:"非运算",example:"NOT(true)",description:"输出相反的True或者False，上述例子返回false"},TRUE:{title:"真boolen值",example:"TRUE()",description:"返回true"},FALSE:{title:"假boolen值",example:"FALSE()",description:"返回false"},SWITCH:{title:"多条件判断",example:"SWITCH(表达式, 值1, 结果1, 值2, 结果2, ...)",description:"这里的“表达式”是一个计算结果，而“值1”、“值2”等是你要与表达式结果进行比对的值。如果表达式的值与某个值匹配，函数会返回对应的结果；如果没有匹配项，可以指定一个默认值。SWITCH(7, 9, 'Nine', 7, 'Seven')返回结果Seven"},MAX:{title:"获取一组输入中最大的数",example:"MAX([0.1,0.2], [0.4,0.8]) or MAX(0.1,0.2,0.8,0.4)",description:"上述示例返回0.8"},MIN:{title:"获取一组输入中最小的数",example:"MIN([0.1,0.2], [0.4,0.8]) or MIN(0.1,0.2,0.8,0.4)",description:"上述示例返回0.1"},AVERAGE:{title:"求平均数",example:"AVERAGE([2,4], [8,16]) or AVERAGE(2,4,8,16)",description:"上述示例返回7.5"},AVEDEV:{title:"求偏差平均值",example:"AVEDEV([2,4], [8,16] or or AVERAGE(2,4,8,16))",description:"上述示例返回4.5"},COUNT:{title:"返回输入的数量",example:"COUNT([2,4], [8,16] or or COUNT(2,4,8,16))",description:"上述示例返回4"},COUNTIF:{title:"返回满足条件的输入数量",example:"COUNTIF([1,2,3,4],'>3')",description:"上述示例返回1"}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(L){VALID_ANSI.indexOf(L)!=-1&&(current_ansi=CS2CP[0]=L)};function reset_ansi(){set_ansi(1252)}var set_cp=function(L){set_ansi(L)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(L){for(var S=[],T=0,_=L.length;T<_;++T)S[T]=L.charCodeAt(T);return S}function utf16leread(L){for(var S=[],T=0;T<L.length>>1;++T)S[T]=String.fromCharCode(L.charCodeAt(2*T)+(L.charCodeAt(2*T+1)<<8));return S.join("")}function utf16beread(L){for(var S=[],T=0;T<L.length>>1;++T)S[T]=String.fromCharCode(L.charCodeAt(2*T+1)+(L.charCodeAt(2*T)<<8));return S.join("")}var debom=function(L){var S=L.charCodeAt(0),T=L.charCodeAt(1);return S==255&&T==254?utf16leread(L.slice(2)):S==254&&T==255?utf16beread(L.slice(2)):S==65279?L.slice(1):L},_getchar=function(S){return String.fromCharCode(S)},_getansi=function(S){return String.fromCharCode(S)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(L){for(var S="",T=0,_=0,w=0,B=0,A=0,O=0,R=0,P=0;P<L.length;)T=L.charCodeAt(P++),B=T>>2,_=L.charCodeAt(P++),A=(T&3)<<4|_>>4,w=L.charCodeAt(P++),O=(_&15)<<2|w>>6,R=w&63,isNaN(_)?O=R=64:isNaN(w)&&(R=64),S+=Base64_map.charAt(B)+Base64_map.charAt(A)+Base64_map.charAt(O)+Base64_map.charAt(R);return S}function Base64_decode(L){var S="",T=0,_=0,w=0,B=0,A=0,O=0,R=0;L=L.replace(/[^\w\+\/\=]/g,"");for(var P=0;P<L.length;)B=Base64_map.indexOf(L.charAt(P++)),A=Base64_map.indexOf(L.charAt(P++)),T=B<<2|A>>4,S+=String.fromCharCode(T),O=Base64_map.indexOf(L.charAt(P++)),_=(A&15)<<4|O>>2,O!==64&&(S+=String.fromCharCode(_)),R=Base64_map.indexOf(L.charAt(P++)),w=(O&3)<<6|R,R!==64&&(S+=String.fromCharCode(w));return S}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var L=!Buffer.from;if(!L)try{Buffer.from("foo","utf8")}catch(S){L=!0}return L?function(S,T){return T?new Buffer(S,T):new Buffer(S)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(L){return has_buf?Buffer.alloc?Buffer.alloc(L):new Buffer(L):typeof Uint8Array<"u"?new Uint8Array(L):new Array(L)}function new_unsafe_buf(L){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(L):new Buffer(L):typeof Uint8Array<"u"?new Uint8Array(L):new Array(L)}var s2a=function(S){return has_buf?Buffer_from(S,"binary"):S.split("").map(function(T){return T.charCodeAt(0)&255})};function a2s(L){if(Array.isArray(L))return L.map(function(_){return String.fromCharCode(_)}).join("");for(var S=[],T=0;T<L.length;++T)S[T]=String.fromCharCode(L[T]);return S.join("")}function ab2a(L){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(L instanceof ArrayBuffer)return ab2a(new Uint8Array(L));for(var S=new Array(L.length),T=0;T<L.length;++T)S[T]=L[T];return S}var bconcat=has_buf?function(L){return Buffer.concat(L.map(function(S){return Buffer.isBuffer(S)?S:Buffer_from(S)}))}:function(L){if(typeof Uint8Array<"u"){var S=0,T=0;for(S=0;S<L.length;++S)T+=L[S].length;var _=new Uint8Array(T),w=0;for(S=0,T=0;S<L.length;T+=w,++S)if(w=L[S].length,L[S]instanceof Uint8Array)_.set(L[S],T);else{if(typeof L[S]=="string")throw"wtf";_.set(new Uint8Array(L[S]),T)}return _}return[].concat.apply([],L.map(function(B){return Array.isArray(B)?B:[].slice.call(B)}))};function utf8decode(L){for(var S=[],T=0,_=L.length+250,w=new_raw_buf(L.length+255),B=0;B<L.length;++B){var A=L.charCodeAt(B);if(A<128)w[T++]=A;else if(A<2048)w[T++]=192|A>>6&31,w[T++]=128|A&63;else if(A>=55296&&A<57344){A=(A&1023)+64;var O=L.charCodeAt(++B)&1023;w[T++]=240|A>>8&7,w[T++]=128|A>>2&63,w[T++]=128|O>>6&15|(A&3)<<4,w[T++]=128|O&63}else w[T++]=224|A>>12&15,w[T++]=128|A>>6&63,w[T++]=128|A&63;T>_&&(S.push(w.slice(0,T)),T=0,w=new_raw_buf(65535),_=65530)}return S.push(w.slice(0,T)),bconcat(S)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(L){for(var S="",T=L.length-1;T>=0;)S+=L.charAt(T--);return S}function pad0(L,S){var T=""+L;return T.length>=S?T:fill("0",S-T.length)+T}function pad_(L,S){var T=""+L;return T.length>=S?T:fill(" ",S-T.length)+T}function rpad_(L,S){var T=""+L;return T.length>=S?T:T+fill(" ",S-T.length)}function pad0r1(L,S){var T=""+Math.round(L);return T.length>=S?T:fill("0",S-T.length)+T}function pad0r2(L,S){var T=""+L;return T.length>=S?T:fill("0",S-T.length)+T}var p2_32=Math.pow(2,32);function pad0r(L,S){if(L>p2_32||L<-p2_32)return pad0r1(L,S);var T=Math.round(L);return pad0r2(T,S)}function SSF_isgeneral(L,S){return S=S||0,L.length>=7+S&&(L.charCodeAt(S)|32)===103&&(L.charCodeAt(S+1)|32)===101&&(L.charCodeAt(S+2)|32)===110&&(L.charCodeAt(S+3)|32)===101&&(L.charCodeAt(S+4)|32)===114&&(L.charCodeAt(S+5)|32)===97&&(L.charCodeAt(S+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(L){return L||(L={}),L[0]="General",L[1]="0",L[2]="0.00",L[3]="#,##0",L[4]="#,##0.00",L[9]="0%",L[10]="0.00%",L[11]="0.00E+00",L[12]="# ?/?",L[13]="# ??/??",L[14]="m/d/yy",L[15]="d-mmm-yy",L[16]="d-mmm",L[17]="mmm-yy",L[18]="h:mm AM/PM",L[19]="h:mm:ss AM/PM",L[20]="h:mm",L[21]="h:mm:ss",L[22]="m/d/yy h:mm",L[37]="#,##0 ;(#,##0)",L[38]="#,##0 ;[Red](#,##0)",L[39]="#,##0.00;(#,##0.00)",L[40]="#,##0.00;[Red](#,##0.00)",L[45]="mm:ss",L[46]="[h]:mm:ss",L[47]="mmss.0",L[48]="##0.0E+0",L[49]="@",L[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',L}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(L,S,T){for(var _=L<0?-1:1,w=L*_,B=0,A=1,O=0,R=1,P=0,E=0,D=Math.floor(w);P<S&&(D=Math.floor(w),O=D*A+B,E=D*P+R,!(w-D<5e-8));)w=1/(w-D),B=A,A=O,R=P,P=E;if(E>S&&(P>S?(E=R,O=B):(E=P,O=A)),!T)return[0,_*O,E];var I=Math.floor(_*O/E);return[I,_*O-I*E,E]}function SSF_parse_date_code(L,S,T){if(L>2958465||L<0)return null;var _=L|0,w=Math.floor(86400*(L-_)),B=0,A=[],O={D:_,T:w,u:86400*(L-_)-w,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(O.u)<1e-6&&(O.u=0),S&&S.date1904&&(_+=1462),O.u>.9999&&(O.u=0,++w==86400&&(O.T=w=0,++_,++O.D)),_===60)A=T?[1317,10,29]:[1900,2,29],B=3;else if(_===0)A=T?[1317,8,29]:[1900,1,0],B=6;else{_>60&&--_;var R=new Date(1900,0,1);R.setDate(R.getDate()+_-1),A=[R.getFullYear(),R.getMonth()+1,R.getDate()],B=R.getDay(),_<60&&(B=(B+6)%7),T&&(B=SSF_fix_hijri(R,A))}return O.y=A[0],O.m=A[1],O.d=A[2],O.S=w%60,w=Math.floor(w/60),O.M=w%60,w=Math.floor(w/60),O.H=w,O.q=B,O}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(L,S){var T=L.getTime();return S?T-=1461*24*60*60*1e3:L>=SSFbase1904&&(T+=24*60*60*1e3),(T-(SSFdnthresh+(L.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(L){return L.indexOf(".")==-1?L:L.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(L){return L.indexOf("E")==-1?L:L.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(L){var S=L<0?12:11,T=SSF_strip_decimal(L.toFixed(12));return T.length<=S||(T=L.toPrecision(10),T.length<=S)?T:L.toExponential(5)}function SSF_large_exp(L){var S=SSF_strip_decimal(L.toFixed(11));return S.length>(L<0?12:11)||S==="0"||S==="-0"?L.toPrecision(6):S}function SSF_general_num(L){var S=Math.floor(Math.log(Math.abs(L))*Math.LOG10E),T;return S>=-4&&S<=-1?T=L.toPrecision(10+S):Math.abs(S)<=9?T=SSF_small_exp(L):S===10?T=L.toFixed(10).substr(0,12):T=SSF_large_exp(L),SSF_strip_decimal(SSF_normalize_exp(T.toUpperCase()))}function SSF_general(L,S){switch(typeof L){case"string":return L;case"boolean":return L?"TRUE":"FALSE";case"number":return(L|0)===L?L.toString(10):SSF_general_num(L);case"undefined":return"";case"object":if(L==null)return"";if(L instanceof Date)return SSF_format(14,datenum_local(L,S&&S.date1904),S)}throw new Error("unsupported value in General format: "+L)}function SSF_fix_hijri(L,S){S[0]-=581;var T=L.getDay();return L<60&&(T=(T+6)%7),T}function SSF_write_date(L,S,T,_){var w="",B=0,A=0,O=T.y,R,P=0;switch(L){case 98:O=T.y+543;case 121:switch(S.length){case 1:case 2:R=O%100,P=2;break;default:R=O%1e4,P=4;break}break;case 109:switch(S.length){case 1:case 2:R=T.m,P=S.length;break;case 3:return months[T.m-1][1];case 5:return months[T.m-1][0];default:return months[T.m-1][2]}break;case 100:switch(S.length){case 1:case 2:R=T.d,P=S.length;break;case 3:return days[T.q][0];default:return days[T.q][1]}break;case 104:switch(S.length){case 1:case 2:R=1+(T.H+11)%12,P=S.length;break;default:throw"bad hour format: "+S}break;case 72:switch(S.length){case 1:case 2:R=T.H,P=S.length;break;default:throw"bad hour format: "+S}break;case 77:switch(S.length){case 1:case 2:R=T.M,P=S.length;break;default:throw"bad minute format: "+S}break;case 115:if(S!="s"&&S!="ss"&&S!=".0"&&S!=".00"&&S!=".000")throw"bad second format: "+S;return T.u===0&&(S=="s"||S=="ss")?pad0(T.S,S.length):(_>=2?A=_===3?1e3:100:A=_===1?10:1,B=Math.round(A*(T.S+T.u)),B>=60*A&&(B=0),S==="s"?B===0?"0":""+B/A:(w=pad0(B,2+_),S==="ss"?w.substr(0,2):"."+w.substr(2,S.length-1)));case 90:switch(S){case"[h]":case"[hh]":R=T.D*24+T.H;break;case"[m]":case"[mm]":R=(T.D*24+T.H)*60+T.M;break;case"[s]":case"[ss]":R=((T.D*24+T.H)*60+T.M)*60+Math.round(T.S+T.u);break;default:throw"bad abstime format: "+S}P=S.length===3?1:2;break;case 101:R=O,P=1;break}var E=P>0?pad0(R,P):"";return E}function commaify(L){var S=3;if(L.length<=S)return L;for(var T=L.length%S,_=L.substr(0,T);T!=L.length;T+=S)_+=(_.length>0?",":"")+L.substr(T,S);return _}var pct1=/%/g;function write_num_pct(L,S,T){var _=S.replace(pct1,""),w=S.length-_.length;return write_num(L,_,T*Math.pow(10,2*w))+fill("%",w)}function write_num_cm(L,S,T){for(var _=S.length-1;S.charCodeAt(_-1)===44;)--_;return write_num(L,S.substr(0,_),T/Math.pow(10,3*(S.length-_)))}function write_num_exp(L,S){var T,_=L.indexOf("E")-L.indexOf(".")-1;if(L.match(/^#+0.0E\+0$/)){if(S==0)return"0.0E+0";if(S<0)return"-"+write_num_exp(L,-S);var w=L.indexOf(".");w===-1&&(w=L.indexOf("E"));var B=Math.floor(Math.log(S)*Math.LOG10E)%w;if(B<0&&(B+=w),T=(S/Math.pow(10,B)).toPrecision(_+1+(w+B)%w),T.indexOf("e")===-1){var A=Math.floor(Math.log(S)*Math.LOG10E);for(T.indexOf(".")===-1?T=T.charAt(0)+"."+T.substr(1)+"E+"+(A-T.length+B):T+="E+"+(A-B);T.substr(0,2)==="0.";)T=T.charAt(0)+T.substr(2,w)+"."+T.substr(2+w),T=T.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");T=T.replace(/\+-/,"-")}T=T.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,R,P,E){return R+P+E.substr(0,(w+B)%w)+"."+E.substr(B)+"E"})}else T=S.toExponential(_);return L.match(/E\+00$/)&&T.match(/e[+-]\d$/)&&(T=T.substr(0,T.length-1)+"0"+T.charAt(T.length-1)),L.match(/E\-/)&&T.match(/e\+/)&&(T=T.replace(/e\+/,"e")),T.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(L,S,T){var _=parseInt(L[4],10),w=Math.round(S*_),B=Math.floor(w/_),A=w-B*_,O=_;return T+(B===0?"":""+B)+" "+(A===0?fill(" ",L[1].length+1+L[4].length):pad_(A,L[1].length)+L[2]+"/"+L[3]+pad0(O,L[4].length))}function write_num_f2(L,S,T){return T+(S===0?"":""+S)+fill(" ",L[1].length+2+L[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(L){for(var S="",T,_=0;_!=L.length;++_)switch(T=L.charCodeAt(_)){case 35:break;case 63:S+=" ";break;case 48:S+="0";break;default:S+=String.fromCharCode(T)}return S}function rnd(L,S){var T=Math.pow(10,S);return""+Math.round(L*T)/T}function dec(L,S){var T=L-Math.floor(L),_=Math.pow(10,S);return S<(""+Math.round(T*_)).length?0:Math.round(T*_)}function carry(L,S){return S<(""+Math.round((L-Math.floor(L))*Math.pow(10,S))).length?1:0}function flr(L){return L<2147483647&&L>-2147483648?""+(L>=0?L|0:L-1|0):""+Math.floor(L)}function write_num_flt(L,S,T){if(L.charCodeAt(0)===40&&!S.match(closeparen)){var _=S.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return T>=0?write_num_flt("n",_,T):"("+write_num_flt("n",_,-T)+")"}if(S.charCodeAt(S.length-1)===44)return write_num_cm(L,S,T);if(S.indexOf("%")!==-1)return write_num_pct(L,S,T);if(S.indexOf("E")!==-1)return write_num_exp(S,T);if(S.charCodeAt(0)===36)return"$"+write_num_flt(L,S.substr(S.charAt(1)==" "?2:1),T);var w,B,A,O,R=Math.abs(T),P=T<0?"-":"";if(S.match(/^00+$/))return P+pad0r(R,S.length);if(S.match(/^[#?]+$/))return w=pad0r(T,0),w==="0"&&(w=""),w.length>S.length?w:hashq(S.substr(0,S.length-w.length))+w;if(B=S.match(frac1))return write_num_f1(B,R,P);if(S.match(/^#+0+$/))return P+pad0r(R,S.length-S.indexOf("0"));if(B=S.match(dec1))return w=rnd(T,B[1].length).replace(/^([^\.]+)$/,"$1."+hashq(B[1])).replace(/\.$/,"."+hashq(B[1])).replace(/\.(\d*)$/,function(N,k){return"."+k+fill("0",hashq(B[1]).length-k.length)}),S.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(S=S.replace(/^#+([0.])/,"$1"),B=S.match(/^(0*)\.(#*)$/))return P+rnd(R,B[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,B[1].length?"0.":".");if(B=S.match(/^#{1,3},##0(\.?)$/))return P+commaify(pad0r(R,0));if(B=S.match(/^#,##0\.([#0]*0)$/))return T<0?"-"+write_num_flt(L,S,-T):commaify(""+(Math.floor(T)+carry(T,B[1].length)))+"."+pad0(dec(T,B[1].length),B[1].length);if(B=S.match(/^#,#*,#0/))return write_num_flt(L,S.replace(/^#,#*,/,""),T);if(B=S.match(/^([0#]+)(\\?-([0#]+))+$/))return w=_strrev(write_num_flt(L,S.replace(/[\\-]/g,""),T)),A=0,_strrev(_strrev(S.replace(/\\/g,"")).replace(/[0#]/g,function(N){return A<w.length?w.charAt(A++):N==="0"?"0":""}));if(S.match(phone))return w=write_num_flt(L,"##########",T),"("+w.substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var E="";if(B=S.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(B[4].length,7),O=SSF_frac(R,Math.pow(10,A)-1,!1),w=""+P,E=write_num("n",B[1],O[1]),E.charAt(E.length-1)==" "&&(E=E.substr(0,E.length-1)+"0"),w+=E+B[2]+"/"+B[3],E=rpad_(O[2],A),E.length<B[4].length&&(E=hashq(B[4].substr(B[4].length-E.length))+E),w+=E,w;if(B=S.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(Math.max(B[1].length,B[4].length),7),O=SSF_frac(R,Math.pow(10,A)-1,!0),P+(O[0]||(O[1]?"":"0"))+" "+(O[1]?pad_(O[1],A)+B[2]+"/"+B[3]+rpad_(O[2],A):fill(" ",2*A+1+B[2].length+B[3].length));if(B=S.match(/^[#0?]+$/))return w=pad0r(T,0),S.length<=w.length?w:hashq(S.substr(0,S.length-w.length))+w;if(B=S.match(/^([#0?]+)\.([#0]+)$/)){w=""+T.toFixed(Math.min(B[2].length,10)).replace(/([^0])0+$/,"$1"),A=w.indexOf(".");var D=S.indexOf(".")-A,I=S.length-w.length-D;return hashq(S.substr(0,D)+w+S.substr(S.length-I))}if(B=S.match(/^00,000\.([#0]*0)$/))return A=dec(T,B[1].length),T<0?"-"+write_num_flt(L,S,-T):commaify(flr(T)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?pad0(0,3-N.length):"")+N})+"."+pad0(A,B[1].length);switch(S){case"###,##0.00":return write_num_flt(L,"#,##0.00",T);case"###,###":case"##,###":case"#,###":var M=commaify(pad0r(R,0));return M!=="0"?P+M:"";case"###,###.00":return write_num_flt(L,"###,##0.00",T).replace(/^0\./,".");case"#,###.00":return write_num_flt(L,"#,##0.00",T).replace(/^0\./,".")}throw new Error("unsupported format |"+S+"|")}function write_num_cm2(L,S,T){for(var _=S.length-1;S.charCodeAt(_-1)===44;)--_;return write_num(L,S.substr(0,_),T/Math.pow(10,3*(S.length-_)))}function write_num_pct2(L,S,T){var _=S.replace(pct1,""),w=S.length-_.length;return write_num(L,_,T*Math.pow(10,2*w))+fill("%",w)}function write_num_exp2(L,S){var T,_=L.indexOf("E")-L.indexOf(".")-1;if(L.match(/^#+0.0E\+0$/)){if(S==0)return"0.0E+0";if(S<0)return"-"+write_num_exp2(L,-S);var w=L.indexOf(".");w===-1&&(w=L.indexOf("E"));var B=Math.floor(Math.log(S)*Math.LOG10E)%w;if(B<0&&(B+=w),T=(S/Math.pow(10,B)).toPrecision(_+1+(w+B)%w),!T.match(/[Ee]/)){var A=Math.floor(Math.log(S)*Math.LOG10E);T.indexOf(".")===-1?T=T.charAt(0)+"."+T.substr(1)+"E+"+(A-T.length+B):T+="E+"+(A-B),T=T.replace(/\+-/,"-")}T=T.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(O,R,P,E){return R+P+E.substr(0,(w+B)%w)+"."+E.substr(B)+"E"})}else T=S.toExponential(_);return L.match(/E\+00$/)&&T.match(/e[+-]\d$/)&&(T=T.substr(0,T.length-1)+"0"+T.charAt(T.length-1)),L.match(/E\-/)&&T.match(/e\+/)&&(T=T.replace(/e\+/,"e")),T.replace("e","E")}function write_num_int(L,S,T){if(L.charCodeAt(0)===40&&!S.match(closeparen)){var _=S.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return T>=0?write_num_int("n",_,T):"("+write_num_int("n",_,-T)+")"}if(S.charCodeAt(S.length-1)===44)return write_num_cm2(L,S,T);if(S.indexOf("%")!==-1)return write_num_pct2(L,S,T);if(S.indexOf("E")!==-1)return write_num_exp2(S,T);if(S.charCodeAt(0)===36)return"$"+write_num_int(L,S.substr(S.charAt(1)==" "?2:1),T);var w,B,A,O,R=Math.abs(T),P=T<0?"-":"";if(S.match(/^00+$/))return P+pad0(R,S.length);if(S.match(/^[#?]+$/))return w=""+T,T===0&&(w=""),w.length>S.length?w:hashq(S.substr(0,S.length-w.length))+w;if(B=S.match(frac1))return write_num_f2(B,R,P);if(S.match(/^#+0+$/))return P+pad0(R,S.length-S.indexOf("0"));if(B=S.match(dec1))return w=(""+T).replace(/^([^\.]+)$/,"$1."+hashq(B[1])).replace(/\.$/,"."+hashq(B[1])),w=w.replace(/\.(\d*)$/,function(N,k){return"."+k+fill("0",hashq(B[1]).length-k.length)}),S.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(S=S.replace(/^#+([0.])/,"$1"),B=S.match(/^(0*)\.(#*)$/))return P+(""+R).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,B[1].length?"0.":".");if(B=S.match(/^#{1,3},##0(\.?)$/))return P+commaify(""+R);if(B=S.match(/^#,##0\.([#0]*0)$/))return T<0?"-"+write_num_int(L,S,-T):commaify(""+T)+"."+fill("0",B[1].length);if(B=S.match(/^#,#*,#0/))return write_num_int(L,S.replace(/^#,#*,/,""),T);if(B=S.match(/^([0#]+)(\\?-([0#]+))+$/))return w=_strrev(write_num_int(L,S.replace(/[\\-]/g,""),T)),A=0,_strrev(_strrev(S.replace(/\\/g,"")).replace(/[0#]/g,function(N){return A<w.length?w.charAt(A++):N==="0"?"0":""}));if(S.match(phone))return w=write_num_int(L,"##########",T),"("+w.substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var E="";if(B=S.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(B[4].length,7),O=SSF_frac(R,Math.pow(10,A)-1,!1),w=""+P,E=write_num("n",B[1],O[1]),E.charAt(E.length-1)==" "&&(E=E.substr(0,E.length-1)+"0"),w+=E+B[2]+"/"+B[3],E=rpad_(O[2],A),E.length<B[4].length&&(E=hashq(B[4].substr(B[4].length-E.length))+E),w+=E,w;if(B=S.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(Math.max(B[1].length,B[4].length),7),O=SSF_frac(R,Math.pow(10,A)-1,!0),P+(O[0]||(O[1]?"":"0"))+" "+(O[1]?pad_(O[1],A)+B[2]+"/"+B[3]+rpad_(O[2],A):fill(" ",2*A+1+B[2].length+B[3].length));if(B=S.match(/^[#0?]+$/))return w=""+T,S.length<=w.length?w:hashq(S.substr(0,S.length-w.length))+w;if(B=S.match(/^([#0]+)\.([#0]+)$/)){w=""+T.toFixed(Math.min(B[2].length,10)).replace(/([^0])0+$/,"$1"),A=w.indexOf(".");var D=S.indexOf(".")-A,I=S.length-w.length-D;return hashq(S.substr(0,D)+w+S.substr(S.length-I))}if(B=S.match(/^00,000\.([#0]*0)$/))return T<0?"-"+write_num_int(L,S,-T):commaify(""+T).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?pad0(0,3-N.length):"")+N})+"."+pad0(0,B[1].length);switch(S){case"###,###":case"##,###":case"#,###":var M=commaify(""+R);return M!=="0"?P+M:"";default:if(S.match(/\.[0#?]*$/))return write_num_int(L,S.slice(0,S.lastIndexOf(".")),T)+hashq(S.slice(S.lastIndexOf(".")))}throw new Error("unsupported format |"+S+"|")}function write_num(L,S,T){return(T|0)===T?write_num_int(L,S,T):write_num_flt(L,S,T)}function SSF_split_fmt(L){for(var S=[],T=!1,_=0,w=0;_<L.length;++_)switch(L.charCodeAt(_)){case 34:T=!T;break;case 95:case 42:case 92:++_;break;case 59:S[S.length]=L.substr(w,_-w),w=_+1}if(S[S.length]=L.substr(w),T===!0)throw new Error("Format |"+L+"| unterminated string ");return S}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(L){for(var S=0,T="",_="";S<L.length;)switch(T=L.charAt(S)){case"G":SSF_isgeneral(L,S)&&(S+=6),S++;break;case'"':for(;L.charCodeAt(++S)!==34&&S<L.length;);++S;break;case"\\":S+=2;break;case"_":S+=2;break;case"@":++S;break;case"B":case"b":if(L.charAt(S+1)==="1"||L.charAt(S+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(L.substr(S,3).toUpperCase()==="A/P"||L.substr(S,5).toUpperCase()==="AM/PM"||L.substr(S,5).toUpperCase()==="上午/下午")return!0;++S;break;case"[":for(_=T;L.charAt(S++)!=="]"&&S<L.length;)_+=L.charAt(S);if(_.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;S<L.length&&("0#?.,E+-%".indexOf(T=L.charAt(++S))>-1||T=="\\"&&L.charAt(S+1)=="-"&&"0#".indexOf(L.charAt(S+2))>-1););break;case"?":for(;L.charAt(++S)===T;);break;case"*":++S,(L.charAt(S)==" "||L.charAt(S)=="*")&&++S;break;case"(":case")":++S;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;S<L.length&&"0123456789".indexOf(L.charAt(++S))>-1;);break;case" ":++S;break;default:++S;break}return!1}function eval_fmt(L,S,T,_){for(var w=[],B="",A=0,O="",R="t",P,E,D,I="H";A<L.length;)switch(O=L.charAt(A)){case"G":if(!SSF_isgeneral(L,A))throw new Error("unrecognized character "+O+" in "+L);w[w.length]={t:"G",v:"General"},A+=7;break;case'"':for(B="";(D=L.charCodeAt(++A))!==34&&A<L.length;)B+=String.fromCharCode(D);w[w.length]={t:"t",v:B},++A;break;case"\\":var M=L.charAt(++A),N=M==="("||M===")"?M:"t";w[w.length]={t:N,v:M},++A;break;case"_":w[w.length]={t:"t",v:" "},A+=2;break;case"@":w[w.length]={t:"T",v:S},++A;break;case"B":case"b":if(L.charAt(A+1)==="1"||L.charAt(A+1)==="2"){if(P==null&&(P=SSF_parse_date_code(S,T,L.charAt(A+1)==="2"),P==null))return"";w[w.length]={t:"X",v:L.substr(A,2)},R=O,A+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":O=O.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(S<0||P==null&&(P=SSF_parse_date_code(S,T),P==null))return"";for(B=O;++A<L.length&&L.charAt(A).toLowerCase()===O;)B+=O;O==="m"&&R.toLowerCase()==="h"&&(O="M"),O==="h"&&(O=I),w[w.length]={t:O,v:B},R=O;break;case"A":case"a":case"上":var k={t:O,v:O};if(P==null&&(P=SSF_parse_date_code(S,T)),L.substr(A,3).toUpperCase()==="A/P"?(P!=null&&(k.v=P.H>=12?"P":"A"),k.t="T",I="h",A+=3):L.substr(A,5).toUpperCase()==="AM/PM"?(P!=null&&(k.v=P.H>=12?"PM":"AM"),k.t="T",A+=5,I="h"):L.substr(A,5).toUpperCase()==="上午/下午"?(P!=null&&(k.v=P.H>=12?"下午":"上午"),k.t="T",A+=5,I="h"):(k.t="t",++A),P==null&&k.t==="T")return"";w[w.length]=k,R=O;break;case"[":for(B=O;L.charAt(A++)!=="]"&&A<L.length;)B+=L.charAt(A);if(B.slice(-1)!=="]")throw'unterminated "[" block: |'+B+"|";if(B.match(SSF_abstime)){if(P==null&&(P=SSF_parse_date_code(S,T),P==null))return"";w[w.length]={t:"Z",v:B.toLowerCase()},R=B.charAt(1)}else B.indexOf("$")>-1&&(B=(B.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(L)||(w[w.length]={t:"t",v:B}));break;case".":if(P!=null){for(B=O;++A<L.length&&(O=L.charAt(A))==="0";)B+=O;w[w.length]={t:"s",v:B};break}case"0":case"#":for(B=O;++A<L.length&&"0#?.,E+-%".indexOf(O=L.charAt(A))>-1;)B+=O;w[w.length]={t:"n",v:B};break;case"?":for(B=O;L.charAt(++A)===O;)B+=O;w[w.length]={t:O,v:B},R=O;break;case"*":++A,(L.charAt(A)==" "||L.charAt(A)=="*")&&++A;break;case"(":case")":w[w.length]={t:_===1?"t":O,v:O},++A;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(B=O;A<L.length&&"0123456789".indexOf(L.charAt(++A))>-1;)B+=L.charAt(A);w[w.length]={t:"D",v:B};break;case" ":w[w.length]={t:O,v:O},++A;break;case"$":w[w.length]={t:"t",v:"$"},++A;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(O)===-1)throw new Error("unrecognized character "+O+" in "+L);w[w.length]={t:"t",v:O},++A;break}var F=0,G=0,V;for(A=w.length-1,R="t";A>=0;--A)switch(w[A].t){case"h":case"H":w[A].t=I,R="h",F<1&&(F=1);break;case"s":(V=w[A].v.match(/\.0+$/))&&(G=Math.max(G,V[0].length-1)),F<3&&(F=3);case"d":case"y":case"M":case"e":R=w[A].t;break;case"m":R==="s"&&(w[A].t="M",F<2&&(F=2));break;case"X":break;case"Z":F<1&&w[A].v.match(/[Hh]/)&&(F=1),F<2&&w[A].v.match(/[Mm]/)&&(F=2),F<3&&w[A].v.match(/[Ss]/)&&(F=3)}switch(F){case 0:break;case 1:P.u>=.5&&(P.u=0,++P.S),P.S>=60&&(P.S=0,++P.M),P.M>=60&&(P.M=0,++P.H);break;case 2:P.u>=.5&&(P.u=0,++P.S),P.S>=60&&(P.S=0,++P.M);break}var j="",H;for(A=0;A<w.length;++A)switch(w[A].t){case"t":case"T":case" ":case"D":break;case"X":w[A].v="",w[A].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":w[A].v=SSF_write_date(w[A].t.charCodeAt(0),w[A].v,P,G),w[A].t="t";break;case"n":case"?":for(H=A+1;w[H]!=null&&((O=w[H].t)==="?"||O==="D"||(O===" "||O==="t")&&w[H+1]!=null&&(w[H+1].t==="?"||w[H+1].t==="t"&&w[H+1].v==="/")||w[A].t==="("&&(O===" "||O==="n"||O===")")||O==="t"&&(w[H].v==="/"||w[H].v===" "&&w[H+1]!=null&&w[H+1].t=="?"));)w[A].v+=w[H].v,w[H]={v:"",t:";"},++H;j+=w[A].v,A=H-1;break;case"G":w[A].t="t",w[A].v=SSF_general(S,T);break}var U="",X,Y;if(j.length>0){j.charCodeAt(0)==40?(X=S<0&&j.charCodeAt(0)===45?-S:S,Y=write_num("n",j,X)):(X=S<0&&_>1?-S:S,Y=write_num("n",j,X),X<0&&w[0]&&w[0].t=="t"&&(Y=Y.substr(1),w[0].v="-"+w[0].v)),H=Y.length-1;var z=w.length;for(A=0;A<w.length;++A)if(w[A]!=null&&w[A].t!="t"&&w[A].v.indexOf(".")>-1){z=A;break}var W=w.length;if(z===w.length&&Y.indexOf("E")===-1){for(A=w.length-1;A>=0;--A)w[A]==null||"n?".indexOf(w[A].t)===-1||(H>=w[A].v.length-1?(H-=w[A].v.length,w[A].v=Y.substr(H+1,w[A].v.length)):H<0?w[A].v="":(w[A].v=Y.substr(0,H+1),H=-1),w[A].t="t",W=A);H>=0&&W<w.length&&(w[W].v=Y.substr(0,H+1)+w[W].v)}else if(z!==w.length&&Y.indexOf("E")===-1){for(H=Y.indexOf(".")-1,A=z;A>=0;--A)if(!(w[A]==null||"n?".indexOf(w[A].t)===-1)){for(E=w[A].v.indexOf(".")>-1&&A===z?w[A].v.indexOf(".")-1:w[A].v.length-1,U=w[A].v.substr(E+1);E>=0;--E)H>=0&&(w[A].v.charAt(E)==="0"||w[A].v.charAt(E)==="#")&&(U=Y.charAt(H--)+U);w[A].v=U,w[A].t="t",W=A}for(H>=0&&W<w.length&&(w[W].v=Y.substr(0,H+1)+w[W].v),H=Y.indexOf(".")+1,A=z;A<w.length;++A)if(!(w[A]==null||"n?(".indexOf(w[A].t)===-1&&A!==z)){for(E=w[A].v.indexOf(".")>-1&&A===z?w[A].v.indexOf(".")+1:0,U=w[A].v.substr(0,E);E<w[A].v.length;++E)H<Y.length&&(U+=Y.charAt(H++));w[A].v=U,w[A].t="t",W=A}}}for(A=0;A<w.length;++A)w[A]!=null&&"n?".indexOf(w[A].t)>-1&&(X=_>1&&S<0&&A>0&&w[A-1].v==="-"?-S:S,w[A].v=write_num(w[A].t,w[A].v,X),w[A].t="t");var Z="";for(A=0;A!==w.length;++A)w[A]!=null&&(Z+=w[A].v);return Z}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(L,S){if(S==null)return!1;var T=parseFloat(S[2]);switch(S[1]){case"=":if(L==T)return!0;break;case">":if(L>T)return!0;break;case"<":if(L<T)return!0;break;case"<>":if(L!=T)return!0;break;case">=":if(L>=T)return!0;break;case"<=":if(L<=T)return!0;break}return!1}function choose_fmt(L,S){var T=SSF_split_fmt(L),_=T.length,w=T[_-1].indexOf("@");if(_<4&&w>-1&&--_,T.length>4)throw new Error("cannot find right format for |"+T.join("|")+"|");if(typeof S!="number")return[4,T.length===4||w>-1?T[T.length-1]:"@"];switch(T.length){case 1:T=w>-1?["General","General","General",T[0]]:[T[0],T[0],T[0],"@"];break;case 2:T=w>-1?[T[0],T[0],T[0],T[1]]:[T[0],T[1],T[0],"@"];break;case 3:T=w>-1?[T[0],T[1],T[0],T[2]]:[T[0],T[1],T[2],"@"];break}var B=S>0?T[0]:S<0?T[1]:T[2];if(T[0].indexOf("[")===-1&&T[1].indexOf("[")===-1)return[_,B];if(T[0].match(/\[[=<>]/)!=null||T[1].match(/\[[=<>]/)!=null){var A=T[0].match(cfregex2),O=T[1].match(cfregex2);return chkcond(S,A)?[_,T[0]]:chkcond(S,O)?[_,T[1]]:[_,T[A!=null&&O!=null?2:1]]}return[_,B]}function SSF_format(L,S,T){T==null&&(T={});var _="";switch(typeof L){case"string":L=="m/d/yy"&&T.dateNF?_=T.dateNF:_=L;break;case"number":L==14&&T.dateNF?_=T.dateNF:_=(T.table!=null?T.table:table_fmt)[L],_==null&&(_=T.table&&T.table[SSF_default_map[L]]||table_fmt[SSF_default_map[L]]),_==null&&(_=SSF_default_str[L]||"General");break}if(SSF_isgeneral(_,0))return SSF_general(S,T);S instanceof Date&&(S=datenum_local(S,T.date1904));var w=choose_fmt(_,S);if(SSF_isgeneral(w[1]))return SSF_general(S,T);if(S===!0)S="TRUE";else if(S===!1)S="FALSE";else if(S===""||S==null)return"";return eval_fmt(w[1],S,T,w[0])}function SSF_load(L,S){if(typeof S!="number"){S=+S||-1;for(var T=0;T<392;++T){if(table_fmt[T]==null){S<0&&(S=T);continue}if(table_fmt[T]==L){S=T;break}}S<0&&(S=391)}return table_fmt[S]=L,S}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(L){var S=typeof L=="number"?table_fmt[L]:L;return S=S.replace(dateNFregex,"(\\d+)"),new RegExp("^"+S+"$")}function dateNF_fix(L,S,T){var _=-1,w=-1,B=-1,A=-1,O=-1,R=-1;(S.match(dateNFregex)||[]).forEach(function(D,I){var M=parseInt(T[I+1],10);switch(D.toLowerCase().charAt(0)){case"y":_=M;break;case"d":B=M;break;case"h":A=M;break;case"s":R=M;break;case"m":A>=0?O=M:w=M;break}}),R>=0&&O==-1&&w>=0&&(O=w,w=-1);var P=(""+(_>=0?_:new Date().getFullYear())).slice(-4)+"-"+("00"+(w>=1?w:1)).slice(-2)+"-"+("00"+(B>=1?B:1)).slice(-2);P.length==7&&(P="0"+P),P.length==8&&(P="20"+P);var E=("00"+(A>=0?A:0)).slice(-2)+":"+("00"+(O>=0?O:0)).slice(-2)+":"+("00"+(R>=0?R:0)).slice(-2);return A==-1&&O==-1&&R==-1?P:_==-1&&w==-1&&B==-1?E:P+"T"+E}var CRC32=function(){var L={};L.version="1.2.0";function S(){for(var Y=0,z=new Array(256),W=0;W!=256;++W)Y=W,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,z[W]=Y;return typeof Int32Array<"u"?new Int32Array(z):z}var T=S();function _(Y){var z=0,W=0,Z=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)Q[Z]=Y[Z];for(Z=0;Z!=256;++Z)for(W=Y[Z],z=256+Z;z<4096;z+=256)W=Q[z]=W>>>8^Y[W&255];var ee=[];for(Z=1;Z!=16;++Z)ee[Z-1]=typeof Int32Array<"u"?Q.subarray(Z*256,Z*256+256):Q.slice(Z*256,Z*256+256);return ee}var w=_(T),B=w[0],A=w[1],O=w[2],R=w[3],P=w[4],E=w[5],D=w[6],I=w[7],M=w[8],N=w[9],k=w[10],F=w[11],G=w[12],V=w[13],j=w[14];function H(Y,z){for(var W=z^-1,Z=0,Q=Y.length;Z<Q;)W=W>>>8^T[(W^Y.charCodeAt(Z++))&255];return~W}function U(Y,z){for(var W=z^-1,Z=Y.length-15,Q=0;Q<Z;)W=j[Y[Q++]^W&255]^V[Y[Q++]^W>>8&255]^G[Y[Q++]^W>>16&255]^F[Y[Q++]^W>>>24]^k[Y[Q++]]^N[Y[Q++]]^M[Y[Q++]]^I[Y[Q++]]^D[Y[Q++]]^E[Y[Q++]]^P[Y[Q++]]^R[Y[Q++]]^O[Y[Q++]]^A[Y[Q++]]^B[Y[Q++]]^T[Y[Q++]];for(Z+=15;Q<Z;)W=W>>>8^T[(W^Y[Q++])&255];return~W}function X(Y,z){for(var W=z^-1,Z=0,Q=Y.length,ee=0,te=0;Z<Q;)ee=Y.charCodeAt(Z++),ee<128?W=W>>>8^T[(W^ee)&255]:ee<2048?(W=W>>>8^T[(W^(192|ee>>6&31))&255],W=W>>>8^T[(W^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,te=Y.charCodeAt(Z++)&1023,W=W>>>8^T[(W^(240|ee>>8&7))&255],W=W>>>8^T[(W^(128|ee>>2&63))&255],W=W>>>8^T[(W^(128|te>>6&15|(ee&3)<<4))&255],W=W>>>8^T[(W^(128|te&63))&255]):(W=W>>>8^T[(W^(224|ee>>12&15))&255],W=W>>>8^T[(W^(128|ee>>6&63))&255],W=W>>>8^T[(W^(128|ee&63))&255]);return~W}return L.table=T,L.bstr=H,L.buf=U,L.str=X,L}(),CFB=function(){var S={};S.version="1.2.1";function T(tt,ft){for(var lt=tt.split("/"),at=ft.split("/"),dt=0,_t=0,Ct=Math.min(lt.length,at.length);dt<Ct;++dt){if(_t=lt[dt].length-at[dt].length)return _t;if(lt[dt]!=at[dt])return lt[dt]<at[dt]?-1:1}return lt.length-at.length}function _(tt){if(tt.charAt(tt.length-1)=="/")return tt.slice(0,-1).indexOf("/")===-1?tt:_(tt.slice(0,-1));var ft=tt.lastIndexOf("/");return ft===-1?tt:tt.slice(0,ft+1)}function w(tt){if(tt.charAt(tt.length-1)=="/")return w(tt.slice(0,-1));var ft=tt.lastIndexOf("/");return ft===-1?tt:tt.slice(ft+1)}function B(tt,ft){typeof ft=="string"&&(ft=new Date(ft));var lt=ft.getHours();lt=lt<<6|ft.getMinutes(),lt=lt<<5|ft.getSeconds()>>>1,tt.write_shift(2,lt);var at=ft.getFullYear()-1980;at=at<<4|ft.getMonth()+1,at=at<<5|ft.getDate(),tt.write_shift(2,at)}function A(tt){var ft=tt.read_shift(2)&65535,lt=tt.read_shift(2)&65535,at=new Date,dt=lt&31;lt>>>=5;var _t=lt&15;lt>>>=4,at.setMilliseconds(0),at.setFullYear(lt+1980),at.setMonth(_t-1),at.setDate(dt);var Ct=ft&31;ft>>>=5;var It=ft&63;return ft>>>=6,at.setHours(ft),at.setMinutes(It),at.setSeconds(Ct<<1),at}function O(tt){prep_blob(tt,0);for(var ft={},lt=0;tt.l<=tt.length-4;){var at=tt.read_shift(2),dt=tt.read_shift(2),_t=tt.l+dt,Ct={};switch(at){case 21589:lt=tt.read_shift(1),lt&1&&(Ct.mtime=tt.read_shift(4)),dt>5&&(lt&2&&(Ct.atime=tt.read_shift(4)),lt&4&&(Ct.ctime=tt.read_shift(4))),Ct.mtime&&(Ct.mt=new Date(Ct.mtime*1e3));break}tt.l=_t,ft[at]=Ct}return ft}var R;function P(){return R||(R={})}function E(tt,ft){if(tt[0]==80&&tt[1]==75)return qe(tt,ft);if((tt[0]|32)==109&&(tt[1]|32)==105)return Yt(tt,ft);if(tt.length<512)throw new Error("CFB file size "+tt.length+" < 512");var lt=3,at=512,dt=0,_t=0,Ct=0,It=0,xt=0,yt=[],At=tt.slice(0,512);prep_blob(At,0);var Rt=D(At);switch(lt=Rt[0],lt){case 3:at=512;break;case 4:at=4096;break;case 0:if(Rt[1]==0)return qe(tt,ft);default:throw new Error("Major Version: Expected 3 or 4 saw "+lt)}at!==512&&(At=tt.slice(0,at),prep_blob(At,28));var Gt=tt.slice(0,at);I(At,lt);var Mt=At.read_shift(4,"i");if(lt===3&&Mt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Mt);At.l+=4,Ct=At.read_shift(4,"i"),At.l+=4,At.chk("00100000","Mini Stream Cutoff Size: "),It=At.read_shift(4,"i"),dt=At.read_shift(4,"i"),xt=At.read_shift(4,"i"),_t=At.read_shift(4,"i");for(var Nt=-1,kt=0;kt<109&&(Nt=At.read_shift(4,"i"),!(Nt<0));++kt)yt[kt]=Nt;var er=M(tt,at);F(xt,_t,er,at,yt);var hr=V(er,Ct,yt,at);hr[Ct].name="!Directory",dt>0&&It!==te&&(hr[It].name="!MiniFAT"),hr[yt[0]].name="!FAT",hr.fat_addrs=yt,hr.ssz=at;var cr={},xr=[],Ar=[],Er=[];j(Ct,hr,er,xr,dt,cr,Ar,It),N(Ar,Er,xr),xr.shift();var br={FileIndex:Ar,FullPaths:Er};return ft&&ft.raw&&(br.raw={header:Gt,sectors:er}),br}function D(tt){if(tt[tt.l]==80&&tt[tt.l+1]==75)return[0,0];tt.chk(re,"Header Signature: "),tt.l+=16;var ft=tt.read_shift(2,"u");return[tt.read_shift(2,"u"),ft]}function I(tt,ft){var lt=9;switch(tt.l+=2,lt=tt.read_shift(2)){case 9:if(ft!=3)throw new Error("Sector Shift: Expected 9 saw "+lt);break;case 12:if(ft!=4)throw new Error("Sector Shift: Expected 12 saw "+lt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+lt)}tt.chk("0600","Mini Sector Shift: "),tt.chk("000000000000","Reserved: ")}function M(tt,ft){for(var lt=Math.ceil(tt.length/ft)-1,at=[],dt=1;dt<lt;++dt)at[dt-1]=tt.slice(dt*ft,(dt+1)*ft);return at[lt-1]=tt.slice(lt*ft),at}function N(tt,ft,lt){for(var at=0,dt=0,_t=0,Ct=0,It=0,xt=lt.length,yt=[],At=[];at<xt;++at)yt[at]=At[at]=at,ft[at]=lt[at];for(;It<At.length;++It)at=At[It],dt=tt[at].L,_t=tt[at].R,Ct=tt[at].C,yt[at]===at&&(dt!==-1&&yt[dt]!==dt&&(yt[at]=yt[dt]),_t!==-1&&yt[_t]!==_t&&(yt[at]=yt[_t])),Ct!==-1&&(yt[Ct]=at),dt!==-1&&at!=yt[at]&&(yt[dt]=yt[at],At.lastIndexOf(dt)<It&&At.push(dt)),_t!==-1&&at!=yt[at]&&(yt[_t]=yt[at],At.lastIndexOf(_t)<It&&At.push(_t));for(at=1;at<xt;++at)yt[at]===at&&(_t!==-1&&yt[_t]!==_t?yt[at]=yt[_t]:dt!==-1&&yt[dt]!==dt&&(yt[at]=yt[dt]));for(at=1;at<xt;++at)if(tt[at].type!==0){if(It=at,It!=yt[It])do It=yt[It],ft[at]=ft[It]+"/"+ft[at];while(It!==0&&yt[It]!==-1&&It!=yt[It]);yt[at]=-1}for(ft[0]+="/",at=1;at<xt;++at)tt[at].type!==2&&(ft[at]+="/")}function k(tt,ft,lt){for(var at=tt.start,dt=tt.size,_t=[],Ct=at;lt&&dt>0&&Ct>=0;)_t.push(ft.slice(Ct*ee,Ct*ee+ee)),dt-=ee,Ct=__readInt32LE(lt,Ct*4);return _t.length===0?new_buf(0):bconcat(_t).slice(0,tt.size)}function F(tt,ft,lt,at,dt){var _t=te;if(tt===te){if(ft!==0)throw new Error("DIFAT chain shorter than expected")}else if(tt!==-1){var Ct=lt[tt],It=(at>>>2)-1;if(!Ct)return;for(var xt=0;xt<It&&(_t=__readInt32LE(Ct,xt*4))!==te;++xt)dt.push(_t);F(__readInt32LE(Ct,at-4),ft-1,lt,at,dt)}}function G(tt,ft,lt,at,dt){var _t=[],Ct=[];dt||(dt=[]);var It=at-1,xt=0,yt=0;for(xt=ft;xt>=0;){dt[xt]=!0,_t[_t.length]=xt,Ct.push(tt[xt]);var At=lt[Math.floor(xt*4/at)];if(yt=xt*4&It,at<4+yt)throw new Error("FAT boundary crossed: "+xt+" 4 "+at);if(!tt[At])break;xt=__readInt32LE(tt[At],yt)}return{nodes:_t,data:__toBuffer([Ct])}}function V(tt,ft,lt,at){var dt=tt.length,_t=[],Ct=[],It=[],xt=[],yt=at-1,At=0,Rt=0,Gt=0,Mt=0;for(At=0;At<dt;++At)if(It=[],Gt=At+ft,Gt>=dt&&(Gt-=dt),!Ct[Gt]){xt=[];var Nt=[];for(Rt=Gt;Rt>=0;){Nt[Rt]=!0,Ct[Rt]=!0,It[It.length]=Rt,xt.push(tt[Rt]);var kt=lt[Math.floor(Rt*4/at)];if(Mt=Rt*4&yt,at<4+Mt)throw new Error("FAT boundary crossed: "+Rt+" 4 "+at);if(!tt[kt]||(Rt=__readInt32LE(tt[kt],Mt),Nt[Rt]))break}_t[Gt]={nodes:It,data:__toBuffer([xt])}}return _t}function j(tt,ft,lt,at,dt,_t,Ct,It){for(var xt=0,yt=at.length?2:0,At=ft[tt].data,Rt=0,Gt=0,Mt;Rt<At.length;Rt+=128){var Nt=At.slice(Rt,Rt+128);prep_blob(Nt,64),Gt=Nt.read_shift(2),Mt=__utf16le(Nt,0,Gt-yt),at.push(Mt);var kt={name:Mt,type:Nt.read_shift(1),color:Nt.read_shift(1),L:Nt.read_shift(4,"i"),R:Nt.read_shift(4,"i"),C:Nt.read_shift(4,"i"),clsid:Nt.read_shift(16),state:Nt.read_shift(4,"i"),start:0,size:0},er=Nt.read_shift(2)+Nt.read_shift(2)+Nt.read_shift(2)+Nt.read_shift(2);er!==0&&(kt.ct=H(Nt,Nt.l-8));var hr=Nt.read_shift(2)+Nt.read_shift(2)+Nt.read_shift(2)+Nt.read_shift(2);hr!==0&&(kt.mt=H(Nt,Nt.l-8)),kt.start=Nt.read_shift(4,"i"),kt.size=Nt.read_shift(4,"i"),kt.size<0&&kt.start<0&&(kt.size=kt.type=0,kt.start=te,kt.name=""),kt.type===5?(xt=kt.start,dt>0&&xt!==te&&(ft[xt].name="!StreamData")):kt.size>=4096?(kt.storage="fat",ft[kt.start]===void 0&&(ft[kt.start]=G(lt,kt.start,ft.fat_addrs,ft.ssz)),ft[kt.start].name=kt.name,kt.content=ft[kt.start].data.slice(0,kt.size)):(kt.storage="minifat",kt.size<0?kt.size=0:xt!==te&&kt.start!==te&&ft[xt]&&(kt.content=k(kt,ft[xt].data,(ft[It]||{}).data))),kt.content&&prep_blob(kt.content,0),_t[Mt]=kt,Ct.push(kt)}}function H(tt,ft){return new Date((__readUInt32LE(tt,ft+4)/1e7*Math.pow(2,32)+__readUInt32LE(tt,ft)/1e7-11644473600)*1e3)}function U(tt,ft){return P(),E(R.readFileSync(tt),ft)}function X(tt,ft){var lt=ft&&ft.type;switch(lt||has_buf&&Buffer.isBuffer(tt)&&(lt="buffer"),lt||"base64"){case"file":return U(tt,ft);case"base64":return E(s2a(Base64_decode(tt)),ft);case"binary":return E(s2a(tt),ft)}return E(tt,ft)}function Y(tt,ft){var lt=ft||{},at=lt.root||"Root Entry";if(tt.FullPaths||(tt.FullPaths=[]),tt.FileIndex||(tt.FileIndex=[]),tt.FullPaths.length!==tt.FileIndex.length)throw new Error("inconsistent CFB structure");tt.FullPaths.length===0&&(tt.FullPaths[0]=at+"/",tt.FileIndex[0]={name:at,type:5}),lt.CLSID&&(tt.FileIndex[0].clsid=lt.CLSID),z(tt)}function z(tt){var ft="Sh33tJ5";if(!CFB.find(tt,"/"+ft)){var lt=new_buf(4);lt[0]=55,lt[1]=lt[3]=50,lt[2]=54,tt.FileIndex.push({name:ft,type:2,content:lt,size:4,L:69,R:69,C:69}),tt.FullPaths.push(tt.FullPaths[0]+ft),W(tt)}}function W(tt,ft){Y(tt);for(var lt=!1,at=!1,dt=tt.FullPaths.length-1;dt>=0;--dt){var _t=tt.FileIndex[dt];switch(_t.type){case 0:at?lt=!0:(tt.FileIndex.pop(),tt.FullPaths.pop());break;case 1:case 2:case 5:at=!0,isNaN(_t.R*_t.L*_t.C)&&(lt=!0),_t.R>-1&&_t.L>-1&&_t.R==_t.L&&(lt=!0);break;default:lt=!0;break}}if(!(!lt&&!ft)){var Ct=new Date(1987,1,19),It=0,xt=Object.create?Object.create(null):{},yt=[];for(dt=0;dt<tt.FullPaths.length;++dt)xt[tt.FullPaths[dt]]=!0,tt.FileIndex[dt].type!==0&&yt.push([tt.FullPaths[dt],tt.FileIndex[dt]]);for(dt=0;dt<yt.length;++dt){var At=_(yt[dt][0]);at=xt[At],at||(yt.push([At,{name:w(At).replace("/",""),type:1,clsid:ne,ct:Ct,mt:Ct,content:null}]),xt[At]=!0)}for(yt.sort(function(Mt,Nt){return T(Mt[0],Nt[0])}),tt.FullPaths=[],tt.FileIndex=[],dt=0;dt<yt.length;++dt)tt.FullPaths[dt]=yt[dt][0],tt.FileIndex[dt]=yt[dt][1];for(dt=0;dt<yt.length;++dt){var Rt=tt.FileIndex[dt],Gt=tt.FullPaths[dt];if(Rt.name=w(Gt).replace("/",""),Rt.L=Rt.R=Rt.C=-(Rt.color=1),Rt.size=Rt.content?Rt.content.length:0,Rt.start=0,Rt.clsid=Rt.clsid||ne,dt===0)Rt.C=yt.length>1?1:-1,Rt.size=0,Rt.type=5;else if(Gt.slice(-1)=="/"){for(It=dt+1;It<yt.length&&_(tt.FullPaths[It])!=Gt;++It);for(Rt.C=It>=yt.length?-1:It,It=dt+1;It<yt.length&&_(tt.FullPaths[It])!=_(Gt);++It);Rt.R=It>=yt.length?-1:It,Rt.type=1}else _(tt.FullPaths[dt+1]||"")==_(Gt)&&(Rt.R=dt+1),Rt.type=2}}}function Z(tt,ft){var lt=ft||{};if(lt.fileType=="mad")return Wt(tt,lt);switch(W(tt),lt.fileType){case"zip":return bt(tt,lt)}var at=function(Mt){for(var Nt=0,kt=0,er=0;er<Mt.FileIndex.length;++er){var hr=Mt.FileIndex[er];if(hr.content){var cr=hr.content.length;cr>0&&(cr<4096?Nt+=cr+63>>6:kt+=cr+511>>9)}}for(var xr=Mt.FullPaths.length+3>>2,Ar=Nt+7>>3,Er=Nt+127>>7,br=Ar+kt+xr+Er,gr=br+127>>7,Dr=gr<=109?0:Math.ceil((gr-109)/127);br+gr+Dr+127>>7>gr;)Dr=++gr<=109?0:Math.ceil((gr-109)/127);var Ir=[1,Dr,gr,Er,xr,kt,Nt,0];return Mt.FileIndex[0].size=Nt<<6,Ir[7]=(Mt.FileIndex[0].start=Ir[0]+Ir[1]+Ir[2]+Ir[3]+Ir[4]+Ir[5])+(Ir[6]+7>>3),Ir}(tt),dt=new_buf(at[7]<<9),_t=0,Ct=0;{for(_t=0;_t<8;++_t)dt.write_shift(1,ie[_t]);for(_t=0;_t<8;++_t)dt.write_shift(2,0);for(dt.write_shift(2,62),dt.write_shift(2,3),dt.write_shift(2,65534),dt.write_shift(2,9),dt.write_shift(2,6),_t=0;_t<3;++_t)dt.write_shift(2,0);for(dt.write_shift(4,0),dt.write_shift(4,at[2]),dt.write_shift(4,at[0]+at[1]+at[2]+at[3]-1),dt.write_shift(4,0),dt.write_shift(4,4096),dt.write_shift(4,at[3]?at[0]+at[1]+at[2]-1:te),dt.write_shift(4,at[3]),dt.write_shift(-4,at[1]?at[0]-1:te),dt.write_shift(4,at[1]),_t=0;_t<109;++_t)dt.write_shift(-4,_t<at[2]?at[1]+_t:-1)}if(at[1])for(Ct=0;Ct<at[1];++Ct){for(;_t<236+Ct*127;++_t)dt.write_shift(-4,_t<at[2]?at[1]+_t:-1);dt.write_shift(-4,Ct===at[1]-1?te:Ct+1)}var It=function(Mt){for(Ct+=Mt;_t<Ct-1;++_t)dt.write_shift(-4,_t+1);Mt&&(++_t,dt.write_shift(-4,te))};for(Ct=_t=0,Ct+=at[1];_t<Ct;++_t)dt.write_shift(-4,he.DIFSECT);for(Ct+=at[2];_t<Ct;++_t)dt.write_shift(-4,he.FATSECT);It(at[3]),It(at[4]);for(var xt=0,yt=0,At=tt.FileIndex[0];xt<tt.FileIndex.length;++xt)At=tt.FileIndex[xt],At.content&&(yt=At.content.length,!(yt<4096)&&(At.start=Ct,It(yt+511>>9)));for(It(at[6]+7>>3);dt.l&511;)dt.write_shift(-4,he.ENDOFCHAIN);for(Ct=_t=0,xt=0;xt<tt.FileIndex.length;++xt)At=tt.FileIndex[xt],At.content&&(yt=At.content.length,!(!yt||yt>=4096)&&(At.start=Ct,It(yt+63>>6)));for(;dt.l&511;)dt.write_shift(-4,he.ENDOFCHAIN);for(_t=0;_t<at[4]<<2;++_t){var Rt=tt.FullPaths[_t];if(!Rt||Rt.length===0){for(xt=0;xt<17;++xt)dt.write_shift(4,0);for(xt=0;xt<3;++xt)dt.write_shift(4,-1);for(xt=0;xt<12;++xt)dt.write_shift(4,0);continue}At=tt.FileIndex[_t],_t===0&&(At.start=At.size?At.start-1:te);var Gt=_t===0&&lt.root||At.name;if(yt=2*(Gt.length+1),dt.write_shift(64,Gt,"utf16le"),dt.write_shift(2,yt),dt.write_shift(1,At.type),dt.write_shift(1,At.color),dt.write_shift(-4,At.L),dt.write_shift(-4,At.R),dt.write_shift(-4,At.C),At.clsid)dt.write_shift(16,At.clsid,"hex");else for(xt=0;xt<4;++xt)dt.write_shift(4,0);dt.write_shift(4,At.state||0),dt.write_shift(4,0),dt.write_shift(4,0),dt.write_shift(4,0),dt.write_shift(4,0),dt.write_shift(4,At.start),dt.write_shift(4,At.size),dt.write_shift(4,0)}for(_t=1;_t<tt.FileIndex.length;++_t)if(At=tt.FileIndex[_t],At.size>=4096)if(dt.l=At.start+1<<9,has_buf&&Buffer.isBuffer(At.content))At.content.copy(dt,dt.l,0,At.size),dt.l+=At.size+511&-512;else{for(xt=0;xt<At.size;++xt)dt.write_shift(1,At.content[xt]);for(;xt&511;++xt)dt.write_shift(1,0)}for(_t=1;_t<tt.FileIndex.length;++_t)if(At=tt.FileIndex[_t],At.size>0&&At.size<4096)if(has_buf&&Buffer.isBuffer(At.content))At.content.copy(dt,dt.l,0,At.size),dt.l+=At.size+63&-64;else{for(xt=0;xt<At.size;++xt)dt.write_shift(1,At.content[xt]);for(;xt&63;++xt)dt.write_shift(1,0)}if(has_buf)dt.l=dt.length;else for(;dt.l<dt.length;)dt.write_shift(1,0);return dt}function Q(tt,ft){var lt=tt.FullPaths.map(function(xt){return xt.toUpperCase()}),at=lt.map(function(xt){var yt=xt.split("/");return yt[yt.length-(xt.slice(-1)=="/"?2:1)]}),dt=!1;ft.charCodeAt(0)===47?(dt=!0,ft=lt[0].slice(0,-1)+ft):dt=ft.indexOf("/")!==-1;var _t=ft.toUpperCase(),Ct=dt===!0?lt.indexOf(_t):at.indexOf(_t);if(Ct!==-1)return tt.FileIndex[Ct];var It=!_t.match(chr1);for(_t=_t.replace(chr0,""),It&&(_t=_t.replace(chr1,"!")),Ct=0;Ct<lt.length;++Ct)if((It?lt[Ct].replace(chr1,"!"):lt[Ct]).replace(chr0,"")==_t||(It?at[Ct].replace(chr1,"!"):at[Ct]).replace(chr0,"")==_t)return tt.FileIndex[Ct];return null}var ee=64,te=-2,re="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(tt,ft,lt){P();var at=Z(tt,lt);R.writeFileSync(ft,at)}function K(tt){for(var ft=new Array(tt.length),lt=0;lt<tt.length;++lt)ft[lt]=String.fromCharCode(tt[lt]);return ft.join("")}function ue(tt,ft){var lt=Z(tt,ft);switch(ft&&ft.type||"buffer"){case"file":return P(),R.writeFileSync(ft.filename,lt),lt;case"binary":return typeof lt=="string"?lt:K(lt);case"base64":return Base64_encode(typeof lt=="string"?lt:K(lt));case"buffer":if(has_buf)return Buffer.isBuffer(lt)?lt:Buffer_from(lt);case"array":return typeof lt=="string"?s2a(lt):lt}return lt}var le;function ce(tt){try{var ft=tt.InflateRaw,lt=new ft;if(lt._processChunk(new Uint8Array([3,0]),lt._finishFlushFlag),lt.bytesRead)le=tt;else throw new Error("zlib does not expose bytesRead")}catch(at){console.error("cannot use native zlib: "+(at.message||at))}}function _e(tt,ft){if(!le)return st(tt,ft);var lt=le.InflateRaw,at=new lt,dt=at._processChunk(tt.slice(tt.l),at._finishFlushFlag);return tt.l+=at.bytesRead,dt}function oe(tt){return le?le.deflateRawSync(tt):ut(tt)}var de=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(tt){var ft=(tt<<1|tt<<11)&139536|(tt<<5|tt<<15)&558144;return(ft>>16|ft>>8|ft)&255}for(var we=typeof Uint8Array<"u",Te=we?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)Te[Ee]=ge(Ee);function De(tt,ft){var lt=Te[tt&255];return ft<=8?lt>>>8-ft:(lt=lt<<8|Te[tt>>8&255],ft<=16?lt>>>16-ft:(lt=lt<<8|Te[tt>>16&255],lt>>>24-ft))}function fe(tt,ft){var lt=ft&7,at=ft>>>3;return(tt[at]|(lt<=6?0:tt[at+1]<<8))>>>lt&3}function Ce(tt,ft){var lt=ft&7,at=ft>>>3;return(tt[at]|(lt<=5?0:tt[at+1]<<8))>>>lt&7}function Se(tt,ft){var lt=ft&7,at=ft>>>3;return(tt[at]|(lt<=4?0:tt[at+1]<<8))>>>lt&15}function be(tt,ft){var lt=ft&7,at=ft>>>3;return(tt[at]|(lt<=3?0:tt[at+1]<<8))>>>lt&31}function Re(tt,ft){var lt=ft&7,at=ft>>>3;return(tt[at]|(lt<=1?0:tt[at+1]<<8))>>>lt&127}function Ve(tt,ft,lt){var at=ft&7,dt=ft>>>3,_t=(1<<lt)-1,Ct=tt[dt]>>>at;return lt<8-at||(Ct|=tt[dt+1]<<8-at,lt<16-at)||(Ct|=tt[dt+2]<<16-at,lt<24-at)||(Ct|=tt[dt+3]<<24-at),Ct&_t}function Pe(tt,ft,lt){var at=ft&7,dt=ft>>>3;return at<=5?tt[dt]|=(lt&7)<<at:(tt[dt]|=lt<<at&255,tt[dt+1]=(lt&7)>>8-at),ft+3}function ke(tt,ft,lt){var at=ft&7,dt=ft>>>3;return lt=(lt&1)<<at,tt[dt]|=lt,ft+1}function Ne(tt,ft,lt){var at=ft&7,dt=ft>>>3;return lt<<=at,tt[dt]|=lt&255,lt>>>=8,tt[dt+1]=lt,ft+8}function Ae(tt,ft,lt){var at=ft&7,dt=ft>>>3;return lt<<=at,tt[dt]|=lt&255,lt>>>=8,tt[dt+1]=lt&255,tt[dt+2]=lt>>>8,ft+16}function Oe(tt,ft){var lt=tt.length,at=2*lt>ft?2*lt:ft+5,dt=0;if(lt>=ft)return tt;if(has_buf){var _t=new_unsafe_buf(at);if(tt.copy)tt.copy(_t);else for(;dt<tt.length;++dt)_t[dt]=tt[dt];return _t}else if(we){var Ct=new Uint8Array(at);if(Ct.set)Ct.set(tt);else for(;dt<lt;++dt)Ct[dt]=tt[dt];return Ct}return tt.length=at,tt}function Fe(tt){for(var ft=new Array(tt),lt=0;lt<tt;++lt)ft[lt]=0;return ft}function nt(tt,ft,lt){var at=1,dt=0,_t=0,Ct=0,It=0,xt=tt.length,yt=we?new Uint16Array(32):Fe(32);for(_t=0;_t<32;++_t)yt[_t]=0;for(_t=xt;_t<lt;++_t)tt[_t]=0;xt=tt.length;var At=we?new Uint16Array(xt):Fe(xt);for(_t=0;_t<xt;++_t)yt[dt=tt[_t]]++,at<dt&&(at=dt),At[_t]=0;for(yt[0]=0,_t=1;_t<=at;++_t)yt[_t+16]=It=It+yt[_t-1]<<1;for(_t=0;_t<xt;++_t)It=tt[_t],It!=0&&(At[_t]=yt[It+16]++);var Rt=0;for(_t=0;_t<xt;++_t)if(Rt=tt[_t],Rt!=0)for(It=De(At[_t],at)>>at-Rt,Ct=(1<<at+4-Rt)-1;Ct>=0;--Ct)ft[It|Ct<<Rt]=Rt&15|_t<<4;return at}var Ze=we?new Uint16Array(512):Fe(512),Xe=we?new Uint16Array(32):Fe(32);if(!we){for(var $e=0;$e<512;++$e)Ze[$e]=0;for($e=0;$e<32;++$e)Xe[$e]=0}(function(){for(var tt=[],ft=0;ft<32;ft++)tt.push(5);nt(tt,Xe,32);var lt=[];for(ft=0;ft<=143;ft++)lt.push(8);for(;ft<=255;ft++)lt.push(9);for(;ft<=279;ft++)lt.push(7);for(;ft<=287;ft++)lt.push(8);nt(lt,Ze,288)})();var ot=function(){for(var ft=we?new Uint8Array(32768):[],lt=0,at=0;lt<ye.length-1;++lt)for(;at<ye[lt+1];++at)ft[at]=lt;for(;at<32768;++at)ft[at]=29;var dt=we?new Uint8Array(259):[];for(lt=0,at=0;lt<me.length-1;++lt)for(;at<me[lt+1];++at)dt[at]=lt;function _t(It,xt){for(var yt=0;yt<It.length;){var At=Math.min(65535,It.length-yt),Rt=yt+At==It.length;for(xt.write_shift(1,+Rt),xt.write_shift(2,At),xt.write_shift(2,~At&65535);At-- >0;)xt[xt.l++]=It[yt++]}return xt.l}function Ct(It,xt){for(var yt=0,At=0,Rt=we?new Uint16Array(32768):[];At<It.length;){var Gt=Math.min(65535,It.length-At);if(Gt<10){for(yt=Pe(xt,yt,+(At+Gt==It.length)),yt&7&&(yt+=8-(yt&7)),xt.l=yt/8|0,xt.write_shift(2,Gt),xt.write_shift(2,~Gt&65535);Gt-- >0;)xt[xt.l++]=It[At++];yt=xt.l*8;continue}yt=Pe(xt,yt,+(At+Gt==It.length)+2);for(var Mt=0;Gt-- >0;){var Nt=It[At];Mt=(Mt<<5^Nt)&32767;var kt=-1,er=0;if((kt=Rt[Mt])&&(kt|=At&-32768,kt>At&&(kt-=32768),kt<At))for(;It[kt+er]==It[At+er]&&er<250;)++er;if(er>2){Nt=dt[er],Nt<=22?yt=Ne(xt,yt,Te[Nt+1]>>1)-1:(Ne(xt,yt,3),yt+=5,Ne(xt,yt,Te[Nt-23]>>5),yt+=3);var hr=Nt<8?0:Nt-4>>2;hr>0&&(Ae(xt,yt,er-me[Nt]),yt+=hr),Nt=ft[At-kt],yt=Ne(xt,yt,Te[Nt]>>3),yt-=3;var cr=Nt<4?0:Nt-2>>1;cr>0&&(Ae(xt,yt,At-kt-ye[Nt]),yt+=cr);for(var xr=0;xr<er;++xr)Rt[Mt]=At&32767,Mt=(Mt<<5^It[At])&32767,++At;Gt-=er-1}else Nt<=143?Nt=Nt+48:yt=ke(xt,yt,1),yt=Ne(xt,yt,Te[Nt]),Rt[Mt]=At&32767,++At}yt=Ne(xt,yt,0)-1}return xt.l=(yt+7)/8|0,xt.l}return function(xt,yt){return xt.length<8?_t(xt,yt):Ct(xt,yt)}}();function ut(tt){var ft=new_buf(50+Math.floor(tt.length*1.1)),lt=ot(tt,ft);return ft.slice(0,lt)}var gt=we?new Uint16Array(32768):Fe(32768),Ue=we?new Uint16Array(32768):Fe(32768),We=we?new Uint16Array(128):Fe(128),ht=1,Be=1;function je(tt,ft){var lt=be(tt,ft)+257;ft+=5;var at=be(tt,ft)+1;ft+=5;var dt=Se(tt,ft)+4;ft+=4;for(var _t=0,Ct=we?new Uint8Array(19):Fe(19),It=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xt=1,yt=we?new Uint8Array(8):Fe(8),At=we?new Uint8Array(8):Fe(8),Rt=Ct.length,Gt=0;Gt<dt;++Gt)Ct[de[Gt]]=_t=Ce(tt,ft),xt<_t&&(xt=_t),yt[_t]++,ft+=3;var Mt=0;for(yt[0]=0,Gt=1;Gt<=xt;++Gt)At[Gt]=Mt=Mt+yt[Gt-1]<<1;for(Gt=0;Gt<Rt;++Gt)(Mt=Ct[Gt])!=0&&(It[Gt]=At[Mt]++);var Nt=0;for(Gt=0;Gt<Rt;++Gt)if(Nt=Ct[Gt],Nt!=0){Mt=Te[It[Gt]]>>8-Nt;for(var kt=(1<<7-Nt)-1;kt>=0;--kt)We[Mt|kt<<Nt]=Nt&7|Gt<<3}var er=[];for(xt=1;er.length<lt+at;)switch(Mt=We[Re(tt,ft)],ft+=Mt&7,Mt>>>=3){case 16:for(_t=3+fe(tt,ft),ft+=2,Mt=er[er.length-1];_t-- >0;)er.push(Mt);break;case 17:for(_t=3+Ce(tt,ft),ft+=3;_t-- >0;)er.push(0);break;case 18:for(_t=11+Re(tt,ft),ft+=7;_t-- >0;)er.push(0);break;default:er.push(Mt),xt<Mt&&(xt=Mt);break}var hr=er.slice(0,lt),cr=er.slice(lt);for(Gt=lt;Gt<286;++Gt)hr[Gt]=0;for(Gt=at;Gt<30;++Gt)cr[Gt]=0;return ht=nt(hr,gt,286),Be=nt(cr,Ue,30),ft}function Qe(tt,ft){if(tt[0]==3&&!(tt[1]&3))return[new_raw_buf(ft),2];for(var lt=0,at=0,dt=new_unsafe_buf(ft||1<<18),_t=0,Ct=dt.length>>>0,It=0,xt=0;(at&1)==0;){if(at=Ce(tt,lt),lt+=3,at>>>1)at>>1==1?(It=9,xt=5):(lt=je(tt,lt),It=ht,xt=Be);else{lt&7&&(lt+=8-(lt&7));var yt=tt[lt>>>3]|tt[(lt>>>3)+1]<<8;if(lt+=32,yt>0)for(!ft&&Ct<_t+yt&&(dt=Oe(dt,_t+yt),Ct=dt.length);yt-- >0;)dt[_t++]=tt[lt>>>3],lt+=8;continue}for(;;){!ft&&Ct<_t+32767&&(dt=Oe(dt,_t+32767),Ct=dt.length);var At=Ve(tt,lt,It),Rt=at>>>1==1?Ze[At]:gt[At];if(lt+=Rt&15,Rt>>>=4,(Rt>>>8&255)===0)dt[_t++]=Rt;else{if(Rt==256)break;Rt-=257;var Gt=Rt<8?0:Rt-4>>2;Gt>5&&(Gt=0);var Mt=_t+me[Rt];Gt>0&&(Mt+=Ve(tt,lt,Gt),lt+=Gt),At=Ve(tt,lt,xt),Rt=at>>>1==1?Xe[At]:Ue[At],lt+=Rt&15,Rt>>>=4;var Nt=Rt<4?0:Rt-2>>1,kt=ye[Rt];for(Nt>0&&(kt+=Ve(tt,lt,Nt),lt+=Nt),!ft&&Ct<Mt&&(dt=Oe(dt,Mt+100),Ct=dt.length);_t<Mt;)dt[_t]=dt[_t-kt],++_t}}}return ft?[dt,lt+7>>>3]:[dt.slice(0,_t),lt+7>>>3]}function st(tt,ft){var lt=tt.slice(tt.l||0),at=Qe(lt,ft);return tt.l+=at[1],at[0]}function pt(tt,ft){if(tt)typeof console<"u"&&console.error(ft);else throw new Error(ft)}function qe(tt,ft){var lt=tt;prep_blob(lt,0);var at=[],dt=[],_t={FileIndex:at,FullPaths:dt};Y(_t,{root:ft.root});for(var Ct=lt.length-4;(lt[Ct]!=80||lt[Ct+1]!=75||lt[Ct+2]!=5||lt[Ct+3]!=6)&&Ct>=0;)--Ct;lt.l=Ct+4,lt.l+=4;var It=lt.read_shift(2);lt.l+=6;var xt=lt.read_shift(4);for(lt.l=xt,Ct=0;Ct<It;++Ct){lt.l+=20;var yt=lt.read_shift(4),At=lt.read_shift(4),Rt=lt.read_shift(2),Gt=lt.read_shift(2),Mt=lt.read_shift(2);lt.l+=8;var Nt=lt.read_shift(4),kt=O(lt.slice(lt.l+Rt,lt.l+Rt+Gt));lt.l+=Rt+Gt+Mt;var er=lt.l;lt.l=Nt+4,rt(lt,yt,At,_t,kt),lt.l=er}return _t}function rt(tt,ft,lt,at,dt){tt.l+=2;var _t=tt.read_shift(2),Ct=tt.read_shift(2),It=A(tt);if(_t&8257)throw new Error("Unsupported ZIP encryption");for(var xt=tt.read_shift(4),yt=tt.read_shift(4),At=tt.read_shift(4),Rt=tt.read_shift(2),Gt=tt.read_shift(2),Mt="",Nt=0;Nt<Rt;++Nt)Mt+=String.fromCharCode(tt[tt.l++]);if(Gt){var kt=O(tt.slice(tt.l,tt.l+Gt));(kt[21589]||{}).mt&&(It=kt[21589].mt),((dt||{})[21589]||{}).mt&&(It=dt[21589].mt)}tt.l+=Gt;var er=tt.slice(tt.l,tt.l+yt);switch(Ct){case 8:er=_e(tt,At);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ct)}var hr=!1;_t&8&&(xt=tt.read_shift(4),xt==134695760&&(xt=tt.read_shift(4),hr=!0),yt=tt.read_shift(4),At=tt.read_shift(4)),yt!=ft&&pt(hr,"Bad compressed size: "+ft+" != "+yt),At!=lt&&pt(hr,"Bad uncompressed size: "+lt+" != "+At),Ft(at,Mt,er,{unsafe:!0,mt:It})}function bt(tt,ft){var lt=ft||{},at=[],dt=[],_t=new_buf(1),Ct=lt.compression?8:0,It=0,xt=0,yt=0,At=0,Rt=0,Gt=tt.FullPaths[0],Mt=Gt,Nt=tt.FileIndex[0],kt=[],er=0;for(xt=1;xt<tt.FullPaths.length;++xt)if(Mt=tt.FullPaths[xt].slice(Gt.length),Nt=tt.FileIndex[xt],!(!Nt.size||!Nt.content||Mt=="Sh33tJ5")){var hr=At,cr=new_buf(Mt.length);for(yt=0;yt<Mt.length;++yt)cr.write_shift(1,Mt.charCodeAt(yt)&127);cr=cr.slice(0,cr.l),kt[Rt]=CRC32.buf(Nt.content,0);var xr=Nt.content;Ct==8&&(xr=oe(xr)),_t=new_buf(30),_t.write_shift(4,67324752),_t.write_shift(2,20),_t.write_shift(2,It),_t.write_shift(2,Ct),Nt.mt?B(_t,Nt.mt):_t.write_shift(4,0),_t.write_shift(-4,kt[Rt]),_t.write_shift(4,xr.length),_t.write_shift(4,Nt.content.length),_t.write_shift(2,cr.length),_t.write_shift(2,0),At+=_t.length,at.push(_t),At+=cr.length,at.push(cr),At+=xr.length,at.push(xr),_t=new_buf(46),_t.write_shift(4,33639248),_t.write_shift(2,0),_t.write_shift(2,20),_t.write_shift(2,It),_t.write_shift(2,Ct),_t.write_shift(4,0),_t.write_shift(-4,kt[Rt]),_t.write_shift(4,xr.length),_t.write_shift(4,Nt.content.length),_t.write_shift(2,cr.length),_t.write_shift(2,0),_t.write_shift(2,0),_t.write_shift(2,0),_t.write_shift(2,0),_t.write_shift(4,0),_t.write_shift(4,hr),er+=_t.l,dt.push(_t),er+=cr.length,dt.push(cr),++Rt}return _t=new_buf(22),_t.write_shift(4,101010256),_t.write_shift(2,0),_t.write_shift(2,0),_t.write_shift(2,Rt),_t.write_shift(2,Rt),_t.write_shift(4,er),_t.write_shift(4,At),_t.write_shift(2,0),bconcat([bconcat(at),bconcat(dt),_t])}var Dt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Et(tt,ft){if(tt.ctype)return tt.ctype;var lt=tt.name||"",at=lt.match(/\.([^\.]+)$/);return at&&Dt[at[1]]||ft&&(at=(lt=ft).match(/[\.\\]([^\.\\])+$/),at&&Dt[at[1]])?Dt[at[1]]:"application/octet-stream"}function Lt(tt){for(var ft=Base64_encode(tt),lt=[],at=0;at<ft.length;at+=76)lt.push(ft.slice(at,at+76));return lt.join("\r\n")+"\r\n"}function Ot(tt){var ft=tt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(yt){var At=yt.charCodeAt(0).toString(16).toUpperCase();return"="+(At.length==1?"0"+At:At)});ft=ft.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ft.charAt(0)=="\n"&&(ft="=0D"+ft.slice(1)),ft=ft.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,"\n=0A").replace(/([^\r\n])\n/mg,"$1=0A");for(var lt=[],at=ft.split("\r\n"),dt=0;dt<at.length;++dt){var _t=at[dt];if(_t.length==0){lt.push("");continue}for(var Ct=0;Ct<_t.length;){var It=76,xt=_t.slice(Ct,Ct+It);xt.charAt(It-1)=="="?It--:xt.charAt(It-2)=="="?It-=2:xt.charAt(It-3)=="="&&(It-=3),xt=_t.slice(Ct,Ct+It),Ct+=It,Ct<_t.length&&(xt+="="),lt.push(xt)}}return lt.join("\r\n")}function Kt(tt){for(var ft=[],lt=0;lt<tt.length;++lt){for(var at=tt[lt];lt<=tt.length&&at.charAt(at.length-1)=="=";)at=at.slice(0,at.length-1)+tt[++lt];ft.push(at)}for(var dt=0;dt<ft.length;++dt)ft[dt]=ft[dt].replace(/[=][0-9A-Fa-f]{2}/g,function(_t){return String.fromCharCode(parseInt(_t.slice(1),16))});return s2a(ft.join("\r\n"))}function Jt(tt,ft,lt){for(var at="",dt="",_t="",Ct,It=0;It<10;++It){var xt=ft[It];if(!xt||xt.match(/^\s*$/))break;var yt=xt.match(/^(.*?):\s*([^\s].*)$/);if(yt)switch(yt[1].toLowerCase()){case"content-location":at=yt[2].trim();break;case"content-type":_t=yt[2].trim();break;case"content-transfer-encoding":dt=yt[2].trim();break}}switch(++It,dt.toLowerCase()){case"base64":Ct=s2a(Base64_decode(ft.slice(It).join("")));break;case"quoted-printable":Ct=Kt(ft.slice(It));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+dt)}var At=Ft(tt,at.slice(lt.length),Ct,{unsafe:!0});_t&&(At.ctype=_t)}function Yt(tt,ft){if(K(tt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var lt=ft&&ft.root||"",at=(has_buf&&Buffer.isBuffer(tt)?tt.toString("binary"):K(tt)).split("\r\n"),dt=0,_t="";for(dt=0;dt<at.length;++dt)if(_t=at[dt],!!/^Content-Location:/i.test(_t)&&(_t=_t.slice(_t.indexOf("file")),lt||(lt=_t.slice(0,_t.lastIndexOf("/")+1)),_t.slice(0,lt.length)!=lt))for(;lt.length>0&&(lt=lt.slice(0,lt.length-1),lt=lt.slice(0,lt.lastIndexOf("/")+1),_t.slice(0,lt.length)!=lt););var Ct=(at[1]||"").match(/boundary="(.*?)"/);if(!Ct)throw new Error("MAD cannot find boundary");var It="--"+(Ct[1]||""),xt=[],yt=[],At={FileIndex:xt,FullPaths:yt};Y(At);var Rt,Gt=0;for(dt=0;dt<at.length;++dt){var Mt=at[dt];Mt!==It&&Mt!==It+"--"||(Gt++&&Jt(At,at.slice(Rt,dt),lt),Rt=dt)}return At}function Wt(tt,ft){var lt=ft||{},at=lt.boundary||"SheetJS";at="------="+at;for(var dt=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+at.slice(2)+'"',"","",""],_t=tt.FullPaths[0],Ct=_t,It=tt.FileIndex[0],xt=1;xt<tt.FullPaths.length;++xt)if(Ct=tt.FullPaths[xt].slice(_t.length),It=tt.FileIndex[xt],!(!It.size||!It.content||Ct=="Sh33tJ5")){Ct=Ct.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(er){return"_x"+er.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(er){return"_u"+er.charCodeAt(0).toString(16)+"_"});for(var yt=It.content,At=has_buf&&Buffer.isBuffer(yt)?yt.toString("binary"):K(yt),Rt=0,Gt=Math.min(1024,At.length),Mt=0,Nt=0;Nt<=Gt;++Nt)(Mt=At.charCodeAt(Nt))>=32&&Mt<128&&++Rt;var kt=Rt>=Gt*4/5;dt.push(at),dt.push("Content-Location: "+(lt.root||"file:///C:/SheetJS/")+Ct),dt.push("Content-Transfer-Encoding: "+(kt?"quoted-printable":"base64")),dt.push("Content-Type: "+Et(It,Ct)),dt.push(""),dt.push(kt?Ot(At):Lt(At))}return dt.push(at+"--\r\n"),dt.join("\r\n")}function rr(tt){var ft={};return Y(ft,tt),ft}function Ft(tt,ft,lt,at){var dt=at&&at.unsafe;dt||Y(tt);var _t=!dt&&CFB.find(tt,ft);if(!_t){var Ct=tt.FullPaths[0];ft.slice(0,Ct.length)==Ct?Ct=ft:(Ct.slice(-1)!="/"&&(Ct+="/"),Ct=(Ct+ft).replace("//","/")),_t={name:w(ft),type:2},tt.FileIndex.push(_t),tt.FullPaths.push(Ct),dt||CFB.utils.cfb_gc(tt)}return _t.content=lt,_t.size=lt?lt.length:0,at&&(at.CLSID&&(_t.clsid=at.CLSID),at.mt&&(_t.mt=at.mt),at.ct&&(_t.ct=at.ct)),_t}function zt(tt,ft){Y(tt);var lt=CFB.find(tt,ft);if(lt){for(var at=0;at<tt.FileIndex.length;++at)if(tt.FileIndex[at]==lt)return tt.FileIndex.splice(at,1),tt.FullPaths.splice(at,1),!0}return!1}function lr(tt,ft,lt){Y(tt);var at=CFB.find(tt,ft);if(at){for(var dt=0;dt<tt.FileIndex.length;++dt)if(tt.FileIndex[dt]==at)return tt.FileIndex[dt].name=w(lt),tt.FullPaths[dt]=lt,!0}return!1}function nr(tt){W(tt,!0)}return S.find=Q,S.read=X,S.parse=E,S.write=ue,S.writeFile=pe,S.utils={cfb_new:rr,cfb_add:Ft,cfb_del:zt,cfb_mov:lr,cfb_gc:nr,ReadShift,CheckField,prep_blob,bconcat,use_zlib:ce,_deflateRaw:ut,_inflateRaw:st,consts:he},S}();function read_binary(L){if(typeof Deno<"u")return Deno.readFileSync(L);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var S=File(L);S.open("r"),S.encoding="binary";var T=S.read();return S.close(),T}catch(_){if(!_.message||!_.message.match(/onstruct/))throw _}throw new Error("Cannot access file "+L)}function keys(L){for(var S=Object.keys(L),T=[],_=0;_<S.length;++_)Object.prototype.hasOwnProperty.call(L,S[_])&&T.push(S[_]);return T}function evert(L){for(var S=[],T=keys(L),_=0;_!==T.length;++_)S[L[T[_]]]=T[_];return S}var basedate=new Date(1899,11,30,0,0,0);function datenum(L,S){var T=L.getTime(),_=basedate.getTime()+(L.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(T-_)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(L){var S=new Date;return S.setTime(L*24*60*60*1e3+dnthresh),S.getTimezoneOffset()!==refoffset&&S.setTime(S.getTime()+(S.getTimezoneOffset()-refoffset)*6e4),S}function parse_isodur(L){var S=0,T=0,_=!1,w=L.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!w)throw new Error("|"+L+"| is not an ISO8601 Duration");for(var B=1;B!=w.length;++B)if(w[B]){switch(T=1,B>3&&(_=!0),w[B].slice(w[B].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+w[B].slice(w[B].length-1));case"D":T*=24;case"H":T*=60;case"M":if(_)T*=60;else throw new Error("Unsupported ISO Duration Field: M")}S+=T*parseInt(w[B],10)}return S}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(L,S){var T=new Date(L);if(good_pd)return S>0?T.setTime(T.getTime()+T.getTimezoneOffset()*60*1e3):S<0&&T.setTime(T.getTime()-T.getTimezoneOffset()*60*1e3),T;if(L instanceof Date)return L;if(good_pd_date.getFullYear()==1917&&!isNaN(T.getFullYear())){var _=T.getFullYear();return L.indexOf(""+_)>-1||T.setFullYear(T.getFullYear()+100),T}var w=L.match(/\d+/g)||["2017","2","19","0","0","0"],B=new Date(+w[0],+w[1]-1,+w[2],+w[3]||0,+w[4]||0,+w[5]||0);return L.indexOf("Z")>-1&&(B=new Date(B.getTime()-B.getTimezoneOffset()*60*1e3)),B}function cc2str(L,S){if(has_buf&&Buffer.isBuffer(L)){if(S){if(L[0]==255&&L[1]==254)return utf8write(L.slice(2).toString("utf16le"));if(L[1]==254&&L[2]==255)return utf8write(utf16beread(L.slice(2).toString("binary")))}return L.toString("binary")}if(typeof TextDecoder<"u")try{if(S){if(L[0]==255&&L[1]==254)return utf8write(new TextDecoder("utf-16le").decode(L.slice(2)));if(L[0]==254&&L[1]==255)return utf8write(new TextDecoder("utf-16be").decode(L.slice(2)))}var T={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(L)&&(L=new Uint8Array(L)),new TextDecoder("latin1").decode(L).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(B){return T[B]||B})}catch(B){}for(var _=[],w=0;w!=L.length;++w)_.push(String.fromCharCode(L[w]));return _.join("")}function dup(L){if(typeof JSON<"u"&&!Array.isArray(L))return JSON.parse(JSON.stringify(L));if(typeof L!="object"||L==null)return L;if(L instanceof Date)return new Date(L.getTime());var S={};for(var T in L)Object.prototype.hasOwnProperty.call(L,T)&&(S[T]=dup(L[T]));return S}function fill(L,S){for(var T="";T.length<S;)T+=L;return T}function fuzzynum(L){var S=Number(L);if(!isNaN(S))return isFinite(S)?S:NaN;if(!/\d/.test(L))return S;var T=1,_=L.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return T*=100,""});return!isNaN(S=Number(_))||(_=_.replace(/[(](.*)[)]/,function(w,B){return T=-T,B}),!isNaN(S=Number(_)))?S/T:S}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(L){var S=new Date(L),T=new Date(NaN),_=S.getYear(),w=S.getMonth(),B=S.getDate();if(isNaN(B))return T;var A=L.toLowerCase();if(A.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(A=A.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),A.length>3&&lower_months.indexOf(A)==-1)return T}else if(A.match(/[a-z]/))return T;return _<0||_>8099?T:(w>0||B>1)&&_!=101?S:L.match(/[^-0-9:,\/\\]/)?T:S}var split_regex=function(){var L="abacaba".split(/(:?b)/i).length==5;return function(T,_,w){if(L||typeof _=="string")return T.split(_);for(var B=T.split(_),A=[B[0]],O=1;O<B.length;++O)A.push(w),A.push(B[O]);return A}}();function getdatastr(L){return L?L.content&&L.type?cc2str(L.content,!0):L.data?debom(L.data):L.asNodeBuffer&&has_buf?debom(L.asNodeBuffer().toString("binary")):L.asBinary?debom(L.asBinary()):L._data&&L._data.getContent?debom(cc2str(Array.prototype.slice.call(L._data.getContent(),0))):null:null}function getdatabin(L){if(!L)return null;if(L.data)return char_codes(L.data);if(L.asNodeBuffer&&has_buf)return L.asNodeBuffer();if(L._data&&L._data.getContent){var S=L._data.getContent();return typeof S=="string"?char_codes(S):Array.prototype.slice.call(S)}return L.content&&L.type?L.content:null}function getdata(L){return L&&L.name.slice(-4)===".bin"?getdatabin(L):getdatastr(L)}function safegetzipfile(L,S){for(var T=L.FullPaths||keys(L.files),_=S.toLowerCase().replace(/[\/]/g,"\\"),w=_.replace(/\\/g,"/"),B=0;B<T.length;++B){var A=T[B].replace(/^Root Entry[\/]/,"").toLowerCase();if(_==A||w==A)return L.files?L.files[T[B]]:L.FileIndex[B]}return null}function getzipfile(L,S){var T=safegetzipfile(L,S);if(T==null)throw new Error("Cannot find file "+S+" in zip");return T}function getzipdata(L,S,T){if(!T)return getdata(getzipfile(L,S));if(!S)return null;try{return getzipdata(L,S)}catch(_){return null}}function getzipstr(L,S,T){if(!T)return getdatastr(getzipfile(L,S));if(!S)return null;try{return getzipstr(L,S)}catch(_){return null}}function getzipbin(L,S,T){return getdatabin(getzipfile(L,S))}function zipentries(L){for(var S=L.FullPaths||keys(L.files),T=[],_=0;_<S.length;++_)S[_].slice(-1)!="/"&&T.push(S[_].replace(/^Root Entry[\/]/,""));return T.sort()}function zip_add_file(L,S,T){if(L.FullPaths){if(typeof T=="string"){var _;return has_buf?_=Buffer_from(T):_=utf8decode(T),CFB.utils.cfb_add(L,S,_)}CFB.utils.cfb_add(L,S,T)}else L.file(S,T)}function zip_read(L,S){switch(S.type){case"base64":return CFB.read(L,{type:"base64"});case"binary":return CFB.read(L,{type:"binary"});case"buffer":case"array":return CFB.read(L,{type:"buffer"})}throw new Error("Unrecognized type "+S.type)}function resolve_path(L,S){if(L.charAt(0)=="/")return L.slice(1);var T=S.split("/");S.slice(-1)!="/"&&T.pop();for(var _=L.split("/");_.length!==0;){var w=_.shift();w===".."?T.pop():w!=="."&&T.push(w)}return T.join("/")}var XML_HEADER='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(L,S,T){for(var _={},w=0,B=0;w!==L.length&&!((B=L.charCodeAt(w))===32||B===10||B===13);++w);if(S||(_[0]=L.slice(0,w)),w===L.length)return _;var A=L.match(attregexg),O=0,R="",P=0,E="",D="",I=1;if(A)for(P=0;P!=A.length;++P){for(D=A[P],B=0;B!=D.length&&D.charCodeAt(B)!==61;++B);for(E=D.slice(0,B).trim();D.charCodeAt(B+1)==32;)++B;for(I=(w=D.charCodeAt(B+1))==34||w==39?1:0,R=D.slice(B+1+I,D.length-I),O=0;O!=E.length&&E.charCodeAt(O)!==58;++O);if(O===E.length)E.indexOf("_")>0&&(E=E.slice(0,E.indexOf("_"))),_[E]=R,_[E.toLowerCase()]=R;else{var M=(O===5&&E.slice(0,5)==="xmlns"?"xmlns":"")+E.slice(O+1);if(_[M]&&E.slice(O-3,O)=="ext")continue;_[M]=R,_[M.toLowerCase()]=R}}return _}function strip_ns(L){return L.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var L=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,S=/_x([\da-fA-F]{4})_/ig;return function T(_){var w=_+"",B=w.indexOf("<![CDATA[");if(B==-1)return w.replace(L,function(O,R){return encodings[O]||String.fromCharCode(parseInt(R,O.indexOf("x")>-1?16:10))||O}).replace(S,function(O,R){return String.fromCharCode(parseInt(R,16))});var A=w.indexOf("]]>");return T(w.slice(0,B))+w.slice(B+9,A)+T(w.slice(A+3))}}(),decregex=/[&<>'"]/g,htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(L){var S=L+"";return S.replace(decregex,function(T){return rencoding[T]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(T){return"&#x"+("000"+T.charCodeAt(0).toString(16)).slice(-4)+";"})}var xlml_fixstr=function(){var L=/&#(\d+);/g;function S(T,_){return String.fromCharCode(parseInt(_,10))}return function(_){return _.replace(L,S)}}();function parsexmlbool(L){switch(L){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(L){for(var S="",T=0,_=0,w=0,B=0,A=0,O=0;T<L.length;){if(_=L.charCodeAt(T++),_<128){S+=String.fromCharCode(_);continue}if(w=L.charCodeAt(T++),_>191&&_<224){A=(_&31)<<6,A|=w&63,S+=String.fromCharCode(A);continue}if(B=L.charCodeAt(T++),_<240){S+=String.fromCharCode((_&15)<<12|(w&63)<<6|B&63);continue}A=L.charCodeAt(T++),O=((_&7)<<18|(w&63)<<12|(B&63)<<6|A&63)-65536,S+=String.fromCharCode(55296+(O>>>10&1023)),S+=String.fromCharCode(56320+(O&1023))}return S}function utf8readb(L){var S=new_raw_buf(2*L.length),T,_,w=1,B=0,A=0,O;for(_=0;_<L.length;_+=w)w=1,(O=L.charCodeAt(_))<128?T=O:O<224?(T=(O&31)*64+(L.charCodeAt(_+1)&63),w=2):O<240?(T=(O&15)*4096+(L.charCodeAt(_+1)&63)*64+(L.charCodeAt(_+2)&63),w=3):(w=4,T=(O&7)*262144+(L.charCodeAt(_+1)&63)*4096+(L.charCodeAt(_+2)&63)*64+(L.charCodeAt(_+3)&63),T-=65536,A=55296+(T>>>10&1023),T=56320+(T&1023)),A!==0&&(S[B++]=A&255,S[B++]=A>>>8,A=0),S[B++]=T%256,S[B++]=T>>>8;return S.slice(0,B).toString("ucs2")}function utf8readc(L){return Buffer_from(L,"binary").toString("utf8")}var utf8corpus="foo bar bazâð£",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(L){return Buffer_from(L,"utf8").toString("binary")}:function(L){for(var S=[],T=0,_=0,w=0;T<L.length;)switch(_=L.charCodeAt(T++),!0){case _<128:S.push(String.fromCharCode(_));break;case _<2048:S.push(String.fromCharCode(192+(_>>6))),S.push(String.fromCharCode(128+(_&63)));break;case(_>=55296&&_<57344):_-=55296,w=L.charCodeAt(T++)-56320+(_<<10),S.push(String.fromCharCode(240+(w>>18&7))),S.push(String.fromCharCode(144+(w>>12&63))),S.push(String.fromCharCode(128+(w>>6&63))),S.push(String.fromCharCode(128+(w&63)));break;default:S.push(String.fromCharCode(224+(_>>12))),S.push(String.fromCharCode(128+(_>>6&63))),S.push(String.fromCharCode(128+(_&63)))}return S.join("")},matchtag=function(){var L={};return function(T,_){var w=T+"|"+(_||"");return L[w]?L[w]:L[w]=new RegExp("<(?:\\w+:)?"+T+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+T+">",_||"")}}(),htmldecode=function(){var L=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(S){return[new RegExp("&"+S[0]+";","ig"),S[1]]});return function(T){for(var _=T.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),w=0;w<L.length;++w)_=_.replace(L[w][0],L[w][1]);return _}}(),vtregex=function(){var L={};return function(T){return L[T]!==void 0?L[T]:L[T]=new RegExp("<(?:vt:)?"+T+">([\\s\\S]*?)</(?:vt:)?"+T+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(L,S){var T=parsexmltag(L),_=L.match(vtregex(T.baseType))||[],w=[];if(_.length!=T.size){if(S.WTF)throw new Error("unexpected vector length "+_.length+" != "+T.size);return w}return _.forEach(function(B){var A=B.replace(vtvregex,"").match(vtmregex);A&&w.push({v:utf8read(A[2]),t:A[1]})}),w}var wtregex=/(^\s|\s$|\n)/;function wxt_helper(L){return keys(L).map(function(S){return" "+S+'="'+L[S]+'"'}).join("")}function writextag(L,S,T){return"<"+L+(T!=null?wxt_helper(T):"")+(S!=null?(S.match(wtregex)?' xml:space="preserve"':"")+">"+S+"</"+L:"/")+">"}function xlml_normalize(L){if(has_buf&&Buffer.isBuffer(L))return L.toString("utf8");if(typeof L=="string")return L;if(typeof Uint8Array<"u"&&L instanceof Uint8Array)return utf8read(a2s(ab2a(L)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function read_double_le(L,S){for(var T=1-2*(L[S+7]>>>7),_=((L[S+7]&127)<<4)+(L[S+6]>>>4&15),w=L[S+6]&15,B=5;B>=0;--B)w=w*256+L[S+B];return _==2047?w==0?T*(1/0):NaN:(_==0?_=-1022:(_-=1023,w+=Math.pow(2,52)),T*Math.pow(2,_-52)*w)}function write_double_le(L,S,T){var _=(S<0||1/S==-1/0?1:0)<<7,w=0,B=0,A=_?-S:S;isFinite(A)?A==0?w=B=0:(w=Math.floor(Math.log(A)/Math.LN2),B=A*Math.pow(2,52-w),w<=-1023&&(!isFinite(B)||B<Math.pow(2,52))?w=-1022:(B-=Math.pow(2,52),w+=1023)):(w=2047,B=isNaN(S)?26985:0);for(var O=0;O<=5;++O,B/=256)L[T+O]=B&255;L[T+6]=(w&15)<<4|B&15,L[T+7]=w>>4|_}var ___toBuffer=function(L){for(var S=[],T=10240,_=0;_<L[0].length;++_)if(L[0][_])for(var w=0,B=L[0][_].length;w<B;w+=T)S.push.apply(S,L[0][_].slice(w,w+T));return S},__toBuffer=has_buf?function(L){return L[0].length>0&&Buffer.isBuffer(L[0][0])?Buffer.concat(L[0].map(function(S){return Buffer.isBuffer(S)?S:Buffer_from(S)})):___toBuffer(L)}:___toBuffer,___utf16le=function(L,S,T){for(var _=[],w=S;w<T;w+=2)_.push(String.fromCharCode(__readUInt16LE(L,w)));return _.join("").replace(chr0,"")},__utf16le=has_buf?function(L,S,T){return Buffer.isBuffer(L)?L.toString("utf16le",S,T).replace(chr0,""):___utf16le(L,S,T)}:___utf16le,___hexlify=function(L,S,T){for(var _=[],w=S;w<S+T;++w)_.push(("0"+L[w].toString(16)).slice(-2));return _.join("")},__hexlify=has_buf?function(L,S,T){return Buffer.isBuffer(L)?L.toString("hex",S,S+T):___hexlify(L,S,T)}:___hexlify,___utf8=function(L,S,T){for(var _=[],w=S;w<T;w++)_.push(String.fromCharCode(__readUInt8(L,w)));return _.join("")},__utf8=has_buf?function(S,T,_){return Buffer.isBuffer(S)?S.toString("utf8",T,_):___utf8(S,T,_)}:___utf8,___lpstr=function(L,S){var T=__readUInt32LE(L,S);return T>0?__utf8(L,S+4,S+4+T-1):""},__lpstr=___lpstr,___cpstr=function(L,S){var T=__readUInt32LE(L,S);return T>0?__utf8(L,S+4,S+4+T-1):""},__cpstr=___cpstr,___lpwstr=function(L,S){var T=2*__readUInt32LE(L,S);return T>0?__utf8(L,S+4,S+4+T-1):""},__lpwstr=___lpwstr,___lpp4=function(S,T){var _=__readUInt32LE(S,T);return _>0?__utf16le(S,T+4,T+4+_):""},__lpp4=___lpp4,___8lpp4=function(L,S){var T=__readUInt32LE(L,S);return T>0?__utf8(L,S+4,S+4+T):""},__8lpp4=___8lpp4,___double=function(L,S){return read_double_le(L,S)},__double=___double,is_buf=function(S){return Array.isArray(S)||typeof Uint8Array<"u"&&S instanceof Uint8Array};has_buf&&(__lpstr=function(S,T){if(!Buffer.isBuffer(S))return ___lpstr(S,T);var _=S.readUInt32LE(T);return _>0?S.toString("utf8",T+4,T+4+_-1):""},__cpstr=function(S,T){if(!Buffer.isBuffer(S))return ___cpstr(S,T);var _=S.readUInt32LE(T);return _>0?S.toString("utf8",T+4,T+4+_-1):""},__lpwstr=function(S,T){if(!Buffer.isBuffer(S))return ___lpwstr(S,T);var _=2*S.readUInt32LE(T);return S.toString("utf16le",T+4,T+4+_-1)},__lpp4=function(S,T){if(!Buffer.isBuffer(S))return ___lpp4(S,T);var _=S.readUInt32LE(T);return S.toString("utf16le",T+4,T+4+_)},__8lpp4=function(S,T){if(!Buffer.isBuffer(S))return ___8lpp4(S,T);var _=S.readUInt32LE(T);return S.toString("utf8",T+4,T+4+_)},__double=function(S,T){return Buffer.isBuffer(S)?S.readDoubleLE(T):___double(S,T)},is_buf=function(S){return Buffer.isBuffer(S)||Array.isArray(S)||typeof Uint8Array<"u"&&S instanceof Uint8Array});var __readUInt8=function(L,S){return L[S]},__readUInt16LE=function(L,S){return L[S+1]*256+L[S]},__readInt16LE=function(L,S){var T=L[S+1]*256+L[S];return T<32768?T:(65535-T+1)*-1},__readUInt32LE=function(L,S){return L[S+3]*(1<<24)+(L[S+2]<<16)+(L[S+1]<<8)+L[S]},__readInt32LE=function(L,S){return L[S+3]<<24|L[S+2]<<16|L[S+1]<<8|L[S]},__readInt32BE=function(L,S){return L[S]<<24|L[S+1]<<16|L[S+2]<<8|L[S+3]};function ReadShift(L,S){var T="",_,w,B=[],A,O,R,P;switch(S){case"dbcs":if(P=this.l,has_buf&&Buffer.isBuffer(this))T=this.slice(this.l,this.l+2*L).toString("utf16le");else for(R=0;R<L;++R)T+=String.fromCharCode(__readUInt16LE(this,P)),P+=2;L*=2;break;case"utf8":T=__utf8(this,this.l,this.l+L);break;case"utf16le":L*=2,T=__utf16le(this,this.l,this.l+L);break;case"wstr":return ReadShift.call(this,L,"dbcs");case"lpstr-ansi":T=__lpstr(this,this.l),L=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":T=__cpstr(this,this.l),L=4+__readUInt32LE(this,this.l);break;case"lpwstr":T=__lpwstr(this,this.l),L=4+2*__readUInt32LE(this,this.l);break;case"lpp4":L=4+__readUInt32LE(this,this.l),T=__lpp4(this,this.l),L&2&&(L+=2);break;case"8lpp4":L=4+__readUInt32LE(this,this.l),T=__8lpp4(this,this.l),L&3&&(L+=4-(L&3));break;case"cstr":for(L=0,T="";(A=__readUInt8(this,this.l+L++))!==0;)B.push(_getchar(A));T=B.join("");break;case"_wstr":for(L=0,T="";(A=__readUInt16LE(this,this.l+L))!==0;)B.push(_getchar(A)),L+=2;L+=2,T=B.join("");break;case"dbcs-cont":for(T="",P=this.l,R=0;R<L;++R){if(this.lens&&this.lens.indexOf(P)!==-1)return A=__readUInt8(this,P),this.l=P+1,O=ReadShift.call(this,L-R,A?"dbcs-cont":"sbcs-cont"),B.join("")+O;B.push(_getchar(__readUInt16LE(this,P))),P+=2}T=B.join(""),L*=2;break;case"cpstr":case"sbcs-cont":for(T="",P=this.l,R=0;R!=L;++R){if(this.lens&&this.lens.indexOf(P)!==-1)return A=__readUInt8(this,P),this.l=P+1,O=ReadShift.call(this,L-R,A?"dbcs-cont":"sbcs-cont"),B.join("")+O;B.push(_getchar(__readUInt8(this,P))),P+=1}T=B.join("");break;default:switch(L){case 1:return _=__readUInt8(this,this.l),this.l++,_;case 2:return _=(S==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,_;case 4:case-4:return S==="i"||(this[this.l+3]&128)===0?(_=(L>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,_):(w=__readUInt32LE(this,this.l),this.l+=4,w);case 8:case-8:if(S==="f")return L==8?w=__double(this,this.l):w=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,w;L=8;case 16:T=__hexlify(this,this.l,L);break}}return this.l+=L,T}var __writeUInt32LE=function(L,S,T){L[T]=S&255,L[T+1]=S>>>8&255,L[T+2]=S>>>16&255,L[T+3]=S>>>24&255},__writeInt32LE=function(L,S,T){L[T]=S&255,L[T+1]=S>>8&255,L[T+2]=S>>16&255,L[T+3]=S>>24&255},__writeUInt16LE=function(L,S,T){L[T]=S&255,L[T+1]=S>>>8&255};function WriteShift(L,S,T){var _=0,w=0;if(T==="dbcs"){for(w=0;w!=S.length;++w)__writeUInt16LE(this,S.charCodeAt(w),this.l+2*w);_=2*S.length}else if(T==="sbcs"){for(S=S.replace(/[^\x00-\x7F]/g,"_"),w=0;w!=S.length;++w)this[this.l+w]=S.charCodeAt(w)&255;_=S.length}else if(T==="hex"){for(;w<L;++w)this[this.l++]=parseInt(S.slice(2*w,2*w+2),16)||0;return this}else if(T==="utf16le"){var B=Math.min(this.l+L,this.length);for(w=0;w<Math.min(S.length,L);++w){var A=S.charCodeAt(w);this[this.l++]=A&255,this[this.l++]=A>>8}for(;this.l<B;)this[this.l++]=0;return this}else switch(L){case 1:_=1,this[this.l]=S&255;break;case 2:_=2,this[this.l]=S&255,S>>>=8,this[this.l+1]=S&255;break;case 3:_=3,this[this.l]=S&255,S>>>=8,this[this.l+1]=S&255,S>>>=8,this[this.l+2]=S&255;break;case 4:_=4,__writeUInt32LE(this,S,this.l);break;case 8:if(_=8,T==="f"){write_double_le(this,S,this.l);break}case 16:break;case-4:_=4,__writeInt32LE(this,S,this.l);break}return this.l+=_,this}function CheckField(L,S){var T=__hexlify(this,this.l,L.length>>1);if(T!==L)throw new Error(S+"Expected "+L+" saw "+T);this.l+=L.length>>1}function prep_blob(L,S){L.l=S,L.read_shift=ReadShift,L.chk=CheckField,L.write_shift=WriteShift}function parsenoop(L,S){L.l+=S}function new_buf(L){var S=new_raw_buf(L);return prep_blob(S,0),S}function recordhopper(L,S,T){if(L){var _,w,B;prep_blob(L,L.l||0);for(var A=L.length,O=0,R=0;L.l<A;){O=L.read_shift(1),O&128&&(O=(O&127)+((L.read_shift(1)&127)<<7));var P=XLSBRecordEnum[O]||XLSBRecordEnum[65535];for(_=L.read_shift(1),B=_&127,w=1;w<4&&_&128;++w)B+=((_=L.read_shift(1))&127)<<7*w;R=L.l+B;var E=P.f&&P.f(L,B,T);if(L.l=R,S(E,P,O))return}}}function buf_array(){var L=[],S=has_buf?256:2048,T=function(P){var E=new_buf(P);return prep_blob(E,0),E},_=T(S),w=function(){_&&(_.length>_.l&&(_=_.slice(0,_.l),_.l=_.length),_.length>0&&L.push(_),_=null)},B=function(P){return _&&P<_.length-_.l?_:(w(),_=T(Math.max(P+1,S)))},A=function(){return w(),bconcat(L)},O=function(P){w(),_=P,_.l==null&&(_.l=_.length),B(S)};return{next:B,push:O,end:A,_bufs:L}}function shift_cell_xls(L,S,T){var _=dup(L);if(S.s?(_.cRel&&(_.c+=S.s.c),_.rRel&&(_.r+=S.s.r)):(_.cRel&&(_.c+=S.c),_.rRel&&(_.r+=S.r)),!T||T.biff<12){for(;_.c>=256;)_.c-=256;for(;_.r>=65536;)_.r-=65536}return _}function shift_range_xls(L,S,T){var _=dup(L);return _.s=shift_cell_xls(_.s,S.s,T),_.e=shift_cell_xls(_.e,S.s,T),_}function encode_cell_xls(L,S){if(L.cRel&&L.c<0)for(L=dup(L);L.c<0;)L.c+=S>8?16384:256;if(L.rRel&&L.r<0)for(L=dup(L);L.r<0;)L.r+=S>8?1048576:S>5?65536:16384;var T=encode_cell(L);return!L.cRel&&L.cRel!=null&&(T=fix_col(T)),!L.rRel&&L.rRel!=null&&(T=fix_row(T)),T}function encode_range_xls(L,S){return L.s.r==0&&!L.s.rRel&&L.e.r==(S.biff>=12?1048575:S.biff>=8?65536:16384)&&!L.e.rRel?(L.s.cRel?"":"$")+encode_col(L.s.c)+":"+(L.e.cRel?"":"$")+encode_col(L.e.c):L.s.c==0&&!L.s.cRel&&L.e.c==(S.biff>=12?16383:255)&&!L.e.cRel?(L.s.rRel?"":"$")+encode_row(L.s.r)+":"+(L.e.rRel?"":"$")+encode_row(L.e.r):encode_cell_xls(L.s,S.biff)+":"+encode_cell_xls(L.e,S.biff)}function decode_row(L){return parseInt(unfix_row(L),10)-1}function encode_row(L){return""+(L+1)}function fix_row(L){return L.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(L){return L.replace(/\$(\d+)$/,"$1")}function decode_col(L){for(var S=unfix_col(L),T=0,_=0;_!==S.length;++_)T=26*T+S.charCodeAt(_)-64;return T-1}function encode_col(L){if(L<0)throw new Error("invalid column "+L);var S="";for(++L;L;L=Math.floor((L-1)/26))S=String.fromCharCode((L-1)%26+65)+S;return S}function fix_col(L){return L.replace(/^([A-Z])/,"$$$1")}function unfix_col(L){return L.replace(/^\$([A-Z])/,"$1")}function split_cell(L){return L.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(L){for(var S=0,T=0,_=0;_<L.length;++_){var w=L.charCodeAt(_);w>=48&&w<=57?S=10*S+(w-48):w>=65&&w<=90&&(T=26*T+(w-64))}return{c:T-1,r:S-1}}function encode_cell(L){for(var S=L.c+1,T="";S;S=(S-1)/26|0)T=String.fromCharCode((S-1)%26+65)+T;return T+(L.r+1)}function decode_range(L){var S=L.indexOf(":");return S==-1?{s:decode_cell(L),e:decode_cell(L)}:{s:decode_cell(L.slice(0,S)),e:decode_cell(L.slice(S+1))}}function encode_range(L,S){return typeof S>"u"||typeof S=="number"?encode_range(L.s,L.e):(typeof L!="string"&&(L=encode_cell(L)),typeof S!="string"&&(S=encode_cell(S)),L==S?L:L+":"+S)}function safe_decode_range(L){var S={s:{c:0,r:0},e:{c:0,r:0}},T=0,_=0,w=0,B=L.length;for(T=0;_<B&&!((w=L.charCodeAt(_)-64)<1||w>26);++_)T=26*T+w;for(S.s.c=--T,T=0;_<B&&!((w=L.charCodeAt(_)-48)<0||w>9);++_)T=10*T+w;if(S.s.r=--T,_===B||w!=10)return S.e.c=S.s.c,S.e.r=S.s.r,S;for(++_,T=0;_!=B&&!((w=L.charCodeAt(_)-64)<1||w>26);++_)T=26*T+w;for(S.e.c=--T,T=0;_!=B&&!((w=L.charCodeAt(_)-48)<0||w>9);++_)T=10*T+w;return S.e.r=--T,S}function safe_format_cell(L,S){var T=L.t=="d"&&S instanceof Date;if(L.z!=null)try{return L.w=SSF_format(L.z,T?datenum(S):S)}catch(_){}try{return L.w=SSF_format((L.XF||{}).numFmtId||(T?14:0),T?datenum(S):S)}catch(_){return""+S}}function format_cell(L,S,T){return L==null||L.t==null||L.t=="z"?"":L.w!==void 0?L.w:(L.t=="d"&&!L.z&&T&&T.dateNF&&(L.z=T.dateNF),L.t=="e"?BErr[L.v]||L.v:S==null?safe_format_cell(L,L.v):safe_format_cell(L,S))}function sheet_to_workbook(L,S){var T=S&&S.sheet?S.sheet:"Sheet1",_={};return _[T]=L,{SheetNames:[T],Sheets:_}}function sheet_add_aoa(L,S,T){var _=T||{},w=L?Array.isArray(L):_.dense,B=L||(w?[]:{}),A=0,O=0;if(B&&_.origin!=null){if(typeof _.origin=="number")A=_.origin;else{var R=typeof _.origin=="string"?decode_cell(_.origin):_.origin;A=R.r,O=R.c}B["!ref"]||(B["!ref"]="A1:A1")}var P={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(B["!ref"]){var E=safe_decode_range(B["!ref"]);P.s.c=E.s.c,P.s.r=E.s.r,P.e.c=Math.max(P.e.c,E.e.c),P.e.r=Math.max(P.e.r,E.e.r),A==-1&&(P.e.r=A=E.e.r+1)}for(var D=0;D!=S.length;++D)if(S[D]){if(!Array.isArray(S[D]))throw new Error("aoa_to_sheet expects an array of arrays");for(var I=0;I!=S[D].length;++I)if(!(typeof S[D][I]>"u")){var M={v:S[D][I]},N=A+D,k=O+I;if(P.s.r>N&&(P.s.r=N),P.s.c>k&&(P.s.c=k),P.e.r<N&&(P.e.r=N),P.e.c<k&&(P.e.c=k),S[D][I]&&typeof S[D][I]=="object"&&!Array.isArray(S[D][I])&&!(S[D][I]instanceof Date))M=S[D][I];else if(Array.isArray(M.v)&&(M.f=S[D][I][1],M.v=M.v[0]),M.v===null)if(M.f)M.t="n";else if(_.nullError)M.t="e",M.v=0;else if(_.sheetStubs)M.t="z";else continue;else typeof M.v=="number"?M.t="n":typeof M.v=="boolean"?M.t="b":M.v instanceof Date?(M.z=_.dateNF||table_fmt[14],_.cellDates?(M.t="d",M.w=SSF_format(M.z,datenum(M.v))):(M.t="n",M.v=datenum(M.v),M.w=SSF_format(M.z,M.v))):M.t="s";if(w)B[N]||(B[N]=[]),B[N][k]&&B[N][k].z&&(M.z=B[N][k].z),B[N][k]=M;else{var F=encode_cell({c:k,r:N});B[F]&&B[F].z&&(M.z=B[F].z),B[F]=M}}}return P.s.c<1e7&&(B["!ref"]=encode_range(P)),B}function aoa_to_sheet(L,S){return sheet_add_aoa(null,L,S)}function parse_Int32LE(L){return L.read_shift(4,"i")}function parse_XLWideString(L){var S=L.read_shift(4);return S===0?"":L.read_shift(S,"dbcs")}function parse_StrRun(L){return{ich:L.read_shift(2),ifnt:L.read_shift(2)}}function parse_RichStr(L,S){var T=L.l,_=L.read_shift(1),w=parse_XLWideString(L),B=[],A={t:w,h:w};if((_&1)!==0){for(var O=L.read_shift(4),R=0;R!=O;++R)B.push(parse_StrRun(L));A.r=B}else A.r=[{ich:0,ifnt:0}];return L.l=T+S,A}var parse_BrtCommentText=parse_RichStr;function parse_XLSBCell(L){var S=L.read_shift(4),T=L.read_shift(2);return T+=L.read_shift(1)<<16,L.l++,{c:S,iStyleRef:T}}function parse_XLSBShortCell(L){var S=L.read_shift(2);return S+=L.read_shift(1)<<16,L.l++,{c:-1,iStyleRef:S}}var parse_XLSBCodeName=parse_XLWideString;function parse_XLNullableWideString(L){var S=L.read_shift(4);return S===0||S===4294967295?"":L.read_shift(S,"dbcs")}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString;function parse_RkNumber(L){var S=L.slice(L.l,L.l+4),T=S[0]&1,_=S[0]&2;L.l+=4;var w=_===0?__double([0,0,0,0,S[0]&252,S[1],S[2],S[3]],0):__readInt32LE(S,0)>>2;return T?w/100:w}function parse_RfX(L){var S={s:{},e:{}};return S.s.r=L.read_shift(4),S.e.r=L.read_shift(4),S.s.c=L.read_shift(4),S.e.c=L.read_shift(4),S}var parse_UncheckedRfX=parse_RfX;function parse_Xnum(L){if(L.length-L.l<8)throw"XLS Xnum Buffer underflow";return L.read_shift(8,"f")}function parse_BrtColor(L){var S={},T=L.read_shift(1),_=T>>>1,w=L.read_shift(1),B=L.read_shift(2,"i"),A=L.read_shift(1),O=L.read_shift(1),R=L.read_shift(1);switch(L.l++,_){case 0:S.auto=1;break;case 1:S.index=w;var P=XLSIcv[w];P&&(S.rgb=rgb2Hex(P));break;case 2:S.rgb=rgb2Hex([A,O,R]);break;case 3:S.theme=w;break}return B!=0&&(S.tint=B>0?B/32767:B/32768),S}function parse_FontFlags(L){var S=L.read_shift(1);L.l++;var T={fBold:S&1,fItalic:S&2,fUnderline:S&4,fStrikeout:S&8,fOutline:S&16,fShadow:S&32,fCondense:S&64,fExtend:S&128};return T}function parse_ClipboardFormatOrString(L,S){var T={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},_=L.read_shift(4);switch(_){case 0:return"";case 4294967295:case 4294967294:return T[L.read_shift(4)]||""}if(_>400)throw new Error("Unsupported Clipboard: "+_.toString(16));return L.l-=4,L.read_shift(0,S==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(L){return parse_ClipboardFormatOrString(L,1)}function parse_ClipboardFormatOrUnicodeString(L){return parse_ClipboardFormatOrString(L,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(L){return L.map(function(S){return[S>>16&255,S>>8&255,S&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(L){var S=new_ct();if(!L||!L.match)return S;var T={};if((L.match(tagregex)||[]).forEach(function(_){var w=parsexmltag(_);switch(w[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":S.xmlns=w["xmlns"+(w[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":T[w.Extension]=w.ContentType;break;case"<Override":S[ct2type[w.ContentType]]!==void 0&&S[ct2type[w.ContentType]].push(w.PartName);break}}),S.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+S.xmlns);return S.calcchain=S.calcchains.length>0?S.calcchains[0]:"",S.sst=S.strs.length>0?S.strs[0]:"",S.style=S.styles.length>0?S.styles[0]:"",S.defaults=T,delete S.calcchains,S}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(L){var S=L.lastIndexOf("/");return L.slice(0,S+1)+"_rels/"+L.slice(S+1)+".rels"}function parse_rels(L,S){var T={"!id":{}};if(!L)return T;S.charAt(0)!=="/"&&(S="/"+S);var _={};return(L.match(tagregex)||[]).forEach(function(w){var B=parsexmltag(w);if(B[0]==="<Relationship"){var A={};A.Type=B.Type,A.Target=B.Target,A.Id=B.Id,B.TargetMode&&(A.TargetMode=B.TargetMode);var O=B.TargetMode==="External"?B.Target:resolve_path(B.Target,S);T[O]=A,_[B.Id]=A}}),T["!id"]=_,T}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(L,S){for(var T=xlml_normalize(L),_,w;_=xlmlregex.exec(T);)switch(_[3]){case"manifest":break;case"file-entry":if(w=parsexmltag(_[0],!1),w.path=="/"&&w.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(S&&S.WTF)throw _}}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var L=new Array(CORE_PROPS.length),S=0;S<CORE_PROPS.length;++S){var T=CORE_PROPS[S],_="(?:"+T[0].slice(0,T[0].indexOf(":"))+":)"+T[0].slice(T[0].indexOf(":")+1);L[S]=new RegExp("<"+_+"[^>]*>([\\s\\S]*?)</"+_+">")}return L}();function parse_core_props(L){var S={};L=utf8read(L);for(var T=0;T<CORE_PROPS.length;++T){var _=CORE_PROPS[T],w=L.match(CORE_PROPS_REGEX[T]);w!=null&&w.length>0&&(S[_[1]]=unescapexml(w[1])),_[2]==="date"&&S[_[1]]&&(S[_[1]]=parseDate(S[_[1]]))}return S}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function load_props_pairs(L,S,T,_){var w=[];if(typeof L=="string")w=parseVector(L,_);else for(var B=0;B<L.length;++B)w=w.concat(L[B].map(function(E){return{v:E}}));var A=typeof S=="string"?parseVector(S,_).map(function(E){return E.v}):S,O=0,R=0;if(A.length>0)for(var P=0;P!==w.length;P+=2){switch(R=+w[P+1].v,w[P].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":T.Worksheets=R,T.SheetNames=A.slice(O,O+R);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":T.NamedRanges=R,T.DefinedNames=A.slice(O,O+R);break;case"Charts":case"Diagramme":T.Chartsheets=R,T.ChartNames=A.slice(O,O+R);break}O+=R}}function parse_ext_props(L,S,T){var _={};return S||(S={}),L=utf8read(L),EXT_PROPS.forEach(function(w){var B=(L.match(matchtag(w[0]))||[])[1];switch(w[2]){case"string":B&&(S[w[1]]=unescapexml(B));break;case"bool":S[w[1]]=B==="true";break;case"raw":var A=L.match(new RegExp("<"+w[0]+"[^>]*>([\\s\\S]*?)</"+w[0]+">"));A&&A.length>0&&(_[w[1]]=A[1]);break}}),_.HeadingPairs&&_.TitlesOfParts&&load_props_pairs(_.HeadingPairs,_.TitlesOfParts,S,T),S}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(L,S){var T={},_="",w=L.match(custregex);if(w)for(var B=0;B!=w.length;++B){var A=w[B],O=parsexmltag(A);switch(O[0]){case"<?xml":break;case"<Properties":break;case"<property":_=unescapexml(O.name);break;case"</property>":_=null;break;default:if(A.indexOf("<vt:")===0){var R=A.split(">"),P=R[0].slice(4),E=R[1];switch(P){case"lpstr":case"bstr":case"lpwstr":T[_]=unescapexml(E);break;case"bool":T[_]=parsexmlbool(E);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":T[_]=parseInt(E,10);break;case"r4":case"r8":case"decimal":T[_]=parseFloat(E);break;case"filetime":case"date":T[_]=parseDate(E);break;case"cy":case"error":T[_]=unescapexml(E);break;default:if(P.slice(-1)=="/")break;S.WTF&&typeof console<"u"&&console.warn("Unexpected",A,P,R)}}else if(A.slice(0,2)!=="</"){if(S.WTF)throw new Error(A)}}}return T}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(L,S,T){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),S=evert_XLMLDPM[S]||S,L[S]=T}function parse_FILETIME(L){var S=L.read_shift(4),T=L.read_shift(4);return new Date((T/1e7*Math.pow(2,32)+S/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function parse_lpstr(L,S,T){var _=L.l,w=L.read_shift(0,"lpstr-cp");if(T)for(;L.l-_&3;)++L.l;return w}function parse_lpwstr(L,S,T){var _=L.read_shift(0,"lpwstr");return _}function parse_VtStringBase(L,S,T){return S===31?parse_lpwstr(L):parse_lpstr(L,S,T)}function parse_VtString(L,S,T){return parse_VtStringBase(L,S,T===!1?0:4)}function parse_VtUnalignedString(L,S){if(!S)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(L,S,0)}function parse_VtVecLpwstrValue(L){for(var S=L.read_shift(4),T=[],_=0;_!=S;++_){var w=L.l;T[_]=L.read_shift(0,"lpwstr").replace(chr0,""),L.l-w&2&&(L.l+=2)}return T}function parse_VtVecUnalignedLpstrValue(L){for(var S=L.read_shift(4),T=[],_=0;_!=S;++_)T[_]=L.read_shift(0,"lpstr-cp").replace(chr0,"");return T}function parse_VtHeadingPair(L){var S=L.l,T=parse_TypedPropertyValue(L,VT_USTR);L[L.l]==0&&L[L.l+1]==0&&L.l-S&2&&(L.l+=2);var _=parse_TypedPropertyValue(L,VT_I4);return[T,_]}function parse_VtVecHeadingPairValue(L){for(var S=L.read_shift(4),T=[],_=0;_<S/2;++_)T.push(parse_VtHeadingPair(L));return T}function parse_dictionary(L,S){for(var T=L.read_shift(4),_={},w=0;w!=T;++w){var B=L.read_shift(4),A=L.read_shift(4);_[B]=L.read_shift(A,S===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),S===1200&&A%2&&(L.l+=2)}return L.l&3&&(L.l=L.l>>3<<2),_}function parse_BLOB(L){var S=L.read_shift(4),T=L.slice(L.l,L.l+S);return L.l+=S,(S&3)>0&&(L.l+=4-(S&3)&3),T}function parse_ClipboardData(L){var S={};return S.Size=L.read_shift(4),L.l+=S.Size+3-(S.Size-1)%4,S}function parse_TypedPropertyValue(L,S,T){var _=L.read_shift(2),w,B=T||{};if(L.l+=2,S!==VT_VARIANT&&_!==S&&VT_CUSTOM.indexOf(S)===-1&&!((S&65534)==4126&&(_&65534)==4126))throw new Error("Expected type "+S+" saw "+_);switch(S===VT_VARIANT?_:S){case 2:return w=L.read_shift(2,"i"),B.raw||(L.l+=2),w;case 3:return w=L.read_shift(4,"i"),w;case 11:return L.read_shift(4)!==0;case 19:return w=L.read_shift(4),w;case 30:return parse_lpstr(L,_,4).replace(chr0,"");case 31:return parse_lpwstr(L);case 64:return parse_FILETIME(L);case 65:return parse_BLOB(L);case 71:return parse_ClipboardData(L);case 80:return parse_VtString(L,_,!B.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(L,_).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(L);case 4126:case 4127:return _==4127?parse_VtVecLpwstrValue(L):parse_VtVecUnalignedLpstrValue(L);default:throw new Error("TypedPropertyValue unrecognized type "+S+" "+_)}}function parse_PropertySet(L,S){var T=L.l,_=L.read_shift(4),w=L.read_shift(4),B=[],A=0,O=0,R=-1,P={};for(A=0;A!=w;++A){var E=L.read_shift(4),D=L.read_shift(4);B[A]=[E,D+T]}B.sort(function(V,j){return V[1]-j[1]});var I={};for(A=0;A!=w;++A){if(L.l!==B[A][1]){var M=!0;if(A>0&&S)switch(S[B[A-1][0]].t){case 2:L.l+2===B[A][1]&&(L.l+=2,M=!1);break;case 80:L.l<=B[A][1]&&(L.l=B[A][1],M=!1);break;case 4108:L.l<=B[A][1]&&(L.l=B[A][1],M=!1);break}if((!S||A==0)&&L.l<=B[A][1]&&(M=!1,L.l=B[A][1]),M)throw new Error("Read Error: Expected address "+B[A][1]+" at "+L.l+" :"+A)}if(S){var N=S[B[A][0]];if(I[N.n]=parse_TypedPropertyValue(L,N.t,{raw:!0}),N.p==="version"&&(I[N.n]=String(I[N.n]>>16)+"."+("0000"+String(I[N.n]&65535)).slice(-4)),N.n=="CodePage")switch(I[N.n]){case 0:I[N.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(O=I[N.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+I[N.n])}}else if(B[A][0]===1){if(O=I.CodePage=parse_TypedPropertyValue(L,VT_I2),set_cp(O),R!==-1){var k=L.l;L.l=B[R][1],P=parse_dictionary(L,O),L.l=k}}else if(B[A][0]===0){if(O===0){R=A,L.l=B[A+1][1];continue}P=parse_dictionary(L,O)}else{var F=P[B[A][0]],G;switch(L[L.l]){case 65:L.l+=4,G=parse_BLOB(L);break;case 30:L.l+=4,G=parse_VtString(L,L[L.l-4]).replace(/\u0000+$/,"");break;case 31:L.l+=4,G=parse_VtString(L,L[L.l-4]).replace(/\u0000+$/,"");break;case 3:L.l+=4,G=L.read_shift(4,"i");break;case 19:L.l+=4,G=L.read_shift(4);break;case 5:L.l+=4,G=L.read_shift(8,"f");break;case 11:L.l+=4,G=parsebool(L,4);break;case 64:L.l+=4,G=parseDate(parse_FILETIME(L));break;default:throw new Error("unparsed value: "+L[L.l])}I[F]=G}}return L.l=T+_,I}function parse_PropertySetStream(L,S,T){var _=L.content;if(!_)return{};prep_blob(_,0);var w,B,A,O,R=0;_.chk("feff","Byte Order: "),_.read_shift(2);var P=_.read_shift(4),E=_.read_shift(16);if(E!==CFB.utils.consts.HEADER_CLSID&&E!==T)throw new Error("Bad PropertySet CLSID "+E);if(w=_.read_shift(4),w!==1&&w!==2)throw new Error("Unrecognized #Sets: "+w);if(B=_.read_shift(16),O=_.read_shift(4),w===1&&O!==_.l)throw new Error("Length mismatch: "+O+" !== "+_.l);w===2&&(A=_.read_shift(16),R=_.read_shift(4));var D=parse_PropertySet(_,S),I={SystemIdentifier:P};for(var M in D)I[M]=D[M];if(I.FMTID=B,w===1)return I;if(R-_.l==2&&(_.l+=2),_.l!==R)throw new Error("Length mismatch 2: "+_.l+" !== "+R);var N;try{N=parse_PropertySet(_,null)}catch(k){}for(M in N)I[M]=N[M];return I.FMTID=[B,A],I}function parsenoop2(L,S){return L.read_shift(S),null}function parslurp(L,S,T){for(var _=[],w=L.l+S;L.l<w;)_.push(T(L,w-L.l));if(w!==L.l)throw new Error("Slurp error");return _}function parsebool(L,S){return L.read_shift(S)===1}function parseuint16(L){return L.read_shift(2,"u")}function parseuint16a(L,S){return parslurp(L,S,parseuint16)}function parse_Bes(L){var S=L.read_shift(1),T=L.read_shift(1);return T===1?S:S===1}function parse_ShortXLUnicodeString(L,S,T){var _=L.read_shift(T&&T.biff>=12?2:1),w="sbcs-cont";if(T&&T.biff>=8,!T||T.biff==8){var B=L.read_shift(1);B&&(w="dbcs-cont")}else T.biff==12&&(w="wstr");T.biff>=2&&T.biff<=5&&(w="cpstr");var A=_?L.read_shift(_,w):"";return A}function parse_XLUnicodeRichExtendedString(L){var S=L.read_shift(2),T=L.read_shift(1),_=T&4,w=T&8,B=1+(T&1),A=0,O,R={};w&&(A=L.read_shift(2)),_&&(O=L.read_shift(4));var P=B==2?"dbcs-cont":"sbcs-cont",E=S===0?"":L.read_shift(S,P);return w&&(L.l+=4*A),_&&(L.l+=O),R.t=E,w||(R.raw="<t>"+R.t+"</t>",R.r=R.t),R}function parse_XLUnicodeStringNoCch(L,S,T){var _;if(T){if(T.biff>=2&&T.biff<=5)return L.read_shift(S,"cpstr");if(T.biff>=12)return L.read_shift(S,"dbcs-cont")}var w=L.read_shift(1);return w===0?_=L.read_shift(S,"sbcs-cont"):_=L.read_shift(S,"dbcs-cont"),_}function parse_XLUnicodeString(L,S,T){var _=L.read_shift(T&&T.biff==2?1:2);return _===0?(L.l++,""):parse_XLUnicodeStringNoCch(L,_,T)}function parse_XLUnicodeString2(L,S,T){if(T.biff>5)return parse_XLUnicodeString(L,S,T);var _=L.read_shift(1);return _===0?(L.l++,""):L.read_shift(_,T.biff<=4||!L.lens?"cpstr":"sbcs-cont")}function parse_ControlInfo(L){var S=L.read_shift(1);L.l++;var T=L.read_shift(2);return L.l+=2,[S,T]}function parse_URLMoniker(L){var S=L.read_shift(4),T=L.l,_=!1;S>24&&(L.l+=S-24,L.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(_=!0),L.l=T);var w=L.read_shift((_?S-24:S)>>1,"utf16le").replace(chr0,"");return _&&(L.l+=24),w}function parse_FileMoniker(L){for(var S=L.read_shift(2),T="";S-- >0;)T+="../";var _=L.read_shift(0,"lpstr-ansi");if(L.l+=2,L.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var w=L.read_shift(4);if(w===0)return T+_.replace(/\\/g,"/");var B=L.read_shift(4);if(L.read_shift(2)!=3)throw new Error("Bad FileMoniker");var A=L.read_shift(B>>1,"utf16le").replace(chr0,"");return T+A}function parse_HyperlinkMoniker(L,S){var T=L.read_shift(16);switch(T){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(L);case"0303000000000000c000000000000046":return parse_FileMoniker(L);default:throw new Error("Unsupported Moniker "+T)}}function parse_HyperlinkString(L){var S=L.read_shift(4),T=S>0?L.read_shift(S,"utf16le").replace(chr0,""):"";return T}function parse_Hyperlink(L,S){var T=L.l+S,_=L.read_shift(4);if(_!==2)throw new Error("Unrecognized streamVersion: "+_);var w=L.read_shift(2);L.l+=2;var B,A,O,R,P="",E,D;w&16&&(B=parse_HyperlinkString(L,T-L.l)),w&128&&(A=parse_HyperlinkString(L,T-L.l)),(w&257)===257&&(O=parse_HyperlinkString(L,T-L.l)),(w&257)===1&&(R=parse_HyperlinkMoniker(L,T-L.l)),w&8&&(P=parse_HyperlinkString(L,T-L.l)),w&32&&(E=L.read_shift(16)),w&64&&(D=parse_FILETIME(L)),L.l=T;var I=A||O||R||"";I&&P&&(I+="#"+P),I||(I="#"+P),w&2&&I.charAt(0)=="/"&&I.charAt(1)!="/"&&(I="file://"+I);var M={Target:I};return E&&(M.guid=E),D&&(M.time=D),B&&(M.Tooltip=B),M}function parse_LongRGBA(L){var S=L.read_shift(1),T=L.read_shift(1),_=L.read_shift(1),w=L.read_shift(1);return[S,T,_,w]}function parse_LongRGB(L,S){var T=parse_LongRGBA(L);return T[3]=0,T}function parse_XLSCell(L){var S=L.read_shift(2),T=L.read_shift(2),_=L.read_shift(2);return{r:S,c:T,ixfe:_}}function parse_frtHeader(L){var S=L.read_shift(2),T=L.read_shift(2);return L.l+=8,{type:S,flags:T}}function parse_OptXLUnicodeString(L,S,T){return S===0?"":parse_XLUnicodeString2(L,S,T)}function parse_XTI(L,S,T){var _=T.biff>8?4:2,w=L.read_shift(_),B=L.read_shift(_,"i"),A=L.read_shift(_,"i");return[w,B,A]}function parse_RkRec(L){var S=L.read_shift(2),T=parse_RkNumber(L);return[S,T]}function parse_AddinUdf(L,S,T){L.l+=4,S-=4;var _=L.l+S,w=parse_ShortXLUnicodeString(L,S,T),B=L.read_shift(2);if(_-=L.l,B!==_)throw new Error("Malformed AddinUdf: padding = "+_+" != "+B);return L.l+=B,w}function parse_Ref8U(L){var S=L.read_shift(2),T=L.read_shift(2),_=L.read_shift(2),w=L.read_shift(2);return{s:{c:_,r:S},e:{c:w,r:T}}}function parse_RefU(L){var S=L.read_shift(2),T=L.read_shift(2),_=L.read_shift(1),w=L.read_shift(1);return{s:{c:_,r:S},e:{c:w,r:T}}}var parse_Ref=parse_RefU;function parse_FtCmo(L){L.l+=4;var S=L.read_shift(2),T=L.read_shift(2),_=L.read_shift(2);return L.l+=12,[T,S,_]}function parse_FtNts(L){var S={};return L.l+=4,L.l+=16,S.fSharedNote=L.read_shift(2),L.l+=4,S}function parse_FtCf(L){var S={};return L.l+=4,L.cf=L.read_shift(2),S}function parse_FtSkip(L){L.l+=2,L.l+=L.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(L,S){for(var T=L.l+S,_=[];L.l<T;){var w=L.read_shift(2);L.l-=2;try{_.push(FtTab[w](L,T-L.l))}catch(B){return L.l=T,_}}return L.l!=T&&(L.l=T),_}function parse_BOF(L,S){var T={BIFFVer:0,dt:0};switch(T.BIFFVer=L.read_shift(2),S-=2,S>=2&&(T.dt=L.read_shift(2),L.l-=2),T.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(S>6)throw new Error("Unexpected BIFF Ver "+T.BIFFVer)}return L.read_shift(S),T}function parse_InterfaceHdr(L,S){return S===0||L.read_shift(2),1200}function parse_WriteAccess(L,S,T){if(T.enc)return L.l+=S,"";var _=L.l,w=parse_XLUnicodeString2(L,0,T);return L.read_shift(S+_-L.l),w}function parse_WsBool(L,S,T){var _=T&&T.biff==8||S==2?L.read_shift(2):(L.l+=S,0);return{fDialog:_&16,fBelow:_&64,fRight:_&128}}function parse_BoundSheet8(L,S,T){var _=L.read_shift(4),w=L.read_shift(1)&3,B=L.read_shift(1);switch(B){case 0:B="Worksheet";break;case 1:B="Macrosheet";break;case 2:B="Chartsheet";break;case 6:B="VBAModule";break}var A=parse_ShortXLUnicodeString(L,0,T);return A.length===0&&(A="Sheet1"),{pos:_,hs:w,dt:B,name:A}}function parse_SST(L,S){for(var T=L.l+S,_=L.read_shift(4),w=L.read_shift(4),B=[],A=0;A!=w&&L.l<T;++A)B.push(parse_XLUnicodeRichExtendedString(L));return B.Count=_,B.Unique=w,B}function parse_ExtSST(L,S){var T={};return T.dsst=L.read_shift(2),L.l+=S-2,T}function parse_Row(L){var S={};S.r=L.read_shift(2),S.c=L.read_shift(2),S.cnt=L.read_shift(2)-S.c;var T=L.read_shift(2);L.l+=4;var _=L.read_shift(1);return L.l+=3,_&7&&(S.level=_&7),_&32&&(S.hidden=!0),_&64&&(S.hpt=T/20),S}function parse_ForceFullCalculation(L){var S=parse_frtHeader(L);if(S.type!=2211)throw new Error("Invalid Future Record "+S.type);var T=L.read_shift(4);return T!==0}function parse_RecalcId(L){return L.read_shift(2),L.read_shift(4)}function parse_DefaultRowHeight(L,S,T){var _=0;T&&T.biff==2||(_=L.read_shift(2));var w=L.read_shift(2);T&&T.biff==2&&(_=1-(w>>15),w&=32767);var B={Unsynced:_&1,DyZero:(_&2)>>1,ExAsc:(_&4)>>2,ExDsc:(_&8)>>3};return[B,w]}function parse_Window1(L){var S=L.read_shift(2),T=L.read_shift(2),_=L.read_shift(2),w=L.read_shift(2),B=L.read_shift(2),A=L.read_shift(2),O=L.read_shift(2),R=L.read_shift(2),P=L.read_shift(2);return{Pos:[S,T],Dim:[_,w],Flags:B,CurTab:A,FirstTab:O,Selected:R,TabRatio:P}}function parse_Window2(L,S,T){if(T&&T.biff>=2&&T.biff<5)return{};var _=L.read_shift(2);return{RTL:_&64}}function parse_Pane(){}function parse_Font(L,S,T){var _={dyHeight:L.read_shift(2),fl:L.read_shift(2)};switch(T&&T.biff||8){case 2:break;case 3:case 4:L.l+=2;break;default:L.l+=10;break}return _.name=parse_ShortXLUnicodeString(L,0,T),_}function parse_LabelSst(L){var S=parse_XLSCell(L);return S.isst=L.read_shift(4),S}function parse_Label(L,S,T){T.biffguess&&T.biff==2&&(T.biff=5);var _=L.l+S,w=parse_XLSCell(L);T.biff==2&&L.l++;var B=parse_XLUnicodeString(L,_-L.l,T);return w.val=B,w}function parse_Format(L,S,T){var _=L.read_shift(2),w=parse_XLUnicodeString2(L,0,T);return[_,w]}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(L,S,T){var _=L.l+S,w=T.biff==8||!T.biff?4:2,B=L.read_shift(w),A=L.read_shift(w),O=L.read_shift(2),R=L.read_shift(2);return L.l=_,{s:{r:B,c:O},e:{r:A,c:R}}}function parse_RK(L){var S=L.read_shift(2),T=L.read_shift(2),_=parse_RkRec(L);return{r:S,c:T,ixfe:_[0],rknum:_[1]}}function parse_MulRk(L,S){for(var T=L.l+S-2,_=L.read_shift(2),w=L.read_shift(2),B=[];L.l<T;)B.push(parse_RkRec(L));if(L.l!==T)throw new Error("MulRK read error");var A=L.read_shift(2);if(B.length!=A-w+1)throw new Error("MulRK length mismatch");return{r:_,c:w,C:A,rkrec:B}}function parse_MulBlank(L,S){for(var T=L.l+S-2,_=L.read_shift(2),w=L.read_shift(2),B=[];L.l<T;)B.push(L.read_shift(2));if(L.l!==T)throw new Error("MulBlank read error");var A=L.read_shift(2);if(B.length!=A-w+1)throw new Error("MulBlank length mismatch");return{r:_,c:w,C:A,ixfe:B}}function parse_CellStyleXF(L,S,T,_){var w={},B=L.read_shift(4),A=L.read_shift(4),O=L.read_shift(4),R=L.read_shift(2);return w.patternType=XLSFillPattern[O>>26],_.cellStyles&&(w.alc=B&7,w.fWrap=B>>3&1,w.alcV=B>>4&7,w.fJustLast=B>>7&1,w.trot=B>>8&255,w.cIndent=B>>16&15,w.fShrinkToFit=B>>20&1,w.iReadOrder=B>>22&2,w.fAtrNum=B>>26&1,w.fAtrFnt=B>>27&1,w.fAtrAlc=B>>28&1,w.fAtrBdr=B>>29&1,w.fAtrPat=B>>30&1,w.fAtrProt=B>>31&1,w.dgLeft=A&15,w.dgRight=A>>4&15,w.dgTop=A>>8&15,w.dgBottom=A>>12&15,w.icvLeft=A>>16&127,w.icvRight=A>>23&127,w.grbitDiag=A>>30&3,w.icvTop=O&127,w.icvBottom=O>>7&127,w.icvDiag=O>>14&127,w.dgDiag=O>>21&15,w.icvFore=R&127,w.icvBack=R>>7&127,w.fsxButton=R>>14&1),w}function parse_XF(L,S,T){var _={};return _.ifnt=L.read_shift(2),_.numFmtId=L.read_shift(2),_.flags=L.read_shift(2),_.fStyle=_.flags>>2&1,S-=6,_.data=parse_CellStyleXF(L,S,_.fStyle,T),_}function parse_Guts(L){L.l+=4;var S=[L.read_shift(2),L.read_shift(2)];if(S[0]!==0&&S[0]--,S[1]!==0&&S[1]--,S[0]>7||S[1]>7)throw new Error("Bad Gutters: "+S.join("|"));return S}function parse_BoolErr(L,S,T){var _=parse_XLSCell(L);(T.biff==2||S==9)&&++L.l;var w=parse_Bes(L);return _.val=w,_.t=w===!0||w===!1?"b":"e",_}function parse_Number(L,S,T){T.biffguess&&T.biff==2&&(T.biff=5);var _=parse_XLSCell(L),w=parse_Xnum(L);return _.val=w,_}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(L,S,T){var _=L.l+S,w=L.read_shift(2),B=L.read_shift(2);if(T.sbcch=B,B==1025||B==14849)return[B,w];if(B<1||B>255)throw new Error("Unexpected SupBook type: "+B);for(var A=parse_XLUnicodeStringNoCch(L,B),O=[];_>L.l;)O.push(parse_XLUnicodeString(L));return[B,w,A,O]}function parse_ExternName(L,S,T){var _=L.read_shift(2),w,B={fBuiltIn:_&1,fWantAdvise:_>>>1&1,fWantPict:_>>>2&1,fOle:_>>>3&1,fOleLink:_>>>4&1,cf:_>>>5&1023,fIcon:_>>>15&1};return T.sbcch===14849&&(w=parse_AddinUdf(L,S-2,T)),B.body=w||L.read_shift(S-2),typeof w=="string"&&(B.Name=w),B}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(L,S,T){var _=L.l+S,w=L.read_shift(2),B=L.read_shift(1),A=L.read_shift(1),O=L.read_shift(T&&T.biff==2?1:2),R=0;(!T||T.biff>=5)&&(T.biff!=5&&(L.l+=2),R=L.read_shift(2),T.biff==5&&(L.l+=2),L.l+=4);var P=parse_XLUnicodeStringNoCch(L,A,T);w&32&&(P=XLSLblBuiltIn[P.charCodeAt(0)]);var E=_-L.l;T&&T.biff==2&&--E;var D=_==L.l||O===0||!(E>0)?[]:parse_NameParsedFormula(L,E,T,O);return{chKey:B,Name:P,itab:R,rgce:D}}function parse_ExternSheet(L,S,T){if(T.biff<8)return parse_BIFF5ExternSheet(L,S,T);for(var _=[],w=L.l+S,B=L.read_shift(T.biff>8?4:2);B--!==0;)_.push(parse_XTI(L,T.biff>8?12:6,T));if(L.l!=w)throw new Error("Bad ExternSheet: "+L.l+" != "+w);return _}function parse_BIFF5ExternSheet(L,S,T){L[L.l+1]==3&&L[L.l]++;var _=parse_ShortXLUnicodeString(L,S,T);return _.charCodeAt(0)==3?_.slice(1):_}function parse_NameCmt(L,S,T){if(T.biff<8){L.l+=S;return}var _=L.read_shift(2),w=L.read_shift(2),B=parse_XLUnicodeStringNoCch(L,_,T),A=parse_XLUnicodeStringNoCch(L,w,T);return[B,A]}function parse_ShrFmla(L,S,T){var _=parse_RefU(L);L.l++;var w=L.read_shift(1);return S-=8,[parse_SharedParsedFormula(L,S,T),w,_]}function parse_Array(L,S,T){var _=parse_Ref(L);switch(T.biff){case 2:L.l++,S-=7;break;case 3:case 4:L.l+=2,S-=8;break;default:L.l+=6,S-=12}return[_,parse_ArrayParsedFormula(L,S,T)]}function parse_MTRSettings(L){var S=L.read_shift(4)!==0,T=L.read_shift(4)!==0,_=L.read_shift(4);return[S,T,_]}function parse_NoteSh(L,S,T){if(!(T.biff<8)){var _=L.read_shift(2),w=L.read_shift(2),B=L.read_shift(2),A=L.read_shift(2),O=parse_XLUnicodeString2(L,0,T);return T.biff<8&&L.read_shift(1),[{r:_,c:w},O,A,B]}}function parse_Note(L,S,T){return parse_NoteSh(L,S,T)}function parse_MergeCells(L,S){for(var T=[],_=L.read_shift(2);_--;)T.push(parse_Ref8U(L));return T}function parse_Obj(L,S,T){if(T&&T.biff<8)return parse_BIFF5Obj(L,S,T);var _=parse_FtCmo(L),w=parse_FtArray(L,S-22,_[1]);return{cmo:_,ft:w}}var parse_BIFF5OT={8:function(L,S){var T=L.l+S;L.l+=10;var _=L.read_shift(2);L.l+=4,L.l+=2,L.l+=2,L.l+=2,L.l+=4;var w=L.read_shift(1);return L.l+=w,L.l=T,{fmt:_}}};function parse_BIFF5Obj(L,S,T){L.l+=4;var _=L.read_shift(2),w=L.read_shift(2),B=L.read_shift(2);L.l+=2,L.l+=2,L.l+=2,L.l+=2,L.l+=2,L.l+=2,L.l+=2,L.l+=2,L.l+=2,L.l+=6,S-=36;var A=[];return A.push((parse_BIFF5OT[_]||parsenoop)(L,S,T)),{cmo:[w,_,B],ft:A}}function parse_TxO(L,S,T){var _=L.l,w="";try{L.l+=4;var B=(T.lastobj||{cmo:[0,0]}).cmo[1],A;[0,5,7,11,12,14].indexOf(B)==-1?L.l+=6:A=parse_ControlInfo(L,6,T);var O=L.read_shift(2);L.read_shift(2),parseuint16(L,2);var R=L.read_shift(2);L.l+=R;for(var P=1;P<L.lens.length-1;++P){if(L.l-_!=L.lens[P])throw new Error("TxO: bad continue record");var E=L[L.l],D=parse_XLUnicodeStringNoCch(L,L.lens[P+1]-L.lens[P]-1);if(w+=D,w.length>=(E?O:2*O))break}if(w.length!==O&&w.length!==O*2)throw new Error("cchText: "+O+" != "+w.length);return L.l=_+S,{t:w}}catch(I){return L.l=_+S,{t:w}}}function parse_HLink(L,S){var T=parse_Ref8U(L);L.l+=16;var _=parse_Hyperlink(L,S-24);return[T,_]}function parse_HLinkTooltip(L,S){L.read_shift(2);var T=parse_Ref8U(L),_=L.read_shift((S-10)/2,"dbcs-cont");return _=_.replace(chr0,""),[T,_]}function parse_Country(L){var S=[0,0],T;return T=L.read_shift(2),S[0]=CountryEnum[T]||T,T=L.read_shift(2),S[1]=CountryEnum[T]||T,S}function parse_ClrtClient(L){for(var S=L.read_shift(2),T=[];S-- >0;)T.push(parse_LongRGB(L));return T}function parse_Palette(L){for(var S=L.read_shift(2),T=[];S-- >0;)T.push(parse_LongRGB(L));return T}function parse_XFCRC(L){L.l+=2;var S={cxfs:0,crc:0};return S.cxfs=L.read_shift(2),S.crc=L.read_shift(4),S}function parse_ColInfo(L,S,T){if(!T.cellStyles)return parsenoop(L,S);var _=T&&T.biff>=12?4:2,w=L.read_shift(_),B=L.read_shift(_),A=L.read_shift(_),O=L.read_shift(_),R=L.read_shift(2);_==2&&(L.l+=2);var P={s:w,e:B,w:A,ixfe:O,flags:R};return(T.biff>=5||!T.biff)&&(P.level=R>>8&7),P}function parse_Setup(L,S){var T={};return S<32||(L.l+=16,T.header=parse_Xnum(L),T.footer=parse_Xnum(L),L.l+=2),T}function parse_ShtProps(L,S,T){var _={area:!1};if(T.biff!=5)return L.l+=S,_;var w=L.read_shift(1);return L.l+=3,w&16&&(_.area=!0),_}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(L){var S=L.read_shift(2),T=L.read_shift(2),_=L.read_shift(4),w={fmt:S,env:T,len:_,data:L.slice(L.l,L.l+_)};return L.l+=_,w}function parse_BIFF2STR(L,S,T){T.biffguess&&T.biff==5&&(T.biff=2);var _=parse_XLSCell(L);++L.l;var w=parse_XLUnicodeString2(L,S-7,T);return _.t="str",_.val=w,_}function parse_BIFF2NUM(L){var S=parse_XLSCell(L);++L.l;var T=parse_Xnum(L);return S.t="n",S.val=T,S}function parse_BIFF2INT(L){var S=parse_XLSCell(L);++L.l;var T=L.read_shift(2);return S.t="n",S.val=T,S}function parse_BIFF2STRING(L){var S=L.read_shift(1);return S===0?(L.l++,""):L.read_shift(S,"sbcs-cont")}function parse_BIFF2FONTXTRA(L,S){L.l+=6,L.l+=2,L.l+=1,L.l+=3,L.l+=1,L.l+=S-13}function parse_RString(L,S,T){var _=L.l+S,w=parse_XLSCell(L),B=L.read_shift(2),A=parse_XLUnicodeStringNoCch(L,B,T);return L.l=_,w.t="str",w.val=A,w}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var L={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},S=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function T(O,R){var P=[],E=new_raw_buf(1);switch(R.type){case"base64":E=s2a(Base64_decode(O));break;case"binary":E=s2a(O);break;case"buffer":case"array":E=O;break}prep_blob(E,0);var D=E.read_shift(1),I=!!(D&136),M=!1,N=!1;switch(D){case 2:break;case 3:break;case 48:M=!0,I=!0;break;case 49:M=!0,I=!0;break;case 131:break;case 139:break;case 140:N=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+D.toString(16))}var k=0,F=521;D==2&&(k=E.read_shift(2)),E.l+=3,D!=2&&(k=E.read_shift(4)),k>1048576&&(k=1e6),D!=2&&(F=E.read_shift(2));var G=E.read_shift(2),V=R.codepage||1252;D!=2&&(E.l+=16,E.read_shift(1),E[E.l]!==0&&(V=L[E[E.l]]),E.l+=1,E.l+=2),N&&(E.l+=36);for(var j=[],H={},U=Math.min(E.length,D==2?521:F-10-(M?264:0)),X=N?32:11;E.l<U&&E[E.l]!=13;)switch(H={},H.name=$cptable.utils.decode(V,E.slice(E.l,E.l+X)).replace(/[\u0000\r\n].*$/g,""),E.l+=X,H.type=String.fromCharCode(E.read_shift(1)),D!=2&&!N&&(H.offset=E.read_shift(4)),H.len=E.read_shift(1),D==2&&(H.offset=E.read_shift(2)),H.dec=E.read_shift(1),H.name.length&&j.push(H),D!=2&&(E.l+=N?13:14),H.type){case"B":(!M||H.len!=8)&&R.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"G":case"P":R.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+H.type)}if(E[E.l]!==13&&(E.l=F-1),E.read_shift(1)!==13)throw new Error("DBF Terminator not found "+E.l+" "+E[E.l]);E.l=F;var Y=0,z=0;for(P[0]=[],z=0;z!=j.length;++z)P[0][z]=j[z].name;for(;k-- >0;){if(E[E.l]===42){E.l+=G;continue}for(++E.l,P[++Y]=[],z=0,z=0;z!=j.length;++z){var W=E.slice(E.l,E.l+j[z].len);E.l+=j[z].len,prep_blob(W,0);var Z=$cptable.utils.decode(V,W);switch(j[z].type){case"C":Z.trim().length&&(P[Y][z]=Z.replace(/\s+$/,""));break;case"D":Z.length===8?P[Y][z]=new Date(+Z.slice(0,4),+Z.slice(4,6)-1,+Z.slice(6,8)):P[Y][z]=Z;break;case"F":P[Y][z]=parseFloat(Z.trim());break;case"+":case"I":P[Y][z]=N?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(Z.trim().toUpperCase()){case"Y":case"T":P[Y][z]=!0;break;case"N":case"F":P[Y][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Z+"|")}break;case"M":if(!I)throw new Error("DBF Unexpected MEMO for type "+D.toString(16));P[Y][z]="##MEMO##"+(N?parseInt(Z.trim(),10):W.read_shift(4));break;case"N":Z=Z.replace(/\u0000/g,"").trim(),Z&&Z!="."&&(P[Y][z]=+Z||0);break;case"@":P[Y][z]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":P[Y][z]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":P[Y][z]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":P[Y][z]=-W.read_shift(-8,"f");break;case"B":if(M&&j[z].len==8){P[Y][z]=W.read_shift(8,"f");break}case"G":case"P":W.l+=j[z].len;break;case"0":if(j[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[z].type)}}}if(D!=2&&E.l<E.length&&E[E.l++]!=26)throw new Error("DBF EOF Marker missing "+(E.l-1)+" of "+E.length+" "+E[E.l-1].toString(16));return R&&R.sheetRows&&(P=P.slice(0,R.sheetRows)),R.DBF=j,P}function _(O,R){var P=R||{};P.dateNF||(P.dateNF="yyyymmdd");var E=aoa_to_sheet(T(O,P),P);return E["!cols"]=P.DBF.map(function(D){return{wch:D.len,DBF:D}}),delete P.DBF,E}function w(O,R){try{return sheet_to_workbook(_(O,R),R)}catch(P){if(R&&R.WTF)throw P}return{SheetNames:[],Sheets:{}}}var B={B:8,C:250,L:1,D:8,"?":0,"":0};function A(O,R){var P=R||{};if(+P.codepage>=0&&set_cp(+P.codepage),P.type=="string")throw new Error("Cannot write DBF to JS string");var E=buf_array(),D=sheet_to_json(O,{header:1,raw:!0,cellDates:!0}),I=D[0],M=D.slice(1),N=O["!cols"]||[],k=0,F=0,G=0,V=1;for(k=0;k<I.length;++k){if(((N[k]||{}).DBF||{}).name){I[k]=N[k].DBF.name,++G;continue}if(I[k]!=null){if(++G,typeof I[k]=="number"&&(I[k]=I[k].toString(10)),typeof I[k]!="string")throw new Error("DBF Invalid column name "+I[k]+" |"+typeof I[k]+"|");if(I.indexOf(I[k])!==k){for(F=0;F<1024;++F)if(I.indexOf(I[k]+"_"+F)==-1){I[k]+="_"+F;break}}}}var j=safe_decode_range(O["!ref"]),H=[],U=[],X=[];for(k=0;k<=j.e.c-j.s.c;++k){var Y="",z="",W=0,Z=[];for(F=0;F<M.length;++F)M[F][k]!=null&&Z.push(M[F][k]);if(Z.length==0||I[k]==null){H[k]="?";continue}for(F=0;F<Z.length;++F){switch(typeof Z[F]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=Z[F]instanceof Date?"D":"C";break;default:z="C"}W=Math.max(W,String(Z[F]).length),Y=Y&&Y!=z?"C":z}W>250&&(W=250),z=((N[k]||{}).DBF||{}).type,z=="C"&&N[k].DBF.len>W&&(W=N[k].DBF.len),Y=="B"&&z=="N"&&(Y="N",X[k]=N[k].DBF.dec,W=N[k].DBF.len),U[k]=Y=="C"||z=="N"?W:B[Y]||0,V+=U[k],H[k]=Y}var Q=E.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,M.length),Q.write_shift(2,296+32*G),Q.write_shift(2,V),k=0;k<4;++k)Q.write_shift(4,0);for(Q.write_shift(4,0|(+S[current_ansi]||3)<<8),k=0,F=0;k<I.length;++k)if(I[k]!=null){var ee=E.next(32),te=(I[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,te,"sbcs"),ee.write_shift(1,H[k]=="?"?"C":H[k],"sbcs"),ee.write_shift(4,F),ee.write_shift(1,U[k]||B[H[k]]||0),ee.write_shift(1,X[k]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),F+=U[k]||B[H[k]]||0}var re=E.next(264);for(re.write_shift(4,13),k=0;k<65;++k)re.write_shift(4,0);for(k=0;k<M.length;++k){var ie=E.next(V);for(ie.write_shift(1,0),F=0;F<I.length;++F)if(I[F]!=null)switch(H[F]){case"L":ie.write_shift(1,M[k][F]==null?63:M[k][F]?84:70);break;case"B":ie.write_shift(8,M[k][F]||0,"f");break;case"N":var ne="0";for(typeof M[k][F]=="number"&&(ne=M[k][F].toFixed(X[F]||0)),G=0;G<U[F]-ne.length;++G)ie.write_shift(1,32);ie.write_shift(1,ne,"sbcs");break;case"D":M[k][F]?(ie.write_shift(4,("0000"+M[k][F].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(M[k][F].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+M[k][F].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var he=String(M[k][F]!=null?M[k][F]:"").slice(0,U[F]);for(ie.write_shift(1,he,"sbcs"),G=0;G<U[F]-he.length;++G)ie.write_shift(1,32);break}}return E.next(1).write_shift(1,26),E.end()}return{to_workbook:w,to_sheet:_,from_sheet:A}}(),SYLK=function(){var L={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},S=new RegExp("\x1BN("+keys(L).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),T=function(I,M){var N=L[M];return typeof N=="number"?_getansi(N):N},_=function(I,M,N){var k=M.charCodeAt(0)-32<<4|N.charCodeAt(0)-48;return k==59?I:_getansi(k)};L["|"]=254;function w(I,M){switch(M.type){case"base64":return B(Base64_decode(I),M);case"binary":return B(I,M);case"buffer":return B(has_buf&&Buffer.isBuffer(I)?I.toString("binary"):a2s(I),M);case"array":return B(cc2str(I),M)}throw new Error("Unrecognized type "+M.type)}function B(I,M){var N=I.split(/[\n\r]+/),k=-1,F=-1,G=0,V=0,j=[],H=[],U=null,X={},Y=[],z=[],W=[],Z=0,Q;for(+M.codepage>=0&&set_cp(+M.codepage);G!==N.length;++G){Z=0;var ee=N[G].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,_).replace(S,T),te=ee.replace(/;;/g,"\0").split(";").map(function(de){return de.replace(/\u0000/g,";")}),re=te[0],ie;if(ee.length>0)switch(re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&H.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,he=!1,pe=!1,K=!1,ue=-1,le=-1;for(V=1;V<te.length;++V)switch(te[V].charAt(0)){case"A":break;case"X":F=parseInt(te[V].slice(1))-1,he=!0;break;case"Y":for(k=parseInt(te[V].slice(1))-1,he||(F=0),Q=j.length;Q<=k;++Q)j[Q]=[];break;case"K":ie=te[V].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(fuzzynum(ie))?isNaN(fuzzydate(ie).getDate())||(ie=parseDate(ie)):(ie=fuzzynum(ie),U!==null&&fmt_is_date(U)&&(ie=numdate(ie))),ne=!0;break;case"E":K=!0;var ce=rc_to_a1(te[V].slice(1),{r:k,c:F});j[k][F]=[j[k][F],ce];break;case"S":pe=!0,j[k][F]=[j[k][F],"S5S"];break;case"G":break;case"R":ue=parseInt(te[V].slice(1))-1;break;case"C":le=parseInt(te[V].slice(1))-1;break;default:if(M&&M.WTF)throw new Error("SYLK bad record "+ee)}if(ne&&(j[k][F]&&j[k][F].length==2?j[k][F][0]=ie:j[k][F]=ie,U=null),pe){if(K)throw new Error("SYLK shared formula cannot have own formula");var _e=ue>-1&&j[ue][le];if(!_e||!_e[1])throw new Error("SYLK shared formula cannot find base");j[k][F][1]=shift_formula_str(_e[1],{r:k-ue,c:F-le})}break;case"F":var oe=0;for(V=1;V<te.length;++V)switch(te[V].charAt(0)){case"X":F=parseInt(te[V].slice(1))-1,++oe;break;case"Y":for(k=parseInt(te[V].slice(1))-1,Q=j.length;Q<=k;++Q)j[Q]=[];break;case"M":Z=parseInt(te[V].slice(1))/20;break;case"F":break;case"G":break;case"P":U=H[parseInt(te[V].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=te[V].slice(1).split(" "),Q=parseInt(W[0],10);Q<=parseInt(W[1],10);++Q)Z=parseInt(W[2],10),z[Q-1]=Z===0?{hidden:!0}:{wch:Z},process_col(z[Q-1]);break;case"C":F=parseInt(te[V].slice(1))-1,z[F]||(z[F]={});break;case"R":k=parseInt(te[V].slice(1))-1,Y[k]||(Y[k]={}),Z>0?(Y[k].hpt=Z,Y[k].hpx=pt2px(Z)):Z===0&&(Y[k].hidden=!0);break;default:if(M&&M.WTF)throw new Error("SYLK bad record "+ee)}oe<1&&(U=null);break;default:if(M&&M.WTF)throw new Error("SYLK bad record "+ee)}}return Y.length>0&&(X["!rows"]=Y),z.length>0&&(X["!cols"]=z),M&&M.sheetRows&&(j=j.slice(0,M.sheetRows)),[j,X]}function A(I,M){var N=w(I,M),k=N[0],F=N[1],G=aoa_to_sheet(k,M);return keys(F).forEach(function(V){G[V]=F[V]}),G}function O(I,M){return sheet_to_workbook(A(I,M),M)}function R(I,M,N,k){var F="C;Y"+(N+1)+";X"+(k+1)+";K";switch(I.t){case"n":F+=I.v||0,I.f&&!I.F&&(F+=";E"+a1_to_rc(I.f,{r:N,c:k}));break;case"b":F+=I.v?"TRUE":"FALSE";break;case"e":F+=I.w||I.v;break;case"d":F+='"'+(I.w||I.v)+'"';break;case"s":F+='"'+I.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return F}function P(I,M){M.forEach(function(N,k){var F="F;W"+(k+1)+" "+(k+1)+" ";N.hidden?F+="0":(typeof N.width=="number"&&!N.wpx&&(N.wpx=width2px(N.width)),typeof N.wpx=="number"&&!N.wch&&(N.wch=px2char(N.wpx)),typeof N.wch=="number"&&(F+=Math.round(N.wch))),F.charAt(F.length-1)!=" "&&I.push(F)})}function E(I,M){M.forEach(function(N,k){var F="F;";N.hidden?F+="M0;":N.hpt?F+="M"+20*N.hpt+";":N.hpx&&(F+="M"+20*px2pt(N.hpx)+";"),F.length>2&&I.push(F+"R"+(k+1))})}function D(I,M){var N=["ID;PWXL;N;E"],k=[],F=safe_decode_range(I["!ref"]),G,V=Array.isArray(I),j="\r\n";N.push("P;PGeneral"),N.push("F;P0;DG0G8;M255"),I["!cols"]&&P(N,I["!cols"]),I["!rows"]&&E(N,I["!rows"]),N.push("B;Y"+(F.e.r-F.s.r+1)+";X"+(F.e.c-F.s.c+1)+";D"+[F.s.c,F.s.r,F.e.c,F.e.r].join(" "));for(var H=F.s.r;H<=F.e.r;++H)for(var U=F.s.c;U<=F.e.c;++U){var X=encode_cell({r:H,c:U});G=V?(I[H]||[])[U]:I[X],!(!G||G.v==null&&(!G.f||G.F))&&k.push(R(G,I,H,U))}return N.join(j)+j+k.join(j)+j+"E"+j}return{to_workbook:O,to_sheet:A,from_sheet:D}}(),DIF=function(){function L(B,A){switch(A.type){case"base64":return S(Base64_decode(B),A);case"binary":return S(B,A);case"buffer":return S(has_buf&&Buffer.isBuffer(B)?B.toString("binary"):a2s(B),A);case"array":return S(cc2str(B),A)}throw new Error("Unrecognized type "+A.type)}function S(B,A){for(var O=B.split("\n"),R=-1,P=-1,E=0,D=[];E!==O.length;++E){if(O[E].trim()==="BOT"){D[++R]=[],P=0;continue}if(!(R<0)){var I=O[E].trim().split(","),M=I[0],N=I[1];++E;for(var k=O[E]||"";(k.match(/["]/g)||[]).length&1&&E<O.length-1;)k+="\n"+O[++E];switch(k=k.trim(),+M){case-1:if(k==="BOT"){D[++R]=[],P=0;continue}else if(k!=="EOD")throw new Error("Unrecognized DIF special command "+k);break;case 0:k==="TRUE"?D[R][P]=!0:k==="FALSE"?D[R][P]=!1:isNaN(fuzzynum(N))?isNaN(fuzzydate(N).getDate())?D[R][P]=N:D[R][P]=parseDate(N):D[R][P]=fuzzynum(N),++P;break;case 1:k=k.slice(1,k.length-1),k=k.replace(/""/g,'"'),k&&k.match(/^=".*"$/)&&(k=k.slice(2,-1)),D[R][P++]=k!==""?k:null;break}if(k==="EOD")break}}return A&&A.sheetRows&&(D=D.slice(0,A.sheetRows)),D}function T(B,A){return aoa_to_sheet(L(B,A),A)}function _(B,A){return sheet_to_workbook(T(B,A),A)}var w=function(){var B=function(R,P,E,D,I){R.push(P),R.push(E+","+D),R.push('"'+I.replace(/"/g,'""')+'"')},A=function(R,P,E,D){R.push(P+","+E),R.push(P==1?'"'+D.replace(/"/g,'""')+'"':D)};return function(R){var P=[],E=safe_decode_range(R["!ref"]),D,I=Array.isArray(R);B(P,"TABLE",0,1,"sheetjs"),B(P,"VECTORS",0,E.e.r-E.s.r+1,""),B(P,"TUPLES",0,E.e.c-E.s.c+1,""),B(P,"DATA",0,0,"");for(var M=E.s.r;M<=E.e.r;++M){A(P,-1,0,"BOT");for(var N=E.s.c;N<=E.e.c;++N){var k=encode_cell({r:M,c:N});if(D=I?(R[M]||[])[N]:R[k],!D){A(P,1,0,"");continue}switch(D.t){case"n":var F=D.w;!F&&D.v!=null&&(F=D.v),F==null?D.f&&!D.F?A(P,1,0,"="+D.f):A(P,1,0,""):A(P,0,F,"V");break;case"b":A(P,0,D.v?1:0,D.v?"TRUE":"FALSE");break;case"s":A(P,1,0,isNaN(D.v)?D.v:'="'+D.v+'"');break;case"d":D.w||(D.w=SSF_format(D.z||table_fmt[14],datenum(parseDate(D.v)))),A(P,0,D.w,"V");break;default:A(P,1,0,"")}}}A(P,-1,0,"EOD");var G="\r\n",V=P.join(G);return V}}();return{to_workbook:_,to_sheet:T,from_sheet:w}}(),ETH=function(){function L(D){return D.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function S(D){return D.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function T(D,I){for(var M=D.split("\n"),N=-1,k=-1,F=0,G=[];F!==M.length;++F){var V=M[F].trim().split(":");if(V[0]==="cell"){var j=decode_cell(V[1]);if(G.length<=j.r)for(N=G.length;N<=j.r;++N)G[N]||(G[N]=[]);switch(N=j.r,k=j.c,V[2]){case"t":G[N][k]=L(V[3]);break;case"v":G[N][k]=+V[3];break;case"vtf":var H=V[V.length-1];case"vtc":switch(V[3]){case"nl":G[N][k]=!!+V[4];break;default:G[N][k]=+V[4];break}V[2]=="vtf"&&(G[N][k]=[G[N][k],H])}}}return I&&I.sheetRows&&(G=G.slice(0,I.sheetRows)),G}function _(D,I){return aoa_to_sheet(T(D,I),I)}function w(D,I){return sheet_to_workbook(_(D,I),I)}var B=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),A=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",O=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),R="--SocialCalcSpreadsheetControlSave--";function P(D){if(!D||!D["!ref"])return"";for(var I=[],M=[],N,k="",F=decode_range(D["!ref"]),G=Array.isArray(D),V=F.s.r;V<=F.e.r;++V)for(var j=F.s.c;j<=F.e.c;++j)if(k=encode_cell({r:V,c:j}),N=G?(D[V]||[])[j]:D[k],!(!N||N.v==null||N.t==="z")){switch(M=["cell",k,"t"],N.t){case"s":case"str":M.push(S(N.v));break;case"n":N.f?(M[2]="vtf",M[3]="n",M[4]=N.v,M[5]=S(N.f)):(M[2]="v",M[3]=N.v);break;case"b":M[2]="vt"+(N.f?"f":"c"),M[3]="nl",M[4]=N.v?"1":"0",M[5]=S(N.f||(N.v?"TRUE":"FALSE"));break;case"d":var H=datenum(parseDate(N.v));M[2]="vtc",M[3]="nd",M[4]=""+H,M[5]=N.w||SSF_format(N.z||table_fmt[14],H);break;case"e":continue}I.push(M.join(":"))}return I.push("sheet:c:"+(F.e.c-F.s.c+1)+":r:"+(F.e.r-F.s.r+1)+":tvf:1"),I.push("valueformat:1:text-wiki"),I.join("\n")}function E(D){return[B,A,O,A,P(D),R].join("\n")}return{to_workbook:w,to_sheet:_,from_sheet:E}}(),PRN=function(){function L(E,D,I,M,N){N.raw?D[I][M]=E:E===""||(E==="TRUE"?D[I][M]=!0:E==="FALSE"?D[I][M]=!1:isNaN(fuzzynum(E))?isNaN(fuzzydate(E).getDate())?D[I][M]=E:D[I][M]=parseDate(E):D[I][M]=fuzzynum(E))}function S(E,D){var I=D||{},M=[];if(!E||E.length===0)return M;for(var N=E.split(/[\r\n]/),k=N.length-1;k>=0&&N[k].length===0;)--k;for(var F=10,G=0,V=0;V<=k;++V)G=N[V].indexOf(" "),G==-1?G=N[V].length:G++,F=Math.max(F,G);for(V=0;V<=k;++V){M[V]=[];var j=0;for(L(N[V].slice(0,F).trim(),M,V,j,I),j=1;j<=(N[V].length-F)/10+1;++j)L(N[V].slice(F+(j-1)*10,F+j*10).trim(),M,V,j,I)}return I.sheetRows&&(M=M.slice(0,I.sheetRows)),M}var T={44:",",9:"	",59:";",124:"|"},_={44:3,9:2,59:1,124:0};function w(E){for(var D={},I=!1,M=0,N=0;M<E.length;++M)(N=E.charCodeAt(M))==34?I=!I:!I&&N in T&&(D[N]=(D[N]||0)+1);N=[];for(M in D)Object.prototype.hasOwnProperty.call(D,M)&&N.push([D[M],M]);if(!N.length){D=_;for(M in D)Object.prototype.hasOwnProperty.call(D,M)&&N.push([D[M],M])}return N.sort(function(k,F){return k[0]-F[0]||_[k[1]]-_[F[1]]}),T[N.pop()[1]]||44}function B(E,D){var I=D||{},M="",N=I.dense?[]:{},k={s:{c:0,r:0},e:{c:0,r:0}};E.slice(0,4)=="sep="?E.charCodeAt(5)==13&&E.charCodeAt(6)==10?(M=E.charAt(4),E=E.slice(7)):E.charCodeAt(5)==13||E.charCodeAt(5)==10?(M=E.charAt(4),E=E.slice(6)):M=w(E.slice(0,1024)):I&&I.FS?M=I.FS:M=w(E.slice(0,1024));var F=0,G=0,V=0,j=0,H=0,U=M.charCodeAt(0),X=!1,Y=0,z=E.charCodeAt(0);E=E.replace(/\r\n/mg,"\n");var W=I.dateNF!=null?dateNF_regex(I.dateNF):null;function Z(){var Q=E.slice(j,H),ee={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)ee.t="z";else if(I.raw)ee.t="s",ee.v=Q;else if(Q.trim().length===0)ee.t="s",ee.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(ee.t="s",ee.v=Q.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(Q)?(ee.t="n",ee.f=Q.slice(1)):(ee.t="s",ee.v=Q);else if(Q=="TRUE")ee.t="b",ee.v=!0;else if(Q=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(V=fuzzynum(Q)))ee.t="n",I.cellText!==!1&&(ee.w=Q),ee.v=V;else if(!isNaN(fuzzydate(Q).getDate())||W&&Q.match(W)){ee.z=I.dateNF||table_fmt[14];var te=0;W&&Q.match(W)&&(Q=dateNF_fix(Q,I.dateNF,Q.match(W)||[]),te=1),I.cellDates?(ee.t="d",ee.v=parseDate(Q,te)):(ee.t="n",ee.v=datenum(parseDate(Q,te))),I.cellText!==!1&&(ee.w=SSF_format(ee.z,ee.v instanceof Date?datenum(ee.v):ee.v)),I.cellNF||delete ee.z}else ee.t="s",ee.v=Q;if(ee.t=="z"||(I.dense?(N[F]||(N[F]=[]),N[F][G]=ee):N[encode_cell({c:G,r:F})]=ee),j=H+1,z=E.charCodeAt(j),k.e.c<G&&(k.e.c=G),k.e.r<F&&(k.e.r=F),Y==U)++G;else if(G=0,++F,I.sheetRows&&I.sheetRows<=F)return!0}e:for(;H<E.length;++H)switch(Y=E.charCodeAt(H)){case 34:z===34&&(X=!X);break;case U:case 10:case 13:if(!X&&Z())break e;break}return H-j>0&&Z(),N["!ref"]=encode_range(k),N}function A(E,D){return!(D&&D.PRN)||D.FS||E.slice(0,4)=="sep="||E.indexOf("	")>=0||E.indexOf(",")>=0||E.indexOf(";")>=0?B(E,D):aoa_to_sheet(S(E,D),D)}function O(E,D){var I="",M=D.type=="string"?[0,0,0,0]:firstbyte(E,D);switch(D.type){case"base64":I=Base64_decode(E);break;case"binary":I=E;break;case"buffer":D.codepage==65001?I=E.toString("utf8"):D.codepage&&typeof $cptable<"u"||(I=has_buf&&Buffer.isBuffer(E)?E.toString("binary"):a2s(E));break;case"array":I=cc2str(E);break;case"string":I=E;break;default:throw new Error("Unrecognized type "+D.type)}return M[0]==239&&M[1]==187&&M[2]==191?I=utf8read(I.slice(3)):D.type!="string"&&D.type!="buffer"&&D.codepage==65001?I=utf8read(I):D.type=="binary"&&typeof $cptable<"u",I.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(D.type=="string"?I:utf8read(I),D):A(I,D)}function R(E,D){return sheet_to_workbook(O(E,D),D)}function P(E){for(var D=[],I=safe_decode_range(E["!ref"]),M,N=Array.isArray(E),k=I.s.r;k<=I.e.r;++k){for(var F=[],G=I.s.c;G<=I.e.c;++G){var V=encode_cell({r:k,c:G});if(M=N?(E[k]||[])[G]:E[V],!M||M.v==null){F.push("          ");continue}for(var j=(M.w||(format_cell(M),M.w)||"").slice(0,10);j.length<10;)j+=" ";F.push(j+(G===0?" ":""))}D.push(F.join(""))}return D.join("\n")}return{to_workbook:R,to_sheet:O,from_sheet:P}}();function read_wb_ID(L,S){var T=S||{},_=!!T.WTF;T.WTF=!0;try{var w=SYLK.to_workbook(L,T);return T.WTF=_,w}catch(B){if(T.WTF=_,!B.message.match(/SYLK bad record ID/)&&_)throw B;return PRN.to_workbook(L,S)}}var WK_=function(){function L(ce,_e,oe){if(ce){prep_blob(ce,ce.l||0);for(var de=oe.Enum||ue;ce.l<ce.length;){var me=ce.read_shift(2),ye=de[me]||de[65535],ge=ce.read_shift(2),we=ce.l+ge,Te=ye.f&&ye.f(ce,ge,oe);if(ce.l=we,_e(Te,ye,me))return}}}function S(ce,_e){switch(_e.type){case"base64":return T(s2a(Base64_decode(ce)),_e);case"binary":return T(s2a(ce),_e);case"buffer":case"array":return T(ce,_e)}throw"Unsupported type "+_e.type}function T(ce,_e){if(!ce)return ce;var oe=_e||{},de=oe.dense?[]:{},me="Sheet1",ye="",ge=0,we={},Te=[],Ee=[],De={s:{r:0,c:0},e:{r:0,c:0}},fe=oe.sheetRows||0;if(ce[2]==0&&(ce[3]==8||ce[3]==9)&&ce.length>=16&&ce[14]==5&&ce[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(ce[2]==2)oe.Enum=ue,L(ce,function(Re,Ve,Pe){switch(Pe){case 0:oe.vers=Re,Re>=4096&&(oe.qpro=!0);break;case 6:De=Re;break;case 204:Re&&(ye=Re);break;case 222:ye=Re;break;case 15:case 51:oe.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Pe==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=oe.dateNF||table_fmt[14],oe.cellDates&&(Re[1].t="d",Re[1].v=numdate(Re[1].v))),oe.qpro&&Re[3]>ge&&(de["!ref"]=encode_range(De),we[me]=de,Te.push(me),de=oe.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},ge=Re[3],me=ye||"Sheet"+(ge+1),ye="");var ke=oe.dense?(de[Re[0].r]||[])[Re[0].c]:de[encode_cell(Re[0])];if(ke){ke.t=Re[1].t,ke.v=Re[1].v,Re[1].z!=null&&(ke.z=Re[1].z),Re[1].f!=null&&(ke.f=Re[1].f);break}oe.dense?(de[Re[0].r]||(de[Re[0].r]=[]),de[Re[0].r][Re[0].c]=Re[1]):de[encode_cell(Re[0])]=Re[1];break}},oe);else if(ce[2]==26||ce[2]==14)oe.Enum=le,ce[2]==14&&(oe.qpro=!0,ce.l=0),L(ce,function(Re,Ve,Pe){switch(Pe){case 204:me=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>ge&&(de["!ref"]=encode_range(De),we[me]=de,Te.push(me),de=oe.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},ge=Re[3],me="Sheet"+(ge+1)),fe>0&&Re[0].r>=fe)break;oe.dense?(de[Re[0].r]||(de[Re[0].r]=[]),de[Re[0].r][Re[0].c]=Re[1]):de[encode_cell(Re[0])]=Re[1],De.e.c<Re[0].c&&(De.e.c=Re[0].c),De.e.r<Re[0].r&&(De.e.r=Re[0].r);break;case 27:Re[14e3]&&(Ee[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Ee[Re[0]]=Re[1],Re[0]==ge&&(me=Re[1]);break}},oe);else throw new Error("Unrecognized LOTUS BOF "+ce[2]);if(de["!ref"]=encode_range(De),we[ye||me]=de,Te.push(ye||me),!Ee.length)return{SheetNames:Te,Sheets:we};for(var Ce={},Se=[],be=0;be<Ee.length;++be)we[Te[be]]?(Se.push(Ee[be]||Te[be]),Ce[Ee[be]]=we[Ee[be]]||we[Te[be]]):(Se.push(Ee[be]),Ce[Ee[be]]={"!ref":"A1"});return{SheetNames:Se,Sheets:Ce}}function _(ce,_e){var oe=_e||{};if(+oe.codepage>=0&&set_cp(+oe.codepage),oe.type=="string")throw new Error("Cannot write WK1 to JS string");var de=buf_array(),me=safe_decode_range(ce["!ref"]),ye=Array.isArray(ce),ge=[];write_biff_rec(de,0,B(1030)),write_biff_rec(de,6,R(me));for(var we=Math.min(me.e.r,8191),Te=me.s.r;Te<=we;++Te)for(var Ee=encode_row(Te),De=me.s.c;De<=me.e.c;++De){Te===me.s.r&&(ge[De]=encode_col(De));var fe=ge[De]+Ee,Ce=ye?(ce[Te]||[])[De]:ce[fe];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?write_biff_rec(de,13,M(Te,De,Ce.v)):write_biff_rec(de,14,k(Te,De,Ce.v));else{var Se=format_cell(Ce);write_biff_rec(de,15,D(Te,De,Se.slice(0,239)))}}return write_biff_rec(de,1),de.end()}function w(ce,_e){var oe=_e||{};if(+oe.codepage>=0&&set_cp(+oe.codepage),oe.type=="string")throw new Error("Cannot write WK3 to JS string");var de=buf_array();write_biff_rec(de,0,A(ce));for(var me=0,ye=0;me<ce.SheetNames.length;++me)(ce.Sheets[ce.SheetNames[me]]||{})["!ref"]&&write_biff_rec(de,27,K(ce.SheetNames[me],ye++));var ge=0;for(me=0;me<ce.SheetNames.length;++me){var we=ce.Sheets[ce.SheetNames[me]];if(!(!we||!we["!ref"])){for(var Te=safe_decode_range(we["!ref"]),Ee=Array.isArray(we),De=[],fe=Math.min(Te.e.r,8191),Ce=Te.s.r;Ce<=fe;++Ce)for(var Se=encode_row(Ce),be=Te.s.c;be<=Te.e.c;++be){Ce===Te.s.r&&(De[be]=encode_col(be));var Re=De[be]+Se,Ve=Ee?(we[Ce]||[])[be]:we[Re];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")write_biff_rec(de,23,Z(Ce,be,ge,Ve.v));else{var Pe=format_cell(Ve);write_biff_rec(de,22,Y(Ce,be,ge,Pe.slice(0,239)))}}++ge}}return write_biff_rec(de,1),de.end()}function B(ce){var _e=new_buf(2);return _e.write_shift(2,ce),_e}function A(ce){var _e=new_buf(26);_e.write_shift(2,4096),_e.write_shift(2,4),_e.write_shift(4,0);for(var oe=0,de=0,me=0,ye=0;ye<ce.SheetNames.length;++ye){var ge=ce.SheetNames[ye],we=ce.Sheets[ge];if(!(!we||!we["!ref"])){++me;var Te=decode_range(we["!ref"]);oe<Te.e.r&&(oe=Te.e.r),de<Te.e.c&&(de=Te.e.c)}}return oe>8191&&(oe=8191),_e.write_shift(2,oe),_e.write_shift(1,me),_e.write_shift(1,de),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(1,1),_e.write_shift(1,2),_e.write_shift(4,0),_e.write_shift(4,0),_e}function O(ce,_e,oe){var de={s:{c:0,r:0},e:{c:0,r:0}};return _e==8&&oe.qpro?(de.s.c=ce.read_shift(1),ce.l++,de.s.r=ce.read_shift(2),de.e.c=ce.read_shift(1),ce.l++,de.e.r=ce.read_shift(2),de):(de.s.c=ce.read_shift(2),de.s.r=ce.read_shift(2),_e==12&&oe.qpro&&(ce.l+=2),de.e.c=ce.read_shift(2),de.e.r=ce.read_shift(2),_e==12&&oe.qpro&&(ce.l+=2),de.s.c==65535&&(de.s.c=de.e.c=de.s.r=de.e.r=0),de)}function R(ce){var _e=new_buf(8);return _e.write_shift(2,ce.s.c),_e.write_shift(2,ce.s.r),_e.write_shift(2,ce.e.c),_e.write_shift(2,ce.e.r),_e}function P(ce,_e,oe){var de=[{c:0,r:0},{t:"n",v:0},0,0];return oe.qpro&&oe.vers!=20768?(de[0].c=ce.read_shift(1),de[3]=ce.read_shift(1),de[0].r=ce.read_shift(2),ce.l+=2):(de[2]=ce.read_shift(1),de[0].c=ce.read_shift(2),de[0].r=ce.read_shift(2)),de}function E(ce,_e,oe){var de=ce.l+_e,me=P(ce,_e,oe);if(me[1].t="s",oe.vers==20768){ce.l++;var ye=ce.read_shift(1);return me[1].v=ce.read_shift(ye,"utf8"),me}return oe.qpro&&ce.l++,me[1].v=ce.read_shift(de-ce.l,"cstr"),me}function D(ce,_e,oe){var de=new_buf(7+oe.length);de.write_shift(1,255),de.write_shift(2,_e),de.write_shift(2,ce),de.write_shift(1,39);for(var me=0;me<de.length;++me){var ye=oe.charCodeAt(me);de.write_shift(1,ye>=128?95:ye)}return de.write_shift(1,0),de}function I(ce,_e,oe){var de=P(ce,_e,oe);return de[1].v=ce.read_shift(2,"i"),de}function M(ce,_e,oe){var de=new_buf(7);return de.write_shift(1,255),de.write_shift(2,_e),de.write_shift(2,ce),de.write_shift(2,oe,"i"),de}function N(ce,_e,oe){var de=P(ce,_e,oe);return de[1].v=ce.read_shift(8,"f"),de}function k(ce,_e,oe){var de=new_buf(13);return de.write_shift(1,255),de.write_shift(2,_e),de.write_shift(2,ce),de.write_shift(8,oe,"f"),de}function F(ce,_e,oe){var de=ce.l+_e,me=P(ce,_e,oe);if(me[1].v=ce.read_shift(8,"f"),oe.qpro)ce.l=de;else{var ye=ce.read_shift(2);H(ce.slice(ce.l,ce.l+ye),me),ce.l+=ye}return me}function G(ce,_e,oe){var de=_e&32768;return _e&=-32769,_e=(de?ce:0)+(_e>=8192?_e-16384:_e),(de?"":"$")+(oe?encode_col(_e):encode_row(_e))}var V={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function H(ce,_e){prep_blob(ce,0);for(var oe=[],de=0,me="",ye="",ge="",we="";ce.l<ce.length;){var Te=ce[ce.l++];switch(Te){case 0:oe.push(ce.read_shift(8,"f"));break;case 1:ye=G(_e[0].c,ce.read_shift(2),!0),me=G(_e[0].r,ce.read_shift(2),!1),oe.push(ye+me);break;case 2:{var Ee=G(_e[0].c,ce.read_shift(2),!0),De=G(_e[0].r,ce.read_shift(2),!1);ye=G(_e[0].c,ce.read_shift(2),!0),me=G(_e[0].r,ce.read_shift(2),!1),oe.push(Ee+De+":"+ye+me)}break;case 3:if(ce.l<ce.length){console.error("WK1 premature formula end");return}break;case 4:oe.push("("+oe.pop()+")");break;case 5:oe.push(ce.read_shift(2));break;case 6:{for(var fe="";Te=ce[ce.l++];)fe+=String.fromCharCode(Te);oe.push('"'+fe.replace(/"/g,'""')+'"')}break;case 8:oe.push("-"+oe.pop());break;case 23:oe.push("+"+oe.pop());break;case 22:oe.push("NOT("+oe.pop()+")");break;case 20:case 21:we=oe.pop(),ge=oe.pop(),oe.push(["AND","OR"][Te-20]+"("+ge+","+we+")");break;default:if(Te<32&&j[Te])we=oe.pop(),ge=oe.pop(),oe.push(ge+j[Te]+we);else if(V[Te]){if(de=V[Te][1],de==69&&(de=ce[ce.l++]),de>oe.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+oe.join("|")+"|");return}var Ce=oe.slice(-de);oe.length-=de,oe.push(V[Te][0]+"("+Ce.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}oe.length==1?_e[1].f=""+oe[0]:console.error("WK1 bad formula parse |"+oe.join("|")+"|")}function U(ce){var _e=[{c:0,r:0},{t:"n",v:0},0];return _e[0].r=ce.read_shift(2),_e[3]=ce[ce.l++],_e[0].c=ce[ce.l++],_e}function X(ce,_e){var oe=U(ce);return oe[1].t="s",oe[1].v=ce.read_shift(_e-4,"cstr"),oe}function Y(ce,_e,oe,de){var me=new_buf(6+de.length);me.write_shift(2,ce),me.write_shift(1,oe),me.write_shift(1,_e),me.write_shift(1,39);for(var ye=0;ye<de.length;++ye){var ge=de.charCodeAt(ye);me.write_shift(1,ge>=128?95:ge)}return me.write_shift(1,0),me}function z(ce,_e){var oe=U(ce);oe[1].v=ce.read_shift(2);var de=oe[1].v>>1;if(oe[1].v&1)switch(de&7){case 0:de=(de>>3)*5e3;break;case 1:de=(de>>3)*500;break;case 2:de=(de>>3)/20;break;case 3:de=(de>>3)/200;break;case 4:de=(de>>3)/2e3;break;case 5:de=(de>>3)/2e4;break;case 6:de=(de>>3)/16;break;case 7:de=(de>>3)/64;break}return oe[1].v=de,oe}function W(ce,_e){var oe=U(ce),de=ce.read_shift(4),me=ce.read_shift(4),ye=ce.read_shift(2);if(ye==65535)return de===0&&me===3221225472?(oe[1].t="e",oe[1].v=15):de===0&&me===3489660928?(oe[1].t="e",oe[1].v=42):oe[1].v=0,oe;var ge=ye&32768;return ye=(ye&32767)-16446,oe[1].v=(1-ge*2)*(me*Math.pow(2,ye+32)+de*Math.pow(2,ye)),oe}function Z(ce,_e,oe,de){var me=new_buf(14);if(me.write_shift(2,ce),me.write_shift(1,oe),me.write_shift(1,_e),de==0)return me.write_shift(4,0),me.write_shift(4,0),me.write_shift(2,65535),me;var ye=0,ge=0,we=0,Te=0;return de<0&&(ye=1,de=-de),ge=Math.log2(de)|0,de/=Math.pow(2,ge-31),Te=de>>>0,(Te&2147483648)==0&&(de/=2,++ge,Te=de>>>0),de-=Te,Te|=2147483648,Te>>>=0,de*=Math.pow(2,32),we=de>>>0,me.write_shift(4,we),me.write_shift(4,Te),ge+=16383+(ye?32768:0),me.write_shift(2,ge),me}function Q(ce,_e){var oe=W(ce);return ce.l+=_e-14,oe}function ee(ce,_e){var oe=U(ce),de=ce.read_shift(4);return oe[1].v=de>>6,oe}function te(ce,_e){var oe=U(ce),de=ce.read_shift(8,"f");return oe[1].v=de,oe}function re(ce,_e){var oe=te(ce);return ce.l+=_e-10,oe}function ie(ce,_e){return ce[ce.l+_e-1]==0?ce.read_shift(_e,"cstr"):""}function ne(ce,_e){var oe=ce[ce.l++];oe>_e-1&&(oe=_e-1);for(var de="";de.length<oe;)de+=String.fromCharCode(ce[ce.l++]);return de}function he(ce,_e,oe){if(!(!oe.qpro||_e<21)){var de=ce.read_shift(1);ce.l+=17,ce.l+=1,ce.l+=2;var me=ce.read_shift(_e-21,"cstr");return[de,me]}}function pe(ce,_e){for(var oe={},de=ce.l+_e;ce.l<de;){var me=ce.read_shift(2);if(me==14e3){for(oe[me]=[0,""],oe[me][0]=ce.read_shift(2);ce[ce.l];)oe[me][1]+=String.fromCharCode(ce[ce.l]),ce.l++;ce.l++}}return oe}function K(ce,_e){var oe=new_buf(5+ce.length);oe.write_shift(2,14e3),oe.write_shift(2,_e);for(var de=0;de<ce.length;++de){var me=ce.charCodeAt(de);oe[oe.l++]=me>127?95:me}return oe[oe.l++]=0,oe}var ue={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:O},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:I},14:{n:"NUMBER",f:N},15:{n:"LABEL",f:E},16:{n:"FORMULA",f:F},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:E},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:_,book_to_wk3:w,to_workbook:S}}();function parse_rpr(L){var S={},T=L.match(tagregex),_=0,w=!1;if(T)for(;_!=T.length;++_){var B=parsexmltag(T[_]);switch(B[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!B.val)break;case"<shadow>":case"<shadow/>":S.shadow=1;break;case"</shadow>":break;case"<charset":if(B.val=="1")break;S.cp=CS2CP[parseInt(B.val,10)];break;case"<outline":if(!B.val)break;case"<outline>":case"<outline/>":S.outline=1;break;case"</outline>":break;case"<rFont":S.name=B.val;break;case"<sz":S.sz=B.val;break;case"<strike":if(!B.val)break;case"<strike>":case"<strike/>":S.strike=1;break;case"</strike>":break;case"<u":if(!B.val)break;switch(B.val){case"double":S.uval="double";break;case"singleAccounting":S.uval="single-accounting";break;case"doubleAccounting":S.uval="double-accounting";break}case"<u>":case"<u/>":S.u=1;break;case"</u>":break;case"<b":if(B.val=="0")break;case"<b>":case"<b/>":S.b=1;break;case"</b>":break;case"<i":if(B.val=="0")break;case"<i>":case"<i/>":S.i=1;break;case"</i>":break;case"<color":B.rgb&&(S.color=B.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":S.family=B.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":S.valign=B.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":w=!0;break;case"</ext>":w=!1;break;default:if(B[0].charCodeAt(1)!==47&&!w)throw new Error("Unrecognized rich format "+B[0])}}return S}var parse_rs=function(){var L=matchtag("t"),S=matchtag("rPr");function T(B){var A=B.match(L);if(!A)return{t:"s",v:""};var O={t:"s",v:unescapexml(A[1])},R=B.match(S);return R&&(O.s=parse_rpr(R[1])),O}var _=/<(?:\w+:)?r>/g,w=/<\/(?:\w+:)?r>/;return function(A){return A.replace(_,"").split(w).map(T).filter(function(O){return O.v})}}(),rs_to_html=function(){var S=/(\r\n|\n)/g;function T(w,B,A){var O=[];w.u&&O.push("text-decoration: underline;"),w.uval&&O.push("text-underline-style:"+w.uval+";"),w.sz&&O.push("font-size:"+w.sz+"pt;"),w.outline&&O.push("text-effect: outline;"),w.shadow&&O.push("text-shadow: auto;"),B.push('<span style="'+O.join("")+'">'),w.b&&(B.push("<b>"),A.push("</b>")),w.i&&(B.push("<i>"),A.push("</i>")),w.strike&&(B.push("<s>"),A.push("</s>"));var R=w.valign||"";return R=="superscript"||R=="super"?R="sup":R=="subscript"&&(R="sub"),R!=""&&(B.push("<"+R+">"),A.push("</"+R+">")),A.push("</span>"),w}function _(w){var B=[[],w.v,[]];return w.v?(w.s&&T(w.s,B[0],B[2]),B[0].join("")+B[1].replace(S,"<br/>")+B[2].join("")):""}return function(B){return B.map(_).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(L,S){var T=S?S.cellHTML:!0,_={};return L?(L.match(/^\s*<(?:\w+:)?t[^>]*>/)?(_.t=unescapexml(utf8read(L.slice(L.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),_.r=utf8read(L),T&&(_.h=escapehtml(_.t))):L.match(sirregex)&&(_.r=utf8read(L),_.t=unescapexml(utf8read((L.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),T&&(_.h=rs_to_html(parse_rs(_.r)))),_):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(L,S){var T=[],_="";if(!L)return T;var w=L.match(sstr0);if(w){_=w[2].replace(sstr1,"").split(sstr2);for(var B=0;B!=_.length;++B){var A=parse_si(_[B].trim(),S);A!=null&&(T[T.length]=A)}w=parsexmltag(w[1]),T.Count=w.count,T.Unique=w.uniqueCount}return T}function parse_BrtBeginSst(L){return[L.read_shift(4),L.read_shift(4)]}function parse_sst_bin(L,S){var T=[],_=!1;return recordhopper(L,function(B,A,O){switch(O){case 159:T.Count=B[0],T.Unique=B[1];break;case 19:T.push(B);break;case 160:return!0;case 35:_=!0;break;case 36:_=!1;break;default:if(A.T,!_||S.WTF)throw new Error("Unexpected record 0x"+O.toString(16))}}),T}function _JS2ANSI(L){for(var S=[],T=L.split(""),_=0;_<T.length;++_)S[_]=T[_].charCodeAt(0);return S}function parse_CRYPTOVersion(L,S){var T={};return T.Major=L.read_shift(2),T.Minor=L.read_shift(2),S>=4&&(L.l+=S-4),T}function parse_DataSpaceVersionInfo(L){var S={};return S.id=L.read_shift(0,"lpp4"),S.R=parse_CRYPTOVersion(L,4),S.U=parse_CRYPTOVersion(L,4),S.W=parse_CRYPTOVersion(L,4),S}function parse_DataSpaceMapEntry(L){for(var S=L.read_shift(4),T=L.l+S-4,_={},w=L.read_shift(4),B=[];w-- >0;)B.push({t:L.read_shift(4),v:L.read_shift(0,"lpp4")});if(_.name=L.read_shift(0,"lpp4"),_.comps=B,L.l!=T)throw new Error("Bad DataSpaceMapEntry: "+L.l+" != "+T);return _}function parse_DataSpaceMap(L){var S=[];L.l+=4;for(var T=L.read_shift(4);T-- >0;)S.push(parse_DataSpaceMapEntry(L));return S}function parse_DataSpaceDefinition(L){var S=[];L.l+=4;for(var T=L.read_shift(4);T-- >0;)S.push(L.read_shift(0,"lpp4"));return S}function parse_TransformInfoHeader(L){var S={};return L.read_shift(4),L.l+=4,S.id=L.read_shift(0,"lpp4"),S.name=L.read_shift(0,"lpp4"),S.R=parse_CRYPTOVersion(L,4),S.U=parse_CRYPTOVersion(L,4),S.W=parse_CRYPTOVersion(L,4),S}function parse_Primary(L){var S=parse_TransformInfoHeader(L);if(S.ename=L.read_shift(0,"8lpp4"),S.blksz=L.read_shift(4),S.cmode=L.read_shift(4),L.read_shift(4)!=4)throw new Error("Bad !Primary record");return S}function parse_EncryptionHeader(L,S){var T=L.l+S,_={};_.Flags=L.read_shift(4)&63,L.l+=4,_.AlgID=L.read_shift(4);var w=!1;switch(_.AlgID){case 26126:case 26127:case 26128:w=_.Flags==36;break;case 26625:w=_.Flags==4;break;case 0:w=_.Flags==16||_.Flags==4||_.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+_.AlgID}if(!w)throw new Error("Encryption Flags/AlgID mismatch");return _.AlgIDHash=L.read_shift(4),_.KeySize=L.read_shift(4),_.ProviderType=L.read_shift(4),L.l+=8,_.CSPName=L.read_shift(T-L.l>>1,"utf16le"),L.l=T,_}function parse_EncryptionVerifier(L,S){var T={},_=L.l+S;return L.l+=4,T.Salt=L.slice(L.l,L.l+16),L.l+=16,T.Verifier=L.slice(L.l,L.l+16),L.l+=16,L.read_shift(4),T.VerifierHash=L.slice(L.l,_),L.l=_,T}function parse_EncryptionInfo(L){var S=parse_CRYPTOVersion(L);switch(S.Minor){case 2:return[S.Minor,parse_EncInfoStd(L)];case 3:return[S.Minor,parse_EncInfoExt()];case 4:return[S.Minor,parse_EncInfoAgl(L)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+S.Minor)}function parse_EncInfoStd(L){var S=L.read_shift(4);if((S&63)!=36)throw new Error("EncryptionInfo mismatch");var T=L.read_shift(4),_=parse_EncryptionHeader(L,T),w=parse_EncryptionVerifier(L,L.length-L.l);return{t:"Std",h:_,v:w}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(L){var S=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];L.l+=4;var T=L.read_shift(L.length-L.l,"utf8"),_={};return T.replace(tagregex,function(B){var A=parsexmltag(B);switch(strip_ns(A[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":S.forEach(function(O){_[O]=A[O]});break;case"<dataIntegrity":_.encryptedHmacKey=A.encryptedHmacKey,_.encryptedHmacValue=A.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":_.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":_.uri=A.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":_.encs.push(A);break;default:throw A[0]}}),_}function parse_RC4CryptoHeader(L,S){var T={},_=T.EncryptionVersionInfo=parse_CRYPTOVersion(L,4);if(S-=4,_.Minor!=2)throw new Error("unrecognized minor version code: "+_.Minor);if(_.Major>4||_.Major<2)throw new Error("unrecognized major version code: "+_.Major);T.Flags=L.read_shift(4),S-=4;var w=L.read_shift(4);return S-=4,T.EncryptionHeader=parse_EncryptionHeader(L,w),S-=w,T.EncryptionVerifier=parse_EncryptionVerifier(L,S),T}function parse_RC4Header(L){var S={},T=S.EncryptionVersionInfo=parse_CRYPTOVersion(L,4);if(T.Major!=1||T.Minor!=1)throw"unrecognized version code "+T.Major+" : "+T.Minor;return S.Salt=L.read_shift(16),S.EncryptedVerifier=L.read_shift(16),S.EncryptedVerifierHash=L.read_shift(16),S}function crypto_CreatePasswordVerifier_Method1(L){var S=0,T,_=_JS2ANSI(L),w=_.length+1,B,A,O,R,P;for(T=new_raw_buf(w),T[0]=_.length,B=1;B!=w;++B)T[B]=_[B-1];for(B=w-1;B>=0;--B)A=T[B],O=(S&16384)===0?0:1,R=S<<1&32767,P=O|R,S=P^A;return S^52811}var crypto_CreateXorArray_Method1=function(){var L=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],S=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],T=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],_=function(A){return(A/2|A*128)&255},w=function(A,O){return _(A^O)},B=function(A){for(var O=S[A.length-1],R=104,P=A.length-1;P>=0;--P)for(var E=A[P],D=0;D!=7;++D)E&64&&(O^=T[R]),E*=2,--R;return O};return function(A){for(var O=_JS2ANSI(A),R=B(O),P=O.length,E=new_raw_buf(16),D=0;D!=16;++D)E[D]=0;var I,M,N;for((P&1)===1&&(I=R>>8,E[P]=w(L[0],I),--P,I=R&255,M=O[O.length-1],E[P]=w(M,I));P>0;)--P,I=R>>8,E[P]=w(O[P],I),--P,I=R&255,E[P]=w(O[P],I);for(P=15,N=15-O.length;N>0;)I=R>>8,E[P]=w(L[N],I),--P,--N,I=R&255,E[P]=w(O[P],I),--P,--N;return E}}(),crypto_DecryptData_Method1=function(L,S,T,_,w){w||(w=S),_||(_=crypto_CreateXorArray_Method1(L));var B,A;for(B=0;B!=S.length;++B)A=S[B],A^=_[T],A=(A>>5|A<<3)&255,w[B]=A,++T;return[w,T,_]},crypto_MakeXorDecryptor=function(L){var S=0,T=crypto_CreateXorArray_Method1(L);return function(_){var w=crypto_DecryptData_Method1("",_,S,T);return S=w[1],w[0]}};function parse_XORObfuscation(L,S,T,_){var w={key:parseuint16(L),verificationBytes:parseuint16(L)};return T.password&&(w.verifier=crypto_CreatePasswordVerifier_Method1(T.password)),_.valid=w.verificationBytes===w.verifier,_.valid&&(_.insitu=crypto_MakeXorDecryptor(T.password)),w}function parse_FilePassHeader(L,S,T){var _=T||{};return _.Info=L.read_shift(2),L.l-=2,_.Info===1?_.Data=parse_RC4Header(L):_.Data=parse_RC4CryptoHeader(L,S),_}function parse_FilePass(L,S,T){var _={Type:T.biff>=8?L.read_shift(2):0};return _.Type?parse_FilePassHeader(L,S-2,_):parse_XORObfuscation(L,T.biff>=8?S:S-2,T,_),_}var RTF=function(){function L(w,B){switch(B.type){case"base64":return S(Base64_decode(w),B);case"binary":return S(w,B);case"buffer":return S(has_buf&&Buffer.isBuffer(w)?w.toString("binary"):a2s(w),B);case"array":return S(cc2str(w),B)}throw new Error("Unrecognized type "+B.type)}function S(w,B){var A=B||{},O=A.dense?[]:{},R=w.match(/\\trowd.*?\\row\b/g);if(!R.length)throw new Error("RTF missing table");var P={s:{c:0,r:0},e:{c:0,r:R.length-1}};return R.forEach(function(E,D){Array.isArray(O)&&(O[D]=[]);for(var I=/\\\w+\b/g,M=0,N,k=-1;N=I.exec(E);){switch(N[0]){case"\\cell":var F=E.slice(M,I.lastIndex-N[0].length);if(F[0]==" "&&(F=F.slice(1)),++k,F.length){var G={v:F,t:"s"};Array.isArray(O)?O[D][k]=G:O[encode_cell({r:D,c:k})]=G}break}M=I.lastIndex}k>P.e.c&&(P.e.c=k)}),O["!ref"]=encode_range(P),O}function T(w,B){return sheet_to_workbook(L(w,B),B)}function _(w){for(var B=["{\\rtf1\\ansi"],A=safe_decode_range(w["!ref"]),O,R=Array.isArray(w),P=A.s.r;P<=A.e.r;++P){B.push("\\trowd\\trautofit1");for(var E=A.s.c;E<=A.e.c;++E)B.push("\\cellx"+(E+1));for(B.push("\\pard\\intbl"),E=A.s.c;E<=A.e.c;++E){var D=encode_cell({r:P,c:E});O=R?(w[P]||[])[E]:w[D],!(!O||O.v==null&&(!O.f||O.F))&&(B.push(" "+(O.w||(format_cell(O),O.w))),B.push("\\cell"))}B.push("\\pard\\intbl\\row")}return B.join("")+"}"}return{to_workbook:T,to_sheet:L,from_sheet:_}}();function hex2RGB(L){var S=L.slice(L[0]==="#"?1:0).slice(0,6);return[parseInt(S.slice(0,2),16),parseInt(S.slice(2,4),16),parseInt(S.slice(4,6),16)]}function rgb2Hex(L){for(var S=0,T=1;S!=3;++S)T=T*256+(L[S]>255?255:L[S]<0?0:L[S]);return T.toString(16).toUpperCase().slice(1)}function rgb2HSL(L){var S=L[0]/255,T=L[1]/255,_=L[2]/255,w=Math.max(S,T,_),B=Math.min(S,T,_),A=w-B;if(A===0)return[0,0,S];var O=0,R=0,P=w+B;switch(R=A/(P>1?2-P:P),w){case S:O=((T-_)/A+6)%6;break;case T:O=(_-S)/A+2;break;case _:O=(S-T)/A+4;break}return[O/6,R,P/2]}function hsl2RGB(L){var S=L[0],T=L[1],_=L[2],w=T*2*(_<.5?_:1-_),B=_-w/2,A=[B,B,B],O=6*S,R;if(T!==0)switch(O|0){case 0:case 6:R=w*O,A[0]+=w,A[1]+=R;break;case 1:R=w*(2-O),A[0]+=R,A[1]+=w;break;case 2:R=w*(O-2),A[1]+=w,A[2]+=R;break;case 3:R=w*(4-O),A[1]+=R,A[2]+=w;break;case 4:R=w*(O-4),A[2]+=w,A[0]+=R;break;case 5:R=w*(6-O),A[2]+=R,A[0]+=w;break}for(var P=0;P!=3;++P)A[P]=Math.round(A[P]*255);return A}function rgb_tint(L,S){if(S===0)return L;var T=rgb2HSL(hex2RGB(L));return S<0?T[2]=T[2]*(1+S):T[2]=1-(1-T[2])*(1-S),rgb2Hex(hsl2RGB(T))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(L){return Math.floor((L+Math.round(128/MDW)/256)*MDW)}function px2char(L){return Math.floor((L-5)/MDW*100+.5)/100}function char2width(L){return Math.round((L*MDW+5)/MDW*256)/256}function cycle_width(L){return char2width(px2char(width2px(L)))}function find_mdw_colw(L){var S=Math.abs(L-cycle_width(L)),T=MDW;if(S>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(L-cycle_width(L))<=S&&(S=Math.abs(L-cycle_width(L)),T=MDW);MDW=T}function process_col(L){L.width?(L.wpx=width2px(L.width),L.wch=px2char(L.wpx),L.MDW=MDW):L.wpx?(L.wch=px2char(L.wpx),L.width=char2width(L.wch),L.MDW=MDW):typeof L.wch=="number"&&(L.width=char2width(L.wch),L.wpx=width2px(L.width),L.MDW=MDW),L.customWidth&&delete L.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(L){return L*96/PPI}function pt2px(L){return L*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(L,S,T,_){S.Borders=[];var w={},B=!1;(L[0].match(tagregex)||[]).forEach(function(A){var O=parsexmltag(A);switch(strip_ns(O[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":w={},O.diagonalUp&&(w.diagonalUp=parsexmlbool(O.diagonalUp)),O.diagonalDown&&(w.diagonalDown=parsexmlbool(O.diagonalDown)),S.Borders.push(w);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;default:if(_&&_.WTF&&!B)throw new Error("unrecognized "+O[0]+" in borders")}})}function parse_fills(L,S,T,_){S.Fills=[];var w={},B=!1;(L[0].match(tagregex)||[]).forEach(function(A){var O=parsexmltag(A);switch(strip_ns(O[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":w={},S.Fills.push(w);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":S.Fills.push(w),w={};break;case"<patternFill":case"<patternFill>":O.patternType&&(w.patternType=O.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":w.bgColor||(w.bgColor={}),O.indexed&&(w.bgColor.indexed=parseInt(O.indexed,10)),O.theme&&(w.bgColor.theme=parseInt(O.theme,10)),O.tint&&(w.bgColor.tint=parseFloat(O.tint)),O.rgb&&(w.bgColor.rgb=O.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":w.fgColor||(w.fgColor={}),O.theme&&(w.fgColor.theme=parseInt(O.theme,10)),O.tint&&(w.fgColor.tint=parseFloat(O.tint)),O.rgb!=null&&(w.fgColor.rgb=O.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;default:if(_&&_.WTF&&!B)throw new Error("unrecognized "+O[0]+" in fills")}})}function parse_fonts(L,S,T,_){S.Fonts=[];var w={},B=!1;(L[0].match(tagregex)||[]).forEach(function(A){var O=parsexmltag(A);switch(strip_ns(O[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":S.Fonts.push(w),w={};break;case"<name":O.val&&(w.name=utf8read(O.val));break;case"<name/>":case"</name>":break;case"<b":w.bold=O.val?parsexmlbool(O.val):1;break;case"<b/>":w.bold=1;break;case"<i":w.italic=O.val?parsexmlbool(O.val):1;break;case"<i/>":w.italic=1;break;case"<u":switch(O.val){case"none":w.underline=0;break;case"single":w.underline=1;break;case"double":w.underline=2;break;case"singleAccounting":w.underline=33;break;case"doubleAccounting":w.underline=34;break}break;case"<u/>":w.underline=1;break;case"<strike":w.strike=O.val?parsexmlbool(O.val):1;break;case"<strike/>":w.strike=1;break;case"<outline":w.outline=O.val?parsexmlbool(O.val):1;break;case"<outline/>":w.outline=1;break;case"<shadow":w.shadow=O.val?parsexmlbool(O.val):1;break;case"<shadow/>":w.shadow=1;break;case"<condense":w.condense=O.val?parsexmlbool(O.val):1;break;case"<condense/>":w.condense=1;break;case"<extend":w.extend=O.val?parsexmlbool(O.val):1;break;case"<extend/>":w.extend=1;break;case"<sz":O.val&&(w.sz=+O.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":O.val&&(w.vertAlign=O.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":O.val&&(w.family=parseInt(O.val,10));break;case"<family/>":case"</family>":break;case"<scheme":O.val&&(w.scheme=O.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(O.val=="1")break;O.codepage=CS2CP[parseInt(O.val,10)];break;case"<color":if(w.color||(w.color={}),O.auto&&(w.color.auto=parsexmlbool(O.auto)),O.rgb)w.color.rgb=O.rgb.slice(-6);else if(O.indexed){w.color.index=parseInt(O.indexed,10);var R=XLSIcv[w.color.index];w.color.index==81&&(R=XLSIcv[1]),R||(R=XLSIcv[1]),w.color.rgb=R[0].toString(16)+R[1].toString(16)+R[2].toString(16)}else O.theme&&(w.color.theme=parseInt(O.theme,10),O.tint&&(w.color.tint=parseFloat(O.tint)),O.theme&&T.themeElements&&T.themeElements.clrScheme&&(w.color.rgb=rgb_tint(T.themeElements.clrScheme[w.color.theme].rgb,w.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":B=!0;break;case"</AlternateContent>":B=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;default:if(_&&_.WTF&&!B)throw new Error("unrecognized "+O[0]+" in fonts")}})}function parse_numFmts(L,S,T){S.NumberFmt=[];for(var _=keys(table_fmt),w=0;w<_.length;++w)S.NumberFmt[_[w]]=table_fmt[_[w]];var B=L[0].match(tagregex);if(B)for(w=0;w<B.length;++w){var A=parsexmltag(B[w]);switch(strip_ns(A[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var O=unescapexml(utf8read(A.formatCode)),R=parseInt(A.numFmtId,10);if(S.NumberFmt[R]=O,R>0){if(R>392){for(R=392;R>60&&S.NumberFmt[R]!=null;--R);S.NumberFmt[R]=O}SSF_load(O,R)}}break;case"</numFmt>":break;default:if(T.WTF)throw new Error("unrecognized "+A[0]+" in numFmts")}}}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(L,S,T){S.CellXf=[];var _,w=!1;(L[0].match(tagregex)||[]).forEach(function(B){var A=parsexmltag(B),O=0;switch(strip_ns(A[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(_=A,delete _[0],O=0;O<cellXF_uint.length;++O)_[cellXF_uint[O]]&&(_[cellXF_uint[O]]=parseInt(_[cellXF_uint[O]],10));for(O=0;O<cellXF_bool.length;++O)_[cellXF_bool[O]]&&(_[cellXF_bool[O]]=parsexmlbool(_[cellXF_bool[O]]));if(S.NumberFmt&&_.numFmtId>392){for(O=392;O>60;--O)if(S.NumberFmt[_.numFmtId]==S.NumberFmt[O]){_.numFmtId=O;break}}S.CellXf.push(_);break;case"</xf>":break;case"<alignment":case"<alignment/>":var R={};A.vertical&&(R.vertical=A.vertical),A.horizontal&&(R.horizontal=A.horizontal),A.textRotation!=null&&(R.textRotation=A.textRotation),A.indent&&(R.indent=A.indent),A.wrapText&&(R.wrapText=parsexmlbool(A.wrapText)),_.alignment=R;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":w=!0;break;case"</AlternateContent>":w=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":w=!0;break;case"</ext>":w=!1;break;default:if(T&&T.WTF&&!w)throw new Error("unrecognized "+A[0]+" in cellXfs")}})}var parse_sty_xml=function(){var S=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,T=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,_=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,w=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,B=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(O,R,P){var E={};if(!O)return E;O=O.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var D;return(D=O.match(S))&&parse_numFmts(D,E,P),(D=O.match(w))&&parse_fonts(D,E,R,P),(D=O.match(_))&&parse_fills(D,E,R,P),(D=O.match(B))&&parse_borders(D,E,R,P),(D=O.match(T))&&parse_cellXfs(D,E,P),E}}();function parse_BrtFmt(L,S){var T=L.read_shift(2),_=parse_XLWideString(L);return[T,_]}function parse_BrtFont(L,S,T){var _={};_.sz=L.read_shift(2)/20;var w=parse_FontFlags(L);w.fItalic&&(_.italic=1),w.fCondense&&(_.condense=1),w.fExtend&&(_.extend=1),w.fShadow&&(_.shadow=1),w.fOutline&&(_.outline=1),w.fStrikeout&&(_.strike=1);var B=L.read_shift(2);switch(B===700&&(_.bold=1),L.read_shift(2)){case 1:_.vertAlign="superscript";break;case 2:_.vertAlign="subscript";break}var A=L.read_shift(1);A!=0&&(_.underline=A);var O=L.read_shift(1);O>0&&(_.family=O);var R=L.read_shift(1);switch(R>0&&(_.charset=R),L.l++,_.color=parse_BrtColor(L),L.read_shift(1)){case 1:_.scheme="major";break;case 2:_.scheme="minor";break}return _.name=parse_XLWideString(L),_}var parse_BrtFill=parsenoop;function parse_BrtXF(L,S){var T=L.l+S,_=L.read_shift(2),w=L.read_shift(2);return L.l=T,{ixfe:_,numFmtId:w}}var parse_BrtBorder=parsenoop;function parse_sty_bin(L,S,T){var _={};_.NumberFmt=[];for(var w in table_fmt)_.NumberFmt[w]=table_fmt[w];_.CellXf=[],_.Fonts=[];var B=[],A=!1;return recordhopper(L,function(R,P,E){switch(E){case 44:_.NumberFmt[R[0]]=R[1],SSF_load(R[1],R[0]);break;case 43:_.Fonts.push(R),R.color.theme!=null&&S&&S.themeElements&&S.themeElements.clrScheme&&(R.color.rgb=rgb_tint(S.themeElements.clrScheme[R.color.theme].rgb,R.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:B[B.length-1]==617&&_.CellXf.push(R);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:A=!0;break;case 36:A=!1;break;case 37:B.push(E),A=!0;break;case 38:B.pop(),A=!1;break;default:if(P.T>0)B.push(E);else if(P.T<0)B.pop();else if(!A||T.WTF&&B[B.length-1]!=37)throw new Error("Unexpected record 0x"+E.toString(16))}}),_}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(L,S,T){S.themeElements.clrScheme=[];var _={};(L[0].match(tagregex)||[]).forEach(function(w){var B=parsexmltag(w);switch(B[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":_.rgb=B.val;break;case"<a:sysClr":_.rgb=B.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":B[0].charAt(1)==="/"?(S.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(B[0])]=_,_={}):_.name=B[0].slice(3,B[0].length-1);break;default:if(T&&T.WTF)throw new Error("Unrecognized "+B[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(L,S,T){S.themeElements={};var _;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(w){if(!(_=L.match(w[1])))throw new Error(w[0]+" not found in themeElements");w[2](_,S,T)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(L,S){(!L||L.length===0)&&(L=write_theme());var T,_={};if(!(T=L.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(T[0],_,S),_.raw=L,_}function write_theme(L,S){var T=[XML_HEADER];return T[T.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',T[T.length]="<a:themeElements>",T[T.length]='<a:clrScheme name="Office">',T[T.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',T[T.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',T[T.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',T[T.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',T[T.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',T[T.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',T[T.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',T[T.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',T[T.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',T[T.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',T[T.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',T[T.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',T[T.length]="</a:clrScheme>",T[T.length]='<a:fontScheme name="Office">',T[T.length]="<a:majorFont>",T[T.length]='<a:latin typeface="Cambria"/>',T[T.length]='<a:ea typeface=""/>',T[T.length]='<a:cs typeface=""/>',T[T.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',T[T.length]='<a:font script="Hang" typeface="맑은 고딕"/>',T[T.length]='<a:font script="Hans" typeface="宋体"/>',T[T.length]='<a:font script="Hant" typeface="新細明體"/>',T[T.length]='<a:font script="Arab" typeface="Times New Roman"/>',T[T.length]='<a:font script="Hebr" typeface="Times New Roman"/>',T[T.length]='<a:font script="Thai" typeface="Tahoma"/>',T[T.length]='<a:font script="Ethi" typeface="Nyala"/>',T[T.length]='<a:font script="Beng" typeface="Vrinda"/>',T[T.length]='<a:font script="Gujr" typeface="Shruti"/>',T[T.length]='<a:font script="Khmr" typeface="MoolBoran"/>',T[T.length]='<a:font script="Knda" typeface="Tunga"/>',T[T.length]='<a:font script="Guru" typeface="Raavi"/>',T[T.length]='<a:font script="Cans" typeface="Euphemia"/>',T[T.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',T[T.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',T[T.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',T[T.length]='<a:font script="Thaa" typeface="MV Boli"/>',T[T.length]='<a:font script="Deva" typeface="Mangal"/>',T[T.length]='<a:font script="Telu" typeface="Gautami"/>',T[T.length]='<a:font script="Taml" typeface="Latha"/>',T[T.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',T[T.length]='<a:font script="Orya" typeface="Kalinga"/>',T[T.length]='<a:font script="Mlym" typeface="Kartika"/>',T[T.length]='<a:font script="Laoo" typeface="DokChampa"/>',T[T.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',T[T.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',T[T.length]='<a:font script="Viet" typeface="Times New Roman"/>',T[T.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',T[T.length]='<a:font script="Geor" typeface="Sylfaen"/>',T[T.length]="</a:majorFont>",T[T.length]="<a:minorFont>",T[T.length]='<a:latin typeface="Calibri"/>',T[T.length]='<a:ea typeface=""/>',T[T.length]='<a:cs typeface=""/>',T[T.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',T[T.length]='<a:font script="Hang" typeface="맑은 고딕"/>',T[T.length]='<a:font script="Hans" typeface="宋体"/>',T[T.length]='<a:font script="Hant" typeface="新細明體"/>',T[T.length]='<a:font script="Arab" typeface="Arial"/>',T[T.length]='<a:font script="Hebr" typeface="Arial"/>',T[T.length]='<a:font script="Thai" typeface="Tahoma"/>',T[T.length]='<a:font script="Ethi" typeface="Nyala"/>',T[T.length]='<a:font script="Beng" typeface="Vrinda"/>',T[T.length]='<a:font script="Gujr" typeface="Shruti"/>',T[T.length]='<a:font script="Khmr" typeface="DaunPenh"/>',T[T.length]='<a:font script="Knda" typeface="Tunga"/>',T[T.length]='<a:font script="Guru" typeface="Raavi"/>',T[T.length]='<a:font script="Cans" typeface="Euphemia"/>',T[T.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',T[T.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',T[T.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',T[T.length]='<a:font script="Thaa" typeface="MV Boli"/>',T[T.length]='<a:font script="Deva" typeface="Mangal"/>',T[T.length]='<a:font script="Telu" typeface="Gautami"/>',T[T.length]='<a:font script="Taml" typeface="Latha"/>',T[T.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',T[T.length]='<a:font script="Orya" typeface="Kalinga"/>',T[T.length]='<a:font script="Mlym" typeface="Kartika"/>',T[T.length]='<a:font script="Laoo" typeface="DokChampa"/>',T[T.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',T[T.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',T[T.length]='<a:font script="Viet" typeface="Arial"/>',T[T.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',T[T.length]='<a:font script="Geor" typeface="Sylfaen"/>',T[T.length]="</a:minorFont>",T[T.length]="</a:fontScheme>",T[T.length]='<a:fmtScheme name="Office">',T[T.length]="<a:fillStyleLst>",T[T.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',T[T.length]='<a:gradFill rotWithShape="1">',T[T.length]="<a:gsLst>",T[T.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',T[T.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',T[T.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',T[T.length]="</a:gsLst>",T[T.length]='<a:lin ang="16200000" scaled="1"/>',T[T.length]="</a:gradFill>",T[T.length]='<a:gradFill rotWithShape="1">',T[T.length]="<a:gsLst>",T[T.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',T[T.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',T[T.length]="</a:gsLst>",T[T.length]='<a:lin ang="16200000" scaled="0"/>',T[T.length]="</a:gradFill>",T[T.length]="</a:fillStyleLst>",T[T.length]="<a:lnStyleLst>",T[T.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',T[T.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',T[T.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',T[T.length]="</a:lnStyleLst>",T[T.length]="<a:effectStyleLst>",T[T.length]="<a:effectStyle>",T[T.length]="<a:effectLst>",T[T.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',T[T.length]="</a:effectLst>",T[T.length]="</a:effectStyle>",T[T.length]="<a:effectStyle>",T[T.length]="<a:effectLst>",T[T.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',T[T.length]="</a:effectLst>",T[T.length]="</a:effectStyle>",T[T.length]="<a:effectStyle>",T[T.length]="<a:effectLst>",T[T.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',T[T.length]="</a:effectLst>",T[T.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',T[T.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',T[T.length]="</a:effectStyle>",T[T.length]="</a:effectStyleLst>",T[T.length]="<a:bgFillStyleLst>",T[T.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',T[T.length]='<a:gradFill rotWithShape="1">',T[T.length]="<a:gsLst>",T[T.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',T[T.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',T[T.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',T[T.length]="</a:gsLst>",T[T.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',T[T.length]="</a:gradFill>",T[T.length]='<a:gradFill rotWithShape="1">',T[T.length]="<a:gsLst>",T[T.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',T[T.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',T[T.length]="</a:gsLst>",T[T.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',T[T.length]="</a:gradFill>",T[T.length]="</a:bgFillStyleLst>",T[T.length]="</a:fmtScheme>",T[T.length]="</a:themeElements>",T[T.length]="<a:objectDefaults>",T[T.length]="<a:spDef>",T[T.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',T[T.length]="</a:spDef>",T[T.length]="<a:lnDef>",T[T.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',T[T.length]="</a:lnDef>",T[T.length]="</a:objectDefaults>",T[T.length]="<a:extraClrSchemeLst/>",T[T.length]="</a:theme>",T.join("")}function parse_Theme(L,S,T){var _=L.l+S,w=L.read_shift(4);if(w!==124226){if(!T.cellStyles){L.l=_;return}var B=L.slice(L.l);L.l=_;var A;try{A=zip_read(B,{type:"array"})}catch(R){return}var O=getzipstr(A,"theme/theme/theme1.xml",!0);if(O)return parse_theme_xml(O,T)}}function parse_ColorTheme(L){return L.read_shift(4)}function parse_FullColorExt(L){var S={};switch(S.xclrType=L.read_shift(2),S.nTintShade=L.read_shift(2),S.xclrType){case 0:L.l+=4;break;case 1:S.xclrValue=parse_IcvXF(L,4);break;case 2:S.xclrValue=parse_LongRGBA(L);break;case 3:S.xclrValue=parse_ColorTheme(L);break;case 4:L.l+=4;break}return L.l+=8,S}function parse_IcvXF(L,S){return parsenoop(L,S)}function parse_XFExtGradient(L,S){return parsenoop(L,S)}function parse_ExtProp(L){var S=L.read_shift(2),T=L.read_shift(2)-4,_=[S];switch(S){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:_[1]=parse_FullColorExt(L);break;case 6:_[1]=parse_XFExtGradient(L,T);break;case 14:case 15:_[1]=L.read_shift(T===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+S+" "+T)}return _}function parse_XFExt(L,S){var T=L.l+S;L.l+=2;var _=L.read_shift(2);L.l+=2;for(var w=L.read_shift(2),B=[];w-- >0;)B.push(parse_ExtProp(L,T-L.l));return{ixfe:_,ext:B}}function update_xfext(L,S){S.forEach(function(T){T[0]})}function parse_BrtMdtinfo(L,S){return{flags:L.read_shift(4),version:L.read_shift(4),name:parse_XLWideString(L)}}function parse_BrtMdb(L){for(var S=[],T=L.read_shift(4);T-- >0;)S.push([L.read_shift(4),L.read_shift(4)]);return S}function parse_BrtBeginEsmdb(L){return L.l+=4,L.read_shift(4)!=0}function parse_xlmeta_bin(L,S,T){var _={Types:[],Cell:[],Value:[]},w=T||{},B=[],A=!1,O=2;return recordhopper(L,function(R,P,E){switch(E){case 335:_.Types.push({name:R.name});break;case 51:R.forEach(function(D){O==1?_.Cell.push({type:_.Types[D[0]-1].name,index:D[1]}):O==0&&_.Value.push({type:_.Types[D[0]-1].name,index:D[1]})});break;case 337:O=R?1:0;break;case 338:O=2;break;case 35:B.push(E),A=!0;break;case 36:B.pop(),A=!1;break;default:if(!P.T){if(!A||w.WTF&&B[B.length-1]!=35)throw new Error("Unexpected record 0x"+E.toString(16))}}}),_}function parse_xlmeta_xml(L,S,T){var _={Types:[],Cell:[],Value:[]};if(!L)return _;var w=!1,B=2,A;return L.replace(tagregex,function(O){var R=parsexmltag(O);switch(strip_ns(R[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":_.Types.push({name:R.name});break;case"</metadataType>":break;case"<futureMetadata":for(var P=0;P<_.Types.length;++P)_.Types[P].name==R.name&&(A=_.Types[P]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":B==1?_.Cell.push({type:_.Types[R.t-1].name,index:+R.v}):B==0&&_.Value.push({type:_.Types[R.t-1].name,index:+R.v});break;case"</rc>":break;case"<cellMetadata":B=1;break;case"</cellMetadata>":B=2;break;case"<valueMetadata":B=0;break;case"</valueMetadata>":B=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":w=!0;break;case"</ext>":w=!1;break;case"<rvb":if(!A)break;A.offsets||(A.offsets=[]),A.offsets.push(+R.i);break;default:if(!w&&T.WTF)throw new Error("unrecognized "+R[0]+" in metadata")}return O}),_}function parse_cc_xml(L){var S=[];if(!L)return S;var T=1;return(L.match(tagregex)||[]).forEach(function(_){var w=parsexmltag(_);switch(w[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete w[0],w.i?T=w.i:w.i=T,S.push(w);break}}),S}function parse_BrtCalcChainItem$(L){var S={};S.i=L.read_shift(4);var T={};T.r=L.read_shift(4),T.c=L.read_shift(4),S.r=encode_cell(T);var _=L.read_shift(1);return _&2&&(S.l="1"),_&8&&(S.a="1"),S}function parse_cc_bin(L,S,T){var _=[];return recordhopper(L,function(B,A,O){switch(O){case 63:_.push(B);break;default:if(!A.T)throw new Error("Unexpected record 0x"+O.toString(16))}}),_}function parse_xlink_xml(){}function parse_xlink_bin(L,S,T,_){if(!L)return L;var w=_||{},B=!1;recordhopper(L,function(O,R,P){switch(P){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:B=!0;break;case 36:B=!1;break;default:if(!R.T){if(!B||w.WTF)throw new Error("Unexpected record 0x"+P.toString(16))}}},w)}function parse_drawing(L,S){if(!L)return"??";var T=(L.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return S["!id"][T].Target}function sheet_insert_comments(L,S,T,_){var w=Array.isArray(L),B;S.forEach(function(A){var O=decode_cell(A.ref);if(w?(L[O.r]||(L[O.r]=[]),B=L[O.r][O.c]):B=L[A.ref],!B){B={t:"z"},w?L[O.r][O.c]=B:L[A.ref]=B;var R=safe_decode_range(L["!ref"]||"BDWGO1000001:A1");R.s.r>O.r&&(R.s.r=O.r),R.e.r<O.r&&(R.e.r=O.r),R.s.c>O.c&&(R.s.c=O.c),R.e.c<O.c&&(R.e.c=O.c);var P=encode_range(R);P!==L["!ref"]&&(L["!ref"]=P)}B.c||(B.c=[]);var E={a:A.author,t:A.t,r:A.r,T};A.h&&(E.h=A.h);for(var D=B.c.length-1;D>=0;--D){if(!T&&B.c[D].T)return;T&&!B.c[D].T&&B.c.splice(D,1)}if(T&&_){for(D=0;D<_.length;++D)if(E.a==_[D].id){E.a=_[D].name||E.a;break}}B.c.push(E)})}function parse_comments_xml(L,S){if(L.match(/<(?:\w+:)?comments *\/>/))return[];var T=[],_=[],w=L.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);w&&w[1]&&w[1].split(/<\/\w*:?author>/).forEach(function(A){if(!(A===""||A.trim()==="")){var O=A.match(/<(?:\w+:)?author[^>]*>(.*)/);O&&T.push(O[1])}});var B=L.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return B&&B[1]&&B[1].split(/<\/\w*:?comment>/).forEach(function(A){if(!(A===""||A.trim()==="")){var O=A.match(/<(?:\w+:)?comment[^>]*>/);if(O){var R=parsexmltag(O[0]),P={author:R.authorId&&T[R.authorId]||"sheetjsghost",ref:R.ref,guid:R.guid},E=decode_cell(R.ref);if(!(S.sheetRows&&S.sheetRows<=E.r)){var D=A.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),I=!!D&&!!D[1]&&parse_si(D[1])||{r:"",t:"",h:""};P.r=I.r,I.r=="<t></t>"&&(I.t=I.h=""),P.t=(I.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),S.cellHTML&&(P.h=I.h),_.push(P)}}}}),_}function parse_tcmnt_xml(L,S){var T=[],_=!1,w={},B=0;return L.replace(tagregex,function(O,R){var P=parsexmltag(O);switch(strip_ns(P[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":w={author:P.personId,guid:P.id,ref:P.ref,T:1};break;case"</threadedComment>":w.t!=null&&T.push(w);break;case"<text>":case"<text":B=R+O.length;break;case"</text>":w.t=L.slice(B,R).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":_=!0;break;case"</mentions>":_=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_=!0;break;case"</ext>":_=!1;break;default:if(!_&&S.WTF)throw new Error("unrecognized "+P[0]+" in threaded comments")}return O}),T}function parse_people_xml(L,S){var T=[],_=!1;return L.replace(tagregex,function(B){var A=parsexmltag(B);switch(strip_ns(A[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":T.push({name:A.displayname,id:A.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_=!0;break;case"</ext>":_=!1;break;default:if(!_&&S.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return B}),T}function parse_BrtBeginComment(L){var S={};S.iauthor=L.read_shift(4);var T=parse_UncheckedRfX(L);return S.rfx=T.s,S.ref=encode_cell(T.s),L.l+=16,S}var parse_BrtCommentAuthor=parse_XLWideString;function parse_comments_bin(L,S){var T=[],_=[],w={},B=!1;return recordhopper(L,function(O,R,P){switch(P){case 632:_.push(O);break;case 635:w=O;break;case 637:w.t=O.t,w.h=O.h,w.r=O.r;break;case 636:if(w.author=_[w.iauthor],delete w.iauthor,S.sheetRows&&w.rfx&&S.sheetRows<=w.rfx.r)break;w.t||(w.t=""),delete w.rfx,T.push(w);break;case 3072:break;case 35:B=!0;break;case 36:B=!1;break;case 37:break;case 38:break;default:if(!R.T){if(!B||S.WTF)throw new Error("Unexpected record 0x"+P.toString(16))}}}),T}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(L){var S=CFB.utils.cfb_new({root:"R"});return L.FullPaths.forEach(function(T,_){if(!(T.slice(-1)==="/"||!T.match(/_VBA_PROJECT_CUR/))){var w=T.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(S,w,L.FileIndex[_].content)}}),CFB.write(S)}function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var L=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,S={r:0,c:0};function T(_,w,B,A){var O=!1,R=!1;B.length==0?R=!0:B.charAt(0)=="["&&(R=!0,B=B.slice(1,-1)),A.length==0?O=!0:A.charAt(0)=="["&&(O=!0,A=A.slice(1,-1));var P=B.length>0?parseInt(B,10)|0:0,E=A.length>0?parseInt(A,10)|0:0;return O?E+=S.c:--E,R?P+=S.r:--P,w+(O?"":"$")+encode_col(E)+(R?"":"$")+encode_row(P)}return function(w,B){return S=B,w.replace(L,T)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(S,T){return S.replace(crefregex,function(_,w,B,A,O,R){var P=decode_col(A)-(B?0:T.c),E=decode_row(R)-(O?0:T.r),D=E==0?"":O?E+1:"["+E+"]",I=P==0?"":B?P+1:"["+P+"]";return w+"R"+D+"C"+I})}}();function shift_formula_str(L,S){return L.replace(crefregex,function(T,_,w,B,A,O){return _+(w=="$"?w+B:encode_col(decode_col(B)+S.c))+(A=="$"?A+O:encode_row(decode_row(O)+S.r))})}function shift_formula_xlsx(L,S,T){var _=decode_range(S),w=_.s,B=decode_cell(T),A={r:B.r-w.r,c:B.c-w.c};return shift_formula_str(L,A)}function fuzzyfmla(L){return L.length!=1}function _xlfn(L){return L.replace(/_xlfn\./g,"")}function parseread1(L){L.l+=1}function parse_ColRelU(L,S){var T=L.read_shift(2);return[T&16383,T>>14&1,T>>15&1]}function parse_RgceArea(L,S,T){var _=2;if(T){if(T.biff>=2&&T.biff<=5)return parse_RgceArea_BIFF2(L);T.biff==12&&(_=4)}var w=L.read_shift(_),B=L.read_shift(_),A=parse_ColRelU(L),O=parse_ColRelU(L);return{s:{r:w,c:A[0],cRel:A[1],rRel:A[2]},e:{r:B,c:O[0],cRel:O[1],rRel:O[2]}}}function parse_RgceArea_BIFF2(L){var S=parse_ColRelU(L),T=parse_ColRelU(L),_=L.read_shift(1),w=L.read_shift(1);return{s:{r:S[0],c:_,cRel:S[1],rRel:S[2]},e:{r:T[0],c:w,cRel:T[1],rRel:T[2]}}}function parse_RgceAreaRel(L,S,T){if(T.biff<8)return parse_RgceArea_BIFF2(L);var _=L.read_shift(T.biff==12?4:2),w=L.read_shift(T.biff==12?4:2),B=parse_ColRelU(L),A=parse_ColRelU(L);return{s:{r:_,c:B[0],cRel:B[1],rRel:B[2]},e:{r:w,c:A[0],cRel:A[1],rRel:A[2]}}}function parse_RgceLoc(L,S,T){if(T&&T.biff>=2&&T.biff<=5)return parse_RgceLoc_BIFF2(L);var _=L.read_shift(T&&T.biff==12?4:2),w=parse_ColRelU(L);return{r:_,c:w[0],cRel:w[1],rRel:w[2]}}function parse_RgceLoc_BIFF2(L){var S=parse_ColRelU(L),T=L.read_shift(1);return{r:S[0],c:T,cRel:S[1],rRel:S[2]}}function parse_RgceElfLoc(L){var S=L.read_shift(2),T=L.read_shift(2);return{r:S,c:T&255,fQuoted:!!(T&16384),cRel:T>>15,rRel:T>>15}}function parse_RgceLocRel(L,S,T){var _=T&&T.biff?T.biff:8;if(_>=2&&_<=5)return parse_RgceLocRel_BIFF2(L);var w=L.read_shift(_>=12?4:2),B=L.read_shift(2),A=(B&16384)>>14,O=(B&32768)>>15;if(B&=16383,O==1)for(;w>524287;)w-=1048576;if(A==1)for(;B>8191;)B=B-16384;return{r:w,c:B,cRel:A,rRel:O}}function parse_RgceLocRel_BIFF2(L){var S=L.read_shift(2),T=L.read_shift(1),_=(S&32768)>>15,w=(S&16384)>>14;return S&=16383,_==1&&S>=8192&&(S=S-16384),w==1&&T>=128&&(T=T-256),{r:S,c:T,cRel:w,rRel:_}}function parse_PtgArea(L,S,T){var _=(L[L.l++]&96)>>5,w=parse_RgceArea(L,T.biff>=2&&T.biff<=5?6:8,T);return[_,w]}function parse_PtgArea3d(L,S,T){var _=(L[L.l++]&96)>>5,w=L.read_shift(2,"i"),B=8;if(T)switch(T.biff){case 5:L.l+=12,B=6;break;case 12:B=12;break}var A=parse_RgceArea(L,B,T);return[_,w,A]}function parse_PtgAreaErr(L,S,T){var _=(L[L.l++]&96)>>5;return L.l+=T&&T.biff>8?12:T.biff<8?6:8,[_]}function parse_PtgAreaErr3d(L,S,T){var _=(L[L.l++]&96)>>5,w=L.read_shift(2),B=8;if(T)switch(T.biff){case 5:L.l+=12,B=6;break;case 12:B=12;break}return L.l+=B,[_,w]}function parse_PtgAreaN(L,S,T){var _=(L[L.l++]&96)>>5,w=parse_RgceAreaRel(L,S-1,T);return[_,w]}function parse_PtgArray(L,S,T){var _=(L[L.l++]&96)>>5;return L.l+=T.biff==2?6:T.biff==12?14:7,[_]}function parse_PtgAttrBaxcel(L){var S=L[L.l+1]&1,T=1;return L.l+=4,[S,T]}function parse_PtgAttrChoose(L,S,T){L.l+=2;for(var _=L.read_shift(T&&T.biff==2?1:2),w=[],B=0;B<=_;++B)w.push(L.read_shift(T&&T.biff==2?1:2));return w}function parse_PtgAttrGoto(L,S,T){var _=L[L.l+1]&255?1:0;return L.l+=2,[_,L.read_shift(T&&T.biff==2?1:2)]}function parse_PtgAttrIf(L,S,T){var _=L[L.l+1]&255?1:0;return L.l+=2,[_,L.read_shift(T&&T.biff==2?1:2)]}function parse_PtgAttrIfError(L){var S=L[L.l+1]&255?1:0;return L.l+=2,[S,L.read_shift(2)]}function parse_PtgAttrSemi(L,S,T){var _=L[L.l+1]&255?1:0;return L.l+=T&&T.biff==2?3:4,[_]}function parse_PtgAttrSpaceType(L){var S=L.read_shift(1),T=L.read_shift(1);return[S,T]}function parse_PtgAttrSpace(L){return L.read_shift(2),parse_PtgAttrSpaceType(L)}function parse_PtgAttrSpaceSemi(L){return L.read_shift(2),parse_PtgAttrSpaceType(L)}function parse_PtgRef(L,S,T){var _=(L[L.l]&96)>>5;L.l+=1;var w=parse_RgceLoc(L,0,T);return[_,w]}function parse_PtgRefN(L,S,T){var _=(L[L.l]&96)>>5;L.l+=1;var w=parse_RgceLocRel(L,0,T);return[_,w]}function parse_PtgRef3d(L,S,T){var _=(L[L.l]&96)>>5;L.l+=1;var w=L.read_shift(2);T&&T.biff==5&&(L.l+=12);var B=parse_RgceLoc(L,0,T);return[_,w,B]}function parse_PtgFunc(L,S,T){var _=(L[L.l]&96)>>5;L.l+=1;var w=L.read_shift(T&&T.biff<=3?1:2);return[FtabArgc[w],Ftab[w],_]}function parse_PtgFuncVar(L,S,T){var _=L[L.l++],w=L.read_shift(1),B=T&&T.biff<=3?[_==88?-1:0,L.read_shift(1)]:parsetab(L);return[w,(B[0]===0?Ftab:Cetab)[B[1]]]}function parsetab(L){return[L[L.l+1]>>7,L.read_shift(2)&32767]}function parse_PtgAttrSum(L,S,T){L.l+=T&&T.biff==2?3:4}function parse_PtgExp(L,S,T){if(L.l++,T&&T.biff==12)return[L.read_shift(4,"i"),0];var _=L.read_shift(2),w=L.read_shift(T&&T.biff==2?1:2);return[_,w]}function parse_PtgErr(L){return L.l++,BErr[L.read_shift(1)]}function parse_PtgInt(L){return L.l++,L.read_shift(2)}function parse_PtgBool(L){return L.l++,L.read_shift(1)!==0}function parse_PtgNum(L){return L.l++,parse_Xnum(L)}function parse_PtgStr(L,S,T){return L.l++,parse_ShortXLUnicodeString(L,S-1,T)}function parse_SerAr(L,S){var T=[L.read_shift(1)];if(S==12)switch(T[0]){case 2:T[0]=4;break;case 4:T[0]=16;break;case 0:T[0]=1;break;case 1:T[0]=2;break}switch(T[0]){case 4:T[1]=parsebool(L,1)?"TRUE":"FALSE",S!=12&&(L.l+=7);break;case 37:case 16:T[1]=BErr[L[L.l]],L.l+=S==12?4:8;break;case 0:L.l+=8;break;case 1:T[1]=parse_Xnum(L);break;case 2:T[1]=parse_XLUnicodeString2(L,0,{biff:S>0&&S<8?2:S});break;default:throw new Error("Bad SerAr: "+T[0])}return T}function parse_PtgExtraMem(L,S,T){for(var _=L.read_shift(T.biff==12?4:2),w=[],B=0;B!=_;++B)w.push((T.biff==12?parse_UncheckedRfX:parse_Ref8U)(L));return w}function parse_PtgExtraArray(L,S,T){var _=0,w=0;T.biff==12?(_=L.read_shift(4),w=L.read_shift(4)):(w=1+L.read_shift(1),_=1+L.read_shift(2)),T.biff>=2&&T.biff<8&&(--_,--w==0&&(w=256));for(var B=0,A=[];B!=_&&(A[B]=[]);++B)for(var O=0;O!=w;++O)A[B][O]=parse_SerAr(L,T.biff);return A}function parse_PtgName(L,S,T){var _=L.read_shift(1)>>>5&3,w=!T||T.biff>=8?4:2,B=L.read_shift(w);switch(T.biff){case 2:L.l+=5;break;case 3:case 4:L.l+=8;break;case 5:L.l+=12;break}return[_,0,B]}function parse_PtgNameX(L,S,T){if(T.biff==5)return parse_PtgNameX_BIFF5(L);var _=L.read_shift(1)>>>5&3,w=L.read_shift(2),B=L.read_shift(4);return[_,w,B]}function parse_PtgNameX_BIFF5(L){var S=L.read_shift(1)>>>5&3,T=L.read_shift(2,"i");L.l+=8;var _=L.read_shift(2);return L.l+=12,[S,T,_]}function parse_PtgMemArea(L,S,T){var _=L.read_shift(1)>>>5&3;L.l+=T&&T.biff==2?3:4;var w=L.read_shift(T&&T.biff==2?1:2);return[_,w]}function parse_PtgMemFunc(L,S,T){var _=L.read_shift(1)>>>5&3,w=L.read_shift(T&&T.biff==2?1:2);return[_,w]}function parse_PtgRefErr(L,S,T){var _=L.read_shift(1)>>>5&3;return L.l+=4,T.biff<8&&L.l--,T.biff==12&&(L.l+=2),[_]}function parse_PtgRefErr3d(L,S,T){var _=(L[L.l++]&96)>>5,w=L.read_shift(2),B=4;if(T)switch(T.biff){case 5:B=15;break;case 12:B=6;break}return L.l+=B,[_,w]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(L,S,T){return L.l+=2,[parse_RgceElfLoc(L)]}function parse_PtgElfNoop(L){return L.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(L){return L.l+=2,[parseuint16(L),L.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(L){L.l+=2;var S=L.read_shift(2),T=L.read_shift(2),_=L.read_shift(4),w=L.read_shift(2),B=L.read_shift(2),A=PtgListRT[T>>2&31];return{ixti:S,coltype:T&3,rt:A,idx:_,c:w,C:B}}function parse_PtgSxName(L){return L.l+=2,[L.read_shift(4)]}function parse_PtgSheet(L,S,T){return L.l+=5,L.l+=2,L.l+=T.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(L,S,T){return L.l+=T.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(L){var S=L.read_shift(1)>>>5&3,T=L.read_shift(2);return[S,T]}function parse_PtgMemNoMemN(L){var S=L.read_shift(1)>>>5&3,T=L.read_shift(2);return[S,T]}function parse_PtgAttrNoop(L){return L.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(L,S,T,_){if(_.biff<8)return parsenoop(L,S);for(var w=L.l+S,B=[],A=0;A!==T.length;++A)switch(T[A][0]){case"PtgArray":T[A][1]=parse_PtgExtraArray(L,0,_),B.push(T[A][1]);break;case"PtgMemArea":T[A][2]=parse_PtgExtraMem(L,T[A][1],_),B.push(T[A][2]);break;case"PtgExp":_&&_.biff==12&&(T[A][1][1]=L.read_shift(4),B.push(T[A][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+T[A][0]}return S=w-L.l,S!==0&&B.push(parsenoop(L,S)),B}function parse_Rgce(L,S,T){for(var _=L.l+S,w,B,A=[];_!=L.l;)S=_-L.l,B=L[L.l],w=PtgTypes[B]||PtgTypes[PtgDupes[B]],(B===24||B===25)&&(w=(B===24?Ptg18:Ptg19)[L[L.l+1]]),!w||!w.f?parsenoop(L,S):A.push([w.n,w.f(L,S,T)]);return A}function stringify_array(L){for(var S=[],T=0;T<L.length;++T){for(var _=L[T],w=[],B=0;B<_.length;++B){var A=_[B];if(A)switch(A[0]){case 2:w.push('"'+A[1].replace(/"/g,'""')+'"');break;default:w.push(A[1])}else w.push("")}S.push(w.join(","))}return S.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(L,S){if(!L&&!(S&&S.biff<=5&&S.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(L)?"'"+L+"'":L}function get_ixti_raw(L,S,T){if(!L)return"SH33TJSERR0";if(T.biff>8&&(!L.XTI||!L.XTI[S]))return L.SheetNames[S];if(!L.XTI)return"SH33TJSERR6";var _=L.XTI[S];if(T.biff<8)return S>1e4&&(S-=65536),S<0&&(S=-S),S==0?"":L.XTI[S-1];if(!_)return"SH33TJSERR1";var w="";if(T.biff>8)switch(L[_[0]][0]){case 357:return w=_[1]==-1?"#REF":L.SheetNames[_[1]],_[1]==_[2]?w:w+":"+L.SheetNames[_[2]];case 358:return T.SID!=null?L.SheetNames[T.SID]:"SH33TJSSAME"+L[_[0]][0];case 355:default:return"SH33TJSSRC"+L[_[0]][0]}switch(L[_[0]][0][0]){case 1025:return w=_[1]==-1?"#REF":L.SheetNames[_[1]]||"SH33TJSERR3",_[1]==_[2]?w:w+":"+L.SheetNames[_[2]];case 14849:return L[_[0]].slice(1).map(function(B){return B.Name}).join(";;");default:return L[_[0]][0][3]?(w=_[1]==-1?"#REF":L[_[0]][0][3][_[1]]||"SH33TJSERR4",_[1]==_[2]?w:w+":"+L[_[0]][0][3][_[2]]):"SH33TJSERR2"}}function get_ixti(L,S,T){var _=get_ixti_raw(L,S,T);return _=="#REF"?_:formula_quote_sheet_name(_,T)}function stringify_formula(L,S,T,_,w){var B=w&&w.biff||8,A={s:{c:0,r:0}},O=[],R,P,E,D=0,I=0,M,N="";if(!L[0]||!L[0][0])return"";for(var k=-1,F="",G=0,V=L[0].length;G<V;++G){var j=L[0][G];switch(j[0]){case"PtgUminus":O.push("-"+O.pop());break;case"PtgUplus":O.push("+"+O.pop());break;case"PtgPercent":O.push(O.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(R=O.pop(),P=O.pop(),k>=0){switch(L[0][k][1][0]){case 0:F=fill(" ",L[0][k][1][1]);break;case 1:F=fill("\r",L[0][k][1][1]);break;default:if(F="",w.WTF)throw new Error("Unexpected PtgAttrSpaceType "+L[0][k][1][0])}P=P+F,k=-1}O.push(P+PtgBinOp[j[0]]+R);break;case"PtgIsect":R=O.pop(),P=O.pop(),O.push(P+" "+R);break;case"PtgUnion":R=O.pop(),P=O.pop(),O.push(P+","+R);break;case"PtgRange":R=O.pop(),P=O.pop(),O.push(P+":"+R);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":E=shift_cell_xls(j[1][1],A,w),O.push(encode_cell_xls(E,B));break;case"PtgRefN":E=T?shift_cell_xls(j[1][1],T,w):j[1][1],O.push(encode_cell_xls(E,B));break;case"PtgRef3d":D=j[1][1],E=shift_cell_xls(j[1][2],A,w),N=get_ixti(_,D,w),O.push(N+"!"+encode_cell_xls(E,B));break;case"PtgFunc":case"PtgFuncVar":var H=j[1][0],U=j[1][1];H||(H=0),H&=127;var X=H==0?[]:O.slice(-H);O.length-=H,U==="User"&&(U=X.shift()),O.push(U+"("+X.join(",")+")");break;case"PtgBool":O.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":O.push(j[1]);break;case"PtgNum":O.push(String(j[1]));break;case"PtgStr":O.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":O.push(j[1]);break;case"PtgAreaN":M=shift_range_xls(j[1][1],T?{s:T}:A,w),O.push(encode_range_xls(M,w));break;case"PtgArea":M=shift_range_xls(j[1][1],A,w),O.push(encode_range_xls(M,w));break;case"PtgArea3d":D=j[1][1],M=j[1][2],N=get_ixti(_,D,w),O.push(N+"!"+encode_range_xls(M,w));break;case"PtgAttrSum":O.push("SUM("+O.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":I=j[1][2];var Y=(_.names||[])[I-1]||(_[0]||[])[I],z=Y?Y.Name:"SH33TJSNAME"+String(I);z&&z.slice(0,6)=="_xlfn."&&!w.xlfn&&(z=z.slice(6)),O.push(z);break;case"PtgNameX":var W=j[1][1];I=j[1][2];var Z;if(w.biff<=5)W<0&&(W=-W),_[W]&&(Z=_[W][I]);else{var Q="";if(((_[W]||[])[0]||[])[0]==14849||(((_[W]||[])[0]||[])[0]==1025?_[W][I]&&_[W][I].itab>0&&(Q=_.SheetNames[_[W][I].itab-1]+"!"):Q=_.SheetNames[I-1]+"!"),_[W]&&_[W][I])Q+=_[W][I].Name;else if(_[0]&&_[0][I])Q+=_[0][I].Name;else{var ee=(get_ixti_raw(_,W,w)||"").split(";;");ee[I-1]?Q=ee[I-1]:Q+="SH33TJSERRX"}O.push(Q);break}Z||(Z={Name:"SH33TJSERRY"}),O.push(Z.Name);break;case"PtgParen":var te="(",re=")";if(k>=0){switch(F="",L[0][k][1][0]){case 2:te=fill(" ",L[0][k][1][1])+te;break;case 3:te=fill("\r",L[0][k][1][1])+te;break;case 4:re=fill(" ",L[0][k][1][1])+re;break;case 5:re=fill("\r",L[0][k][1][1])+re;break;default:if(w.WTF)throw new Error("Unexpected PtgAttrSpaceType "+L[0][k][1][0])}k=-1}O.push(te+O.pop()+re);break;case"PtgRefErr":O.push("#REF!");break;case"PtgRefErr3d":O.push("#REF!");break;case"PtgExp":E={c:j[1][1],r:j[1][0]};var ie={c:T.c,r:T.r};if(_.sharedf[encode_cell(E)]){var ne=_.sharedf[encode_cell(E)];O.push(stringify_formula(ne,A,ie,_,w))}else{var he=!1;for(R=0;R!=_.arrayf.length;++R)if(P=_.arrayf[R],!(E.c<P[0].s.c||E.c>P[0].e.c)&&!(E.r<P[0].s.r||E.r>P[0].e.r)){O.push(stringify_formula(P[1],A,ie,_,w)),he=!0;break}he||O.push(j[1])}break;case"PtgArray":O.push("{"+stringify_array(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":k=G;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":O.push("");break;case"PtgAreaErr":O.push("#REF!");break;case"PtgAreaErr3d":O.push("#REF!");break;case"PtgList":O.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(w.biff!=3&&k>=0&&pe.indexOf(L[0][G][0])==-1){j=L[0][k];var K=!0;switch(j[1][0]){case 4:K=!1;case 0:F=fill(" ",j[1][1]);break;case 5:K=!1;case 1:F=fill("\r",j[1][1]);break;default:if(F="",w.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}O.push((K?F:"")+O.pop()+(K?"":F)),k=-1}}if(O.length>1&&w.WTF)throw new Error("bad formula stack");return O[0]}function parse_ArrayParsedFormula(L,S,T){var _=L.l+S,w=T.biff==2?1:2,B,A=L.read_shift(w);if(A==65535)return[[],parsenoop(L,S-2)];var O=parse_Rgce(L,A,T);return S!==A+w&&(B=parse_RgbExtra(L,S-A-w,O,T)),L.l=_,[O,B]}function parse_XLSCellParsedFormula(L,S,T){var _=L.l+S,w=T.biff==2?1:2,B,A=L.read_shift(w);if(A==65535)return[[],parsenoop(L,S-2)];var O=parse_Rgce(L,A,T);return S!==A+w&&(B=parse_RgbExtra(L,S-A-w,O,T)),L.l=_,[O,B]}function parse_NameParsedFormula(L,S,T,_){var w=L.l+S,B=parse_Rgce(L,_,T),A;return w!==L.l&&(A=parse_RgbExtra(L,w-L.l,B,T)),[B,A]}function parse_SharedParsedFormula(L,S,T){var _=L.l+S,w,B=L.read_shift(2),A=parse_Rgce(L,B,T);return B==65535?[[],parsenoop(L,S-2)]:(S!==B+2&&(w=parse_RgbExtra(L,_-B-2,A,T)),[A,w])}function parse_FormulaValue(L){var S;if(__readUInt16LE(L,L.l+6)!==65535)return[parse_Xnum(L),"n"];switch(L[L.l]){case 0:return L.l+=8,["String","s"];case 1:return S=L[L.l+2]===1,L.l+=8,[S,"b"];case 2:return S=L[L.l+2],L.l+=8,[S,"e"];case 3:return L.l+=8,["","s"]}return[]}function parse_Formula(L,S,T){var _=L.l+S,w=parse_XLSCell(L);T.biff==2&&++L.l;var B=parse_FormulaValue(L),A=L.read_shift(1);T.biff!=2&&(L.read_shift(1),T.biff>=5&&L.read_shift(4));var O=parse_XLSCellParsedFormula(L,_-L.l,T);return{cell:w,val:B[0],formula:O,shared:A>>3&1,tt:B[1]}}function parse_XLSBParsedFormula(L,S,T){var _=L.read_shift(4),w=parse_Rgce(L,_,T),B=L.read_shift(4),A=B>0?parse_RgbExtra(L,B,w,T):null;return[w,A]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(L){return L.slice(0,3)=="of:"&&(L=L.slice(3)),L.charCodeAt(0)==61&&(L=L.slice(1),L.charCodeAt(0)==61&&(L=L.slice(1))),L=L.replace(/COM\.MICROSOFT\./g,""),L=L.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(S,T){return T.replace(/\./g,"")}),L=L.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),L.replace(/[;~]/g,",").replace(/\|/g,";")}function ods_to_csf_3D(L){var S=L.split(":"),T=S[0].split(".")[0];return[T,S[0].split(".")[1]+(S.length>1?":"+(S[1].split(".")[1]||S[1].split(".")[0]):"")]}var strs={},_ssfopts={};function default_margins(L,S){if(L){var T=[.7,.7,.75,.75,.3,.3];S=="xlml"&&(T=[1,1,1,1,.5,.5]),L.left==null&&(L.left=T[0]),L.right==null&&(L.right=T[1]),L.top==null&&(L.top=T[2]),L.bottom==null&&(L.bottom=T[3]),L.header==null&&(L.header=T[4]),L.footer==null&&(L.footer=T[5])}}function safe_format(L,S,T,_,w,B){try{_.cellNF&&(L.z=table_fmt[S])}catch(O){if(_.WTF)throw O}if(!(L.t==="z"&&!_.cellStyles)){if(L.t==="d"&&typeof L.v=="string"&&(L.v=parseDate(L.v)),(!_||_.cellText!==!1)&&L.t!=="z")try{if(table_fmt[S]==null&&SSF_load(SSFImplicit[S]||"General",S),L.t==="e")L.w=L.w||BErr[L.v];else if(S===0)if(L.t==="n")(L.v|0)===L.v?L.w=L.v.toString(10):L.w=SSF_general_num(L.v);else if(L.t==="d"){var A=datenum(L.v);(A|0)===A?L.w=A.toString(10):L.w=SSF_general_num(A)}else{if(L.v===void 0)return"";L.w=SSF_general(L.v,_ssfopts)}else L.t==="d"?L.w=SSF_format(S,datenum(L.v),_ssfopts):L.w=SSF_format(S,L.v,_ssfopts)}catch(O){if(_.WTF)throw O}if(_.cellStyles&&T!=null)try{L.s=B.Fills[T],L.s.fgColor&&L.s.fgColor.theme&&!L.s.fgColor.rgb&&(L.s.fgColor.rgb=rgb_tint(w.themeElements.clrScheme[L.s.fgColor.theme].rgb,L.s.fgColor.tint||0),_.WTF&&(L.s.fgColor.raw_rgb=w.themeElements.clrScheme[L.s.fgColor.theme].rgb)),L.s.bgColor&&L.s.bgColor.theme&&(L.s.bgColor.rgb=rgb_tint(w.themeElements.clrScheme[L.s.bgColor.theme].rgb,L.s.bgColor.tint||0),_.WTF&&(L.s.bgColor.raw_rgb=w.themeElements.clrScheme[L.s.bgColor.theme].rgb))}catch(O){if(_.WTF&&B.Fills)throw O}}}function parse_ws_xml_dim(L,S){var T=safe_decode_range(S);T.s.r<=T.e.r&&T.s.c<=T.e.c&&T.s.r>=0&&T.s.c>=0&&(L["!ref"]=encode_range(T))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(L,S,T,_,w,B,A){if(!L)return L;_||(_={"!id":{}});var O=S.dense?[]:{},R={s:{r:2e6,c:2e6},e:{r:0,c:0}},P="",E="",D=L.match(sheetdataregex);D?(P=L.slice(0,D.index),E=L.slice(D.index+D[0].length)):P=E=L;var I=P.match(sheetprregex);I?parse_ws_xml_sheetpr(I[0],O,w,T):(I=P.match(sheetprregex2))&&parse_ws_xml_sheetpr2(I[0],I[1]||"",O,w,T);var M=(P.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(M>0){var N=P.slice(M,M+50).match(dimregex);N&&parse_ws_xml_dim(O,N[1])}var k=P.match(svsregex);k&&k[1]&&parse_ws_xml_sheetviews(k[1],w);var F=[];if(S.cellStyles){var G=P.match(colregex);G&&parse_ws_xml_cols(F,G)}D&&parse_ws_xml_data(D[1],O,S,R,B,A);var V=E.match(afregex);V&&(O["!autofilter"]=parse_ws_xml_autofilter(V[0]));var j=[],H=E.match(mergecregex);if(H)for(M=0;M!=H.length;++M)j[M]=safe_decode_range(H[M].slice(H[M].indexOf('"')+1));var U=E.match(hlinkregex);U&&parse_ws_xml_hlinks(O,U,_);var X=E.match(marginregex);if(X&&(O["!margins"]=parse_ws_xml_margins(parsexmltag(X[0]))),!O["!ref"]&&R.e.c>=R.s.c&&R.e.r>=R.s.r&&(O["!ref"]=encode_range(R)),S.sheetRows>0&&O["!ref"]){var Y=safe_decode_range(O["!ref"]);S.sheetRows<=+Y.e.r&&(Y.e.r=S.sheetRows-1,Y.e.r>R.e.r&&(Y.e.r=R.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>R.e.c&&(Y.e.c=R.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),O["!fullref"]=O["!ref"],O["!ref"]=encode_range(Y))}return F.length>0&&(O["!cols"]=F),j.length>0&&(O["!merges"]=j),O}function parse_ws_xml_sheetpr(L,S,T,_){var w=parsexmltag(L);T.Sheets[_]||(T.Sheets[_]={}),w.codeName&&(T.Sheets[_].CodeName=unescapexml(utf8read(w.codeName)))}function parse_ws_xml_sheetpr2(L,S,T,_,w){parse_ws_xml_sheetpr(L.slice(0,L.indexOf(">")),T,_,w)}function parse_ws_xml_hlinks(L,S,T){for(var _=Array.isArray(L),w=0;w!=S.length;++w){var B=parsexmltag(utf8read(S[w]),!0);if(!B.ref)return;var A=((T||{})["!id"]||[])[B.id];A?(B.Target=A.Target,B.location&&(B.Target+="#"+unescapexml(B.location))):(B.Target="#"+unescapexml(B.location),A={Target:B.Target,TargetMode:"Internal"}),B.Rel=A,B.tooltip&&(B.Tooltip=B.tooltip,delete B.tooltip);for(var O=safe_decode_range(B.ref),R=O.s.r;R<=O.e.r;++R)for(var P=O.s.c;P<=O.e.c;++P){var E=encode_cell({c:P,r:R});_?(L[R]||(L[R]=[]),L[R][P]||(L[R][P]={t:"z",v:void 0}),L[R][P].l=B):(L[E]||(L[E]={t:"z",v:void 0}),L[E].l=B)}}}function parse_ws_xml_margins(L){var S={};return["left","right","top","bottom","header","footer"].forEach(function(T){L[T]&&(S[T]=parseFloat(L[T]))}),S}function parse_ws_xml_cols(L,S){for(var T=!1,_=0;_!=S.length;++_){var w=parsexmltag(S[_],!0);w.hidden&&(w.hidden=parsexmlbool(w.hidden));var B=parseInt(w.min,10)-1,A=parseInt(w.max,10)-1;for(w.outlineLevel&&(w.level=+w.outlineLevel||0),delete w.min,delete w.max,w.width=+w.width,!T&&w.width&&(T=!0,find_mdw_colw(w.width)),process_col(w);B<=A;)L[B++]=dup(w)}}function parse_ws_xml_autofilter(L){var S={ref:(L.match(/ref="([^"]*)"/)||[])[1]};return S}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(L,S){S.Views||(S.Views=[{}]),(L.match(sviewregex)||[]).forEach(function(T,_){var w=parsexmltag(T);S.Views[_]||(S.Views[_]={}),+w.zoomScale&&(S.Views[_].zoom=+w.zoomScale),parsexmlbool(w.rightToLeft)&&(S.Views[_].RTL=!0)})}var parse_ws_xml_data=function(){var L=/<(?:\w+:)?c[ \/>]/,S=/<\/(?:\w+:)?row>/,T=/r=["']([^"']*)["']/,_=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,w=/ref=["']([^"']*)["']/,B=matchtag("v"),A=matchtag("f");return function(R,P,E,D,I,M){for(var N=0,k="",F=[],G=[],V=0,j=0,H=0,U="",X,Y,z=0,W=0,Z,Q,ee=0,te=0,re=Array.isArray(M.CellXf),ie,ne=[],he=[],pe=Array.isArray(P),K=[],ue={},le=!1,ce=!!E.sheetStubs,_e=R.split(S),oe=0,de=_e.length;oe!=de;++oe){k=_e[oe].trim();var me=k.length;if(me!==0){var ye=0;e:for(N=0;N<me;++N)switch(k[N]){case">":if(k[N-1]!="/"){++N;break e}if(E&&E.cellStyles){if(Y=parsexmltag(k.slice(ye,N),!0),z=Y.r!=null?parseInt(Y.r,10):z+1,W=-1,E.sheetRows&&E.sheetRows<z)continue;ue={},le=!1,Y.ht&&(le=!0,ue.hpt=parseFloat(Y.ht),ue.hpx=pt2px(ue.hpt)),Y.hidden=="1"&&(le=!0,ue.hidden=!0),Y.outlineLevel!=null&&(le=!0,ue.level=+Y.outlineLevel),le&&(K[z-1]=ue)}break;case"<":ye=N;break}if(ye>=N)break;if(Y=parsexmltag(k.slice(ye,N),!0),z=Y.r!=null?parseInt(Y.r,10):z+1,W=-1,!(E.sheetRows&&E.sheetRows<z)){D.s.r>z-1&&(D.s.r=z-1),D.e.r<z-1&&(D.e.r=z-1),E&&E.cellStyles&&(ue={},le=!1,Y.ht&&(le=!0,ue.hpt=parseFloat(Y.ht),ue.hpx=pt2px(ue.hpt)),Y.hidden=="1"&&(le=!0,ue.hidden=!0),Y.outlineLevel!=null&&(le=!0,ue.level=+Y.outlineLevel),le&&(K[z-1]=ue)),F=k.slice(N).split(L);for(var ge=0;ge!=F.length&&F[ge].trim().charAt(0)=="<";++ge);for(F=F.slice(ge),N=0;N!=F.length;++N)if(k=F[N].trim(),k.length!==0){if(G=k.match(T),V=N,j=0,H=0,k="<c "+(k.slice(0,1)=="<"?">":"")+k,G!=null&&G.length===2){for(V=0,U=G[1],j=0;j!=U.length&&!((H=U.charCodeAt(j)-64)<1||H>26);++j)V=26*V+H;--V,W=V}else++W;for(j=0;j!=k.length&&k.charCodeAt(j)!==62;++j);if(++j,Y=parsexmltag(k.slice(0,j),!0),Y.r||(Y.r=encode_cell({r:z-1,c:W})),U=k.slice(j),X={t:""},(G=U.match(B))!=null&&G[1]!==""&&(X.v=unescapexml(G[1])),E.cellFormula){if((G=U.match(A))!=null&&G[1]!==""){if(X.f=unescapexml(utf8read(G[1])).replace(/\r\n/g,"\n"),E.xlfn||(X.f=_xlfn(X.f)),G[0].indexOf('t="array"')>-1)X.F=(U.match(w)||[])[1],X.F.indexOf(":")>-1&&ne.push([safe_decode_range(X.F),X.F]);else if(G[0].indexOf('t="shared"')>-1){Q=parsexmltag(G[0]);var we=unescapexml(utf8read(G[1]));E.xlfn||(we=_xlfn(we)),he[parseInt(Q.si,10)]=[Q,we,Y.r]}}else(G=U.match(/<f[^>]*\/>/))&&(Q=parsexmltag(G[0]),he[Q.si]&&(X.f=shift_formula_xlsx(he[Q.si][1],he[Q.si][2],Y.r)));var Te=decode_cell(Y.r);for(j=0;j<ne.length;++j)Te.r>=ne[j][0].s.r&&Te.r<=ne[j][0].e.r&&Te.c>=ne[j][0].s.c&&Te.c<=ne[j][0].e.c&&(X.F=ne[j][1])}if(Y.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(ce)X.t="z";else continue;else X.t=Y.t||"n";switch(D.s.c>W&&(D.s.c=W),D.e.c<W&&(D.e.c=W),X.t){case"n":if(X.v==""||X.v==null){if(!ce)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!ce)continue;X.t="z"}else Z=strs[parseInt(X.v,10)],X.v=Z.t,X.r=Z.r,E.cellHTML&&(X.h=Z.h);break;case"str":X.t="s",X.v=X.v!=null?utf8read(X.v):"",E.cellHTML&&(X.h=escapehtml(X.v));break;case"inlineStr":G=U.match(_),X.t="s",G!=null&&(Z=parse_si(G[1]))?(X.v=Z.t,E.cellHTML&&(X.h=Z.h)):X.v="";break;case"b":X.v=parsexmlbool(X.v);break;case"d":E.cellDates?X.v=parseDate(X.v,1):(X.v=datenum(parseDate(X.v,1)),X.t="n");break;case"e":(!E||E.cellText!==!1)&&(X.w=X.v),X.v=RBErr[X.v];break}if(ee=te=0,ie=null,re&&Y.s!==void 0&&(ie=M.CellXf[Y.s],ie!=null&&(ie.numFmtId!=null&&(ee=ie.numFmtId),E.cellStyles&&ie.fillId!=null&&(te=ie.fillId))),safe_format(X,ee,te,E,I,M),E.cellDates&&re&&X.t=="n"&&fmt_is_date(table_fmt[ee])&&(X.t="d",X.v=numdate(X.v)),Y.cm&&E.xlmeta){var Ee=(E.xlmeta.Cell||[])[+Y.cm-1];Ee&&Ee.type=="XLDAPR"&&(X.D=!0)}if(pe){var De=decode_cell(Y.r);P[De.r]||(P[De.r]=[]),P[De.r][De.c]=X}else P[Y.r]=X}}}}K.length>0&&(P["!rows"]=K)}}();function parse_BrtRowHdr(L,S){var T={},_=L.l+S;T.r=L.read_shift(4),L.l+=4;var w=L.read_shift(2);L.l+=1;var B=L.read_shift(1);return L.l=_,B&7&&(T.level=B&7),B&16&&(T.hidden=!0),B&32&&(T.hpt=w/20),T}var parse_BrtWsDim=parse_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(L,S){var T={},_=L[L.l];return++L.l,T.above=!(_&64),T.left=!(_&128),L.l+=18,T.name=parse_XLSBCodeName(L),T}function parse_BrtCellBlank(L){var S=parse_XLSBCell(L);return[S]}function parse_BrtShortBlank(L){var S=parse_XLSBShortCell(L);return[S]}function parse_BrtCellBool(L){var S=parse_XLSBCell(L),T=L.read_shift(1);return[S,T,"b"]}function parse_BrtShortBool(L){var S=parse_XLSBShortCell(L),T=L.read_shift(1);return[S,T,"b"]}function parse_BrtCellError(L){var S=parse_XLSBCell(L),T=L.read_shift(1);return[S,T,"e"]}function parse_BrtShortError(L){var S=parse_XLSBShortCell(L),T=L.read_shift(1);return[S,T,"e"]}function parse_BrtCellIsst(L){var S=parse_XLSBCell(L),T=L.read_shift(4);return[S,T,"s"]}function parse_BrtShortIsst(L){var S=parse_XLSBShortCell(L),T=L.read_shift(4);return[S,T,"s"]}function parse_BrtCellReal(L){var S=parse_XLSBCell(L),T=parse_Xnum(L);return[S,T,"n"]}function parse_BrtShortReal(L){var S=parse_XLSBShortCell(L),T=parse_Xnum(L);return[S,T,"n"]}function parse_BrtCellRk(L){var S=parse_XLSBCell(L),T=parse_RkNumber(L);return[S,T,"n"]}function parse_BrtShortRk(L){var S=parse_XLSBShortCell(L),T=parse_RkNumber(L);return[S,T,"n"]}function parse_BrtCellRString(L){var S=parse_XLSBCell(L),T=parse_RichStr(L);return[S,T,"is"]}function parse_BrtCellSt(L){var S=parse_XLSBCell(L),T=parse_XLWideString(L);return[S,T,"str"]}function parse_BrtShortSt(L){var S=parse_XLSBShortCell(L),T=parse_XLWideString(L);return[S,T,"str"]}function parse_BrtFmlaBool(L,S,T){var _=L.l+S,w=parse_XLSBCell(L);w.r=T["!row"];var B=L.read_shift(1),A=[w,B,"b"];if(T.cellFormula){L.l+=2;var O=parse_XLSBCellParsedFormula(L,_-L.l,T);A[3]=stringify_formula(O,null,w,T.supbooks,T)}else L.l=_;return A}function parse_BrtFmlaError(L,S,T){var _=L.l+S,w=parse_XLSBCell(L);w.r=T["!row"];var B=L.read_shift(1),A=[w,B,"e"];if(T.cellFormula){L.l+=2;var O=parse_XLSBCellParsedFormula(L,_-L.l,T);A[3]=stringify_formula(O,null,w,T.supbooks,T)}else L.l=_;return A}function parse_BrtFmlaNum(L,S,T){var _=L.l+S,w=parse_XLSBCell(L);w.r=T["!row"];var B=parse_Xnum(L),A=[w,B,"n"];if(T.cellFormula){L.l+=2;var O=parse_XLSBCellParsedFormula(L,_-L.l,T);A[3]=stringify_formula(O,null,w,T.supbooks,T)}else L.l=_;return A}function parse_BrtFmlaString(L,S,T){var _=L.l+S,w=parse_XLSBCell(L);w.r=T["!row"];var B=parse_XLWideString(L),A=[w,B,"str"];if(T.cellFormula){L.l+=2;var O=parse_XLSBCellParsedFormula(L,_-L.l,T);A[3]=stringify_formula(O,null,w,T.supbooks,T)}else L.l=_;return A}var parse_BrtMergeCell=parse_UncheckedRfX;function parse_BrtHLink(L,S){var T=L.l+S,_=parse_UncheckedRfX(L),w=parse_XLNullableWideString(L),B=parse_XLWideString(L),A=parse_XLWideString(L),O=parse_XLWideString(L);L.l=T;var R={rfx:_,relId:w,loc:B,display:O};return A&&(R.Tooltip=A),R}function parse_BrtPane(){}function parse_BrtArrFmla(L,S,T){var _=L.l+S,w=parse_RfX(L),B=L.read_shift(1),A=[w];if(A[2]=B,T.cellFormula){var O=parse_XLSBArrayParsedFormula(L,_-L.l,T);A[1]=O}else L.l=_;return A}function parse_BrtShrFmla(L,S,T){var _=L.l+S,w=parse_UncheckedRfX(L),B=[w];if(T.cellFormula){var A=parse_XLSBSharedParsedFormula(L,_-L.l,T);B[1]=A,L.l=_}else L.l=_;return B}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(L){var S={};return BrtMarginKeys.forEach(function(T){S[T]=parse_Xnum(L)}),S}function parse_BrtBeginWsView(L){var S=L.read_shift(2);return L.l+=28,{RTL:S&32}}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(L,S,T,_,w,B,A){if(!L)return L;var O=S||{};_||(_={"!id":{}});var R=O.dense?[]:{},P,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},D=!1,I=!1,M,N,k,F,G,V,j,H,U,X=[];O.biff=12,O["!row"]=0;var Y=0,z=!1,W=[],Z={},Q=O.supbooks||w.supbooks||[[]];if(Q.sharedf=Z,Q.arrayf=W,Q.SheetNames=w.SheetNames||w.Sheets.map(function(pe){return pe.name}),!O.supbooks&&(O.supbooks=Q,w.Names))for(var ee=0;ee<w.Names.length;++ee)Q[0][ee+1]=w.Names[ee];var te=[],re=[],ie=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var ne;if(recordhopper(L,function(K,ue,le){if(!I)switch(le){case 148:P=K;break;case 0:M=K,O.sheetRows&&O.sheetRows<=M.r&&(I=!0),H=encode_row(F=M.r),O["!row"]=M.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=pt2px(K.hpt)),re[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(N={t:K[2]},K[2]){case"n":N.v=K[1];break;case"s":j=strs[K[1]],N.v=j.t,N.r=j.r;break;case"b":N.v=!!K[1];break;case"e":N.v=K[1],O.cellText!==!1&&(N.w=BErr[N.v]);break;case"str":N.t="s",N.v=K[1];break;case"is":N.t="s",N.v=K[1].t;break}if((k=A.CellXf[K[0].iStyleRef])&&safe_format(N,k.numFmtId,null,O,B,A),G=K[0].c==-1?G+1:K[0].c,O.dense?(R[F]||(R[F]=[]),R[F][G]=N):R[encode_col(G)+H]=N,O.cellFormula){for(z=!1,Y=0;Y<W.length;++Y){var ce=W[Y];M.r>=ce[0].s.r&&M.r<=ce[0].e.r&&G>=ce[0].s.c&&G<=ce[0].e.c&&(N.F=encode_range(ce[0]),z=!0)}!z&&K.length>3&&(N.f=K[3])}if(E.s.r>M.r&&(E.s.r=M.r),E.s.c>G&&(E.s.c=G),E.e.r<M.r&&(E.e.r=M.r),E.e.c<G&&(E.e.c=G),O.cellDates&&k&&N.t=="n"&&fmt_is_date(table_fmt[k.numFmtId])){var _e=SSF_parse_date_code(N.v);_e&&(N.t="d",N.v=new Date(_e.y,_e.m-1,_e.d,_e.H,_e.M,_e.S,_e.u))}ne&&(ne.type=="XLDAPR"&&(N.D=!0),ne=void 0);break;case 1:case 12:if(!O.sheetStubs||D)break;N={t:"z",v:void 0},G=K[0].c==-1?G+1:K[0].c,O.dense?(R[F]||(R[F]=[]),R[F][G]=N):R[encode_col(G)+H]=N,E.s.r>M.r&&(E.s.r=M.r),E.s.c>G&&(E.s.c=G),E.e.r<M.r&&(E.e.r=M.r),E.e.c<G&&(E.e.c=G),ne&&(ne.type=="XLDAPR"&&(N.D=!0),ne=void 0);break;case 176:X.push(K);break;case 49:ne=((O.xlmeta||{}).Cell||[])[K-1];break;case 494:var oe=_["!id"][K.relId];for(oe?(K.Target=oe.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=oe):K.relId==""&&(K.Target="#"+K.loc),F=K.rfx.s.r;F<=K.rfx.e.r;++F)for(G=K.rfx.s.c;G<=K.rfx.e.c;++G)O.dense?(R[F]||(R[F]=[]),R[F][G]||(R[F][G]={t:"z",v:void 0}),R[F][G].l=K):(V=encode_cell({c:G,r:F}),R[V]||(R[V]={t:"z",v:void 0}),R[V].l=K);break;case 426:if(!O.cellFormula)break;W.push(K),U=O.dense?R[F][G]:R[encode_col(G)+H],U.f=stringify_formula(K[1],E,{r:M.r,c:G},Q,O),U.F=encode_range(K[0]);break;case 427:if(!O.cellFormula)break;Z[encode_cell(K[0].s)]=K[1],U=O.dense?R[F][G]:R[encode_col(G)+H],U.f=stringify_formula(K[1],E,{r:M.r,c:G},Q,O);break;case 60:if(!O.cellStyles)break;for(;K.e>=K.s;)te[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},ie||(ie=!0,find_mdw_colw(K.w/256)),process_col(te[K.e+1]);break;case 161:R["!autofilter"]={ref:encode_range(K)};break;case 476:R["!margins"]=K;break;case 147:w.Sheets[T]||(w.Sheets[T]={}),K.name&&(w.Sheets[T].CodeName=K.name),(K.above||K.left)&&(R["!outline"]={above:K.above,left:K.left});break;case 137:w.Views||(w.Views=[{}]),w.Views[0]||(w.Views[0]={}),K.RTL&&(w.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:D=!0;break;case 36:D=!1;break;case 37:D=!0;break;case 38:D=!1;break;default:if(!ue.T){if(!D||O.WTF)throw new Error("Unexpected record 0x"+le.toString(16))}}},O),delete O.supbooks,delete O["!row"],!R["!ref"]&&(E.s.r<2e6||P&&(P.e.r>0||P.e.c>0||P.s.r>0||P.s.c>0))&&(R["!ref"]=encode_range(P||E)),O.sheetRows&&R["!ref"]){var he=safe_decode_range(R["!ref"]);O.sheetRows<=+he.e.r&&(he.e.r=O.sheetRows-1,he.e.r>E.e.r&&(he.e.r=E.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>E.e.c&&(he.e.c=E.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),R["!fullref"]=R["!ref"],R["!ref"]=encode_range(he))}return X.length>0&&(R["!merges"]=X),te.length>0&&(R["!cols"]=te),re.length>0&&(R["!rows"]=re),R}function parse_Cache(L){var S=[],T=L.match(/^<c:numCache>/),_;(L.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(B){var A=B.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);A&&(S[+A[1]]=T?+A[2]:A[2])});var w=unescapexml((L.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(L.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(B){_=B.replace(/<.*?>/g,"")}),[S,w,_]}function parse_chart(L,S,T,_,w,B){var A=B||{"!type":"chart"};if(!L)return B;var O=0,R=0,P="A",E={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(L.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(D){var I=parse_Cache(D);E.s.r=E.s.c=0,E.e.c=O,P=encode_col(O),I[0].forEach(function(M,N){A[P+encode_row(N)]={t:"n",v:M,z:I[1]},R=N}),E.e.r<R&&(E.e.r=R),++O}),O>0&&(A["!ref"]=encode_range(E)),A}function parse_cs_xml(L,S,T,_,w){if(!L)return L;_||(_={"!id":{}});var B={"!type":"chart","!drawel":null,"!rel":""},A,O=L.match(sheetprregex);return O&&parse_ws_xml_sheetpr(O[0],B,w,T),(A=L.match(/drawing r:id="(.*?)"/))&&(B["!rel"]=A[1]),_["!id"][B["!rel"]]&&(B["!drawel"]=_["!id"][B["!rel"]]),B}function parse_BrtCsProp(L,S){L.l+=10;var T=parse_XLWideString(L);return{name:T}}function parse_cs_bin(L,S,T,_,w){if(!L)return L;_||(_={"!id":{}});var B={"!type":"chart","!drawel":null,"!rel":""},A=!1;return recordhopper(L,function(R,P,E){switch(E){case 550:B["!rel"]=R;break;case 651:w.Sheets[T]||(w.Sheets[T]={}),R.name&&(w.Sheets[T].CodeName=R.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:A=!0;break;case 36:A=!1;break;case 37:break;case 38:break;default:if(!(P.T>0)){if(!(P.T<0)){if(!A||S.WTF)throw new Error("Unexpected record 0x"+E.toString(16))}}}},S),_["!id"][B["!rel"]]&&(B["!drawel"]=_["!id"][B["!rel"]]),B}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(L,S){for(var T=0;T!=L.length;++T)for(var _=L[T],w=0;w!=S.length;++w){var B=S[w];if(_[B[0]]==null)_[B[0]]=B[1];else switch(B[2]){case"bool":typeof _[B[0]]=="string"&&(_[B[0]]=parsexmlbool(_[B[0]]));break;case"int":typeof _[B[0]]=="string"&&(_[B[0]]=parseInt(_[B[0]],10));break}}}function push_defaults(L,S){for(var T=0;T!=S.length;++T){var _=S[T];if(L[_[0]]==null)L[_[0]]=_[1];else switch(_[2]){case"bool":typeof L[_[0]]=="string"&&(L[_[0]]=parsexmlbool(L[_[0]]));break;case"int":typeof L[_[0]]=="string"&&(L[_[0]]=parseInt(L[_[0]],10));break}}}function parse_wb_defaults(L){push_defaults(L.WBProps,WBPropsDef),push_defaults(L.CalcPr,CalcPrDef),push_defaults_array(L.WBView,WBViewDef),push_defaults_array(L.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(L.WBProps.date1904)}var badchars="][*?/\\".split("");function check_ws_name(L,S){if(L.length>31)throw new Error("Sheet names cannot exceed 31 chars");var T=!0;return badchars.forEach(function(_){if(L.indexOf(_)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),T}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(L,S){if(!L)throw new Error("Could not find file");var T={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},_=!1,w="xmlns",B={},A=0;if(L.replace(tagregex,function(R,P){var E=parsexmltag(R);switch(strip_ns(E[0])){case"<?xml":break;case"<workbook":R.match(wbnsregex)&&(w="xmlns"+R.match(/<(\w+):/)[1]),T.xmlns=E[w];break;case"</workbook>":break;case"<fileVersion":delete E[0],T.AppVersion=E;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(D){if(E[D[0]]!=null)switch(D[2]){case"bool":T.WBProps[D[0]]=parsexmlbool(E[D[0]]);break;case"int":T.WBProps[D[0]]=parseInt(E[D[0]],10);break;default:T.WBProps[D[0]]=E[D[0]]}}),E.codeName&&(T.WBProps.CodeName=utf8read(E.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete E[0],T.WBView.push(E);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(E.state){case"hidden":E.Hidden=1;break;case"veryHidden":E.Hidden=2;break;default:E.Hidden=0}delete E.state,E.name=unescapexml(utf8read(E.name)),delete E[0],T.Sheets.push(E);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":_=!0;break;case"</definedNames>":_=!1;break;case"<definedName":B={},B.Name=utf8read(E.name),E.comment&&(B.Comment=E.comment),E.localSheetId&&(B.Sheet=+E.localSheetId),parsexmlbool(E.hidden||"0")&&(B.Hidden=!0),A=P+R.length;break;case"</definedName>":B.Ref=unescapexml(utf8read(L.slice(A,P))),T.Names.push(B);break;case"<definedName/>":break;case"<calcPr":delete E[0],T.CalcPr=E;break;case"<calcPr/>":delete E[0],T.CalcPr=E;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_=!0;break;case"</ext>":_=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":_=!0;break;case"</AlternateContent>":_=!1;break;case"<revisionPtr":break;default:if(!_&&S.WTF)throw new Error("unrecognized "+E[0]+" in workbook")}return R}),XMLNS_main.indexOf(T.xmlns)===-1)throw new Error("Unknown Namespace: "+T.xmlns);return parse_wb_defaults(T),T}function parse_BrtBundleSh(L,S){var T={};return T.Hidden=L.read_shift(4),T.iTabID=L.read_shift(4),T.strRelID=parse_RelID(L),T.name=parse_XLWideString(L),T}function parse_BrtWbProp(L,S){var T={},_=L.read_shift(4);T.defaultThemeVersion=L.read_shift(4);var w=S>8?parse_XLWideString(L):"";return w.length>0&&(T.CodeName=w),T.autoCompressPictures=!!(_&65536),T.backupFile=!!(_&64),T.checkCompatibility=!!(_&4096),T.date1904=!!(_&1),T.filterPrivacy=!!(_&8),T.hidePivotFieldList=!!(_&1024),T.promptedSolutions=!!(_&16),T.publishItems=!!(_&2048),T.refreshAllConnections=!!(_&262144),T.saveExternalLinkValues=!!(_&128),T.showBorderUnselectedTables=!!(_&4),T.showInkAnnotation=!!(_&32),T.showObjects=["all","placeholders","none"][_>>13&3],T.showPivotChartFilter=!!(_&32768),T.updateLinks=["userSet","never","always"][_>>8&3],T}function parse_BrtFRTArchID$(L,S){var T={};return L.read_shift(4),T.ArchID=L.read_shift(4),L.l+=S-8,T}function parse_BrtName(L,S,T){var _=L.l+S;L.l+=4,L.l+=1;var w=L.read_shift(4),B=parse_XLNameWideString(L),A=parse_XLSBNameParsedFormula(L,0,T),O=parse_XLNullableWideString(L);L.l=_;var R={Name:B,Ptg:A};return w<268435455&&(R.Sheet=w),O&&(R.Comment=O),R}function parse_wb_bin(L,S){var T={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},_=[],w=!1;S||(S={}),S.biff=12;var B=[],A=[[]];return A.SheetNames=[],A.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(L,function(R,P,E){switch(E){case 156:A.SheetNames.push(R.name),T.Sheets.push(R);break;case 153:T.WBProps=R;break;case 39:R.Sheet!=null&&(S.SID=R.Sheet),R.Ref=stringify_formula(R.Ptg,null,null,A,S),delete S.SID,delete R.Ptg,B.push(R);break;case 1036:break;case 357:case 358:case 355:case 667:A[0].length?A.push([E,R]):A[0]=[E,R],A[A.length-1].XTI=[];break;case 362:A.length===0&&(A[0]=[],A[0].XTI=[]),A[A.length-1].XTI=A[A.length-1].XTI.concat(R),A.XTI=A.XTI.concat(R);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:_.push(E),w=!0;break;case 36:_.pop(),w=!1;break;case 37:_.push(E),w=!0;break;case 38:_.pop(),w=!1;break;case 16:break;default:if(!P.T){if(!w||S.WTF&&_[_.length-1]!=37&&_[_.length-1]!=35)throw new Error("Unexpected record 0x"+E.toString(16))}}},S),parse_wb_defaults(T),T.Names=B,T.supbooks=A,T}function parse_wb(L,S,T){return S.slice(-4)===".bin"?parse_wb_bin(L,T):parse_wb_xml(L,T)}function parse_ws(L,S,T,_,w,B,A,O){return S.slice(-4)===".bin"?parse_ws_bin(L,_,T,w,B,A,O):parse_ws_xml(L,_,T,w,B,A,O)}function parse_cs(L,S,T,_,w,B,A,O){return S.slice(-4)===".bin"?parse_cs_bin(L,_,T,w,B):parse_cs_xml(L,_,T,w,B)}function parse_ms(L,S,T,_,w,B,A,O){return S.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(L,S,T,_,w,B,A,O){return S.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(L,S,T,_){return S.slice(-4)===".bin"?parse_sty_bin(L,T,_):parse_sty_xml(L,T,_)}function parse_theme(L,S,T){return parse_theme_xml(L,T)}function parse_sst(L,S,T){return S.slice(-4)===".bin"?parse_sst_bin(L,T):parse_sst_xml(L,T)}function parse_cmnt(L,S,T){return S.slice(-4)===".bin"?parse_comments_bin(L,T):parse_comments_xml(L,T)}function parse_cc(L,S,T){return S.slice(-4)===".bin"?parse_cc_bin(L):parse_cc_xml(L)}function parse_xlink(L,S,T,_){return T.slice(-4)===".bin"?parse_xlink_bin(L,S,T,_):void 0}function parse_xlmeta(L,S,T){return S.slice(-4)===".bin"?parse_xlmeta_bin(L,S,T):parse_xlmeta_xml(L,S,T)}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(L,S){var T=L.split(/\s+/),_=[];if(_[0]=T[0],T.length===1)return _;var w=L.match(attregexg2),B,A,O,R;if(w)for(R=0;R!=w.length;++R)B=w[R].match(attregex2),(A=B[1].indexOf(":"))===-1?_[B[1]]=B[2].slice(1,B[2].length-1):(B[1].slice(0,6)==="xmlns:"?O="xmlns"+B[1].slice(6):O=B[1].slice(A+1),_[O]=B[2].slice(1,B[2].length-1));return _}function xlml_parsexmltagobj(L){var S=L.split(/\s+/),T={};if(S.length===1)return T;var _=L.match(attregexg2),w,B,A,O;if(_)for(O=0;O!=_.length;++O)w=_[O].match(attregex2),(B=w[1].indexOf(":"))===-1?T[w[1]]=w[2].slice(1,w[2].length-1):(w[1].slice(0,6)==="xmlns:"?A="xmlns"+w[1].slice(6):A=w[1].slice(B+1),T[A]=w[2].slice(1,w[2].length-1));return T}var XLMLFormatMap;function xlml_format(L,S){var T=XLMLFormatMap[L]||unescapexml(L);return T==="General"?SSF_general(S):SSF_format(T,S)}function xlml_set_custprop(L,S,T,_){var w=_;switch((T[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":w=parsexmlbool(_);break;case"i2":case"int":w=parseInt(_,10);break;case"r4":case"float":w=parseFloat(_);break;case"date":case"dateTime.tz":w=parseDate(_);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+T[0])}L[unescapexml(S)]=w}function safe_format_xlml(L,S,T){if(L.t!=="z"){if(!T||T.cellText!==!1)try{L.t==="e"?L.w=L.w||BErr[L.v]:S==="General"?L.t==="n"?(L.v|0)===L.v?L.w=L.v.toString(10):L.w=SSF_general_num(L.v):L.w=SSF_general(L.v):L.w=xlml_format(S||"General",L.v)}catch(B){if(T.WTF)throw B}try{var _=XLMLFormatMap[S]||S||"General";if(T.cellNF&&(L.z=_),T.cellDates&&L.t=="n"&&fmt_is_date(_)){var w=SSF_parse_date_code(L.v);w&&(L.t="d",L.v=new Date(w.y,w.m-1,w.d,w.H,w.M,w.S,w.u))}}catch(B){if(T.WTF)throw B}}}function process_style_xlml(L,S,T){if(T.cellStyles&&S.Interior){var _=S.Interior;_.Pattern&&(_.patternType=XLMLPatternTypeMap[_.Pattern]||_.Pattern)}L[S.ID]=S}function parse_xlml_data(L,S,T,_,w,B,A,O,R,P){var E="General",D=_.StyleID,I={};P=P||{};var M=[],N=0;for(D===void 0&&O&&(D=O.StyleID),D===void 0&&A&&(D=A.StyleID);B[D]!==void 0&&(B[D].nf&&(E=B[D].nf),B[D].Interior&&M.push(B[D].Interior),!!B[D].Parent);)D=B[D].Parent;switch(T.Type){case"Boolean":_.t="b",_.v=parsexmlbool(L);break;case"String":_.t="s",_.r=xlml_fixstr(unescapexml(L)),_.v=L.indexOf("<")>-1?unescapexml(S||L).replace(/<.*?>/g,""):_.r;break;case"DateTime":L.slice(-1)!="Z"&&(L+="Z"),_.v=(parseDate(L)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),_.v!==_.v?_.v=unescapexml(L):_.v<60&&(_.v=_.v-1),(!E||E=="General")&&(E="yyyy-mm-dd");case"Number":_.v===void 0&&(_.v=+L),_.t||(_.t="n");break;case"Error":_.t="e",_.v=RBErr[L],P.cellText!==!1&&(_.w=L);break;default:L==""&&S==""?_.t="z":(_.t="s",_.v=xlml_fixstr(S||L));break}if(safe_format_xlml(_,E,P),P.cellFormula!==!1)if(_.Formula){var k=unescapexml(_.Formula);k.charCodeAt(0)==61&&(k=k.slice(1)),_.f=rc_to_a1(k,w),delete _.Formula,_.ArrayRange=="RC"?_.F=rc_to_a1("RC:RC",w):_.ArrayRange&&(_.F=rc_to_a1(_.ArrayRange,w),R.push([safe_decode_range(_.F),_.F]))}else for(N=0;N<R.length;++N)w.r>=R[N][0].s.r&&w.r<=R[N][0].e.r&&w.c>=R[N][0].s.c&&w.c<=R[N][0].e.c&&(_.F=R[N][1]);P.cellStyles&&(M.forEach(function(F){!I.patternType&&F.patternType&&(I.patternType=F.patternType)}),_.s=I),_.StyleID!==void 0&&(_.ixfe=_.StyleID)}function xlml_clean_comment(L){L.t=L.v||"",L.t=L.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),L.v=L.w=L.ixfe=void 0}function parse_xlml_xml(L,S){var T=S||{};make_ssf();var _=debom(xlml_normalize(L));(T.type=="binary"||T.type=="array"||T.type=="base64")&&(_=utf8read(_));var w=_.slice(0,1024).toLowerCase(),B=!1;if(w=w.replace(/".*?"/g,""),(w.indexOf(">")&1023)>Math.min(w.indexOf(",")&1023,w.indexOf(";")&1023)){var A=dup(T);return A.type="string",PRN.to_workbook(_,A)}if(w.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ve){w.indexOf("<"+Ve)>=0&&(B=!0)}),B)return html_to_workbook(_,T);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var O,R=[],P,E={},D=[],I=T.dense?[]:{},M="",N={},k={},F=xlml_parsexmltag('<Data ss:Type="String">'),G=0,V=0,j=0,H={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},X={},Y="",z=0,W=[],Z={},Q={},ee=0,te=[],re=[],ie={},ne=[],he,pe=!1,K=[],ue=[],le={},ce=0,_e=0,oe={Sheets:[],WBProps:{date1904:!1}},de={};xlmlregex.lastIndex=0,_=_.replace(/<!--([\s\S]*?)-->/mg,"");for(var me="";O=xlmlregex.exec(_);)switch(O[3]=(me=O[3]).toLowerCase()){case"data":if(me=="data"){if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"))}else O[0].charAt(O[0].length-2)!=="/"&&R.push([O[3],!0]);break}if(R[R.length-1][1])break;O[1]==="/"?parse_xlml_data(_.slice(G,O.index),Y,F,R[R.length-1][0]=="comment"?ie:N,{c:V,r:j},U,ne[V],k,K,T):(Y="",F=xlml_parsexmltag(O[0]),G=O.index+O[0].length);break;case"cell":if(O[1]==="/")if(re.length>0&&(N.c=re),(!T.sheetRows||T.sheetRows>j)&&N.v!==void 0&&(T.dense?(I[j]||(I[j]=[]),I[j][V]=N):I[encode_col(V)+encode_row(j)]=N),N.HRef&&(N.l={Target:unescapexml(N.HRef)},N.HRefScreenTip&&(N.l.Tooltip=N.HRefScreenTip),delete N.HRef,delete N.HRefScreenTip),(N.MergeAcross||N.MergeDown)&&(ce=V+(parseInt(N.MergeAcross,10)|0),_e=j+(parseInt(N.MergeDown,10)|0),W.push({s:{c:V,r:j},e:{c:ce,r:_e}})),!T.sheetStubs)N.MergeAcross?V=ce+1:++V;else if(N.MergeAcross||N.MergeDown){for(var ye=V;ye<=ce;++ye)for(var ge=j;ge<=_e;++ge)(ye>V||ge>j)&&(T.dense?(I[ge]||(I[ge]=[]),I[ge][ye]={t:"z"}):I[encode_col(ye)+encode_row(ge)]={t:"z"});V=ce+1}else++V;else N=xlml_parsexmltagobj(O[0]),N.Index&&(V=+N.Index-1),V<H.s.c&&(H.s.c=V),V>H.e.c&&(H.e.c=V),O[0].slice(-2)==="/>"&&++V,re=[];break;case"row":O[1]==="/"||O[0].slice(-2)==="/>"?(j<H.s.r&&(H.s.r=j),j>H.e.r&&(H.e.r=j),O[0].slice(-2)==="/>"&&(k=xlml_parsexmltag(O[0]),k.Index&&(j=+k.Index-1)),V=0,++j):(k=xlml_parsexmltag(O[0]),k.Index&&(j=+k.Index-1),le={},(k.AutoFitHeight=="0"||k.Height)&&(le.hpx=parseInt(k.Height,10),le.hpt=px2pt(le.hpx),ue[j]=le),k.Hidden=="1"&&(le.hidden=!0,ue[j]=le));break;case"worksheet":if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"));D.push(M),H.s.r<=H.e.r&&H.s.c<=H.e.c&&(I["!ref"]=encode_range(H),T.sheetRows&&T.sheetRows<=H.e.r&&(I["!fullref"]=I["!ref"],H.e.r=T.sheetRows-1,I["!ref"]=encode_range(H))),W.length&&(I["!merges"]=W),ne.length>0&&(I["!cols"]=ne),ue.length>0&&(I["!rows"]=ue),E[M]=I}else H={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=V=0,R.push([O[3],!1]),P=xlml_parsexmltag(O[0]),M=unescapexml(P.Name),I=T.dense?[]:{},W=[],K=[],ue=[],de={name:M,Hidden:0},oe.Sheets.push(de);break;case"table":if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"))}else{if(O[0].slice(-2)=="/>")break;R.push([O[3],!1]),ne=[],pe=!1}break;case"style":O[1]==="/"?process_style_xlml(U,X,T):X=xlml_parsexmltag(O[0]);break;case"numberformat":X.nf=unescapexml(xlml_parsexmltag(O[0]).Format||"General"),XLMLFormatMap[X.nf]&&(X.nf=XLMLFormatMap[X.nf]);for(var we=0;we!=392&&table_fmt[we]!=X.nf;++we);if(we==392){for(we=57;we!=392;++we)if(table_fmt[we]==null){SSF_load(X.nf,we);break}}break;case"column":if(R[R.length-1][0]!=="table")break;if(he=xlml_parsexmltag(O[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!pe&&he.wpx>10){pe=!0,MDW=DEF_MDW;for(var Te=0;Te<ne.length;++Te)ne[Te]&&process_col(ne[Te])}pe&&process_col(he),ne[he.Index-1||ne.length]=he;for(var Ee=0;Ee<+he.Span;++Ee)ne[ne.length]=dup(he);break;case"namedrange":if(O[1]==="/")break;oe.Names||(oe.Names=[]);var De=parsexmltag(O[0]),fe={Name:De.Name,Ref:rc_to_a1(De.RefersTo.slice(1),{r:0,c:0})};oe.Sheets.length>0&&(fe.Sheet=oe.Sheets.length-1),oe.Names.push(fe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(O[0].slice(-2)==="/>")break;O[1]==="/"?Y+=_.slice(z,O.index):z=O.index+O[0].length;break;case"interior":if(!T.cellStyles)break;X.Interior=xlml_parsexmltag(O[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(O[0].slice(-2)==="/>")break;O[1]==="/"?xlml_set_prop(Z,me,_.slice(ee,O.index)):ee=O.index+O[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"))}else R.push([O[3],!1]);break;case"comment":if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"));xlml_clean_comment(ie),re.push(ie)}else R.push([O[3],!1]),P=xlml_parsexmltag(O[0]),ie={a:P.Author};break;case"autofilter":if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"))}else if(O[0].charAt(O[0].length-2)!=="/"){var Ce=xlml_parsexmltag(O[0]);I["!autofilter"]={ref:rc_to_a1(Ce.Range).replace(/\$/g,"")},R.push([O[3],!0])}break;case"name":break;case"datavalidation":if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"))}else O[0].charAt(O[0].length-2)!=="/"&&R.push([O[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(O[1]==="/"){if((P=R.pop())[0]!==O[3])throw new Error("Bad state: "+P.join("|"))}else O[0].charAt(O[0].length-2)!=="/"&&R.push([O[3],!0]);break;case"null":break;default:if(R.length==0&&O[3]=="document"||R.length==0&&O[3]=="uof")return parse_fods(_,T);var Se=!0;switch(R[R.length-1][0]){case"officedocumentsettings":switch(O[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Se=!1}break;case"componentoptions":switch(O[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Se=!1}break;case"excelworkbook":switch(O[3]){case"date1904":oe.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Se=!1}break;case"workbookoptions":switch(O[3]){case"owcversion":break;case"height":break;case"width":break;default:Se=!1}break;case"worksheetoptions":switch(O[3]){case"visible":if(O[0].slice(-2)!=="/>")if(O[1]==="/")switch(_.slice(ee,O.index)){case"SheetHidden":de.Hidden=1;break;case"SheetVeryHidden":de.Hidden=2;break}else ee=O.index+O[0].length;break;case"header":I["!margins"]||default_margins(I["!margins"]={},"xlml"),isNaN(+parsexmltag(O[0]).Margin)||(I["!margins"].header=+parsexmltag(O[0]).Margin);break;case"footer":I["!margins"]||default_margins(I["!margins"]={},"xlml"),isNaN(+parsexmltag(O[0]).Margin)||(I["!margins"].footer=+parsexmltag(O[0]).Margin);break;case"pagemargins":var be=parsexmltag(O[0]);I["!margins"]||default_margins(I["!margins"]={},"xlml"),isNaN(+be.Top)||(I["!margins"].top=+be.Top),isNaN(+be.Left)||(I["!margins"].left=+be.Left),isNaN(+be.Right)||(I["!margins"].right=+be.Right),isNaN(+be.Bottom)||(I["!margins"].bottom=+be.Bottom);break;case"displayrighttoleft":oe.Views||(oe.Views=[]),oe.Views[0]||(oe.Views[0]={}),oe.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":I["!outline"]||(I["!outline"]={}),I["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":I["!outline"]||(I["!outline"]={}),I["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Se=!1}break;case"pivottable":case"pivotcache":switch(O[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Se=!1}break;case"pagebreaks":switch(O[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Se=!1}break;case"autofilter":switch(O[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Se=!1}break;case"querytable":switch(O[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Se=!1}break;case"datavalidation":switch(O[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Se=!1}break;case"sorting":case"conditionalformatting":switch(O[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Se=!1}break;case"mapinfo":case"schema":case"data":switch(O[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Se=!1}break;case"smarttags":break;default:Se=!1;break}if(Se||O[3].match(/!\[CDATA/))break;if(!R[R.length-1][1])throw"Unrecognized tag: "+O[3]+"|"+R.join("|");if(R[R.length-1][0]==="customdocumentproperties"){if(O[0].slice(-2)==="/>")break;O[1]==="/"?xlml_set_custprop(Q,me,te,_.slice(ee,O.index)):(te=O,ee=O.index+O[0].length);break}if(T.WTF)throw"Unrecognized tag: "+O[3]+"|"+R.join("|")}var Re={};return!T.bookSheets&&!T.bookProps&&(Re.Sheets=E),Re.SheetNames=D,Re.Workbook=oe,Re.SSF=dup(table_fmt),Re.Props=Z,Re.Custprops=Q,Re}function parse_xlml(L,S){switch(fix_read_opts(S=S||{}),S.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(L),S);case"binary":case"buffer":case"file":return parse_xlml_xml(L,S);case"array":return parse_xlml_xml(a2s(L),S)}}function parse_compobj(L){var S={},T=L.content;if(T.l=28,S.AnsiUserType=T.read_shift(0,"lpstr-ansi"),S.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(T),T.length-T.l<=4)return S;var _=T.read_shift(4);if(_==0||_>40||(T.l-=4,S.Reserved1=T.read_shift(0,"lpstr-ansi"),T.length-T.l<=4)||(_=T.read_shift(4),_!==1907505652)||(S.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(T),_=T.read_shift(4),_==0||_>40))return S;T.l-=4,S.Reserved2=T.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(L,S,T,_,w){var B=_,A=[],O=T.slice(T.l,T.l+B);if(w&&w.enc&&w.enc.insitu&&O.length>0)switch(L){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:w.enc.insitu(O)}A.push(O),T.l+=B;for(var R=__readUInt16LE(T,T.l),P=XLSRecordEnum[R],E=0;P!=null&&CONTINUE_RT.indexOf(R)>-1;)B=__readUInt16LE(T,T.l+2),E=T.l+4,R==2066?E+=4:(R==2165||R==2175)&&(E+=12),O=T.slice(E,T.l+4+B),A.push(O),T.l+=4+B,P=XLSRecordEnum[R=__readUInt16LE(T,T.l)];var D=bconcat(A);prep_blob(D,0);var I=0;D.lens=[];for(var M=0;M<A.length;++M)D.lens.push(I),I+=A[M].length;if(D.length<_)throw"XLS Record 0x"+L.toString(16)+" Truncated: "+D.length+" < "+_;return S.f(D,D.length,w)}function safe_format_xf(L,S,T){if(L.t!=="z"&&L.XF){var _=0;try{_=L.z||L.XF.numFmtId||0,S.cellNF&&(L.z=table_fmt[_])}catch(B){if(S.WTF)throw B}if(!S||S.cellText!==!1)try{L.t==="e"?L.w=L.w||BErr[L.v]:_===0||_=="General"?L.t==="n"?(L.v|0)===L.v?L.w=L.v.toString(10):L.w=SSF_general_num(L.v):L.w=SSF_general(L.v):L.w=SSF_format(_,L.v,{date1904:!!T,dateNF:S&&S.dateNF})}catch(B){if(S.WTF)throw B}if(S.cellDates&&_&&L.t=="n"&&fmt_is_date(table_fmt[_]||String(_))){var w=SSF_parse_date_code(L.v);w&&(L.t="d",L.v=new Date(w.y,w.m-1,w.d,w.H,w.M,w.S,w.u))}}}function make_cell(L,S,T){return{v:L,ixfe:S,t:T}}function parse_workbook(L,S){var T={opts:{}},_={},w=S.dense?[]:{},B={},A={},O=null,R=[],P="",E={},D,I="",M,N,k,F,G={},V=[],j,H,U=[],X=[],Y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},W=function(ut){return ut<8?XLSIcv[ut]:ut<64&&X[ut-8]||XLSIcv[ut]},Z=function(ut,gt,Ue){var We=gt.XF.data;if(!(!We||!We.patternType||!Ue||!Ue.cellStyles)){gt.s={},gt.s.patternType=We.patternType;var ht;(ht=rgb2Hex(W(We.icvFore)))&&(gt.s.fgColor={rgb:ht}),(ht=rgb2Hex(W(We.icvBack)))&&(gt.s.bgColor={rgb:ht})}},Q=function(ut,gt,Ue){if(!(le>1)&&!(Ue.sheetRows&&ut.r>=Ue.sheetRows)){if(Ue.cellStyles&&gt.XF&&gt.XF.data&&Z(ut,gt,Ue),delete gt.ixfe,delete gt.XF,D=ut,I=encode_cell(ut),(!A||!A.s||!A.e)&&(A={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<A.s.r&&(A.s.r=ut.r),ut.c<A.s.c&&(A.s.c=ut.c),ut.r+1>A.e.r&&(A.e.r=ut.r+1),ut.c+1>A.e.c&&(A.e.c=ut.c+1),Ue.cellFormula&&gt.f){for(var We=0;We<V.length;++We)if(!(V[We][0].s.c>ut.c||V[We][0].s.r>ut.r)&&!(V[We][0].e.c<ut.c||V[We][0].e.r<ut.r)){gt.F=encode_range(V[We][0]),(V[We][0].s.c!=ut.c||V[We][0].s.r!=ut.r)&&delete gt.f,gt.f&&(gt.f=""+stringify_formula(V[We][1],A,ut,K,ee));break}}Ue.dense?(w[ut.r]||(w[ut.r]=[]),w[ut.r][ut.c]=gt):w[I]=gt}},ee={enc:!1,sbcch:0,snames:[],sharedf:G,arrayf:V,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!S&&!!S.cellStyles,WTF:!!S&&!!S.wtf};S.password&&(ee.password=S.password);var te,re=[],ie=[],ne=[],he=[],pe=!1,K=[];K.SheetNames=ee.snames,K.sharedf=ee.sharedf,K.arrayf=ee.arrayf,K.names=[],K.XTI=[];var ue=0,le=0,ce=0,_e=[],oe=[],de;ee.codepage=1200,set_cp(1200);for(var me=!1;L.l<L.length-1;){var ye=L.l,ge=L.read_shift(2);if(ge===0&&ue===10)break;var we=L.l===L.length?0:L.read_shift(2),Te=XLSRecordEnum[ge];if(Te&&Te.f){if(S.bookSheets&&ue===133&&ge!==133)break;if(ue=ge,Te.r===2||Te.r==12){var Ee=L.read_shift(2);if(we-=2,!ee.enc&&Ee!==ge&&((Ee&255)<<8|Ee>>8)!==ge)throw new Error("rt mismatch: "+Ee+"!="+ge);Te.r==12&&(L.l+=10,we-=10)}var De={};if(ge===10?De=Te.f(L,we,ee):De=slurp(ge,Te,L,we,ee),le==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(ge){case 34:T.opts.Date1904=Y.WBProps.date1904=De;break;case 134:T.opts.WriteProtect=!0;break;case 47:if(ee.enc||(L.l=0),ee.enc=De,!S.password)throw new Error("File is password-protected");if(De.valid==null)throw new Error("Encryption scheme unsupported");if(!De.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=De;break;case 66:var fe=Number(De);switch(fe){case 21010:fe=1200;break;case 32768:fe=1e4;break;case 32769:fe=1252;break}set_cp(ee.codepage=fe),me=!0;break;case 317:ee.rrtabid=De;break;case 25:ee.winlocked=De;break;case 439:T.opts.RefreshAll=De;break;case 12:T.opts.CalcCount=De;break;case 16:T.opts.CalcDelta=De;break;case 17:T.opts.CalcIter=De;break;case 13:T.opts.CalcMode=De;break;case 14:T.opts.CalcPrecision=De;break;case 95:T.opts.CalcSaveRecalc=De;break;case 15:ee.CalcRefMode=De;break;case 2211:T.opts.FullCalc=De;break;case 129:De.fDialog&&(w["!type"]="dialog"),De.fBelow||((w["!outline"]||(w["!outline"]={})).above=!0),De.fRight||((w["!outline"]||(w["!outline"]={})).left=!0);break;case 224:U.push(De);break;case 430:K.push([De]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(De);break;case 24:case 536:de={Name:De.Name,Ref:stringify_formula(De.rgce,A,null,K,ee)},De.itab>0&&(de.Sheet=De.itab-1),K.names.push(de),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(De),De.Name=="_xlnm._FilterDatabase"&&De.itab>0&&De.rgce&&De.rgce[0]&&De.rgce[0][0]&&De.rgce[0][0][0]=="PtgArea3d"&&(oe[De.itab-1]={ref:encode_range(De.rgce[0][0][1][2])});break;case 22:ee.ExternCount=De;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(De),K.XTI=K.XTI.concat(De);break;case 2196:if(ee.biff<8)break;de!=null&&(de.Comment=De[1]);break;case 18:w["!protect"]=De;break;case 19:De!==0&&ee.WTF&&console.error("Password verifier: "+De);break;case 133:B[De.pos]=De,ee.snames.push(De.name);break;case 10:{if(--le)break;if(A.e){if(A.e.r>0&&A.e.c>0){if(A.e.r--,A.e.c--,w["!ref"]=encode_range(A),S.sheetRows&&S.sheetRows<=A.e.r){var Ce=A.e.r;A.e.r=S.sheetRows-1,w["!fullref"]=w["!ref"],w["!ref"]=encode_range(A),A.e.r=Ce}A.e.r++,A.e.c++}re.length>0&&(w["!merges"]=re),ie.length>0&&(w["!objects"]=ie),ne.length>0&&(w["!cols"]=ne),he.length>0&&(w["!rows"]=he),Y.Sheets.push(z)}P===""?E=w:_[P]=w,w=S.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[De.BIFFVer]||8),ee.biffguess=De.BIFFVer==0,De.BIFFVer==0&&De.dt==4096&&(ee.biff=5,me=!0,set_cp(ee.codepage=28591)),ee.biff==8&&De.BIFFVer==0&&De.dt==16&&(ee.biff=2),le++)break;if(w=S.dense?[]:{},ee.biff<8&&!me&&(me=!0,set_cp(ee.codepage=S.codepage||1252)),ee.biff<5||De.BIFFVer==0&&De.dt==4096){P===""&&(P="Sheet1"),A={s:{r:0,c:0},e:{r:0,c:0}};var Se={pos:L.l-we,name:P};B[Se.pos]=Se,ee.snames.push(P)}else P=(B[ye]||{name:""}).name;De.dt==32&&(w["!type"]="chart"),De.dt==64&&(w["!type"]="macro"),re=[],ie=[],ee.arrayf=V=[],ne=[],he=[],pe=!1,z={Hidden:(B[ye]||{hs:0}).hs,name:P}}break;case 515:case 3:case 2:w["!type"]=="chart"&&(S.dense?(w[De.r]||[])[De.c]:w[encode_cell({c:De.c,r:De.r})])&&++De.c,j={ixfe:De.ixfe,XF:U[De.ixfe]||{},v:De.val,t:"n"},ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:De.c,r:De.r},j,S);break;case 5:case 517:j={ixfe:De.ixfe,XF:U[De.ixfe],v:De.val,t:De.t},ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:De.c,r:De.r},j,S);break;case 638:j={ixfe:De.ixfe,XF:U[De.ixfe],v:De.rknum,t:"n"},ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:De.c,r:De.r},j,S);break;case 189:for(var be=De.c;be<=De.C;++be){var Re=De.rkrec[be-De.c][0];j={ixfe:Re,XF:U[Re],v:De.rkrec[be-De.c][1],t:"n"},ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:be,r:De.r},j,S)}break;case 6:case 518:case 1030:{if(De.val=="String"){O=De;break}if(j=make_cell(De.val,De.cell.ixfe,De.tt),j.XF=U[j.ixfe],S.cellFormula){var Ve=De.formula;if(Ve&&Ve[0]&&Ve[0][0]&&Ve[0][0][0]=="PtgExp"){var Pe=Ve[0][0][1][0],ke=Ve[0][0][1][1],Ne=encode_cell({r:Pe,c:ke});G[Ne]?j.f=""+stringify_formula(De.formula,A,De.cell,K,ee):j.F=((S.dense?(w[Pe]||[])[ke]:w[Ne])||{}).F}else j.f=""+stringify_formula(De.formula,A,De.cell,K,ee)}ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q(De.cell,j,S),O=De}break;case 7:case 519:if(O)O.val=De,j=make_cell(De,O.cell.ixfe,"s"),j.XF=U[j.ixfe],S.cellFormula&&(j.f=""+stringify_formula(O.formula,A,O.cell,K,ee)),ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q(O.cell,j,S),O=null;else throw new Error("String record expects Formula");break;case 33:case 545:{V.push(De);var Ae=encode_cell(De[0].s);if(M=S.dense?(w[De[0].s.r]||[])[De[0].s.c]:w[Ae],S.cellFormula&&M){if(!O||!Ae||!M)break;M.f=""+stringify_formula(De[1],A,De[0],K,ee),M.F=encode_range(De[0])}}break;case 1212:{if(!S.cellFormula)break;if(I){if(!O)break;G[encode_cell(O.cell)]=De[0],M=S.dense?(w[O.cell.r]||[])[O.cell.c]:w[encode_cell(O.cell)],(M||{}).f=""+stringify_formula(De[0],A,D,K,ee)}}break;case 253:j=make_cell(R[De.isst].t,De.ixfe,"s"),R[De.isst].h&&(j.h=R[De.isst].h),j.XF=U[j.ixfe],ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:De.c,r:De.r},j,S);break;case 513:S.sheetStubs&&(j={ixfe:De.ixfe,XF:U[De.ixfe],t:"z"},ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:De.c,r:De.r},j,S));break;case 190:if(S.sheetStubs)for(var Oe=De.c;Oe<=De.C;++Oe){var Fe=De.ixfe[Oe-De.c];j={ixfe:Fe,XF:U[Fe],t:"z"},ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:Oe,r:De.r},j,S)}break;case 214:case 516:case 4:j=make_cell(De.val,De.ixfe,"s"),j.XF=U[j.ixfe],ce>0&&(j.z=_e[j.ixfe>>8&63]),safe_format_xf(j,S,T.opts.Date1904),Q({c:De.c,r:De.r},j,S);break;case 0:case 512:le===1&&(A=De);break;case 252:R=De;break;case 1054:if(ee.biff==4){_e[ce++]=De[1];for(var nt=0;nt<ce+163&&table_fmt[nt]!=De[1];++nt);nt>=163&&SSF_load(De[1],ce+163)}else SSF_load(De[1],De[0]);break;case 30:{_e[ce++]=De;for(var Ze=0;Ze<ce+163&&table_fmt[Ze]!=De;++Ze);Ze>=163&&SSF_load(De,ce+163)}break;case 229:re=re.concat(De);break;case 93:ie[De.cmo[0]]=ee.lastobj=De;break;case 438:ee.lastobj.TxO=De;break;case 127:ee.lastobj.ImData=De;break;case 440:for(F=De[0].s.r;F<=De[0].e.r;++F)for(k=De[0].s.c;k<=De[0].e.c;++k)M=S.dense?(w[F]||[])[k]:w[encode_cell({c:k,r:F})],M&&(M.l=De[1]);break;case 2048:for(F=De[0].s.r;F<=De[0].e.r;++F)for(k=De[0].s.c;k<=De[0].e.c;++k)M=S.dense?(w[F]||[])[k]:w[encode_cell({c:k,r:F})],M&&M.l&&(M.l.Tooltip=De[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;M=S.dense?(w[De[0].r]||[])[De[0].c]:w[encode_cell(De[0])];var Xe=ie[De[2]];M||(S.dense?(w[De[0].r]||(w[De[0].r]=[]),M=w[De[0].r][De[0].c]={t:"z"}):M=w[encode_cell(De[0])]={t:"z"},A.e.r=Math.max(A.e.r,De[0].r),A.s.r=Math.min(A.s.r,De[0].r),A.e.c=Math.max(A.e.c,De[0].c),A.s.c=Math.min(A.s.c,De[0].c)),M.c||(M.c=[]),N={a:De[1],t:Xe.TxO.t},M.c.push(N)}break;case 2173:update_xfext(U[De.ixfe],De.ext);break;case 125:{if(!ee.cellStyles)break;for(;De.e>=De.s;)ne[De.e--]={width:De.w/256,level:De.level||0,hidden:!!(De.flags&1)},pe||(pe=!0,find_mdw_colw(De.w/256)),process_col(ne[De.e+1])}break;case 520:{var $e={};De.level!=null&&(he[De.r]=$e,$e.level=De.level),De.hidden&&(he[De.r]=$e,$e.hidden=!0),De.hpt&&(he[De.r]=$e,$e.hpt=De.hpt,$e.hpx=pt2px(De.hpt))}break;case 38:case 39:case 40:case 41:w["!margins"]||default_margins(w["!margins"]={}),w["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=De;break;case 161:w["!margins"]||default_margins(w["!margins"]={}),w["!margins"].header=De.header,w["!margins"].footer=De.footer;break;case 574:De.RTL&&(Y.Views[0].RTL=!0);break;case 146:X=De;break;case 2198:te=De;break;case 140:H=De;break;case 442:P?z.CodeName=De||z.name:Y.WBProps.CodeName=De||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),L.l+=we}return T.SheetNames=keys(B).sort(function(ot,ut){return Number(ot)-Number(ut)}).map(function(ot){return B[ot].name}),S.bookSheets||(T.Sheets=_),!T.SheetNames.length&&E["!ref"]?(T.SheetNames.push("Sheet1"),T.Sheets&&(T.Sheets.Sheet1=E)):T.Preamble=E,T.Sheets&&oe.forEach(function(ot,ut){T.Sheets[T.SheetNames[ut]]["!autofilter"]=ot}),T.Strings=R,T.SSF=dup(table_fmt),ee.enc&&(T.Encryption=ee.enc),te&&(T.Themes=te),T.Metadata={},H!==void 0&&(T.Metadata.Country=H),K.names.length>0&&(Y.Names=K.names),T.Workbook=Y,T}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(L,S,T){var _=CFB.find(L,"/!DocumentSummaryInformation");if(_&&_.size>0)try{var w=parse_PropertySetStream(_,DocSummaryPIDDSI,PSCLSID.DSI);for(var B in w)S[B]=w[B]}catch(P){if(T.WTF)throw P}var A=CFB.find(L,"/!SummaryInformation");if(A&&A.size>0)try{var O=parse_PropertySetStream(A,SummaryPIDSI,PSCLSID.SI);for(var R in O)S[R]==null&&(S[R]=O[R])}catch(P){if(T.WTF)throw P}S.HeadingPairs&&S.TitlesOfParts&&(load_props_pairs(S.HeadingPairs,S.TitlesOfParts,S,T),delete S.HeadingPairs,delete S.TitlesOfParts)}function parse_xlscfb(L,S){S||(S={}),fix_read_opts(S),reset_cp(),S.codepage&&set_ansi(S.codepage);var T,_;if(L.FullPaths){if(CFB.find(L,"/encryption"))throw new Error("File is password-protected");T=CFB.find(L,"!CompObj"),_=CFB.find(L,"/Workbook")||CFB.find(L,"/Book")}else{switch(S.type){case"base64":L=s2a(Base64_decode(L));break;case"binary":L=s2a(L);break;case"buffer":break;case"array":Array.isArray(L)||(L=Array.prototype.slice.call(L));break}prep_blob(L,0),_={content:L}}var w,B;if(T&&parse_compobj(T),S.bookProps&&!S.bookSheets)w={};else{var A=has_buf?"buffer":"array";if(_&&_.content)w=parse_workbook(_.content,S);else if((B=CFB.find(L,"PerfectOffice_MAIN"))&&B.content)w=WK_.to_workbook(B.content,(S.type=A,S));else if((B=CFB.find(L,"NativeContent_MAIN"))&&B.content)w=WK_.to_workbook(B.content,(S.type=A,S));else throw(B=CFB.find(L,"MN0"))&&B.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");S.bookVBA&&L.FullPaths&&CFB.find(L,"/_VBA_PROJECT_CUR/VBA/dir")&&(w.vbaraw=make_vba_xls(L))}var O={};return L.FullPaths&&parse_xls_props(L,O,S),w.Props=w.Custprops=O,S.bookFiles&&(w.cfb=L),w}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(L,S,T,_){var w=S;if(!isNaN(w)){var B=(T||[]).length||0,A=L.next(4);A.write_shift(2,w),A.write_shift(2,B),B>0&&is_buf(T)&&L.push(T)}}function html_to_sheet(L,S){var T=S||{},_=T.dense?[]:{};L=L.replace(/<!--.*?-->/g,"");var w=L.match(/<table/i);if(!w)throw new Error("Invalid HTML: could not find <table>");var B=L.match(/<\/table/i),A=w.index,O=B&&B.index||L.length,R=split_regex(L.slice(A,O),/(:?<tr[^>]*>)/i,"<tr>"),P=-1,E=0,D=0,I=0,M={s:{r:1e7,c:1e7},e:{r:0,c:0}},N=[];for(A=0;A<R.length;++A){var k=R[A].trim(),F=k.slice(0,3).toLowerCase();if(F=="<tr"){if(++P,T.sheetRows&&T.sheetRows<=P){--P;break}E=0;continue}if(!(F!="<td"&&F!="<th")){var G=k.split(/<\/t[dh]>/i);for(O=0;O<G.length;++O){var V=G[O].trim();if(V.match(/<t[dh]/i)){for(var j=V,H=0;j.charAt(0)=="<"&&(H=j.indexOf(">"))>-1;)j=j.slice(H+1);for(var U=0;U<N.length;++U){var X=N[U];X.s.c==E&&X.s.r<P&&P<=X.e.r&&(E=X.e.c+1,U=-1)}var Y=parsexmltag(V.slice(0,V.indexOf(">")));I=Y.colspan?+Y.colspan:1,((D=+Y.rowspan)>1||I>1)&&N.push({s:{r:P,c:E},e:{r:P+(D||1)-1,c:E+I-1}});var z=Y.t||Y["data-t"]||"";if(!j.length){E+=I;continue}if(j=htmldecode(j),M.s.r>P&&(M.s.r=P),M.e.r<P&&(M.e.r=P),M.s.c>E&&(M.s.c=E),M.e.c<E&&(M.e.c=E),!j.length){E+=I;continue}var W={t:"s",v:j};T.raw||!j.trim().length||z=="s"||(j==="TRUE"?W={t:"b",v:!0}:j==="FALSE"?W={t:"b",v:!1}:isNaN(fuzzynum(j))?isNaN(fuzzydate(j).getDate())||(W={t:"d",v:parseDate(j)},T.cellDates||(W={t:"n",v:datenum(W.v)}),W.z=T.dateNF||table_fmt[14]):W={t:"n",v:fuzzynum(j)}),T.dense?(_[P]||(_[P]=[]),_[P][E]=W):_[encode_cell({r:P,c:E})]=W,E+=I}}}}return _["!ref"]=encode_range(M),N.length&&(_["!merges"]=N),_}function make_html_row(L,S,T,_){for(var w=L["!merges"]||[],B=[],A=S.s.c;A<=S.e.c;++A){for(var O=0,R=0,P=0;P<w.length;++P)if(!(w[P].s.r>T||w[P].s.c>A)&&!(w[P].e.r<T||w[P].e.c<A)){if(w[P].s.r<T||w[P].s.c<A){O=-1;break}O=w[P].e.r-w[P].s.r+1,R=w[P].e.c-w[P].s.c+1;break}if(!(O<0)){var E=encode_cell({r:T,c:A}),D=_.dense?(L[T]||[])[A]:L[E],I=D&&D.v!=null&&(D.h||escapehtml(D.w||(format_cell(D),D.w)||""))||"",M={};O>1&&(M.rowspan=O),R>1&&(M.colspan=R),_.editable?I='<span contenteditable="true">'+I+"</span>":D&&(M["data-t"]=D&&D.t||"z",D.v!=null&&(M["data-v"]=D.v),D.z!=null&&(M["data-z"]=D.z),D.l&&(D.l.Target||"#").charAt(0)!="#"&&(I='<a href="'+D.l.Target+'">'+I+"</a>")),M.id=(_.id||"sjs")+"-"+E,B.push(writextag("td",I,M))}}var N="<tr>";return N+B.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(L,S){var T=L.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!T||T.length==0)throw new Error("Invalid HTML: could not find <table>");if(T.length==1)return sheet_to_workbook(html_to_sheet(T[0],S),S);var _=book_new();return T.forEach(function(w,B){book_append_sheet(_,html_to_sheet(w,S),"Sheet"+(B+1))}),_}function make_html_preamble(L,S,T){var _=[];return _.join("")+"<table"+(T&&T.id?' id="'+T.id+'"':"")+">"}function sheet_to_html(L,S){var T=S||{},_=T.header!=null?T.header:HTML_BEGIN,w=T.footer!=null?T.footer:HTML_END,B=[_],A=decode_range(L["!ref"]);T.dense=Array.isArray(L),B.push(make_html_preamble(L,A,T));for(var O=A.s.r;O<=A.e.r;++O)B.push(make_html_row(L,A,O,T));return B.push("</table>"+w),B.join("")}function sheet_add_dom(L,S,T){var _=T||{},w=0,B=0;if(_.origin!=null)if(typeof _.origin=="number")w=_.origin;else{var A=typeof _.origin=="string"?decode_cell(_.origin):_.origin;w=A.r,B=A.c}var O=S.getElementsByTagName("tr"),R=Math.min(_.sheetRows||1e7,O.length),P={s:{r:0,c:0},e:{r:w,c:B}};if(L["!ref"]){var E=decode_range(L["!ref"]);P.s.r=Math.min(P.s.r,E.s.r),P.s.c=Math.min(P.s.c,E.s.c),P.e.r=Math.max(P.e.r,E.e.r),P.e.c=Math.max(P.e.c,E.e.c),w==-1&&(P.e.r=w=E.e.r+1)}var D=[],I=0,M=L["!rows"]||(L["!rows"]=[]),N=0,k=0,F=0,G=0,V=0,j=0;for(L["!cols"]||(L["!cols"]=[]);N<O.length&&k<R;++N){var H=O[N];if(is_dom_element_hidden(H)){if(_.display)continue;M[k]={hidden:!0}}var U=H.children;for(F=G=0;F<U.length;++F){var X=U[F];if(!(_.display&&is_dom_element_hidden(X))){var Y=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):htmldecode(X.innerHTML),z=X.getAttribute("data-z")||X.getAttribute("z");for(I=0;I<D.length;++I){var W=D[I];W.s.c==G+B&&W.s.r<k+w&&k+w<=W.e.r&&(G=W.e.c+1-B,I=-1)}j=+X.getAttribute("colspan")||1,((V=+X.getAttribute("rowspan")||1)>1||j>1)&&D.push({s:{r:k+w,c:G+B},e:{r:k+w+(V||1)-1,c:G+B+(j||1)-1}});var Z={t:"s",v:Y},Q=X.getAttribute("data-t")||X.getAttribute("t")||"";Y!=null&&(Y.length==0?Z.t=Q||"z":_.raw||Y.trim().length==0||Q=="s"||(Y==="TRUE"?Z={t:"b",v:!0}:Y==="FALSE"?Z={t:"b",v:!1}:isNaN(fuzzynum(Y))?isNaN(fuzzydate(Y).getDate())||(Z={t:"d",v:parseDate(Y)},_.cellDates||(Z={t:"n",v:datenum(Z.v)}),Z.z=_.dateNF||table_fmt[14]):Z={t:"n",v:fuzzynum(Y)})),Z.z===void 0&&z!=null&&(Z.z=z);var ee="",te=X.getElementsByTagName("A");if(te&&te.length)for(var re=0;re<te.length&&!(te[re].hasAttribute("href")&&(ee=te[re].getAttribute("href"),ee.charAt(0)!="#"));++re);ee&&ee.charAt(0)!="#"&&(Z.l={Target:ee}),_.dense?(L[k+w]||(L[k+w]=[]),L[k+w][G+B]=Z):L[encode_cell({c:G+B,r:k+w})]=Z,P.e.c<G+B&&(P.e.c=G+B),G+=j}}++k}return D.length&&(L["!merges"]=(L["!merges"]||[]).concat(D)),P.e.r=Math.max(P.e.r,k-1+w),L["!ref"]=encode_range(P),k>=R&&(L["!fullref"]=encode_range((P.e.r=O.length-N+k-1+w,P))),L}function parse_dom_table(L,S){var T=S||{},_=T.dense?[]:{};return sheet_add_dom(_,L,S)}function table_to_book(L,S){return sheet_to_workbook(parse_dom_table(L,S),S)}function is_dom_element_hidden(L){var S="",T=get_get_computed_style_function(L);return T&&(S=T(L).getPropertyValue("display")),S||(S=L.style&&L.style.display),S==="none"}function get_get_computed_style_function(L){return L.ownerDocument.defaultView&&typeof L.ownerDocument.defaultView.getComputedStyle=="function"?L.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(L){var S=L.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(_,w){return Array(parseInt(w,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,"\n"),T=unescapexml(S.replace(/<[^>]*>/g,""));return[T]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(L,S){var T=S||{},_=xlml_normalize(L),w=[],B,A,O={name:""},R="",P=0,E,D,I={},M=[],N=T.dense?[]:{},k,F,G={value:""},V="",j=0,H=[],U=-1,X=-1,Y={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,W={},Z=[],Q={},ee=0,te=0,re=[],ie=1,ne=1,he=[],pe={Names:[]},K={},ue=["",""],le=[],ce={},_e="",oe=0,de=!1,me=!1,ye=0;for(xlmlregex.lastIndex=0,_=_.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");k=xlmlregex.exec(_);)switch(k[3]=k[3].replace(/_.*$/,"")){case"table":case"工作表":k[1]==="/"?(Y.e.c>=Y.s.c&&Y.e.r>=Y.s.r?N["!ref"]=encode_range(Y):N["!ref"]="A1:A1",T.sheetRows>0&&T.sheetRows<=Y.e.r&&(N["!fullref"]=N["!ref"],Y.e.r=T.sheetRows-1,N["!ref"]=encode_range(Y)),Z.length&&(N["!merges"]=Z),re.length&&(N["!rows"]=re),E.name=E.名称||E.name,typeof JSON<"u"&&JSON.stringify(E),M.push(E.name),I[E.name]=N,me=!1):k[0].charAt(k[0].length-2)!=="/"&&(E=parsexmltag(k[0],!1),U=X=-1,Y.s.r=Y.s.c=1e7,Y.e.r=Y.e.c=0,N=T.dense?[]:{},Z=[],re=[],me=!0);break;case"table-row-group":k[1]==="/"?--z:++z;break;case"table-row":case"行":if(k[1]==="/"){U+=ie,ie=1;break}if(D=parsexmltag(k[0],!1),D.行号?U=D.行号-1:U==-1&&(U=0),ie=+D["number-rows-repeated"]||1,ie<10)for(ye=0;ye<ie;++ye)z>0&&(re[U+ye]={level:z});X=-1;break;case"covered-table-cell":k[1]!=="/"&&++X,T.sheetStubs&&(T.dense?(N[U]||(N[U]=[]),N[U][X]={t:"z"}):N[encode_cell({r:U,c:X})]={t:"z"}),V="",H=[];break;case"table-cell":case"数据":if(k[0].charAt(k[0].length-2)==="/")++X,G=parsexmltag(k[0],!1),ne=parseInt(G["number-columns-repeated"]||"1",10),F={t:"z",v:null},G.formula&&T.cellFormula!=!1&&(F.f=ods_to_csf_formula(unescapexml(G.formula))),(G.数据类型||G["value-type"])=="string"&&(F.t="s",F.v=unescapexml(G["string-value"]||""),T.dense?(N[U]||(N[U]=[]),N[U][X]=F):N[encode_cell({r:U,c:X})]=F),X+=ne-1;else if(k[1]!=="/"){++X,V="",j=0,H=[],ne=1;var ge=ie?U+ie-1:U;if(X>Y.e.c&&(Y.e.c=X),X<Y.s.c&&(Y.s.c=X),U<Y.s.r&&(Y.s.r=U),ge>Y.e.r&&(Y.e.r=ge),G=parsexmltag(k[0],!1),le=[],ce={},F={t:G.数据类型||G["value-type"],v:null},T.cellFormula)if(G.formula&&(G.formula=unescapexml(G.formula)),G["number-matrix-columns-spanned"]&&G["number-matrix-rows-spanned"]&&(ee=parseInt(G["number-matrix-rows-spanned"],10)||0,te=parseInt(G["number-matrix-columns-spanned"],10)||0,Q={s:{r:U,c:X},e:{r:U+ee-1,c:X+te-1}},F.F=encode_range(Q),he.push([Q,F.F])),G.formula)F.f=ods_to_csf_formula(G.formula);else for(ye=0;ye<he.length;++ye)U>=he[ye][0].s.r&&U<=he[ye][0].e.r&&X>=he[ye][0].s.c&&X<=he[ye][0].e.c&&(F.F=he[ye][1]);switch((G["number-columns-spanned"]||G["number-rows-spanned"])&&(ee=parseInt(G["number-rows-spanned"],10)||0,te=parseInt(G["number-columns-spanned"],10)||0,Q={s:{r:U,c:X},e:{r:U+ee-1,c:X+te-1}},Z.push(Q)),G["number-columns-repeated"]&&(ne=parseInt(G["number-columns-repeated"],10)),F.t){case"boolean":F.t="b",F.v=parsexmlbool(G["boolean-value"]);break;case"float":F.t="n",F.v=parseFloat(G.value);break;case"percentage":F.t="n",F.v=parseFloat(G.value);break;case"currency":F.t="n",F.v=parseFloat(G.value);break;case"date":F.t="d",F.v=parseDate(G["date-value"]),T.cellDates||(F.t="n",F.v=datenum(F.v)),F.z="m/d/yy";break;case"time":F.t="n",F.v=parse_isodur(G["time-value"])/86400,T.cellDates&&(F.t="d",F.v=numdate(F.v)),F.z="HH:MM:SS";break;case"number":F.t="n",F.v=parseFloat(G.数据数值);break;default:if(F.t==="string"||F.t==="text"||!F.t)F.t="s",G["string-value"]!=null&&(V=unescapexml(G["string-value"]),H=[]);else throw new Error("Unsupported value type "+F.t)}}else{if(de=!1,F.t==="s"&&(F.v=V||"",H.length&&(F.R=H),de=j==0),K.Target&&(F.l=K),le.length>0&&(F.c=le,le=[]),V&&T.cellText!==!1&&(F.w=V),de&&(F.t="z",delete F.v),(!de||T.sheetStubs)&&!(T.sheetRows&&T.sheetRows<=U))for(var we=0;we<ie;++we){if(ne=parseInt(G["number-columns-repeated"]||"1",10),T.dense)for(N[U+we]||(N[U+we]=[]),N[U+we][X]=we==0?F:dup(F);--ne>0;)N[U+we][X+ne]=dup(F);else for(N[encode_cell({r:U+we,c:X})]=F;--ne>0;)N[encode_cell({r:U+we,c:X+ne})]=dup(F);Y.e.c<=X&&(Y.e.c=X)}ne=parseInt(G["number-columns-repeated"]||"1",10),X+=ne-1,ne=0,F={},V="",H=[]}K={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(k[1]==="/"){if((B=w.pop())[0]!==k[3])throw"Bad state: "+B}else k[0].charAt(k[0].length-2)!=="/"&&w.push([k[3],!0]);break;case"annotation":if(k[1]==="/"){if((B=w.pop())[0]!==k[3])throw"Bad state: "+B;ce.t=V,H.length&&(ce.R=H),ce.a=_e,le.push(ce)}else k[0].charAt(k[0].length-2)!=="/"&&w.push([k[3],!1]);_e="",oe=0,V="",j=0,H=[];break;case"creator":k[1]==="/"?_e=_.slice(oe,k.index):oe=k.index+k[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(k[1]==="/"){if((B=w.pop())[0]!==k[3])throw"Bad state: "+B}else k[0].charAt(k[0].length-2)!=="/"&&w.push([k[3],!1]);V="",j=0,H=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(k[1]==="/"){if(W[O.name]=R,(B=w.pop())[0]!==k[3])throw"Bad state: "+B}else k[0].charAt(k[0].length-2)!=="/"&&(R="",O=parsexmltag(k[0],!1),w.push([k[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(w[w.length-1][0]){case"time-style":case"date-style":A=parsexmltag(k[0],!1),R+=number_formats_ods[k[3]][A.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(w[w.length-1][0]){case"time-style":case"date-style":A=parsexmltag(k[0],!1),R+=number_formats_ods[k[3]][A.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(k[0].slice(-2)==="/>")break;if(k[1]==="/")switch(w[w.length-1][0]){case"number-style":case"date-style":case"time-style":R+=_.slice(P,k.index);break}else P=k.index+k[0].length;break;case"named-range":A=parsexmltag(k[0],!1),ue=ods_to_csf_3D(A["cell-range-address"]);var Te={Name:A.name,Ref:ue[0]+"!"+ue[1]};me&&(Te.Sheet=M.length),pe.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(w[w.length-1][0])>-1)break;if(k[1]==="/"&&(!G||!G["string-value"])){var Ee=parse_text_p(_.slice(j,k.index));V=(V.length>0?V+"\n":"")+Ee[0]}else parsexmltag(k[0],!1),j=k.index+k[0].length;break;case"s":break;case"database-range":if(k[1]==="/")break;try{ue=ods_to_csf_3D(parsexmltag(k[0])["target-range-address"]),I[ue[0]]["!autofilter"]={ref:ue[1]}}catch(fe){}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(k[1]!=="/"){if(K=parsexmltag(k[0],!1),!K.href)break;K.Target=unescapexml(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(ue=ods_to_csf_3D(K.Target.slice(1)),K.Target="#"+ue[0]+"!"+ue[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(k[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(T.WTF)throw new Error(k)}}var De={Sheets:I,SheetNames:M,Workbook:pe};return T.bookSheets&&delete De.Sheets,De}function parse_ods(L,S){S=S||{},safegetzipfile(L,"META-INF/manifest.xml")&&parse_manifest(getzipdata(L,"META-INF/manifest.xml"),S);var T=getzipstr(L,"content.xml");if(!T)throw new Error("Missing content.xml in ODS / UOF file");var _=parse_content_xml(utf8read(T),S);return safegetzipfile(L,"meta.xml")&&(_.Props=parse_core_props(getzipdata(L,"meta.xml"))),_}function parse_fods(L,S){return parse_content_xml(L,S)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(L){return new DataView(L.buffer,L.byteOffset,L.byteLength)}function u8str(L){return typeof TextDecoder<"u"?new TextDecoder().decode(L):utf8read(a2s(L))}function u8concat(L){var S=L.reduce(function(w,B){return w+B.length},0),T=new Uint8Array(S),_=0;return L.forEach(function(w){T.set(w,_),_+=w.length}),T}function popcnt(L){return L-=L>>1&1431655765,L=(L&858993459)+(L>>2&858993459),(L+(L>>4)&252645135)*16843009>>>24}function readDecimal128LE(L,S){for(var T=(L[S+15]&127)<<7|L[S+14]>>1,_=L[S+14]&1,w=S+13;w>=S;--w)_=_*256+L[w];return(L[S+15]&128?-_:_)*Math.pow(10,T-6176)}function parse_varint49(L,S){var T=S?S[0]:0,_=L[T]&127;e:if(L[T++]>=128&&(_|=(L[T]&127)<<7,L[T++]<128||(_|=(L[T]&127)<<14,L[T++]<128)||(_|=(L[T]&127)<<21,L[T++]<128)||(_+=(L[T]&127)*Math.pow(2,28),++T,L[T++]<128)||(_+=(L[T]&127)*Math.pow(2,35),++T,L[T++]<128)||(_+=(L[T]&127)*Math.pow(2,42),++T,L[T++]<128)))break e;return S&&(S[0]=T),_}function varint_to_i32(L){var S=0,T=L[S]&127;e:if(L[S++]>=128){if(T|=(L[S]&127)<<7,L[S++]<128||(T|=(L[S]&127)<<14,L[S++]<128)||(T|=(L[S]&127)<<21,L[S++]<128))break e;T|=(L[S]&127)<<28}return T}function parse_shallow(L){for(var S=[],T=[0];T[0]<L.length;){var _=T[0],w=parse_varint49(L,T),B=w&7;w=Math.floor(w/8);var A=0,O;if(w==0)break;switch(B){case 0:{for(var R=T[0];L[T[0]++]>=128;);O=L.slice(R,T[0])}break;case 5:A=4,O=L.slice(T[0],T[0]+A),T[0]+=A;break;case 1:A=8,O=L.slice(T[0],T[0]+A),T[0]+=A;break;case 2:A=parse_varint49(L,T),O=L.slice(T[0],T[0]+A),T[0]+=A;break;case 3:case 4:default:throw new Error("PB Type ".concat(B," for Field ").concat(w," at offset ").concat(_))}var P={data:O,type:B};S[w]==null?S[w]=[P]:S[w].push(P)}return S}function mappa(L,S){return(L==null?void 0:L.map(function(T){return S(T.data)}))||[]}function parse_iwa_file(L){for(var S,T=[],_=[0];_[0]<L.length;){var w=parse_varint49(L,_),B=parse_shallow(L.slice(_[0],_[0]+w));_[0]+=w;var A={id:varint_to_i32(B[1][0].data),messages:[]};B[2].forEach(function(O){var R=parse_shallow(O.data),P=varint_to_i32(R[3][0].data);A.messages.push({meta:R,data:L.slice(_[0],_[0]+P)}),_[0]+=P}),(S=B[3])!=null&&S[0]&&(A.merge=varint_to_i32(B[3][0].data)>>>0>0),T.push(A)}return T}function parse_snappy_chunk(L,S){if(L!=0)throw new Error("Unexpected Snappy chunk type ".concat(L));for(var T=[0],_=parse_varint49(S,T),w=[];T[0]<S.length;){var B=S[T[0]]&3;if(B==0){var A=S[T[0]++]>>2;if(A<60)++A;else{var O=A-59;A=S[T[0]],O>1&&(A|=S[T[0]+1]<<8),O>2&&(A|=S[T[0]+2]<<16),O>3&&(A|=S[T[0]+3]<<24),A>>>=0,A++,T[0]+=O}w.push(S.slice(T[0],T[0]+A)),T[0]+=A;continue}else{var R=0,P=0;if(B==1?(P=(S[T[0]]>>2&7)+4,R=(S[T[0]++]&224)<<3,R|=S[T[0]++]):(P=(S[T[0]++]>>2)+1,B==2?(R=S[T[0]]|S[T[0]+1]<<8,T[0]+=2):(R=(S[T[0]]|S[T[0]+1]<<8|S[T[0]+2]<<16|S[T[0]+3]<<24)>>>0,T[0]+=4)),w=[u8concat(w)],R==0)throw new Error("Invalid offset 0");if(R>w[0].length)throw new Error("Invalid offset beyond length");if(P>=R)for(w.push(w[0].slice(-R)),P-=R;P>=w[w.length-1].length;)w.push(w[w.length-1]),P-=w[w.length-1].length;w.push(w[0].slice(-R,-R+P))}}var E=u8concat(w);if(E.length!=_)throw new Error("Unexpected length: ".concat(E.length," != ").concat(_));return E}function decompress_iwa_file(L){for(var S=[],T=0;T<L.length;){var _=L[T++],w=L[T]|L[T+1]<<8|L[T+2]<<16;T+=3,S.push(parse_snappy_chunk(_,L.slice(T,T+w))),T+=w}if(T!==L.length)throw new Error("data is not a valid framed stream!");return u8concat(S)}function parse_old_storage(L,S,T,_){var w=u8_to_dataview(L),B=w.getUint32(4,!0),A=(_>1?12:8)+popcnt(B&(_>1?3470:398))*4,O=-1,R=-1,P=NaN,E=new Date(2001,0,1);B&512&&(O=w.getUint32(A,!0),A+=4),A+=popcnt(B&(_>1?12288:4096))*4,B&16&&(R=w.getUint32(A,!0),A+=4),B&32&&(P=w.getFloat64(A,!0),A+=8),B&64&&(E.setTime(E.getTime()+w.getFloat64(A,!0)*1e3),A+=8);var D;switch(L[2]){case 0:break;case 2:D={t:"n",v:P};break;case 3:D={t:"s",v:S[R]};break;case 5:D={t:"d",v:E};break;case 6:D={t:"b",v:P>0};break;case 7:D={t:"n",v:P/86400};break;case 8:D={t:"e",v:0};break;case 9:if(O>-1)D={t:"s",v:T[O]};else if(R>-1)D={t:"s",v:S[R]};else if(!isNaN(P))D={t:"n",v:P};else throw new Error("Unsupported cell type ".concat(L.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(L.slice(0,4)))}return D}function parse_new_storage(L,S,T){var _=u8_to_dataview(L),w=_.getUint32(8,!0),B=12,A=-1,O=-1,R=NaN,P=NaN,E=new Date(2001,0,1);w&1&&(R=readDecimal128LE(L,B),B+=16),w&2&&(P=_.getFloat64(B,!0),B+=8),w&4&&(E.setTime(E.getTime()+_.getFloat64(B,!0)*1e3),B+=8),w&8&&(O=_.getUint32(B,!0),B+=4),w&16&&(A=_.getUint32(B,!0),B+=4);var D;switch(L[1]){case 0:break;case 2:D={t:"n",v:R};break;case 3:D={t:"s",v:S[O]};break;case 5:D={t:"d",v:E};break;case 6:D={t:"b",v:P>0};break;case 7:D={t:"n",v:P/86400};break;case 8:D={t:"e",v:0};break;case 9:if(A>-1)D={t:"s",v:T[A]};else throw new Error("Unsupported cell type ".concat(L[1]," : ").concat(w&31," : ").concat(L.slice(0,4)));break;case 10:D={t:"n",v:R};break;default:throw new Error("Unsupported cell type ".concat(L[1]," : ").concat(w&31," : ").concat(L.slice(0,4)))}return D}function parse_cell_storage(L,S,T){switch(L[0]){case 0:case 1:case 2:case 3:return parse_old_storage(L,S,T,L[0]);case 5:return parse_new_storage(L,S,T);default:throw new Error("Unsupported payload version ".concat(L[0]))}}function parse_TSP_Reference(L){var S=parse_shallow(L);return parse_varint49(S[1][0].data)}function parse_TST_TableDataList(L,S){var T=parse_shallow(S.data),_=varint_to_i32(T[1][0].data),w=T[3],B=[];return(w||[]).forEach(function(A){var O=parse_shallow(A.data),R=varint_to_i32(O[1][0].data)>>>0;switch(_){case 1:B[R]=u8str(O[3][0].data);break;case 8:{var P=L[parse_TSP_Reference(O[9][0].data)][0],E=parse_shallow(P.data),D=L[parse_TSP_Reference(E[1][0].data)][0],I=varint_to_i32(D.meta[1][0].data);if(I!=2001)throw new Error("2000 unexpected reference to ".concat(I));var M=parse_shallow(D.data);B[R]=M[3].map(function(N){return u8str(N.data)}).join("")}break}}),B}function parse_TST_TileRowInfo(L,S){var T,_,w,B,A,O,R,P,E,D,I,M,N,k,F=parse_shallow(L),G=varint_to_i32(F[1][0].data)>>>0,V=varint_to_i32(F[2][0].data)>>>0,j=((_=(T=F[8])==null?void 0:T[0])==null?void 0:_.data)&&varint_to_i32(F[8][0].data)>0||!1,H,U;if((B=(w=F[7])==null?void 0:w[0])!=null&&B.data&&S!=0)H=(O=(A=F[7])==null?void 0:A[0])==null?void 0:O.data,U=(P=(R=F[6])==null?void 0:R[0])==null?void 0:P.data;else if((D=(E=F[4])==null?void 0:E[0])!=null&&D.data&&S!=1)H=(M=(I=F[4])==null?void 0:I[0])==null?void 0:M.data,U=(k=(N=F[3])==null?void 0:N[0])==null?void 0:k.data;else throw"NUMBERS Tile missing ".concat(S," cell storage");for(var X=j?4:1,Y=u8_to_dataview(H),z=[],W=0;W<H.length/2;++W){var Z=Y.getUint16(W*2,!0);Z<65535&&z.push([W,Z])}if(z.length!=V)throw"Expected ".concat(V," cells, found ").concat(z.length);var Q=[];for(W=0;W<z.length-1;++W)Q[z[W][0]]=U.subarray(z[W][1]*X,z[W+1][1]*X);return z.length>=1&&(Q[z[z.length-1][0]]=U.subarray(z[z.length-1][1]*X)),{R:G,cells:Q}}function parse_TST_Tile(L,S){var T,_=parse_shallow(S.data),w=(T=_==null?void 0:_[7])!=null&&T[0]?varint_to_i32(_[7][0].data)>>>0>0?1:0:-1,B=mappa(_[5],function(A){return parse_TST_TileRowInfo(A,w)});return{nrows:varint_to_i32(_[4][0].data)>>>0,data:B.reduce(function(A,O){return A[O.R]||(A[O.R]=[]),O.cells.forEach(function(R,P){if(A[O.R][P])throw new Error("Duplicate cell r=".concat(O.R," c=").concat(P));A[O.R][P]=R}),A},[])}}function parse_TST_TableModelArchive(L,S,T){var _,w=parse_shallow(S.data),B={s:{r:0,c:0},e:{r:0,c:0}};if(B.e.r=(varint_to_i32(w[6][0].data)>>>0)-1,B.e.r<0)throw new Error("Invalid row varint ".concat(w[6][0].data));if(B.e.c=(varint_to_i32(w[7][0].data)>>>0)-1,B.e.c<0)throw new Error("Invalid col varint ".concat(w[7][0].data));T["!ref"]=encode_range(B);var A=parse_shallow(w[4][0].data),O=parse_TST_TableDataList(L,L[parse_TSP_Reference(A[4][0].data)][0]),R=(_=A[17])!=null&&_[0]?parse_TST_TableDataList(L,L[parse_TSP_Reference(A[17][0].data)][0]):[],P=parse_shallow(A[3][0].data),E=0;P[1].forEach(function(D){var I=parse_shallow(D.data),M=L[parse_TSP_Reference(I[2][0].data)][0],N=varint_to_i32(M.meta[1][0].data);if(N!=6002)throw new Error("6001 unexpected reference to ".concat(N));var k=parse_TST_Tile(L,M);k.data.forEach(function(F,G){F.forEach(function(V,j){var H=encode_cell({r:E+G,c:j}),U=parse_cell_storage(V,O,R);U&&(T[H]=U)})}),E+=k.nrows})}function parse_TST_TableInfoArchive(L,S){var T=parse_shallow(S.data),_={"!ref":"A1"},w=L[parse_TSP_Reference(T[2][0].data)],B=varint_to_i32(w[0].meta[1][0].data);if(B!=6001)throw new Error("6000 unexpected reference to ".concat(B));return parse_TST_TableModelArchive(L,w[0],_),_}function parse_TN_SheetArchive(L,S){var T,_=parse_shallow(S.data),w={name:(T=_[1])!=null&&T[0]?u8str(_[1][0].data):"",sheets:[]},B=mappa(_[2],parse_TSP_Reference);return B.forEach(function(A){L[A].forEach(function(O){var R=varint_to_i32(O.meta[1][0].data);R==6e3&&w.sheets.push(parse_TST_TableInfoArchive(L,O))})}),w}function parse_TN_DocumentArchive(L,S){var T=book_new(),_=parse_shallow(S.data),w=mappa(_[1],parse_TSP_Reference);if(w.forEach(function(B){L[B].forEach(function(A){var O=varint_to_i32(A.meta[1][0].data);if(O==2){var R=parse_TN_SheetArchive(L,A);R.sheets.forEach(function(P,E){book_append_sheet(T,P,E==0?R.name:R.name+"_"+E,!0)})}})}),T.SheetNames.length==0)throw new Error("Empty NUMBERS file");return T}function parse_numbers_iwa(L){var S,T,_,w,B={},A=[];if(L.FullPaths.forEach(function(R){if(R.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),L.FileIndex.forEach(function(R){if(R.name.match(/\.iwa$/)){var P;try{P=decompress_iwa_file(R.content)}catch(D){return console.log("?? "+R.content.length+" "+(D.message||D))}var E;try{E=parse_iwa_file(P)}catch(D){return console.log("## "+(D.message||D))}E.forEach(function(D){B[D.id]=D.messages,A.push(D.id)})}}),!A.length)throw new Error("File has no messages");var O=((w=(_=(T=(S=B==null?void 0:B[1])==null?void 0:S[0])==null?void 0:T.meta)==null?void 0:_[1])==null?void 0:w[0].data)&&varint_to_i32(B[1][0].meta[1][0].data)==1&&B[1][0];if(O||A.forEach(function(R){B[R].forEach(function(P){var E=varint_to_i32(P.meta[1][0].data)>>>0;if(E==1)if(!O)O=P;else throw new Error("Document has multiple roots")})}),!O)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(B,O)}function fix_opts_func(L){return function(T){for(var _=0;_!=L.length;++_){var w=L[_];T[w[0]]===void 0&&(T[w[0]]=w[1]),w[2]==="n"&&(T[w[0]]=Number(T[w[0]]))}}}function fix_read_opts(L){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(L)}function get_sheet_type(L){return RELS.WS.indexOf(L)>-1?"sheet":L==RELS.CS?"chart":L==RELS.DS?"dialog":L==RELS.MS?"macro":L&&L.length?L:"sheet"}function safe_parse_wbrels(L,S){if(!L)return 0;try{L=S.map(function(_){return _.id||(_.id=_.strRelID),[_.name,L["!id"][_.id].Target,get_sheet_type(L["!id"][_.id].Type)]})}catch(T){return null}return!L||L.length===0?null:L}function safe_parse_sheet(L,S,T,_,w,B,A,O,R,P,E,D){try{B[_]=parse_rels(getzipstr(L,T,!0),S);var I=getzipdata(L,S),M;switch(O){case"sheet":M=parse_ws(I,S,w,R,B[_],P,E,D);break;case"chart":if(M=parse_cs(I,S,w,R,B[_],P,E,D),!M||!M["!drawel"])break;var N=resolve_path(M["!drawel"].Target,S),k=get_rels_path(N),F=parse_drawing(getzipstr(L,N,!0),parse_rels(getzipstr(L,k,!0),N)),G=resolve_path(F,N),V=get_rels_path(G);M=parse_chart(getzipstr(L,G,!0),G,R,parse_rels(getzipstr(L,V,!0),G),P,M);break;case"macro":M=parse_ms(I,S,w,R,B[_],P,E,D);break;case"dialog":M=parse_ds(I,S,w,R,B[_],P,E,D);break;default:throw new Error("Unrecognized sheet type "+O)}A[_]=M;var j=[];B&&B[_]&&keys(B[_]).forEach(function(H){var U="";if(B[_][H].Type==RELS.CMNT){U=resolve_path(B[_][H].Target,S);var X=parse_cmnt(getzipdata(L,U,!0),U,R);if(!X||!X.length)return;sheet_insert_comments(M,X,!1)}B[_][H].Type==RELS.TCMNT&&(U=resolve_path(B[_][H].Target,S),j=j.concat(parse_tcmnt_xml(getzipdata(L,U,!0),R)))}),j&&j.length&&sheet_insert_comments(M,j,!0,R.people||[])}catch(H){if(R.WTF)throw H}}function strip_front_slash(L){return L.charAt(0)=="/"?L.slice(1):L}function parse_zip(L,S){if(make_ssf(),S=S||{},fix_read_opts(S),safegetzipfile(L,"META-INF/manifest.xml")||safegetzipfile(L,"objectdata.xml"))return parse_ods(L,S);if(safegetzipfile(L,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(L.FileIndex)return parse_numbers_iwa(L);var T=CFB.utils.cfb_new();return zipentries(L).forEach(function(re){zip_add_file(T,re,getzipbin(L,re))}),parse_numbers_iwa(T)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(L,"[Content_Types].xml"))throw safegetzipfile(L,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(L,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var _=zipentries(L),w=parse_ct(getzipstr(L,"[Content_Types].xml")),B=!1,A,O;if(w.workbooks.length===0&&(O="xl/workbook.xml",getzipdata(L,O,!0)&&w.workbooks.push(O)),w.workbooks.length===0){if(O="xl/workbook.bin",!getzipdata(L,O,!0))throw new Error("Could not find workbook");w.workbooks.push(O),B=!0}w.workbooks[0].slice(-3)=="bin"&&(B=!0);var R={},P={};if(!S.bookSheets&&!S.bookProps){if(strs=[],w.sst)try{strs=parse_sst(getzipdata(L,strip_front_slash(w.sst)),w.sst,S)}catch(re){if(S.WTF)throw re}S.cellStyles&&w.themes.length&&(R=parse_theme(getzipstr(L,w.themes[0].replace(/^\//,""),!0)||"",w.themes[0],S)),w.style&&(P=parse_sty(getzipdata(L,strip_front_slash(w.style)),w.style,R,S))}w.links.map(function(re){try{var ie=parse_rels(getzipstr(L,get_rels_path(strip_front_slash(re))),re);return parse_xlink(getzipdata(L,strip_front_slash(re)),ie,re,S)}catch(ne){}});var E=parse_wb(getzipdata(L,strip_front_slash(w.workbooks[0])),w.workbooks[0],S),D={},I="";w.coreprops.length&&(I=getzipdata(L,strip_front_slash(w.coreprops[0]),!0),I&&(D=parse_core_props(I)),w.extprops.length!==0&&(I=getzipdata(L,strip_front_slash(w.extprops[0]),!0),I&&parse_ext_props(I,D,S)));var M={};(!S.bookSheets||S.bookProps)&&w.custprops.length!==0&&(I=getzipstr(L,strip_front_slash(w.custprops[0]),!0),I&&(M=parse_cust_props(I,S)));var N={};if((S.bookSheets||S.bookProps)&&(E.Sheets?A=E.Sheets.map(function(ie){return ie.name}):D.Worksheets&&D.SheetNames.length>0&&(A=D.SheetNames),S.bookProps&&(N.Props=D,N.Custprops=M),S.bookSheets&&typeof A<"u"&&(N.SheetNames=A),S.bookSheets?N.SheetNames:S.bookProps))return N;A={};var k={};S.bookDeps&&w.calcchain&&(k=parse_cc(getzipdata(L,strip_front_slash(w.calcchain)),w.calcchain));var F=0,G={},V,j;{var H=E.Sheets;D.Worksheets=H.length,D.SheetNames=[];for(var U=0;U!=H.length;++U)D.SheetNames[U]=H[U].name}var X=B?"bin":"xml",Y=w.workbooks[0].lastIndexOf("/"),z=(w.workbooks[0].slice(0,Y+1)+"_rels/"+w.workbooks[0].slice(Y+1)+".rels").replace(/^\//,"");safegetzipfile(L,z)||(z="xl/_rels/workbook."+X+".rels");var W=parse_rels(getzipstr(L,z,!0),z.replace(/_rels.*/,"s5s"));(w.metadata||[]).length>=1&&(S.xlmeta=parse_xlmeta(getzipdata(L,strip_front_slash(w.metadata[0])),w.metadata[0],S)),(w.people||[]).length>=1&&(S.people=parse_people_xml(getzipdata(L,strip_front_slash(w.people[0])),S)),W&&(W=safe_parse_wbrels(W,E.Sheets));var Z=getzipdata(L,"xl/worksheets/sheet.xml",!0)?1:0;e:for(F=0;F!=D.Worksheets;++F){var Q="sheet";if(W&&W[F]?(V="xl/"+W[F][1].replace(/[\/]?xl\//,""),safegetzipfile(L,V)||(V=W[F][1]),safegetzipfile(L,V)||(V=z.replace(/_rels\/.*$/,"")+W[F][1]),Q=W[F][2]):(V="xl/worksheets/sheet"+(F+1-Z)+"."+X,V=V.replace(/sheet0\./,"sheet.")),j=V.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),S&&S.sheets!=null)switch(typeof S.sheets){case"number":if(F!=S.sheets)continue e;break;case"string":if(D.SheetNames[F].toLowerCase()!=S.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(S.sheets)){for(var ee=!1,te=0;te!=S.sheets.length;++te)typeof S.sheets[te]=="number"&&S.sheets[te]==F&&(ee=1),typeof S.sheets[te]=="string"&&S.sheets[te].toLowerCase()==D.SheetNames[F].toLowerCase()&&(ee=1);if(!ee)continue e}}safe_parse_sheet(L,V,j,D.SheetNames[F],F,G,A,Q,S,E,R,P)}return N={Directory:w,Workbook:E,Props:D,Custprops:M,Deps:k,Sheets:A,SheetNames:D.SheetNames,Strings:strs,Styles:P,Themes:R,SSF:dup(table_fmt)},S&&S.bookFiles&&(L.files?(N.keys=_,N.files=L.files):(N.keys=[],N.files={},L.FullPaths.forEach(function(re,ie){re=re.replace(/^Root Entry[\/]/,""),N.keys.push(re),N.files[re]=L.FileIndex[ie]}))),S&&S.bookVBA&&(w.vba.length>0?N.vbaraw=getzipdata(L,strip_front_slash(w.vba[0]),!0):w.defaults&&w.defaults.bin===CT_VBA&&(N.vbaraw=getzipdata(L,"xl/vbaProject.bin",!0))),N}function parse_xlsxcfb(L,S){var T=S||{},_="Workbook",w=CFB.find(L,_);try{if(_="/!DataSpaces/Version",w=CFB.find(L,_),!w||!w.content)throw new Error("ECMA-376 Encrypted file missing "+_);if(parse_DataSpaceVersionInfo(w.content),_="/!DataSpaces/DataSpaceMap",w=CFB.find(L,_),!w||!w.content)throw new Error("ECMA-376 Encrypted file missing "+_);var B=parse_DataSpaceMap(w.content);if(B.length!==1||B[0].comps.length!==1||B[0].comps[0].t!==0||B[0].name!=="StrongEncryptionDataSpace"||B[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+_);if(_="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",w=CFB.find(L,_),!w||!w.content)throw new Error("ECMA-376 Encrypted file missing "+_);var A=parse_DataSpaceDefinition(w.content);if(A.length!=1||A[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+_);if(_="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",w=CFB.find(L,_),!w||!w.content)throw new Error("ECMA-376 Encrypted file missing "+_);parse_Primary(w.content)}catch(R){}if(_="/EncryptionInfo",w=CFB.find(L,_),!w||!w.content)throw new Error("ECMA-376 Encrypted file missing "+_);var O=parse_EncryptionInfo(w.content);if(_="/EncryptedPackage",w=CFB.find(L,_),!w||!w.content)throw new Error("ECMA-376 Encrypted file missing "+_);if(O[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(O[1],w.content,T.password||"",T);if(O[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(O[1],w.content,T.password||"",T);throw new Error("File is password-protected")}function firstbyte(L,S){var T="";switch((S||{}).type||"base64"){case"buffer":return[L[0],L[1],L[2],L[3],L[4],L[5],L[6],L[7]];case"base64":T=Base64_decode(L.slice(0,12));break;case"binary":T=L;break;case"array":return[L[0],L[1],L[2],L[3],L[4],L[5],L[6],L[7]];default:throw new Error("Unrecognized type "+(S&&S.type||"undefined"))}return[T.charCodeAt(0),T.charCodeAt(1),T.charCodeAt(2),T.charCodeAt(3),T.charCodeAt(4),T.charCodeAt(5),T.charCodeAt(6),T.charCodeAt(7)]}function read_cfb(L,S){return CFB.find(L,"EncryptedPackage")?parse_xlsxcfb(L,S):parse_xlscfb(L,S)}function read_zip(L,S){var T,_=L,w=S||{};return w.type||(w.type=has_buf&&Buffer.isBuffer(L)?"buffer":"base64"),T=zip_read(_,w),parse_zip(T,w)}function read_plaintext(L,S){var T=0;e:for(;T<L.length;)switch(L.charCodeAt(T)){case 10:case 13:case 32:++T;break;case 60:return parse_xlml(L.slice(T),S);default:break e}return PRN.to_workbook(L,S)}function read_plaintext_raw(L,S){var T="",_=firstbyte(L,S);switch(S.type){case"base64":T=Base64_decode(L);break;case"binary":T=L;break;case"buffer":T=L.toString("binary");break;case"array":T=cc2str(L);break;default:throw new Error("Unrecognized type "+S.type)}return _[0]==239&&_[1]==187&&_[2]==191&&(T=utf8read(T)),S.type="binary",read_plaintext(T,S)}function read_utf16(L,S){var T=L;return S.type=="base64"&&(T=Base64_decode(T)),T=$cptable.utils.decode(1200,T.slice(2),"str"),S.type="binary",read_plaintext(T,S)}function bstrify(L){return L.match(/[^\x00-\x7F]/)?utf8write(L):L}function read_prn(L,S,T,_){return _?(T.type="string",PRN.to_workbook(L,T)):PRN.to_workbook(S,T)}function readSync(L,S){reset_cp();var T=S||{};if(typeof ArrayBuffer<"u"&&L instanceof ArrayBuffer)return readSync(new Uint8Array(L),(T=dup(T),T.type="array",T));typeof Uint8Array<"u"&&L instanceof Uint8Array&&!T.type&&(T.type=typeof Deno<"u"?"buffer":"array");var _=L,w=[0,0,0,0],B=!1;if(T.cellStyles&&(T.cellNF=!0,T.sheetStubs=!0),_ssfopts={},T.dateNF&&(_ssfopts.dateNF=T.dateNF),T.type||(T.type=has_buf&&Buffer.isBuffer(L)?"buffer":"base64"),T.type=="file"&&(T.type=has_buf?"buffer":"binary",_=read_binary(L),typeof Uint8Array<"u"&&!has_buf&&(T.type="array")),T.type=="string"&&(B=!0,T.type="binary",T.codepage=65001,_=bstrify(L)),T.type=="array"&&typeof Uint8Array<"u"&&L instanceof Uint8Array&&typeof ArrayBuffer<"u"){var A=new ArrayBuffer(3),O=new Uint8Array(A);if(O.foo="bar",!O.foo)return T=dup(T),T.type="array",readSync(ab2a(_),T)}switch((w=firstbyte(_,T))[0]){case 208:if(w[1]===207&&w[2]===17&&w[3]===224&&w[4]===161&&w[5]===177&&w[6]===26&&w[7]===225)return read_cfb(CFB.read(_,T),T);break;case 9:if(w[1]<=8)return parse_xlscfb(_,T);break;case 60:return parse_xlml(_,T);case 73:if(w[1]===73&&w[2]===42&&w[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(w[1]===68)return read_wb_ID(_,T);break;case 84:if(w[1]===65&&w[2]===66&&w[3]===76)return DIF.to_workbook(_,T);break;case 80:return w[1]===75&&w[2]<9&&w[3]<9?read_zip(_,T):read_prn(L,_,T,B);case 239:return w[3]===60?parse_xlml(_,T):read_prn(L,_,T,B);case 255:if(w[1]===254)return read_utf16(_,T);if(w[1]===0&&w[2]===2&&w[3]===0)return WK_.to_workbook(_,T);break;case 0:if(w[1]===0&&(w[2]>=2&&w[3]===0||w[2]===0&&(w[3]===8||w[3]===9)))return WK_.to_workbook(_,T);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(_,T);case 123:if(w[1]===92&&w[2]===114&&w[3]===116)return RTF.to_workbook(_,T);break;case 10:case 13:case 32:return read_plaintext_raw(_,T);case 137:if(w[1]===80&&w[2]===78&&w[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(w[0])>-1&&w[2]<=12&&w[3]<=31?DBF.to_workbook(_,T):read_prn(L,_,T,B)}function make_json_row(L,S,T,_,w,B,A,O){var R=encode_row(T),P=O.defval,E=O.raw||!Object.prototype.hasOwnProperty.call(O,"raw"),D=!0,I=w===1?[]:{};if(w!==1)if(Object.defineProperty)try{Object.defineProperty(I,"__rowNum__",{value:T,enumerable:!1})}catch(F){I.__rowNum__=T}else I.__rowNum__=T;if(!A||L[T])for(var M=S.s.c;M<=S.e.c;++M){var N=A?L[T][M]:L[_[M]+R];if(N===void 0||N.t===void 0){if(P===void 0)continue;B[M]!=null&&(I[B[M]]=P);continue}var k=N.v;switch(N.t){case"z":if(k==null)break;continue;case"e":k=k==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+N.t)}if(B[M]!=null){if(k==null)if(N.t=="e"&&k===null)I[B[M]]=null;else if(P!==void 0)I[B[M]]=P;else if(E&&k===null)I[B[M]]=null;else continue;else I[B[M]]=E&&(N.t!=="n"||N.t==="n"&&O.rawNumbers!==!1)?k:format_cell(N,k,O);k!=null&&(D=!1)}}return{row:I,isempty:D}}function sheet_to_json(L,S){if(L==null||L["!ref"]==null)return[];var T={t:"n",v:0},_=0,w=1,B=[],A=0,O="",R={s:{r:0,c:0},e:{r:0,c:0}},P=S||{},E=P.range!=null?P.range:L["!ref"];switch(P.header===1?_=1:P.header==="A"?_=2:Array.isArray(P.header)?_=3:P.header==null&&(_=0),typeof E){case"string":R=safe_decode_range(E);break;case"number":R=safe_decode_range(L["!ref"]),R.s.r=E;break;default:R=E}_>0&&(w=0);var D=encode_row(R.s.r),I=[],M=[],N=0,k=0,F=Array.isArray(L),G=R.s.r,V=0,j={};F&&!L[G]&&(L[G]=[]);var H=P.skipHidden&&L["!cols"]||[],U=P.skipHidden&&L["!rows"]||[];for(V=R.s.c;V<=R.e.c;++V)if(!(H[V]||{}).hidden)switch(I[V]=encode_col(V),T=F?L[G][V]:L[I[V]+D],_){case 1:B[V]=V-R.s.c;break;case 2:B[V]=I[V];break;case 3:B[V]=P.header[V-R.s.c];break;default:if(T==null&&(T={w:"__EMPTY",t:"s"}),O=A=format_cell(T,null,P),k=j[A]||0,!k)j[A]=1;else{do O=A+"_"+k++;while(j[O]);j[A]=k,j[O]=1}B[V]=O}for(G=R.s.r+w;G<=R.e.r;++G)if(!(U[G]||{}).hidden){var X=make_json_row(L,R,G,I,_,B,F,P);(X.isempty===!1||(_===1?P.blankrows!==!1:P.blankrows))&&(M[N++]=X.row)}return M.length=N,M}var qreg=/"/g;function make_csv_row(L,S,T,_,w,B,A,O){for(var R=!0,P=[],E="",D=encode_row(T),I=S.s.c;I<=S.e.c;++I)if(_[I]){var M=O.dense?(L[T]||[])[I]:L[_[I]+D];if(M==null)E="";else if(M.v!=null){R=!1,E=""+(O.rawNumbers&&M.t=="n"?M.v:format_cell(M,null,O));for(var N=0,k=0;N!==E.length;++N)if((k=E.charCodeAt(N))===w||k===B||k===34||O.forceQuotes){E='"'+E.replace(qreg,'""')+'"';break}E=="ID"&&(E='"ID"')}else M.f!=null&&!M.F?(R=!1,E="="+M.f,E.indexOf(",")>=0&&(E='"'+E.replace(qreg,'""')+'"')):E="";P.push(E)}return O.blankrows===!1&&R?null:P.join(A)}function sheet_to_csv(L,S){var T=[],_=S==null?{}:S;if(L==null||L["!ref"]==null)return"";var w=safe_decode_range(L["!ref"]),B=_.FS!==void 0?_.FS:",",A=B.charCodeAt(0),O=_.RS!==void 0?_.RS:"\n",R=O.charCodeAt(0),P=new RegExp((B=="|"?"\\|":B)+"+$"),E="",D=[];_.dense=Array.isArray(L);for(var I=_.skipHidden&&L["!cols"]||[],M=_.skipHidden&&L["!rows"]||[],N=w.s.c;N<=w.e.c;++N)(I[N]||{}).hidden||(D[N]=encode_col(N));for(var k=0,F=w.s.r;F<=w.e.r;++F)(M[F]||{}).hidden||(E=make_csv_row(L,w,F,D,A,R,B,_),E!=null&&(_.strip&&(E=E.replace(P,"")),(E||_.blankrows!==!1)&&T.push((k++?O:"")+E)));return delete _.dense,T.join("")}function sheet_to_txt(L,S){S||(S={}),S.FS="	",S.RS="\n";var T=sheet_to_csv(L,S);return T}function sheet_to_formulae(L){var S="",T,_="";if(L==null||L["!ref"]==null)return[];var w=safe_decode_range(L["!ref"]),B="",A=[],O,R=[],P=Array.isArray(L);for(O=w.s.c;O<=w.e.c;++O)A[O]=encode_col(O);for(var E=w.s.r;E<=w.e.r;++E)for(B=encode_row(E),O=w.s.c;O<=w.e.c;++O)if(S=A[O]+B,T=P?(L[E]||[])[O]:L[S],_="",T!==void 0){if(T.F!=null){if(S=T.F,!T.f)continue;_=T.f,S.indexOf(":")==-1&&(S=S+":"+S)}if(T.f!=null)_=T.f;else{if(T.t=="z")continue;if(T.t=="n"&&T.v!=null)_=""+T.v;else if(T.t=="b")_=T.v?"TRUE":"FALSE";else if(T.w!==void 0)_="'"+T.w;else{if(T.v===void 0)continue;T.t=="s"?_="'"+T.v:_=""+T.v}}R[R.length]=S+"="+_}return R}function sheet_add_json(L,S,T){var _=T||{},w=+!_.skipHeader,B=L||{},A=0,O=0;if(B&&_.origin!=null)if(typeof _.origin=="number")A=_.origin;else{var R=typeof _.origin=="string"?decode_cell(_.origin):_.origin;A=R.r,O=R.c}var P,E={s:{c:0,r:0},e:{c:O,r:A+S.length-1+w}};if(B["!ref"]){var D=safe_decode_range(B["!ref"]);E.e.c=Math.max(E.e.c,D.e.c),E.e.r=Math.max(E.e.r,D.e.r),A==-1&&(A=D.e.r+1,E.e.r=A+S.length-1+w)}else A==-1&&(A=0,E.e.r=S.length-1+w);var I=_.header||[],M=0;S.forEach(function(k,F){keys(k).forEach(function(G){(M=I.indexOf(G))==-1&&(I[M=I.length]=G);var V=k[G],j="z",H="",U=encode_cell({c:O+M,r:A+F+w});P=ws_get_cell_stub(B,U),V&&typeof V=="object"&&!(V instanceof Date)?B[U]=V:(typeof V=="number"?j="n":typeof V=="boolean"?j="b":typeof V=="string"?j="s":V instanceof Date?(j="d",_.cellDates||(j="n",V=datenum(V)),H=_.dateNF||table_fmt[14]):V===null&&_.nullError&&(j="e",V=0),P?(P.t=j,P.v=V,delete P.w,delete P.R,H&&(P.z=H)):B[U]=P={t:j,v:V},H&&(P.z=H))})}),E.e.c=Math.max(E.e.c,O+I.length-1);var N=encode_row(A);if(w)for(M=0;M<I.length;++M)B[encode_col(M+O)+N]={t:"s",v:I[M]};return B["!ref"]=encode_range(E),B}function json_to_sheet(L,S){return sheet_add_json(null,L,S)}function ws_get_cell_stub(L,S,T){if(typeof S=="string"){if(Array.isArray(L)){var _=decode_cell(S);return L[_.r]||(L[_.r]=[]),L[_.r][_.c]||(L[_.r][_.c]={t:"z"})}return L[S]||(L[S]={t:"z"})}return typeof S!="number"?ws_get_cell_stub(L,encode_cell(S)):ws_get_cell_stub(L,encode_cell({r:S,c:T||0}))}function wb_sheet_idx(L,S){if(typeof S=="number"){if(S>=0&&L.SheetNames.length>S)return S;throw new Error("Cannot find sheet # "+S)}else if(typeof S=="string"){var T=L.SheetNames.indexOf(S);if(T>-1)return T;throw new Error("Cannot find sheet name |"+S+"|")}else throw new Error("Cannot find sheet |"+S+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(L,S,T,_){var w=1;if(!T)for(;w<=65535&&L.SheetNames.indexOf(T="Sheet"+w)!=-1;++w,T=void 0);if(!T||L.SheetNames.length>=65535)throw new Error("Too many worksheets");if(_&&L.SheetNames.indexOf(T)>=0){var B=T.match(/(^.*?)(\d+)$/);w=B&&+B[2]||0;var A=B&&B[1]||T;for(++w;w<=65535&&L.SheetNames.indexOf(T=A+w)!=-1;++w);}if(check_ws_name(T),L.SheetNames.indexOf(T)>=0)throw new Error("Worksheet with name |"+T+"| already exists!");return L.SheetNames.push(T),L.Sheets[T]=S,T}function book_set_sheet_visibility(L,S,T){L.Workbook||(L.Workbook={}),L.Workbook.Sheets||(L.Workbook.Sheets=[]);var _=wb_sheet_idx(L,S);switch(L.Workbook.Sheets[_]||(L.Workbook.Sheets[_]={}),T){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+T)}L.Workbook.Sheets[_].Hidden=T}function cell_set_number_format(L,S){return L.z=S,L}function cell_set_hyperlink(L,S,T){return S?(L.l={Target:S},T&&(L.l.Tooltip=T)):delete L.l,L}function cell_set_internal_link(L,S,T){return cell_set_hyperlink(L,"#"+S,T)}function cell_add_comment(L,S,T){L.c||(L.c=[]),L.c.push({t:S,a:T||"SheetJS"})}function sheet_set_array_formula(L,S,T,_){for(var w=typeof S!="string"?S:safe_decode_range(S),B=typeof S=="string"?S:encode_range(S),A=w.s.r;A<=w.e.r;++A)for(var O=w.s.c;O<=w.e.c;++O){var R=ws_get_cell_stub(L,A,O);R.t="n",R.F=B,delete R.v,A==w.s.r&&O==w.s.c&&(R.f=T,_&&(R.D=!0))}return L}var utils$1={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const zhString={"Add Node":"添加节点","Add Group":"添加分组","Edit Group":"编辑分组",Clone:"复制",Inputs:"输入",Outputs:"输出",Properties:"参数","Properties Panel":"参数面板",Title:"标题",Mode:"运行模式",Always:"每帧运行","On Event":"事件触发",Never:"从不运行","On Trigger":"通用触发",Resize:"自适应尺寸",Collapse:"折叠",Pin:"固定",Color:"颜色",Colors:"颜色",Shapes:"形状",Remove:"移除",default:"默认",box:"矩形",round:"圆角",card:"卡片","Font size":"标题大小","Rename Slot":"重命名节点","Remove Slot":"移除节点","Disconnect Links":"断开链接","Add Reroute":"添加控制点",Delete:"删除",Expand:"展开",graph:"蓝图",Open:"打开","Close subgraph":"关闭分支蓝图","Align Selected To":"对齐选中节点",Align:"对齐",Top:"顶部",Bottom:"底部",Left:"左边",Right:"右边","Distribute Nodes":"平均分配节点",Vertically:"垂直",Horizontally:"水平",tips:"提示",input:"输入",middle:"中间",output:"输出",objects:"物件",data:"数据",value:"常数",valueString:"文字",button:"按下按键",screen:"触摸屏",phoneSensor:"动作感应",event:"游戏内的变化",controll:"摇杆",controllHorizontal:"摇杆前后",customButton:"自定义按键",touchStart:"触摸开始",touchMove:"触摸移动",touchEnd:"触摸结束",leftOrRightAct:"重力感应",forwardOrbackAct:"前后倾斜",shakeAct:"摇晃",rotationAct:"转动",gameStart:"开始时",objectDestroy:"物体损坏时",calculate:"计算",covert:"转换",angleCalculate:"角度计算",compare:"比较",inRange:"范围内",logic:"逻辑",change:"变化",tool:"工具",mapping:"映射",toint:"取整数",squareRoot:"平方根",abs:"绝对值",revertNegative:"正负反转",dataObject:"数据结构",getKeyValue:"数据取值",angleDifference:"角度差",vectorToAngel:"将位置转换为角度",angleConvertVector:"将角度转换为位置",allRight:"且",orRight:"或",notRight:"非",checkTag:"标记状态",upCount:"计数",timeDown:"倒计时",randomNum:"随机数",sendData:"无线传送发射",acceptData:"无线传送接收",writeNote:"个人备忘录",exportObject:"引用物体",media:"播放媒体",time:"时间控制",game:"游戏控制",other:"其它",bgm:"背景音",sound:"声音",vibrate:"震动",stopTime:"停止时间",timeScale:"时间缩放",restartGame:"重新开始",endGame:"游戏结束",changeGame:"切换游戏",showTextTip:"文字提示",consoleInfo:"输出控制台",showConfirm:"确认框",showHandTip:"触摸提示",blockTouch:"屏蔽触摸",sprite:"绘制图片",animate:"骨骼动画",animates:"动画",tween:"数值动画",bezierCurve:"路径动画",powerOfGod:"神秘力量",objectSensor:"传感器",space:"空间",camera:"照相机",createObject:"物体",destroyObject:"销毁物体",sendObject:"传送物体",gravity:"引力",contact:"接触感应器",destroy:"销毁感应器",position:"位置感应器",speed:"其它感应器",acceleration:"加速度感应器",angle:"角度感应器",angleSpeed:"角速度感应器",connection:"连接零件",layoutEx:"自动布局",girdMap:"格子地图",scrollRect:"滚动视图",group:"物体成组",getData:"获取数据",setData:"记录数据",controllData:"修改数据",handData:"操作数据",bagControll:"背包",friend:"朋友",systemData:"系统数据",screenSize:"屏幕适配",customData:"自定义数据",userData:"玩家数据",addBagGood:"添加物品",useBagGood:"使用物品",getFriend:"获取好友",add:"加",del:"减",x:"乘",chu:"除",length:"长度",equire:"等于",litter:"小于",bigger:"大于",menu:"菜单",startBtn:"运行",previewBtn:"预览",importBtn:"导入",exportBtn:"导出到缓存",downloadBtn:"下载到本地",freshBtn:"刷新",closeViewBtn:"关闭",bigIcon:"大icon显示",hideLine:"隐藏绿线",debugMode:"预览Debug模式 OFF",recordMode:"recordMode",clearBtn:"删除缓存",showFps:"showFps",setting:"设置",customComponent:"脚本组件",inputArr:"输入扩展",outputArr:"输出扩展",outputLine:"输出逻辑线",linkArr:"关联扩展",lighting:"动态赋值",lightingOut:"动态取值",textCode:"js文本"};var Di,Fi,Ii;class InputIndicators{constructor(S){dr(this,Di);dr(this,Fi);dr(this,Ii);this.canvas=S,this.radius=8,this.startAngle=0,this.endAngle=Math.PI*2,this.inactiveColour="#ffffff10",this.colour1="#ff5f00",this.colour2="#00ff7c",this.colour3="#dea7ff",this.fontString="bold 12px Arial",this.enabled=!0,this.shiftDown=!1,this.undoDown=!1,this.redoDown=!1,this.ctrlDown=!1,this.altDown=!1,this.mouse0Down=!1,this.mouse1Down=!1,this.mouse2Down=!1,this.x=0,this.y=0,_r(this,Di,this.onPointerDownOrMove.bind(this)),_r(this,Fi,this.onPointerUp.bind(this)),_r(this,Ii,this.onKeyDownOrUp.bind(this)),this.controller=new AbortController;const{signal:T}=this.controller,_=S.canvas,w={capture:!0,signal:T};_.addEventListener("pointerdown",Ut(this,Di),w),_.addEventListener("pointermove",Ut(this,Di),w),_.addEventListener("pointerup",Ut(this,Fi),w),_.addEventListener("keydown",Ut(this,Ii),w),document.addEventListener("keyup",Ut(this,Ii),w);const B=S.drawFrontCanvas.bind(S);T.addEventListener("abort",()=>{S.drawFrontCanvas=B}),S.drawFrontCanvas=()=>{B(),this.draw()}}onPointerDownOrMove(S){this.mouse0Down=(S.buttons&1)===1,this.mouse1Down=(S.buttons&4)===4,this.mouse2Down=(S.buttons&2)===2,this.x=S.clientX,this.y=S.clientY,this.canvas.setDirty(!0)}onPointerUp(){this.mouse0Down=!1,this.mouse1Down=!1,this.mouse2Down=!1}onKeyDownOrUp(S){this.ctrlDown=S.ctrlKey,this.altDown=S.altKey,this.shiftDown=S.shiftKey,this.undoDown=S.ctrlKey&&S.code==="KeyZ"&&S.type==="keydown",this.redoDown=S.ctrlKey&&S.code==="KeyY"&&S.type==="keydown"}draw(){const{canvas:{ctx:S},radius:T,startAngle:_,endAngle:w,x:B,y:A,inactiveColour:O,colour1:R,colour2:P,colour3:E,fontString:D}=this,{fillStyle:I,font:M}=S,N=B,k=A-80,F=N,G=k-15;S.font=D,U(F+0,G,"Shift",this.shiftDown?R:O),U(F+45,G+20,"Alt",this.altDown?P:O),U(F+30,G,"Control",this.ctrlDown?E:O),U(F-30,G,"↩️",this.undoDown?"#000":"transparent"),U(F+45,G,"↪️",this.redoDown?"#000":"transparent"),S.beginPath(),Y(N,k),Y(N+15,k),Y(N+30,k),S.fillStyle=O,S.fill();const V=this.mouse0Down?R:O,j=this.mouse1Down?P:O,H=this.mouse2Down?E:O;this.mouse0Down&&X(N,k,V),this.mouse1Down&&X(N+15,k,j),this.mouse2Down&&X(N+30,k,H),S.fillStyle=I,S.font=M;function U(z,W,Z,Q){S.fillStyle=Q,S.fillText(Z,z,W)}function X(z,W,Z){S.beginPath(),S.fillStyle=Z,Y(z,W),S.fill()}function Y(z,W){S.arc(z,W,T,_,w)}}dispose(){var S;(S=this.controller)==null||S.abort(),this.controller=void 0}[Symbol.dispose](){this.dispose()}}Di=new WeakMap,Fi=new WeakMap,Ii=new WeakMap;class ContextMenu{constructor(S,T){var M,N,k;this.controller=new AbortController,T||(T={}),this.options=T;const _=T.parentMenu;_&&(_ instanceof ContextMenu?(this.parentMenu=_,this.parentMenu.lock=!0,this.parentMenu.current_submenu=this):(console.error("parentMenu must be of class ContextMenu, ignoring it"),T.parentMenu=void 0),((M=_.options)==null?void 0:M.className)==="dark"&&(T.className="dark"));const w=T.event?T.event.constructor.name:null;w!=="MouseEvent"&&w!=="CustomEvent"&&w!=="PointerEvent"&&(console.error("Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it. (".concat(w,")")),T.event=void 0);const B=document.createElement("div");let A="litegraph litecontextmenu litemenubar-panel";T.className&&(A+=" ".concat(T.className)),B.className=A,B.style.minWidth="100",B.style.minHeight="100",B.style.pointerEvents="none",setTimeout(function(){B.style.pointerEvents="auto"},100);const{signal:O}=this.controller,R={capture:!0,signal:O};if(this.parentMenu||document.addEventListener("pointerdown",F=>{F.target instanceof Node&&!this.containsNode(F.target)&&this.close()},R),B.addEventListener("pointerup",F=>F.preventDefault(),!0),B.addEventListener("contextmenu",F=>{F.button===2&&F.preventDefault()},!0),B.addEventListener("pointerdown",F=>{F.button==2&&(this.close(),F.preventDefault())},!0),this.root=B,T.title){const F=document.createElement("div");F.className="litemenu-title",F.innerHTML=T.title,B.append(F)}for(let F=0;F<S.length;F++){const G=S[F];let V=Array.isArray(S)?G:String(F);typeof V!="string"&&(V=V!=null?V.content===void 0?String(V):V.content:V),this.addItem(V,G,T)}B.addEventListener("pointerenter",function(){B.closing_timer&&clearTimeout(B.closing_timer)});const E=((k=(N=T.event)==null?void 0:N.target)==null?void 0:k.ownerDocument)||document;E.fullscreenElement?E.fullscreenElement.append(B):E.body.append(B);let D=T.left||0,I=T.top||0;if(T.event){if(D=T.event.clientX-10,I=T.event.clientY-10,T.title&&(I-=20),_){const V=_.root.getBoundingClientRect();D=V.left+V.width}const F=document.body.getBoundingClientRect(),G=B.getBoundingClientRect();F.height==0&&console.error("document.body height is 0. That is dangerous, set html,body { height: 100%; }"),F.width&&D>F.width-G.width-10&&(D=F.width-G.width-10),F.height&&I>F.height-G.height-10&&(I=F.height-G.height-10)}B.style.left="".concat(D,"px"),B.style.top="".concat(I,"px"),LiteGraph.context_menu_scaling&&T.scale&&(B.style.transform="scale(".concat(Math.round(T.scale*4)*.25,")"))}containsNode(S,T=new Set){var _;return T.has(this)?!1:(T.add(this),((_=this.current_submenu)==null?void 0:_.containsNode(S,T))||this.root.contains(S))}addItem(S,T,_){var E;_||(_={});const w=document.createElement("div");w.className="litemenu-entry submenu";let B=!1;if(T===null)w.classList.add("separator");else{const D=S===null?"":String(S);typeof T=="string"?w.innerHTML=D:(w.innerHTML=(E=T==null?void 0:T.title)!=null?E:D,T.disabled&&(B=!0,w.classList.add("disabled"),w.setAttribute("aria-disabled","true")),(T.submenu||T.has_submenu)&&(w.classList.add("has_submenu"),w.setAttribute("aria-haspopup","true"),w.setAttribute("aria-expanded","false")),T.className&&(w.className+=" ".concat(T.className))),zhString[w.innerHTML]!=null&&(w.innerHTML=zhString[w.innerHTML]),w.value=T,w.setAttribute("role","menuitem"),typeof T=="function"?(w.dataset.value=String(S),w.onclick_callback=T):w.dataset.value=String(T)}this.root.append(w),B||w.addEventListener("click",P),!B&&_.autoopen&&w.addEventListener("pointerenter",O);const A=()=>{const D=this.root.querySelectorAll("div.litemenu-entry.has_submenu");if(D)for(const I of D)I.setAttribute("aria-expanded","false");w.setAttribute("aria-expanded","true")};function O(D){const I=this.value;!I||!I.has_submenu||(P.call(this,D),A())}const R=this;function P(D){var N;const I=this.value;let M=!0;if((N=R.current_submenu)==null||N.close(D),(I!=null&&I.has_submenu||I!=null&&I.submenu)&&A(),_.callback&&_.callback.call(this,I,_,D,R,_.node)===!0&&(M=!1),typeof I=="object"&&(I.callback&&!_.ignore_item_callbacks&&I.disabled!==!0&&I.callback.call(this,I,_,D,R,_.extra)===!0&&(M=!1),I.submenu)){if(!I.submenu.options)throw"ContextMenu submenu needs options";new R.constructor(I.submenu.options,{callback:I.submenu.callback,event:D,parentMenu:R,ignore_item_callbacks:I.submenu.ignore_item_callbacks,title:I.submenu.title,extra:I.submenu.extra,autoopen:_.autoopen}),M=!1}M&&!R.lock&&R.close()}return w}close(S,T){var _;this.controller.abort(),this.root.remove(),this.parentMenu&&!T&&(this.parentMenu.lock=!1,this.parentMenu.current_submenu=void 0,S===void 0?this.parentMenu.close():S&&!ContextMenu.isCursorOverElement(S,this.parentMenu.root)&&ContextMenu.trigger(this.parentMenu.root,"".concat(LiteGraph.pointerevents_method,"leave"),S)),(_=this.current_submenu)==null||_.close(S,!0),this.root.closing_timer&&clearTimeout(this.root.closing_timer)}static trigger(S,T,_){const w=document.createEvent("CustomEvent");return w.initCustomEvent(T,!0,!0,_),S.dispatchEvent&&S.dispatchEvent(w),w}getTopMenu(){return this.options.parentMenu?this.options.parentMenu.getTopMenu():this}getFirstEvent(){return this.options.parentMenu?this.options.parentMenu.getFirstEvent():this.options.event}static isCursorOverElement(S,T){const _=S.clientX,w=S.clientY,B=T.getBoundingClientRect();return B?w>B.top&&w<B.top+B.height&&_>B.left&&_<B.left+B.width:!1}}var NodeSlotType=(L=>(L[L.INPUT=1]="INPUT",L[L.OUTPUT=2]="OUTPUT",L))(NodeSlotType||{}),RenderShape=(L=>(L[L.BOX=1]="BOX",L[L.ROUND=2]="ROUND",L[L.CIRCLE=3]="CIRCLE",L[L.CARD=4]="CARD",L[L.ARROW=5]="ARROW",L[L.GRID=6]="GRID",L[L.HollowCircle=7]="HollowCircle",L))(RenderShape||{}),CanvasItem=(L=>(L[L.Nothing=0]="Nothing",L[L.Node=1]="Node",L[L.Group=2]="Group",L[L.Reroute=4]="Reroute",L[L.Link=8]="Link",L[L.ResizeSe=16]="ResizeSe",L))(CanvasItem||{}),LinkDirection=(L=>(L[L.NONE=0]="NONE",L[L.UP=1]="UP",L[L.DOWN=2]="DOWN",L[L.LEFT=3]="LEFT",L[L.RIGHT=4]="RIGHT",L[L.CENTER=5]="CENTER",L))(LinkDirection||{}),LinkRenderType=(L=>(L[L.HIDDEN_LINK=-1]="HIDDEN_LINK",L[L.STRAIGHT_LINK=0]="STRAIGHT_LINK",L[L.LINEAR_LINK=1]="LINEAR_LINK",L[L.SPLINE_LINK=2]="SPLINE_LINK",L))(LinkRenderType||{}),LinkMarkerShape=(L=>(L[L.None=0]="None",L[L.Circle=1]="Circle",L[L.Arrow=2]="Arrow",L))(LinkMarkerShape||{}),TitleMode=(L=>(L[L.NORMAL_TITLE=0]="NORMAL_TITLE",L[L.NO_TITLE=1]="NO_TITLE",L[L.TRANSPARENT_TITLE=2]="TRANSPARENT_TITLE",L[L.AUTOHIDE_TITLE=3]="AUTOHIDE_TITLE",L))(TitleMode||{}),LGraphEventMode=(L=>(L[L.ALWAYS=0]="ALWAYS",L[L.ON_EVENT=1]="ON_EVENT",L[L.NEVER=2]="NEVER",L[L.ON_TRIGGER=3]="ON_TRIGGER",L[L.BYPASS=4]="BYPASS",L))(LGraphEventMode||{}),EaseFunction=(L=>(L.LINEAR="linear",L.EASE_IN_QUAD="easeInQuad",L.EASE_OUT_QUAD="easeOutQuad",L.EASE_IN_OUT_QUAD="easeInOutQuad",L))(EaseFunction||{});function distance(L,S){return Math.sqrt((S[0]-L[0])*(S[0]-L[0])+(S[1]-L[1])*(S[1]-L[1]))}function dist2(L,S,T,_){return(T-L)*(T-L)+(_-S)*(_-S)}function isInRectangle(L,S,T,_,w,B){return L>=T&&L<T+w&&S>=_&&S<_+B}function isPointInRect(L,S){return L[0]>=S[0]&&L[0]<S[0]+S[2]&&L[1]>=S[1]&&L[1]<S[1]+S[3]}function isInRect(L,S,T){return L>=T[0]&&L<T[0]+T[2]&&S>=T[1]&&S<T[1]+T[3]}function isInsideRectangle(L,S,T,_,w,B){return T<L&&T+w>L&&_<S&&_+B>S}function isSortaInsideOctagon(L,S,T){return Math.min(T,Math.abs(L))+Math.min(T,Math.abs(S))<T*.75}function overlapBounding(L,S){const T=L[0]+L[2],_=L[1]+L[3],w=S[0]+S[2],B=S[1]+S[3];return!(L[0]>w||L[1]>B||T<S[0]||_<S[1])}function containsCentre(L,S){const T=S[0]+S[2]*.5,_=S[1]+S[3]*.5;return isInRect(T,_,L)}function containsRect(L,S){const T=L[0]+L[2],_=L[1]+L[3],w=S[0]+S[2],B=S[1]+S[3];return!(L[0]===S[0]&&L[1]===S[1]&&T===w&&_===B)&&L[0]<=S[0]&&L[1]<=S[1]&&T>=w&&_>=B}function findPointOnCurve(L,S,T,_,w,B=.5){const A=1-B,O=A*A*A,R=3*(A*A)*B,P=3*A*(B*B),E=B*B*B;L[0]=O*S[0]+R*_[0]+P*w[0]+E*T[0],L[1]=O*S[1]+R*_[1]+P*w[1]+E*T[1]}function createBounds(L,S=10){const T=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const _ of L){const w=_.boundingRect;T[0]=Math.min(T[0],w[0]),T[1]=Math.min(T[1],w[1]),T[2]=Math.max(T[2],w[0]+w[2]),T[3]=Math.max(T[3],w[1]+w[3])}return T.every(_=>isFinite(_))?[T[0]-S,T[1]-S,T[2]-T[0]+2*S,T[3]-T[1]+2*S]:null}function snapPoint(L,S){return S?(L[0]=S*Math.round(L[0]/S),L[1]=S*Math.round(L[1]/S),!0):!1}class CurveEditor{constructor(S){this.points=S,this.selected=-1,this.nearest=-1,this.size=null,this.must_update=!0,this.margin=5}static sampleCurve(S,T){if(T){for(let _=0;_<T.length-1;++_){const w=T[_],B=T[_+1];if(B[0]<S)continue;const A=B[0]-w[0];if(Math.abs(A)<1e-5)return w[1];const O=(S-w[0])/A;return w[1]*(1-O)+B[1]*O}return 0}}draw(S,T,_,w,B,A=!1){const O=this.points;if(!O)return;this.size=T;const R=T[0]-this.margin*2,P=T[1]-this.margin*2;B=B||"#666",S.save(),S.translate(this.margin,this.margin),w&&(S.fillStyle="#111",S.fillRect(0,0,R,P),S.fillStyle="#222",S.fillRect(R*.5,0,1,P),S.strokeStyle="#333",S.strokeRect(0,0,R,P)),S.strokeStyle=B,A&&(S.globalAlpha=.5),S.beginPath();for(const E of O)S.lineTo(E[0]*R,(1-E[1])*P);if(S.stroke(),S.globalAlpha=1,!A)for(const[E,D]of O.entries())S.fillStyle=this.selected==E?"#FFF":this.nearest==E?"#DDD":"#AAA",S.beginPath(),S.arc(D[0]*R,(1-D[1])*P,2,0,Math.PI*2),S.fill();S.restore()}onMouseDown(S,T){const _=this.points;if(!_||S[1]<0)return;if(this.size==null)throw new Error("CurveEditor.size was null or undefined.");const w=this.size[0]-this.margin*2,B=this.size[1]-this.margin*2,A=S[0]-this.margin,O=S[1]-this.margin,R=[A,O],P=30/T.ds.scale;if(this.selected=this.getCloserPoint(R,P),this.selected==-1){const E=[A/w,1-O/B];_.push(E),_.sort(function(D,I){return D[0]-I[0]}),this.selected=_.indexOf(E),this.must_update=!0}if(this.selected!=-1)return!0}onMouseMove(S,T){const _=this.points;if(!_)return;const w=this.selected;if(w<0)return;if(this.size==null)throw new Error("CurveEditor.size was null or undefined.");const B=(S[0]-this.margin)/(this.size[0]-this.margin*2),A=(S[1]-this.margin)/(this.size[1]-this.margin*2),O=[S[0]-this.margin,S[1]-this.margin],R=30/T.ds.scale;this._nearest=this.getCloserPoint(O,R);const P=_[w];if(P){const E=w==0||w==_.length-1;if(!E&&(S[0]<-10||S[0]>this.size[0]+10||S[1]<-10||S[1]>this.size[1]+10)){_.splice(w,1),this.selected=-1;return}E?P[0]=w==0?0:1:P[0]=clamp(B,0,1),P[1]=1-clamp(A,0,1),_.sort(function(D,I){return D[0]-I[0]}),this.selected=_.indexOf(P),this.must_update=!0}}onMouseUp(){return this.selected=-1,!1}getCloserPoint(S,T){const _=this.points;if(!_)return-1;if(T=T||30,this.size==null)throw new Error("CurveEditor.size was null or undefined.");const w=this.size[0]-this.margin*2,B=this.size[1]-this.margin*2,A=_.length,O=[0,0];let R=1e6,P=-1;for(let E=0;E<A;++E){const D=_[E];O[0]=D[0]*w,O[1]=(1-D[1])*B;const I=distance(S,O);I>R||I>T||(P=E,R=I)}return P}}class DragAndScale{get offset(){return this.state.offset}set offset(S){this.state.offset=S}get scale(){return this.state.scale}set scale(S){this.state.scale=S}constructor(S){this.state={offset:new Float32Array([0,0]),scale:1},this.max_scale=10,this.min_scale=.1,this.enabled=!0,this.last_mouse=[0,0],this.visible_area=new Float32Array(4),this.element=S}computeVisibleArea(S){if(!this.element){this.visible_area[0]=this.visible_area[1]=this.visible_area[2]=this.visible_area[3]=0;return}let T=this.element.width,_=this.element.height,w=-this.offset[0],B=-this.offset[1];S&&(w+=S[0]/this.scale,B+=S[1]/this.scale,T=S[2],_=S[3]);const A=w+T/this.scale,O=B+_/this.scale;this.visible_area[0]=w,this.visible_area[1]=B,this.visible_area[2]=A-w,this.visible_area[3]=O-B}toCanvasContext(S){S.scale(this.scale,this.scale),S.translate(this.offset[0],this.offset[1])}convertOffsetToCanvas(S){return[(S[0]+this.offset[0])*this.scale,(S[1]+this.offset[1])*this.scale]}convertCanvasToOffset(S,T){return T=T||[0,0],T[0]=S[0]/this.scale-this.offset[0],T[1]=S[1]/this.scale-this.offset[1],T}mouseDrag(S,T){var _;this.offset[0]+=S/this.scale,this.offset[1]+=T/this.scale,(_=this.onredraw)==null||_.call(this,this)}changeScale(S,T){var R;if(S<this.min_scale?S=this.min_scale:S>this.max_scale&&(S=this.max_scale),S==this.scale||!this.element)return;const _=this.element.getBoundingClientRect();if(!_)return;T=T!=null?T:[_.width*.5,_.height*.5];const w=[T[0]-_.x,T[1]-_.y],B=this.convertCanvasToOffset(w);this.scale=S,Math.abs(this.scale-1)<.01&&(this.scale=1);const A=this.convertCanvasToOffset(w),O=[A[0]-B[0],A[1]-B[1]];this.offset[0]+=O[0],this.offset[1]+=O[1],(R=this.onredraw)==null||R.call(this,this)}changeDeltaScale(S,T){this.changeScale(this.scale*S,T)}animateToBounds(S,T,{duration:_=350,zoom:w=.75,easing:B=EaseFunction.EASE_IN_OUT_QUAD}={}){var W;if(!(_>0))throw new RangeError("Duration must be greater than 0");const A={linear:Z=>Z,easeInQuad:Z=>Z*Z,easeOutQuad:Z=>Z*(2-Z),easeInOutQuad:Z=>Z<.5?2*Z*Z:-1+(4-2*Z)*Z},O=(W=A[B])!=null?W:A.linear,R=performance.now(),P=this.element.width/window.devicePixelRatio,E=this.element.height/window.devicePixelRatio,D=this.offset[0],I=this.offset[1],M=D-P/this.scale,N=I-E/this.scale;let F=this.scale;if(w>0){const Z=w*P/Math.max(S[2],300),Q=w*E/Math.max(S[3],300);F=Math.min(Z,Q,this.max_scale)}const G=P/F,V=E/F,j=-S[0]-S[2]*.5+G*.5,H=-S[1]-S[3]*.5+V*.5,U=j-G,X=H-V,Y=Z=>{const Q=Z-R,ee=Math.min(Q/_,1),te=O(ee),re=D+(j-D)*te,ie=I+(H-I)*te;if(this.offset[0]=re,this.offset[1]=ie,w>0){const ne=M+(U-M)*te,he=N+(X-N)*te,pe=Math.abs(ne-re),K=Math.abs(he-ie);this.scale=Math.min(P/pe,E/K)}T(),ee<1?z=requestAnimationFrame(Y):cancelAnimationFrame(z)};let z=requestAnimationFrame(Y)}reset(){this.scale=1,this.offset[0]=0,this.offset[1]=0}}var SlotType=(L=>(L.Array="array",L[L.Event=-1]="Event",L))(SlotType||{}),SlotShape=(L=>(L[L.Box=RenderShape.BOX]="Box",L[L.Arrow=RenderShape.ARROW]="Arrow",L[L.Grid=RenderShape.GRID]="Grid",L[L.Circle=RenderShape.CIRCLE]="Circle",L[L.HollowCircle=RenderShape.HollowCircle]="HollowCircle",L))(SlotShape||{}),SlotDirection=(L=>(L[L.Up=LinkDirection.UP]="Up",L[L.Right=LinkDirection.RIGHT]="Right",L[L.Down=LinkDirection.DOWN]="Down",L[L.Left=LinkDirection.LEFT]="Left",L))(SlotDirection||{}),LabelPosition=(L=>(L.Left="left",L.Right="right",L))(LabelPosition||{});function strokeShape(L,S,{shape:T=RenderShape.BOX,round_radius:_,title_height:w,title_mode:B=TitleMode.NORMAL_TITLE,color:A,padding:O=6,collapsed:R=!1,lineWidth:P=1}={}){if(_!=null||(_=LiteGraph.ROUND_RADIUS),A!=null||(A=LiteGraph.NODE_BOX_OUTLINE_COLOR),B===TitleMode.TRANSPARENT_TITLE){const F=w!=null?w:LiteGraph.NODE_TITLE_HEIGHT;S[1]-=F,S[3]+=F}const{lineWidth:E,strokeStyle:D}=L;L.lineWidth=P,L.globalAlpha=.8,L.strokeStyle=A,L.beginPath();const[I,M,N,k]=S;switch(T){case RenderShape.BOX:{L.rect(I-O,M-O,N+2*O,k+2*O);break}case RenderShape.ROUND:case RenderShape.CARD:{const F=_+O,V=T===RenderShape.CARD&&R||T===RenderShape.ROUND?[F]:[F,2,F,2];L.roundRect(I-O,M-O,N+2*O,k+2*O,V);break}case RenderShape.CIRCLE:{const F=I+N/2,G=M+k/2,V=Math.max(N,k)/2+O;L.arc(F,G,V,0,Math.PI*2);break}}L.stroke(),L.lineWidth=E,L.strokeStyle=D,L.globalAlpha=1}const zeroUuid="00000000-0000-0000-0000-000000000000",randomStorage=new Uint32Array(31);function createUuidv4(){if(typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();if(typeof(crypto==null?void 0:crypto.getRandomValues)=="function"){const L=crypto.getRandomValues(randomStorage);let S=0;return"10000000-1000-4000-8000-100000000000".replaceAll(/[018]/g,T=>(Number(T)^L[S++]*3725290298461914e-24>>Number(T)*.25).toString(16))}return"10000000-1000-4000-8000-100000000000".replaceAll(/[018]/g,L=>(Number(L)^Math.random()*16>>Number(L)*.25).toString(16))}class LinkConnectorEventTarget extends EventTarget{dispatch(S,T){const _=new CustomEvent(S,{detail:T});return super.dispatchEvent(_)}addEventListener(S,T,_){super.addEventListener(S,T,_)}removeEventListener(S,T,_){super.removeEventListener(S,T,_)}dispatchEvent(S){return super.dispatchEvent(S)}}var Vi;const si=class si{constructor(S,T,_,w,B,A,O){dr(this,Vi);this.id=S,this.type=T,this.origin_id=_,this.origin_slot=w,this.target_id=B,this.target_slot=A,this.parentId=O,this._data=null,this._pos=new Float32Array(2)}get color(){return Ut(this,Vi)}set color(S){_r(this,Vi,S===""?null:S)}get isFloatingOutput(){return this.origin_id===-1&&this.origin_slot===-1}get isFloatingInput(){return this.target_id===-1&&this.target_slot===-1}get isFloating(){return this.isFloatingOutput||this.isFloatingInput}static createFromArray(S){return new si(S[0],S[5],S[1],S[2],S[3],S[4])}static create(S){return new si(S.id,S.type,S.origin_id,S.origin_slot,S.target_id,S.target_slot,S.parentId)}static getReroutes(S,T){var _,w;return T.parentId?(w=(_=S.reroutes.get(T.parentId))==null?void 0:_.getReroutes())!=null?w:[]:[]}static getFirstReroute(S,T){return si.getReroutes(S,T).at(0)}static findNextReroute(S,T,_){var w;if(T.parentId)return(w=S.reroutes.get(T.parentId))==null?void 0:w.findNextReroute(_)}static getOriginNode(S,T){var w,B;const _=(w=S.links.get(T))==null?void 0:w.origin_id;return(B=S.getNodeById(_))!=null?B:void 0}static getTargetNode(S,T){var w,B;const _=(w=S.links.get(T))==null?void 0:w.target_id;return(B=S.getNodeById(_))!=null?B:void 0}configure(S){Array.isArray(S)?(this.id=S[0],this.origin_id=S[1],this.origin_slot=S[2],this.target_id=S[3],this.target_slot=S[4],this.type=S[5]):(this.id=S.id,this.type=S.type,this.origin_id=S.origin_id,this.origin_slot=S.origin_slot,this.target_id=S.target_id,this.target_slot=S.target_slot,this.parentId=S.parentId)}hasOrigin(S,T){return this.origin_id===S&&this.origin_slot===T}hasTarget(S,T){return this.target_id===S&&this.target_slot===T}toFloating(S,T){const _=this.asSerialisable();return _.id=-1,_.parentId=T,S==="input"?(_.origin_id=-1,_.origin_slot=-1):(_.target_id=-1,_.target_slot=-1),si.create(_)}disconnect(S,T){const _=si.getReroutes(S,this),w=_.at(-1);if(T==="output"&&(w==null?void 0:w.linkIds.size)===1&&w.floatingLinkIds.size===0||T==="input"&&w){const A=si.create(this);A.id=-1,T==="input"?(A.origin_id=-1,A.origin_slot=-1,w.floating={slotType:"input"}):(A.target_id=-1,A.target_slot=-1,w.floating={slotType:"output"}),S.addFloatingLink(A)}for(const A of _)A.linkIds.delete(this.id),!T&&!A.totalLinks&&S.reroutes.delete(A.id);S.links.delete(this.id)}serialize(){return[this.id,this.origin_id,this.origin_slot,this.target_id,this.target_slot,this.type]}asSerialisable(){const S={id:this.id,origin_id:this.origin_id,origin_slot:this.origin_slot,target_id:this.target_id,target_slot:this.target_slot,type:this.type};return this.parentId&&(S.parentId=this.parentId),S}};Vi=new WeakMap;let LLink=si;class FloatingRenderLink{constructor(S,T,_,w,B=LinkDirection.CENTER){var E,D,I;this.network=S,this.link=T,this.toType=_,this.fromReroute=w,this.dragDirection=B,this.outputNodeId=-1,this.outputIndex=-1,this.inputNodeId=-1,this.inputIndex=-1;const{origin_id:A,target_id:O,origin_slot:R,target_slot:P}=T;if(A!==-1){const M=(E=S.getNodeById(A))!=null?E:void 0;if(!M)throw new Error("Creating DraggingRenderLink for link [".concat(T.id,"] failed: Output node [").concat(A,"] not found."));const N=M==null?void 0:M.outputs.at(R);if(!N)throw new Error("Creating DraggingRenderLink for link [".concat(T.id,"] failed: Output slot [").concat(R,"] not found."));this.outputNodeId=A,this.outputNode=M,this.outputSlot=N,this.outputIndex=R,this.outputPos=M.getOutputPos(R),this.node=M,this.fromSlot=N,this.fromPos=(D=w==null?void 0:w.pos)!=null?D:this.outputPos,this.fromDirection=LinkDirection.LEFT,this.dragDirection=LinkDirection.RIGHT,this.fromSlotIndex=R}else{const M=(I=S.getNodeById(O))!=null?I:void 0;if(!M)throw new Error("Creating DraggingRenderLink for link [".concat(T.id,"] failed: Input node [").concat(O,"] not found."));const N=M==null?void 0:M.inputs.at(P);if(!N)throw new Error("Creating DraggingRenderLink for link [".concat(T.id,"] failed: Input slot [").concat(P,"] not found."));this.inputNodeId=O,this.inputNode=M,this.inputSlot=N,this.inputIndex=P,this.inputPos=M.getInputPos(P),this.node=M,this.fromSlot=N,this.fromDirection=LinkDirection.RIGHT,this.fromSlotIndex=P}this.fromPos=w.pos}canConnectToInput(){return this.toType==="input"}canConnectToOutput(){return this.toType==="output"}canConnectToReroute(S){var T,_;if(this.toType==="input"){if(S.origin_id===((T=this.inputNode)==null?void 0:T.id))return!1}else if(S.origin_id===((_=this.outputNode)==null?void 0:_.id))return!1;return!0}connectToInput(S,T,_){var B,A;const w=this.link;w.target_id=S.id,w.target_slot=S.inputs.indexOf(T),S.disconnectInput(S.inputs.indexOf(T)),(B=this.fromSlot._floatingLinks)==null||B.delete(w),(A=T._floatingLinks)!=null||(T._floatingLinks=new Set),T._floatingLinks.add(w)}connectToOutput(S,T,_){var B,A;const w=this.link;w.origin_id=S.id,w.origin_slot=S.outputs.indexOf(T),(B=this.fromSlot._floatingLinks)==null||B.delete(w),(A=T._floatingLinks)!=null||(T._floatingLinks=new Set),T._floatingLinks.add(w)}connectToRerouteInput(S,{node:T,input:_},w){var A,O;const B=this.link;B.target_id=T.id,B.target_slot=T.inputs.indexOf(_),(A=this.fromSlot._floatingLinks)==null||A.delete(B),(O=_._floatingLinks)!=null||(_._floatingLinks=new Set),_._floatingLinks.add(B),w.dispatch("input-moved",this)}connectToRerouteOutput(S,T,_,w){var A,O;const B=this.link;B.origin_id=T.id,B.origin_slot=T.outputs.indexOf(_),(A=this.fromSlot._floatingLinks)==null||A.delete(B),(O=_._floatingLinks)!=null||(_._floatingLinks=new Set),_._floatingLinks.add(B),w.dispatch("output-moved",this)}}class MovingLinkBase{constructor(S,T,_,w,B=LinkDirection.CENTER){var N,k;this.network=S,this.link=T,this.toType=_,this.fromReroute=w,this.dragDirection=B;const{origin_id:A,target_id:O,origin_slot:R,target_slot:P}=T,E=(N=S.getNodeById(A))!=null?N:void 0;if(!E)throw new Error("Creating MovingRenderLink for link [".concat(T.id,"] failed: Output node [").concat(A,"] not found."));const D=E.outputs.at(R);if(!D)throw new Error("Creating MovingRenderLink for link [".concat(T.id,"] failed: Output slot [").concat(R,"] not found."));this.outputNodeId=A,this.outputNode=E,this.outputSlot=D,this.outputIndex=R,this.outputPos=E.getOutputPos(R);const I=(k=S.getNodeById(O))!=null?k:void 0;if(!I)throw new Error("Creating DraggingRenderLink for link [".concat(T.id,"] failed: Input node [").concat(O,"] not found."));const M=I.inputs.at(P);if(!M)throw new Error("Creating DraggingRenderLink for link [".concat(T.id,"] failed: Input slot [").concat(P,"] not found."));this.inputNodeId=O,this.inputNode=I,this.inputSlot=M,this.inputIndex=P,this.inputPos=I.getInputPos(P)}}class MovingInputLink extends MovingLinkBase{constructor(S,T,_,w=LinkDirection.CENTER){var B;super(S,T,"input",_,w),this.toType="input",this.node=this.outputNode,this.fromSlot=this.outputSlot,this.fromPos=(B=_==null?void 0:_.pos)!=null?B:this.outputPos,this.fromDirection=LinkDirection.NONE,this.fromSlotIndex=this.outputIndex}canConnectToInput(S,T){return this.node.canConnectTo(S,T,this.outputSlot)}canConnectToOutput(){return!1}canConnectToReroute(S){return S.origin_id!==this.inputNode.id}connectToInput(S,T,_){var B;if(T===this.inputSlot)return;this.inputNode.disconnectInput(this.inputIndex,!0);const w=this.outputNode.connectSlots(this.outputSlot,S,T,(B=this.fromReroute)==null?void 0:B.id);return w&&_.dispatch("input-moved",this),w}connectToOutput(){throw new Error("MovingInputLink cannot connect to an output.")}connectToRerouteInput(S,{node:T,input:_,link:w},B,A){const{outputNode:O,outputSlot:R,fromReroute:P}=this;for(const D of A){if(D.id===this.link.parentId)break;D.totalLinks===1&&D.remove()}S.parentId=P==null?void 0:P.id,O.connectSlots(R,T,_,w.parentId)&&B.dispatch("input-moved",this)}connectToRerouteOutput(){throw new Error("MovingInputLink cannot connect to an output.")}}class MovingOutputLink extends MovingLinkBase{constructor(S,T,_,w=LinkDirection.CENTER){var B;super(S,T,"output",_,w),this.toType="output",this.node=this.inputNode,this.fromSlot=this.inputSlot,this.fromPos=(B=_==null?void 0:_.pos)!=null?B:this.inputPos,this.fromDirection=LinkDirection.LEFT,this.fromSlotIndex=this.inputIndex}canConnectToInput(){return!1}canConnectToOutput(S,T){return S.canConnectTo(this.node,this.inputSlot,T)}canConnectToReroute(S){return S.origin_id!==this.outputNode.id}connectToInput(){throw new Error("MovingOutputLink cannot connect to an input.")}connectToOutput(S,T,_){if(T===this.outputSlot)return;const w=S.connectSlots(T,this.inputNode,this.inputSlot,this.link.parentId);return w&&_.dispatch("output-moved",this),w}connectToRerouteInput(){throw new Error("MovingOutputLink cannot connect to an input.")}connectToRerouteOutput(S,T,_,w){var P;const{inputNode:B,inputSlot:A,fromReroute:O}=this,R=((P=S==null?void 0:S.floating)==null?void 0:P.slotType)==="output";O?O.parentId=S.id:this.link.parentId=S.id,T.connectSlots(_,B,A,this.link.parentId),R&&S.removeAllFloatingLinks(),w.dispatch("output-moved",this)}}class ToInputRenderLink{constructor(S,T,_,w,B=LinkDirection.CENTER){this.network=S,this.node=T,this.fromSlot=_,this.fromReroute=w,this.dragDirection=B,this.toType="input",this.fromDirection=LinkDirection.RIGHT;const A=T.outputs.indexOf(_);if(A===-1)throw new Error("Creating render link for node [".concat(this.node.id,"] failed: Slot index not found."));this.fromSlotIndex=A,this.fromPos=w?w.pos:this.node.getOutputPos(A)}canConnectToInput(S,T){return this.node.canConnectTo(S,T,this.fromSlot)}canConnectToOutput(){return!1}connectToInput(S,T,_){const{node:w,fromSlot:B,fromReroute:A}=this;if(S===w)return;const O=w.connectSlots(B,S,T,A==null?void 0:A.id);_.dispatch("link-created",O)}connectToRerouteInput(S,{node:T,input:_,link:w},B,A){var I;const{node:O,fromSlot:R,fromReroute:P}=this,E=((I=P==null?void 0:P.floating)==null?void 0:I.slotType)==="output";S.parentId=P==null?void 0:P.id;const D=O.connectSlots(R,T,_,w.parentId);E&&P.removeAllFloatingLinks();for(const M of A){if(M.id===(P==null?void 0:P.id))break;if(M.removeLink(w),M.totalLinks===0)if(w.isFloating)M.remove();else{const N=w.toFloating("output",M.id);this.network.addFloatingLink(N),M.floating={slotType:"output"}}}B.dispatch("link-created",D)}connectToOutput(){throw new Error("ToInputRenderLink cannot connect to an output.")}connectToRerouteOutput(){throw new Error("ToInputRenderLink cannot connect to an output.")}}class ToOutputRenderLink{constructor(S,T,_,w,B=LinkDirection.CENTER){this.network=S,this.node=T,this.fromSlot=_,this.fromReroute=w,this.dragDirection=B,this.toType="output",this.fromDirection=LinkDirection.LEFT;const A=T.inputs.indexOf(_);if(A===-1)throw new Error("Creating render link for node [".concat(this.node.id,"] failed: Slot index not found."));this.fromSlotIndex=A,this.fromPos=w?w.pos:this.node.getInputPos(A)}canConnectToInput(){return!1}canConnectToOutput(S,T){return this.node.canConnectTo(S,this.fromSlot,T)}canConnectToReroute(S){return S.origin_id!==this.node.id}connectToOutput(S,T,_){const{node:w,fromSlot:B,fromReroute:A}=this;if(!w)return;const O=S.connectSlots(T,w,B,A==null?void 0:A.id);_.dispatch("link-created",O)}connectToRerouteOutput(S,T,_,w){const{node:B,fromSlot:A}=this,O=T.connectSlots(_,B,A,S==null?void 0:S.id);w.dispatch("link-created",O)}connectToInput(){throw new Error("ToOutputRenderLink cannot connect to an input.")}connectToRerouteInput(){throw new Error("ToOutputRenderLink cannot connect to an input.")}}var Gi,Pr,kn,Fn,Vn,_i;class LinkConnector{constructor(S){dr(this,Pr);dr(this,Gi);this.state={connectingTo:void 0,multi:!1,draggingExistingLinks:!1},this.events=new LinkConnectorEventTarget,this.renderLinks=[],this.inputLinks=[],this.outputLinks=[],this.floatingLinks=[],this.hiddenReroutes=new Set,_r(this,Gi,S)}get isConnecting(){return this.state.connectingTo!==void 0}get draggingExistingLinks(){return this.state.draggingExistingLinks}moveInputLink(S,T){var O;if(this.isConnecting)throw new Error("Already dragging links.");const{state:_,inputLinks:w,renderLinks:B}=this,A=T.link;if(A==null){const R=(O=T._floatingLinks)==null?void 0:O.values().next().value;if((R==null?void 0:R.parentId)==null)return;try{const P=S.reroutes.get(R.parentId);if(!P)throw new Error("Invalid reroute id: [".concat(R.parentId,"] for floating link id: [").concat(R.id,"]."));const E=new FloatingRenderLink(S,R,"input",P);if(this.events.dispatch("before-move-input",E)===!1)return;B.push(E)}catch(P){console.warn("Could not create render link for link id: [".concat(R.id,"]."),R,P)}R._dragging=!0,this.floatingLinks.push(R)}else{const R=S.links.get(A);if(!R)return;try{const P=S.getReroute(R.parentId),E=new MovingInputLink(S,R,P);if(this.events.dispatch("before-move-input",E)===!1)return;B.push(E),this.listenUntilReset("input-moved",I=>{I.detail.link.disconnect(S,"output")})}catch(P){console.warn("Could not create render link for link id: [".concat(R.id,"]."),R,P);return}R._dragging=!0,w.push(R)}_.connectingTo="input",_.draggingExistingLinks=!0,Zt(this,Pr,_i).call(this,!1)}moveOutputLink(S,T){var B,A;if(this.isConnecting)throw new Error("Already dragging links.");const{state:_,renderLinks:w}=this;if((B=T._floatingLinks)!=null&&B.size)for(const O of T._floatingLinks.values())try{const R=LLink.getFirstReroute(S,O);if(!R)throw new Error("Invalid reroute id: [".concat(O.parentId,"] for floating link id: [").concat(O.id,"]."));const P=new FloatingRenderLink(S,O,"output",R);if(this.events.dispatch("before-move-output",P)===!1)continue;w.push(P),this.floatingLinks.push(O)}catch(R){console.warn("Could not create render link for link id: [".concat(O.id,"]."),O,R)}if((A=T.links)!=null&&A.length)for(const O of T.links){const R=S.links.get(O);if(!R)continue;const P=LLink.getFirstReroute(S,R);P?(P._dragging=!0,this.hiddenReroutes.add(P)):R._dragging=!0,this.outputLinks.push(R);try{const E=new MovingOutputLink(S,R,P,LinkDirection.RIGHT);if(this.events.dispatch("before-move-output",E)===!1)continue;w.push(E)}catch(E){console.warn("Could not create render link for link id: [".concat(R.id,"]."),R,E);continue}}if(w.length===0)return this.reset();_.draggingExistingLinks=!0,_.multi=!0,_.connectingTo="output",Zt(this,Pr,_i).call(this,!0)}dragNewFromOutput(S,T,_,w){if(this.isConnecting)throw new Error("Already dragging links.");const{state:B}=this,A=new ToInputRenderLink(S,T,_,w);this.renderLinks.push(A),B.connectingTo="input",Zt(this,Pr,_i).call(this,!1)}dragNewFromInput(S,T,_,w){if(this.isConnecting)throw new Error("Already dragging links.");const{state:B}=this,A=new ToOutputRenderLink(S,T,_,w);this.renderLinks.push(A),B.connectingTo="output",Zt(this,Pr,_i).call(this,!0)}dragFromReroute(S,T){var O;if(this.isConnecting)throw new Error("Already dragging links.");const _=(O=T.firstLink)!=null?O:T.firstFloatingLink;if(!_)return;const w=S.getNodeById(_.origin_id);if(!w)return;const B=w.outputs.at(_.origin_slot);if(!B)return;const A=new ToInputRenderLink(S,w,B,T);A.fromDirection=LinkDirection.NONE,this.renderLinks.push(A),this.state.connectingTo="input",Zt(this,Pr,_i).call(this,!1)}dragFromLinkSegment(S,T){if(this.isConnecting)throw new Error("Already dragging links.");const{state:_}=this;if(T.origin_id==null||T.origin_slot==null)return;const w=S.getNodeById(T.origin_id);if(!w)return;const B=w.outputs.at(T.origin_slot);if(!B)return;const A=S.getReroute(T.parentId),O=new ToInputRenderLink(S,w,B,A);O.fromDirection=LinkDirection.NONE,this.renderLinks.push(O),_.connectingTo="input",Zt(this,Pr,_i).call(this,!1)}dropLinks(S,T){var R;if(!this.isConnecting)return this.reset();const{renderLinks:_}=this;if(this.events.dispatch("before-drop-links",{renderLinks:_,event:T})===!1)return this.reset();const{canvasX:B,canvasY:A}=T,O=(R=S.getNodeOnPos(B,A))!=null?R:void 0;if(O)this.dropOnNode(O,T);else{const P=S.getRerouteOnPos(B,A);P&&this.isRerouteValidDrop(P)?this.dropOnReroute(P,T):this.dropOnNothing(T)}this.events.dispatch("after-drop-links",{renderLinks:_,event:T}),this.reset()}dropOnNode(S,T){const{renderLinks:_,state:w}=this,{connectingTo:B}=w,{canvasX:A,canvasY:O}=T;if(!_.every(R=>R.node===S)){if(B==="output"){const R=S.getOutputOnPos([A,O]);R?Zt(this,Pr,Vn).call(this,S,R):Zt(this,Pr,kn).call(this,S,T)}else if(B==="input"){const R=S.getInputOnPos([A,O]);R?Zt(this,Pr,Fn).call(this,S,R):this.overWidget&&_[0]instanceof ToInputRenderLink?(this.events.dispatch("dropped-on-widget",{link:_[0],node:S,widget:this.overWidget}),this.overWidget=void 0):Zt(this,Pr,kn).call(this,S,T)}}}dropOnReroute(S,T){if(this.events.dispatch("dropped-on-reroute",{reroute:S,event:T})!==!1){if(this.state.connectingTo==="input"){if(this.renderLinks.length!==1)throw new Error("Attempted to connect ".concat(this.renderLinks.length," input links to a reroute."));const w=this.renderLinks[0],B=S.findTargetInputs();if(!(B!=null&&B.length))return;const A=S.getReroutes();if(A===null)throw new Error("Reroute loop detected.");const O=A.slice(0,-1).reverse();if(w instanceof ToInputRenderLink){const{node:P,fromSlot:E,fromSlotIndex:D,fromReroute:I}=w;if(S.setFloatingLinkOrigin(P,E,D),I!=null)for(const M of O){if(M.id===I.id)break;for(const N of S.floatingLinkIds)M.floatingLinkIds.delete(N)}}const R=B.filter(P=>w.toType==="input"&&canConnectInputLinkToReroute(w,P.node,P.input,S));for(const P of R)w.connectToRerouteInput(S,P,this.events,O);return}for(const w of this.renderLinks){if(w.toType!=="output")continue;const B=S.findSourceOutput();if(!B)continue;const{node:A,output:O}=B;w.canConnectToOutput(A,O)&&w.connectToRerouteOutput(S,A,O,this.events)}}}dropOnNothing(S){if(this.state.connectingTo==="input")for(const T of this.renderLinks)T instanceof MovingInputLink&&T.inputNode.disconnectInput(T.inputIndex,!0);this.events.dispatch("dropped-on-canvas",S)}isNodeValidDrop(S){var T;return this.state.connectingTo==="output"?S.outputs.some(_=>this.renderLinks.some(w=>w.canConnectToOutput(S,_))):(T=S.widgets)!=null&&T.length?!0:S.inputs.some(_=>this.renderLinks.some(w=>w.canConnectToInput(S,_)))}isRerouteValidDrop(S){if(this.state.connectingTo==="input"){const T=S.findTargetInputs();if(!(T!=null&&T.length))return!1;for(const{node:_,input:w}of T)for(const B of this.renderLinks)if(B.toType==="input"&&canConnectInputLinkToReroute(B,_,w,S))return!0}else{const T=S.findSourceOutput();if(!T)return!1;const{node:_,output:w}=T;for(const B of this.renderLinks)if(B.toType==="output"&&B.canConnectToReroute(S)&&B.canConnectToOutput(_,w))return!0}return!1}export(S){return{renderLinks:[...this.renderLinks],inputLinks:[...this.inputLinks],outputLinks:[...this.outputLinks],floatingLinks:[...this.floatingLinks],state:{...this.state},network:S}}listenUntilReset(S,T,_){this.events.addEventListener(S,T,_),this.events.addEventListener("reset",()=>this.events.removeEventListener(S,T),{once:!0})}reset(S=!1){this.events.dispatch("reset",S);const{state:T,outputLinks:_,inputLinks:w,hiddenReroutes:B,renderLinks:A,floatingLinks:O}=this;if(!(!S&&T.connectingTo===void 0)){T.connectingTo=void 0;for(const R of _)delete R._dragging;for(const R of w)delete R._dragging;for(const R of O)delete R._dragging;for(const R of B)delete R._dragging;A.length=0,w.length=0,_.length=0,O.length=0,B.clear(),T.multi=!1,T.draggingExistingLinks=!1}}}Gi=new WeakMap,Pr=new WeakSet,kn=function(S,T){var A,O;const{state:{connectingTo:_}}=this;if(this.events.dispatch("dropped-on-node",{node:S,event:T})===!1)return;const B=this.renderLinks[0];if(B){if(_==="output"){const R=(A=S.findOutputByType(B.fromSlot.type))==null?void 0:A.slot;if(!R){console.warn("Could not find slot for link type: [".concat(B.fromSlot.type,"]."));return}Zt(this,Pr,Vn).call(this,S,R)}else if(_==="input"){const R=(O=S.findInputByType(B.fromSlot.type))==null?void 0:O.slot;if(!R){console.warn("Could not find slot for link type: [".concat(B.fromSlot.type,"]."));return}Zt(this,Pr,Fn).call(this,S,R)}}},Fn=function(S,T){for(const _ of this.renderLinks)_.canConnectToInput(S,T)&&_.connectToInput(S,T,this.events)},Vn=function(S,T){for(const _ of this.renderLinks){if(!_.canConnectToOutput(S,T)){_ instanceof MovingOutputLink&&_.link.parentId!==void 0&&_.outputNode.connectSlots(_.outputSlot,_.inputNode,_.inputSlot,void 0);continue}_.connectToOutput(S,T,this.events)}},_i=function(S){const T=this.renderLinks.map(_=>{var O,R;const w=S?_.fromSlot:null,B=S?null:_.fromSlot,A=_ instanceof MovingLinkBase?(O=_.link)==null?void 0:O.parentId:(R=_.fromReroute)==null?void 0:R.id;return{node:_.node,slot:_.fromSlotIndex,input:w,output:B,pos:_.fromPos,afterRerouteId:A}});Ut(this,Gi).call(this,T)};function canConnectInputLinkToReroute(L,S,T,_){var B,A,O;const{fromReroute:w}=L;if(!L.canConnectToInput(S,T)||(w==null?void 0:w.id)===_.id||(B=w==null?void 0:w.getReroutes())!=null&&B.includes(_))return!1;if(L instanceof ToInputRenderLink){if(_.parentId==null){if((A=_.firstLink)!=null&&A.hasOrigin(L.node.id,L.fromSlotIndex))return!1}else if(((O=L.fromReroute)==null?void 0:O.id)===_.parentId)return!1}return!0}function getNodeInputOnPos(L,S,T){var w,B,A,O,R;const{inputs:_}=L;if(_)for(const[P,E]of _.entries()){const D=L.getInputPos(P),M=20+(((R=(A=(w=E.label)==null?void 0:w.length)!=null?A:(B=E.localized_name)==null?void 0:B.length)!=null?R:(O=E.name)==null?void 0:O.length)||3)*7;if(isInRectangle(S,T,D[0]-10,D[1]-10,M,20))return{index:P,input:E,pos:D}}}function getNodeOutputOnPos(L,S,T){const{outputs:_}=L;if(_)for(const[w,B]of _.entries()){const A=L.getOutputPos(w);if(isInRectangle(S,T,A[0]-10,A[1]-10,40,20))return{index:w,output:B,pos:A}}}function isOverNodeInput(L,S,T,_){const w=getNodeInputOnPos(L,S,T);return w?(_&&(_[0]=w.pos[0],_[1]=w.pos[1]),w.index):-1}function isOverNodeOutput(L,S,T,_){const w=getNodeOutputOnPos(L,S,T);return w?(_&&(_[0]=w.pos[0],_[1]=w.pos[1]),w.index):-1}var gi,ji,Pi,kr,Gn,en,Xs,jn;const Jr=class Jr{constructor(S){dr(this,kr);dr(this,Pi);this.dragStarted=!1,this.isDouble=!1,this.isDown=!1,this.clearEventsOnReset=!0,this.element=S}static get maxClickDrift(){return Ut(this,gi)}static set maxClickDrift(S){_r(this,gi,S),_r(this,ji,S*S)}get finally(){return Ut(this,Pi)}set finally(S){var T;try{(T=Ut(this,Pi))==null||T.call(this)}finally{_r(this,Pi,S)}}down(S){this.reset(),this.eDown=S,this.pointerId=S.pointerId,this.element.setPointerCapture(S.pointerId)}move(S){var w;const{eDown:T}=this;if(!T)return;if(!S.buttons){this.reset();return}if(!(S.buttons&T.buttons)){Zt(this,kr,Gn).call(this,S),this.reset();return}if(this.eMove=S,(w=this.onDrag)==null||w.call(this,S),this.dragStarted)return;(S.timeStamp-T.timeStamp>Jr.bufferTime||!Zt(this,kr,en).call(this,S,T))&&Zt(this,kr,jn).call(this)}up(S){var _;if(S.button!==((_=this.eDown)==null?void 0:_.button))return!1;Zt(this,kr,Gn).call(this,S);const{dragStarted:T}=this;return this.reset(),!T}reset(){this.finally=void 0,delete this.onClick,delete this.onDoubleClick,delete this.onDragStart,delete this.onDrag,delete this.onDragEnd,this.isDown=!1,this.isDouble=!1,this.dragStarted=!1,this.clearEventsOnReset&&(this.eDown=void 0,this.eMove=void 0,this.eUp=void 0);const{element:S,pointerId:T}=this;this.pointerId=void 0,typeof T=="number"&&S.hasPointerCapture(T)&&S.releasePointerCapture(T)}};gi=new WeakMap,ji=new WeakMap,Pi=new WeakMap,kr=new WeakSet,Gn=function(S){var _,w,B;const{eDown:T}=this;T&&(this.eUp=S,this.dragStarted?(_=this.onDragEnd)==null||_.call(this,S):Zt(this,kr,en).call(this,S,T)?this.onDoubleClick&&Zt(this,kr,Xs).call(this)?(this.onDoubleClick(S),this.eLastDown=void 0):((B=this.onClick)==null||B.call(this,S),this.eLastDown=T):(Zt(this,kr,jn).call(this),(w=this.onDragEnd)==null||w.call(this,S)))},en=function(S,T,_=Ut(Jr,ji)){return dist2(S.clientX,S.clientY,T.clientX,T.clientY)<=_},Xs=function(){const{eDown:S,eLastDown:T}=this;if(!S||!T)return!1;const _=(3*Ut(Jr,gi))**2,w=S.timeStamp-T.timeStamp;return w>0&&w<Jr.doubleClickTime&&Zt(this,kr,en).call(this,S,T,_)},jn=function(){var S;this.dragStarted=!0,(S=this.onDragStart)==null||S.call(this,this),delete this.onDragStart},Jr.bufferTime=150,Jr.doubleClickTime=300,dr(Jr,gi,6),dr(Jr,ji,Ut(Jr,gi)**2);let CanvasPointer=Jr;class NullGraphError extends Error{constructor(S="Attempted to access LGraph reference that was null or undefined.",T){super(S,{cause:T}),this.name="NullGraphError"}}var BadgePosition=(L=>(L.TopLeft="top-left",L.TopRight="top-right",L))(BadgePosition||{});class LGraphBadge{constructor({text:S,fgColor:T="white",bgColor:_="#0F1F0F",fontSize:w=12,padding:B=6,height:A=20,cornerRadius:O=5}){this.text=S,this.fgColor=T,this.bgColor=_,this.fontSize=w,this.padding=B,this.height=A,this.cornerRadius=O}get visible(){return this.text.length>0}getWidth(S){if(!this.visible)return 0;const{font:T}=S;S.font="".concat(this.fontSize,"px sans-serif");const _=S.measureText(this.text).width;return S.font=T,_+this.padding*2}draw(S,T,_){if(!this.visible)return;const{fillStyle:w}=S;S.font="".concat(this.fontSize,"px sans-serif");const B=this.getWidth(S),A=0;S.fillStyle=this.bgColor,S.beginPath(),S.roundRect?S.roundRect(T+A,_,B,this.height,this.cornerRadius):S.rect(T+A,_,B,this.height),S.fill(),S.fillStyle=this.fgColor,S.fillText(this.text,T+A+this.padding,_+this.height-this.padding),S.fillStyle=w}}function shallowCloneCommonProps(L){const{color_off:S,color_on:T,dir:_,label:w,localized_name:B,locked:A,name:O,nameLocked:R,removable:P,shape:E,type:D}=L;return{color_off:S,color_on:T,dir:_,label:w,localized_name:B,locked:A,name:O,nameLocked:R,removable:P,shape:E,type:D}}function inputAsSerialisable(L){const{link:S}=L,T=L.widget?{widget:{name:L.widget.name}}:{pos:L.pos};return{...shallowCloneCommonProps(L),...T,link:S}}function outputAsSerialisable(L){const{pos:S,slot_index:T,links:_,widget:w}=L,B=w?{widget:{name:w.name}}:null;return{...shallowCloneCommonProps(L),...B,pos:S,slot_index:T,links:_}}function toNodeSlotClass(L){if(isINodeInputSlot(L))return new NodeInputSlot(L);if(isINodeOutputSlot(L))return new NodeOutputSlot(L);throw new Error("Invalid slot type")}function isWidgetInputSlot(L){return isINodeInputSlot(L)&&!!L.widget}class NodeSlot{constructor(S){Object.assign(this,S),this.name=S.name,this.type=S.type}get renderingLabel(){return this.label||this.localized_name||this.name||""}connectedColor(S){return this.color_on||S.default_connection_color_byType[this.type]||S.default_connection_color.output_on}disconnectedColor(S){return this.color_off||S.default_connection_color_byTypeOff[this.type]||S.default_connection_color_byType[this.type]||S.default_connection_color.output_off}renderingColor(S){return this.isConnected()?this.connectedColor(S):this.disconnectedColor(S)}draw(S,T){const{pos:_,colorContext:w,labelColor:B="#AAA",labelPosition:A=LabelPosition.Right,lowQuality:O=!1,highlight:R=!1}=T;let{doStroke:P=!1}=T;const E=S.fillStyle,D=S.strokeStyle,I=S.lineWidth,M=this.type,N=M===SlotType.Array?SlotShape.Grid:this.shape;S.beginPath();let k=!0;if(S.fillStyle=this.renderingColor(w),S.lineWidth=1,M===SlotType.Event||N===SlotShape.Box)S.rect(_[0]-6+.5,_[1]-5+.5,14,10);else if(N===SlotShape.Arrow)S.moveTo(_[0]+8,_[1]+.5),S.lineTo(_[0]-4,_[1]+6+.5),S.lineTo(_[0]-4,_[1]-6+.5),S.closePath();else if(N===SlotShape.Grid){for(let H=0;H<3;H++)for(let U=0;U<3;U++)S.rect(_[0]-4+H*3,_[1]-4+U*3,2,2);P=!1}else if(O)S.rect(_[0]-4,_[1]-4,8,8);else{let G;N===SlotShape.HollowCircle?(k=!1,P=!0,S.lineWidth=3,S.strokeStyle=S.fillStyle,G=R?4:3):G=R?5:4,S.arc(_[0],_[1],G,0,Math.PI*2)}if(k&&S.fill(),!O&&P&&S.stroke(),!(O||isWidgetInputSlot(this))){const G=this.renderingLabel;G&&(S.fillStyle=B,A===LabelPosition.Right?this.dir==LinkDirection.UP?S.fillText(G,_[0],_[1]-10):S.fillText(G,_[0]+10,_[1]+5):this.dir==LinkDirection.DOWN?S.fillText(G,_[0],_[1]-8):S.fillText(G,_[0]-10,_[1]+5))}this.hasErrors&&(S.lineWidth=2,S.strokeStyle="red",S.beginPath(),S.arc(_[0],_[1],12,0,Math.PI*2),S.stroke()),S.fillStyle=E,S.strokeStyle=D,S.lineWidth=I}drawCollapsed(S,T){const[_,w]=T.pos,B=S.fillStyle;S.fillStyle="#686",S.beginPath(),this.type===SlotType.Event||this.shape===RenderShape.BOX?S.rect(_-7+.5,w-4,14,8):this.shape===RenderShape.ARROW?(this instanceof NodeInputSlot?(S.moveTo(_+8,w),S.lineTo(_-4,w-4),S.lineTo(_-4,w+4)):(S.moveTo(_+6,w),S.lineTo(_-6,w-4),S.lineTo(_-6,w+4)),S.closePath()):S.arc(_,w,4,0,Math.PI*2),S.fill(),S.fillStyle=B}}function isINodeInputSlot(L){return"link"in L}class NodeInputSlot extends NodeSlot{constructor(S){super(S),this.link=S.link}isConnected(){return this.link!=null}isValidTarget(S){return"links"in S&&LiteGraph.isValidConnection(this.type,S.type)}draw(S,T){const _=S.textAlign;S.textAlign="left",super.draw(S,{...T,labelPosition:LabelPosition.Right,doStroke:!1}),S.textAlign=_}}function isINodeOutputSlot(L){return"links"in L}class NodeOutputSlot extends NodeSlot{constructor(S){super(S),this.links=S.links,this._data=S._data,this.slot_index=S.slot_index}isValidTarget(S){return"link"in S&&LiteGraph.isValidConnection(this.type,S.type)}isConnected(){return this.links!=null&&this.links.length>0}draw(S,T){const _=S.textAlign,w=S.strokeStyle;S.textAlign="right",S.strokeStyle="black",super.draw(S,{...T,labelPosition:LabelPosition.Left,doStroke:!0}),S.textAlign=_,S.strokeStyle=w}}function stringOrEmpty(L){return L==null?"":String(L)}function parseSlotTypes(L){return L==""||L=="0"?["*"]:String(L).toLowerCase().split(",")}function getAllNestedItems(L){const S=new Set;if(L)for(const _ of L)T(_,S);return S;function T(_,w){if(!(w.has(_)||_.pinned)&&(w.add(_),_.children))for(const B of _.children)T(B,w)}}function findFirstNode(L){for(const S of L)if(S instanceof LGraphNode)return S}function findFreeSlotOfType(L,S){var A,O,R;if(!(L!=null&&L.length))return;let T,_,w;const B=parseSlotTypes(S);for(const[P,E]of L.entries()){const D=parseSlotTypes(E.type);for(const I of B)for(const M of D)if(M===I){if(E.link==null&&!((A=E.links)!=null&&A.length))return{index:P,slot:E};T!=null||(T={index:P,slot:E})}else!_&&(I==="*"||M==="*")&&(E.link==null&&!((O=E.links)!=null&&O.length)?_={index:P,slot:E}:w!=null||(w={index:P,slot:E}))}return(R=_!=null?_:T)!=null?R:w}class LayoutElement{constructor(S){this.value=S.value,this.boundingRect=S.boundingRect}get center(){return[this.boundingRect[0]+this.boundingRect[2]/2,this.boundingRect[1]+this.boundingRect[3]/2]}}function distributeSpace(L,S){if(S.length===0)return[];const T=S.reduce((B,A)=>B+A.minSize,0);if(L<T)return S.map(B=>B.minSize);let _=S.map(B=>{var A,O;return{computedSize:B.minSize,maxSize:(A=B.maxSize)!=null?A:1/0,remaining:((O=B.maxSize)!=null?O:1/0)-B.minSize}}),w=L-T;for(;w>0&&_.some(B=>B.remaining>0);){const B=_.filter(R=>R.remaining>0).length;if(B===0)break;const A=w/B;let O=0;if(_=_.map(R=>{if(R.remaining<=0)return R;const P=Math.min(A,R.remaining);return O+=P,{...R,computedSize:R.computedSize+P,remaining:R.remaining-P}}),w-=O,O===0)break}return _.map(({computedSize:B})=>B)}function toClass(L,S){return S instanceof L?S:new L(S)}class BaseWidget{constructor(S){this.y=0,Object.assign(this,S),this.name=S.name,this.options=S.options,this.type=S.type}get outline_color(){return this.advanced?LiteGraph.WIDGET_ADVANCED_OUTLINE_COLOR:LiteGraph.WIDGET_OUTLINE_COLOR}get background_color(){return LiteGraph.WIDGET_BGCOLOR}get height(){return LiteGraph.NODE_WIDGET_HEIGHT}get text_color(){return LiteGraph.WIDGET_TEXT_COLOR}get secondary_text_color(){return LiteGraph.WIDGET_SECONDARY_TEXT_COLOR}setValue(S,T){var R,P,E,D;const{node:_,canvas:w,e:B}=T,A=this.value;if(S===this.value)return;const O=this.type==="number"?Number(S):S;if(this.value=O,(R=this.options)!=null&&R.property&&_.properties[this.options.property]!==void 0&&_.setProperty(this.options.property,O),w!=null){const I=w.graph_mouse;(P=this.callback)==null||P.call(this,this.value,w,_,I,B)}(D=_.onWidgetChanged)==null||D.call(_,(E=this.name)!=null?E:"",O,A,this),_.graph&&_.graph._version++}}class BooleanWidget extends BaseWidget{constructor(S){super(S),this.type="toggle",this.value=S.value}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){const{height:A}=this;if(S.textAlign="left",S.strokeStyle=this.outline_color,S.fillStyle=this.background_color,S.beginPath(),w?S.roundRect(B,T,_-B*2,A,[A*.5]):S.rect(B,T,_-B*2,A),S.fill(),w&&!this.computedDisabled&&S.stroke(),S.fillStyle=this.value?"#89A":"#333",S.beginPath(),S.arc(_-B*2,T+A*.5,A*.36,0,Math.PI*2),S.fill(),w){S.fillStyle=this.secondary_text_color;const O=this.label||this.name;O!=null&&S.fillText(O,B*2,T+A*.7),S.fillStyle=this.value?this.text_color:this.secondary_text_color,S.textAlign="right",S.fillText(this.value?this.options.on||"true":this.options.off||"false",_-40,T+A*.7)}}onClick(S){this.setValue(!this.value,S)}}class ButtonWidget extends BaseWidget{constructor(S){var T;super(S),this.type="button",this.clicked=(T=S.clicked)!=null?T:!1}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){const A=S.textAlign,O=S.strokeStyle,R=S.fillStyle,{height:P}=this;let E=_-B*2,D=0;var I=N=>{S.fillStyle=this.background_color,this.clickeName==N&&(S.fillStyle="#AAA",this.clickeName=""),S.fillRect(B+D,T,E,P),w&&!this.computedDisabled&&(S.strokeStyle=this.outline_color,S.strokeRect(B+D,T,E,P)),w&&(S.textAlign="center",S.fillStyle=this.text_color,S.fillText(N,E*.5+D+B,T+P*.7)),D+=E+2};if(this.options.buttons!=null){E=E/this.options.buttons.length,E-=2;for(var M=0;M<this.options.buttons.length;M++)I(this.options.buttons[M])}else I(this.label||this.name||"");S.textAlign=A,S.strokeStyle=O,S.fillStyle=R}onClick(S){var I;const{e:T,node:_,canvas:w}=S,B=w.graph_mouse,A=T.canvasX-_.pos[0];T.canvasY-this.y-_.pos[1];const{height:O}=this,R=this.width||_.size[0];let P=15,E=R-P*2;if(this.options.buttons!=null){E=E/this.options.buttons.length-2,this.clickeName="";for(var D=0;D<this.options.buttons.length;D++){let M=E*D+P+D*2,N=E*(D+1)+P+D*2;if(M<A&&A<N){this.clickeName=this.options.buttons[D];break}}}else this.clickeName=this.label||this.name||"";this.clicked=!0,w.setDirty(!0),(I=this.callback)==null||I.call(this,this,w,_,B,T)}}class ComboWidget extends BaseWidget{constructor(S){super(S),this.type="combo",this.value=S.value}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){const A=S.textAlign,O=S.strokeStyle,R=S.fillStyle,{height:P}=this;if(S.textAlign="left",S.strokeStyle=this.outline_color,S.fillStyle=this.background_color,S.beginPath(),w?S.roundRect(B,T,_-B*2,P,[P*.5]):S.rect(B,T,_-B*2,P),S.fill(),w){this.computedDisabled||(S.stroke(),S.fillStyle=this.text_color,S.beginPath(),S.moveTo(B+16,T+5),S.lineTo(B+6,T+P*.5),S.lineTo(B+16,T+P-5),S.fill(),S.beginPath(),S.moveTo(_-B-16,T+5),S.lineTo(_-B-6,T+P*.5),S.lineTo(_-B-16,T+P-5),S.fill()),S.fillStyle=this.secondary_text_color;const E=this.label||this.name;E!=null&&S.fillText(E,B*2+5,T+P*.7),S.fillStyle=this.text_color,S.textAlign="right";let D=typeof this.value=="number"?String(this.value):this.value;if(this.options.values){let F=this.options.values;typeof F=="function"&&(F=F()),F&&!Array.isArray(F)&&(D=F[this.value])}const I=S.measureText(E||"").width+B*2,N=_-B*4-I,k=S.measureText(D).width;if(k>N){const F="…",G=S.measureText(F).width,V=S.measureText("a").width;if(N<=G)D="․";else{if(D="".concat(D),k+G-N+V*3>N){const H=N+V*3,U=Math.floor((H-G)/V);D=D.substr(0,U)}for(;S.measureText(D).width+G>N;)D=D.substr(0,D.length-1);D+=F}}S.fillText(D,_-B*2-20,T+P*.7)}S.textAlign=A,S.strokeStyle=O,S.fillStyle=R}onClick(S){const{e:T,node:_,canvas:w}=S,B=T.canvasX-_.pos[0],A=this.width||_.size[0],O=B<40?-1:B>A-40?1:0;let R=this.options.values;typeof R=="function"&&(R=R(this,_));const P=Array.isArray(R)?R:Object.keys(R);if(O){let D=-1;w.last_mouseclick=0,D=typeof R=="object"?P.indexOf(String(this.value))+O:P.indexOf(this.value)+O,D>=P.length&&(D=P.length-1),D<0&&(D=0),this.setValue(Array.isArray(R)?R[D]:D,{e:T,node:_,canvas:w});return}const E=R!=P?Object.values(R):R;new LiteGraph.ContextMenu(E,{scale:Math.max(1,w.ds.scale),event:T,className:"dark",callback:D=>{this.setValue(R!=P?E.indexOf(D):D,{e:T,node:_,canvas:w})}})}}function getWidgetStep(L){return L.step2||(L.step||10)*.1}class KnobWidget extends BaseWidget{constructor(S){super(S),this.current_drag_offset=0,this.type="knob",this.value=S.value,this.options=S.options}computeLayoutSize(){return{minHeight:60,minWidth:20,maxHeight:1e6,maxWidth:1e6}}get height(){return this.computedHeight||super.height}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){var H;const A=S.textAlign,O=S.strokeStyle,R=S.fillStyle,{gradient_stops:P="rgb(14, 182, 201); rgb(0, 216, 72)"}=this.options,E=this.computedHeight||this.height,D=Math.min(this.computedHeight||this.height,this.width||20)/20,I={x:_/2,y:E/2+T};S.lineWidth=(Math.min(_,E)-B*D)/6;const M=(Math.min(_,E)-B*D-S.lineWidth)/2;{const U=S.createRadialGradient(I.x,I.y,M+S.lineWidth,0,0,M+S.lineWidth);U.addColorStop(0,"rgb(29, 29, 29)"),U.addColorStop(1,"rgb(116, 116, 116)"),S.fillStyle=U}S.beginPath(),S.arc(I.x,I.y,M+S.lineWidth/2,0,Math.PI*2,!1),S.fill(),S.closePath();const N={start_angle:Math.PI*.6,end_angle:Math.PI*2.4};S.beginPath();{const U=S.createRadialGradient(I.x,I.y,M+S.lineWidth,0,0,M+S.lineWidth);U.addColorStop(0,"rgb(99, 99, 99)"),U.addColorStop(1,"rgb(36, 36, 36)"),S.strokeStyle=U}S.arc(I.x,I.y,M,N.start_angle,N.end_angle,!1),S.stroke(),S.closePath();const k=this.options.max-this.options.min;let F=(this.value-this.options.min)/k;F=clamp(F,0,1),S.beginPath();const G=S.createConicGradient(N.start_angle,I.x,I.y),V=P.split(";");for(const[U,X]of V.entries())G.addColorStop(U,X.trim());S.strokeStyle=G;const j=(N.end_angle-N.start_angle)*F+N.start_angle;if(S.arc(I.x,I.y,M,N.start_angle,j,!1),S.stroke(),S.closePath(),w&&!this.computedDisabled&&(S.strokeStyle=this.outline_color,S.beginPath(),S.strokeStyle=this.outline_color,S.arc(I.x,I.y,M+S.lineWidth/2,0,Math.PI*2,!1),S.lineWidth=1,S.stroke(),S.closePath()),w){S.textAlign="center",S.fillStyle=this.text_color;const U=Number(this.value).toFixed((H=this.options.precision)!=null?H:3);S.fillText("".concat(this.label||this.name,"\n").concat(U),_*.5,T+E*.5)}S.textAlign=A,S.strokeStyle=O,S.fillStyle=R}onClick(){this.current_drag_offset=0}onDrag(S){if(this.options.read_only)return;const{e:T}=S,_=getWidgetStep(this.options),w=this.options.max-this.options.min,B=w/10,A=w/100,O={shift:B>_?B-B%_:_,delta_y:A>_?A-A%_:_},R=Math.abs(T.movementY)>Math.abs(T.movementX),P=R?-T.movementY:T.movementX,E=15;this.current_drag_offset+=P;let D=0;this.current_drag_offset>E?(D+=1,this.current_drag_offset-=E):this.current_drag_offset<-E&&(D-=1,this.current_drag_offset+=E);const I=T.shiftKey?O.shift:R?O.delta_y:_,M=D*I,N=clamp(this.value+M,this.options.min,this.options.max);N!==this.value&&this.setValue(N,S)}}class NumberWidget extends BaseWidget{constructor(L){super(L),this.type="number",this.value=L.value}setValue(L,S){let T=L;this.options.min!=null&&T<this.options.min&&(T=this.options.min),this.options.max!=null&&T>this.options.max&&(T=this.options.max),super.setValue(T,S)}drawWidget(L,{y:S,width:T,show_text:_=!0,margin:w=15}){const B=L.textAlign,A=L.strokeStyle,O=L.fillStyle,{height:R}=this;if(L.textAlign="left",L.strokeStyle=this.outline_color,L.fillStyle=this.background_color,L.beginPath(),_?L.roundRect(w,S,T-w*2,R,[R*.5]):L.rect(w,S,T-w*2,R),L.fill(),_){this.computedDisabled||(L.stroke(),L.fillStyle=this.text_color,L.beginPath(),L.moveTo(w+16,S+5),L.lineTo(w+6,S+R*.5),L.lineTo(w+16,S+R-5),L.fill(),L.beginPath(),L.moveTo(T-w-16,S+5),L.lineTo(T-w-6,S+R*.5),L.lineTo(T-w-16,S+R-5),L.fill()),L.fillStyle=this.secondary_text_color;const P=this.label||this.name;P!=null&&L.fillText(P,w*2+5,S+R*.7),L.fillStyle=this.text_color,L.textAlign="right",L.fillText(Number(this.value).toFixed(this.options.precision!==void 0?this.options.precision:3),T-w*2-20,S+R*.7)}L.textAlign=B,L.strokeStyle=A,L.fillStyle=O}onClick(options){const{e,node,canvas}=options,x=e.canvasX-node.pos[0],width=this.width||node.size[0],delta=x<40?-1:x>width-40?1:0;if(delta){this.setValue(this.value+delta*getWidgetStep(this.options),{e,node,canvas});return}canvas.prompt("Value",this.value,v=>{if(/^[\d\s()*+/-]+|\d+\.\d+$/.test(v))try{v=eval(v)}catch(L){}const newValue=Number(v);isNaN(newValue)||this.setValue(newValue,{e,node,canvas})},e)}onDrag(L){var O;const{e:S,node:T,canvas:_}=L,w=this.width||T.width,B=S.canvasX-T.pos[0];(B<40||B>w-40)&&B>-3&&B<w+3||this.setValue(this.value+((O=S.deltaX)!=null?O:0)*getWidgetStep(this.options),{e:S,node:T,canvas:_})}}class SliderWidget extends BaseWidget{constructor(S){super(S),this.type="slider",this.value=S.value,this.options=S.options,this.marker=S.marker}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){var I,M,N;const A=S.textAlign,O=S.strokeStyle,R=S.fillStyle,{height:P}=this;S.fillStyle=this.background_color,S.fillRect(B,T,_-B*2,P);const E=this.options.max-this.options.min;let D=(this.value-this.options.min)/E;if(D=clamp(D,0,1),S.fillStyle=(I=this.options.slider_color)!=null?I:"#678",S.fillRect(B,T,D*(_-B*2),P),w&&!this.computedDisabled&&(S.strokeStyle=this.outline_color,S.strokeRect(B,T,_-B*2,P)),this.marker!=null){let k=(this.marker-this.options.min)/E;k=clamp(k,0,1),S.fillStyle=(M=this.options.marker_color)!=null?M:"#AA9",S.fillRect(B+k*(_-B*2),T,2,P)}if(w){S.textAlign="center",S.fillStyle=this.text_color;const k=Number(this.value).toFixed((N=this.options.precision)!=null?N:3);S.fillText("".concat(this.label||this.name,"  ").concat(k),_*.5,T+P*.7)}S.textAlign=A,S.strokeStyle=O,S.fillStyle=R}onClick(S){if(this.options.read_only)return;const{e:T,node:_}=S,w=this.width||_.size[0],B=T.canvasX-_.pos[0],A=clamp((B-15)/(w-30),0,1),O=this.options.min+(this.options.max-this.options.min)*A;O!==this.value&&this.setValue(O,S)}onDrag(S){if(this.options.read_only)return!1;const{e:T,node:_}=S,w=this.width||_.size[0],B=T.canvasX-_.pos[0],A=clamp((B-15)/(w-30),0,1),O=this.options.min+(this.options.max-this.options.min)*A;O!==this.value&&this.setValue(O,S)}}class TextWidget extends BaseWidget{constructor(S){var T,_,w;super(S),this.type=(T=S.type)!=null?T:"string",this.value=(w=(_=S.value)==null?void 0:_.toString())!=null?w:""}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){const A=S.textAlign,O=S.strokeStyle,R=S.fillStyle,{height:P}=this;if(S.textAlign="left",S.strokeStyle=this.outline_color,S.fillStyle=this.background_color,S.beginPath(),w?S.roundRect(B,T,_-B*2,P,[P*.5]):S.rect(B,T,_-B*2,P),S.fill(),w){this.computedDisabled||S.stroke(),S.save(),S.beginPath(),S.rect(B,T,_-B*2,P),S.clip(),S.fillStyle=this.secondary_text_color;const E=this.label||this.name;E!=null&&S.fillText(E,B*2,T+P*.7),S.fillStyle=this.text_color,S.textAlign="right";let D=String(this.value),I=D.length<9?D:D.substring(0,8)+"..";S.fillText(I,_-B*2,T+P*.7),S.restore()}S.textAlign=A,S.strokeStyle=O,S.fillStyle=R}onClick(S){var B,A;const{e:T,node:_,canvas:w}=S;w.prompt("Value",this.value,O=>{O!==null&&this.setValue(O,{e:T,node:_,canvas:w})},T,(A=(B=this.options)==null?void 0:B.multiline)!=null?A:!1)}}class ccNodeWidget extends BaseWidget{get height(){return this._height||100}computeLayoutSize(S){var T=S.width-30,_=this.options.viewHeight/this.options.viewWidth;let w=_*T;return this._height=w,{minHeight:w+4,maxHeight:w+4,minWidth:T,maxWidth:T}}constructor(S){super(S),this.type="ccnode",this.value=S.value,this.options=S.options}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){const A=S.strokeStyle,O=S.fillStyle;_-=B*2;var R=this.options.viewHeight/this.options.viewWidth,P=R*_;S.fillStyle=this.background_color,S.fillRect(B,T,_,P),S.strokeStyle=this.outline_color,S.beginPath(),S.rect(B,T,_,P),S.stroke(),S.save(),S.clip(),S.fillStyle=this.value.color||"#D8D8D8",S.strokeStyle=this.options.borderColor||"#D8D8D8";var E=this.value.x,D=this.value.y*-1,I=_/this.options.viewWidth*E,M=P/this.options.viewHeight*D,N=_/this.options.viewWidth*this.value.width*this.value.scaleX,k=P/this.options.viewHeight*this.value.height*this.value.scaleY,F=_*.5,G=P*.5,V=this.value.anchorX*N*-1,j=(1-this.value.anchorY)*k*-1,H=this.value.angle*Math.PI/180*-1;S.translate(B+I+F,T+M+G),S.rotate(H),this.options.justDrawBorder?S.strokeRect(V,j,N,k):S.fillRect(V,j,N,k),S.restore(),S.fillStyle="#1568DD",S.beginPath(),S.arc(B+I+F,T+M+G,2,0,360),S.fill(),S.strokeStyle=A,S.fillStyle=O}dealTouch(S){var D,I;if(this.options.read_only)return;const{e:T,node:_}=S,w=this.width||_.size[0],B=T.canvasX-_.pos[0],A=T.canvasY-this.y-_.pos[1],O=clamp((B-15)/(w-30),0,1),R=clamp(A/this.height,0,1);let P=(O-.5)*this.options.viewWidth,E=(R-.5)*this.options.viewHeight*-1;this.value.x=P,this.value.y=E,_.properties.x!==void 0&&_.setProperty("x",P),_.properties.y!==void 0&&_.setProperty("y",E),_.properties[this.options.property]!==void 0&&_.setProperty(this.options.property,this.value),(I=_.onWidgetChanged)==null||I.call(_,(D=this.name)!=null?D:"",this.value,null,this),_.graph&&_.graph._version++}onClick(S){this.dealTouch(S)}onDrag(S){this.dealTouch(S)}}const{abs:abs$1,cos:cos$1,sin:sin$1,acos:acos$1,atan2,sqrt:sqrt$1,pow}=Math;function crt(L){return L<0?-pow(-L,1/3):pow(L,1/3)}const pi$1=Math.PI,tau=2*pi$1,quart=pi$1/2,epsilon=1e-6,nMax=Number.MAX_SAFE_INTEGER||9007199254740991,nMin=Number.MIN_SAFE_INTEGER||-9007199254740991,ZERO={x:0,y:0,z:0},utils={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(L,S){const T=S(L);let _=T.x*T.x+T.y*T.y;return typeof T.z<"u"&&(_+=T.z*T.z),sqrt$1(_)},compute:function(L,S,T){if(L===0)return S[0].t=0,S[0];const _=S.length-1;if(L===1)return S[_].t=1,S[_];const w=1-L;let B=S;if(_===0)return S[0].t=L,S[0];if(_===1){const O={x:w*B[0].x+L*B[1].x,y:w*B[0].y+L*B[1].y,t:L};return T&&(O.z=w*B[0].z+L*B[1].z),O}if(_<4){let O=w*w,R=L*L,P,E,D,I=0;_===2?(B=[B[0],B[1],B[2],ZERO],P=O,E=w*L*2,D=R):_===3&&(P=O*w,E=O*L*3,D=w*R*3,I=L*R);const M={x:P*B[0].x+E*B[1].x+D*B[2].x+I*B[3].x,y:P*B[0].y+E*B[1].y+D*B[2].y+I*B[3].y,t:L};return T&&(M.z=P*B[0].z+E*B[1].z+D*B[2].z+I*B[3].z),M}const A=JSON.parse(JSON.stringify(S));for(;A.length>1;){for(let O=0;O<A.length-1;O++)A[O]={x:A[O].x+(A[O+1].x-A[O].x)*L,y:A[O].y+(A[O+1].y-A[O].y)*L},typeof A[O].z<"u"&&(A[O].z=A[O].z+(A[O+1].z-A[O].z)*L);A.splice(A.length-1,1)}return A[0].t=L,A[0]},computeWithRatios:function(L,S,T,_){const w=1-L,B=T,A=S;let O=B[0],R=B[1],P=B[2],E=B[3],D;if(O*=w,R*=L,A.length===2)return D=O+R,{x:(O*A[0].x+R*A[1].x)/D,y:(O*A[0].y+R*A[1].y)/D,z:_?(O*A[0].z+R*A[1].z)/D:!1,t:L};if(O*=w,R*=2*w,P*=L*L,A.length===3)return D=O+R+P,{x:(O*A[0].x+R*A[1].x+P*A[2].x)/D,y:(O*A[0].y+R*A[1].y+P*A[2].y)/D,z:_?(O*A[0].z+R*A[1].z+P*A[2].z)/D:!1,t:L};if(O*=w,R*=1.5*w,P*=3*w,E*=L*L*L,A.length===4)return D=O+R+P+E,{x:(O*A[0].x+R*A[1].x+P*A[2].x+E*A[3].x)/D,y:(O*A[0].y+R*A[1].y+P*A[2].y+E*A[3].y)/D,z:_?(O*A[0].z+R*A[1].z+P*A[2].z+E*A[3].z)/D:!1,t:L}},derive:function(L,S){const T=[];for(let _=L,w=_.length,B=w-1;w>1;w--,B--){const A=[];for(let O=0,R;O<B;O++)R={x:B*(_[O+1].x-_[O].x),y:B*(_[O+1].y-_[O].y)},S&&(R.z=B*(_[O+1].z-_[O].z)),A.push(R);T.push(A),_=A}return T},between:function(L,S,T){return S<=L&&L<=T||utils.approximately(L,S)||utils.approximately(L,T)},approximately:function(L,S,T){return abs$1(L-S)<=(T||epsilon)},length:function(L){const T=utils.Tvalues.length;let _=0;for(let w=0,B;w<T;w++)B=.5*utils.Tvalues[w]+.5,_+=utils.Cvalues[w]*utils.arcfn(B,L);return .5*_},map:function(L,S,T,_,w){const B=T-S,A=w-_,O=L-S,R=O/B;return _+A*R},lerp:function(L,S,T){const _={x:S.x+L*(T.x-S.x),y:S.y+L*(T.y-S.y)};return S.z!==void 0&&T.z!==void 0&&(_.z=S.z+L*(T.z-S.z)),_},pointToString:function(L){let S=L.x+"/"+L.y;return typeof L.z<"u"&&(S+="/"+L.z),S},pointsToString:function(L){return"["+L.map(utils.pointToString).join(", ")+"]"},copy:function(L){return JSON.parse(JSON.stringify(L))},angle:function(L,S,T){const _=S.x-L.x,w=S.y-L.y,B=T.x-L.x,A=T.y-L.y,O=_*A-w*B,R=_*B+w*A;return atan2(O,R)},round:function(L,S){const T=""+L,_=T.indexOf(".");return parseFloat(T.substring(0,_+1+S))},dist:function(L,S){const T=L.x-S.x,_=L.y-S.y;return sqrt$1(T*T+_*_)},closest:function(L,S){let T=pow(2,63),_,w;return L.forEach(function(B,A){w=utils.dist(S,B),w<T&&(T=w,_=A)}),{mdist:T,mpos:_}},abcratio:function(L,S){if(S!==2&&S!==3)return!1;if(typeof L>"u")L=.5;else if(L===0||L===1)return L;const T=pow(L,S)+pow(1-L,S),_=T-1;return abs$1(_/T)},projectionratio:function(L,S){if(S!==2&&S!==3)return!1;if(typeof L>"u")L=.5;else if(L===0||L===1)return L;const T=pow(1-L,S),_=pow(L,S)+T;return T/_},lli8:function(L,S,T,_,w,B,A,O){const R=(L*_-S*T)*(w-A)-(L-T)*(w*O-B*A),P=(L*_-S*T)*(B-O)-(S-_)*(w*O-B*A),E=(L-T)*(B-O)-(S-_)*(w-A);return E==0?!1:{x:R/E,y:P/E}},lli4:function(L,S,T,_){const w=L.x,B=L.y,A=S.x,O=S.y,R=T.x,P=T.y,E=_.x,D=_.y;return utils.lli8(w,B,A,O,R,P,E,D)},lli:function(L,S){return utils.lli4(L,L.c,S,S.c)},makeline:function(L,S){return new Bezier(L.x,L.y,(L.x+S.x)/2,(L.y+S.y)/2,S.x,S.y)},findbbox:function(L){let S=nMax,T=nMax,_=nMin,w=nMin;return L.forEach(function(B){const A=B.bbox();S>A.x.min&&(S=A.x.min),T>A.y.min&&(T=A.y.min),_<A.x.max&&(_=A.x.max),w<A.y.max&&(w=A.y.max)}),{x:{min:S,mid:(S+_)/2,max:_,size:_-S},y:{min:T,mid:(T+w)/2,max:w,size:w-T}}},shapeintersections:function(L,S,T,_,w){if(!utils.bboxoverlap(S,_))return[];const B=[],A=[L.startcap,L.forward,L.back,L.endcap],O=[T.startcap,T.forward,T.back,T.endcap];return A.forEach(function(R){R.virtual||O.forEach(function(P){if(P.virtual)return;const E=R.intersects(P,w);E.length>0&&(E.c1=R,E.c2=P,E.s1=L,E.s2=T,B.push(E))})}),B},makeshape:function(L,S,T){const _=S.points.length,w=L.points.length,B=utils.makeline(S.points[_-1],L.points[0]),A=utils.makeline(L.points[w-1],S.points[0]),O={startcap:B,forward:L,back:S,endcap:A,bbox:utils.findbbox([B,L,S,A])};return O.intersections=function(R){return utils.shapeintersections(O,O.bbox,R,R.bbox,T)},O},getminmax:function(L,S,T){if(!T)return{min:0,max:0};let _=nMax,w=nMin,B,A;T.indexOf(0)===-1&&(T=[0].concat(T)),T.indexOf(1)===-1&&T.push(1);for(let O=0,R=T.length;O<R;O++)B=T[O],A=L.get(B),A[S]<_&&(_=A[S]),A[S]>w&&(w=A[S]);return{min:_,mid:(_+w)/2,max:w,size:w-_}},align:function(L,S){const T=S.p1.x,_=S.p1.y,w=-atan2(S.p2.y-_,S.p2.x-T),B=function(A){return{x:(A.x-T)*cos$1(w)-(A.y-_)*sin$1(w),y:(A.x-T)*sin$1(w)+(A.y-_)*cos$1(w)}};return L.map(B)},roots:function(L,S){S=S||{p1:{x:0,y:0},p2:{x:1,y:0}};const T=L.length-1,_=utils.align(L,S),w=function(Y){return 0<=Y&&Y<=1};if(T===2){const Y=_[0].y,z=_[1].y,W=_[2].y,Z=Y-2*z+W;if(Z!==0){const Q=-sqrt$1(z*z-Y*W),ee=-Y+z,te=-(Q+ee)/Z,re=-(-Q+ee)/Z;return[te,re].filter(w)}else if(z!==W&&Z===0)return[(2*z-W)/(2*z-2*W)].filter(w);return[]}const B=_[0].y,A=_[1].y,O=_[2].y,R=_[3].y;let P=-B+3*A-3*O+R,E=3*B-6*A+3*O,D=-3*B+3*A,I=B;if(utils.approximately(P,0)){if(utils.approximately(E,0))return utils.approximately(D,0)?[]:[-I/D].filter(w);const Y=sqrt$1(D*D-4*E*I),z=2*E;return[(Y-D)/z,(-D-Y)/z].filter(w)}E/=P,D/=P,I/=P;const M=(3*D-E*E)/3,N=M/3,k=(2*E*E*E-9*E*D+27*I)/27,F=k/2,G=F*F+N*N*N;let V,j,H,U,X;if(G<0){const Y=-M/3,z=Y*Y*Y,W=sqrt$1(z),Z=-k/(2*W),Q=Z<-1?-1:Z>1?1:Z,ee=acos$1(Q),te=crt(W),re=2*te;return H=re*cos$1(ee/3)-E/3,U=re*cos$1((ee+tau)/3)-E/3,X=re*cos$1((ee+2*tau)/3)-E/3,[H,U,X].filter(w)}else{if(G===0)return V=F<0?crt(-F):-crt(F),H=2*V-E/3,U=-V-E/3,[H,U].filter(w);{const Y=sqrt$1(G);return V=crt(-F+Y),j=crt(F+Y),[V-j-E/3].filter(w)}}},droots:function(L){if(L.length===3){const S=L[0],T=L[1],_=L[2],w=S-2*T+_;if(w!==0){const B=-sqrt$1(T*T-S*_),A=-S+T,O=-(B+A)/w,R=-(-B+A)/w;return[O,R]}else if(T!==_&&w===0)return[(2*T-_)/(2*(T-_))];return[]}if(L.length===2){const S=L[0],T=L[1];return S!==T?[S/(S-T)]:[]}return[]},curvature:function(L,S,T,_,w){let B,A,O,R,P=0,E=0;const D=utils.compute(L,S),I=utils.compute(L,T),M=D.x*D.x+D.y*D.y;if(_?(B=sqrt$1(pow(D.y*I.z-I.y*D.z,2)+pow(D.z*I.x-I.z*D.x,2)+pow(D.x*I.y-I.x*D.y,2)),A=pow(M+D.z*D.z,3/2)):(B=D.x*I.y-D.y*I.x,A=pow(M,3/2)),B===0||A===0)return{k:0,r:0};if(P=B/A,E=A/B,!w){const N=utils.curvature(L-.001,S,T,_,!0).k,k=utils.curvature(L+.001,S,T,_,!0).k;R=(k-P+(P-N))/2,O=(abs$1(k-P)+abs$1(P-N))/2}return{k:P,r:E,dk:R,adk:O}},inflections:function(L){if(L.length<4)return[];const S=utils.align(L,{p1:L[0],p2:L.slice(-1)[0]}),T=S[2].x*S[1].y,_=S[3].x*S[1].y,w=S[1].x*S[2].y,B=S[3].x*S[2].y,A=18*(-3*T+2*_+3*w-B),O=18*(3*T-_-3*w),R=18*(w-T);if(utils.approximately(A,0)){if(!utils.approximately(O,0)){let I=-R/O;if(0<=I&&I<=1)return[I]}return[]}const P=2*A;if(utils.approximately(P,0))return[];const E=O*O-4*A*R;if(E<0)return[];const D=Math.sqrt(E);return[(D-O)/P,-(O+D)/P].filter(function(I){return 0<=I&&I<=1})},bboxoverlap:function(L,S){const T=["x","y"],_=T.length;for(let w=0,B,A,O,R;w<_;w++)if(B=T[w],A=L[B].mid,O=S[B].mid,R=(L[B].size+S[B].size)/2,abs$1(A-O)>=R)return!1;return!0},expandbox:function(L,S){S.x.min<L.x.min&&(L.x.min=S.x.min),S.y.min<L.y.min&&(L.y.min=S.y.min),S.z&&S.z.min<L.z.min&&(L.z.min=S.z.min),S.x.max>L.x.max&&(L.x.max=S.x.max),S.y.max>L.y.max&&(L.y.max=S.y.max),S.z&&S.z.max>L.z.max&&(L.z.max=S.z.max),L.x.mid=(L.x.min+L.x.max)/2,L.y.mid=(L.y.min+L.y.max)/2,L.z&&(L.z.mid=(L.z.min+L.z.max)/2),L.x.size=L.x.max-L.x.min,L.y.size=L.y.max-L.y.min,L.z&&(L.z.size=L.z.max-L.z.min)},pairiteration:function(L,S,T){const _=L.bbox(),w=S.bbox(),B=1e5,A=T||.5;if(_.x.size+_.y.size<A&&w.x.size+w.y.size<A)return[(B*(L._t1+L._t2)/2|0)/B+"/"+(B*(S._t1+S._t2)/2|0)/B];let O=L.split(.5),R=S.split(.5),P=[{left:O.left,right:R.left},{left:O.left,right:R.right},{left:O.right,right:R.right},{left:O.right,right:R.left}];P=P.filter(function(D){return utils.bboxoverlap(D.left.bbox(),D.right.bbox())});let E=[];return P.length===0||(P.forEach(function(D){E=E.concat(utils.pairiteration(D.left,D.right,A))}),E=E.filter(function(D,I){return E.indexOf(D)===I})),E},getccenter:function(L,S,T){const _=S.x-L.x,w=S.y-L.y,B=T.x-S.x,A=T.y-S.y,O=_*cos$1(quart)-w*sin$1(quart),R=_*sin$1(quart)+w*cos$1(quart),P=B*cos$1(quart)-A*sin$1(quart),E=B*sin$1(quart)+A*cos$1(quart),D=(L.x+S.x)/2,I=(L.y+S.y)/2,M=(S.x+T.x)/2,N=(S.y+T.y)/2,k=D+O,F=I+R,G=M+P,V=N+E,j=utils.lli8(D,I,k,F,M,N,G,V),H=utils.dist(j,L);let U=atan2(L.y-j.y,L.x-j.x),X=atan2(S.y-j.y,S.x-j.x),Y=atan2(T.y-j.y,T.x-j.x),z;return U<Y?((U>X||X>Y)&&(U+=tau),U>Y&&(z=Y,Y=U,U=z)):Y<X&&X<U?(z=Y,Y=U,U=z):Y+=tau,j.s=U,j.e=Y,j.r=H,j},numberSort:function(L,S){return L-S}};class PolyBezier{constructor(S){this.curves=[],this._3d=!1,S&&(this.curves=S,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(S){return utils.pointsToString(S.points)}).join(", ")+"]"}addCurve(S){this.curves.push(S),this._3d=this._3d||S._3d}length(){return this.curves.map(function(S){return S.length()}).reduce(function(S,T){return S+T})}curve(S){return this.curves[S]}bbox(){const S=this.curves;for(var T=S[0].bbox(),_=1;_<S.length;_++)utils.expandbox(T,S[_].bbox());return T}offset(S){const T=[];return this.curves.forEach(function(_){T.push(..._.offset(S))}),new PolyBezier(T)}}const{abs,min,max,cos,sin,acos,sqrt}=Math,pi=Math.PI;class Bezier{constructor(S){let T=S&&S.forEach?S:Array.from(arguments).slice(),_=!1;if(typeof T[0]=="object"){_=T.length;const M=[];T.forEach(function(N){["x","y","z"].forEach(function(k){typeof N[k]<"u"&&M.push(N[k])})}),T=M}let w=!1;const B=T.length;if(_){if(_>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");w=!0}}else if(B!==6&&B!==8&&B!==9&&B!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const A=this._3d=!w&&(B===9||B===12)||S&&S[0]&&typeof S[0].z<"u",O=this.points=[];for(let M=0,N=A?3:2;M<B;M+=N){var R={x:T[M],y:T[M+1]};A&&(R.z=T[M+2]),O.push(R)}const P=this.order=O.length-1,E=this.dims=["x","y"];A&&E.push("z"),this.dimlen=E.length;const D=utils.align(O,{p1:O[0],p2:O[P]}),I=utils.dist(O[0],O[P]);this._linear=D.reduce((M,N)=>M+abs(N.y),0)<I/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(S,T,_,w){if(typeof w>"u"&&(w=.5),w===0)return new Bezier(T,T,_);if(w===1)return new Bezier(S,T,T);const B=Bezier.getABC(2,S,T,_,w);return new Bezier(S,B.A,_)}static cubicFromPoints(S,T,_,w,B){typeof w>"u"&&(w=.5);const A=Bezier.getABC(3,S,T,_,w);typeof B>"u"&&(B=utils.dist(T,A.C));const O=B*(1-w)/w,R=utils.dist(S,_),P=(_.x-S.x)/R,E=(_.y-S.y)/R,D=B*P,I=B*E,M=O*P,N=O*E,k={x:T.x-D,y:T.y-I},F={x:T.x+M,y:T.y+N},G=A.A,V={x:G.x+(k.x-G.x)/(1-w),y:G.y+(k.y-G.y)/(1-w)},j={x:G.x+(F.x-G.x)/w,y:G.y+(F.y-G.y)/w},H={x:S.x+(V.x-S.x)/w,y:S.y+(V.y-S.y)/w},U={x:_.x+(j.x-_.x)/(1-w),y:_.y+(j.y-_.y)/(1-w)};return new Bezier(S,H,U,_)}static getUtils(){return utils}getUtils(){return Bezier.getUtils()}static get PolyBezier(){return PolyBezier}valueOf(){return this.toString()}toString(){return utils.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const S=this.points,T=S[0].x,_=S[0].y,w=["M",T,_,this.order===2?"Q":"C"];for(let B=1,A=S.length;B<A;B++)w.push(S[B].x),w.push(S[B].y);return w.join(" ")}setRatios(S){if(S.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=S,this._lut=[]}verify(){const S=this.coordDigest();S!==this._print&&(this._print=S,this.update())}coordDigest(){return this.points.map(function(S,T){return""+T+S.x+S.y+(S.z?S.z:0)}).join("")}update(){this._lut=[],this.dpoints=utils.derive(this.points,this._3d),this.computedirection()}computedirection(){const S=this.points,T=utils.angle(S[0],S[this.order],S[1]);this.clockwise=T>0}length(){return utils.length(this.derivative.bind(this))}static getABC(S=2,T,_,w,B=.5){const A=utils.projectionratio(B,S),O=1-A,R={x:A*T.x+O*w.x,y:A*T.y+O*w.y},P=utils.abcratio(B,S);return{A:{x:_.x+(_.x-R.x)/P,y:_.y+(_.y-R.y)/P},B:_,C:R,S:T,E:w}}getABC(S,T){T=T||this.get(S);let _=this.points[0],w=this.points[this.order];return Bezier.getABC(this.order,_,T,w,S)}getLUT(S){if(this.verify(),S=S||100,this._lut.length===S+1)return this._lut;this._lut=[],S++,this._lut=[];for(let T=0,_,w;T<S;T++)w=T/(S-1),_=this.compute(w),_.t=w,this._lut.push(_);return this._lut}on(S,T){T=T||5;const _=this.getLUT(),w=[];for(let B=0,A,O=0;B<_.length;B++)A=_[B],utils.dist(A,S)<T&&(w.push(A),O+=B/_.length);return w.length?t/=w.length:!1}project(S){const T=this.getLUT(),_=T.length-1,w=utils.closest(T,S),B=w.mpos,A=(B-1)/_,O=(B+1)/_,R=.1/_;let P=w.mdist,E=A,D=E,I;P+=1;for(let M;E<O+R;E+=R)I=this.compute(E),M=utils.dist(S,I),M<P&&(P=M,D=E);return D=D<0?0:D>1?1:D,I=this.compute(D),I.t=D,I.d=P,I}get(S){return this.compute(S)}point(S){return this.points[S]}compute(S){return this.ratios?utils.computeWithRatios(S,this.points,this.ratios,this._3d):utils.compute(S,this.points,this._3d,this.ratios)}raise(){const S=this.points,T=[S[0]],_=S.length;for(let w=1,B,A;w<_;w++)B=S[w],A=S[w-1],T[w]={x:(_-w)/_*B.x+w/_*A.x,y:(_-w)/_*B.y+w/_*A.y};return T[_]=S[_-1],new Bezier(T)}derivative(S){return utils.compute(S,this.dpoints[0],this._3d)}dderivative(S){return utils.compute(S,this.dpoints[1],this._3d)}align(){let S=this.points;return new Bezier(utils.align(S,{p1:S[0],p2:S[S.length-1]}))}curvature(S){return utils.curvature(S,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return utils.inflections(this.points)}normal(S){return this._3d?this.__normal3(S):this.__normal2(S)}__normal2(S){const T=this.derivative(S),_=sqrt(T.x*T.x+T.y*T.y);return{t:S,x:-T.y/_,y:T.x/_}}__normal3(S){const T=this.derivative(S),_=this.derivative(S+.01),w=sqrt(T.x*T.x+T.y*T.y+T.z*T.z),B=sqrt(_.x*_.x+_.y*_.y+_.z*_.z);T.x/=w,T.y/=w,T.z/=w,_.x/=B,_.y/=B,_.z/=B;const A={x:_.y*T.z-_.z*T.y,y:_.z*T.x-_.x*T.z,z:_.x*T.y-_.y*T.x},O=sqrt(A.x*A.x+A.y*A.y+A.z*A.z);A.x/=O,A.y/=O,A.z/=O;const R=[A.x*A.x,A.x*A.y-A.z,A.x*A.z+A.y,A.x*A.y+A.z,A.y*A.y,A.y*A.z-A.x,A.x*A.z-A.y,A.y*A.z+A.x,A.z*A.z];return{t:S,x:R[0]*T.x+R[1]*T.y+R[2]*T.z,y:R[3]*T.x+R[4]*T.y+R[5]*T.z,z:R[6]*T.x+R[7]*T.y+R[8]*T.z}}hull(S){let T=this.points,_=[],w=[],B=0;for(w[B++]=T[0],w[B++]=T[1],w[B++]=T[2],this.order===3&&(w[B++]=T[3]);T.length>1;){_=[];for(let A=0,O,R=T.length-1;A<R;A++)O=utils.lerp(S,T[A],T[A+1]),w[B++]=O,_.push(O);T=_}return w}split(S,T){if(S===0&&T)return this.split(T).left;if(T===1)return this.split(S).right;const _=this.hull(S),w={left:this.order===2?new Bezier([_[0],_[3],_[5]]):new Bezier([_[0],_[4],_[7],_[9]]),right:this.order===2?new Bezier([_[5],_[4],_[2]]):new Bezier([_[9],_[8],_[6],_[3]]),span:_};return w.left._t1=utils.map(0,0,1,this._t1,this._t2),w.left._t2=utils.map(S,0,1,this._t1,this._t2),w.right._t1=utils.map(S,0,1,this._t1,this._t2),w.right._t2=utils.map(1,0,1,this._t1,this._t2),T?(T=utils.map(T,S,1,0,1),w.right.split(T).left):w}extrema(){const S={};let T=[];return this.dims.forEach((function(_){let w=function(A){return A[_]},B=this.dpoints[0].map(w);S[_]=utils.droots(B),this.order===3&&(B=this.dpoints[1].map(w),S[_]=S[_].concat(utils.droots(B))),S[_]=S[_].filter(function(A){return A>=0&&A<=1}),T=T.concat(S[_].sort(utils.numberSort))}).bind(this)),S.values=T.sort(utils.numberSort).filter(function(_,w){return T.indexOf(_)===w}),S}bbox(){const S=this.extrema(),T={};return this.dims.forEach((function(_){T[_]=utils.getminmax(this,_,S[_])}).bind(this)),T}overlaps(S){const T=this.bbox(),_=S.bbox();return utils.bboxoverlap(T,_)}offset(S,T){if(typeof T<"u"){const _=this.get(S),w=this.normal(S),B={c:_,n:w,x:_.x+w.x*T,y:_.y+w.y*T};return this._3d&&(B.z=_.z+w.z*T),B}if(this._linear){const _=this.normal(0),w=this.points.map(function(B){const A={x:B.x+S*_.x,y:B.y+S*_.y};return B.z&&_.z&&(A.z=B.z+S*_.z),A});return[new Bezier(w)]}return this.reduce().map(function(_){return _._linear?_.offset(S)[0]:_.scale(S)})}simple(){if(this.order===3){const w=utils.angle(this.points[0],this.points[3],this.points[1]),B=utils.angle(this.points[0],this.points[3],this.points[2]);if(w>0&&B<0||w<0&&B>0)return!1}const S=this.normal(0),T=this.normal(1);let _=S.x*T.x+S.y*T.y;return this._3d&&(_+=S.z*T.z),abs(acos(_))<pi/3}reduce(){let S,T=0,_=0,w=.01,B,A=[],O=[],R=this.extrema().values;for(R.indexOf(0)===-1&&(R=[0].concat(R)),R.indexOf(1)===-1&&R.push(1),T=R[0],S=1;S<R.length;S++)_=R[S],B=this.split(T,_),B._t1=T,B._t2=_,A.push(B),T=_;return A.forEach(function(P){for(T=0,_=0;_<=1;)for(_=T+w;_<=1+w;_+=w)if(B=P.split(T,_),!B.simple()){if(_-=w,abs(T-_)<w)return[];B=P.split(T,_),B._t1=utils.map(T,0,1,P._t1,P._t2),B._t2=utils.map(_,0,1,P._t1,P._t2),O.push(B),T=_;break}T<1&&(B=P.split(T,1),B._t1=utils.map(T,0,1,P._t1,P._t2),B._t2=P._t2,O.push(B))}),O}translate(S,T,_){_=typeof _=="number"?_:T;const w=this.order;let B=this.points.map((A,O)=>(1-O/w)*T+O/w*_);return new Bezier(this.points.map((A,O)=>({x:A.x+S.x*B[O],y:A.y+S.y*B[O]})))}scale(S){const T=this.order;let _=!1;if(typeof S=="function"&&(_=S),_&&T===2)return this.raise().scale(_);const w=this.clockwise,B=this.points;if(this._linear)return this.translate(this.normal(0),_?_(0):S,_?_(1):S);const A=_?_(0):S,O=_?_(1):S,R=[this.offset(0,10),this.offset(1,10)],P=[],E=utils.lli4(R[0],R[0].c,R[1],R[1].c);if(!E)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(D){const I=P[D*T]=utils.copy(B[D*T]);I.x+=(D?O:A)*R[D].n.x,I.y+=(D?O:A)*R[D].n.y}),_?([0,1].forEach(function(D){if(!(T===2&&D)){var I=B[D+1],M={x:I.x-E.x,y:I.y-E.y},N=_?_((D+1)/T):S;_&&!w&&(N=-N);var k=sqrt(M.x*M.x+M.y*M.y);M.x/=k,M.y/=k,P[D+1]={x:I.x+N*M.x,y:I.y+N*M.y}}}),new Bezier(P)):([0,1].forEach(D=>{if(T===2&&D)return;const I=P[D*T],M=this.derivative(D),N={x:I.x+M.x,y:I.y+M.y};P[D+1]=utils.lli4(I,N,E,B[D+1])}),new Bezier(P))}outline(S,T,_,w){if(T=T===void 0?S:T,this._linear){const U=this.normal(0),X=this.points[0],Y=this.points[this.points.length-1];let z,W,Z;_===void 0&&(_=S,w=T),z={x:X.x+U.x*S,y:X.y+U.y*S},Z={x:Y.x+U.x*_,y:Y.y+U.y*_},W={x:(z.x+Z.x)/2,y:(z.y+Z.y)/2};const Q=[z,W,Z];z={x:X.x-U.x*T,y:X.y-U.y*T},Z={x:Y.x-U.x*w,y:Y.y-U.y*w},W={x:(z.x+Z.x)/2,y:(z.y+Z.y)/2};const ee=[Z,W,z],te=utils.makeline(ee[2],Q[0]),re=utils.makeline(Q[2],ee[0]),ie=[te,new Bezier(Q),re,new Bezier(ee)];return new PolyBezier(ie)}const B=this.reduce(),A=B.length,O=[];let R=[],P,E=0,D=this.length();const I=typeof _<"u"&&typeof w<"u";function M(U,X,Y,z,W){return function(Z){const Q=z/Y,ee=(z+W)/Y,te=X-U;return utils.map(Z,0,1,U+Q*te,U+ee*te)}}B.forEach(function(U){const X=U.length();I?(O.push(U.scale(M(S,_,D,E,X))),R.push(U.scale(M(-T,-w,D,E,X)))):(O.push(U.scale(S)),R.push(U.scale(-T))),E+=X}),R=R.map(function(U){return P=U.points,P[3]?U.points=[P[3],P[2],P[1],P[0]]:U.points=[P[2],P[1],P[0]],U}).reverse();const N=O[0].points[0],k=O[A-1].points[O[A-1].points.length-1],F=R[A-1].points[R[A-1].points.length-1],G=R[0].points[0],V=utils.makeline(F,N),j=utils.makeline(k,G),H=[V].concat(O).concat([j]).concat(R);return new PolyBezier(H)}outlineshapes(S,T,_){T=T||S;const w=this.outline(S,T).curves,B=[];for(let A=1,O=w.length;A<O/2;A++){const R=utils.makeshape(w[A],w[O-A],_);R.startcap.virtual=A>1,R.endcap.virtual=A<O/2-1,B.push(R)}return B}intersects(S,T){return S?S.p1&&S.p2?this.lineIntersects(S):(S instanceof Bezier&&(S=S.reduce()),this.curveintersects(this.reduce(),S,T)):this.selfintersects(T)}lineIntersects(S){const T=min(S.p1.x,S.p2.x),_=min(S.p1.y,S.p2.y),w=max(S.p1.x,S.p2.x),B=max(S.p1.y,S.p2.y);return utils.roots(this.points,S).filter(A=>{var O=this.get(A);return utils.between(O.x,T,w)&&utils.between(O.y,_,B)})}selfintersects(S){const T=this.reduce(),_=T.length-2,w=[];for(let B=0,A,O,R;B<_;B++)O=T.slice(B,B+1),R=T.slice(B+2),A=this.curveintersects(O,R,S),w.push(...A);return w}curveintersects(S,T,_){const w=[];S.forEach(function(A){T.forEach(function(O){A.overlaps(O)&&w.push({left:A,right:O})})});let B=[];return w.forEach(function(A){const O=utils.pairiteration(A.left,A.right,_);O.length>0&&(B=B.concat(O))}),B}arcs(S){return S=S||.5,this._iterate(S,[])}_error(S,T,_,w){const B=(w-_)/4,A=this.get(_+B),O=this.get(w-B),R=utils.dist(S,T),P=utils.dist(S,A),E=utils.dist(S,O);return abs(P-R)+abs(E-R)}_iterate(S,T){let _=0,w=1,B;do{B=0,w=1;let A=this.get(_),O,R,P,E,D=!1,I=!1,M,N=w,k=1;do if(I=D,E=P,N=(_+w)/2,O=this.get(N),R=this.get(w),P=utils.getccenter(A,O,R),P.interval={start:_,end:w},D=this._error(P,A,_,w)<=S,M=I&&!D,M||(k=w),D){if(w>=1){if(P.interval.end=k=1,E=P,w>1){let G={x:P.x+P.r*cos(P.e),y:P.y+P.r*sin(P.e)};P.e+=utils.angle({x:P.x,y:P.y},G,this.get(1))}break}w=w+(w-_)/2}else w=N;while(!M&&B++<100);if(B>=100)break;E=E||P,T.push(E),_=k}while(w<1);return T}}class curveWidget extends BaseWidget{get height(){return this._height||100}computeLayoutSize(S){var T=S.width-30,_=this.options.viewHeight/this.options.viewWidth;let w=_*T;return this._height=w,{minHeight:w+4,maxHeight:w+4,minWidth:T,maxWidth:T}}constructor(S){super(S),this.type="curve",this.value=S.value,this.options=S.options,this.selectPoint=-1}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){const A=S.strokeStyle,O=S.fillStyle,R=S.font,P=S.textAlign,E=S.textBaseline;let D=[];for(var I=0;I<this.value.length;I++)D.push({x:this.value[I],y:this.value[I+1]}),I+=1;let M=[];for(var I=0;I<D.length;I++)M.push(D[I].x),M.push(D[I].y);var N=new Bezier(this.value);_-=B*2;var k=this.options.viewHeight/this.options.viewWidth,F=k*_;S.fillStyle=this.background_color,S.fillRect(B,T,_,F),S.strokeStyle=this.outline_color,S.beginPath(),S.rect(B,T,_,F),S.stroke(),S.save(),S.clip();var G=this.value.x||0,V=this.value.y*-1||0;_/this.options.viewWidth*G,F/this.options.viewHeight*V;var j=_*.5,H=F*.5,U=Z=>B+_/this.options.viewWidth*Z+j,X=Z=>T+F/this.options.viewHeight*Z*-1+H;S.restore(),S.fillStyle="#1568DD",S.beginPath();for(var Y=0;Y<=1;Y+=.01){var z=N.get(Y);Y==0?S.moveTo(U(z.x),X(z.y)):S.lineTo(U(z.x),X(z.y))}S.stroke(),S.strokeStyle="#FFFFFF";for(var W=Z=>{var Q=D[Z];Z==0?S.fillStyle="#7AFF16":Z==D.length-1?S.fillStyle="#FF1616":S.fillStyle="#1568DD",S.beginPath(),S.arc(U(Q.x),X(Q.y),4,0,360),S.fill(),Z!=0&&Z!=D.length-1&&w&&(S.fillStyle="#FFFFFF",S.textAlign="center",S.textBaseline="middle",S.font="8px Arial",S.fillText(Z+"",U(Q.x),X(Q.y)+1)),this.selectPoint==Z&&S.stroke()},I=0;I<D.length;I++)W(I);S.textAlign=P,S.textBaseline=E,S.font=R,S.strokeStyle=A,S.fillStyle=O}remonveCtrlPoint(S){var _,w;if(this.value.length==6){console.log("至少要有3个控制点生成曲线！");return}if(this.selectPoint>=0){var T=this.selectPoint*2;this.value.splice(T,2),this.selectPoint=-1,S!=null&&((w=S.onWidgetChanged)==null||w.call(S,(_=this.name)!=null?_:"",this.value,null,this))}}addCtrlPoint(S){var _,w;if(this.selectPoint>0){var T=this.selectPoint*2;this.value.splice(this.selectPoint,0,this.value[T]+30,this.value[T+1]+30)}else this.value.push(0),this.value.push(0);S!=null&&((w=S.onWidgetChanged)==null||w.call(S,(_=this.name)!=null?_:"",this.value,null,this))}dealTouch(S,T){var V,j;if(this.options.read_only)return;const{e:_,node:w}=S,B=this.width||w.size[0],A=_.canvasX-w.pos[0],O=_.canvasY-this.y-w.pos[1],R=(A-15)/(B-30),P=O/this.height;let E=(R-.5)*this.options.viewWidth,D=(P-.5)*this.options.viewHeight*-1;var I=4/(B/this.options.viewWidth);let M=[];for(var N=0;N<this.value.length;N++)M.push({x:this.value[N],y:this.value[N+1],i:N}),N+=1;for(var k=-1,N=0;N<M.length;N++){var F=M[N].x-E,G=M[N].y-D;if(Math.sqrt(F*F+G*G)<I){console.log("点击了第几个点？",N),k=N;break}}k!=-1&&this.selectPoint!=k&&(this.selectPoint=k),this.selectPoint>=0&&(M[this.selectPoint].x=E,M[this.selectPoint].y=D,this.value[M[this.selectPoint].i]=E,this.value[M[this.selectPoint].i+1]=D,(j=w.onWidgetChanged)==null||j.call(w,(V=this.name)!=null?V:"",this.value,null,this)),w.graph&&w.graph._version++}onClick(S){this.dealTouch(S,!0)}onDrag(S){this.dealTouch(S,!1)}}class LinkNodeWidget extends BaseWidget{constructor(S){var T;super(S),this.type="linknode",this.clicked=(T=S.clicked)!=null?T:!1}drawWidget(S,{y:T,width:_,show_text:w=!0,margin:B=15}){const A=S.textAlign,O=S.strokeStyle,R=S.fillStyle,{height:P}=this;let E=_-B*2,D=0;var I=N=>{S.fillStyle=this.background_color,this.clickeName==N&&(S.fillStyle="#AAA",this.clickeName=""),S.fillRect(B+D,T,E,P),w&&!this.computedDisabled&&(S.strokeStyle=this.outline_color,S.strokeRect(B+D,T,E,P)),w&&(S.textAlign="center",S.fillStyle=this.text_color,S.fillText(N,E*.5+D+B,T+P*.7)),D+=E+2};if(this.options.buttons!=null){E=E/this.options.buttons.length,E-=2;for(var M=0;M<this.options.buttons.length;M++)I(this.options.buttons[M])}else I(this.label||this.name||"");S.textAlign=A,S.strokeStyle=O,S.fillStyle=R}onClick(S){var I;const{e:T,node:_,canvas:w}=S,B=w.graph_mouse,A=T.canvasX-_.pos[0];T.canvasY-this.y-_.pos[1];const{height:O}=this,R=this.width||_.size[0];let P=15,E=R-P*2;if(this.options.buttons!=null){E=E/this.options.buttons.length-2,this.clickeName="";for(var D=0;D<this.options.buttons.length;D++){let M=E*D+P+D*2,N=E*(D+1)+P+D*2;if(M<A&&A<N){this.clickeName=this.options.buttons[D];break}}}else this.clickeName=this.label||this.name||"";this.clicked=!0,w.setDirty(!0),(I=this.callback)==null||I.call(this,this,w,_,B,T)}}const WIDGET_TYPE_MAP={button:ButtonWidget,toggle:BooleanWidget,slider:SliderWidget,knob:KnobWidget,combo:ComboWidget,number:NumberWidget,string:TextWidget,text:TextWidget,ccnode:ccNodeWidget,curve:curveWidget,linknode:LinkNodeWidget};var Bi,Li,pr,Ys,Ws,Un,Ni,Hn,Xn,tn,zs,Zs,Js,Ks,$s,Qs;const Ei=class Ei{constructor(S,T){dr(this,pr);dr(this,Bi);dr(this,Li);this.graph=null,this.type="",this.inputs=[],this.outputs=[],this.connections=[],this.properties={},this.properties_info=[],this.flags={},this.order=0,this.mode=LGraphEventMode.ALWAYS,this.badges=[],this.badgePosition=BadgePosition.TopLeft,_r(this,Bi,new Float32Array(4)),_r(this,Li,new Float32Array(4)),this._posSize=new Float32Array(4),this._pos=this._posSize.subarray(0,2),this._size=this._posSize.subarray(2,4),this.id=LiteGraph.use_uuids?LiteGraph.uuidv4():-1,this.title=S||"Unnamed",this.type=T!=null?T:"",this.size=[LiteGraph.NODE_WIDTH,60],this.pos=[10,10],this.strokeStyles={error:Zt(this,pr,Ys),selected:Zt(this,pr,Ws)}}get titleFontStyle(){return"".concat(LiteGraph.NODE_TEXT_SIZE,"px Arial")}get innerFontStyle(){return"normal ".concat(LiteGraph.NODE_SUBTEXT_SIZE,"px Arial")}get renderingColor(){return this.color||this.constructor.color||LiteGraph.NODE_DEFAULT_COLOR}get renderingBgColor(){return this.bgcolor||this.constructor.bgcolor||LiteGraph.NODE_DEFAULT_BGCOLOR}get renderingBoxColor(){var S;if(this.boxcolor)return this.boxcolor;if(LiteGraph.node_box_coloured_when_on){if(this.action_triggered)return"#FFF";if(this.execute_triggered)return"#AAA"}if(LiteGraph.node_box_coloured_by_mode){const T=LiteGraph.NODE_MODES_COLORS[(S=this.mode)!=null?S:LGraphEventMode.ALWAYS];if(T)return T}return LiteGraph.NODE_DEFAULT_BOXCOLOR}setColorOption(S){S==null?(delete this.color,delete this.bgcolor):(this.color=S.color,this.bgcolor=S.bgcolor)}getColorOption(){var S;return(S=Object.values(LGraphCanvas.node_colors).find(T=>T.color===this.color&&T.bgcolor===this.bgcolor))!=null?S:null}get renderArea(){return Ut(this,Bi)}get boundingRect(){return Ut(this,Li)}get pos(){return this._pos}set pos(S){!S||S.length<2||(this._pos[0]=S[0],this._pos[1]=S[1])}get size(){return this._size}set size(S){!S||S.length<2||(this._size[0]=S[0],this._size[1]=S[1])}get renderingSize(){var S;return this.flags.collapsed?[(S=this._collapsed_width)!=null?S:0,0]:this._size}get shape(){return this._shape}set shape(S){switch(S){case"default":delete this._shape;break;case"box":this._shape=RenderShape.BOX;break;case"round":this._shape=RenderShape.ROUND;break;case"circle":this._shape=RenderShape.CIRCLE;break;case"card":this._shape=RenderShape.CARD;break;default:this._shape=S}}get renderingShape(){return this._shape||this.constructor.shape||LiteGraph.NODE_DEFAULT_SHAPE}get is_selected(){return this.selected}set is_selected(S){this.selected=S}get title_mode(){var S;return(S=this.constructor.title_mode)!=null?S:TitleMode.NORMAL_TITLE}getRealLinkNode(){var S=this.getInputLink(0);if(S==null)return null;if(this.graph._is_subgraph==!0){let T=this.graph.getNodeById(S.origin_id),_=this.graph._subgraph_node.inputs.findIndex(w=>w.name==T.properties.name);if(_!=-1){let w=this.graph._subgraph_node.getInputLink(_);return w==null?null:this.graph._subgraph_node.graph.getNodeById(w.origin_id)}}else return this.graph.getNodeById(S.origin_id)}getIdWithGraph(){return this.graph==null?this.id:this.graph._subgraph_node!=null?this.id+"_"+this.graph._subgraph_node.id:this.id}configure(S){var T,_,w,B,A,O,R,P,E,D,I;this.graph&&this.graph._version++;for(const M in S){if(M=="properties"){for(const N in S.properties)this.properties[N]=S.properties[N],(T=this.onPropertyChanged)==null||T.call(this,N,S.properties[N]);continue}S[M]!=null&&(typeof S[M]=="object"?(_=this[M])!=null&&_.configure?(w=this[M])==null||w.configure(S[M]):this[M]=LiteGraph.cloneObject(S[M],this[M]):this[M]=S[M])}S.title||(this.title=this.constructor.title),(B=this.inputs)!=null||(this.inputs=[]),this.inputs=this.inputs.map(M=>toClass(NodeInputSlot,M));for(const[M,N]of this.inputs.entries()){const k=this.graph&&N.link!=null?this.graph._links.get(N.link):null;(A=this.onConnectionsChange)==null||A.call(this,NodeSlotType.INPUT,M,!0,k,N),(O=this.onInputAdded)==null||O.call(this,N)}(R=this.outputs)!=null||(this.outputs=[]),this.outputs=this.outputs.map(M=>toClass(NodeOutputSlot,M));for(const[M,N]of this.outputs.entries())if(N.links){for(const k of N.links){const F=this.graph?this.graph._links.get(k):null;(P=this.onConnectionsChange)==null||P.call(this,NodeSlotType.OUTPUT,M,!0,F,N)}(E=this.onOutputAdded)==null||E.call(this,N)}if(this.widgets){for(const M of this.widgets)M&&(D=M.options)!=null&&D.property&&this.properties[M.options.property]!=null&&(M.value=JSON.parse(JSON.stringify(this.properties[M.options.property])));if(S.widgets_values)for(let M=0;M<S.widgets_values.length;++M){const N=this.widgets[M];N&&(N.value=S.widgets_values[M])}}this.pinned&&(this.resizable=!1),(I=this.onConfigure)==null||I.call(this,S)}serialize(){var _;const S={id:this.id,type:this.type,pos:[this.pos[0],this.pos[1]],size:[this.size[0],this.size[1]],flags:LiteGraph.cloneObject(this.flags),order:this.order,mode:this.mode,showAdvanced:this.showAdvanced};if(this.constructor===Ei&&this.last_serialization)return this.last_serialization;this.inputs&&(S.inputs=this.inputs.map(w=>inputAsSerialisable(w))),this.outputs&&(S.outputs=this.outputs.map(w=>outputAsSerialisable(w))),this.title&&this.title!=this.constructor.title&&(S.title=this.title),this.properties&&(S.properties=LiteGraph.cloneObject(this.properties));const{widgets:T}=this;if(T&&this.serialize_widgets){S.widgets_values=[];for(const[w,B]of T.entries())S.widgets_values[w]=B?B.value:null}return S.type||(S.type=this.constructor.type),this.color&&(S.color=this.color),this.bgcolor&&(S.bgcolor=this.bgcolor),this.boxcolor&&(S.boxcolor=this.boxcolor),this.shape&&(S.shape=this.shape),(_=this.onSerialize)!=null&&_.call(this,S)&&console.warn("node onSerialize shouldnt return anything, data should be stored in the object pass in the first parameter"),S}clone(){if(this.type==null)return null;const S=LiteGraph.createNode(this.type);if(!S)return null;const T=LiteGraph.cloneObject(this.serialize()),{inputs:_,outputs:w}=T;if(_)for(const B of _)B.link=null;if(w)for(const{links:B}of w)B&&(B.length=0);return delete T.id,LiteGraph.use_uuids&&(T.id=LiteGraph.uuidv4()),S.configure(T),S}onGetOutputs(){return[["被引用","lgraphNode"]]}toString(){return JSON.stringify(this.serialize())}getTitle(){return this.title||this.constructor.title}setProperty(S,T){var w;if(this.properties||(this.properties={}),T===this.properties[S])return;const _=this.properties[S];if(this.properties[S]=T,((w=this.onPropertyChanged)==null?void 0:w.call(this,S,T,_))===!1&&(this.properties[S]=_),this.widgets){for(const B of this.widgets)if(B&&B.options.property==S){B.value=T;break}}}setOutputData(S,T){const{outputs:_}=this;if(!_||S==-1||S>=_.length)return;const w=_[S];if(!w)return;if(w._data=T,!this.graph)throw new NullGraphError;const{links:B}=_[S];if(B)for(const A of B){const O=this.graph._links.get(A);O&&(O.data=T)}}setOutputDataType(S,T){const{outputs:_}=this;if(!_||S==-1||S>=_.length)return;const w=_[S];if(!w)return;if(w.type=T,!this.graph)throw new NullGraphError;const{links:B}=_[S];if(B)for(const A of B){const O=this.graph._links.get(A);O&&(O.type=T)}}getInputData(S,T){var A;if(!this.inputs||S>=this.inputs.length||this.inputs[S].link==null)return;if(!this.graph)throw new NullGraphError;const _=this.inputs[S].link,w=this.graph._links.get(_);if(!w)return null;if(!T)return w.data;const B=this.graph.getNodeById(w.origin_id);return B&&(B.updateOutputData?B.updateOutputData(w.origin_slot):(A=B.onExecute)==null||A.call(B)),w.data}getInputDataType(S){if(!this.inputs||S>=this.inputs.length||this.inputs[S].link==null)return null;if(!this.graph)throw new NullGraphError;const T=this.inputs[S].link,_=this.graph._links.get(T);if(!_)return null;const w=this.graph.getNodeById(_.origin_id);if(!w)return _.type;const B=w.outputs[_.origin_slot];return B?B.type:null}getInputDataByName(S,T){const _=this.findInputSlot(S);return _==-1?null:this.getInputData(_,T)}isInputConnected(S){return this.inputs?S<this.inputs.length&&this.inputs[S].link!=null:!1}getInputInfo(S){return!this.inputs||!(S<this.inputs.length)?null:this.inputs[S]}getInputLink(S){var T;if(!this.inputs)return null;if(S<this.inputs.length){if(!this.graph)throw new NullGraphError;const _=this.inputs[S];if(_.link!=null)return(T=this.graph._links.get(_.link))!=null?T:null}return null}isAnyInputConnected(){if(!this.inputs)return!1;let S=!1;for(var T=0;T<this.inputs.length;T++)if(this.inputs[T].link!=null){S=!0;break}return S}getInputNode(S){if(!this.inputs||S>=this.inputs.length)return null;const T=this.inputs[S];if(!T||T.link===null)return null;if(!this.graph)throw new NullGraphError;const _=this.graph._links.get(T.link);return _?this.graph.getNodeById(_.origin_id):null}getInputOrProperty(S){const{inputs:T}=this;if(!(T!=null&&T.length))return this.properties?this.properties[S]:null;if(!this.graph)throw new NullGraphError;for(const _ of T)if(S==_.name&&_.link!=null){const w=this.graph._links.get(_.link);if(w)return w.data}return this.properties[S]}getOutputData(S){return!this.outputs||S>=this.outputs.length?null:this.outputs[S]._data}getOutputInfo(S){return!this.outputs||!(S<this.outputs.length)?null:this.outputs[S]}isOutputConnected(S){var T;return this.outputs?S<this.outputs.length&&Number((T=this.outputs[S].links)==null?void 0:T.length)>0:!1}isAnyOutputConnected(){var T;const{outputs:S}=this;if(!S)return!1;for(const _ of S)if((T=_.links)!=null&&T.length)return!0;return!1}getOutputNodes(S){const{outputs:T}=this;if(!T||T.length==0||S>=T.length)return null;const{links:_}=T[S];if(!_||_.length==0)return null;if(!this.graph)throw new NullGraphError;const w=[];for(const B of _){const A=this.graph._links.get(B);if(A){const O=this.graph.getNodeById(A.target_id);O&&w.push(O)}}return w}addOnTriggerInput(){const S=this.findInputSlot("onTrigger");return S==-1?(this.addInput("onTrigger",LiteGraph.EVENT,{nameLocked:!0}),this.findInputSlot("onTrigger")):S}addOnExecutedOutput(){const S=this.findOutputSlot("onExecuted");return S==-1?(this.addOutput("onExecuted",LiteGraph.ACTION,{nameLocked:!0}),this.findOutputSlot("onExecuted")):S}removeOnTriggerInput(){const S=this.findInputSlot("onTrigger");S!=-1&&this.removeInput(S)}removeOnExecutedOutput(){const S=this.findOutputSlot("onExecuted");S!=-1&&this.removeOutput(S)}onAfterExecuteNode(S,T){const _=this.findOutputSlot("onExecuted");_!=-1&&this.triggerSlot(_,S,null,T)}changeMode(S){return S==LGraphEventMode.ON_TRIGGER?(this.addOnTriggerInput(),this.addOnExecutedOutput()):(this.removeOnTriggerInput(),this.removeOnExecutedOutput()),this.mode=S,!0}doExecute(S,T){var _;if(T=T||{},this.onExecute){if(T.action_call||(T.action_call="".concat(this.id,"_exec_").concat(Math.floor(Math.random()*9999))),!this.graph)throw new NullGraphError;this.graph.nodes_executing[this.id]=!0,this.onExecute(S,T),this.graph.nodes_executing[this.id]=!1,this.exec_version=this.graph.iteration,T!=null&&T.action_call&&(this.action_call=T.action_call,this.graph.nodes_executedAction[this.id]=T.action_call)}this.execute_triggered=2,(_=this.onAfterExecuteNode)==null||_.call(this,S,T)}actionDo(S,T,_){var w;if(_=_||{},this.onAction){if(_.action_call||(_.action_call="".concat(this.id,"_").concat(S||"action","_").concat(Math.floor(Math.random()*9999))),!this.graph)throw new NullGraphError;this.graph.nodes_actioning[this.id]=S||"actioning",this.onAction(S,T,_),this.graph.nodes_actioning[this.id]=!1,_!=null&&_.action_call&&(this.action_call=_.action_call,this.graph.nodes_executedAction[this.id]=_.action_call)}this.action_triggered=2,(w=this.onAfterExecuteNode)==null||w.call(this,T,_)}trigger(S,T,_){const{outputs:w}=this;if(!(!w||!w.length)){this.graph&&(this.graph._last_trigger_time=LiteGraph.getTime());for(const[B,A]of w.entries())!A||A.type!==LiteGraph.EVENT||S&&A.name!=S||this.triggerSlot(B,T,null,_)}}triggerSlot(S,T,_,w){var O;if(w=w||{},!this.outputs)return;if(S==null){console.error("slot must be a number");return}typeof S!="number"&&console.warn("slot must be a number, use node.trigger('name') if you want to use a string");const B=this.outputs[S];if(!B)return;const A=B.links;if(!(!A||!A.length)){if(!this.graph)throw new NullGraphError;this.graph._last_trigger_time=LiteGraph.getTime();for(const R of A){if(_!=null&&_!=R)continue;const P=this.graph._links.get(R);if(!P)continue;P._last_time=LiteGraph.getTime();const E=this.graph.getNodeById(P.target_id);if(E){if(E.mode===LGraphEventMode.ON_TRIGGER)w.action_call||(w.action_call="".concat(this.id,"_trigg_").concat(Math.floor(Math.random()*9999))),(O=E.doExecute)==null||O.call(E,T,w);else if(E.onAction){w.action_call||(w.action_call="".concat(this.id,"_act_").concat(Math.floor(Math.random()*9999)));const D=E.inputs[P.target_slot];E.actionDo(D.name,T,w)}}}}}clearTriggeredSlot(S,T){if(!this.outputs)return;const _=this.outputs[S];if(!_)return;const w=_.links;if(!(!w||!w.length)){if(!this.graph)throw new NullGraphError;for(const B of w){if(T!=null&&T!=B)continue;const A=this.graph._links.get(B);A&&(A._last_time=0)}}}setSize(S){var T;this.size=S,(T=this.onResize)==null||T.call(this,this.size)}expandToFitContent(){const S=this.computeSize();this.setSize([Math.max(this.size[0],S[0]),Math.max(this.size[1],S[1])])}addProperty(S,T,_,w){const B={name:S,type:_,default_value:T};return w&&Object.assign(B,w),this.properties_info||(this.properties_info=[]),this.properties_info.push(B),this.properties||(this.properties={}),this.properties[S]=T,B}addOutput(S,T,_){var B;const w=new NodeOutputSlot({name:S,type:T,links:null});return _&&Object.assign(w,_),this.outputs||(this.outputs=[]),this.outputs.push(w),(B=this.onOutputAdded)==null||B.call(this,w),LiteGraph.auto_load_slot_types&&LiteGraph.registerNodeAndSlotType(this,T,!0),this.expandToFitContent(),this.setDirtyCanvas(!0,!0),w}addOutputs(S){var T;for(const _ of S){const w=new NodeOutputSlot({name:_[0],type:_[1],links:null});S[2]&&Object.assign(w,_[2]),this.outputs||(this.outputs=[]),this.outputs.push(w),(T=this.onOutputAdded)==null||T.call(this,w),LiteGraph.auto_load_slot_types&&LiteGraph.registerNodeAndSlotType(this,_[1],!0)}this.expandToFitContent(),this.setDirtyCanvas(!0,!0)}removeOutput(S){var _;this.disconnectOutput(S);const{outputs:T}=this;T.splice(S,1);for(let w=S;w<T.length;++w){const B=T[w];if(!(!B||!B.links))for(const A of B.links){if(!this.graph)throw new NullGraphError;const O=this.graph._links.get(A);O&&O.origin_slot--}}(_=this.onOutputRemoved)==null||_.call(this,S),this.setDirtyCanvas(!0,!0)}addInput(S,T,_){var B;T=T||0;const w=new NodeInputSlot({name:S,type:T,link:null});return _&&Object.assign(w,_),this.inputs||(this.inputs=[]),this.inputs.push(w),this.expandToFitContent(),(B=this.onInputAdded)==null||B.call(this,w),LiteGraph.registerNodeAndSlotType(this,T),this.setDirtyCanvas(!0,!0),w}addInputs(S){var T;for(const _ of S){const w=new NodeInputSlot({name:_[0],type:_[1],link:null});S[2]&&Object.assign(w,_[2]),this.inputs||(this.inputs=[]),this.inputs.push(w),(T=this.onInputAdded)==null||T.call(this,w),LiteGraph.registerNodeAndSlotType(this,_[1])}this.expandToFitContent(),this.setDirtyCanvas(!0,!0)}removeInput(S){var w;this.disconnectInput(S,!0);const{inputs:T}=this,_=T.splice(S,1);for(let B=S;B<T.length;++B){const A=T[B];if(!(A!=null&&A.link))continue;if(!this.graph)throw new NullGraphError;const O=this.graph._links.get(A.link);O&&O.target_slot--}(w=this.onInputRemoved)==null||w.call(this,S,_[0]),this.setDirtyCanvas(!0,!0)}addConnection(S,T,_,w){const B={name:S,type:T,pos:_,direction:w,links:null};return this.connections.push(B),B}computeSize(S){var M,N;const T=this.constructor.size;if(T)return[T[0],T[1]];const{inputs:_,outputs:w}=this;let B=Math.max(_?_.filter(k=>!isWidgetInputSlot(k)).length:1,w?w.length:1);const A=S||new Float32Array([0,0]);B=Math.max(B,1);const O=LiteGraph.NODE_TEXT_SIZE,R=I(this.title);let P=0,E=0;if(_)for(const k of _){const F=k.label||k.localized_name||k.name||"",G=I(F);P<G&&(P=G)}if(w)for(const k of w){const F=k.label||k.localized_name||k.name||"",G=I(F);E<G&&(E=G)}A[0]=Math.max(P+E+10,R),A[0]=Math.max(A[0],LiteGraph.NODE_WIDTH),(M=this.widgets)!=null&&M.length&&(A[0]=Math.max(A[0],LiteGraph.NODE_WIDTH*1.5)),A[1]=(this.constructor.slot_start_y||0)+B*LiteGraph.NODE_SLOT_HEIGHT;let D=0;if((N=this.widgets)!=null&&N.length){for(const k of this.widgets){if(!this.isWidgetVisible(k))continue;let F=0;k.computeSize?F+=k.computeSize(A[0])[1]:k.computeLayoutSize?F+=k.computeLayoutSize(this).minHeight:F+=LiteGraph.NODE_WIDGET_HEIGHT,D+=F+4}D+=8}this.widgets_up?A[1]=Math.max(A[1],D):this.widgets_start_y!=null?A[1]=Math.max(A[1],D+this.widgets_start_y):A[1]+=D;function I(k){return k?O*k.length*.6:0}return this.constructor.min_height&&A[1]<this.constructor.min_height&&(A[1]=this.constructor.min_height),A[1]+=6,A}inResizeCorner(S,T){const _=this.outputs?this.outputs.length:1,w=(this.constructor.slot_start_y||0)+_*LiteGraph.NODE_SLOT_HEIGHT;return isInRectangle(S,T,this.pos[0]+this.size[0]-15,this.pos[1]+Math.max(this.size[1]-15,w),20,20)}getPropertyInfo(S){var w;let T=null;const{properties_info:_}=this;if(_){for(const B of _)if(B.name==S){T=B;break}}return this.constructor["@".concat(S)]&&(T=this.constructor["@".concat(S)]),(w=this.constructor.widgets_info)!=null&&w[S]&&(T=this.constructor.widgets_info[S]),!T&&this.onGetPropertyInfo&&(T=this.onGetPropertyInfo(S)),T||(T={}),T.type||(T.type=typeof this.properties[S]),T.widget=="combo"&&(T.type="enum"),T}addWidget(S,T,_,w,B){this.widgets||(this.widgets=[]),!B&&w&&typeof w=="object"&&(B=w,w=null),B||(B={}),typeof B=="string"&&(B={property:B}),w&&typeof w=="string"&&(B.property=w,w=null);const A={type:S.toLowerCase(),name:T,value:_,callback:typeof w!="function"?void 0:w,options:B,y:0};if(A.options.y!==void 0&&(A.y=A.options.y),!w&&!A.options.callback&&!A.options.property&&console.warn("LiteGraph addWidget(...) without a callback or property assigned"),S=="combo"&&!A.options.values)throw"LiteGraph addWidget('combo',...) requires to pass values in options: { values:['red','blue'] }";const O=this.addCustomWidget(A);return this.expandToFitContent(),O}addCustomWidget(S){this.widgets||(this.widgets=[]);const T=WIDGET_TYPE_MAP[S.type],_=T?new T(S):S;return this.widgets.push(_),_}move(S,T){this.pinned||(this.pos[0]+=S,this.pos[1]+=T)}measure(S,T){var A,O;const _=this.title_mode,B=_!=TitleMode.TRANSPARENT_TITLE&&_!=TitleMode.NO_TITLE?LiteGraph.NODE_TITLE_HEIGHT:0;S[0]=this.pos[0],S[1]=this.pos[1]+-B,(A=this.flags)!=null&&A.collapsed?(T.font=this.innerFontStyle,this._collapsed_width=Math.min(this.size[0],T.measureText((O=this.getTitle())!=null?O:"").width+LiteGraph.NODE_TITLE_HEIGHT*2),S[2]=this._collapsed_width||LiteGraph.NODE_COLLAPSED_WIDTH,S[3]=LiteGraph.NODE_TITLE_HEIGHT):(S[2]=this.size[0],S[3]=this.size[1]+B)}getBounding(S,T){S||(S=new Float32Array(4));const _=T?this.renderArea:this.boundingRect;return S[0]=_[0],S[1]=_[1],S[2]=_[2],S[3]=_[3],S}updateArea(S){var w;const T=Ut(this,Li);this.measure(T,S),(w=this.onBounding)==null||w.call(this,T);const _=Ut(this,Bi);_.set(T),_[0]-=4,_[1]-=4,_[2]+=10,_[3]+=9}isPointInside(S,T){return isInRect(S,T,this.boundingRect)}isPointInCollapse(S,T){const _=LiteGraph.NODE_TITLE_HEIGHT;return isInRectangle(S,T,this.pos[0],this.pos[1]-_,_,_)}getInputOnPos(S){var T;return(T=getNodeInputOnPos(this,S[0],S[1]))==null?void 0:T.input}getOutputOnPos(S){var T;return(T=getNodeOutputOnPos(this,S[0],S[1]))==null?void 0:T.output}getSlotOnPos(S){var T;if(isPointInRect(S,this.boundingRect))return(T=this.getInputOnPos(S))!=null?T:this.getOutputOnPos(S)}getSlotInPosition(S,T){const{inputs:_,outputs:w}=this;if(_)for(const[B,A]of _.entries()){const O=this.getInputPos(B);if(isInRectangle(S,T,O[0]-10,O[1]-10,20,20))return{input:A,slot:B,link_pos:O}}if(w)for(const[B,A]of w.entries()){const O=this.getOutputPos(B);if(isInRectangle(S,T,O[0]-10,O[1]-10,20,20))return{output:A,slot:B,link_pos:O}}return null}getWidgetOnPos(S,T,_=!1){var E,D,I;const{widgets:w,pos:B,size:A}=this;if(!(w!=null&&w.length))return null;const O=S-B[0],R=T-B[1],P=A[0];for(const M of w){if(M.computedDisabled&&!_||!this.isWidgetVisible(M))continue;const N=(I=(D=M.computedHeight)!=null?D:(E=M.computeSize)==null?void 0:E.call(M,P)[1])!=null?I:LiteGraph.NODE_WIDGET_HEIGHT,k=M.width||P;if(M.last_y!==void 0&&isInRectangle(O,R,6,M.last_y,k-12,N))return M}return null}findInputSlot(S,T=!1){const{inputs:_}=this;if(!_)return-1;for(const[w,B]of _.entries())if(S==B.name)return T?B:w;return-1}findOutputSlot(S,T=!1){const{outputs:_}=this;if(!_)return-1;for(const[w,B]of _.entries())if(S==B.name)return T?B:w;return-1}findInputSlotFree(S){return Zt(this,pr,Un).call(this,this.inputs,S)}findOutputSlotFree(S){return Zt(this,pr,Un).call(this,this.outputs,S)}findInputSlotByType(S,T,_,w){return Zt(this,pr,Ni).call(this,this.inputs,S,T,_,w)}findOutputSlotByType(S,T,_,w){return Zt(this,pr,Ni).call(this,this.outputs,S,T,_,w)}findSlotByType(S,T,_,w,B){return S?Zt(this,pr,Ni).call(this,this.inputs,T,_,w,B):Zt(this,pr,Ni).call(this,this.outputs,T,_,w,B)}findConnectByTypeSlot(S,T,_,w){w&&typeof w=="object"&&("firstFreeIfInputGeneralInCase"in w&&(w.wildcardToTyped=!!w.firstFreeIfInputGeneralInCase),"firstFreeIfOutputGeneralInCase"in w&&(w.wildcardToTyped=!!w.firstFreeIfOutputGeneralInCase),"generalTypeInCase"in w&&(w.typedToWildcard=!!w.generalTypeInCase));const A=Object.assign({createEventInCase:!0,wildcardToTyped:!0,typedToWildcard:!0},w);if(!this.graph)throw new NullGraphError;if(T&&typeof T=="number"){const R=this.graph.getNodeById(T);if(!R)return;T=R}const O=T.findSlotByType(S,_,!1,!0);if(O>=0&&O!==null)return O;if(A.createEventInCase&&_==LiteGraph.EVENT){if(S)return-1;if(LiteGraph.do_add_triggers_slots)return T.addOnExecutedOutput()}if(A.typedToWildcard){const R=T.findSlotByType(S,0,!1,!0,!0);if(R>=0)return R}if(A.wildcardToTyped&&(_==0||_=="*"||_=="")){const R={typesNotAccepted:[LiteGraph.EVENT]},P=S?T.findInputSlotFree(R):T.findOutputSlotFree(R);if(P>=0)return P}}findOutputByType(S){return findFreeSlotOfType(this.outputs,S)}findInputByType(S){return findFreeSlotOfType(this.inputs,S)}connectByType(S,T,_,w){const B=this.findConnectByTypeSlot(!0,T,_,w);return B!==void 0?this.connect(S,T,B,w==null?void 0:w.afterRerouteId):(console.debug("[connectByType]: no way to connect type:",_,"to node:",T),null)}connectByTypeOutput(S,T,_,w){typeof w=="object"&&("firstFreeIfInputGeneralInCase"in w&&(w.wildcardToTyped=!!w.firstFreeIfInputGeneralInCase),"generalTypeInCase"in w&&(w.typedToWildcard=!!w.generalTypeInCase));const B=this.findConnectByTypeSlot(!1,T,_,w);return B!==void 0?T.connect(B,this,S,w==null?void 0:w.afterRerouteId):(console.debug("[connectByType]: no way to connect type:",_,"to node:",T),null)}canConnectTo(S,T,_){return this.id!==S.id&&LiteGraph.isValidConnection(_.type,T.type)}connect(S,T,_,w){var D;let B;const{graph:A,outputs:O}=this;if(!A)return console.log("Connect: Error, node doesn't belong to any graph. Nodes must be added first to a graph before connecting them."),null;if(typeof S=="string"){if(S=this.findOutputSlot(S),S==-1)return LiteGraph.debug&&console.log("Connect: Error, no slot of name ".concat(S)),null}else if(!O||S>=O.length)return LiteGraph.debug&&console.log("Connect: Error, slot number not found"),null;if(T&&typeof T=="number"){const I=A.getNodeById(T);if(!I)throw"target node is null";T=I}if(!T)throw"target node is null";if(T==this)return null;if(typeof _=="string"){if(B=T.findInputSlot(_),B==-1)return LiteGraph.debug&&console.log("Connect: Error, no slot of name ".concat(B)),null}else if(_===LiteGraph.EVENT)if(LiteGraph.do_add_triggers_slots)T.changeMode(LGraphEventMode.ON_TRIGGER),B=T.findInputSlot("onTrigger");else return null;else typeof _=="number"?B=_:B=0;if(T.onBeforeConnectInput){const I=T.onBeforeConnectInput(B,_);B=typeof I=="number"?I:null}if(B===null||!T.inputs||B>=T.inputs.length)return LiteGraph.debug&&console.log("Connect: Error, slot number not found"),null;const R=T.inputs[B],P=O[S];if(!P)return null;(D=P.links)!=null&&D.length&&P.type===LiteGraph.EVENT&&!LiteGraph.allow_multi_output_for_events&&(A.beforeChange(),this.disconnectOutput(S,!1,{doProcessChange:!1}));const E=this.connectSlots(P,T,R,w);return E!=null?E:null}connectSlots(S,T,_,w){var D,I,M,N,k,F;const{graph:B}=this;if(!B)throw new NullGraphError;const A=this.outputs.indexOf(S);if(A===-1){console.warn("connectSlots: output not found");return}const O=T.inputs.indexOf(_);if(O===-1){console.warn("connectSlots: input not found");return}if(!LiteGraph.isValidConnection(S.type,_.type))return this.setDirtyCanvas(!1,!0),null;if(((D=T.onConnectInput)==null?void 0:D.call(T,O,S.type,S,this,A))===!1||((I=this.onConnectOutput)==null?void 0:I.call(this,A,_.type,_,T,O))===!1)return null;((M=T.inputs[O])==null?void 0:M.link)!=null&&(B.beforeChange(),T.disconnectInput(O,!0));const R=new LLink(++B.state.lastLinkId,_.type||S.type,this.id,A,T.id,O,w);B._links.set(R.id,R),(N=S.links)!=null||(S.links=[]),S.links.push(R.id),T.inputs[O].link=R.id;const P=LLink.getReroutes(B,R);for(const G of P)G.linkIds.add(R.id),G.floating&&delete G.floating,G._dragging=void 0;const E=P.at(-1);if(E)for(const G of E.floatingLinkIds){const V=B.floatingLinks.get(G);(V==null?void 0:V.parentId)===E.id&&B.removeFloatingLink(V)}return B._version++,(k=this.onConnectionsChange)==null||k.call(this,NodeSlotType.OUTPUT,A,!0,R,S),(F=T.onConnectionsChange)==null||F.call(T,NodeSlotType.INPUT,O,!0,R,_),this.setDirtyCanvas(!1,!0),B.afterChange(),B.connectionChange(this),R}connectFloatingReroute(S,T,_){var M,N;const{graph:w,id:B}=this;if(!w)throw new NullGraphError;const A=this.inputs.indexOf(T),O=this.outputs.indexOf(T);if(A===-1&&O===-1)throw new Error("Invalid slot");const R=O===-1?"input":"output",P=w.setReroute({pos:S,parentId:_,linkIds:[],floating:{slotType:R}}),E=w.getReroute(_),D=((M=E==null?void 0:E.floating)==null?void 0:M.slotType)==="output";if(_==null||!D){const k=new LLink(-1,T.type,O===-1?-1:B,O,A===-1?-1:B,A);return k.parentId=P.id,w.addFloatingLink(k),P}if(!E)throw new Error("[connectFloatingReroute] Parent reroute not found");const I=(N=E.getFloatingLinks("output"))==null?void 0:N[0];if(!I)throw new Error("[connectFloatingReroute] Floating link not found");return P.floatingLinkIds.add(I.id),I.parentId=P.id,delete E.floating,P}disconnectOutput(S,T){var A,O,R,P,E;if(typeof S=="string"){if(S=this.findOutputSlot(S),S==-1)return LiteGraph.debug&&console.log("Connect: Error, no slot of name ".concat(S)),!1}else if(!this.outputs||S>=this.outputs.length)return LiteGraph.debug&&console.log("Connect: Error, slot number not found"),!1;const _=this.outputs[S];if(!_)return!1;if(_._floatingLinks)for(const D of _._floatingLinks)D.hasOrigin(this.id,S)&&((A=this.graph)==null||A.removeFloatingLink(D));if(!_.links||_.links.length==0)return!1;const{links:w}=_,B=this.graph;if(!B)throw new NullGraphError;if(T){const D=typeof T=="number"?B.getNodeById(T):T;if(!D)throw"Target Node not found";for(const[I,M]of w.entries()){const N=B._links.get(M);if((N==null?void 0:N.target_id)!=D.id)continue;w.splice(I,1);const k=D.inputs[N.target_slot];k.link=null,N.disconnect(B,"input"),B._version++,(O=D.onConnectionsChange)==null||O.call(D,NodeSlotType.INPUT,N.target_slot,!1,N,k),(R=this.onConnectionsChange)==null||R.call(this,NodeSlotType.OUTPUT,S,!1,N,_);break}}else{for(const D of w){const I=B._links.get(D);if(!I)continue;const M=B.getNodeById(I.target_id);if(B._version++,M){const N=M.inputs[I.target_slot];N.link=null,(P=M.onConnectionsChange)==null||P.call(M,NodeSlotType.INPUT,I.target_slot,!1,I,N)}I.disconnect(B,"input"),(E=this.onConnectionsChange)==null||E.call(this,NodeSlotType.OUTPUT,S,!1,I,_)}_.links=null}return this.setDirtyCanvas(!1,!0),B.connectionChange(this),!0}disconnectInput(S,T){var A,O,R,P;if(typeof S=="string"){if(S=this.findInputSlot(S),S==-1)return LiteGraph.debug&&console.log("Connect: Error, no slot of name ".concat(S)),!1}else if(!this.inputs||S>=this.inputs.length)return LiteGraph.debug&&console.log("Connect: Error, slot number not found"),!1;const _=this.inputs[S];if(!_)return!1;const{graph:w}=this;if(!w)throw new NullGraphError;if((A=_._floatingLinks)!=null&&A.size)for(const E of _._floatingLinks)w.removeFloatingLink(E);const B=this.inputs[S].link;if(B!=null){this.inputs[S].link=null;const E=w._links.get(B);if(E){const D=w.getNodeById(E.origin_id);if(!D)return!1;const I=D.outputs[E.origin_slot];if(!((O=I==null?void 0:I.links)!=null&&O.length))return!1;let M=0;for(const N=I.links.length;M<N;M++)if(I.links[M]==B){I.links.splice(M,1);break}E.disconnect(w,T?"output":void 0),w&&w._version++,(R=this.onConnectionsChange)==null||R.call(this,NodeSlotType.INPUT,S,!1,E,_),(P=D.onConnectionsChange)==null||P.call(D,NodeSlotType.OUTPUT,M,!1,E,I)}}return this.setDirtyCanvas(!1,!0),w==null||w.connectionChange(this),!0}getConnectionPos(S,T,_){var I,M;_||(_=new Float32Array(2));const{pos:[w,B],inputs:A,outputs:O}=this;if(this.flags.collapsed){const N=this._collapsed_width||LiteGraph.NODE_COLLAPSED_WIDTH;return _[0]=S?w:w+N,_[1]=B-LiteGraph.NODE_TITLE_HEIGHT*.5,_}if(S&&T==-1)return _[0]=w+LiteGraph.NODE_TITLE_HEIGHT*.5,_[1]=B+LiteGraph.NODE_TITLE_HEIGHT*.5,_;const R=(I=A==null?void 0:A[T])==null?void 0:I.pos,P=(M=O==null?void 0:O[T])==null?void 0:M.pos;if(S&&R)return _[0]=w+R[0],_[1]=B+R[1],_;if(!S&&P)return _[0]=w+P[0],_[1]=B+P[1],_;const E=LiteGraph.NODE_SLOT_HEIGHT*.5,D=S?Ut(this,pr,Hn).indexOf(this.inputs[T]):Ut(this,pr,Xn).indexOf(this.outputs[T]);return _[0]=S?w+E:w+this.size[0]+1-E,_[1]=B+(D+.7)*LiteGraph.NODE_SLOT_HEIGHT+(this.constructor.slot_start_y||0),_}getInputPos(S){var E;const{pos:[T,_],inputs:w}=this;if(this.flags.collapsed){const D=LiteGraph.NODE_TITLE_HEIGHT*.5;return[T,_-D]}const B=(E=w==null?void 0:w[S])==null?void 0:E.pos;if(B)return[T+B[0],_+B[1]];const A=LiteGraph.NODE_SLOT_HEIGHT*.5,O=this.constructor.slot_start_y||0,P=(Ut(this,pr,Hn).indexOf(this.inputs[S])+.7)*LiteGraph.NODE_SLOT_HEIGHT;return[T+A,_+P+O]}getOutputPos(S){var D;const{pos:[T,_],outputs:w,size:[B]}=this;if(this.flags.collapsed){const I=this._collapsed_width||LiteGraph.NODE_COLLAPSED_WIDTH,M=LiteGraph.NODE_TITLE_HEIGHT*.5;return[T+I,_-M]}const A=(D=w==null?void 0:w[S])==null?void 0:D.pos;if(A)return[T+A[0],_+A[1]];const O=LiteGraph.NODE_SLOT_HEIGHT*.5,R=this.constructor.slot_start_y||0,E=(Ut(this,pr,Xn).indexOf(this.outputs[S])+.7)*LiteGraph.NODE_SLOT_HEIGHT;return[T+B+1-O,_+E+R]}snapToGrid(S){return this.pinned?!1:snapPoint(this.pos,S)}alignToGrid(){this.snapToGrid(LiteGraph.CANVAS_GRID_SIZE)}trace(S){this.console||(this.console=[]),this.console.push(S),this.console.length>Ei.MAX_CONSOLE&&this.console.shift()}setDirtyCanvas(S,T){var _;(_=this.graph)==null||_.canvasAction(w=>w.setDirty(S,T))}loadImage(S){const T=new Image;T.src=LiteGraph.node_images_path+S,T.ready=!1;const _=()=>this.setDirtyCanvas(!0);return T.addEventListener("load",function(){this.ready=!0,_()}),T}captureInput(S){if(!this.graph||!this.graph.list_of_graphcanvas)return;const T=this.graph.list_of_graphcanvas;for(const _ of T)!S&&_.node_capturing_input!=this||(_.node_capturing_input=S?this:null)}get collapsed(){return!!this.flags.collapsed}get collapsible(){return!this.pinned&&this.constructor.collapsable!==!1}collapse(S){if(!(!this.collapsible&&!S)){if(!this.graph)throw new NullGraphError;this.graph._version++,this.flags.collapsed=!this.flags.collapsed,this.setDirtyCanvas(!0,!0)}}toggleAdvanced(){var S;if((S=this.widgets)!=null&&S.some(T=>T.advanced)){if(!this.graph)throw new NullGraphError;this.graph._version++,this.showAdvanced=!this.showAdvanced,this.expandToFitContent(),this.setDirtyCanvas(!0,!0)}}get pinned(){return!!this.flags.pinned}pin(S){if(!this.graph)throw new NullGraphError;this.graph._version++,this.flags.pinned=S!=null?S:!this.flags.pinned,this.resizable=!this.pinned,this.pinned||delete this.flags.pinned}unpin(){this.pin(!1)}localToScreen(S,T,_){return[(S+this.pos[0])*_.scale+_.offset[0],(T+this.pos[1])*_.scale+_.offset[1]]}get width(){return this.collapsed?this._collapsed_width||LiteGraph.NODE_COLLAPSED_WIDTH:this.size[0]}get height(){return LiteGraph.NODE_TITLE_HEIGHT+this.bodyHeight}get bodyHeight(){return this.collapsed?0:this.size[1]}drawBadges(S,{gap:T=2}={}){const _=this.badges.map(O=>O instanceof LGraphBadge?O:O());let B=this.badgePosition===BadgePosition.TopLeft?0:this.width-_.reduce((O,R)=>O+R.getWidth(S)+T,0);const A=-(LiteGraph.NODE_TITLE_HEIGHT+T);for(const O of _)O.draw(S,B,A-O.height),B+=O.getWidth(S)+T}drawTitleBarBackground(S,{scale:T,title_height:_=LiteGraph.NODE_TITLE_HEIGHT,low_quality:w=!1}){const B=this.renderingColor,A=this.renderingShape,O=this.renderingSize;if(this.onDrawTitleBar){this.onDrawTitleBar(S,_,O,T,B);return}this.title_mode!==TitleMode.TRANSPARENT_TITLE&&(this.collapsed&&(S.shadowColor=LiteGraph.DEFAULT_SHADOW_COLOR),S.fillStyle=this.constructor.title_color||B,S.beginPath(),A==RenderShape.BOX||w?S.rect(0,-_,O[0],_):(A==RenderShape.ROUND||A==RenderShape.CARD)&&S.roundRect(0,-_,O[0],_,this.collapsed?[LiteGraph.ROUND_RADIUS]:[LiteGraph.ROUND_RADIUS,LiteGraph.ROUND_RADIUS,0,0]),S.fill(),S.shadowColor="transparent")}drawErrorTips(S){S.beginPath(),this.renderingShape==RenderShape.BOX?S.rect(0,-LiteGraph.NODE_TITLE_HEIGHT,this.renderingSize[0],LiteGraph.NODE_TITLE_HEIGHT):S.roundRect(0,-LiteGraph.NODE_TITLE_HEIGHT,this.renderingSize[0],LiteGraph.NODE_TITLE_HEIGHT,[8,8,8,8]),S.lineWidth=2,S.strokeStyle="#FF0000",S.stroke()}drawAssestBox(S,T,_){var w=0,B=0,A=5,O=0,R=0;this.flags.collapsed?(w=this.renderingSize[0],B=this.renderingSize[0],B>_+A*2&&(B=_+A*2),R=-7):(w=130,B=130,B>_+A*2&&(B=_+A*2),O=this.renderingSize[0]*.5-w*.5,R=-30-B),T==null&&(T=w),_==null&&(_=B);var P=Math.min((w-A)/T,(B-A)/_),E=T*P,D=_*P;D<E&&(B=D+A,this.flags.collapsed||(R=-30-B));var I=O+(w-E)*.5,M=R+(B-D)*.5;return S.beginPath(),this.flags.collapsed?(S.shadowColor=LiteGraph.DEFAULT_SHADOW_COLOR,S.roundRect(0,R,this.renderingSize[0],B,[0,0,8,8])):S.roundRect(this.renderingSize[0]*.5-w*.5,R,w,B,[8,8,0,0]),S.fillStyle=this.renderingBgColor,S.fill(),S.shadowColor="transparent",{x:I,y:M,width:E,height:D}}drawTitleBox(S,{scale:T,low_quality:_=!1,title_height:w=LiteGraph.NODE_TITLE_HEIGHT,box_size:B=10}){const A=this.renderingSize,O=this.renderingShape;if(this.onDrawTitleBox){this.onDrawTitleBox(S,w,A,T);return}[RenderShape.ROUND,RenderShape.CIRCLE,RenderShape.CARD].includes(O)?(_&&(S.fillStyle="black",S.beginPath(),S.arc(w*.5,w*-.5,B*.5+1,0,Math.PI*2),S.fill()),S.fillStyle=this.renderingBoxColor,_?S.fillRect(w*.5-B*.5,w*-.5-B*.5,B,B):(S.beginPath(),S.arc(w*.5,w*-.5,B*.5,0,Math.PI*2),S.fill())):(_&&(S.fillStyle="black",S.fillRect((w-B)*.5-1,(w+B)*-.5-1,B+2,B+2)),S.fillStyle=this.renderingBoxColor,S.fillRect((w-B)*.5,(w+B)*-.5,B,B))}drawTitleText(S,{scale:T,default_title_color:_,low_quality:w=!1,title_height:B=LiteGraph.NODE_TITLE_HEIGHT}){var E;const A=this.renderingSize,O=this.selected;if(this.onDrawTitleText){this.onDrawTitleText(S,B,A,T,this.titleFontStyle,O);return}if(w)return;S.font=this.titleFontStyle;const R=(E=this.getTitle())!=null?E:"❌ ".concat(this.type),P=String(R)+(this.pinned?"📌":"");P&&(O?S.fillStyle=LiteGraph.NODE_SELECTED_TITLE_COLOR:S.fillStyle=this.constructor.title_text_color||_,this.collapsed?(S.textAlign="left",S.fillText(P.substr(0,20),B,LiteGraph.NODE_TITLE_TEXT_Y-B),S.textAlign="left"):(S.textAlign="left",S.fillText(P,B,LiteGraph.NODE_TITLE_TEXT_Y-B)))}connectInputToOutput(){var O;const{inputs:S,outputs:T,graph:_}=this;if(!S||!T)return;if(!_)throw new NullGraphError;const{_links:w}=_;let B=!1;for(const[R,P]of S.entries()){if(P.link==null)continue;const E=T[R];if(!E||!LiteGraph.isValidConnection(P.type,E.type))continue;const D=w.get(P.link);if(!D)continue;const I=_.getNodeById(D==null?void 0:D.origin_id);I&&A(E,I,D,_)}if(!((O=this.flags.keepAllLinksOnBypass)!=null?O:Ei.keepAllLinksOnBypass))return B;for(const R of S){if(R.link==null)continue;const P=w.get(R.link);if(!P)continue;const E=_.getNodeById(P==null?void 0:P.origin_id);if(E){for(const D of T)if(LiteGraph.isValidConnection(R.type,D.type)){A(D,E,P,_);break}}}return B;function A(R,P,E,D){var M;const I=(M=R.links)==null?void 0:M.map(N=>w.get(N)).filter(N=>!!N);if(I!=null&&I.length)for(const N of I){const k=D.getNodeById(N.target_id);if(!k)continue;const F=P.connect(E.origin_slot,k,N.target_slot,E.parentId);B||(B=!!F)}}}isWidgetVisible(S){return!(this.collapsed||S.hidden||S.advanced&&!this.showAdvanced)}drawWidgets(S,{lowQuality:T=!1,editorAlpha:_=1}){var P,E;if(!this.widgets)return;const w=this.size[0],B=this.widgets,A=LiteGraph.NODE_WIDGET_HEIGHT,O=!T;S.save(),S.globalAlpha=_;const R=15;for(const D of B){if(!this.isWidgetVisible(D))continue;const I=D.y,M=D.advanced?LiteGraph.WIDGET_ADVANCED_OUTLINE_COLOR:LiteGraph.WIDGET_OUTLINE_COLOR;D.last_y=I,D.computedDisabled=D.disabled||((P=this.getSlotFromWidget(D))==null?void 0:P.link)!=null,S.strokeStyle=M,S.fillStyle="#222",S.textAlign="left",D.computedDisabled&&(S.globalAlpha*=.5);const N=D.width||w,k=WIDGET_TYPE_MAP[D.type];k?toClass(k,D).drawWidget(S,{y:I,width:N,show_text:O,margin:R}):(E=D.draw)==null||E.call(D,S,this,N,I,A,T),S.globalAlpha=_}S.restore()}drawCollapsedSlots(S){var w,B,A;let T=null,_=null;for(const O of(w=this.inputs)!=null?w:[])if(O.link!=null){T=O;break}for(const O of(B=this.outputs)!=null?B:[])if(!(!O.links||!O.links.length)){_=O;break}if(T){const R=LiteGraph.NODE_TITLE_HEIGHT*-.5;toClass(NodeInputSlot,T).drawCollapsed(S,{pos:[0,R]})}if(_){const O=(A=this._collapsed_width)!=null?A:LiteGraph.NODE_COLLAPSED_WIDTH,R=LiteGraph.NODE_TITLE_HEIGHT*-.5;toClass(NodeOutputSlot,_).drawCollapsed(S,{pos:[O,R]})}}get highlightColor(){var S,T;return(T=(S=LiteGraph.NODE_TEXT_HIGHLIGHT_COLOR)!=null?S:LiteGraph.NODE_SELECTED_TITLE_COLOR)!=null?T:LiteGraph.NODE_TEXT_COLOR}get slots(){return[...this.inputs,...this.outputs]}getSlotFromWidget(S){return this.inputs.find(T=>isWidgetInputSlot(T)&&T.widget.name===S.name)}getWidgetFromSlot(S){var T;if(isWidgetInputSlot(S))return(T=this.widgets)==null?void 0:T.find(_=>_.name===S.widget.name)}drawSlots(S,{fromSlot:T,colorContext:_,editorAlpha:w,lowQuality:B}){var A;for(const O of this.slots){const R=O._layoutElement,P=toNodeSlotClass(O),E=!T||P.isValidTarget(T),D=E&&Zt(this,pr,Js).call(this,O),I=D?this.highlightColor:LiteGraph.NODE_TEXT_COLOR,M=!isWidgetInputSlot(O)||Zt(this,pr,Ks).call(this,this.getWidgetFromSlot(O))||T&&P.isValidTarget(T)||P.isConnected();S.globalAlpha=M?E?w:.4*w:0,P.draw(S,{pos:(A=R==null?void 0:R.center)!=null?A:[0,0],colorContext:_,labelColor:I,lowQuality:B,highlight:D})}}arrange(){const S=Zt(this,pr,zs).call(this),T=S?S[1]+S[3]:0;Zt(this,pr,$s).call(this,T),Zt(this,pr,Qs).call(this)}drawProgressBar(S){if(!this.progress)return;const T=S.fillStyle;S.fillStyle="green",S.fillRect(0,0,this.width*this.progress,6),S.fillStyle=T}};Bi=new WeakMap,Li=new WeakMap,pr=new WeakSet,Ys=function(){if(this.has_errors)return{padding:12,lineWidth:10,color:LiteGraph.NODE_ERROR_COLOUR}},Ws=function(){if(this.selected)return{padding:this.has_errors?20:void 0}},Un=function(S,T){var A,O,R;const w=Object.assign({returnObj:!1,typesNotAccepted:[]},T||{}),B=S==null?void 0:S.length;if(!(B>0))return-1;for(let P=0;P<B;++P){const E=S[P];if(!(!E||E.link||(A=E.links)!=null&&A.length)&&!((R=(O=w.typesNotAccepted)==null?void 0:O.includes)!=null&&R.call(O,E.type)))return w.returnObj?E:P}return-1},Ni=function(S,T,_,w,B){var P;const A=S==null?void 0:S.length;if(!A)return-1;(T==""||T=="*")&&(T=0);const O=String(T).toLowerCase().split(",");let R=null;for(let E=0;E<A;++E){const D=S[E],I=D.type=="0"||D.type=="*"?["0"]:String(D.type).toLowerCase().split(",");for(const M of O){const N=M=="_event_"?LiteGraph.EVENT:M;for(const k of I){const F=k=="_event_"?LiteGraph.EVENT:k;if(N==F||N==="*"||F==="*"){if(w&&((P=D.links)!=null&&P.length||D.link!=null)){R!=null||(R=_?D:E);continue}return _?D:E}}}}return B?-1:R!=null?R:-1},Hn=function(){return this.inputs.filter(S=>{var T;return!(S.pos||(T=this.widgets)!=null&&T.length&&isWidgetInputSlot(S))})},Xn=function(){return this.outputs.filter(S=>!S.pos)},tn=function(S,T){const w=isINodeInputSlot(S)?this.getInputPos(T):this.getOutputPos(T);return S._layoutElement=new LayoutElement({value:S,boundingRect:[w[0]-this.pos[0]-LiteGraph.NODE_SLOT_HEIGHT*.5,w[1]-this.pos[1]-LiteGraph.NODE_SLOT_HEIGHT*.5,LiteGraph.NODE_SLOT_HEIGHT,LiteGraph.NODE_SLOT_HEIGHT]}),S._layoutElement},zs=function(){var T;const S=[];for(const[_,w]of this.inputs.entries()){if((T=this.widgets)!=null&&T.length&&isWidgetInputSlot(w))continue;const B=Zt(this,pr,tn).call(this,w,_);S.push(B)}for(const[_,w]of this.outputs.entries()){const B=Zt(this,pr,tn).call(this,w,_);S.push(B)}return S.length?createBounds(S,0):null},Zs=function(S){var w,B;const T=isINodeInputSlot(S),_=(B=(w=this.mouseOver)==null?void 0:w[T?"inputId":"outputId"])!=null?B:-1;return _===-1?null:T?this.inputs[_]:this.outputs[_]},Js=function(S){return Zt(this,pr,Zs).call(this,S)===S},Ks=function(S){var T;return((T=this.mouseOver)==null?void 0:T.overWidget)===S},$s=function(S){var E,D;if(!this.widgets||!this.widgets.length)return;const T=this.bodyHeight,_=(E=this.widgets_start_y)!=null?E:(this.widgets_up?0:S)+2;let w=T-_,B=0;const A=[];for(const I of this.widgets)if(this.isWidgetVisible(I)!=!1){if(I.computeSize){const M=I.computeSize()[1]+4;I.computedHeight=M,B+=M}else if(I.computeLayoutSize){const{minHeight:M,maxHeight:N}=I.computeLayoutSize(this);A.push({minHeight:M,prefHeight:N,w:I})}else{const M=LiteGraph.NODE_WIDGET_HEIGHT+4;I.computedHeight=M,B+=M}B+=8}w-=B,this.freeWidgetSpace=w;const O=A.map(I=>({minSize:I.minHeight,maxSize:I.prefHeight})),R=distributeSpace(Math.max(0,w),O);for(const[I,M]of A.entries())M.w.computedHeight=R[I];let P=_;for(const I of this.widgets)this.isWidgetVisible(I)!=!1&&(I.y=P,P+=(D=I.computedHeight)!=null?D:0);if(P+=8,!this.graph)throw new NullGraphError;P>T&&(this.setSize([this.size[0],P]),this.graph.setDirtyCanvas(!1,!0))},Qs=function(){var T;if(!this.widgets)return;const S=new Map;for(const[_,w]of this.inputs.entries())isWidgetInputSlot(w)&&S.set((T=w.widget)==null?void 0:T.name,{...w,index:_});if(S.size)for(const _ of this.widgets){const w=S.get(_.name);if(!w)continue;const B=this.inputs[w.index],A=LiteGraph.NODE_SLOT_HEIGHT*.5;B.pos=[A,_.y+A],Zt(this,pr,tn).call(this,B,w.index)}},Ei.keepAllLinksOnBypass=!1;let LGraphNode=Ei;const Or=class Or{constructor(S,T){this.font_size=LiteGraph.DEFAULT_GROUP_FONT||24,this._bounding=new Float32Array([10,10,Or.minWidth,Or.minHeight]),this._pos=this._bounding.subarray(0,2),this._size=this._bounding.subarray(2,4),this._nodes=[],this._children=new Set,this.flags={},this.isPointInside=LGraphNode.prototype.isPointInside,this.setDirtyCanvas=LGraphNode.prototype.setDirtyCanvas,this.id=T!=null?T:-1,this.title=S||"Group",this.color=LGraphCanvas.node_colors.pale_blue?LGraphCanvas.node_colors.pale_blue.groupcolor:"#AAA"}setColorOption(S){S==null?delete this.color:this.color=S.groupcolor}getColorOption(){var S;return(S=Object.values(LGraphCanvas.node_colors).find(T=>T.groupcolor===this.color))!=null?S:null}get pos(){return this._pos}set pos(S){!S||S.length<2||(this._pos[0]=S[0],this._pos[1]=S[1])}get size(){return this._size}set size(S){!S||S.length<2||(this._size[0]=Math.max(Or.minWidth,S[0]),this._size[1]=Math.max(Or.minHeight,S[1]))}get boundingRect(){return this._bounding}get nodes(){return this._nodes}get titleHeight(){return this.font_size*1.4}get children(){return this._children}get pinned(){return!!this.flags.pinned}pin(S){(S===void 0?!this.pinned:S)?this.flags.pinned=!0:delete this.flags.pinned}unpin(){this.pin(!1)}configure(S){this.id=S.id,this.title=S.title,this._bounding.set(S.bounding),this.color=S.color,this.flags=S.flags||this.flags,S.font_size&&(this.font_size=S.font_size)}serialize(){const S=this._bounding;return{id:this.id,title:this.title,bounding:[...S],color:this.color,font_size:this.font_size,flags:this.flags}}draw(S,T){const{padding:_,resizeLength:w,defaultColour:B}=Or,A=this.font_size||LiteGraph.DEFAULT_GROUP_FONT_SIZE,[O,R]=this._pos,[P,E]=this._size,D=this.color||B;T.globalAlpha=.25*S.editor_alpha,T.fillStyle=D,T.strokeStyle=D,T.beginPath(),T.rect(O+.5,R+.5,P,A*1.4),T.fill(),T.fillStyle=D,T.strokeStyle=D,T.beginPath(),T.rect(O+.5,R+.5,P,E),T.fill(),T.globalAlpha=S.editor_alpha,T.stroke(),T.beginPath(),T.moveTo(O+P,R+E),T.lineTo(O+P-w,R+E),T.lineTo(O+P,R+E-w),T.fill(),T.font="".concat(A,"px Arial"),T.textAlign="left",T.fillText(this.title+(this.pinned?"📌":""),O+_,R+A),LiteGraph.highlight_selected_group&&this.selected&&strokeShape(T,this._bounding,{title_height:this.titleHeight,padding:_})}resize(S,T){return this.pinned?!1:(this._size[0]=Math.max(Or.minWidth,S),this._size[1]=Math.max(Or.minHeight,T),!0)}move(S,T,_=!1){if(!this.pinned&&(this._pos[0]+=S,this._pos[1]+=T,_!==!0))for(const w of this._children)w.move(S,T)}snapToGrid(S){return this.pinned?!1:snapPoint(this.pos,S)}recomputeInsideNodes(){if(!this.graph)throw new NullGraphError;const{nodes:S,reroutes:T,groups:_}=this.graph,w=this._children;this._nodes.length=0,w.clear();for(const B of S)containsCentre(this._bounding,B.boundingRect)&&(this._nodes.push(B),w.add(B));for(const B of T.values())isPointInRect(B.pos,this._bounding)&&w.add(B);for(const B of _)containsRect(this._bounding,B._bounding)&&w.add(B);_.sort((B,A)=>B===this?w.has(A)?-1:0:A===this&&w.has(B)?1:0)}resizeTo(S,T=10){const _=createBounds(S,T);_!==null&&(this.pos[0]=_[0],this.pos[1]=_[1]-this.titleHeight,this.size[0]=_[2],this.size[1]=_[3]+this.titleHeight)}addNodes(S,T=10){!this._nodes&&S.length===0||this.resizeTo([...this.children,...this._nodes,...S],T)}getMenuOptions(){return[{content:this.pinned?"Unpin":"Pin",callback:()=>{this.pinned?this.unpin():this.pin(),this.setDirtyCanvas(!1,!0)}},null,{content:"Title",callback:LGraphCanvas.onShowPropertyEditor},{content:"Color",has_submenu:!0,callback:LGraphCanvas.onMenuNodeColors},{content:"Font size",property:"font_size",type:"Number",callback:LGraphCanvas.onShowPropertyEditor},null,{content:"Remove",callback:LGraphCanvas.onMenuNodeRemove}]}isPointInTitlebar(S,T){const _=this.boundingRect;return isInRectangle(S,T,_[0],_[1],_[2],this.titleHeight)}isInResize(S,T){const _=this.boundingRect,w=_[0]+_[2],B=_[1]+_[3];return S<w&&T<B&&S-w+(T-B)>-Or.resizeLength}};Or.minWidth=140,Or.minHeight=80,Or.resizeLength=10,Or.padding=4,Or.defaultColour="#335";let LGraphGroup=Or;var vi,Lr,Zr,Ur,Ri;const Nr=class Nr{constructor(S,T,_,w,B,A){dr(this,vi);dr(this,Lr);dr(this,Zr);dr(this,Ur);dr(this,Ri);this.id=S,_r(this,vi,new Float32Array(8)),_r(this,Ur,Ut(this,vi).subarray(0,2)),this.cos=0,this.sin=0,this.controlPoint=Ut(this,vi).subarray(4,6),this._pos=Ut(this,vi).subarray(6,8),_r(this,Ri,-1/0),_r(this,Lr,new WeakRef(T)),this.parentId=w,_&&(this.pos=_),this.linkIds=new Set(B),this.floatingLinkIds=new Set(A)}get parentId(){return Ut(this,Zr)}set parentId(S){S!==this.id&&this.getReroutes()!==null&&_r(this,Zr,S)}get parent(){var S;return(S=Ut(this,Lr).deref())==null?void 0:S.getReroute(Ut(this,Zr))}get pos(){return Ut(this,Ur)}set pos(S){if(!((S==null?void 0:S.length)>=2))throw new TypeError("Reroute.pos is an x,y point, and expects an indexable with at least two values.");Ut(this,Ur)[0]=S[0],Ut(this,Ur)[1]=S[1]}get boundingRect(){const{radius:S}=Nr,[T,_]=Ut(this,Ur);return[T-S,_-S,2*S,2*S]}get totalLinks(){return this.linkIds.size+this.floatingLinkIds.size}get firstLink(){var T;const S=this.linkIds.values().next().value;return S===void 0||(T=Ut(this,Lr).deref())==null?void 0:T.links.get(S)}get firstFloatingLink(){var T;const S=this.floatingLinkIds.values().next().value;return S===void 0||(T=Ut(this,Lr).deref())==null?void 0:T.floatingLinks.get(S)}get origin_id(){var S;return(S=this.firstLink)==null?void 0:S.origin_id}get origin_slot(){var S;return(S=this.firstLink)==null?void 0:S.origin_slot}update(S,T,_,w){this.parentId=S,T&&(this.pos=T),_&&(this.linkIds=new Set(_)),this.floating=w}validateLinks(S,T){const{linkIds:_,floatingLinkIds:w}=this;for(const B of _)S.has(B)||_.delete(B);for(const B of w)T.has(B)||w.delete(B);return _.size>0||w.size>0}getReroutes(S=new Set){var w;if(Ut(this,Zr)===void 0)return[this];if(S.has(this))return null;S.add(this);const T=(w=Ut(this,Lr).deref())==null?void 0:w.reroutes.get(Ut(this,Zr));if(!T)return _r(this,Zr,void 0),[this];const _=T.getReroutes(S);return _==null||_.push(this),_}findNextReroute(S,T=new Set){var _,w;if(Ut(this,Zr)===S)return this;if(T.has(this))return null;if(T.add(this),Ut(this,Zr)!==void 0)return(w=(_=Ut(this,Lr).deref())==null?void 0:_.reroutes.get(Ut(this,Zr)))==null?void 0:w.findNextReroute(S,T)}findSourceOutput(){var _,w;const S=(_=this.firstLink)!=null?_:this.firstFloatingLink;if(!S)return;const T=(w=Ut(this,Lr).deref())==null?void 0:w.getNodeById(S.origin_id);if(T)return{node:T,output:T.outputs[S.origin_slot]}}findTargetInputs(){const S=Ut(this,Lr).deref();if(!S)return;const T=[];return _(S,this.linkIds,S.links),_(S,this.floatingLinkIds,S.floatingLinks),T;function _(w,B,A){for(const O of B){const R=A.get(O);if(!R)continue;const P=w.getNodeById(R.target_id),E=P==null?void 0:P.inputs[R.target_slot];E&&T.push({node:P,input:E,link:R})}}}getFloatingLinks(S){var B;const T=(B=Ut(this,Lr).deref())==null?void 0:B.floatingLinks;if(!T)return;const _=S==="input"?"origin_id":"target_id",w=[];for(const A of this.floatingLinkIds){const O=T.get(A);(O==null?void 0:O[_])===-1&&w.push(O)}return w}setFloatingLinkOrigin(S,T,_){var A,O,R,P;const w=Ut(this,Lr).deref(),B=this.getFloatingLinks("output");if(!B)throw new Error("[setFloatingLinkOrigin]: Invalid network.");if(B.length){(A=T._floatingLinks)!=null||(T._floatingLinks=new Set);for(const E of B)T._floatingLinks.add(E),(P=(R=(O=w==null?void 0:w.getNodeById(E.origin_id))==null?void 0:O.outputs[E.origin_slot])==null?void 0:R._floatingLinks)==null||P.delete(E),E.origin_id=S.id,E.origin_slot=_}}move(S,T){Ut(this,Ur)[0]+=S,Ut(this,Ur)[1]+=T}snapToGrid(S){if(!S)return!1;const{pos:T}=this;return T[0]=S*Math.round(T[0]/S),T[1]=S*Math.round(T[1]/S),!0}removeAllFloatingLinks(){for(const S of this.floatingLinkIds)this.removeFloatingLink(S)}removeFloatingLink(S){const T=Ut(this,Lr).deref();if(!T)return;const _=T.floatingLinks.get(S);if(!_){console.warn("[Reroute.removeFloatingLink] Floating link not found: ".concat(S,", ignoring and discarding ID.")),this.floatingLinkIds.delete(S);return}T.removeFloatingLink(_)}removeLink(S){const T=Ut(this,Lr).deref();if(!T)return;const _=T.floatingLinks.get(S.id);S===_?this.floatingLinkIds.delete(S.id):this.linkIds.delete(S.id)}remove(){const S=Ut(this,Lr).deref();S&&S.removeReroute(this.id)}calculateAngle(S,T,_){if(!(S>Ut(this,Ri)))return;_r(this,Ri,S);const{id:w,pos:B}=this,A=[];let O=0;if(N(this.linkIds,T.links),N(this.floatingLinkIds,T.floatingLinks),!A.length){this.cos=0,this.sin=0,this.controlPoint[0]=0,this.controlPoint[1]=0;return}O/=A.length;const R=Math.atan2(Ut(this,Ur)[1]-_[1],Ut(this,Ur)[0]-_[0]);let P=(R-O)*.5;Math.abs(P)>Math.PI*.5&&(P+=Math.PI);const E=Math.min(Nr.maxSplineOffset,distance(_,Ut(this,Ur))*.25),D=R-P,I=Math.cos(D),M=Math.sin(D);this.cos=I,this.sin=M,this.controlPoint[0]=E*-I,this.controlPoint[1]=E*-M;function N(k,F){for(const G of k){const V=F.get(G),j=getNextPos(T,V,w);if(!j)continue;const H=getDirection(B,j);A.push(H),O+=H}}}draw(S,T){var B;const{globalAlpha:_}=S,{pos:w}=this;if(S.beginPath(),S.arc(w[0],w[1],Nr.radius,0,2*Math.PI),this.linkIds.size===0&&(S.fillStyle=T!=null?T:"#797979",S.fill(),S.globalAlpha=_*.33),S.fillStyle=(B=this._colour)!=null?B:"#18184d",S.lineWidth=Nr.radius*.1,S.strokeStyle="rgb(0,0,0,0.5)",S.fill(),S.stroke(),S.fillStyle="#ffffff55",S.strokeStyle="rgb(0,0,0,0.3)",S.beginPath(),S.arc(w[0],w[1],Nr.radius*.8,0,2*Math.PI),S.fill(),S.stroke(),this.selected&&(S.strokeStyle="#fff",S.beginPath(),S.arc(w[0],w[1],Nr.radius*1.2,0,2*Math.PI),S.stroke()),Nr.drawIdBadge){const A=new LGraphBadge({text:this.id.toString()}),O=w[0]-A.getWidth(S)*.5,R=w[1]-A.height-Nr.radius-2;A.draw(S,O,R)}S.globalAlpha=_}drawHighlight(S,T){const{pos:_}=this,{strokeStyle:w,lineWidth:B}=S;S.strokeStyle=w,S.lineWidth=B,S.strokeStyle=T,S.lineWidth=1,S.beginPath(),S.arc(_[0],_[1],Nr.radius*1.5,0,2*Math.PI),S.stroke(),S.strokeStyle=w,S.lineWidth=B}asSerialisable(){const{id:S,parentId:T,pos:_,linkIds:w}=this;return{id:S,parentId:T,pos:[_[0],_[1]],linkIds:[...w],floating:this.floating?{slotType:this.floating.slotType}:void 0}}};vi=new WeakMap,Lr=new WeakMap,Zr=new WeakMap,Ur=new WeakMap,Ri=new WeakMap,Nr.radius=10,Nr.maxSplineOffset=80,Nr.drawIdBadge=!1;let Reroute=Nr;function getNextPos(L,S,T){var w,B;if(!S)return;const _=(w=LLink.findNextReroute(L,S,T))==null?void 0:w.pos;if(_)return _;if(!(S.target_id===-1||S.target_slot===-1))return(B=L.getNodeById(S.target_id))==null?void 0:B.getInputPos(S.target_slot)}function getDirection(L,S){return Math.atan2(S[1]-L[1],S[0]-L[0])}function getBoundaryNodes(L){const S=L==null?void 0:L.find(A=>A);if(!S)return null;let T=S,_=S,w=S,B=S;for(const A of L){if(!A)continue;const[O,R]=A.pos,[P,E]=A.size;R<T.pos[1]&&(T=A),O+P>_.pos[0]+_.size[0]&&(_=A),R+E>w.pos[1]+w.size[1]&&(w=A),O<B.pos[0]&&(B=A)}return{top:T,right:_,bottom:w,left:B}}function distributeNodes(L,S){const T=L==null?void 0:L.length;if(!(T>1))return;const _=S?0:1;let w=0,B=-1/0;for(const E of L){w+=E.size[_];const D=E.pos[_]+E.size[_];D>B&&(B=D)}const A=[...L].sort((E,D)=>E.pos[_]-D.pos[_]),O=A[0].pos[_],R=(B-O-w)/(T-1);let P=O;for(let E=0;E<T;E++){const D=A[E];D.pos[_]=P+R*E,P+=D.size[_]}}function alignNodes(L,S,T){if(!L)return;const _=T===void 0?getBoundaryNodes(L):{top:T,right:T,bottom:T,left:T};if(_!==null)for(const w of L)switch(S){case"right":w.pos[0]=_.right.pos[0]+_.right.size[0]-w.size[0];break;case"left":w.pos[0]=_.left.pos[0];break;case"top":w.pos[1]=_.top.pos[1];break;case"bottom":w.pos[1]=_.bottom.pos[1]+_.bottom.size[1]-w.size[1];break}}var sn,an,on,ai,Kr,ln,cn,un,ir,rn,ei,Oi,Hr,Mi,oi,ea,qr,ta,ra,ia,na,sa,wi,Ai,aa,oa,la,ca,ua,nn,ki;const Vt=class Vt{constructor(S,T,_){dr(this,ir);dr(this,ei);dr(this,Oi);dr(this,Hr);dr(this,Mi);dr(this,oi);this.state={draggingItems:!1,draggingCanvas:!1,readOnly:!1,hoveringOver:CanvasItem.Nothing,shouldSetCursor:!0},this._previously_dragging_canvas=null,_r(this,ei,0),this.linkMarkerShape=LinkMarkerShape.Circle,this.low_quality_zoom_threshold=.6,this.renderedPaths=new Set,this.visible_links=[],this.linkConnector=new LinkConnector(w=>this.connecting_links=w),this.frame=0,this.last_draw_time=0,this.render_time=0,this.fps=0,this.selected_nodes={},this.selectedItems=new Set,this.resizingGroup=null,this.selected_group=null,this.visible_nodes=[],_r(this,Oi,new Set),this.highlighted_links={},this.dirty_canvas=!0,this.dirty_bgcanvas=!0,this.dirty_nodes=new Map,this.last_mouse=[0,0],this.last_mouseclick=0,_r(this,Mi,!1),this.dragZoomEnabled=!1,_r(this,oi,null),this.openSubgraph=function(w){if(!w)throw"graph cannot be null";if(this.graph==w)throw"graph cannot be the same";this.upVisibleArea==null&&(this.upVisibleArea={}),this.upVisibleArea[this.graph.id]={offset:[this.ds.offset[0],this.ds.offset[1]],scale:this.ds.scale},this.clear(),this.graph&&(this._graph_stack||(this._graph_stack=[]),this._graph_stack.push(this.graph)),w.attachCanvas(this),this.upVisibleArea[w.id]!=null&&(this.ds.scale=this.upVisibleArea[w.id].scale,this.ds.offset=this.upVisibleArea[w.id].offset),this.checkPanels(),this.setDirty(!0,!0)},this.closeSubgraph=function(){if(!(!this._graph_stack||this._graph_stack.length==0)){this.upVisibleArea[this.graph.id]={offset:[this.ds.offset[0],this.ds.offset[1]],scale:this.ds.scale};var w=this.graph._subgraph_node,B=this._graph_stack.pop();this.selected_nodes={},this.highlighted_links={},B.attachCanvas(this),this.setDirty(!0,!0),w&&(this.centerOnNode(w),this.selectNodes([w])),this.upVisibleArea[B.id]!=null&&(this.ds.scale=this.upVisibleArea[B.id].scale,this.ds.offset=this.upVisibleArea[B.id].offset)}},this.showSubgraphPropertiesDialogRight=function(w){console.log("showing subgraph output properties dialog");var B=this.canvas.parentNode.querySelector(".subgraph_dialog");B&&B.close();var A=this.createPanel("Subgraph Outputs",{closable:!0,width:500});A.node=w,A.classList.add("subgraph_dialog");function O(){if(A.clear(),w.outputs)for(var D=0;D<w.outputs.length;++D){var I=w.outputs[D];if(!I.not_subgraph_output){var M="<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>",N=A.addHTML(M,"subgraph_property");N.dataset.name=I.name,N.dataset.slot=D,N.querySelector(".name").innerText=I.name,N.querySelector(".type").innerText=I.type,N.querySelector("button").addEventListener("click",function(k){w.removeOutput(Number(this.parentNode.dataset.slot)),O()})}}}var R=" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>",P=A.addHTML(R,"subgraph_property extra",!0);P.querySelector(".name").addEventListener("keydown",function(D){D.keyCode==13&&E.apply(this)}),P.querySelector("button").addEventListener("click",function(D){E.apply(this)});function E(){var D=this.parentNode,I=D.querySelector(".name").value,M=D.querySelector(".type").value;!I||w.findOutputSlot(I)!=-1||(w.addOutput(I,M),D.querySelector(".name").value="",D.querySelector(".type").value="",O())}return O(),this.canvas.parentNode.appendChild(A),A},_||(_={}),this.options=_,this.background_image=Vt.DEFAULT_BACKGROUND_IMAGE,this.ds=new DragAndScale(S),this.pointer=new CanvasPointer(S),this.linkConnector.events.addEventListener("reset",()=>{this.connecting_links=null}),this.linkConnector.events.addEventListener("dropped-on-canvas",w=>{var O;if(!this.connecting_links)return;const B=w.detail;this.emitEvent({subType:"empty-release",originalEvent:B,linkReleaseContext:{links:this.connecting_links}});const A=this.linkConnector.renderLinks[0];if(LiteGraph.release_link_on_empty_shows_menu){const R=this.linkConnector.state.connectingTo==="input"?{node_from:A.node,slot_from:A.fromSlot,type_filter_in:A.fromSlot.type}:{node_to:A.node,slot_from:A.fromSlot,type_filter_out:A.fromSlot.type},P=(O=A.fromReroute)==null?void 0:O.id;"shiftKey"in B&&B.shiftKey?this.allow_searchbox&&this.showSearchBox(B,R):this.linkConnector.state.connectingTo==="input"?this.showConnectionMenu({nodeFrom:A.node,slotFrom:A.fromSlot,e:B,afterRerouteId:P}):this.showConnectionMenu({nodeTo:A.node,slotTo:A.fromSlot,e:B,afterRerouteId:P})}}),this.zoom_modify_alpha=!0,this.zoom_speed=1.1,this.node_title_color=LiteGraph.NODE_TITLE_COLOR,this.default_link_color=LiteGraph.LINK_COLOR,this.default_connection_color={input_off:"#778",input_on:"#7F7",output_off:"#778",output_on:"#7F7"},this.default_connection_color_byType={},this.default_connection_color_byTypeOff={},this.highquality_render=!0,this.use_gradients=!1,this.editor_alpha=1,this.pause_rendering=!1,this.clear_background=!0,this.clear_background_color="#222",this.render_only_selected=!0,this.show_info=!0,this.allow_dragcanvas=!0,this.allow_dragnodes=!0,this.allow_interaction=!0,this.multi_select=!1,this.allow_searchbox=!0,this.allow_reconnect_links=!0,this.align_to_grid=!1,this.drag_mode=!1,this.dragging_rectangle=null,this.filter=null,this.set_canvas_dirty_on_mouse_event=!0,this.always_render_background=!1,this.render_shadows=!0,this.render_canvas_border=!0,this.render_connections_shadows=!1,this.render_connections_border=!0,this.render_curved_connections=!1,this.render_connection_arrows=!1,this.render_collapsed_slots=!0,this.render_execution_order=!1,this.render_link_tooltip=!0,this.links_render_mode=LinkRenderType.SPLINE_LINK,this.mouse=[0,0],this.graph_mouse=[0,0],this.canvas_mouse=this.graph_mouse,this.connections_width=3,this.current_node=null,this.node_widget=null,this.last_mouse_position=[0,0],this.visible_area=this.ds.visible_area,this.connecting_links=null,this.viewport=_.viewport||null,this.graph=T,T==null||T.attachCanvas(this),this.canvas=void 0,this.bgcanvas=void 0,this.ctx=void 0,this.upVisibleArea={},this.setCanvas(S,_.skip_events),this.clear(),_.skip_render||this.startRendering(),this.autoresize=_.autoresize}get read_only(){return this.state.readOnly}set read_only(S){this.state.readOnly=S,Zt(this,ir,rn).call(this)}get isDragging(){return this.state.draggingItems}set isDragging(S){this.state.draggingItems=S}get hoveringOver(){return this.state.hoveringOver}set hoveringOver(S){this.state.hoveringOver=S,Zt(this,ir,rn).call(this)}get pointer_is_down(){return this.pointer.isDown}get pointer_is_double(){return this.pointer.isDouble}get dragging_canvas(){return this.state.draggingCanvas}set dragging_canvas(S){this.state.draggingCanvas=S,Zt(this,ir,rn).call(this)}get title_text_font(){return"".concat(LiteGraph.NODE_TEXT_SIZE,"px Arial")}get inner_text_font(){return"normal ".concat(LiteGraph.NODE_SUBTEXT_SIZE,"px Arial")}get maximumFps(){return Ut(this,ei)>Number.EPSILON?Ut(this,ei)/1e3:0}set maximumFps(S){_r(this,ei,S>Number.EPSILON?1e3/S:0)}get round_radius(){return LiteGraph.ROUND_RADIUS}set round_radius(S){LiteGraph.ROUND_RADIUS=S}get low_quality(){return this.ds.scale<this.low_quality_zoom_threshold}static onGroupAdd(S,T,_){const w=Vt.active_canvas,B=new LiteGraph.LGraphGroup;if(B.pos=w.convertEventToCanvasOffset(_),!w.graph)throw new NullGraphError;w.graph.add(B)}static getBoundaryNodes(S){var _;const T=Array.isArray(S)?S:Object.values(S);return(_=getBoundaryNodes(T))!=null?_:{top:null,right:null,bottom:null,left:null}}static alignNodes(S,T,_){alignNodes(Object.values(S),T,_),Vt.active_canvas.setDirty(!0,!0)}static onNodeAlign(S,T,_,w,B){new LiteGraph.ContextMenu(["Top","Bottom","Left","Right"],{event:_,callback:A,parentMenu:w});function A(O){alignNodes(Object.values(Vt.active_canvas.selected_nodes),O.toLowerCase(),B),Vt.active_canvas.setDirty(!0,!0)}}static onGroupAlign(S,T,_,w){new LiteGraph.ContextMenu(["Top","Bottom","Left","Right"],{event:_,callback:B,parentMenu:w});function B(A){alignNodes(Object.values(Vt.active_canvas.selected_nodes),A.toLowerCase()),Vt.active_canvas.setDirty(!0,!0)}}static createDistributeMenu(S,T,_,w){new LiteGraph.ContextMenu(["Vertically","Horizontally"],{event:_,callback:B,parentMenu:w});function B(A){const O=Vt.active_canvas;distributeNodes(Object.values(O.selected_nodes),A==="Horizontally"),O.setDirty(!0,!0)}}static onMenuAdd(S,T,_,w,B){const A=Vt.active_canvas,O=A.getCanvasWindow(),{graph:R}=A;if(!R)return;return P("",w),!1;function P(E,D){if(!R)return;const I=LiteGraph.getNodeTypesCategories(A.filter||R.filter).filter(k=>k.startsWith(E)),M=[];for(const k of I){if(!k)continue;const F=new RegExp("^(".concat(E,")")),G=k.replace(F,"").split("/",1)[0],V=E===""?"".concat(G,"/"):"".concat(E).concat(G,"/");let j=G;j.includes("::")&&(j=j.split("::",2)[1]),M.findIndex(U=>U.value===V)===-1&&M.push({value:V,content:j,has_submenu:!0,callback:function(U,X,Y,z){P(U.value,z)}})}const N=LiteGraph.getNodeTypesInCategory(E.slice(0,-1),A.filter||R.filter);for(const k of N){if(k.skip_list)continue;const F={value:k.type,content:k.title,has_submenu:!1,callback:function(G,V,j,H){if(!A.graph)throw new NullGraphError;const U=H.getFirstEvent();A.graph.beforeChange();const X=LiteGraph.createNode(G.value);if(X){if(!U)throw new TypeError("Context menu event was null. This should not occure in normal usage.");X.pos=A.convertEventToCanvasOffset(U),A.graph.add(X)}B==null||B(X),A.graph.afterChange()}};M.push(F)}console.log("构建菜单选项",E,M),new LiteGraph.ContextMenu(M,{event:_,parentMenu:D},O)}}static onMenuCollapseAll(){}static onMenuNodeEdit(){}static showMenuNodeOptionalInputs(S,P,_,w,B){if(!B)return;var A=this,O=Vt.active_canvas,R=O.getCanvasWindow(),P=B.optional_inputs;B.onGetInputs&&(P=B.onGetInputs());var E=[];if(P)for(var D=0;D<P.length;D++){var I=P[D];if(!I){E.push(null);continue}var M=I[0];I[2]||(I[2]={}),I[2].label&&(M=I[2].label),I[2].removable=!0;var N={content:M,value:I};I[1]==LiteGraph.ACTION&&(N.className="event"),E.push(N)}if(B.onMenuNodeInputs){var k=B.onMenuNodeInputs(E);k&&(E=k)}if(!E.length){console.log("no input entries");return}new LiteGraph.ContextMenu(E,{event:_,callback:F,parentMenu:w,node:B},R);function F(G,V,j){B&&(G.callback&&G.callback.call(A,B,G,V,j),G.value&&(B.graph.beforeChange(),B.addInput(G.value[0],G.value[1],G.value[2]),B.onNodeInputAdd&&B.onNodeInputAdd(G.value),B.setDirtyCanvas(!0,!0),B.graph.afterChange()))}return!1}static showMenuNodeOptionalOutputs(S,T,_,w,B){var k;if(!B)return;const A=Vt.active_canvas;var O=B.optional_outputs;B.onGetOutputs&&(O=B.onGetOutputs());let R=[];if(O)for(var P=0;P<O.length;P++){var E=O[P];if(!E){R.push(null);continue}var D=E[0];E[2]||(E[2]={}),E[2].label&&(D=E[2].label),E[2].removable=!0;var I={content:D,value:E};E[1]==LiteGraph.ACTION&&(I.className="event"),R.push(I)}LiteGraph.do_add_triggers_slots&&B.findOutputSlot("onExecuted")==-1&&R.push({content:"On Executed",value:["onExecuted",LiteGraph.EVENT,{nameLocked:!0}],className:"event"});const M=(k=B.onMenuNodeOutputs)==null?void 0:k.call(B,R);if(M&&(R=M),!R.length)return;new LiteGraph.ContextMenu(R,{event:_,callback:N,parentMenu:w,node:B});function N(F,G,V){var U;if(!B||(F.callback&&F.callback.call(this,B,F,G,V),!F.value))return;const j=F.value[1];if(j&&(typeof j=="object"||Array.isArray(j))){const X=[];for(const Y in j)X.push({content:Y,value:j[Y]});return new LiteGraph.ContextMenu(X,{event:G,callback:N,parentMenu:w,node:B}),!1}const{graph:H}=B;if(!H)throw new NullGraphError;H.beforeChange(),B.addOutput(F.value[0],F.value[1],F.value[2]),(U=B.onNodeOutputAdd)==null||U.call(B,F.value),A.setDirty(!0,!0),H.afterChange()}return!1}static onShowMenuNodeProperties(S,T,_,w,B){if(!B||!B.properties)return;const A=Vt.active_canvas,O=A.getCanvasWindow(),R=[];for(const E in B.properties){S=B.properties[E]!==void 0?B.properties[E]:" ",typeof S=="object"&&(S=JSON.stringify(S));const D=B.getPropertyInfo(E);(D.type=="enum"||D.type=="combo")&&(S=Vt.getPropertyPrintableValue(S,D.values)),S=Vt.decodeHTML(stringOrEmpty(S)),R.push({content:"<span class='property_name'>".concat(D.label||E,"</span><span class='property_value'>").concat(S,"</span>"),value:E})}if(!R.length)return;new LiteGraph.ContextMenu(R,{event:_,callback:P,parentMenu:w,allow_html:!0,node:B},O);function P(E){if(!B)return;const D=this.getBoundingClientRect();A.showEditPropertyValue(B,E.value,{position:[D.left,D.top]})}return!1}static decodeHTML(S){const T=document.createElement("div");return T.textContent=S,T.innerHTML}static onMenuResizeNode(S,T,_,w,B){if(!B)return;const A=function(R){R.setSize(R.computeSize())},O=Vt.active_canvas;if(!O.selected_nodes||Object.keys(O.selected_nodes).length<=1)A(B);else for(const R in O.selected_nodes)A(O.selected_nodes[R]);O.setDirty(!0,!0)}static onShowPropertyEditor(S,T,_,w,B){const A=S.property||"title",O=B[A],R=document.createElement("span");R.className="name",R.textContent=A;const P=document.createElement("input");Object.assign(P,{type:"text",className:"value",autofocus:!0});const E=document.createElement("button");E.textContent="OK";const D=Object.assign(document.createElement("div"),{is_modified:!1,className:"graphdialog",close:()=>D.remove()});D.append(R,P,E),P.value=String(O),P.addEventListener("blur",function(){this.focus()}),P.addEventListener("keydown",H=>{if(D.is_modified=!0,H.key=="Escape")D.close();else if(H.key=="Enter")V();else if(!H.target||!("localName"in H.target)||H.target.localName!="textarea")return;H.preventDefault(),H.stopPropagation()});const I=Vt.active_canvas,M=I.canvas,N=M.getBoundingClientRect(),k=N?-20-N.left:-20,F=N?-20-N.top:-20;if(_?(D.style.left="".concat(_.clientX+k,"px"),D.style.top="".concat(_.clientY+F,"px")):(D.style.left="".concat(M.width*.5+k,"px"),D.style.top="".concat(M.height*.5+F,"px")),E.addEventListener("click",V),M.parentNode==null)throw new TypeError("canvasEl.parentNode was null");M.parentNode.append(D),P.focus();let G;D.addEventListener("mouseleave",function(){LiteGraph.dialog_close_on_mouse_leave&&!D.is_modified&&LiteGraph.dialog_close_on_mouse_leave&&(G=setTimeout(D.close,LiteGraph.dialog_close_on_mouse_leave_delay))}),D.addEventListener("mouseenter",function(){LiteGraph.dialog_close_on_mouse_leave&&G&&clearTimeout(G)});function V(){P&&j(P.value)}function j(H){S.type=="Number"?H=Number(H):S.type=="Boolean"&&(H=!!H),B[A]=H,D.remove(),I.setDirty(!0,!0)}}static getPropertyPrintableValue(S,T){if(!T||Array.isArray(T))return String(S);if(typeof T=="object"){let _="";for(const w in T)if(T[w]==S){_=w;break}return"".concat(String(S)," (").concat(_,")")}}static onMenuNodeCollapse(S,T,_,w,B){if(!B.graph)throw new NullGraphError;B.graph.beforeChange();const A=function(R){R.collapse()},O=Vt.active_canvas;if(!O.selected_nodes||Object.keys(O.selected_nodes).length<=1)A(B);else for(const R in O.selected_nodes)A(O.selected_nodes[R]);B.graph.afterChange()}static onMenuToggleAdvanced(S,T,_,w,B){if(!B.graph)throw new NullGraphError;B.graph.beforeChange();const A=function(R){R.toggleAdvanced()},O=Vt.active_canvas;if(!O.selected_nodes||Object.keys(O.selected_nodes).length<=1)A(B);else for(const R in O.selected_nodes)A(O.selected_nodes[R]);B.graph.afterChange()}static onMenuNodeMode(S,T,_,w,B){new LiteGraph.ContextMenu(LiteGraph.NODE_MODES,{event:_,callback:A,parentMenu:w,node:B});function A(O){if(!B)return;const R=Object.values(LiteGraph.NODE_MODES).indexOf(O),P=function(D){R!==-1&&LiteGraph.NODE_MODES[R]?D.changeMode(R):(console.warn("unexpected mode: ".concat(O)),D.changeMode(LGraphEventMode.ALWAYS))},E=Vt.active_canvas;if(!E.selected_nodes||Object.keys(E.selected_nodes).length<=1)P(B);else for(const D in E.selected_nodes)P(E.selected_nodes[D])}return!1}static onMenuNodeColors(S,T,_,w,B){if(!B)throw"no node for color";const A=[];A.push({value:null,content:"<span style='display: block; padding-left: 4px;'>No color</span>"});for(const R in Vt.node_colors){const P=Vt.node_colors[R];S={value:R,content:"<span style='display: block; color: #999; padding-left: 4px; border-left: 8px solid ".concat(P.color,"; background-color:").concat(P.bgcolor,"'>").concat(R,"</span>")},A.push(S)}new LiteGraph.ContextMenu(A,{event:_,callback:O,parentMenu:w,node:B});function O(R){if(!B)return;const P=function(D){const I=R.value?Vt.node_colors[R.value]:null;D.setColorOption(I)},E=Vt.active_canvas;if(!E.selected_nodes||Object.keys(E.selected_nodes).length<=1)P(B);else for(const D in E.selected_nodes)P(E.selected_nodes[D]);E.setDirty(!0,!0)}return!1}static onMenuNodeShapes(S,T,_,w,B){if(!B)throw"no node passed";new LiteGraph.ContextMenu(LiteGraph.VALID_SHAPES,{event:_,callback:A,parentMenu:w,node:B});function A(O){if(!B)return;if(!B.graph)throw new NullGraphError;B.graph.beforeChange();const R=function(E){E.shape=O},P=Vt.active_canvas;if(!P.selected_nodes||Object.keys(P.selected_nodes).length<=1)R(B);else for(const E in P.selected_nodes)R(P.selected_nodes[E]);B.graph.afterChange(),P.setDirty(!0)}return!1}static onMenuNodeRemove(){Vt.active_canvas.deleteSelected()}onMenuNodeToSubgraph(S,T,_,w,B){var A=B.graph,O=Vt.active_canvas;if(O){var R=Object.values(O.selected_nodes||{});R.length||(R=[B]);var P=LiteGraph.createNode("middle/graph/subgraph");P.pos=B.pos.concat(),A.add(P),P.buildFromNodes(R),O.deselectAllNodes(),B.setDirtyCanvas(!0,!0)}}static onMenuNodeClone(S,T,_,w,B){const{graph:A}=B;if(!A)throw new NullGraphError;A.beforeChange();const O=new Set,R=function(E,D){if(E.clonable===!1)return;const I=E.clone();if(I){if(I.pos=[E.pos[0]+5,E.pos[1]+5],!E.graph)throw new NullGraphError;E.graph.add(I),D.add(I)}},P=Vt.active_canvas;if(!P.selected_nodes||Object.keys(P.selected_nodes).length<=1)R(B,O);else for(const E in P.selected_nodes)R(P.selected_nodes[E],O);O.size&&P.selectNodes([...O]),A.afterChange(),P.setDirty(!0,!0)}clear(){var S,T;this.frame=0,this.last_draw_time=0,this.render_time=0,this.fps=0,this.dragging_rectangle=null,this.selected_nodes={},this.selected_group=null,this.selectedItems.clear(),(S=this.onSelectionChange)==null||S.call(this,this.selected_nodes),this.visible_nodes=[],this.node_over=void 0,this.node_capturing_input=null,this.connecting_links=null,this.highlighted_links={},this.dragging_canvas=!1,Zt(this,ir,qr).call(this),this.dirty_area=null,this.node_in_panel=null,this.node_widget=null,this.last_mouse=[0,0],this.last_mouseclick=0,this.pointer.reset(),this.visible_area.set([0,0,0,0]),(T=this.onClear)==null||T.call(this)}setGraph(S,T){if(this.graph!=S){if(T||this.clear(),!S&&this.graph){this.graph.detachCanvas(this);return}S.attachCanvas(this),this._graph_stack&&(this._graph_stack=null),this.setDirty(!0,!0)}}getTopGraph(){return this._graph_stack.length?this._graph_stack[0]:this.graph}getCurrentGraph(){return this.graph}setCanvas(S,T){var B;const _=Zt(this,ir,ea).call(this,S);if(_===this.canvas||(!_&&this.canvas&&!T&&this.unbindEvents(),this.canvas=_,this.ds.element=_,this.pointer.element=_,!_))return;_.className+=" lgraphcanvas",_.data=this,this.bgcanvas=document.createElement("canvas"),this.bgcanvas.width=this.canvas.width,this.bgcanvas.height=this.canvas.height;const w=(B=_.getContext)==null?void 0:B.call(_,"2d");if(w==null)throw _.localName!="canvas"?"Element supplied for LGraphCanvas must be a <canvas> element, you passed a ".concat(_.localName):"This browser doesn't support Canvas";this.ctx=w,T||this.bindEvents()}_doNothing(S){return S.preventDefault(),!1}_doReturnTrue(S){return S.preventDefault(),!0}bindEvents(){if(this._events_binded){console.warn("LGraphCanvas: events already binded");return}const{canvas:S}=this,{document:T}=this.getCanvasWindow();this._mousedown_callback=this.processMouseDown.bind(this),this._mousewheel_callback=this.processMouseWheel.bind(this),this._mousemove_callback=this.processMouseMove.bind(this),this._mouseup_callback=this.processMouseUp.bind(this),this._mouseout_callback=this.processMouseOut.bind(this),this._mousecancel_callback=this.processMouseCancel.bind(this),S.addEventListener("pointerdown",this._mousedown_callback,!0),S.addEventListener("wheel",this._mousewheel_callback,!1),S.addEventListener("pointerup",this._mouseup_callback,!0),S.addEventListener("pointermove",this._mousemove_callback),S.addEventListener("pointerout",this._mouseout_callback),S.addEventListener("pointercancel",this._mousecancel_callback,!0),S.addEventListener("contextmenu",this._doNothing),this._key_callback=this.processKey.bind(this),S.addEventListener("keydown",this._key_callback,!0),T.addEventListener("keyup",this._key_callback,!0),S.addEventListener("dragover",this._doNothing,!1),S.addEventListener("dragend",this._doNothing,!1),S.addEventListener("dragenter",this._doReturnTrue,!1),this._events_binded=!0}unbindEvents(){if(!this._events_binded){console.warn("LGraphCanvas: no events binded");return}const{document:S}=this.getCanvasWindow(),{canvas:T}=this;T.removeEventListener("pointercancel",this._mousecancel_callback),T.removeEventListener("pointerout",this._mouseout_callback),T.removeEventListener("pointermove",this._mousemove_callback),T.removeEventListener("pointerup",this._mouseup_callback),T.removeEventListener("pointerdown",this._mousedown_callback),T.removeEventListener("wheel",this._mousewheel_callback),T.removeEventListener("keydown",this._key_callback),S.removeEventListener("keyup",this._key_callback),T.removeEventListener("contextmenu",this._doNothing),T.removeEventListener("dragenter",this._doReturnTrue),this._mousedown_callback=void 0,this._mousewheel_callback=void 0,this._key_callback=void 0,this._events_binded=!1}setDirty(S,T){S&&(this.dirty_canvas=!0),T&&(this.dirty_bgcanvas=!0)}getCanvasWindow(){if(!this.canvas)return window;const S=this.canvas.ownerDocument;return S.defaultView||S.parentWindow}startRendering(){if(this.is_rendering)return;this.is_rendering=!0,S.call(this);function S(){this.pause_rendering||this.draw();const T=this.getCanvasWindow();if(this.is_rendering)if(Ut(this,ei)>0){const _=Ut(this,ei)-(LiteGraph.getTime()-this.last_draw_time);setTimeout(S.bind(this),Math.max(1,_))}else T.requestAnimationFrame(S.bind(this))}}stopRendering(){this.is_rendering=!1}blockClick(){this.block_click=!0,this.last_mouseclick=0}getWidgetAtCursor(S){var T;return S!=null||(S=this.node_over),(T=S==null?void 0:S.getWidgetOnPos(this.graph_mouse[0],this.graph_mouse[1],!0))!=null?T:null}updateMouseOverNodes(S,T){var w,B;if(!this.graph)throw new NullGraphError;const _=this.graph._nodes;for(const A of _)A.mouseOver&&S!=A&&(A.mouseOver=null,this._highlight_input=void 0,this._highlight_pos=void 0,this.linkConnector.overWidget=void 0,A.lostFocusAt=LiteGraph.getTime(),(B=(w=this.node_over)==null?void 0:w.onMouseLeave)==null||B.call(w,T),this.node_over=void 0,this.dirty_canvas=!0)}processMouseDown(S){var P,E,D,I;if(this.dragZoomEnabled&&S.ctrlKey&&S.shiftKey&&!S.altKey&&S.buttons){_r(this,oi,{pos:[S.x,S.y],scale:this.ds.scale});return}const{graph:T,pointer:_}=this;if(this.adjustMouseEvent(S),S.isPrimary&&_.down(S),this.set_canvas_dirty_on_mouse_event&&(this.dirty_canvas=!0),!T)return;const w=this.getCanvasWindow();Vt.active_canvas=this;const B=S.clientX,A=S.clientY;if(this.ds.viewport=this.viewport,!(!this.viewport||isInRect(B,A,this.viewport)))return;const R=(P=T.getNodeOnPos(S.canvasX,S.canvasY,this.visible_nodes))!=null?P:void 0;if(this.mouse[0]=B,this.mouse[1]=A,this.graph_mouse[0]=S.canvasX,this.graph_mouse[1]=S.canvasY,this.last_click_position=[this.mouse[0],this.mouse[1]],_.isDouble=_.isDown&&S.isPrimary,_.isDown=!0,this.canvas.focus(),LiteGraph.closeAllContextMenus(w),((E=this.onMouse)==null?void 0:E.call(this,S))!=!0){if(S.button===0&&!_.isDouble)Zt(this,ir,ta).call(this,S,R);else if(S.button===1)Zt(this,ir,na).call(this,S,R);else if((S.button===2||_.isDouble)&&this.allow_interaction&&!this.read_only){if(R)this.processSelect(R,S,!0);else if(this.links_render_mode!==LinkRenderType.HIDDEN_LINK){const M=T.getRerouteOnPos(S.canvasX,S.canvasY);M&&(S.altKey?_.onClick=N=>{var k;N.altKey&&(M.selected&&(this.deselect(M),(k=this.onSelectionChange)==null||k.call(this,this.selected_nodes)),M.remove())}:this.processSelect(M,S,!0))}(D=_.onClick)!=null||(_.onClick=()=>this.processContextMenu(R,S))}this.last_mouse=[B,A],this.last_mouseclick=LiteGraph.getTime(),this.last_mouse_dragging=!0,T.change(),(!w.document.activeElement||w.document.activeElement.nodeName.toLowerCase()!="input"&&w.document.activeElement.nodeName.toLowerCase()!="textarea")&&S.preventDefault(),S.stopPropagation(),(I=this.onMouseDown)==null||I.call(this,S)}}processMouseMove(S){var E,D,I,M;if(this.dragZoomEnabled&&S.ctrlKey&&S.shiftKey&&Ut(this,oi)){Zt(this,ir,sa).call(this,S);return}this.autoresize&&this.resize(),this.set_canvas_dirty_on_mouse_event&&(this.dirty_canvas=!0);const{graph:T,resizingGroup:_,linkConnector:w}=this;if(!T)return;Vt.active_canvas=this,this.adjustMouseEvent(S);const B=[S.clientX,S.clientY];this.mouse[0]=B[0],this.mouse[1]=B[1];const A=[B[0]-this.last_mouse[0],B[1]-this.last_mouse[1]];if(this.last_mouse=B,this.graph_mouse[0]=S.canvasX,this.graph_mouse[1]=S.canvasY,S.isPrimary&&this.pointer.move(S),this.block_click){S.preventDefault();return}if(S.dragging=this.last_mouse_dragging,this.node_widget){const[N,k]=this.node_widget;if(k!=null&&k.mouse){const F=S.canvasX-N.pos[0],G=S.canvasY-N.pos[1],V=k.mouse(S,[F,G],N);V!=null&&(this.dirty_canvas=V)}}let O=CanvasItem.Nothing;const R=T.getNodeOnPos(S.canvasX,S.canvasY,this.visible_nodes),P=this.dragging_rectangle;if(P)P[2]=S.canvasX-P[0],P[3]=S.canvasY-P[1],this.dirty_canvas=!0;else if(_)O|=CanvasItem.ResizeSe|CanvasItem.Group;else if(this.dragging_canvas)this.ds.offset[0]+=A[0]/this.ds.scale,this.ds.offset[1]+=A[1]/this.ds.scale,Zt(this,ir,qr).call(this);else if((this.allow_interaction||R!=null&&R.flags.allow_interaction)&&!this.read_only){if(w.isConnecting&&(this.dirty_canvas=!0),this.updateMouseOverNodes(R,S),R){O|=CanvasItem.Node,R.redraw_on_mouse&&(this.dirty_canvas=!0);const N=[0,0],k=isOverNodeInput(R,S.canvasX,S.canvasY,N),F=isOverNodeOutput(R,S.canvasX,S.canvasY,N),G=R.getWidgetOnPos(S.canvasX,S.canvasY,!0);if(R.mouseOver||(R.mouseOver={inputId:null,outputId:null,overWidget:null},this.node_over=R,this.dirty_canvas=!0,(E=R.onMouseEnter)==null||E.call(R,S)),(D=R.onMouseMove)==null||D.call(R,S,[S.canvasX-R.pos[0],S.canvasY-R.pos[1]],this),R.mouseOver.inputId!==k||R.mouseOver.outputId!==F||R.mouseOver.overWidget!==G){if(R.mouseOver.inputId=k,R.mouseOver.outputId=F,R.mouseOver.overWidget=G,w.overWidget=void 0,w.isConnecting){const V=w.renderLinks.at(0);let j,H;if(!(!V||!w.isNodeValidDrop(R))){if(w.state.connectingTo==="input")if(k===-1&&F===-1){if(!w.overWidget){const U=R.findInputByType(V.fromSlot.type);U&&(H=U.slot,j=R.getInputPos(U.index))}}else k!=-1&&R.inputs[k]&&LiteGraph.isValidConnection(V.fromSlot.type,R.inputs[k].type)&&(j=N,H=R.inputs[k]);else if(w.state.connectingTo==="output")if(k===-1&&F===-1){const U=R.findOutputByType(V.fromSlot.type);U&&(j=R.getOutputPos(U.index))}else F!=-1&&R.outputs[F]&&LiteGraph.isValidConnection(V.fromSlot.type,R.outputs[F].type)&&(j=N)}this._highlight_pos=j,this._highlight_input=H}this.dirty_canvas=!0}R.inResizeCorner(S.canvasX,S.canvasY)&&(O|=CanvasItem.ResizeSe)}else{const N=T.getRerouteOnPos(S.canvasX,S.canvasY);N?(O|=CanvasItem.Reroute,w.overReroute=N,w.isConnecting&&w.isRerouteValidDrop(N)&&(this._highlight_pos=N.pos)):(this._highlight_pos&&(this._highlight_pos=void 0),w.overReroute&&(w.overReroute=void 0));const k=Zt(this,ir,oa).call(this,S);if(this.over_link_center!==k&&(O|=CanvasItem.Link,this.over_link_center=k,this.dirty_bgcanvas=!0),this.canvas){const F=T.getGroupOnPos(S.canvasX,S.canvasY);F&&!S.ctrlKey&&!this.read_only&&F.isInResize(S.canvasX,S.canvasY)&&(O|=CanvasItem.ResizeSe)}}if(this.node_capturing_input&&this.node_capturing_input!=R&&((M=(I=this.node_capturing_input).onMouseMove)==null||M.call(I,S,[S.canvasX-this.node_capturing_input.pos[0],S.canvasY-this.node_capturing_input.pos[1]],this)),this.isDragging){const N=this.selectedItems,k=S.ctrlKey?N:getAllNestedItems(N),F=A[0]/this.ds.scale,G=A[1]/this.ds.scale;for(const V of k)V.move(F,G,!0);Zt(this,ir,qr).call(this)}this.resizing_node&&(O|=CanvasItem.ResizeSe)}this.hoveringOver=O,S.preventDefault()}processMouseUp(S){var A,O,R,P;if(S.isPrimary===!1)return;const{graph:T,pointer:_}=this;if(!T)return;Vt.active_canvas=this,this.adjustMouseEvent(S);const w=LiteGraph.getTime();if(S.click_time=w-this.last_mouseclick,_.up(S)===!0){_.isDown=!1,_.isDouble=!1,this.connecting_links=null,this.dragging_canvas=!1,T.change(),S.stopPropagation(),S.preventDefault(),this.last_mouse_dragging=!1,this.last_click_position=null,this.block_click&&(console.log("pointerevents: processMouseUp block_clicks"),this.block_click=!1);return}if(this.last_mouse_dragging=!1,this.last_click_position=null,this.block_click&&(console.log("pointerevents: processMouseUp block_clicks"),this.block_click=!1),S.button===0){this.selected_group=null,this.isDragging=!1;const E=S.canvasX,D=S.canvasY;this.linkConnector.isConnecting||(this.dirty_canvas=!0,(O=(A=this.node_over)==null?void 0:A.onMouseUp)==null||O.call(A,S,[E-this.node_over.pos[0],D-this.node_over.pos[1]],this),(P=(R=this.node_capturing_input)==null?void 0:R.onMouseUp)==null||P.call(R,S,[E-this.node_capturing_input.pos[0],D-this.node_capturing_input.pos[1]]))}else S.button===1?(this.dirty_canvas=!0,this.dragging_canvas=!1):S.button===2&&(this.dirty_canvas=!0);_.isDown=!1,_.isDouble=!1,T.change(),S.stopPropagation(),S.preventDefault()}processMouseOut(S){}processMouseCancel(){console.warn("Pointer cancel!"),this.pointer.reset()}processMouseWheel(S){var B;if(!this.graph||!this.allow_dragcanvas)return;const T=(B=S.wheelDeltaY)!=null?B:S.detail*-60;this.adjustMouseEvent(S);const _=[S.clientX,S.clientY];if(this.viewport&&!isPointInRect(_,this.viewport))return;let{scale:w}=this.ds;T>0?w*=this.zoom_speed:T<0&&(w*=1/this.zoom_speed),this.ds.changeScale(w,[S.clientX,S.clientY]),this.graph.change(),S.preventDefault()}processKey(S){var _,w,B,A,O,R,P;if(_r(this,Mi,S.shiftKey),!this.graph)return;let T=!1;if(S.target.localName!="input"){if(S.type=="keydown"){if(S.key===" ")this.read_only=!0,this._previously_dragging_canvas===null&&(this._previously_dragging_canvas=this.dragging_canvas),this.dragging_canvas=this.pointer.isDown,T=!0;else if(S.key==="Escape"){if(this.linkConnector.isConnecting){this.linkConnector.reset(),S.preventDefault();return}(_=this.node_panel)==null||_.close(),(w=this.options_panel)==null||w.close(),T=!0}else S.keyCode===65&&S.ctrlKey?(this.selectItems(),T=!0):S.keyCode===67&&(S.metaKey||S.ctrlKey)&&!S.shiftKey?this.selected_nodes&&(this.copyToClipboard(),T=!0):S.keyCode===86&&(S.metaKey||S.ctrlKey)?this.pasteFromClipboard({connectInputs:S.shiftKey}):(S.key==="Delete"||S.key==="Backspace")&&S.target.localName!="input"&&S.target.localName!="textarea"&&(this.deleteSelected(),T=!0);if(this.selected_nodes)for(const E in this.selected_nodes)(A=(B=this.selected_nodes[E]).onKeyDown)==null||A.call(B,S)}else if(S.type=="keyup"&&(S.key===" "&&(this.read_only=!1,this.dragging_canvas=((O=this._previously_dragging_canvas)!=null?O:!1)&&this.pointer.isDown,this._previously_dragging_canvas=null),this.selected_nodes))for(const E in this.selected_nodes)(P=(R=this.selected_nodes[E]).onKeyUp)==null||P.call(R,S);if(this.graph.change(),T)return S.preventDefault(),S.stopImmediatePropagation(),!1}}copyToClipboard(S){var _,w,B;const T={nodes:[],groups:[],reroutes:[],links:[]};for(const A of S!=null?S:this.selectedItems)if(A instanceof LGraphNode){if(A.clonable===!1)continue;const O=(_=A.clone())==null?void 0:_.serialize();if(!O)continue;if(O.id=A.id,T.nodes.push(O),A.inputs)for(const{link:R}of A.inputs){if(R==null)continue;const P=(B=(w=this.graph)==null?void 0:w._links.get(R))==null?void 0:B.asSerialisable();P&&T.links.push(P)}}else A instanceof LGraphGroup?T.groups.push(A.serialize()):A instanceof Reroute&&T.reroutes.push(A.asSerialisable());localStorage.setItem("litegrapheditor_clipboard",JSON.stringify(T))}emitEvent(S){this.canvas.dispatchEvent(new CustomEvent("litegraph:canvas",{bubbles:!0,detail:S}))}emitBeforeChange(){this.emitEvent({subType:"before-change"})}emitAfterChange(){this.emitEvent({subType:"after-change"})}_pasteFromClipboard(S={}){var N,k,F,G,V;const{connectInputs:T=!1,position:_=this.graph_mouse}=S;if(!LiteGraph.ctrl_shift_v_paste_connect_unselected_outputs&&T)return;const w=localStorage.getItem("litegrapheditor_clipboard");if(!w)return;const{graph:B}=this;if(!B)throw new NullGraphError;B.beforeChange();const A=JSON.parse(w);(N=A.nodes)!=null||(A.nodes=[]),(k=A.groups)!=null||(A.groups=[]),(F=A.reroutes)!=null||(A.reroutes=[]),(G=A.links)!=null||(A.links=[]);let O=1/0,R=1/0;for(const j of[...A.nodes,...A.reroutes]){if(j.pos==null)throw new TypeError("Invalid node encounterd on paste.  `pos` was null.");j.pos[0]<O&&(O=j.pos[0]),j.pos[1]<R&&(R=j.pos[1])}if(A.groups)for(const j of A.groups)j.bounding[0]<O&&(O=j.bounding[0]),j.bounding[1]<R&&(R=j.bounding[1]);const P={created:[],nodes:new Map,links:new Map,reroutes:new Map},{created:E,nodes:D,links:I,reroutes:M}=P;for(const j of A.groups){j.id=-1;const H=new LGraphGroup;H.configure(j),B.add(H),E.push(H)}for(const j of A.nodes){const H=j.type==null?null:LiteGraph.createNode(j.type);H&&(D.set(j.id,H),j.id=-1,H.configure(j),B.add(H),E.push(H))}for(const j of A.reroutes){const{id:H,...U}=j,X=B.setReroute(U);E.push(X),M.set(H,X)}for(const j of M.values()){if(j.parentId==null)continue;const H=M.get(j.parentId);H&&(j.parentId=H.id)}for(const j of A.links){let H=D.get(j.origin_id),U;j.parentId!=null&&(U=(V=M.get(j.parentId))==null?void 0:V.id),T&&LiteGraph.ctrl_shift_v_paste_connect_unselected_outputs&&(H!=null||(H=B.getNodeById(j.origin_id)),U!=null||(U=j.parentId));const X=D.get(j.target_id);if(X){const Y=H==null?void 0:H.connect(j.origin_slot,X,j.target_slot,U);Y&&I.set(j.id,Y)}}for(const j of M.values()){const H=[...j.linkIds].map(U=>{var X,Y;return(Y=(X=I.get(U))==null?void 0:X.id)!=null?Y:U});j.update(j.parentId,void 0,H,j.floating),j.validateLinks(B.links,B.floatingLinks)||B.removeReroute(j.id)}for(const j of E)j.pos[0]+=_[0]-O,j.pos[1]+=_[1]-R;return this.selectItems(E),B.afterChange(),P}pasteFromClipboard(S={}){this.emitBeforeChange();try{this._pasteFromClipboard(S)}finally{this.emitAfterChange()}}processNodeDblClicked(S){var T,_;(T=this.onShowNodePanel)==null||T.call(this,S),(_=this.onNodeDblClicked)==null||_.call(this,S),this.setDirty(!0)}processSelect(S,T,_=!1){var R;const w=T==null?void 0:T.shiftKey,B=T!=null&&(T.metaKey||T.ctrlKey),A=w||B,O=A||this.multi_select;if(!S)(!A||this.multi_select)&&this.deselectAll();else if(!S.selected||!this.selectedItems.has(S))O||this.deselectAll(S),this.select(S);else if(O&&!_)this.deselect(S);else if(!_)this.deselectAll(S);else return;(R=this.onSelectionChange)==null||R.call(this,this.selected_nodes),this.setDirty(!0)}select(S){var T,_;if(!(S.selected&&this.selectedItems.has(S))&&(S.selected=!0,this.selectedItems.add(S),S instanceof LGraphNode)){if((T=S.onSelected)==null||T.call(S),this.selected_nodes[S.id]=S,(_=this.onNodeSelected)==null||_.call(this,S),S.inputs)for(const w of S.inputs)w.link!=null&&(this.highlighted_links[w.link]=!0);if(S.outputs)for(const w of S.outputs.flatMap(B=>B.links))w!=null&&(this.highlighted_links[w]=!0)}}deselect(S){var _,w;if(!S.selected&&!this.selectedItems.has(S)||(S.selected=!1,this.selectedItems.delete(S),!(S instanceof LGraphNode)))return;(_=S.onDeselected)==null||_.call(S),delete this.selected_nodes[S.id],(w=this.onNodeDeselected)==null||w.call(this,S);const{graph:T}=this;if(T){if(S.inputs)for(const B of S.inputs){if(B.link==null)continue;const A=LLink.getOriginNode(T,B.link);A&&this.selectedItems.has(A)||delete this.highlighted_links[B.link]}if(S.outputs)for(const B of S.outputs.flatMap(A=>A.links)){if(B==null)continue;const A=LLink.getTargetNode(T,B);A&&this.selectedItems.has(A)||delete this.highlighted_links[B]}}}processNodeSelected(S,T){this.processSelect(S,T,T&&(T.shiftKey||T.metaKey||T.ctrlKey||this.multi_select))}selectNode(S,T){S==null?this.deselectAll():this.selectNodes([S],T)}get empty(){if(!this.graph)throw new NullGraphError;return this.graph.empty}get positionableItems(){if(!this.graph)throw new NullGraphError;return this.graph.positionableItems()}selectItems(S,T){var w;const _=S!=null?S:this.positionableItems;T||this.deselectAll();for(const B of _)this.select(B);(w=this.onSelectionChange)==null||w.call(this,this.selected_nodes),this.setDirty(!0)}selectNodes(S,T){this.selectItems(S,T)}deselectNode(S){this.deselect(S)}deselectAll(S){var B,A;if(!this.graph)return;const T=this.selectedItems;if(!T.size)return;let _;for(const O of T){if(O===S){_=O;continue}(B=O.onDeselected)==null||B.call(O),O.selected=!1}T.clear(),_&&T.add(_),this.setDirty(!0);const w=(S==null?void 0:S.id)==null?null:this.selected_nodes[S.id];if(this.selected_nodes={},this.current_node=null,this.highlighted_links={},S instanceof LGraphNode){if(w&&(this.selected_nodes[w.id]=w),S.inputs)for(const O of S.inputs)O.link!=null&&(this.highlighted_links[O.link]=!0);if(S.outputs)for(const O of S.outputs.flatMap(R=>R.links))O!=null&&(this.highlighted_links[O]=!0)}(A=this.onSelectionChange)==null||A.call(this,this.selected_nodes)}deselectAllNodes(){this.deselectAll()}deleteSelected(){var T,_;const{graph:S}=this;if(!S)throw new NullGraphError;this.emitBeforeChange(),S.beforeChange();for(const w of this.selectedItems)if(w instanceof LGraphNode){const B=w;if(B.block_delete)continue;B.connectInputToOutput(),S.remove(B),(T=this.onNodeDeselected)==null||T.call(this,B)}else w instanceof LGraphGroup?S.remove(w):w instanceof Reroute&&S.removeReroute(w.id);this.selected_nodes={},this.selectedItems.clear(),this.current_node=null,this.highlighted_links={},(_=this.onSelectionChange)==null||_.call(this,this.selected_nodes),this.setDirty(!0),S.afterChange(),this.emitAfterChange()}deleteSelectedNodes(){this.deleteSelected()}centerOnNode(S){this.ds.offset[0]=-S.pos[0]-S.size[0]*.5+this.canvas.width*.5/(this.ds.scale*1),this.ds.offset[1]=-S.pos[1]-S.size[1]*.5+this.canvas.height*.5/(this.ds.scale*1),this.setDirty(!0,!0)}adjustMouseEvent(S){let T=S.clientX,_=S.clientY;if(this.canvas){const w=this.canvas.getBoundingClientRect();T-=w.left,_-=w.top}S.safeOffsetX=T,S.safeOffsetY=_,S.deltaX===void 0&&(S.deltaX=T-this.last_mouse_position[0]),S.deltaY===void 0&&(S.deltaY=_-this.last_mouse_position[1]),this.last_mouse_position[0]=T,this.last_mouse_position[1]=_,S.canvasX=T/this.ds.scale-this.ds.offset[0],S.canvasY=_/this.ds.scale-this.ds.offset[1]}setZoom(S,T){this.ds.changeScale(S,T),Zt(this,ir,qr).call(this)}convertOffsetToCanvas(S,T){return this.ds.convertOffsetToCanvas(S,T)}convertCanvasToOffset(S,T){return this.ds.convertCanvasToOffset(S,T)}convertEventToCanvasOffset(S){const T=this.canvas.getBoundingClientRect();return this.convertCanvasToOffset([S.clientX-T.left,S.clientY-T.top])}bringToFront(S){const{graph:T}=this;if(!T)throw new NullGraphError;const _=T._nodes.indexOf(S);_!=-1&&(T._nodes.splice(_,1),T._nodes.push(S))}sendToBack(S){const{graph:T}=this;if(!T)throw new NullGraphError;const _=T._nodes.indexOf(S);_!=-1&&(T._nodes.splice(_,1),T._nodes.unshift(S))}computeVisibleNodes(S,T){const _=T||[];if(_.length=0,!this.graph)throw new NullGraphError;const w=S||this.graph._nodes;for(const B of w)B.updateArea(this.ctx),overlapBounding(this.visible_area,B.renderArea)&&_.push(B);return _}isNodeVisible(S){return Ut(this,Oi).has(S.id)}draw(S,T){var w;if(!this.canvas||this.canvas.width==0||this.canvas.height==0)return;const _=LiteGraph.getTime();this.render_time=(_-this.last_draw_time)*.001,this.last_draw_time=_,this.graph&&this.ds.computeVisibleArea(this.viewport),(this.dirty_canvas||S)&&(this.computeVisibleNodes(void 0,this.visible_nodes),_r(this,Oi,new Set(this.visible_nodes.map(B=>B.id)))),(this.dirty_bgcanvas||T||this.always_render_background||(w=this.graph)!=null&&w._last_trigger_time&&_-this.graph._last_trigger_time<1e3)&&this.drawBackCanvas(),(this.dirty_canvas||S)&&this.drawFrontCanvas(),this.fps=this.render_time?1/this.render_time:0,this.frame++}drawFrontCanvas(){var B,A,O,R,P;this.dirty_canvas=!1;const{ctx:S,canvas:T,linkConnector:_}=this;S.start2D&&!this.viewport&&(S.start2D(),S.restore(),S.setTransform(1,0,0,1,0,0));const w=this.viewport||this.dirty_area;if(w&&(S.save(),S.beginPath(),S.rect(w[0],w[1],w[2],w[3]),S.clip()),_r(this,Hr,Ut(this,Mi)||LiteGraph.alwaysSnapToGrid?(B=this.graph)==null?void 0:B.getSnapToGridSize():void 0),this.clear_background&&(w?S.clearRect(w[0],w[1],w[2],w[3]):S.clearRect(0,0,T.width,T.height)),this.bgcanvas==this.canvas?this.drawBackCanvas():S.drawImage(this.bgcanvas,0,0),(A=this.onRender)==null||A.call(this,T,S),this.show_info&&this.renderInfo(S,w?w[0]:0,w?w[1]:0),this.graph){S.save(),this.ds.toCanvasContext(S);const{visible_nodes:E}=this,D=Ut(this,Hr)&&this.isDragging;for(const I of E)S.save(),D&&this.selectedItems.has(I)&&this.drawSnapGuide(S,I),S.translate(I.pos[0],I.pos[1]),this.drawNode(I,S),S.restore();if(this.render_execution_order&&this.drawExecutionOrder(S),this.graph.config.links_ontop&&this.drawConnections(S),_.isConnecting){const{renderLinks:I}=_,M=Zt(this,ir,la).call(this);S.lineWidth=this.connections_width;for(const N of I){const{fromSlot:k,fromPos:F,fromDirection:G,dragDirection:V}=N,j=k.shape,H=k.type,U=H===LiteGraph.EVENT?LiteGraph.EVENT_LINK_COLOR:LiteGraph.CONNECTING_LINK_COLOR;this.renderLink(S,F,M,null,!1,null,U,G,V),S.beginPath(),H===LiteGraph.EVENT||j===RenderShape.BOX?(S.rect(F[0]-6+.5,F[1]-5+.5,14,10),S.fill(),S.beginPath(),S.rect(this.graph_mouse[0]-6+.5,this.graph_mouse[1]-5+.5,14,10)):j===RenderShape.ARROW?(S.moveTo(F[0]+8,F[1]+.5),S.lineTo(F[0]-4,F[1]+6+.5),S.lineTo(F[0]-4,F[1]-6+.5),S.closePath()):(S.arc(F[0],F[1],4,0,Math.PI*2),S.fill(),S.beginPath(),S.arc(this.graph_mouse[0],this.graph_mouse[1],4,0,Math.PI*2)),S.fill()}Zt(this,ir,ca).call(this,S,M)}if(this.dragging_rectangle){const{eDown:I,eMove:M}=this.pointer;if(S.strokeStyle="#FFF",I&&M){const N=S.getTransform(),k=1;S.setTransform(k,0,0,k,0,0);const F=I.safeOffsetX,G=I.safeOffsetY;S.strokeRect(F,G,M.safeOffsetX-F,M.safeOffsetY-G),S.setTransform(N)}else{const[N,k,F,G]=this.dragging_rectangle;S.strokeRect(N,k,F,G)}}!this.isDragging&&this.over_link_center&&this.render_link_tooltip?this.drawLinkTooltip(S,this.over_link_center):(O=this.onDrawLinkTooltip)==null||O.call(this,S,null),(R=this.onDrawForeground)==null||R.call(this,S,this.visible_area),S.restore()}this._graph_stack&&this._graph_stack.length&&this.drawSubgraphPanel(S),(P=this.onDrawOverlay)==null||P.call(this,S),w&&S.restore()}drawSubgraphPanel(S){var T=this.graph,_=T._subgraph_node;if(!_){console.warn("subgraph without subnode");return}this.drawSubgraphPanelLeft(T,_,S),this.drawSubgraphPanelRight(T,_,S)}drawSubgraphPanelLeft(S,T,_){var w=T.inputs?T.inputs.length:0,B=200,A=Math.floor(LiteGraph.NODE_SLOT_HEIGHT*1.6);if(_.fillStyle="#111",_.globalAlpha=.8,_.beginPath(),_.roundRect(10,10,B,(w+1)*A+50,[8]),_.fill(),_.globalAlpha=1,_.fillStyle="#888",_.font="14px Arial",_.textAlign="left",_.fillText("Graph Inputs",20,34),this.drawButton(B-20,20,20,20,"X","#151515")){this.closeSubgraph();return}var O=50;if(_.font="14px Arial",T.inputs)for(var R=0;R<T.inputs.length;++R){var P=T.inputs[R];if(!P.not_subgraph_input){if(this.drawButton(20,O+2,B-20,A-2)){var E=T.constructor.input_node_type||"middle/graph/input";this.graph.beforeChange();var D=LiteGraph.createNode(E);D?(S.add(D),this.block_click=!1,this.last_click_position=null,this.selectNodes([D]),this.node_dragged=D,this.dragging_canvas=!1,D.setProperty("name",P.name),D.setProperty("type",P.type),this.node_dragged.pos[0]=this.graph_mouse[0]-5,this.node_dragged.pos[1]=this.graph_mouse[1]-5,this.graph.afterChange()):console.error("graph input node not found:",E)}_.fillStyle="#9C9",_.beginPath(),_.arc(B-16,O+A*.5,5,0,2*Math.PI),_.fill(),_.fillStyle="#AAA",_.fillText(P.name,30,O+A*.75),_.fillStyle="#777",_.fillText(P.type,130,O+A*.75),O+=A}}this.drawButton(20,O+2,B-20,A-2,"+","#151515","#222")&&this.showSubgraphPropertiesDialog(T)}drawSubgraphPanelRight(S,T,_){var w=T.outputs?T.outputs.length:0,B=this.bgcanvas.width,A=200,O=Math.floor(LiteGraph.NODE_SLOT_HEIGHT*1.6);_.fillStyle="#111",_.globalAlpha=.8,_.beginPath(),_.roundRect(B-A-10,10,A,(w+1)*O+50,[8]),_.fill(),_.globalAlpha=1,_.fillStyle="#888",_.font="14px Arial",_.textAlign="left";var R="Graph Outputs",P=_.measureText(R).width;if(_.fillText(R,B-P-20,34),this.drawButton(B-A,20,20,20,"X","#151515")){this.closeSubgraph();return}var E=50;if(_.font="14px Arial",T.outputs)for(var D=0;D<T.outputs.length;++D){var I=T.outputs[D];if(!I.not_subgraph_input){if(this.drawButton(B-A,E+2,A-20,O-2)){var M=T.constructor.output_node_type||"middle/graph/output";this.graph.beforeChange();var N=LiteGraph.createNode(M);N?(S.add(N),this.block_click=!1,this.last_click_position=null,this.selectNodes([N]),this.node_dragged=N,this.dragging_canvas=!1,N.setProperty("name",I.name),N.setProperty("type",I.type),this.node_dragged.pos[0]=this.graph_mouse[0]-5,this.node_dragged.pos[1]=this.graph_mouse[1]-5,this.graph.afterChange()):console.error("graph input node not found:",M)}_.fillStyle="#9C9",_.beginPath(),_.arc(B-A+16,E+O*.5,5,0,2*Math.PI),_.fill(),_.fillStyle="#AAA",_.fillText(I.name,B-A+30,E+O*.75),_.fillStyle="#777",_.fillText(I.type,B-A+130,E+O*.75),E+=O}}this.drawButton(B-A,E+2,A-20,O-2,"+","#151515","#222")&&this.showSubgraphPropertiesDialogRight(T)}drawButton(S,T,_,w,B,A,O,R){var P=this.ctx;A=A||LiteGraph.NODE_DEFAULT_COLOR,O=O||"#555",R=R||LiteGraph.NODE_TEXT_COLOR;var E=this.ds.convertOffsetToCanvas(this.graph_mouse),D=LiteGraph.isInsideRectangle(E[0],E[1],S,T,_,w);if(E=this.last_click_position?[this.last_click_position[0],this.last_click_position[1]]:null,E){var I=this.canvas.getBoundingClientRect();E[0]-=I.left,E[1]-=I.top}var M=E&&LiteGraph.isInsideRectangle(E[0],E[1],S,T,_,w);P.fillStyle=D?O:A,M&&(P.fillStyle="#AAA"),P.beginPath(),P.roundRect(S,T,_,w,[4]),P.fill(),B!=null&&B.constructor==String&&(P.fillStyle=R,P.textAlign="center",P.font=(w*.65|0)+"px Arial",P.fillText(B,S+_*.5,T+w*.75),P.textAlign="left");var N=M&&!this.block_click;return M&&this.blockClick(),N}isAreaClicked(S,T,_,w,B){var A=this.mouse;LiteGraph.isInsideRectangle(A[0],A[1],S,T,_,w),A=this.last_click_position;var O=A&&LiteGraph.isInsideRectangle(A[0],A[1],S,T,_,w),R=O&&!this.block_click;return O&&B&&this.blockClick(),R}renderInfo(S,T,_){T=T||10,_=_||this.canvas.offsetHeight-80,S.save(),S.translate(T,_),S.font="10px Arial",S.fillStyle="#888",S.textAlign="left",this.graph?(S.fillText("T: ".concat(this.graph.globaltime.toFixed(2),"s"),5,13*1),S.fillText("I: ".concat(this.graph.iteration),5,13*2),S.fillText("N: ".concat(this.graph._nodes.length," [").concat(this.visible_nodes.length,"]"),5,13*3),S.fillText("V: ".concat(this.graph._version),5,13*4),S.fillText("FPS:".concat(this.fps.toFixed(2)),5,13*5)):S.fillText("No graph selected",5,13*1),S.restore()}drawBackCanvas(){var R,P;const S=this.bgcanvas;(S.width!=this.canvas.width||S.height!=this.canvas.height)&&(S.width=this.canvas.width,S.height=this.canvas.height),this.bgctx||(this.bgctx=this.bgcanvas.getContext("2d"));const T=this.bgctx;if(!T)throw new TypeError("Background canvas context was null.");const _=this.viewport||[0,0,T.canvas.width,T.canvas.height];if(this.clear_background&&T.clearRect(_[0],_[1],_[2],_[3]),this._graph_stack&&this._graph_stack.length){T.save(),this._graph_stack[this._graph_stack.length-1];var w=this.graph._subgraph_node;T.strokeStyle=w.bgcolor,T.lineWidth=10,T.strokeRect(1,1,S.width-2,S.height-2),T.lineWidth=1,T.font="40px Arial",T.textAlign="center",T.fillStyle=w.bgcolor||"#AAA";for(var B="",A=1;A<this._graph_stack.length;++A)B+=this._graph_stack[A]._subgraph_node.getTitle()+" >> ";T.fillText(B+w.getTitle(),S.width*.5,40),T.restore()}const O=this.onRenderBackground?this.onRenderBackground(S,T):!1;if(this.viewport||(T.restore(),T.setTransform(1,0,0,1,0,0)),this.graph){if(T.save(),this.ds.toCanvasContext(T),this.ds.scale<1.5&&!O&&this.clear_background_color&&(T.fillStyle=this.clear_background_color,T.fillRect(this.visible_area[0],this.visible_area[1],this.visible_area[2],this.visible_area[3])),this.background_image&&this.ds.scale>.5&&!O){if(this.zoom_modify_alpha?T.globalAlpha=(1-.5/this.ds.scale)*this.editor_alpha:T.globalAlpha=this.editor_alpha,T.imageSmoothingEnabled=!1,!this._bg_img||this._bg_img.name!=this.background_image){this._bg_img=new Image,this._bg_img.name=this.background_image,this._bg_img.src=this.background_image;const D=this;this._bg_img.addEventListener("load",function(){D.draw(!0,!0)})}let E=this._pattern;E==null&&this._bg_img.width>0&&(E=(R=T.createPattern(this._bg_img,"repeat"))!=null?R:void 0,this._pattern_img=this._bg_img,this._pattern=E),E&&(T.fillStyle=E,T.fillRect(this.visible_area[0],this.visible_area[1],this.visible_area[2],this.visible_area[3]),T.fillStyle="transparent"),T.globalAlpha=1,T.imageSmoothingEnabled=!0}this.graph._groups.length&&this.drawGroups(S,T),(P=this.onDrawBackground)==null||P.call(this,T,this.visible_area),this.render_canvas_border&&(T.strokeStyle="#235",T.strokeRect(0,0,S.width,S.height)),this.render_connections_shadows?(T.shadowColor="#000",T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowBlur=6):T.shadowColor="rgba(0,0,0,0)",this.drawConnections(T),T.shadowColor="rgba(0,0,0,0)",T.restore()}this.dirty_bgcanvas=!1,this.dirty_canvas=!0}drawNode(S,T){var P,E,D;this.current_node=S;const _=S.renderingColor,w=S.renderingBgColor,{low_quality:B,editor_alpha:A}=this;if(T.globalAlpha=A,this.render_shadows&&!B?(T.shadowColor=LiteGraph.DEFAULT_SHADOW_COLOR,T.shadowOffsetX=2*this.ds.scale,T.shadowOffsetY=2*this.ds.scale,T.shadowBlur=3*this.ds.scale):T.shadowColor="transparent",S.flags.collapsed&&((P=S.onDrawCollapsed)==null?void 0:P.call(S,T,this))==!0)return;const O=S._shape||RenderShape.BOX,R=Ut(Vt,an);R.set(S.renderingSize),S.collapsed&&(T.font=this.inner_text_font),S.clip_area&&(T.save(),T.beginPath(),O==RenderShape.BOX?T.rect(0,0,R[0],R[1]):O==RenderShape.ROUND?T.roundRect(0,0,R[0],R[1],[10]):O==RenderShape.CIRCLE&&T.arc(R[0]*.5,R[1]*.5,R[0]*.5,0,Math.PI*2),T.clip()),this.drawNodeShape(S,T,R,_,w,!!S.selected),B||S.drawBadges(T),T.shadowColor="transparent",T.strokeStyle=LiteGraph.NODE_BOX_OUTLINE_COLOR,(E=S.onDrawForeground)==null||E.call(S,T,this,this.canvas),T.font=this.inner_text_font,S.collapsed?this.render_collapsed_slots&&S.drawCollapsedSlots(T):(S.arrange(),S.drawSlots(T,{fromSlot:(D=this.linkConnector.renderLinks[0])==null?void 0:D.fromSlot,colorContext:this,editorAlpha:this.editor_alpha,lowQuality:this.low_quality}),T.textAlign="left",T.globalAlpha=1,this.drawNodeWidgets(S,null,T)),S.clip_area&&T.restore(),T.globalAlpha=1}drawLinkTooltip(S,T){var P;const _=T._pos;if(S.fillStyle="black",S.beginPath(),this.linkMarkerShape===LinkMarkerShape.Arrow){const E=S.getTransform();S.translate(_[0],_[1]),Number.isFinite(T._centreAngle)&&S.rotate(T._centreAngle),S.moveTo(-2,-3),S.lineTo(4,0),S.lineTo(-2,3),S.setTransform(E)}else(this.linkMarkerShape==null||this.linkMarkerShape===LinkMarkerShape.Circle)&&S.arc(_[0],_[1],3,0,Math.PI*2);S.fill();const{data:w}=T;if(w==null||((P=this.onDrawLinkTooltip)==null?void 0:P.call(this,S,T,this))==!0)return;let B=null;if(typeof w=="number"?B=w.toFixed(2):typeof w=="string"?B='"'.concat(w,'"'):typeof w=="boolean"?B=String(w):w.toToolTip?B=w.toToolTip():B="[".concat(w.constructor.name,"]"),B==null)return;B=B.substring(0,30),S.font="14px Courier New";const O=S.measureText(B).width+20,R=24;S.shadowColor="black",S.shadowOffsetX=2,S.shadowOffsetY=2,S.shadowBlur=3,S.fillStyle="#454",S.beginPath(),S.roundRect(_[0]-O*.5,_[1]-15-R,O,R,[3]),S.moveTo(_[0]-10,_[1]-15),S.lineTo(_[0]+10,_[1]-15),S.lineTo(_[0],_[1]-5),S.fill(),S.shadowColor="transparent",S.textAlign="center",S.fillStyle="#CEC",S.fillText(B,_[0],_[1]-15-R*.3)}drawNodeShape(S,T,_,w,B,A){var k;T.strokeStyle=w,T.fillStyle=B;const O=LiteGraph.NODE_TITLE_HEIGHT,{low_quality:R}=this,{collapsed:P}=S.flags,E=S.renderingShape,{title_mode:D}=S,I=!(D==TitleMode.TRANSPARENT_TITLE||D==TitleMode.NO_TITLE),M=Ut(Vt,on);M.set(S.boundingRect),M[0]-=S.pos[0],M[1]-=S.pos[1];const N=T.globalAlpha;T.beginPath(),E==RenderShape.BOX||R?T.fillRect(M[0],M[1],M[2],M[3]):E==RenderShape.ROUND||E==RenderShape.CARD?T.roundRect(M[0],M[1],M[2],M[3],E==RenderShape.CARD?[LiteGraph.ROUND_RADIUS,LiteGraph.ROUND_RADIUS,0,0]:[LiteGraph.ROUND_RADIUS]):E==RenderShape.CIRCLE&&T.arc(_[0]*.5,_[1]*.5,_[0]*.5,0,Math.PI*2),T.fill(),!P&&I&&(T.shadowColor="transparent",T.fillStyle="rgba(0,0,0,0.2)",T.fillRect(0,-1,M[2],2)),T.shadowColor="transparent",S.onDrawBackground&&S.onDrawBackground(T,this,this.canvas,this.graph_mouse),(I||D==TitleMode.TRANSPARENT_TITLE)&&(S.drawTitleBarBackground(T,{scale:this.ds.scale,low_quality:R}),S.drawTitleBox(T,{scale:this.ds.scale,low_quality:R,box_size:10}),T.globalAlpha=N,S.drawTitleText(T,{scale:this.ds.scale,default_title_color:this.node_title_color,low_quality:R}),(k=S.onDrawTitle)==null||k.call(S,T,this.graph_mouse));for(const F of Object.values(S.strokeStyles)){const G=F.call(S);G&&strokeShape(T,M,{shape:E,title_height:O,title_mode:D,collapsed:P,...G})}S.drawProgressBar(T),S.execute_triggered!=null&&S.execute_triggered>0&&S.execute_triggered--,S.action_triggered!=null&&S.action_triggered>0&&S.action_triggered--}drawSnapGuide(S,T,_=RenderShape.ROUND){const w=Ut(Vt,sn);w.set(T.boundingRect);const{pos:B}=T,A=B[0]-w[0],O=B[1]-w[1];w[0]+=A,w[1]+=O,Ut(this,Hr)&&snapPoint(w,Ut(this,Hr)),w[0]-=A,w[1]-=O;const{globalAlpha:R}=S;S.globalAlpha=1,S.beginPath();const[P,E,D,I]=w;if(_===RenderShape.CIRCLE){const M=P+D*.5,N=E+I*.5,k=Math.min(D*.5,I*.5);S.arc(M,N,k,0,Math.PI*2)}else S.rect(P,E,D,I);S.lineWidth=.5,S.strokeStyle="#FFFFFF66",S.fillStyle="#FFFFFF22",S.fill(),S.stroke(),S.globalAlpha=R}drawConnections(S){if(this.renderedPaths.clear(),this.links_render_mode===LinkRenderType.HIDDEN_LINK)return;const{graph:T}=this;if(!T)throw new NullGraphError;const _=[],w=LiteGraph.getTime(),{visible_area:B}=this;Ut(Vt,ai)[0]=B[0]-20,Ut(Vt,ai)[1]=B[1]-20,Ut(Vt,ai)[2]=B[2]+40,Ut(Vt,ai)[3]=B[3]+40,S.lineWidth=this.connections_width,S.fillStyle="#AAA",S.strokeStyle="#AAA",S.globalAlpha=this.editor_alpha;const A=T._nodes;for(const O of A){const{inputs:R}=O;if(R!=null&&R.length)for(const[P,E]of R.entries()){if(!E||E.link==null)continue;const D=E.link,I=T._links.get(D);if(!I)continue;const M=O.getInputPos(P),N=T.getNodeById(I.origin_id);if(N==null)continue;const k=I.origin_slot,F=k===-1?[N.pos[0]+10,N.pos[1]+10]:N.getOutputPos(k),G=N.outputs[k];G&&Zt(this,ir,nn).call(this,S,I,F,M,_,w,G.dir,E.dir)}}T.floatingLinks.size>0&&Zt(this,ir,ua).call(this,S,T,_,w),_.sort((O,R)=>O.linkIds.size-R.linkIds.size);for(const O of _)Ut(this,Hr)&&this.isDragging&&this.selectedItems.has(O)&&this.drawSnapGuide(S,O,RenderShape.CIRCLE),O.draw(S,this._pattern);S.globalAlpha=1}renderLink(S,T,_,w,B,A,O,R,P,{startControl:E,endControl:D,reroute:I,num_sublines:M=1,disabled:N=!1}={}){var z,W;const k=w!=null&&this.highlighted_links[w.id]?"#FFF":O||(w==null?void 0:w.color)||(w==null?void 0:w.type)!=null&&Vt.link_type_colors[w.type]||this.default_link_color,F=R||LinkDirection.RIGHT,G=P||LinkDirection.LEFT,V=this.links_render_mode==LinkRenderType.SPLINE_LINK&&(!D||!E)?distance(T,_):0;this.render_connections_border&&!this.low_quality&&(S.lineWidth=this.connections_width+4),S.lineJoin="round",M||(M=1),M>1&&(S.lineWidth=.5);const j=new Path2D,H=I!=null?I:w;H&&(H.path=j);const U=Ut(Vt,ln),X=Ut(Vt,cn),Y=(z=H==null?void 0:H._pos)!=null?z:[0,0];for(let Z=0;Z<M;Z++){const Q=(Z-(M-1)*.5)*5;if(U[0]=T[0],U[1]=T[1],X[0]=_[0],X[1]=_[1],this.links_render_mode==LinkRenderType.SPLINE_LINK){if(D?(X[0]=_[0]+D[0],X[1]=_[1]+D[1]):Zt(this,ir,ki).call(this,X,G,V),E?(U[0]=T[0]+E[0],U[1]=T[1]+E[1]):Zt(this,ir,ki).call(this,U,F,V),j.moveTo(T[0],T[1]+Q),j.bezierCurveTo(U[0],U[1]+Q,X[0],X[1]+Q,_[0],_[1]+Q),findPointOnCurve(Y,T,_,U,X,.5),H&&this.linkMarkerShape===LinkMarkerShape.Arrow){const ee=Ut(Vt,un);findPointOnCurve(ee,T,_,U,X,.51),H._centreAngle=Math.atan2(ee[1]-Y[1],ee[0]-Y[0])}}else{const ee=this.links_render_mode==LinkRenderType.LINEAR_LINK?15:10;switch(F){case LinkDirection.LEFT:U[0]+=-ee;break;case LinkDirection.RIGHT:U[0]+=ee;break;case LinkDirection.UP:U[1]+=-ee;break;case LinkDirection.DOWN:U[1]+=ee;break}switch(G){case LinkDirection.LEFT:X[0]+=-ee;break;case LinkDirection.RIGHT:X[0]+=ee;break;case LinkDirection.UP:X[1]+=-ee;break;case LinkDirection.DOWN:X[1]+=ee;break}if(this.links_render_mode==LinkRenderType.LINEAR_LINK)j.moveTo(T[0],T[1]+Q),j.lineTo(U[0],U[1]+Q),j.lineTo(X[0],X[1]+Q),j.lineTo(_[0],_[1]+Q),Y[0]=(U[0]+X[0])*.5,Y[1]=(U[1]+X[1])*.5,H&&this.linkMarkerShape===LinkMarkerShape.Arrow&&(H._centreAngle=Math.atan2(X[1]-U[1],X[0]-U[0]));else if(this.links_render_mode==LinkRenderType.STRAIGHT_LINK){const te=(U[0]+X[0])*.5;if(j.moveTo(T[0],T[1]),j.lineTo(U[0],U[1]),j.lineTo(te,U[1]),j.lineTo(te,X[1]),j.lineTo(X[0],X[1]),j.lineTo(_[0],_[1]),Y[0]=te,Y[1]=(U[1]+X[1])*.5,H&&this.linkMarkerShape===LinkMarkerShape.Arrow){const re=X[1]-U[1];Math.abs(re)<4?H._centreAngle=0:re>0?H._centreAngle=Math.PI*.5:H._centreAngle=-(Math.PI*.5)}}else return}}if(this.render_connections_border&&!this.low_quality&&!B&&(S.strokeStyle="rgba(0,0,0,0.5)",S.stroke(j)),S.lineWidth=this.connections_width,S.fillStyle=S.strokeStyle=k,S.stroke(j),this.ds.scale>=.6&&this.highquality_render&&H){if(this.render_connection_arrows){const Z=this.computeConnectionPoint(T,_,.25,F,G),Q=this.computeConnectionPoint(T,_,.26,F,G),ee=this.computeConnectionPoint(T,_,.75,F,G),te=this.computeConnectionPoint(T,_,.76,F,G);let re=0,ie=0;this.render_curved_connections?(re=-Math.atan2(Q[0]-Z[0],Q[1]-Z[1]),ie=-Math.atan2(te[0]-ee[0],te[1]-ee[1])):ie=re=_[1]>T[1]?0:Math.PI;const ne=S.getTransform();S.translate(Z[0],Z[1]),S.rotate(re),S.beginPath(),S.moveTo(-5,-3),S.lineTo(0,7),S.lineTo(5,-3),S.fill(),S.setTransform(ne),S.translate(ee[0],ee[1]),S.rotate(ie),S.beginPath(),S.moveTo(-5,-3),S.lineTo(0,7),S.lineTo(5,-3),S.fill(),S.setTransform(ne)}if(S.beginPath(),this.linkMarkerShape===LinkMarkerShape.Arrow){const Z=S.getTransform();S.translate(Y[0],Y[1]),H._centreAngle&&S.rotate(H._centreAngle),S.moveTo(-3.2,-5),S.lineTo(7,0),S.lineTo(-3.2,5),S.setTransform(Z)}else(this.linkMarkerShape==null||this.linkMarkerShape===LinkMarkerShape.Circle)&&S.arc(Y[0],Y[1],5,0,Math.PI*2);if(N){const{fillStyle:Z,globalAlpha:Q}=S;S.fillStyle=(W=this._pattern)!=null?W:"#797979",S.globalAlpha=.75,S.fill(),S.globalAlpha=Q,S.fillStyle=Z}S.fill()}if(A){S.fillStyle=k;for(let Z=0;Z<5;++Z){const Q=(LiteGraph.getTime()*.001+Z*.2)%1,ee=this.computeConnectionPoint(T,_,Q,F,G);S.beginPath(),S.arc(ee[0],ee[1],5,0,2*Math.PI),S.fill()}}}computeConnectionPoint(S,T,_,w,B){w||(w=LinkDirection.RIGHT),B||(B=LinkDirection.LEFT);const A=distance(S,T),O=[S[0],S[1]],R=[T[0],T[1]];Zt(this,ir,ki).call(this,O,w,A),Zt(this,ir,ki).call(this,R,B,A);const P=(1-_)*(1-_)*(1-_),E=3*((1-_)*(1-_))*_,D=3*(1-_)*(_*_),I=_*_*_,M=P*S[0]+E*O[0]+D*R[0]+I*T[0],N=P*S[1]+E*O[1]+D*R[1]+I*T[1];return[M,N]}drawExecutionOrder(S){S.shadowColor="transparent",S.globalAlpha=.25,S.textAlign="center",S.strokeStyle="white",S.globalAlpha=.75;const{visible_nodes:T}=this;for(const _ of T)S.fillStyle="black",S.fillRect(_.pos[0]-LiteGraph.NODE_TITLE_HEIGHT,_.pos[1]-LiteGraph.NODE_TITLE_HEIGHT,LiteGraph.NODE_TITLE_HEIGHT,LiteGraph.NODE_TITLE_HEIGHT),_.order==0&&S.strokeRect(_.pos[0]-LiteGraph.NODE_TITLE_HEIGHT+.5,_.pos[1]-LiteGraph.NODE_TITLE_HEIGHT+.5,LiteGraph.NODE_TITLE_HEIGHT,LiteGraph.NODE_TITLE_HEIGHT),S.fillStyle="#FFF",S.fillText(stringOrEmpty(_.order),_.pos[0]+LiteGraph.NODE_TITLE_HEIGHT*-.5,_.pos[1]-6);S.globalAlpha=1}drawNodeWidgets(S,T,_){S.drawWidgets(_,{lowQuality:this.low_quality,editorAlpha:this.editor_alpha})}drawGroups(S,T){if(!this.graph)return;const _=this.graph._groups;T.save(),T.globalAlpha=.5*this.editor_alpha;const w=Ut(this,Hr)&&this.isDragging;for(const B of _)overlapBounding(this.visible_area,B._bounding)&&(w&&this.selectedItems.has(B)&&this.drawSnapGuide(T,B),B.draw(this,T));T.restore()}resize(S,T){if(!S&&!T){const _=this.canvas.parentElement;if(!_)throw new TypeError("Attempted to resize canvas, but parent element was null.");S=_.offsetWidth,T=_.offsetHeight}this.canvas.width==S&&this.canvas.height==T||(this.canvas.width=S!=null?S:0,this.canvas.height=T!=null?T:0,this.bgcanvas.width=this.canvas.width,this.bgcanvas.height=this.canvas.height,this.setDirty(!0,!0))}onNodeSelectionChange(){}boundaryNodesForSelection(){return Vt.getBoundaryNodes(this.selected_nodes)}showLinkMenu(S,T){var I,M;const{graph:_}=this;if(!_)throw new NullGraphError;const w="data"in S&&S.data!=null?S.data.constructor.name:void 0,{origin_id:B,origin_slot:A}=S;if(B==null||A==null)return new LiteGraph.ContextMenu(["Link has no origin"],{event:T,title:w}),!1;const O=_.getNodeById(B),R=(M=(I=O==null?void 0:O.outputs)==null?void 0:I[A])==null?void 0:M.type,P=["Add Node","Add Reroute",null,"Delete",null],E=new LiteGraph.ContextMenu(P,{event:T,title:w,callback:D.bind(this)});return!1;function D(N,k,F){if(!_)throw new NullGraphError;switch(N){case"Add Node":console.log("LGraphCanvas.onMenuAdd",E),Vt.onMenuAdd(null,null,F,E,G=>{var j,H;if(!((j=G==null?void 0:G.inputs)!=null&&j.length)||!((H=G==null?void 0:G.outputs)!=null&&H.length)||A==null)return;const V={afterRerouteId:S.parentId};O!=null&&O.connectByType(A,G,R!=null?R:"*",V)&&(G.pos[0]-=G.size[0]*.5)});break;case"Add Reroute":{try{this.emitBeforeChange(),this.adjustMouseEvent(F),_.createReroute(S._pos,S),this.setDirty(!1,!0)}catch(G){console.error(G)}finally{this.emitAfterChange()}break}case"Delete":_.removeLink(S.id);break}}}createDefaultNodeForSlot(S){const T=Object.assign({nodeFrom:null,slotFrom:null,nodeTo:null,slotTo:null,position:[0,0],nodeType:void 0,posAdd:[0,0],posSizeFix:[0,0]},S),{afterRerouteId:_}=T,w=T.nodeFrom&&T.slotFrom!==null,B=!w&&T.nodeTo&&T.slotTo!==null;if(!w&&!B)return console.warn("No data passed to createDefaultNodeForSlot",T.nodeFrom,T.slotFrom,T.nodeTo,T.slotTo),!1;if(!T.nodeType)return console.warn("No type to createDefaultNodeForSlot"),!1;const A=w?T.nodeFrom:T.nodeTo;if(!A)throw new TypeError("nodeX was null when creating default node for slot.");let O=w?T.slotFrom:T.slotTo,R=!1;switch(typeof O){case"string":R=w?A.findOutputSlot(O,!1):A.findInputSlot(O,!1),O=w?A.outputs[O]:A.inputs[O];break;case"object":if(O===null)return console.warn("Cant get slot information",O),!1;R=w?A.findOutputSlot(O.name):A.findInputSlot(O.name);break;case"number":R=O,O=w?A.outputs[O]:A.inputs[O];break;case"undefined":default:return console.warn("Cant get slot information",O),!1}const P=O.type==LiteGraph.EVENT?"_event_":O.type,E=w?LiteGraph.slot_types_default_out:LiteGraph.slot_types_default_in;if(E!=null&&E[P]){let D=!1;if(typeof E[P]=="object"){for(const I in E[P])if(T.nodeType==E[P][I]||T.nodeType=="AUTO"){D=E[P][I];break}}else(T.nodeType==E[P]||T.nodeType=="AUTO")&&(D=E[P]);if(D){let I=!1;typeof D=="object"&&D.node&&(I=D,D=D.node);const M=LiteGraph.createNode(D);if(M){if(I){if(I.properties)for(const N in I.properties)M.addProperty(N,I.properties[N]);if(I.inputs){M.inputs=[];for(const N in I.inputs)M.addOutput(I.inputs[N][0],I.inputs[N][1])}if(I.outputs){M.outputs=[];for(const N in I.outputs)M.addOutput(I.outputs[N][0],I.outputs[N][1])}I.title&&(M.title=I.title),I.json&&M.configure(I.json)}if(!this.graph)throw new NullGraphError;if(this.graph.add(M),M.pos=[T.position[0]+T.posAdd[0]+(T.posSizeFix[0]?T.posSizeFix[0]*M.size[0]:0),T.position[1]+T.posAdd[1]+(T.posSizeFix[1]?T.posSizeFix[1]*M.size[1]:0)],w){if(!T.nodeFrom)throw new TypeError("createDefaultNodeForSlot - nodeFrom was null");T.nodeFrom.connectByType(R,M,P,{afterRerouteId:_})}else{if(!T.nodeTo)throw new TypeError("createDefaultNodeForSlot - nodeTo was null");T.nodeTo.connectByTypeOutput(R,M,P,{afterRerouteId:_})}return!0}console.log("failed creating ".concat(D))}}return!1}showConnectionMenu(S){const T=Object.assign({nodeFrom:null,slotFrom:null,nodeTo:null,slotTo:null,e:void 0,allow_searchbox:this.allow_searchbox,showSearchBox:this.showSearchBox},S||{}),_=this,{graph:w}=this,{afterRerouteId:B}=T,A=T.nodeFrom&&T.slotFrom,O=!A&&T.nodeTo&&T.slotTo;if(!A&&!O){console.warn("No data passed to showConnectionMenu");return}const R=A?T.nodeFrom:T.nodeTo;if(!R)throw new TypeError("nodeX was null when creating default node for slot.");let P=A?T.slotFrom:T.slotTo,E;switch(typeof P){case"string":E=A?R.findOutputSlot(P,!1):R.findInputSlot(P,!1),P=A?R.outputs[P]:R.inputs[P];break;case"object":if(P===null){console.warn("Cant get slot information",P);return}E=A?R.findOutputSlot(P.name):R.findInputSlot(P.name);break;case"number":E=P,P=A?R.outputs[P]:R.inputs[P];break;default:console.warn("Cant get slot information",P);return}const D=["Add Node","Add Reroute",null];T.allow_searchbox&&D.push("Search",null);const I=P.type==LiteGraph.EVENT?"_event_":P.type,M=A?LiteGraph.slot_types_default_out:LiteGraph.slot_types_default_in;if(M!=null&&M[I])if(typeof M[I]=="object")for(const G in M[I])D.push(M[I][G]);else D.push(M[I]);const N=new LiteGraph.ContextMenu(D,{event:T.e,extra:P,title:(P&&P.name!=""?P.name+(I?" | ":""):"")+(P&&I?I:""),callback:F}),k=()=>Zt(this,ir,qr).call(this);function F(G,V,j){var H,U,X,Y;switch(G){case"Add Node":console.log("LGraphCanvas.onMenuAdd",N),Vt.onMenuAdd(null,null,j,N,function(z){var W,Z;z&&(console.log("显示菜单项目node",z),A?(W=T.nodeFrom)==null||W.connectByType(E,z,I,{afterRerouteId:B}):(Z=T.nodeTo)==null||Z.connectByTypeOutput(E,z,I,{afterRerouteId:B}))});break;case"Add Reroute":{const z=A?T.nodeFrom:T.nodeTo,W=V.extra;if(!w)throw new NullGraphError;if(!z)throw new TypeError("Cannot add reroute: node was null");if(!W)throw new TypeError("Cannot add reroute: slot was null");if(!T.e)throw new TypeError("Cannot add reroute: CanvasPointerEvent was null");if(!z.connectFloatingReroute([T.e.canvasX,T.e.canvasY],W,B))throw new Error("Failed to create reroute");k();break}case"Search":A?T.showSearchBox(j,{node_from:T.nodeFrom,slot_from:P,type_filter_in:I}):T.showSearchBox(j,{node_to:T.nodeTo,slot_from:P,type_filter_out:I});break;default:{const z={position:[(U=(H=T.e)==null?void 0:H.canvasX)!=null?U:0,(Y=(X=T.e)==null?void 0:X.canvasY)!=null?Y:0],nodeType:G,afterRerouteId:B},W=Object.assign(T,z);_.createDefaultNodeForSlot(W);break}}}}prompt(S,T,_,w,B){var X;const A=this;S=S||"";const O={is_modified:!1,className:"graphdialog rounded",innerHTML:B?"<span class='name'></span> <textarea autofocus class='value'></textarea><button class='rounded'>OK</button>":"<span class='name'></span> <input autofocus type='text' class='value'/><button class='rounded'>OK</button>",close(){A.prompt_box=null,P.parentNode&&P.remove()}},R=document.createElement("div"),P=Object.assign(R,O),E=Vt.active_canvas,{canvas:D}=E;if(!D.parentNode)throw new TypeError("canvas element parentNode was null when opening a prompt.");D.parentNode.append(P),this.ds.scale>1&&(P.style.transform="scale(".concat(this.ds.scale,")"));let I,M=0;LiteGraph.pointerListenerAdd(P,"leave",function(){M||LiteGraph.dialog_close_on_mouse_leave&&!P.is_modified&&LiteGraph.dialog_close_on_mouse_leave&&(I=setTimeout(P.close,LiteGraph.dialog_close_on_mouse_leave_delay))}),LiteGraph.pointerListenerAdd(P,"enter",function(){LiteGraph.dialog_close_on_mouse_leave&&I&&clearTimeout(I)});const N=P.querySelectorAll("select");if(N)for(const Y of N)Y.addEventListener("click",function(){M++}),Y.addEventListener("blur",function(){M=0}),Y.addEventListener("change",function(){M=-1});(X=this.prompt_box)==null||X.close(),this.prompt_box=P;const k=P.querySelector(".name");if(!k)throw new TypeError("name_element was null");k.textContent=S;const F=P.querySelector(".value");if(!F)throw new TypeError("value_element was null");F.value=T,F.select();const G=F;G.addEventListener("keydown",function(Y){if(P.is_modified=!0,Y.key=="Escape")P.close();else if(Y.key=="Enter"&&Y.target.localName!="textarea")_&&_(this.value),P.close();else return;Y.preventDefault(),Y.stopPropagation()});const V=P.querySelector("button");if(!V)throw new TypeError("button was null when opening prompt");V.addEventListener("click",function(){_==null||_(G.value),A.setDirty(!0),P.close()});const j=D.getBoundingClientRect();let H=-20,U=-20;return j&&(H-=j.left,U-=j.top),w?(P.style.left="".concat(w.clientX+H,"px"),P.style.top="".concat(w.clientY+U,"px")):(P.style.left="".concat(D.width*.5+H,"px"),P.style.top="".concat(D.height*.5+U,"px")),setTimeout(function(){var W,Z;G.focus();const Y=Date.now();function z(Q){var ee,te;Q.target===D&&Date.now()-Y>256&&(P.close(),(ee=D.parentElement)==null||ee.removeEventListener("click",z),(te=D.parentElement)==null||te.removeEventListener("touchend",z))}(W=D.parentElement)==null||W.addEventListener("click",z),(Z=D.parentElement)==null||Z.addEventListener("touchend",z)},10),P}showSearchBox(S,T){var z;const _={slot_from:null,node_from:null,node_to:null,do_type_filter:LiteGraph.search_filter_enabled,type_filter_in:!1,type_filter_out:!1,show_general_if_none_on_typefilter:!0,show_general_after_typefiltered:!0,hide_on_mouse_leave:LiteGraph.search_hide_on_mouse_leave,show_all_if_empty:!0,show_all_on_open:LiteGraph.search_show_all_on_open};Object.assign(_,T);const w=this,B=Vt.active_canvas,{canvas:A}=B,O=A.ownerDocument||document,R=document.createElement("div"),P=Object.assign(R,{close(){w.search_box=void 0,this.blur(),A.focus(),O.body.style.overflow="",setTimeout(()=>A.focus(),20),P.remove()}});P.className="litegraph litesearchbox graphdialog rounded",P.innerHTML="<span class='name'>Search</span> <input autofocus type='text' class='value rounded'/>",_.do_type_filter&&(P.innerHTML+="<select class='slot_in_type_filter'><option value=''></option></select>",P.innerHTML+="<select class='slot_out_type_filter'><option value=''></option></select>");const E=document.createElement("div");E.className="helper",P.append(E),O.fullscreenElement?O.fullscreenElement.append(P):(O.body.append(P),O.body.style.overflow="hidden");let D,I;if(_.do_type_filter&&(D=P.querySelector(".slot_in_type_filter"),I=P.querySelector(".slot_out_type_filter")),this.ds.scale>1&&(P.style.transform="scale(".concat(this.ds.scale,")")),_.hide_on_mouse_leave){let W=!1,Z=null;if(LiteGraph.pointerListenerAdd(P,"enter",function(){Z&&(clearTimeout(Z),Z=null)}),P.addEventListener("pointerleave",function(){if(W)return;const Q=_.hide_on_mouse_leave,ee=typeof Q=="number"?Q:500;Z=setTimeout(P.close,ee)}),_.do_type_filter){if(!D)throw new TypeError("selIn was null when showing search box");if(!I)throw new TypeError("selOut was null when showing search box");D.addEventListener("click",function(){W++}),D.addEventListener("blur",function(){W=0}),D.addEventListener("change",function(){W=-1}),I.addEventListener("click",function(){W++}),I.addEventListener("blur",function(){W=0}),I.addEventListener("change",function(){W=-1})}}(z=w.search_box)==null||z.close(),w.search_box=P;let M=null,N=null,k=null;const F=P.querySelector("input");if(!F)throw new TypeError("Could not create search input box.");const G=F;if(G&&(G.addEventListener("blur",function(){this.focus()}),G.addEventListener("keydown",function(W){if(W.key=="ArrowUp")X(!1);else if(W.key=="ArrowDown")X(!0);else if(W.key=="Escape")P.close();else if(W.key=="Enter")k instanceof HTMLElement?U(unescape(String(k.dataset.type))):M?U(M):P.close();else{N&&clearInterval(N),N=setTimeout(Y,10);return}return W.preventDefault(),W.stopPropagation(),W.stopImmediatePropagation(),!0})),_.do_type_filter){if(D){const W=LiteGraph.slot_types_in,Z=W.length;(_.type_filter_in==LiteGraph.EVENT||_.type_filter_in==LiteGraph.ACTION)&&(_.type_filter_in="_event_");for(let Q=0;Q<Z;Q++){const ee=document.createElement("option");ee.value=W[Q],ee.innerHTML=W[Q],D.append(ee),_.type_filter_in!==!1&&String(_.type_filter_in).toLowerCase()==String(W[Q]).toLowerCase()&&(ee.selected=!0)}D.addEventListener("change",function(){Y()})}if(I){const W=LiteGraph.slot_types_out;(_.type_filter_out==LiteGraph.EVENT||_.type_filter_out==LiteGraph.ACTION)&&(_.type_filter_out="_event_");for(const Z of W){const Q=document.createElement("option");Q.value=Z,Q.innerHTML=Z,I.append(Q),_.type_filter_out!==!1&&String(_.type_filter_out).toLowerCase()==String(Z).toLowerCase()&&(Q.selected=!0)}I.addEventListener("change",function(){Y()})}}const V=A.getBoundingClientRect(),j=(S?S.clientX:V.left+V.width*.5)-80,H=(S?S.clientY:V.top+V.height*.5)-20;P.style.left="".concat(j,"px"),P.style.top="".concat(H,"px"),S.layerY>V.height-200&&(E.style.maxHeight="".concat(V.height-S.layerY-20,"px")),requestAnimationFrame(function(){G.focus()}),_.show_all_on_open&&Y();function U(W){if(W)if(w.onSearchBoxSelection)w.onSearchBoxSelection(W,S,B);else{if(!B.graph)throw new NullGraphError;B.graph.beforeChange();const Z=LiteGraph.createNode(W);if(Z&&(Z.pos=B.convertEventToCanvasOffset(S),B.graph.add(Z,!1)),_.node_from){let Q=!1;switch(typeof _.slot_from){case"string":Q=_.node_from.findOutputSlot(_.slot_from);break;case"object":if(_.slot_from==null)throw new TypeError("options.slot_from was null when showing search box");Q=_.slot_from.name?_.node_from.findOutputSlot(_.slot_from.name):-1,Q==-1&&_.slot_from.slot_index!==void 0&&(Q=_.slot_from.slot_index);break;case"number":Q=_.slot_from;break;default:Q=0}if(_.node_from.outputs[Q]!==void 0&&Q!==!1&&Q>-1){if(Z==null)throw new TypeError("options.slot_from was null when showing search box");_.node_from.connectByType(Q,Z,_.node_from.outputs[Q].type)}}if(_.node_to){let Q=!1;switch(typeof _.slot_from){case"string":Q=_.node_to.findInputSlot(_.slot_from);break;case"object":if(_.slot_from==null)throw new TypeError("options.slot_from was null when showing search box");Q=_.slot_from.name?_.node_to.findInputSlot(_.slot_from.name):-1,Q==-1&&_.slot_from.slot_index!==void 0&&(Q=_.slot_from.slot_index);break;case"number":Q=_.slot_from;break;default:Q=0}if(_.node_to.inputs[Q]!==void 0&&Q!==!1&&Q>-1){if(Z==null)throw new TypeError("options.slot_from was null when showing search box");_.node_to.connectByTypeOutput(Q,Z,_.node_to.inputs[Q].type)}}B.graph.afterChange()}P.close()}function X(W){const Z=k;k?k instanceof Element&&(k.classList.remove("selected"),k=W?k.nextSibling:k.previousSibling,k||(k=Z)):k=W?E.childNodes[0]:E.childNodes[E.childNodes.length],k instanceof Element&&(k.classList.add("selected"),k.scrollIntoView({block:"end",behavior:"smooth"}))}function Y(){N=null;let W=G.value;if(M=null,E.innerHTML="",!W&&!_.show_all_if_empty)return;if(w.onSearchBox){const Q=w.onSearchBox(E,W,B);if(Q)for(const ee of Q)Z(ee)}else{let Q=function(pe,K){var _e,oe;K=K||{};const le=Object.assign({skipFilter:!1,inTypeOverride:!1,outTypeOverride:!1},K),ce=LiteGraph.registered_node_types[pe];if(te&&ce.filter!=te||(!_.show_all_if_empty||W)&&!pe.toLowerCase().includes(W)&&(!ce.title||!ce.title.toLowerCase().includes(W)))return!1;if(_.do_type_filter&&!le.skipFilter){const de=pe;let me=le.inTypeOverride!==!1?le.inTypeOverride:re.value;if(re&&me&&((_e=LiteGraph.registered_slot_in_types[me])!=null&&_e.nodes)&&LiteGraph.registered_slot_in_types[me].nodes.includes(de)===!1||(me=ie.value,le.outTypeOverride!==!1&&(me=le.outTypeOverride),ie&&me&&((oe=LiteGraph.registered_slot_out_types[me])!=null&&oe.nodes)&&LiteGraph.registered_slot_out_types[me].nodes.includes(de)===!1))return!1}return!0},ee=0;if(W=W.toLowerCase(),!B.graph)throw new NullGraphError;const te=B.filter||B.graph.filter;let re=!1,ie=!1;_.do_type_filter&&w.search_box&&(re=w.search_box.querySelector(".slot_in_type_filter"),ie=w.search_box.querySelector(".slot_out_type_filter"));const he=Object.keys(LiteGraph.registered_node_types).filter(pe=>Q(pe));for(const pe of he)if(Z(pe),Vt.search_limit!==-1&&ee++>Vt.search_limit)break;if(_.show_general_after_typefiltered&&(re.value||ie.value)){filtered_extra=[];for(const pe in LiteGraph.registered_node_types)Q(pe,{inTypeOverride:re&&re.value?"*":!1,outTypeOverride:ie&&ie.value?"*":!1})&&filtered_extra.push(pe);for(const pe of filtered_extra)if(Z(pe,"generic_type"),Vt.search_limit!==-1&&ee++>Vt.search_limit)break}if((re.value||ie.value)&&E.childNodes.length==0&&_.show_general_if_none_on_typefilter){filtered_extra=[];for(const pe in LiteGraph.registered_node_types)Q(pe,{skipFilter:!0})&&filtered_extra.push(pe);for(const pe of filtered_extra)if(Z(pe,"not_in_filter"),Vt.search_limit!==-1&&ee++>Vt.search_limit)break}}function Z(Q,ee){const te=document.createElement("div");M||(M=Q);const re=LiteGraph.registered_node_types[Q];if(re!=null&&re.title){te.textContent=re==null?void 0:re.title;const ie=document.createElement("span");ie.className="litegraph lite-search-item-type",ie.textContent=Q,te.append(ie)}else te.textContent=Q;te.dataset.type=escape(Q),te.className="litegraph lite-search-item",ee&&(te.className+=" ".concat(ee)),te.addEventListener("click",function(){U(unescape(String(this.dataset.type)))}),E.append(te)}}return P}showEditPropertyValue(S,T,_){if(!S||S.properties[T]===void 0)return;_=_||{};const w=S.getPropertyInfo(T),{type:B}=w;let A="";if(B=="string"||B=="number"||B=="array"||B=="object")A="<input autofocus type='text' class='value'/>";else if((B=="enum"||B=="combo")&&w.values){A="<select autofocus type='text' class='value'>";for(const M in w.values){const N=Array.isArray(w.values)?w.values[M]:M,k=N==S.properties[T]?"selected":"";A+="<option value='".concat(N,"' ").concat(k,">").concat(w.values[M],"</option>")}A+="</select>"}else if(B=="boolean"||B=="toggle"){const M=S.properties[T]?"checked":"";A="<input autofocus type='checkbox' class='value' ".concat(M,"/>")}else{console.warn("unknown type: ".concat(B));return}const O=this.createDialog("<span class='name'>".concat(w.label||T,"</span>").concat(A,"<button>OK</button>"),_);let R;if((B=="enum"||B=="combo")&&w.values)R=O.querySelector("select"),R==null||R.addEventListener("change",function(M){var N;O.modified(),I((N=M.target)==null?void 0:N.value)});else if(B=="boolean"||B=="toggle")R=O.querySelector("input"),R==null||R.addEventListener("click",function(){O.modified(),I(!!R.checked)});else if(R=O.querySelector("input"),R){R.addEventListener("blur",function(){this.focus()});let M=S.properties[T]!==void 0?S.properties[T]:"";B!=="string"&&(M=JSON.stringify(M)),R.value=M,R.addEventListener("keydown",function(N){if(N.key=="Escape")O.close();else if(N.key=="Enter")E();else{O.modified();return}N.preventDefault(),N.stopPropagation()})}R==null||R.focus();const P=O.querySelector("button");if(!P)throw new TypeError("Show edit property value button was null.");P.addEventListener("click",E);function E(){I(R==null?void 0:R.value)}const D=()=>Zt(this,ir,qr).call(this);function I(M){var N,k;w!=null&&w.values&&typeof w.values=="object"&&w.values[M]!=null&&(M=w.values[M]),typeof S.properties[T]=="number"&&(M=Number(M)),(B=="array"||B=="object")&&(M=JSON.parse(M)),S.properties[T]=M,S.graph&&S.graph._version++,(N=S.onPropertyChanged)==null||N.call(S,T,M),(k=_.onclose)==null||k.call(_),O.close(),D()}return O}createDialog(S,T){T=Object.assign({checkForInput:!1,closeOnLeave:!0,closeOnLeave_checkModified:!0},T||{});const w={className:"graphdialog",innerHTML:S,is_modified:!1,modified(){this.is_modified=!0},close(){this.remove()}},B=document.createElement("div"),A=Object.assign(B,w),O=this.canvas.getBoundingClientRect();let R=-20,P=-20;if(O&&(R-=O.left,P-=O.top),T.position?(R+=T.position[0],P+=T.position[1]):T.event?(R+=T.event.clientX,P+=T.event.clientY):(R+=this.canvas.width*.5,P+=this.canvas.height*.5),A.style.left="".concat(R,"px"),A.style.top="".concat(P,"px"),!this.canvas.parentNode)throw new TypeError("Canvas parent element was null.");if(this.canvas.parentNode.append(A),T.checkForInput){const M=A.querySelectorAll("input");if(M)for(const N of M)N.addEventListener("keydown",function(k){if(A.modified(),k.key=="Escape")A.close();else if(k.key!="Enter")return;k.preventDefault(),k.stopPropagation()}),N.focus()}let E,D=0;A.addEventListener("mouseleave",function(){D||!A.is_modified&&LiteGraph.dialog_close_on_mouse_leave&&(E=setTimeout(A.close,LiteGraph.dialog_close_on_mouse_leave_delay))}),A.addEventListener("mouseenter",function(){(T.closeOnLeave||LiteGraph.dialog_close_on_mouse_leave)&&E&&clearTimeout(E)});const I=A.querySelectorAll("select");if(I)for(const M of I)M.addEventListener("click",function(){D++}),M.addEventListener("blur",function(){D=0}),M.addEventListener("change",function(){D=-1});return A}createPanel(S,T){T=T||{};const _=T.window||window,w=document.createElement("div");if(w.className="litegraph dialog",w.innerHTML="<div class='dialog-header'><span class='dialog-title'></span></div><div class='dialog-content'></div><div style='display:none;' class='dialog-alt-content'></div><div class='dialog-footer'></div>",w.header=w.querySelector(".dialog-header"),T.width&&(w.style.width=T.width+(typeof T.width=="number"?"px":"")),T.height&&(w.style.height=T.height+(typeof T.height=="number"?"px":"")),T.closable){const B=document.createElement("span");B.innerHTML="&#10005;",B.classList.add("close"),B.addEventListener("click",function(){w.close()}),w.header.append(B)}return w.title_element=w.querySelector(".dialog-title"),w.title_element.textContent=S,w.content=w.querySelector(".dialog-content"),w.alt_content=w.querySelector(".dialog-alt-content"),w.footer=w.querySelector(".dialog-footer"),w.close=function(){typeof w.onClose=="function"&&w.onClose(),w.remove(),this.remove()},w.toggleAltContent=function(B){let A,O;B!==void 0?(A=B?"block":"none",O=B?"none":"block"):(A=w.alt_content.style.display!="block"?"block":"none",O=w.alt_content.style.display!="block"?"none":"block"),w.alt_content.style.display=A,w.content.style.display=O},w.toggleFooterVisibility=function(B){let A;B!==void 0?A=B?"block":"none":A=w.footer.style.display!="block"?"block":"none",w.footer.style.display=A},w.clear=function(){this.content.innerHTML=""},w.addHTML=function(B,A,O){const R=document.createElement("div");return A&&(R.className=A),R.innerHTML=B,O?w.footer.append(R):w.content.append(R),R},w.addButton=function(B,A,O){const R=document.createElement("button");return R.textContent=B,R.options=O,R.classList.add("btn"),R.addEventListener("click",A),w.footer.append(R),R},w.addSeparator=function(){const B=document.createElement("div");B.className="separator",w.content.append(B)},w.addWidget=function(B,A,O,R,P){R=R||{};let E=String(O);B=B.toLowerCase(),B=="number"&&typeof O=="number"&&(E=O.toFixed(3));const D=document.createElement("div");D.className="property",D.innerHTML="<span class='property_name'></span><span class='property_value'></span>";const I=D.querySelector(".property_name");if(!I)throw new TypeError("Property name element was null.");I.textContent=R.label||A;const M=D.querySelector(".property_value");if(!M)throw new TypeError("Property name element was null.");if(M.textContent=E,D.dataset.property=A,D.dataset.type=R.type||B,D.options=R,D.value=O,B=="code")D.addEventListener("click",function(){w.inner_showCodePad(this.dataset.property)});else if(B=="boolean")D.classList.add("boolean"),O&&D.classList.add("bool-on"),D.addEventListener("click",()=>{const k=D.dataset.property;if(D.value=!D.value,D.classList.toggle("bool-on"),!M)throw new TypeError("Property name element was null.");M.textContent=D.value?"true":"false",N(k,D.value)});else if(B=="string"||B=="number"){if(!M)throw new TypeError("Property name element was null.");M.setAttribute("contenteditable","true"),M.addEventListener("keydown",function(k){k.code=="Enter"&&(B!="string"||!k.shiftKey)&&(k.preventDefault(),this.blur())}),M.addEventListener("blur",function(){var V,j;let k=this.textContent;const F=(V=this.parentElement)==null?void 0:V.dataset.property;((j=this.parentElement)==null?void 0:j.dataset.type)=="number"&&(k=Number(k)),N(F,k)})}else if(B=="enum"||B=="combo"){const k=Vt.getPropertyPrintableValue(O,R.values);if(!M)throw new TypeError("Property name element was null.");M.textContent=k!=null?k:"",M.addEventListener("click",function(F){var H;const G=R.values||[],V=(H=this.parentElement)==null?void 0:H.dataset.property,j=U=>(this.textContent=U,N(V,U),!1);new LiteGraph.ContextMenu(G,{event:F,className:"dark",callback:j},_)})}w.content.append(D);function N(k,F){var G;(G=R.callback)==null||G.call(R,k,F,R),P==null||P(k,F,R)}return D},typeof w.onOpen=="function"&&w.onOpen(),w}closePanels(){var S,T,_,w;(T=(S=document.querySelector("#node-panel"))==null?void 0:S.close)==null||T.call(S),(w=(_=document.querySelector("#option-panel"))==null?void 0:_.close)==null||w.call(_)}showShowNodePanel(S){this.SELECTED_NODE=S,this.closePanels();const T=this.getCanvasWindow(),_=this.createPanel(S.title||"",{closable:!0,window:T,onOpen:()=>{this.NODEPANEL_IS_OPEN=!0},onClose:()=>{this.NODEPANEL_IS_OPEN=!1,this.node_panel=null}});this.node_panel=_,_.id="node-panel",_.node=S,_.classList.add("settings");const w=()=>{var R,P;_.content.innerHTML="",_.addHTML("<span class='node_type'>".concat(S.type,"</span><span class='node_desc'>").concat(S.constructor.desc||"","</span><span class='separator'></span>")),_.addHTML("<h3>Properties</h3>");const B=(E,D)=>{if(!this.graph)throw new NullGraphError;switch(this.graph.beforeChange(S),E){case"Title":if(typeof D!="string")throw new TypeError("Attempting to set title to non-string value.");S.title=D;break;case"Mode":{if(typeof D!="string")throw new TypeError("Attempting to set mode to non-string value.");const I=Object.values(LiteGraph.NODE_MODES).indexOf(D);I!==-1&&LiteGraph.NODE_MODES[I]?S.changeMode(I):console.warn("unexpected mode: ".concat(D));break}case"Color":if(typeof D!="string")throw new TypeError("Attempting to set colour to non-string value.");Vt.node_colors[D]?(S.color=Vt.node_colors[D].color,S.bgcolor=Vt.node_colors[D].bgcolor):console.warn("unexpected color: ".concat(D));break;default:S.setProperty(E,D);break}this.graph.afterChange(),this.dirty_canvas=!0};_.addWidget("string","Title",S.title,{},B);const A=S.mode==null?void 0:LiteGraph.NODE_MODES[S.mode];_.addWidget("combo","Mode",A,{values:LiteGraph.NODE_MODES},B);const O=S.color!==void 0?Object.keys(Vt.node_colors).filter(function(E){return Vt.node_colors[E].color==S.color}):"";_.addWidget("combo","Color",O,{values:Object.keys(Vt.node_colors)},B);for(const E in S.properties){const D=S.properties[E],I=S.getPropertyInfo(E);(R=S.onAddPropertyToPanel)!=null&&R.call(S,E,_)||_.addWidget(I.widget||I.type,E,D,I,B)}_.addSeparator(),(P=S.onShowCustomPanelInfo)==null||P.call(S,_),_.footer.innerHTML="",_.addButton("Delete",function(){if(!S.block_delete){if(!S.graph)throw new NullGraphError;S.graph.remove(S),_.close()}}).classList.add("delete")};if(_.inner_showCodePad=function(B){_.classList.remove("settings"),_.classList.add("centered"),_.alt_content.innerHTML="<textarea class='code'></textarea>";const A=_.alt_content.querySelector("textarea"),O=function(){_.toggleAltContent(!1),_.toggleFooterVisibility(!0),A.remove(),_.classList.add("settings"),_.classList.remove("centered"),w()};A.value=String(S.properties[B]),A.addEventListener("keydown",function(E){E.code=="Enter"&&E.ctrlKey&&(S.setProperty(B,A.value),O())}),_.toggleAltContent(!0),_.toggleFooterVisibility(!1),A.style.height="calc(100% - 40px)";const R=_.addButton("Assign",function(){S.setProperty(B,A.value),O()});_.alt_content.append(R);const P=_.addButton("Close",O);P.style.float="right",_.alt_content.append(P)},w(),!this.canvas.parentNode)throw new TypeError("showNodePanel - this.canvas.parentNode was null");this.canvas.parentNode.append(_)}showSubgraphPropertiesDialog(S){console.log("showing subgraph input properties dialog");var T=this.canvas.parentNode.querySelector(".subgraph_dialog");T&&T.close();var _=this.createPanel("Subgraph Inputs",{closable:!0,width:500});_.node=S,_.classList.add("subgraph_dialog");function w(){if(_.clear(),S.inputs)for(var O=0;O<S.inputs.length;++O){var R=S.inputs[O];if(!R.not_subgraph_input){var P="<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>",E=_.addHTML(P,"subgraph_property");E.dataset.name=R.name,E.dataset.slot=O,E.querySelector(".name").innerText=R.name,E.querySelector(".type").innerText=R.type,E.querySelector("button").addEventListener("click",function(D){S.removeInput(Number(this.parentNode.dataset.slot)),w()})}}}var B=" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>",A=_.addHTML(B,"subgraph_property extra",!0);return A.querySelector("button").addEventListener("click",function(O){var R=this.parentNode,P=R.querySelector(".name").value,E=R.querySelector(".type").value;!P||S.findInputSlot(P)!=-1||(S.addInput(P,E),R.querySelector(".name").value="",R.querySelector(".type").value="",w())}),w(),this.canvas.parentNode.appendChild(_),_}checkPanels(){if(!this.canvas)return;if(!this.canvas.parentNode)throw new TypeError("checkPanels - this.canvas.parentNode was null");const S=this.canvas.parentNode.querySelectorAll(".litegraph.dialog");for(const T of S)T.node&&(!T.node.graph||T.graph!=this.graph)&&T.close()}getCanvasMenuOptions(){var _;let S;this.getMenuOptions?S=this.getMenuOptions():(S=[{content:"Add Node",has_submenu:!0,callback:Vt.onMenuAdd},{content:"Add Group",callback:Vt.onGroupAdd}],Object.keys(this.selected_nodes).length>1&&S.push({content:"Align",has_submenu:!0,callback:Vt.onGroupAlign}),this._graph_stack&&this._graph_stack.length>0&&S.push(null,{content:"Close subgraph",callback:this.closeSubgraph.bind(this)}));const T=(_=this.getExtraMenuOptions)==null?void 0:_.call(this,this,S);return Array.isArray(T)?S.concat(T):S}getNodeMenuOptions(S){var A,O,R,P;let T;if(S.getMenuOptions?T=S.getMenuOptions(this):(T=[{content:"Inputs",has_submenu:!0,disabled:!0,callback:Vt.showMenuNodeOptionalInputs},{content:"Outputs",has_submenu:!0,disabled:!0,callback:Vt.showMenuNodeOptionalOutputs},null,{content:"Properties",has_submenu:!0,callback:Vt.onShowMenuNodeProperties},{content:"Properties Panel",callback:function(E,D,I,M,N){Vt.active_canvas.showShowNodePanel(N)}},null,{content:"Title",callback:Vt.onShowPropertyEditor},{content:"Mode",has_submenu:!0,callback:Vt.onMenuNodeMode}],S.resizable!==!1&&T.push({content:"Resize",callback:Vt.onMenuResizeNode}),S.collapsible&&T.push({content:S.collapsed?"Expand":"Collapse",callback:Vt.onMenuNodeCollapse}),(A=S.widgets)!=null&&A.some(E=>E.advanced)&&T.push({content:S.showAdvanced?"Hide Advanced":"Show Advanced",callback:Vt.onMenuToggleAdvanced}),T.push({content:S.pinned?"Unpin":"Pin",callback:()=>{for(const E in this.selected_nodes)this.selected_nodes[E].pin();this.setDirty(!0,!0)}},{content:"Colors",has_submenu:!0,callback:Vt.onMenuNodeColors},{content:"Shapes",has_submenu:!0,callback:Vt.onMenuNodeShapes},null)),S.onGetInputs){var _=S.onGetInputs();_&&_.length&&(T[0].disabled=!1)}if(S.onGetOutputs){var w=S.onGetOutputs();w&&w.length&&(T[1].disabled=!1)}const B=(O=S.getExtraMenuOptions)==null?void 0:O.call(S,this,T);return Array.isArray(B)&&B.length>0&&(B.push(null),T=B.concat(T)),S.clonable!==!1&&T.push({content:"Clone",callback:Vt.onMenuNodeClone}),Object.keys(this.selected_nodes).length>1&&T.push({content:"Align Selected To",has_submenu:!0,callback:Vt.onNodeAlign},{content:"Distribute Nodes",has_submenu:!0,callback:Vt.createDistributeMenu}),T.push(null,{content:"Remove",disabled:!(S.removable!==!1&&!S.block_delete),callback:Vt.onMenuNodeRemove}),(P=(R=S.graph)==null?void 0:R.onGetNodeMenuOptions)==null||P.call(R,T,S),T}getGroupMenuOptions(S){return console.warn("LGraphCanvas.getGroupMenuOptions is deprecated, use LGraphGroup.getMenuOptions instead"),S.getMenuOptions()}processContextMenu(S,T){var E,D,I,M;const w=Vt.active_canvas.getCanvasWindow();let B;const A={event:T,callback:P,extra:S};if(S){A.title=(E=S.type)!=null?E:void 0,Vt.active_node=S;const N=S.getSlotInPosition(T.canvasX,T.canvasY);if(N){if(B=[],S.getSlotMenuOptions)B=S.getSlotMenuOptions(N);else{((I=(D=N.output)==null?void 0:D.links)!=null&&I.length||((M=N.input)==null?void 0:M.link)!=null)&&B.push({content:"Disconnect Links",slot:N});const k=N.input||N.output;if(!k)throw new TypeError("Both in put and output slots were null when processing context menu.");k.removable&&B.push(k.locked?"Cannot remove":{content:"Remove Slot",slot:N}),k.nameLocked||B.push({content:"Rename Slot",slot:N}),S.getExtraSlotMenuOptions&&B.push(...S.getExtraSlotMenuOptions(N))}A.title=(N.input?N.input.type:N.output.type)||"*",N.input&&N.input.type==LiteGraph.ACTION&&(A.title="Action"),N.output&&N.output.type==LiteGraph.EVENT&&(A.title="Event")}else B=this.getNodeMenuOptions(S)}else{if(B=this.getCanvasMenuOptions(),!this.graph)throw new NullGraphError;if(this.links_render_mode!==LinkRenderType.HIDDEN_LINK){const k=this.graph.getRerouteOnPos(T.canvasX,T.canvasY);k&&B.unshift({content:"Delete Reroute",callback:()=>{if(!this.graph)throw new NullGraphError;this.graph.removeReroute(k.id)}},null)}const N=this.graph.getGroupOnPos(T.canvasX,T.canvasY);N&&B.push(null,{content:"Edit Group",has_submenu:!0,submenu:{title:"Group",extra:N,options:N.getMenuOptions()}})}if(!B)return;new LiteGraph.ContextMenu(B,A,w);const O=N=>this.createDialog("<span class='name'>Name</span><input autofocus type='text'/><button>OK</button>",N),R=()=>this.setDirty(!0);function P(N,k){var F;if(N){if(N.content=="Remove Slot"){if(!(S!=null&&S.graph))throw new NullGraphError;const G=N.slot;if(!G)throw new TypeError("Found-slot info was null when processing context menu.");S.graph.beforeChange(),G.input?S.removeInput(G.slot):G.output&&S.removeOutput(G.slot),S.graph.afterChange();return}else if(N.content=="Disconnect Links"){if(!(S!=null&&S.graph))throw new NullGraphError;const G=N.slot;if(!G)throw new TypeError("Found-slot info was null when processing context menu.");S.graph.beforeChange(),G.output?S.disconnectOutput(G.slot):G.input&&S.disconnectInput(G.slot,!0),S.graph.afterChange();return}else if(N.content=="Rename Slot"){if(!S)throw new TypeError("`node` was null when processing the context menu.");const G=N.slot;if(!G)throw new TypeError("Found-slot info was null when processing context menu.");const V=G.input?S.getInputInfo(G.slot):S.getOutputInfo(G.slot),j=O(k),H=j.querySelector("input");H&&V&&(H.value=V.label||"");const U=function(){if(!S.graph)throw new NullGraphError;S.graph.beforeChange(),H!=null&&H.value&&(V&&(V.label=H.value),R()),j.close(),S.graph.afterChange()};if((F=j.querySelector("button"))==null||F.addEventListener("click",U),!H)throw new TypeError("Input element was null when processing context menu.");H.addEventListener("keydown",function(X){if(j.is_modified=!0,X.key=="Escape")j.close();else if(X.key=="Enter")U();else if(X.target.localName!="textarea")return;X.preventDefault(),X.stopPropagation()}),H.focus()}}}}animateToBounds(S,T={}){const _=()=>this.setDirty(!0,!0);this.ds.animateToBounds(S,_,T)}fitViewToSelectionAnimated(S={}){const T=this.selectedItems.size?Array.from(this.selectedItems):this.positionableItems,_=createBounds(T);if(!_)throw new TypeError("Attempted to fit to view but could not calculate bounds.");const w=()=>this.setDirty(!0,!0);this.ds.animateToBounds(_,w,S)}};sn=new WeakMap,an=new WeakMap,on=new WeakMap,ai=new WeakMap,Kr=new WeakMap,ln=new WeakMap,cn=new WeakMap,un=new WeakMap,ir=new WeakSet,rn=function(){if(!this.state.shouldSetCursor)return;let S="default";this.state.draggingCanvas?S="grabbing":this.state.readOnly?S="grab":this.state.hoveringOver&CanvasItem.ResizeSe?S="se-resize":this.state.hoveringOver&CanvasItem.Node&&(S="crosshair"),this.canvas.style.cursor=S},ei=new WeakMap,Oi=new WeakMap,Hr=new WeakMap,Mi=new WeakMap,oi=new WeakMap,ea=function(S){if(typeof S=="string"){const T=document.getElementById(S);if(!(T instanceof HTMLCanvasElement))throw"Error validating LiteGraph canvas: Canvas element not found";return T}return S},qr=function(){this.dirty_canvas=!0,this.dirty_bgcanvas=!0},ta=function(S,T){var P;const{pointer:_,graph:w,linkConnector:B}=this;if(!w)throw new NullGraphError;const A=S.canvasX,O=S.canvasY,R=S.ctrlKey||S.metaKey;if(R&&!S.altKey){const E=new Float32Array(4);E[0]=A,E[1]=O,E[2]=1,E[3]=1,_.onClick=D=>{var M;const I=(M=T!=null?T:w.getRerouteOnPos(D.canvasX,D.canvasY))!=null?M:w.getGroupTitlebarOnPos(D.canvasX,D.canvasY);this.processSelect(I,D)},_.onDragStart=()=>this.dragging_rectangle=E,_.onDragEnd=D=>Zt(this,ir,aa).call(this,D,E),_.finally=()=>this.dragging_rectangle=null;return}if(this.read_only){_.finally=()=>this.dragging_canvas=!1,this.dragging_canvas=!0;return}if(LiteGraph.alt_drag_do_clone_nodes&&S.altKey&&!S.ctrlKey&&T&&this.allow_interaction){const E=(P=T.clone())==null?void 0:P.serialize();if((E==null?void 0:E.type)!=null){const D=LiteGraph.createNode(E.type);if(D){D.configure(E),D.pos[0]+=5,D.pos[1]+=5,this.allow_dragnodes?(_.onDragStart=I=>{w.add(D,!1),Zt(this,ir,wi).call(this,D,I)},_.onDragEnd=I=>Zt(this,ir,Ai).call(this,I)):(w.beforeChange(),w.add(D,!1),w.afterChange());return}}}if(T&&(this.allow_interaction||T.flags.allow_interaction))Zt(this,ir,ra).call(this,S,R,T);else{if(this.links_render_mode!==LinkRenderType.HIDDEN_LINK){const M=w.getRerouteOnPos(A,O);if(M){S.shiftKey&&(B.dragFromReroute(w,M),_.onDragEnd=N=>B.dropLinks(w,N),_.finally=()=>B.reset(!0),this.dirty_bgcanvas=!0),_.onClick=()=>this.processSelect(M,S),_.onDragEnd||(_.onDragStart=N=>Zt(this,ir,wi).call(this,M,N,!0),_.onDragEnd=N=>Zt(this,ir,Ai).call(this,N));return}}const{lineWidth:E}=this.ctx;this.ctx.lineWidth=this.connections_width+7;const D=1;for(const M of this.renderedPaths){const N=M._pos;if(N){if((S.shiftKey||S.altKey)&&M.path&&this.ctx.isPointInStroke(M.path,A*D,O*D)){if(this.ctx.lineWidth=E,S.shiftKey&&!S.altKey){B.dragFromLinkSegment(w,M),_.onDragEnd=k=>B.dropLinks(w,k),_.finally=()=>B.reset(!0);return}else if(S.altKey&&!S.shiftKey){const k=w.createReroute([A,O],M);_.onDragStart=F=>Zt(this,ir,wi).call(this,k,F),_.onDragEnd=F=>Zt(this,ir,Ai).call(this,F);return}}else if(isInRectangle(A,O,N[0]-4,N[1]-4,8,8)){this.ctx.lineWidth=E,_.onClick=()=>this.showLinkMenu(M,S),_.onDragStart=()=>this.dragging_canvas=!0,_.finally=()=>this.dragging_canvas=!1,this.over_link_center=void 0;return}}}this.ctx.lineWidth=E;const I=w.getGroupOnPos(A,O);if(this.selected_group=I!=null?I:null,I){if(I.isInResize(A,O)){const M=I.boundingRect,N=A-(M[0]+M[2]),k=O-(M[1]+M[3]);_.onDragStart=()=>this.resizingGroup=I,_.onDrag=F=>{if(this.read_only)return;const G=[F.canvasX-I.pos[0]-N,F.canvasY-I.pos[1]-k];Ut(this,Hr)&&snapPoint(G,Ut(this,Hr)),I.resize(G[0],G[1])&&(this.dirty_bgcanvas=!0)},_.finally=()=>this.resizingGroup=null}else{const N=(I.font_size||LiteGraph.DEFAULT_GROUP_FONT_SIZE)*1.4;isInRectangle(A,O,I.pos[0],I.pos[1],I.size[0],N)&&(_.onClick=()=>this.processSelect(I,S),_.onDragStart=k=>{I.recomputeInsideNodes(),Zt(this,ir,wi).call(this,I,k,!0)},_.onDragEnd=k=>Zt(this,ir,Ai).call(this,k))}_.onDoubleClick=()=>{this.emitEvent({subType:"group-double-click",originalEvent:S,group:I})}}else _.onDoubleClick=()=>{this.allow_searchbox&&(this.showSearchBox(S),S.preventDefault()),this.emitEvent({subType:"empty-double-click",originalEvent:S})}}!_.onDragStart&&!_.onClick&&!_.onDrag&&this.allow_dragcanvas&&(_.onClick=()=>this.processSelect(null,S),_.finally=()=>this.dragging_canvas=!1,this.dragging_canvas=!0)},ra=function(S,T,_){var I,M,N,k;const{pointer:w,graph:B,linkConnector:A}=this;if(!B)throw new NullGraphError;const O=S.canvasX,R=S.canvasY;w.onClick=()=>this.processSelect(_,S),_.flags.pinned||this.bringToFront(_);const P=_.isPointInCollapse(O,R);if(P)w.onClick=()=>{_.collapse(),this.setDirty(!0,!0)};else if(!_.flags.collapsed){if(_.resizable!==!1&&_.inResizeCorner(O,R)){const V=_.boundingRect,j=O-(V[0]+V[2]),H=R-(V[1]+V[3]);w.onDragStart=()=>{B.beforeChange(),this.resizing_node=_},w.onDrag=U=>{if(this.read_only)return;const X=[U.canvasX-_.pos[0]-j,U.canvasY-_.pos[1]-H];Ut(this,Hr)&&snapPoint(X,Ut(this,Hr));const Y=_.computeSize();X[0]=Math.max(Y[0],X[0]),X[1]=Math.max(Y[1],X[1]),_.setSize(X),Zt(this,ir,qr).call(this)},w.onDragEnd=()=>{Zt(this,ir,qr).call(this),B.afterChange(this.resizing_node)},w.finally=()=>this.resizing_node=null,this.canvas.style.cursor="se-resize";return}const{inputs:F,outputs:G}=_;if(G)for(const[V,j]of G.entries()){const H=_.getOutputPos(V);if(isInRectangle(O,R,H[0]-15,H[1]-10,30,20)){if(S.shiftKey&&((I=j.links)!=null&&I.length||(M=j._floatingLinks)!=null&&M.size)){A.moveOutputLink(B,j),w.onDragEnd=U=>A.dropLinks(B,U),w.finally=()=>A.reset(!0);return}A.dragNewFromOutput(B,_,j),w.onDragEnd=U=>A.dropLinks(B,U),w.finally=()=>A.reset(!0),LiteGraph.shift_click_do_break_link_from?S.shiftKey&&_.disconnectOutput(V):LiteGraph.ctrl_alt_click_do_break_link&&T&&S.altKey&&!S.shiftKey&&_.disconnectOutput(V),w.onDoubleClick=()=>{var U;return(U=_.onOutputDblClick)==null?void 0:U.call(_,V,S)},w.onClick=()=>{var U;return(U=_.onOutputClick)==null?void 0:U.call(_,V,S)};return}}if(F)for(const[V,j]of F.entries()){const H=_.getInputPos(V);if(isInRectangle(O,R,H[0]-15,H[1]-10,30,20)){w.onDoubleClick=()=>{var X;return(X=_.onInputDblClick)==null?void 0:X.call(_,V,S)},w.onClick=()=>{var X;return(X=_.onInputClick)==null?void 0:X.call(_,V,S)};const U=LiteGraph.ctrl_alt_click_do_break_link&&T&&S.altKey&&!S.shiftKey;(j.link!==null||(N=j._floatingLinks)!=null&&N.size)&&(U||LiteGraph.click_do_break_link_to?_.disconnectInput(V,!0):(S.shiftKey||this.allow_reconnect_links)&&A.moveInputLink(B,j)),A.isConnecting||A.dragNewFromInput(B,_,j),w.onDragEnd=X=>A.dropLinks(B,X),w.finally=()=>A.reset(!0),this.dirty_bgcanvas=!0;return}}}const E=[O-_.pos[0],R-_.pos[1]],D=_.getWidgetOnPos(O,R);if(D)Zt(this,ir,ia).call(this,S,_,D),this.node_widget=[_,D];else{if(w.onDoubleClick=()=>{var F,G;E[1]<0&&!P&&((F=_.onNodeTitleDblClick)==null||F.call(_,S,E,this)),(G=_.onDblClick)==null||G.call(_,S,E,this),this.emitEvent({subType:"node-double-click",originalEvent:S,node:_}),this.processNodeDblClicked(_)},(k=_.onMouseDown)!=null&&k.call(_,S,E,this)||!this.allow_dragnodes)return;w.onDragStart=F=>Zt(this,ir,wi).call(this,_,F,!0),w.onDragEnd=F=>Zt(this,ir,Ai).call(this,F)}this.dirty_canvas=!0},ia=function(S,T,_){var E;const{pointer:w}=this;if(typeof _.onPointerDown=="function"&&_.onPointerDown(w,T,this))return;const B=_.value,A=this.graph_mouse,O=A[0]-T.pos[0],R=A[1]-T.pos[1],P=WIDGET_TYPE_MAP[_.type];if(P){const D=toClass(P,_);w.onClick=()=>D.onClick({e:S,node:T,canvas:this}),w.onDrag=I=>{var M;return(M=D.onDrag)==null?void 0:M.call(D,{e:I,node:T,canvas:this})}}else if(_.mouse){const D=_.mouse(S,[O,R],T);D!=null&&(this.dirty_canvas=D)}if(B!=_.value){if((E=T.onWidgetChanged)==null||E.call(T,_.name,_.value,B,_),!T.graph)throw new NullGraphError;T.graph._version++}w.finally=()=>{if(_.mouse){const{eUp:D}=w;if(!D)return;const{canvasX:I,canvasY:M}=D;_.mouse(D,[I-T.pos[0],M-T.pos[1]],T)}this.node_widget=null}},na=function(S,T){const{pointer:_}=this;if(LiteGraph.middle_click_slot_add_default_node&&T&&this.allow_interaction&&!this.read_only&&!this.connecting_links&&!T.flags.collapsed){let w=!1,B=!1,A=!1;const{inputs:O,outputs:R}=T;if(R)for(const[P,E]of R.entries()){const D=T.getOutputPos(P);if(isInRectangle(S.canvasX,S.canvasY,D[0]-15,D[1]-10,30,20)){w=E,B=P,A=!0;break}}if(O)for(const[P,E]of O.entries()){const D=T.getInputPos(P);if(isInRectangle(S.canvasX,S.canvasY,D[0]-15,D[1]-10,30,20)){w=E,B=P,A=!1;break}}if(w&&B!==!1){const P=.5-(B+1)/(A?R.length:O.length),E=T.getBounding(),D=[A?E[0]+E[2]:E[0],S.canvasY-80];_.onClick=()=>this.createDefaultNodeForSlot({nodeFrom:A?T:null,slotFrom:A?B:null,nodeTo:A?null:T,slotTo:A?null:B,position:D,nodeType:"AUTO",posAdd:[A?30:-30,-P*130],posSizeFix:[A?0:-1,0]})}}this.allow_dragcanvas&&(_.onDragStart=()=>this.dragging_canvas=!0,_.finally=()=>this.dragging_canvas=!1)},sa=function(S){if(!S.buttons){_r(this,oi,null);return}const T=Ut(this,oi);if(!T)throw new TypeError("Drag-zoom state object was null");if(!this.graph)throw new NullGraphError;const _=S.y-T.pos[1],B=T.scale-_/100;this.ds.changeScale(B,T.pos),this.graph.change()},wi=function(S,T,_=!1){var w;this.emitBeforeChange(),(w=this.graph)==null||w.beforeChange(),T.finally=()=>{var B;this.isDragging=!1,(B=this.graph)==null||B.afterChange(),this.emitAfterChange()},this.processSelect(S,T.eDown,_),this.isDragging=!0},Ai=function(S){var _;const{graph:T}=this;(S.shiftKey||LiteGraph.alwaysSnapToGrid)&&(T==null||T.snapToGrid(this.selectedItems)),this.dirty_canvas=!0,this.dirty_bgcanvas=!0,(_=this.onNodeMoved)==null||_.call(this,findFirstNode(this.selectedItems))},aa=function(S,T){var P;const{graph:_,selectedItems:w}=this;if(!_)throw new NullGraphError;const B=Math.abs(T[2]),A=Math.abs(T[3]);T[2]<0&&(T[0]-=B),T[3]<0&&(T[1]-=A),T[2]=B,T[3]=A;const O=[],R=[];for(const E of _._nodes)overlapBounding(T,E.boundingRect)&&(!E.selected||!w.has(E)?R.push(E):O.push(E));for(const E of _.groups)containsRect(T,E._bounding)&&(E.recomputeInsideNodes(),!E.selected||!w.has(E)?R.push(E):O.push(E));for(const E of _.reroutes.values())isPointInRect(E.pos,T)&&(w.add(E),E.selected=!0,!E.selected||!w.has(E)?R.push(E):O.push(E));if(S.shiftKey)for(const E of R)this.select(E);else if(S.altKey)for(const E of O)this.deselect(E);else{for(const E of w.values())O.includes(E)||this.deselect(E);for(const E of R)this.select(E)}(P=this.onSelectionChange)==null||P.call(this,this.selected_nodes)},oa=function(S){for(const T of this.renderedPaths){const _=T._pos;if(_&&isInRectangle(S.canvasX,S.canvasY,_[0]-4,_[1]-4,8,8))return T}},la=function(){var S;return LiteGraph.snaps_for_comfy?(S=this._highlight_pos)!=null?S:this.graph_mouse:this.graph_mouse},ca=function(S,T){var z,W,Z;if(!this._highlight_pos||(S.fillStyle="#ffcc00",S.beginPath(),((z=this._highlight_input)==null?void 0:z.shape)===RenderShape.ARROW?(S.moveTo(T[0]+8,T[1]+.5),S.lineTo(T[0]-4,T[1]+6+.5),S.lineTo(T[0]-4,T[1]-6+.5),S.closePath()):S.arc(T[0],T[1],6,0,Math.PI*2),S.fill(),!LiteGraph.snap_highlights_node))return;const{linkConnector:w}=this,{overReroute:B,overWidget:A}=w;if(B){const{globalAlpha:Q}=S;S.globalAlpha=1,B.drawHighlight(S,"#ffcc00aa"),S.globalAlpha=Q}const O=this.node_over;if(!(O&&w.isConnecting))return;const{strokeStyle:R,lineWidth:P}=S,E=O.boundingRect,D=3,I=LiteGraph.ROUND_RADIUS+D,M=E[0]-D,N=E[1]-D,k=E[2]+D*2,F=E[3]+D*2;S.beginPath(),S.roundRect(M,N,k,F,I);const G=w.state.connectingTo==="output"?0:1,V=G?-1:1,j=T[0],H=T[1],U=k<F?k:k*Math.max(F/k,.5),X=S.createRadialGradient(j,H,0,j,H,U);X.addColorStop(1,"#00000000"),X.addColorStop(0,"#ffcc00aa");const Y=S.createLinearGradient(M,N,M+k,N);if(Y.addColorStop(.5,"#00000000"),Y.addColorStop(G+.67*V,"#ddeeff33"),Y.addColorStop(G+V,"#ffcc0055"),S.setLineDash([I,I*.001]),S.lineWidth=1,S.strokeStyle=Y,S.stroke(),A){const{computedHeight:Q}=A;S.beginPath();const{pos:[ee,te]}=O,re=LiteGraph.NODE_WIDGET_HEIGHT;A.type.startsWith("custom")&&Q!=null&&Q>re*2?S.rect(ee+9,te+A.y+9,((W=A.width)!=null?W:E[2])-18,Q-18):S.roundRect(ee+15,te+A.y,(Z=A.width)!=null?Z:E[2],re,re*.5),S.stroke()}S.strokeStyle=X,S.stroke(),S.setLineDash([]),S.lineWidth=P,S.strokeStyle=R},ua=function(S,T,_,w){var A,O;const{globalAlpha:B}=S;S.globalAlpha=B*.33;for(const R of T.floatingLinks.values()){const P=LLink.getReroutes(T,R),E=P[0],D=P.at(-1);if(!(!E||!(D!=null&&D.floating)))if(D.floating.slotType==="input"){const I=T.getNodeById(R.target_id);if(!I)continue;const M=E.pos,N=I.getInputPos(R.target_slot),k=(A=I.inputs[R.target_slot])==null?void 0:A.dir;E._dragging=!0,Zt(this,ir,nn).call(this,S,R,M,N,_,w,LinkDirection.CENTER,k,!0)}else{const I=T.getNodeById(R.origin_id);if(!I)continue;const M=I.getOutputPos(R.origin_slot),N=D.pos,k=(O=I.outputs[R.origin_slot])==null?void 0:O.dir;R._dragging=!0,Zt(this,ir,nn).call(this,S,R,M,N,_,w,k,LinkDirection.CENTER,!0)}}S.globalAlpha=B},nn=function(S,T,_,w,B,A,O,R,P=!1){var V,j,H,U,X,Y;const{graph:E,renderedPaths:D}=this;if(!E)return;const I=LLink.getReroutes(E,T),M=[_,...I.map(z=>z.pos),w],N=M.map(z=>z[0]),k=M.map(z=>z[1]);if(Ut(Vt,Kr)[0]=Math.min(...N),Ut(Vt,Kr)[1]=Math.min(...k),Ut(Vt,Kr)[2]=Math.max(...N)-Ut(Vt,Kr)[0],Ut(Vt,Kr)[3]=Math.max(...k)-Ut(Vt,Kr)[1],!overlapBounding(Ut(Vt,Kr),Ut(Vt,ai)))return;const F=O||LinkDirection.RIGHT,G=R||LinkDirection.LEFT;if(I.length){let z;const W=I.length;for(let Q=0;Q<W;Q++){const ee=I[Q];if(!D.has(ee)){D.add(ee),B.push(ee),ee._colour=T.color||Vt.link_type_colors[T.type]||this.default_link_color;const te=E.getReroute(ee.parentId),re=(V=te==null?void 0:te.pos)!=null?V:_;ee.calculateAngle(this.last_draw_time,E,re),ee._dragging||this.renderLink(S,re,ee.pos,T,!1,0,null,z===void 0?F:LinkDirection.CENTER,LinkDirection.CENTER,{startControl:z,endControl:ee.controlPoint,reroute:ee,disabled:P})}if(!z&&((H=(j=I.at(-1))==null?void 0:j.floating)==null?void 0:H.slotType)==="input")z=[0,0];else{const te=(X=(U=I[Q+1])==null?void 0:U.pos)!=null?X:w,re=Math.min(Reroute.maxSplineOffset,distance(ee.pos,te)*.25);z=[re*ee.cos,re*ee.sin]}}if(T._dragging)return;const Z=(Y=M.at(-2))!=null?Y:_;this.renderLink(S,Z,w,T,!1,0,null,LinkDirection.CENTER,G,{startControl:z,disabled:P})}else T._dragging||this.renderLink(S,_,w,T,!1,0,null,F,G);if(D.add(T),T!=null&&T._last_time&&A-T._last_time<1e3){const z=2-(A-T._last_time)*.002,W=S.globalAlpha;S.globalAlpha=W*z,this.renderLink(S,_,w,T,!0,z,"white",F,G),S.globalAlpha=W}},ki=function(S,T,_,w=.25){switch(T){case LinkDirection.LEFT:S[0]+=_*-w;break;case LinkDirection.RIGHT:S[0]+=_*w;break;case LinkDirection.UP:S[1]+=_*-w;break;case LinkDirection.DOWN:S[1]+=_*w;break}},dr(Vt,sn,new Float32Array(4)),dr(Vt,an,new Float32Array(2)),dr(Vt,on,new Float32Array(4)),dr(Vt,ai,new Float32Array(4)),dr(Vt,Kr,new Float32Array(4)),dr(Vt,ln,new Float32Array(2)),dr(Vt,cn,new Float32Array(2)),dr(Vt,un,new Float32Array(2)),Vt.DEFAULT_BACKGROUND_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQBJREFUeNrs1rEKwjAUhlETUkj3vP9rdmr1Ysammk2w5wdxuLgcMHyptfawuZX4pJSWZTnfnu/lnIe/jNNxHHGNn//HNbbv+4dr6V+11uF527arU7+u63qfa/bnmh8sWLBgwYJlqRf8MEptXPBXJXa37BSl3ixYsGDBMliwFLyCV/DeLIMFCxYsWLBMwSt4Be/NggXLYMGCBUvBK3iNruC9WbBgwYJlsGApeAWv4L1ZBgsWLFiwYJmCV/AK3psFC5bBggULloJX8BpdwXuzYMGCBctgwVLwCl7Be7MMFixYsGDBsu8FH1FaSmExVfAxBa/gvVmwYMGCZbBg/W4vAQYA5tRF9QYlv/QAAAAASUVORK5CYII=",Vt.DEFAULT_EVENT_LINK_COLOR="#A86",Vt.link_type_colors={"-1":Vt.DEFAULT_EVENT_LINK_COLOR,number:"#AAA",node:"#DCA"},Vt.gradients={},Vt.search_limit=-1,Vt.node_colors={red:{color:"#322",bgcolor:"#533",groupcolor:"#A88"},brown:{color:"#332922",bgcolor:"#593930",groupcolor:"#b06634"},green:{color:"#232",bgcolor:"#353",groupcolor:"#8A8"},blue:{color:"#223",bgcolor:"#335",groupcolor:"#88A"},pale_blue:{color:"#2a363b",bgcolor:"#3f5159",groupcolor:"#3f789e"},cyan:{color:"#233",bgcolor:"#355",groupcolor:"#8AA"},purple:{color:"#323",bgcolor:"#535",groupcolor:"#a1309b"},yellow:{color:"#432",bgcolor:"#653",groupcolor:"#b58b2a"},black:{color:"#222",bgcolor:"#000",groupcolor:"#444"}};let LGraphCanvas=Vt;class MapProxyHandler{getOwnPropertyDescriptor(S,T){const _=this.get(S,T);if(_)return{configurable:!0,enumerable:!0,value:_}}has(S,T){if(typeof T=="symbol")return!1;const _=parseInt(T,10);return S.has(isNaN(_)?T:_)}ownKeys(S){return[...S.keys()].map(String)}get(S,T){if(T in S)return Reflect.get(S,T,S);if(typeof T=="symbol")return;const _=parseInt(T,10);return S.get(isNaN(_)?T:_)}set(S,T,_){if(typeof T=="symbol")return!1;const w=parseInt(T,10);return S.set(isNaN(w)?T:w,_),!0}deleteProperty(S,T){return S.delete(T)}static bindAllMethods(S){S.clear=S.clear.bind(S),S.delete=S.delete.bind(S),S.forEach=S.forEach.bind(S),S.get=S.get.bind(S),S.has=S.has.bind(S),S.set=S.set.bind(S),S.entries=S.entries.bind(S),S.keys=S.keys.bind(S),S.values=S.values.bind(S)}}var li,ci,Ui;const zr=class zr{constructor(S){dr(this,li);dr(this,ci);dr(this,Ui);this.id=zeroUuid,this.revision=0,this._version=-1,this._links=new Map,this.status=zr.STATUS_STOPPED,this.state={lastGroupId:0,lastNodeId:0,lastLinkId:0,lastRerouteId:0},this._nodes=[],this._nodes_by_id={},this._nodes_in_order=[],this._nodes_executable=null,this._groups=[],this.iteration=0,this.globaltime=0,this.runningtime=0,this.fixedtime=0,this.fixedtime_lapse=.01,this.elapsed_time=.01,this.last_update_time=0,this.starttime=0,this.catch_errors=!0,this.config={},this.vars={},this.nodes_executing=[],this.nodes_actioning=[],this.nodes_executedAction=[],this.inputs={},this.outputs={},this.extra={},_r(this,li,0),_r(this,ci,new Map),_r(this,Ui,new Map),LiteGraph.debug&&console.log("Graph created");const T=this._links;MapProxyHandler.bindAllMethods(T);const _=new MapProxyHandler;this.links=new Proxy(T,_),this.list_of_graphcanvas=null,this.clear(),S&&this.configure(S)}get empty(){return this._nodes.length+this._groups.length+this.reroutes.size===0}*positionableItems(){for(const S of this._nodes)yield S;for(const S of this._groups)yield S;for(const S of this.reroutes.values())yield S}get floatingLinks(){return Ut(this,ci)}get reroutes(){return Ut(this,Ui)}get last_node_id(){return this.state.lastNodeId}set last_node_id(S){this.state.lastNodeId=S}get last_link_id(){return this.state.lastLinkId}set last_link_id(S){this.state.lastLinkId=S}clear(){var S;if(console.log("lgCanvas开始执行clear"),this.stop(),this.status=zr.STATUS_STOPPED,this.id=zeroUuid,this.revision=0,this.state={lastGroupId:0,lastNodeId:0,lastLinkId:0,lastRerouteId:0},this._version=-1,this._nodes)for(const T of this._nodes)(S=T.onRemoved)==null||S.call(T);this._nodes=[],this._nodes_by_id={},this._nodes_in_order=[],this._nodes_executable=null,this._links.clear(),this.reroutes.clear(),Ut(this,ci).clear(),_r(this,li,0),this._groups=[],this.iteration=0,this.config={audioArray:{}},this.vars={},this.extra={},this.globaltime=0,this.runningtime=0,this.fixedtime=0,this.fixedtime_lapse=.01,this.elapsed_time=.01,this.last_update_time=0,this.starttime=0,this.catch_errors=!0,this.nodes_executing=[],this.nodes_actioning=[],this.nodes_executedAction=[],this.inputs={},this.outputs={},this.change(),this.canvasAction(T=>T.clear())}get nodes(){return this._nodes}get groups(){return this._groups}attachCanvas(S){var T;if(S.constructor!=LGraphCanvas)throw"attachCanvas expects a LGraphCanvas instance";S.graph!=this&&((T=S.graph)==null||T.detachCanvas(S)),S.graph=this,this.list_of_graphcanvas||(this.list_of_graphcanvas=[]),this.list_of_graphcanvas.push(S);for(const _ of this._nodes)_.onAttachCanvas!=null&&_.onAttachCanvas()}detachCanvas(S){if(!this.list_of_graphcanvas)return;const T=this.list_of_graphcanvas.indexOf(S);if(T!=-1){S.graph=null,this.list_of_graphcanvas.splice(T,1);for(const _ of this._nodes)_.onDetachCanvas!=null&&_.onDetachCanvas()}}async startLoadComplete(){return new Promise((S,T)=>{this.checkAssestLoadComplete=()=>{this.config.assestTotal==this.config.assestLoaded&&(console.log("所有资源都加载好了",this.config.assestTotal),this.checkAssestLoadComplete=null,S(!0))}})}async start(S){var T;if(this.status!=zr.STATUS_RUNNING)if(this.status=zr.STATUS_RUNNING,this.config.assestTotal=0,this.config.assestLoaded=0,this.config.audioArray={},this.config.inPause=!1,this.sendEventToAllNodes("onStartBeforeLoad"),this.config.assestTotal!=this.config.assestLoaded&&await this.startLoadComplete(),this.sendEventToAllNodes("onStart"),(T=this.onPlayEvent)==null||T.call(this),this.starttime=LiteGraph.getTime(),this.last_update_time=this.starttime,S||(S=0),S==0&&typeof window<"u"&&window.requestAnimationFrame){const _=()=>{var w,B;this.execution_timer_id==-1&&this.config.inPause!=!0&&(window.requestAnimationFrame(_),(w=this.onBeforeStep)==null||w.call(this),this.runStep(1,!this.catch_errors),(B=this.onAfterStep)==null||B.call(this))};this.execution_timer_id=-1,_(),this.sendEventToAllNodes("onStartAfter")}else this.execution_timer_id=setInterval(()=>{var _,w;this.config.inPause!=!0&&((_=this.onBeforeStep)==null||_.call(this),this.runStep(1,!this.catch_errors),(w=this.onAfterStep)==null||w.call(this))},S)}pause(){this.config.inPause=!0,this.sendEventToAllNodes("onPause")}resume(){this.config.inPause=!1,this.sendEventToAllNodes("onResume")}stop(){var S;this.status!=zr.STATUS_STOPPED&&(this.status=zr.STATUS_STOPPED,(S=this.onStopEvent)==null||S.call(this),this.execution_timer_id!=null&&(this.execution_timer_id!=-1&&clearInterval(this.execution_timer_id),this.execution_timer_id=null),this.sendEventToAllNodes("onStop"))}playSounds(S,T,_){let w,B=[];for(var A=0;A<S.length;A++){let O=LiteGraph.createNode("output/sound");this.add(O),O.setProperty("customeName",S[A]),_!=null&&O.setProperty("yinggui",_),A==0&&(w=O),B.push(O)}for(var A=0;A<B.length;A++){let R=B[A],P=B[A+1];P!=null?R.connect(0,P,0):R.playEndCb=T}w!=null&&w.onAction("播放")}runStep(S,T,_){var R,P,E,D,I,M;S=S||1;const w=LiteGraph.getTime();this.globaltime=.001*(w-this.starttime);const B=this._nodes_executable||this._nodes;if(!B)return;if(_=_||B.length,T){for(let N=0;N<S;N++){for(let k=0;k<_;++k){const F=B[k];F.mode==LGraphEventMode.ALWAYS&&F.onExecute&&((R=F.doExecute)==null||R.call(F))}this.fixedtime+=this.fixedtime_lapse,(P=this.onExecuteStep)==null||P.call(this)}(E=this.onAfterExecute)==null||E.call(this)}else try{for(let N=0;N<S;N++){for(let k=0;k<_;++k){const F=B[k];F.mode==LGraphEventMode.ALWAYS&&((D=F.onExecute)==null||D.call(F))}this.fixedtime+=this.fixedtime_lapse,(I=this.onExecuteStep)==null||I.call(this)}(M=this.onAfterExecute)==null||M.call(this),this.errors_in_execution=!1}catch(N){if(this.errors_in_execution=!0,LiteGraph.throw_errors)throw N;LiteGraph.debug&&console.log("Error during execution:",N),this.stop()}const A=LiteGraph.getTime();let O=A-w;O==0&&(O=1),this.execution_time=.001*O,this.globaltime+=.001*O,this.iteration+=1,this.elapsed_time=(A-this.last_update_time)*.001,this.last_update_time=A,this.nodes_executing=[],this.nodes_actioning=[],this.nodes_executedAction=[]}updateExecutionOrder(){this._nodes_in_order=this.computeExecutionOrder(!1),this._nodes_executable=[];for(const S of this._nodes_in_order)S.onExecute&&this._nodes_executable.push(S)}computeExecutionOrder(S,T){var P;const _=[],w=[],B={},A={},O={};for(const E of this._nodes){if(S&&!E.onExecute)continue;B[E.id]=E;let D=0;if(E.inputs)for(const I of E.inputs)(I==null?void 0:I.link)!=null&&(D+=1);D==0?(w.push(E),T&&(E._level=1)):(T&&(E._level=0),O[E.id]=D)}for(;;){const E=w.shift();if(E===void 0)break;if(_.push(E),delete B[E.id],!!E.outputs){for(const D of E.outputs)if(!((D==null?void 0:D.links)==null||D.links.length==0))for(const I of D.links){const M=this._links.get(I);if(!M||A[M.id])continue;const N=this.getNodeById(M.target_id);if(N==null){A[M.id]=!0;continue}T&&((P=E._level)!=null||(E._level=0),(!N._level||N._level<=E._level)&&(N._level=E._level+1)),A[M.id]=!0,O[N.id]-=1,O[N.id]==0&&w.push(N)}}}for(const E in B)_.push(B[E]);_.length!=this._nodes.length&&LiteGraph.debug&&console.warn("something went wrong, nodes missing");function R(E){const D=E.length;for(let I=0;I<D;++I)E[I].order=I}return R(_),_.sort(function(E,D){const I=E.constructor.priority||E.priority||0,M=D.constructor.priority||D.priority||0;return I==M?E.order-D.order:I-M}),R(_),_}getAncestors(S){const T=[],_=[S],w={};for(;_.length;){const B=_.shift();if(B!=null&&B.inputs){!w[B.id]&&B!=S&&(w[B.id]=!0,T.push(B));for(let A=0;A<B.inputs.length;++A){const O=B.getInputNode(A);O&&!T.includes(O)&&_.push(O)}}}return T.sort(function(B,A){return B.order-A.order}),T}arrange(S,T){S=S||100;const _=this.computeExecutionOrder(!1,!0),w=[];for(const A of _){const O=A._level||1;w[O]||(w[O]=[]),w[O].push(A)}let B=S;for(const A of w){if(!A)continue;let O=100,R=S+LiteGraph.NODE_TITLE_HEIGHT;for(const P of A){P.pos[0]=T==LiteGraph.VERTICAL_LAYOUT?R:B,P.pos[1]=T==LiteGraph.VERTICAL_LAYOUT?B:R;const E=T==LiteGraph.VERTICAL_LAYOUT?1:0;P.size[E]>O&&(O=P.size[E]);const D=T==LiteGraph.VERTICAL_LAYOUT?0:1;R+=P.size[D]+S+LiteGraph.NODE_TITLE_HEIGHT}B+=O+S}this.setDirtyCanvas(!0,!0)}getTime(){return this.globaltime}getFixedTime(){return this.fixedtime}getElapsedTime(){return this.elapsed_time}sendEventToAllNodes(S,T){const _=this._nodes_in_order||this._nodes;if(_)for(const w of _){if(w.constructor===LiteGraph.Subgraph&&S!="onExecute"){w.sendEventToAllNodes(S,T);continue}w[S]&&(T===void 0?w[S]():T&&T.constructor===Array?w[S].apply(w,T):w[S](T))}}canvasAction(S){const T=this.list_of_graphcanvas;if(T)for(const _ of T)S(_)}sendActionToCanvas(S,T){var w;const{list_of_graphcanvas:_}=this;if(_)for(const B of _)(w=B[S])==null||w.apply(B,T)}add(S,T){var w,B;if(!S)return;const{state:_}=this;if(LiteGraph.alwaysSnapToGrid){const A=this.getSnapToGridSize();A&&S.snapToGrid(A)}if(S instanceof LGraphGroup){(S.id==null||S.id===-1)&&(S.id=++_.lastGroupId),S.id>_.lastGroupId&&(_.lastGroupId=S.id),this._groups.push(S),this.setDirtyCanvas(!0),this.change(),S.graph=this,this._version++;return}if(S.id!=-1&&this._nodes_by_id[S.id]!=null&&(console.warn("LiteGraph: there is already a node with this ID, changing it"),S.id=LiteGraph.use_uuids?LiteGraph.uuidv4():++_.lastNodeId),this._nodes.length>=LiteGraph.MAX_NUMBER_OF_NODES)throw"LiteGraph: max number of nodes in a graph reached";return LiteGraph.use_uuids?(S.id==null||S.id==-1)&&(S.id=LiteGraph.uuidv4()):S.id==null||S.id==-1?S.id=++_.lastNodeId:typeof S.id=="number"&&_.lastNodeId<S.id&&(_.lastNodeId=S.id),S.graph=this,this._version++,this._nodes.push(S),this._nodes_by_id[S.id]=S,(w=S.onAdded)==null||w.call(S,this),this.config.align_to_grid&&S.alignToGrid(),T||this.updateExecutionOrder(),(B=this.onNodeAdded)==null||B.call(this,S),this.setDirtyCanvas(!0),this.change(),S}remove(S){var A,O,R;if(S instanceof LGraphGroup){const P=this._groups.indexOf(S);P!=-1&&this._groups.splice(P,1),S.graph=void 0,this._version++,this.setDirtyCanvas(!0,!0),this.change();return}if(this._nodes_by_id[S.id]==null||S.ignore_remove)return;this.beforeChange();const{inputs:T,outputs:_}=S;if(T)for(const[P,E]of T.entries())E.link!=null&&S.disconnectInput(P,!0);if(_)for(const[P,E]of _.entries())(A=E.links)!=null&&A.length&&S.disconnectOutput(P);for(const P of this.floatingLinks.values())(P.origin_id===S.id||P.target_id===S.id)&&this.removeFloatingLink(P);(O=S.onRemoved)==null||O.call(S),S.graph=null,this._version++;const{list_of_graphcanvas:w}=this;if(w)for(const P of w)P.selected_nodes[S.id]&&delete P.selected_nodes[S.id];const B=this._nodes.indexOf(S);B!=-1&&this._nodes.splice(B,1),delete this._nodes_by_id[S.id],(R=this.onNodeRemoved)==null||R.call(this,S),this.canvasAction(P=>P.checkPanels()),this.setDirtyCanvas(!0,!0),this.afterChange(),this.change(),this.updateExecutionOrder()}getNodeById(S){return S!=null?this._nodes_by_id[S]:null}findNodesByClass(S,T){T=T||[],T.length=0;const{_nodes:_}=this;for(const w of _)w.constructor===S&&T.push(w);return T}findNodesByType(S,T){var B;const _=S.toLowerCase();T=T||[],T.length=0;const{_nodes:w}=this;for(const A of w)((B=A.type)==null?void 0:B.toLowerCase())==_&&T.push(A);return T}findNodeByTitle(S){const{_nodes:T}=this;for(const _ of T)if(_.title==S)return _;return null}findNodesByTitle(S){const T=[],{_nodes:_}=this;for(const w of _)w.title==S&&T.push(w);return T}getNodeOnPos(S,T,_){const w=_||this._nodes;let B=w.length;for(;--B>=0;){const A=w[B];if(A.isPointInside(S,T))return A}return null}getGroupOnPos(S,T){return this._groups.toReversed().find(_=>_.isPointInside(S,T))}getGroupTitlebarOnPos(S,T){return this._groups.toReversed().find(_=>_.isPointInTitlebar(S,T))}getRerouteOnPos(S,T){for(const _ of this.reroutes.values()){const{pos:w}=_;if(isSortaInsideOctagon(S-w[0],T-w[1],2*Reroute.radius))return _}}snapToGrid(S){const T=this.getSnapToGridSize();if(T)for(const _ of getAllNestedItems(S))_.pinned||_.snapToGrid(T)}getSnapToGridSize(){return LiteGraph.alwaysSnapToGrid?LiteGraph.CANVAS_GRID_SIZE||1:LiteGraph.CANVAS_GRID_SIZE}checkNodeTypes(){const{_nodes:S}=this;for(const[T,_]of S.entries()){const w=LiteGraph.registered_node_types[_.type];if(_.constructor==w)continue;console.log("node being replaced by newer version:",_.type);const B=LiteGraph.createNode(_.type);B&&(S[T]=B,B.configure(_.serialize()),B.graph=this,this._nodes_by_id[B.id]=B,_.inputs&&(B.inputs=[..._.inputs]),_.outputs&&(B.outputs=[..._.outputs]))}this.updateExecutionOrder()}onAction(S,T,_){this._input_nodes=this.findNodesByClass(LiteGraph.GraphInput,this._input_nodes);for(var w=0;w<this._input_nodes.length;++w){var B=this._input_nodes[w];if(B.properties.name==S){B.actionDo(S,T,_);break}}}trigger(S,T){var _;(_=this.onTrigger)==null||_.call(this,S,T)}addInput(S,T,_){var w=this.inputs[S];w||(this.beforeChange(),this.inputs[S]={name:S,type:T,value:_},this._version++,this.afterChange(),this.onInputAdded&&this.onInputAdded(S,T),this.onInputsOutputsChange&&this.onInputsOutputsChange())}setInputData(S,T){var _=this.inputs[S];_&&(_.value=T)}getInputData(S){var T=this.inputs[S];return T?T.value:null}renameInput(S,T){if(T!=S){if(!this.inputs[S])return!1;if(this.inputs[T])return console.error("there is already one input with that name"),!1;this.inputs[T]=this.inputs[S],delete this.inputs[S],this._version++,this.onInputRenamed&&this.onInputRenamed(S,T),this.onInputsOutputsChange&&this.onInputsOutputsChange()}}changeInputType(S,T){if(!this.inputs[S])return!1;this.inputs[S].type&&String(this.inputs[S].type).toLowerCase()==String(T).toLowerCase()||(this.inputs[S].type=T,this._version++,this.onInputTypeChanged&&this.onInputTypeChanged(S,T))}removeInput(S){return this.inputs[S]?(delete this.inputs[S],this._version++,this.onInputRemoved&&this.onInputRemoved(S),this.onInputsOutputsChange&&this.onInputsOutputsChange(),!0):!1}addOutput(S,T,_){this.outputs[S]={name:S,type:T,value:_},this._version++,this.onOutputAdded&&this.onOutputAdded(S,T),this.onInputsOutputsChange&&this.onInputsOutputsChange()}setOutputData(S,T){var _=this.outputs[S];_&&(_.value=T)}getOutputData(S){var T=this.outputs[S];return T?T.value:null}renameOutput(S,T){if(!this.outputs[S])return!1;if(this.outputs[T])return console.error("there is already one output with that name"),!1;this.outputs[T]=this.outputs[S],delete this.outputs[S],this._version++,this.onOutputRenamed&&this.onOutputRenamed(S,T),this.onInputsOutputsChange&&this.onInputsOutputsChange()}changeOutputType(S,T){if(!this.outputs[S])return!1;this.outputs[S].type&&String(this.outputs[S].type).toLowerCase()==String(T).toLowerCase()||(this.outputs[S].type=T,this._version++,this.onOutputTypeChanged&&this.onOutputTypeChanged(S,T))}removeOutput(S){return this.outputs[S]?(delete this.outputs[S],this._version++,this.onOutputRemoved&&this.onOutputRemoved(S),this.onInputsOutputsChange&&this.onInputsOutputsChange(),!0):!1}triggerInput(S,T){const _=this.findNodesByTitle(S);for(const w of _)w.onTrigger(T)}setCallback(S,T){const _=this.findNodesByTitle(S);for(const w of _)w.setTrigger(T)}beforeChange(S){var T;(T=this.onBeforeChange)==null||T.call(this,this,S),this.canvasAction(_=>{var w;return(w=_.onBeforeChange)==null?void 0:w.call(_,this)})}afterChange(S){var T;(T=this.onAfterChange)==null||T.call(this,this,S),this.canvasAction(_=>{var w;return(w=_.onAfterChange)==null?void 0:w.call(_,this)})}connectionChange(S){var T;this.updateExecutionOrder(),(T=this.onConnectionChange)==null||T.call(this,S),this._version++,this.canvasAction(_=>{var w;return(w=_.onConnectionChange)==null?void 0:w.call(_)})}clearTriggeredSlots(){for(const S of this._links.values())S&&S._last_time&&(S._last_time=0)}change(){var S;this.canvasAction(T=>T.setDirty(!0,!0)),(S=this.on_change)==null||S.call(this,this)}setDirtyCanvas(S,T){this.canvasAction(_=>_.setDirty(S,T))}addFloatingLink(S){var w,B,A,O,R;S.id===-1&&(S.id=++Gs(this,li)._),Ut(this,ci).set(S.id,S);const T=S.target_id!==-1?(B=(w=this.getNodeById(S.target_id))==null?void 0:w.inputs)==null?void 0:B[S.target_slot]:(O=(A=this.getNodeById(S.origin_id))==null?void 0:A.outputs)==null?void 0:O[S.origin_slot];T?((R=T._floatingLinks)!=null||(T._floatingLinks=new Set),T._floatingLinks.add(S)):console.warn("Adding invalid floating link: target/slot: [".concat(S.target_id,"/").concat(S.target_slot,"] origin/slot: [").concat(S.origin_id,"/").concat(S.origin_slot,"]"));const _=LLink.getReroutes(this,S);for(const P of _)P.floatingLinkIds.add(S.id);return S}removeFloatingLink(S){var w,B,A,O,R;Ut(this,ci).delete(S.id);const T=S.target_id!==-1?(B=(w=this.getNodeById(S.target_id))==null?void 0:w.inputs)==null?void 0:B[S.target_slot]:(O=(A=this.getNodeById(S.origin_id))==null?void 0:A.outputs)==null?void 0:O[S.origin_slot];T&&((R=T._floatingLinks)==null||R.delete(S));const _=LLink.getReroutes(this,S);for(const P of _)P.floatingLinkIds.delete(S.id),P.floatingLinkIds.size===0&&delete P.floating,P.totalLinks===0&&this.removeReroute(P.id)}getReroute(S){return S==null?void 0:this.reroutes.get(S)}setReroute({id:S,parentId:T,pos:_,linkIds:w,floating:B}){var O;S!=null||(S=++this.state.lastRerouteId),S>this.state.lastRerouteId&&(this.state.lastRerouteId=S);const A=(O=this.reroutes.get(S))!=null?O:new Reroute(S,this);return A.update(T,_,w,B),this.reroutes.set(S,A),A}createReroute(S,T){const _=++this.state.lastRerouteId,w=T instanceof Reroute?T.linkIds:[T.id],B=T instanceof Reroute?T.floatingLinkIds:[T.id],A=new Reroute(_,this,S,T.parentId,w,B);this.reroutes.set(_,A);for(const O of w){const R=this._links.get(O);if(!R)continue;R.parentId===T.parentId&&(R.parentId=_);const P=LLink.getReroutes(this,R);for(const E of P.filter(D=>D.parentId===T.parentId))E.parentId=_}for(const O of B){const R=this.floatingLinks.get(O);if(!R)continue;R.parentId===T.parentId&&(R.parentId=_);const P=LLink.getReroutes(this,R);for(const E of P.filter(D=>D.parentId===T.parentId))E.parentId=_}return A}removeReroute(S){const{reroutes:T}=this,_=T.get(S);if(!_)return;const{parentId:w,linkIds:B,floatingLinkIds:A}=_;for(const O of T.values())O.parentId===S&&(O.parentId=w);for(const O of B){const R=this._links.get(O);R&&R.parentId===S&&(R.parentId=w)}for(const O of A){const R=this.floatingLinks.get(O);if(!R){console.warn("Removed reroute had floating link ID that did not exist [".concat(O,"]"));continue}const P=LLink.getReroutes(this,R),E=P.at(-1),D=P.at(-2);_===E&&((D==null?void 0:D.totalLinks)!==1?this.removeFloatingLink(R):R.parentId===S&&(R.parentId=w,D.floating=_.floating))}T.delete(S),this.setDirtyCanvas(!1,!0)}removeLink(S){const T=this._links.get(S);if(!T)return;const _=this.getNodeById(T.target_id);_==null||_.disconnectInput(T.target_slot,!1),T.disconnect(this)}serialize(S){const{config:T,state:_,groups:w,nodes:B,reroutes:A,extra:O,floatingLinks:R}=this.asSerialisable(S),P=[...this._links.values()],E=P.map(D=>D.serialize());return A!=null&&A.length&&(O.linkExtensions=P.filter(D=>D.parentId!==void 0).map(D=>({id:D.id,parentId:D.parentId}))),O.reroutes=A!=null&&A.length?A:void 0,{id:this.id,revision:this.revision,last_node_id:_.lastNodeId,last_link_id:_.lastLinkId,nodes:B,links:E,floatingLinks:R,groups:w,config:T,extra:O,version:LiteGraph.VERSION}}asSerialisable(S){var N;const{id:T,revision:_,config:w,state:B,extra:A}=this,R=(!LiteGraph.use_uuids&&(S!=null&&S.sortNodes)?[...this._nodes].sort((k,F)=>k.id-F.id):this._nodes).map(k=>k.serialize()),P=this._groups.map(k=>k.serialize()),E=this._links.size?[...this._links.values()].map(k=>k.asSerialisable()):void 0,D=this.floatingLinks.size?[...this.floatingLinks.values()].map(k=>k.asSerialisable()):void 0,I=this.reroutes.size?[...this.reroutes.values()].map(k=>k.asSerialisable()):void 0,M={id:T,revision:_,version:zr.serialisedSchemaVersion,config:w,state:B,groups:P,nodes:R,links:E,floatingLinks:D,reroutes:I,extra:A};return(N=this.onSerialize)==null||N.call(this,M),M}configure(S,T){var O;if(!S)return;T||this.clear(),S.id&&(this.id=S.id),this.id===zeroUuid&&(this.id=createUuidv4());let _;if(S.version===.4){const{extra:R}=S;if(Array.isArray(S.links))for(const P of S.links){const E=LLink.createFromArray(P);this._links.set(E.id,E)}if(Array.isArray(R==null?void 0:R.linkExtensions))for(const P of R.linkExtensions){const E=this._links.get(P.id);E&&(E.parentId=P.parentId)}_=R==null?void 0:R.reroutes}else{if(S.state){const{state:{lastGroupId:R,lastLinkId:P,lastNodeId:E,lastRerouteId:D}}=S;R!=null&&(this.state.lastGroupId=R),P!=null&&(this.state.lastLinkId=P),E!=null&&(this.state.lastNodeId=E),D!=null&&(this.state.lastRerouteId=D)}if(Array.isArray(S.links))for(const R of S.links){const P=LLink.create(R);this._links.set(P.id,P)}_=S.reroutes}if(Array.isArray(_))for(const R of _)this.setReroute(R);const w=S.nodes;for(const R in S)["nodes","groups","links","state","reroutes","floatingLinks","id"].includes(R)||(this[R]=S[R]);let B=!1;if(this._nodes=[],w){for(const R of w){let P=LiteGraph.createNode(String(R.type),R.title);P||(LiteGraph.debug&&console.log("Node not found or has errors:",R.type),P=new LGraphNode(""),P.last_serialization=R,P.has_errors=!0,B=!0),P.id=R.id,this.add(P,!0)}for(const R of w){const P=this.getNodeById(R.id);P==null||P.configure(R)}}if(Array.isArray(S.floatingLinks))for(const R of S.floatingLinks){const P=LLink.create(R);this.addFloatingLink(P),P.id>Ut(this,li)&&_r(this,li,P.id)}for(const R of this.reroutes.values())R.validateLinks(this._links,this.floatingLinks)||this.reroutes.delete(R.id);this._groups.length=0;const A=S.groups;if(A)for(const R of A){const P=new LiteGraph.LGraphGroup;P.configure(R),this.add(P)}return this.updateExecutionOrder(),this.extra=S.extra||{},delete this.extra.linkExtensions,(O=this.onConfigure)==null||O.call(this,S),this._version++,this.setDirtyCanvas(!0,!0),B}load(S,T){const _=this;if(S instanceof Blob||S instanceof File){const B=new FileReader;B.addEventListener("load",function(A){var P;const O=stringOrEmpty((P=A.target)==null?void 0:P.result),R=JSON.parse(O);_.configure(R),T==null||T()}),B.readAsText(S);return}const w=new XMLHttpRequest;w.open("GET",S,!0),w.send(null),w.addEventListener("load",function(){if(w.status!==200){console.error("Error loading graph:",w.status,w.response);return}const B=JSON.parse(w.response);_.configure(B),T==null||T()}),w.addEventListener("error",B=>{console.error("Error loading graph:",B)})}};li=new WeakMap,ci=new WeakMap,Ui=new WeakMap,zr.serialisedSchemaVersion=1,zr.STATUS_STOPPED=1,zr.STATUS_RUNNING=2;let LGraph=zr;class LiteGraphGlobal{constructor(){this.SlotShape=SlotShape,this.SlotDirection=SlotDirection,this.SlotType=SlotType,this.LabelPosition=LabelPosition,this.VERSION=.4,this.CANVAS_GRID_SIZE=10,this.NODE_TITLE_HEIGHT=30,this.NODE_TITLE_TEXT_Y=20,this.NODE_SLOT_HEIGHT=20,this.NODE_WIDGET_HEIGHT=20,this.NODE_WIDTH=140,this.NODE_MIN_WIDTH=50,this.NODE_COLLAPSED_RADIUS=10,this.NODE_COLLAPSED_WIDTH=80,this.NODE_TITLE_COLOR="#999",this.NODE_SELECTED_TITLE_COLOR="#FFF",this.NODE_TEXT_SIZE=14,this.NODE_TEXT_COLOR="#AAA",this.NODE_TEXT_HIGHLIGHT_COLOR="#EEE",this.NODE_SUBTEXT_SIZE=12,this.NODE_DEFAULT_COLOR="#333",this.NODE_DEFAULT_BGCOLOR="#353535",this.NODE_DEFAULT_BOXCOLOR="#666",this.NODE_DEFAULT_SHAPE=RenderShape.ROUND,this.NODE_BOX_OUTLINE_COLOR="#FFF",this.NODE_ERROR_COLOUR="#E00",this.DEFAULT_SHADOW_COLOR="rgba(0,0,0,0.5)",this.DEFAULT_GROUP_FONT=24,this.WIDGET_BGCOLOR="#222",this.WIDGET_OUTLINE_COLOR="#666",this.WIDGET_ADVANCED_OUTLINE_COLOR="rgba(56, 139, 253, 0.8)",this.WIDGET_TEXT_COLOR="#DDD",this.WIDGET_SECONDARY_TEXT_COLOR="#999",this.LINK_COLOR="#9A9",this.EVENT_LINK_COLOR="#A86",this.CONNECTING_LINK_COLOR="#AFA",this.MAX_NUMBER_OF_NODES=1e4,this.DEFAULT_POSITION=[100,100],this.VALID_SHAPES=["default","box","round","card"],this.ROUND_RADIUS=8,this.BOX_SHAPE=RenderShape.BOX,this.ROUND_SHAPE=RenderShape.ROUND,this.CIRCLE_SHAPE=RenderShape.CIRCLE,this.CARD_SHAPE=RenderShape.CARD,this.ARROW_SHAPE=RenderShape.ARROW,this.GRID_SHAPE=RenderShape.GRID,this.INPUT=NodeSlotType.INPUT,this.OUTPUT=NodeSlotType.OUTPUT,this.EVENT=-1,this.ACTION=-1,this.NODE_MODES=["Always","On Event","Never","On Trigger"],this.NODE_MODES_COLORS=["#0B8236","#FF8B00","#333","#2885D7","#626"],this.ALWAYS=LGraphEventMode.ALWAYS,this.ON_EVENT=LGraphEventMode.ON_EVENT,this.NEVER=LGraphEventMode.NEVER,this.ON_TRIGGER=LGraphEventMode.ON_TRIGGER,this.UP=LinkDirection.UP,this.DOWN=LinkDirection.DOWN,this.LEFT=LinkDirection.LEFT,this.RIGHT=LinkDirection.RIGHT,this.CENTER=LinkDirection.CENTER,this.LINK_RENDER_MODES=["Straight","Linear","Spline"],this.HIDDEN_LINK=LinkRenderType.HIDDEN_LINK,this.STRAIGHT_LINK=LinkRenderType.STRAIGHT_LINK,this.LINEAR_LINK=LinkRenderType.LINEAR_LINK,this.SPLINE_LINK=LinkRenderType.SPLINE_LINK,this.NORMAL_TITLE=TitleMode.NORMAL_TITLE,this.NO_TITLE=TitleMode.NO_TITLE,this.TRANSPARENT_TITLE=TitleMode.TRANSPARENT_TITLE,this.AUTOHIDE_TITLE=TitleMode.AUTOHIDE_TITLE,this.VERTICAL_LAYOUT="vertical",this.proxy=null,this.node_images_path="",this.debug=!1,this.catch_exceptions=!0,this.throw_errors=!0,this.allow_scripts=!1,this.registered_node_types={},this.node_types_by_file_extension={},this.Nodes={},this.Globals={},this.searchbox_extras={},this.node_box_coloured_when_on=!1,this.node_box_coloured_by_mode=!1,this.dialog_close_on_mouse_leave=!1,this.dialog_close_on_mouse_leave_delay=500,this.shift_click_do_break_link_from=!1,this.click_do_break_link_to=!1,this.ctrl_alt_click_do_break_link=!0,this.snaps_for_comfy=!0,this.snap_highlights_node=!0,this.search_hide_on_mouse_leave=!0,this.search_filter_enabled=!1,this.search_show_all_on_open=!0,this.auto_load_slot_types=!1,this.registered_slot_in_types={},this.registered_slot_out_types={},this.slot_types_in=[],this.slot_types_out=[],this.slot_types_default_in={},this.slot_types_default_out={},this.alt_drag_do_clone_nodes=!1,this.do_add_triggers_slots=!1,this.allow_multi_output_for_events=!0,this.middle_click_slot_add_default_node=!1,this.release_link_on_empty_shows_menu=!1,this.pointerevents_method="pointer",this.ctrl_shift_v_paste_connect_unselected_outputs=!0,this.use_uuids=!1,this.highlight_selected_group=!0,this.context_menu_scaling=!1,this.LGraph=LGraph,this.LLink=LLink,this.LGraphNode=LGraphNode,this.LGraphGroup=LGraphGroup,this.DragAndScale=DragAndScale,this.LGraphCanvas=LGraphCanvas,this.ContextMenu=ContextMenu,this.CurveEditor=CurveEditor,this.Reroute=Reroute,this.InputIndicators=InputIndicators,this.uuidv4=createUuidv4,this.distance=distance,this.isInsideRectangle=isInsideRectangle,this.overlapBounding=overlapBounding}registerNodeType(S,T){var A,O,R;if(!T.prototype)throw"Cannot register a simple object, it must be a class with a prototype";T.type=S,this.debug&&console.log("Node registered:",S);const _=T.name,w=S.lastIndexOf("/");T.category=S.substring(0,w),T.title||(T.title=_);for(const P in LGraphNode.prototype)(A=T.prototype)[P]||(A[P]=LGraphNode.prototype[P]);const B=this.registered_node_types[S];B&&console.log("replacing node type:",S),this.registered_node_types[S]=T,T.constructor.name&&(this.Nodes[_]=T),(O=this.onNodeTypeRegistered)==null||O.call(this,S,T),B&&((R=this.onNodeTypeReplaced)==null||R.call(this,S,T,B)),T.prototype.onPropertyChange&&console.warn("LiteGraph node class ".concat(S," has onPropertyChange method, it must be called onPropertyChanged with d at the end")),this.auto_load_slot_types&&new T(T.title||"tmpnode")}unregisterNodeType(S){const T=typeof S=="string"?this.registered_node_types[S]:S;if(!T)throw"node type not found: ".concat(String(S));delete this.registered_node_types[String(T.type)];const _=T.constructor.name;_&&delete this.Nodes[_]}registerNodeAndSlotType(S,T,_){_||(_=!1);const B=(typeof S=="string"&&this.registered_node_types[S]!=="anonymous"?this.registered_node_types[S]:S).constructor.type;let A=[];typeof T=="string"?A=T.split(","):T==this.EVENT||T==this.ACTION?A=["_event_"]:A=["*"];for(let O of A){O===""&&(O="*");const R=_?"registered_slot_out_types":"registered_slot_in_types";this[R][O]===void 0&&(this[R][O]={nodes:[]}),this[R][O].nodes.includes(B)||this[R][O].nodes.push(B);const P=_?this.slot_types_out:this.slot_types_in;P.includes(O.toLowerCase())||(P.push(O.toLowerCase()),P.sort())}}clearRegisteredTypes(){this.registered_node_types={},this.node_types_by_file_extension={},this.Nodes={},this.searchbox_extras={}}createNode(S,T,_){var A;const w=this.registered_node_types[S];if(!w)return this.debug&&console.warn('GraphNode type "'.concat(S,'" not registered.')),null;T=T||w.title||S;let B=null;if(this.catch_exceptions)try{B=new w(T)}catch(O){return console.error(O),null}else B=new w(T);if(B.type=S,!B.title&&T&&(B.title=T),B.properties||(B.properties={}),B.properties_info||(B.properties_info=[]),B.flags||(B.flags={}),B.size||(B.size=B.computeSize()),B.pos||(B.pos=[this.DEFAULT_POSITION[0],this.DEFAULT_POSITION[1]]),B.mode||(B.mode=LGraphEventMode.ALWAYS),_)for(const O in _)B[O]=_[O];return(A=B.onNodeCreated)==null||A.call(B),B}getNodeType(S){return this.registered_node_types[S]}getNodeTypesInCategory(S,T){const _=[];for(const w in this.registered_node_types){const B=this.registered_node_types[w];B.filter==T&&(S==""?B.category==null&&_.push(B):B.category==S&&_.push(B))}return _}getNodeTypesCategories(S){const T={"":1};for(const w in this.registered_node_types){const B=this.registered_node_types[w];if(B.category&&!B.skip_list){if(B.filter!=S)continue;T[B.category]=1}}const _=[];for(const w in T)_.push(w);return _}reloadNodes(S){const T=document.getElementsByTagName("script"),_=[];for(const B of T)_.push(B);const w=document.getElementsByTagName("head")[0];S=document.location.href+S;for(const B of _){const A=B.src;if(!(!A||A.substr(0,S.length)!=S))try{this.debug&&console.log("Reloading:",A);const O=document.createElement("script");O.type="text/javascript",O.src=A,w.append(O),B.remove()}catch(O){if(this.throw_errors)throw O;this.debug&&console.log("Error while reloading",A)}}this.debug&&console.log("Nodes reloaded")}cloneObject(S,T){if(S==null)return null;const _=JSON.parse(JSON.stringify(S));if(!T)return _;for(const w in _)T[w]=_[w];return T}isValidConnection(S,T){if((S==""||S==="*")&&(S=0),(T==""||T==="*")&&(T=0),!S||!T||S==T||S==this.EVENT&&T==this.ACTION)return!0;if(S=String(S),T=String(T),S=S.toLowerCase(),T=T.toLowerCase(),!S.includes(",")&&!T.includes(","))return S==T;const _=S.split(","),w=T.split(",");for(const B of _)for(const A of w)if(this.isValidConnection(B,A))return!0;return!1}getParameterNames(S){return String(S).replaceAll(/\/\/.*$/gm,"").replaceAll(/\s+/g,"").replaceAll(/\/\*[^*/]*\*\//g,"").split("){",1)[0].replace(/^[^(]*\(/,"").replaceAll(/=[^,]+/g,"").split(",").filter(Boolean)}pointerListenerAdd(S,T,_,w=!1){if(!S||!S.addEventListener||!T||typeof _!="function")return;let B=this.pointerevents_method,A=T;if(B=="pointer"&&!window.PointerEvent)switch(console.warn("sMethod=='pointer' && !window.PointerEvent"),console.log("Converting pointer[".concat(A,"] : down move up cancel enter TO touchstart touchmove touchend, etc ..")),A){case"down":{B="touch",A="start";break}case"move":{B="touch";break}case"up":{B="touch",A="end";break}case"cancel":{B="touch";break}case"enter":{console.log("debug: Should I send a move event?");break}default:console.warn("PointerEvent not available in this browser ? The event ".concat(A," would not be called"))}switch(A){case"down":case"up":case"move":case"over":case"out":case"enter":S.addEventListener(B+A,_,w);case"leave":case"cancel":case"gotpointercapture":case"lostpointercapture":if(B!="mouse")return S.addEventListener(B+A,_,w);default:return S.addEventListener(A,_,w)}}pointerListenerRemove(S,T,_,w=!1){if(!(!S||!S.removeEventListener||!T||typeof _!="function"))switch(T){case"down":case"up":case"move":case"over":case"out":case"enter":(this.pointerevents_method=="pointer"||this.pointerevents_method=="mouse")&&S.removeEventListener(this.pointerevents_method+T,_,w);case"leave":case"cancel":case"gotpointercapture":case"lostpointercapture":if(this.pointerevents_method=="pointer")return S.removeEventListener(this.pointerevents_method+T,_,w);default:return S.removeEventListener(T,_,w)}}getTime(){return performance.now()}colorToString(S){return"rgba(".concat(Math.round(S[0]*255).toFixed(),",").concat(Math.round(S[1]*255).toFixed(),",").concat(Math.round(S[2]*255).toFixed(),",").concat(S.length==4?S[3].toFixed(2):"1.0",")")}growBounding(S,T,_){T<S[0]?S[0]=T:T>S[2]&&(S[2]=T),_<S[1]?S[1]=_:_>S[3]&&(S[3]=_)}isInsideBounding(S,T){return!(S[0]<T[0][0]||S[1]<T[0][1]||S[0]>T[1][0]||S[1]>T[1][1])}hex2num(S){S.charAt(0)=="#"&&(S=S.slice(1)),S=S.toUpperCase();const T="0123456789ABCDEF",_=new Array(3);let w=0,B,A;for(let O=0;O<6;O+=2)B=T.indexOf(S.charAt(O)),A=T.indexOf(S.charAt(O+1)),_[w]=B*16+A,w++;return _}num2hex(S){const T="0123456789ABCDEF";let _="#",w,B;for(let A=0;A<3;A++)w=S[A]/16,B=S[A]%16,_+=T.charAt(w)+T.charAt(B);return _}closeAllContextMenus(S=window){const T=[...S.document.querySelectorAll(".litecontextmenu")];if(T.length)for(const _ of T)"close"in _&&typeof _.close=="function"?_.close():_.remove()}extendClass(S,T){for(const _ in T)S.hasOwnProperty(_)||(S[_]=T[_]);if(T.prototype)for(const _ in T.prototype)T.prototype.hasOwnProperty(_)&&(S.prototype.hasOwnProperty(_)||(T.prototype.__lookupGetter__(_)?S.prototype.__defineGetter__(_,T.prototype.__lookupGetter__(_)):S.prototype[_]=T.prototype[_],T.prototype.__lookupSetter__(_)&&S.prototype.__defineSetter__(_,T.prototype.__lookupSetter__(_))))}}var js;(js=Symbol.dispose)!=null||(Symbol.dispose=Symbol("Symbol.dispose"));var Us;(Us=Symbol.asyncDispose)!=null||(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));function loadPolyfills(){typeof window<"u"&&window.CanvasRenderingContext2D&&!window.CanvasRenderingContext2D.prototype.roundRect&&(window.CanvasRenderingContext2D.prototype.roundRect=function(L,S,T,_,w,B){let A=0,O=0,R=0,P=0;if(w===0){this.rect(L,S,T,_);return}if(B===void 0&&(B=w),Array.isArray(w))if(w.length==1)A=O=R=P=w[0];else if(w.length==2)A=P=w[0],O=R=w[1];else if(w.length==4)A=w[0],O=w[1],R=w[2],P=w[3];else return;else{A=w||0,O=w||0;const E=!Array.isArray(B)&&B?B:0;R=E,P=E}this.moveTo(L+A,S),this.lineTo(L+T-O,S),this.quadraticCurveTo(L+T,S,L+T,S+O),this.lineTo(L+T,S+_-P),this.quadraticCurveTo(L+T,S+_,L+T-P,S+_),this.lineTo(L+P,S+_),this.quadraticCurveTo(L,S+_,L,S+_-R),this.lineTo(L,S+R),this.quadraticCurveTo(L,S,L+A,S)}),typeof window<"u"&&!window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(L){window.setTimeout(L,1e3/60)})}const LiteGraph=new LiteGraphGlobal;function clamp(L,S,T){return S>L?S:T<L?T:L}loadPolyfills();window._CCSettings={platform:"web-desktop",groupList:["default"],collisionMatrix:[[!0]],hasResourcesBundle:!0,hasStartSceneBundle:!1,remoteBundles:[],subpackages:[],launchScene:"db://assets/Scene/startScene.fire",orientation:"",jsList:[]};(function(L,S,T){function _(B){var A=S[B];if(!A){var O=L[B];if(!O)return;var R={};A=S[B]={exports:R},O[0](function(P){return _(O[1][P]||P)},A,R)}return A.exports}for(var w=0;w<T.length;w++)_(T[w])})({1:[function(L){L("../core/platform/CCClass");var S=L("../core/utils/misc");cc.Action=cc.Class({name:"cc.Action",ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.Action.TAG_INVALID},clone:function(){var T=new cc.Action;return T.originalTarget=null,T.target=null,T.tag=this.tag,T},isDone:function(){return!0},startWithTarget:function(T){this.originalTarget=T,this.target=T},stop:function(){this.target=null},step:function(){cc.logID(1006)},update:function(){cc.logID(1007)},getTarget:function(){return this.target},setTarget:function(T){this.target=T},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(T){this.originalTarget=T},getTag:function(){return this.tag},setTag:function(T){this.tag=T},retain:function(){},release:function(){}}),cc.Action.TAG_INVALID=-1,cc.FiniteTimeAction=cc.Class({name:"cc.FiniteTimeAction",extends:cc.Action,ctor:function(){this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(T){this._duration=T},reverse:function(){return cc.logID(1008),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Class({name:"cc.Speed",extends:cc.Action,ctor:function(T,_){this._speed=0,this._innerAction=null,T&&this.initWithAction(T,_)},getSpeed:function(){return this._speed},setSpeed:function(T){this._speed=T},initWithAction:function(T,_){return T?(this._innerAction=T,this._speed=_,!0):(cc.errorID(1021),!1)},clone:function(){var T=new cc.Speed;return T.initWithAction(this._innerAction.clone(),this._speed),T},startWithTarget:function(T){cc.Action.prototype.startWithTarget.call(this,T),this._innerAction.startWithTarget(T)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(T){this._innerAction.step(T*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(T){this._innerAction!==T&&(this._innerAction=T)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(T,_){return new cc.Speed(T,_)},cc.Follow=cc.Class({name:"cc.Follow",extends:cc.Action,ctor:function(T,_){this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),T&&(_?this.initWithTarget(T,_):this.initWithTarget(T))},clone:function(){var T=new cc.Follow,_=this._worldRect,w=new cc.Rect(_.x,_.y,_.width,_.height);return T.initWithTarget(this._followedNode,w),T},isBoundarySet:function(){return this._boundarySet},setBoundarySet:function(T){this._boundarySet=T},setBoudarySet:function(T){this.setBoundarySet(T)},initWithTarget:function(T,_){if(!T)return cc.errorID(1022),!1;_=_||cc.rect(0,0,0,0),this._followedNode=T,this._worldRect=_,this._boundarySet=!(_.width===0&&_.height===0),this._boundaryFullyCovered=!1;var w=cc.winSize;return this._fullScreenSize=cc.v2(w.width,w.height),this._halfScreenSize=this._fullScreenSize.mul(.5),this._boundarySet&&(this.leftBoundary=-(_.x+_.width-this._fullScreenSize.x),this.rightBoundary=-_.x,this.topBoundary=-_.y,this.bottomBoundary=-(_.y+_.height-this._fullScreenSize.y),this.rightBoundary<this.leftBoundary&&(this.rightBoundary=this.leftBoundary=(this.leftBoundary+this.rightBoundary)/2),this.topBoundary<this.bottomBoundary&&(this.topBoundary=this.bottomBoundary=(this.topBoundary+this.bottomBoundary)/2),this.topBoundary===this.bottomBoundary&&this.leftBoundary===this.rightBoundary&&(this._boundaryFullyCovered=!0)),!0},step:function(){var T=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),_=this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO),w=T.sub(_),B=this.target.parent.convertToNodeSpaceAR(w.add(this._halfScreenSize));if(this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(S.clampf(B.x,this.leftBoundary,this.rightBoundary),S.clampf(B.y,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(B.x,B.y)},isDone:function(){return!this._followedNode.activeInHierarchy},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(T,_){return new cc.Follow(T,_)}},{"../core/platform/CCClass":196,"../core/utils/misc":271}],2:[function(){function L(w,B,A,O,R,P){var E=P*P,D=E*P,I=(1-R)/2,M=I*(2*E-D-P),N=I*(-D+E)+(2*D-3*E)+1,k=I*(D-2*E+P)+-2*D+3*E,F=I*(D-E),G=w.x*M+B.x*N+A.x*k+O.x*F,V=w.y*M+B.y*N+A.y*k+O.y*F;return cc.v2(G,V)}function S(w,B){return w[Math.min(w.length-1,Math.max(B,0))]}function T(w){for(var B=[],A=w.length-1;A>=0;A--)B.push(cc.v2(w[A].x,w[A].y));return B}function _(w){for(var B=[],A=0;A<w.length;A++)B.push(cc.v2(w[A].x,w[A].y));return B}cc.CardinalSplineTo=cc.Class({name:"cc.CardinalSplineTo",extends:cc.ActionInterval,ctor:function(w,B,A){this._points=[],this._deltaT=0,this._tension=0,this._previousPosition=null,this._accumulatedDiff=null,A!==void 0&&cc.CardinalSplineTo.prototype.initWithDuration.call(this,w,B,A)},initWithDuration:function(w,B,A){return B&&B.length!==0?!!cc.ActionInterval.prototype.initWithDuration.call(this,w)&&(this.setPoints(B),this._tension=A,!0):(cc.errorID(1024),!1)},clone:function(){var w=new cc.CardinalSplineTo;return w.initWithDuration(this._duration,_(this._points),this._tension),w},startWithTarget:function(w){cc.ActionInterval.prototype.startWithTarget.call(this,w),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.v2(this.target.x,this.target.y),this._accumulatedDiff=cc.v2(0,0)},update:function(w){var B,A;w=this._computeEaseTime(w);var O=this._points;if(w===1)B=O.length-1,A=1;else{var R=this._deltaT;A=(w-R*(B=0|w/R))/R}var P,E,D=L(S(O,B-1),S(O,B-0),S(O,B+1),S(O,B+2),this._tension,A);if(cc.macro.ENABLE_STACKABLE_ACTIONS&&(P=this.target.x-this._previousPosition.x,E=this.target.y-this._previousPosition.y,P!==0||E!==0)){var I=this._accumulatedDiff;P=I.x+P,E=I.y+E,I.x=P,I.y=E,D.x+=P,D.y+=E}this.updatePosition(D)},reverse:function(){var w=T(this._points);return cc.cardinalSplineTo(this._duration,w,this._tension)},updatePosition:function(w){this.target.setPosition(w),this._previousPosition=w},getPoints:function(){return this._points},setPoints:function(w){this._points=w}}),cc.cardinalSplineTo=function(w,B,A){return new cc.CardinalSplineTo(w,B,A)},cc.CardinalSplineBy=cc.Class({name:"cc.CardinalSplineBy",extends:cc.CardinalSplineTo,ctor:function(w,B,A){this._startPosition=cc.v2(0,0),A!==void 0&&this.initWithDuration(w,B,A)},startWithTarget:function(w){cc.CardinalSplineTo.prototype.startWithTarget.call(this,w),this._startPosition.x=w.x,this._startPosition.y=w.y},reverse:function(){for(var w,B=this._points.slice(),A=B[0],O=1;O<B.length;++O)w=B[O],B[O]=w.sub(A),A=w;var R=T(B);for(A=R[R.length-1],R.pop(),A.x=-A.x,A.y=-A.y,R.unshift(A),O=1;O<R.length;++O)(w=R[O]).x=-w.x,w.y=-w.y,w.x+=A.x,w.y+=A.y,R[O]=w,A=w;return cc.cardinalSplineBy(this._duration,R,this._tension)},updatePosition:function(w){var B=this._startPosition,A=w.x+B.x,O=w.y+B.y;this._previousPosition.x=A,this._previousPosition.y=O,this.target.setPosition(A,O)},clone:function(){var w=new cc.CardinalSplineBy;return w.initWithDuration(this._duration,_(this._points),this._tension),w}}),cc.cardinalSplineBy=function(w,B,A){return new cc.CardinalSplineBy(w,B,A)},cc.CatmullRomTo=cc.Class({name:"cc.CatmullRomTo",extends:cc.CardinalSplineTo,ctor:function(w,B){B&&this.initWithDuration(w,B)},initWithDuration:function(w,B){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,w,B,.5)},clone:function(){var w=new cc.CatmullRomTo;return w.initWithDuration(this._duration,_(this._points)),w}}),cc.catmullRomTo=function(w,B){return new cc.CatmullRomTo(w,B)},cc.CatmullRomBy=cc.Class({name:"cc.CatmullRomBy",extends:cc.CardinalSplineBy,ctor:function(w,B){B&&this.initWithDuration(w,B)},initWithDuration:function(w,B){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,w,B,.5)},clone:function(){var w=new cc.CatmullRomBy;return w.initWithDuration(this._duration,_(this._points)),w}}),cc.catmullRomBy=function(w,B){return new cc.CatmullRomBy(w,B)}},{}],3:[function(){cc.easeIn=function(re){return{_rate:re,easing:function(ie){return Math.pow(ie,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.easeOut=function(re){return{_rate:re,easing:function(ie){return Math.pow(ie,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.easeInOut=function(re){return{_rate:re,easing:function(ie){return(ie*=2)<1?.5*Math.pow(ie,this._rate):1-.5*Math.pow(2-ie,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}};var L={easing:function(re){return re===0?0:Math.pow(2,10*(re-1))},reverse:function(){return S}};cc.easeExponentialIn=function(){return L};var S={easing:function(re){return re===1?1:1-Math.pow(2,-10*re)},reverse:function(){return L}};cc.easeExponentialOut=function(){return S};var T={easing:function(re){return re!==1&&re!==0?(re*=2)<1?.5*Math.pow(2,10*(re-1)):.5*(2-Math.pow(2,-10*(re-1))):re},reverse:function(){return T}};cc.easeExponentialInOut=function(){return T};var _={easing:function(re){return re===0||re===1?re:-1*Math.cos(re*Math.PI/2)+1},reverse:function(){return w}};cc.easeSineIn=function(){return _};var w={easing:function(re){return re===0||re===1?re:Math.sin(re*Math.PI/2)},reverse:function(){return _}};cc.easeSineOut=function(){return w};var B={easing:function(re){return re===0||re===1?re:-.5*(Math.cos(Math.PI*re)-1)},reverse:function(){return B}};cc.easeSineInOut=function(){return B};var A={easing:function(re){return re===0||re===1?re:(re-=1,-Math.pow(2,10*re)*Math.sin((re-.075)*Math.PI*2/.3))},reverse:function(){return O}};cc.easeElasticIn=function(re){return re&&re!==.3?{_period:re,easing:function(ie){return ie===0||ie===1?ie:(ie-=1,-Math.pow(2,10*ie)*Math.sin((ie-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:A};var O={easing:function(re){return re===0||re===1?re:Math.pow(2,-10*re)*Math.sin((re-.075)*Math.PI*2/.3)+1},reverse:function(){return A}};function R(re){return re<1/2.75?7.5625*re*re:re<2/2.75?7.5625*(re-=1.5/2.75)*re+.75:re<2.5/2.75?7.5625*(re-=2.25/2.75)*re+.9375:7.5625*(re-=2.625/2.75)*re+.984375}cc.easeElasticOut=function(re){return re&&re!==.3?{_period:re,easing:function(ie){return ie===0||ie===1?ie:Math.pow(2,-10*ie)*Math.sin((ie-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:O},cc.easeElasticInOut=function(re){return{_period:re=re||.3,easing:function(ie){var ne=0,he=this._period;if(ie===0||ie===1)ne=ie;else{ie*=2,he||(he=this._period=.3*1.5);var pe=he/4;ne=(ie-=1)<0?-.5*Math.pow(2,10*ie)*Math.sin((ie-pe)*Math.PI*2/he):Math.pow(2,-10*ie)*Math.sin((ie-pe)*Math.PI*2/he)*.5+1}return ne},reverse:function(){return cc.easeElasticInOut(this._period)}}};var P={easing:function(re){return 1-R(1-re)},reverse:function(){return E}};cc.easeBounceIn=function(){return P};var E={easing:function(re){return R(re)},reverse:function(){return P}};cc.easeBounceOut=function(){return E};var D={easing:function(re){return re<.5?.5*(1-R(1-(re*=2))):.5*R(2*re-1)+.5},reverse:function(){return D}};cc.easeBounceInOut=function(){return D};var I={easing:function(re){return re===0||re===1?re:re*re*(2.70158*re-1.70158)},reverse:function(){return M}};cc.easeBackIn=function(){return I};var M={easing:function(re){return re===0?0:(re-=1)*re*(2.70158*re+1.70158)+1},reverse:function(){return I}};cc.easeBackOut=function(){return M};var N={easing:function(re){return(re*=2)<1?re*re*(3.5949095*re-2.5949095)/2:(re-=2)*re*(3.5949095*re+2.5949095)/2+1},reverse:function(){return N}};cc.easeBackInOut=function(){return N},cc.easeBezierAction=function(re,ie,ne,he){return{easing:function(pe){return Math.pow(1-pe,3)*re+3*pe*Math.pow(1-pe,2)*ie+3*Math.pow(pe,2)*(1-pe)*ne+Math.pow(pe,3)*he},reverse:function(){return cc.easeBezierAction(he,ne,ie,re)}}};var k={easing:function(re){return Math.pow(re,2)},reverse:function(){return k}};cc.easeQuadraticActionIn=function(){return k};var F={easing:function(re){return-re*(re-2)},reverse:function(){return F}};cc.easeQuadraticActionOut=function(){return F};var G={easing:function(re){return(re*=2)<1?re*re*.5:-.5*(--re*(re-2)-1)},reverse:function(){return G}};cc.easeQuadraticActionInOut=function(){return G};var V={easing:function(re){return re*re*re*re},reverse:function(){return V}};cc.easeQuarticActionIn=function(){return V};var j={easing:function(re){return-((re-=1)*re*re*re-1)},reverse:function(){return j}};cc.easeQuarticActionOut=function(){return j};var H={easing:function(re){return(re*=2)<1?.5*re*re*re*re:-.5*((re-=2)*re*re*re-2)},reverse:function(){return H}};cc.easeQuarticActionInOut=function(){return H};var U={easing:function(re){return re*re*re*re*re},reverse:function(){return U}};cc.easeQuinticActionIn=function(){return U};var X={easing:function(re){return(re-=1)*re*re*re*re+1},reverse:function(){return X}};cc.easeQuinticActionOut=function(){return X};var Y={easing:function(re){return(re*=2)<1?.5*re*re*re*re*re:.5*((re-=2)*re*re*re*re+2)},reverse:function(){return Y}};cc.easeQuinticActionInOut=function(){return Y};var z={easing:function(re){return-1*(Math.sqrt(1-re*re)-1)},reverse:function(){return z}};cc.easeCircleActionIn=function(){return z};var W={easing:function(re){return re-=1,Math.sqrt(1-re*re)},reverse:function(){return W}};cc.easeCircleActionOut=function(){return W};var Z={easing:function(re){return(re*=2)<1?-.5*(Math.sqrt(1-re*re)-1):(re-=2,.5*(Math.sqrt(1-re*re)+1))},reverse:function(){return Z}};cc.easeCircleActionInOut=function(){return Z};var Q={easing:function(re){return re*re*re},reverse:function(){return Q}};cc.easeCubicActionIn=function(){return Q};var ee={easing:function(re){return(re-=1)*re*re+1},reverse:function(){return ee}};cc.easeCubicActionOut=function(){return ee};var te={easing:function(re){return(re*=2)<1?.5*re*re*re:.5*((re-=2)*re*re+2)},reverse:function(){return te}};cc.easeCubicActionInOut=function(){return te}},{}],4:[function(){cc.ActionInstant=cc.Class({name:"cc.ActionInstant",extends:cc.FiniteTimeAction,isDone:function(){return!0},step:function(){this.update(1)},update:function(){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.Class({name:"cc.Show",extends:cc.ActionInstant,update:function(){for(var L=this.target.getComponentsInChildren(cc.RenderComponent),S=0;S<L.length;++S)L[S].enabled=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Hide=cc.Class({name:"cc.Hide",extends:cc.ActionInstant,update:function(){for(var L=this.target.getComponentsInChildren(cc.RenderComponent),S=0;S<L.length;++S)L[S].enabled=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.ToggleVisibility=cc.Class({name:"cc.ToggleVisibility",extends:cc.ActionInstant,update:function(){for(var L=this.target.getComponentsInChildren(cc.RenderComponent),S=0;S<L.length;++S){var T=L[S];T.enabled=!T.enabled}},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.RemoveSelf=cc.Class({name:"cc.RemoveSelf",extends:cc.ActionInstant,ctor:function(L){this._isNeedCleanUp=!0,L!==void 0&&this.init(L)},update:function(){this.target.removeFromParent(this._isNeedCleanUp)},init:function(L){return this._isNeedCleanUp=L,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(L){return new cc.RemoveSelf(L)},cc.DestroySelf=cc.Class({name:"cc.DestroySelf",extends:cc.ActionInstant,update:function(){this.target.destroy()},reverse:function(){return new cc.DestroySelf},clone:function(){return new cc.DestroySelf}}),cc.destroySelf=function(){return new cc.DestroySelf},cc.FlipX=cc.Class({name:"cc.FlipX",extends:cc.ActionInstant,ctor:function(L){this._flippedX=!1,L!==void 0&&this.initWithFlipX(L)},initWithFlipX:function(L){return this._flippedX=L,!0},update:function(){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var L=new cc.FlipX;return L.initWithFlipX(this._flippedX),L}}),cc.flipX=function(L){return new cc.FlipX(L)},cc.FlipY=cc.Class({name:"cc.FlipY",extends:cc.ActionInstant,ctor:function(L){this._flippedY=!1,L!==void 0&&this.initWithFlipY(L)},initWithFlipY:function(L){return this._flippedY=L,!0},update:function(){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var L=new cc.FlipY;return L.initWithFlipY(this._flippedY),L}}),cc.flipY=function(L){return new cc.FlipY(L)},cc.Place=cc.Class({name:"cc.Place",extends:cc.ActionInstant,ctor:function(L,S){this._x=0,this._y=0,L!==void 0&&(L.x!==void 0&&(S=L.y,L=L.x),this.initWithPosition(L,S))},initWithPosition:function(L,S){return this._x=L,this._y=S,!0},update:function(){this.target.setPosition(this._x,this._y)},clone:function(){var L=new cc.Place;return L.initWithPosition(this._x,this._y),L}}),cc.place=function(L,S){return new cc.Place(L,S)},cc.CallFunc=cc.Class({name:"cc.CallFunc",extends:cc.ActionInstant,ctor:function(L,S,T){this._selectorTarget=null,this._function=null,this._data=null,this.initWithFunction(L,S,T)},initWithFunction:function(L,S,T){return L&&(this._function=L),S&&(this._selectorTarget=S),T!==void 0&&(this._data=T),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(L){L!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=L)},clone:function(){var L=new cc.CallFunc;return L.initWithFunction(this._function,this._selectorTarget,this._data),L}}),cc.callFunc=function(L,S,T){return new cc.CallFunc(L,S,T)}},{}],5:[function(){function L(S,T,_,w,B){return Math.pow(1-B,3)*S+3*B*Math.pow(1-B,2)*T+3*Math.pow(B,2)*(1-B)*_+Math.pow(B,3)*w}cc.ActionInterval=cc.Class({name:"cc.ActionInterval",extends:cc.FiniteTimeAction,ctor:function(S){this.MAX_VALUE=2,this._elapsed=0,this._firstTick=!1,this._easeList=null,this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this._repeatMethod=!1,this._speedMethod=!1,S!==void 0&&cc.ActionInterval.prototype.initWithDuration.call(this,S)},getElapsed:function(){return this._elapsed},initWithDuration:function(S){return this._duration=S===0?cc.macro.FLT_EPSILON:S,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(S){S._repeatForever=this._repeatForever,S._speed=this._speed,S._timesForRepeat=this._timesForRepeat,S._easeList=this._easeList,S._speedMethod=this._speedMethod,S._repeatMethod=this._repeatMethod},_reverseEaseList:function(S){if(this._easeList){S._easeList=[];for(var T=0;T<this._easeList.length;T++)S._easeList.push(this._easeList[T].reverse())}},clone:function(){var S=new cc.ActionInterval(this._duration);return this._cloneDecoration(S),S},easing:function(){this._easeList?this._easeList.length=0:this._easeList=[];for(var S=0;S<arguments.length;S++)this._easeList.push(arguments[S]);return this},_computeEaseTime:function(S){var T=this._easeList;if(!T||T.length===0)return S;for(var _=0,w=T.length;_<w;_++)S=T[_].easing(S);return S},step:function(S){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=S;var T=this._elapsed/(this._duration>1192092896e-16?this._duration:1192092896e-16);T=1>T?T:1,this.update(T>0?T:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(S){cc.Action.prototype.startWithTarget.call(this,S),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.logID(1010),null},setAmplitudeRate:function(){cc.logID(1011)},getAmplitudeRate:function(){return cc.logID(1012),0},speed:function(S){return S<=0?(cc.logID(1013),this):(this._speedMethod=!0,this._speed*=S,this)},getSpeed:function(){return this._speed},setSpeed:function(S){return this._speed=S,this},repeat:function(S){return S=Math.round(S),isNaN(S)||S<1?(cc.logID(1014),this):(this._repeatMethod=!0,this._timesForRepeat*=S,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(S){return new cc.ActionInterval(S)},cc.Sequence=cc.Class({name:"cc.Sequence",extends:cc.ActionInterval,ctor:function(S){this._actions=[],this._split=null,this._last=0,this._reversed=!1;var T=S instanceof Array?S:arguments;if(T.length!==1){var _=T.length-1;if(_>=0&&T[_]==null&&cc.logID(1015),_>=0){for(var w,B=T[0],A=1;A<_;A++)T[A]&&(w=B,B=cc.Sequence._actionOneTwo(w,T[A]));this.initWithTwoActions(B,T[_])}}else cc.errorID(1019)},initWithTwoActions:function(S,T){if(!S||!T)return cc.errorID(1025),!1;var _=S._duration,w=T._duration,B=(_*=S._repeatMethod?S._timesForRepeat:1)+(w*=T._repeatMethod?T._timesForRepeat:1);return this.initWithDuration(B),this._actions[0]=S,this._actions[1]=T,!0},clone:function(){var S=new cc.Sequence;return this._cloneDecoration(S),S.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._split=this._actions[0]._duration/this._duration,this._split*=this._actions[0]._repeatMethod?this._actions[0]._timesForRepeat:1,this._last=-1},stop:function(){this._last!==-1&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(S){var T,_,w=0,B=this._split,A=this._actions,O=this._last;(S=this._computeEaseTime(S))<B?(T=B!==0?S/B:1,w===0&&O===1&&this._reversed&&(A[1].update(0),A[1].stop())):(w=1,T=B===1?1:(S-B)/(1-B),O===-1&&(A[0].startWithTarget(this.target),A[0].update(1),A[0].stop()),O===0&&(A[0].update(1),A[0].stop())),_=A[w],O===w&&_.isDone()||(O!==w&&_.startWithTarget(this.target),T*=_._timesForRepeat,_.update(T>1?T%1:T),this._last=w)},reverse:function(){var S=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(S),this._reverseEaseList(S),S._reversed=!0,S}}),cc.sequence=function(S){var T=S instanceof Array?S:arguments;if(T.length===1)return cc.errorID(1019),null;var _=T.length-1;_>=0&&T[_]==null&&cc.logID(1015);var w=null;if(_>=0){w=T[0];for(var B=1;B<=_;B++)T[B]&&(w=cc.Sequence._actionOneTwo(w,T[B]))}return w},cc.Sequence._actionOneTwo=function(S,T){var _=new cc.Sequence;return _.initWithTwoActions(S,T),_},cc.Repeat=cc.Class({name:"cc.Repeat",extends:cc.ActionInterval,ctor:function(S,T){this._times=0,this._total=0,this._nextDt=0,this._actionInstant=!1,this._innerAction=null,T!==void 0&&this.initWithAction(S,T)},initWithAction:function(S,T){var _=S._duration*T;return!!this.initWithDuration(_)&&(this._times=T,this._innerAction=S,S instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0)},clone:function(){var S=new cc.Repeat;return this._cloneDecoration(S),S.initWithAction(this._innerAction.clone(),this._times),S},startWithTarget:function(S){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,S),this._innerAction.startWithTarget(S)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(S){S=this._computeEaseTime(S);var T=this._innerAction,_=this._duration,w=this._times,B=this._nextDt;if(S>=B){for(;S>B&&this._total<w;)T.update(1),this._total++,T.stop(),T.startWithTarget(this.target),B+=T._duration/_,this._nextDt=B>1?1:B;S>=1&&this._total<w&&(T.update(1),this._total++),this._actionInstant||(this._total===w?T.stop():T.update(S-(B-T._duration/_)))}else T.update(S*w%1)},isDone:function(){return this._total===this._times},reverse:function(){var S=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(S),this._reverseEaseList(S),S},setInnerAction:function(S){this._innerAction!==S&&(this._innerAction=S)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(S,T){return new cc.Repeat(S,T)},cc.repeatForever=function(S){return new cc.RepeatForever(S)},cc.RepeatForever=cc.Class({name:"cc.RepeatForever",extends:cc.ActionInterval,ctor:function(S){this._innerAction=null,S&&this.initWithAction(S)},initWithAction:function(S){return S?(this._innerAction=S,!0):(cc.errorID(1026),!1)},clone:function(){var S=new cc.RepeatForever;return this._cloneDecoration(S),S.initWithAction(this._innerAction.clone()),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._innerAction.startWithTarget(S)},step:function(S){var T=this._innerAction;T.step(S),T.isDone()&&(T.startWithTarget(this.target),T.step(T.getElapsed()-T._duration))},isDone:function(){return!1},reverse:function(){var S=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(S),this._reverseEaseList(S),S},setInnerAction:function(S){this._innerAction!==S&&(this._innerAction=S)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(S){return new cc.RepeatForever(S)},cc.Spawn=cc.Class({name:"cc.Spawn",extends:cc.ActionInterval,ctor:function(S){this._one=null,this._two=null;var T=S instanceof Array?S:arguments;if(T.length!==1){var _=T.length-1;if(_>=0&&T[_]==null&&cc.logID(1015),_>=0){for(var w,B=T[0],A=1;A<_;A++)T[A]&&(w=B,B=cc.Spawn._actionOneTwo(w,T[A]));this.initWithTwoActions(B,T[_])}}else cc.errorID(1020)},initWithTwoActions:function(S,T){if(!S||!T)return cc.errorID(1027),!1;var _=!1,w=S._duration,B=T._duration;return this.initWithDuration(Math.max(w,B))&&(this._one=S,this._two=T,w>B?this._two=cc.Sequence._actionOneTwo(T,cc.delayTime(w-B)):w<B&&(this._one=cc.Sequence._actionOneTwo(S,cc.delayTime(B-w))),_=!0),_},clone:function(){var S=new cc.Spawn;return this._cloneDecoration(S),S.initWithTwoActions(this._one.clone(),this._two.clone()),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._one.startWithTarget(S),this._two.startWithTarget(S)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(S){S=this._computeEaseTime(S),this._one&&this._one.update(S),this._two&&this._two.update(S)},reverse:function(){var S=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(S),this._reverseEaseList(S),S}}),cc.spawn=function(S){var T=S instanceof Array?S:arguments;if(T.length===1)return cc.errorID(1020),null;T.length>0&&T[T.length-1]==null&&cc.logID(1015);for(var _=T[0],w=1;w<T.length;w++)T[w]!=null&&(_=cc.Spawn._actionOneTwo(_,T[w]));return _},cc.Spawn._actionOneTwo=function(S,T){var _=new cc.Spawn;return _.initWithTwoActions(S,T),_},cc.RotateTo=cc.Class({name:"cc.RotateTo",extends:cc.ActionInterval,statics:{_reverse:!1},ctor:function(S,T){this._startAngle=0,this._dstAngle=0,this._angle=0,T!==void 0&&this.initWithDuration(S,T)},initWithDuration:function(S,T){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._dstAngle=T,!0)},clone:function(){var S=new cc.RotateTo;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._dstAngle),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S);var T=S.angle%360,_=cc.RotateTo._reverse?this._dstAngle-T:this._dstAngle+T;_>180&&(_-=360),_<-180&&(_+=360),this._startAngle=T,this._angle=cc.RotateTo._reverse?_:-_},reverse:function(){cc.logID(1016)},update:function(S){S=this._computeEaseTime(S),this.target&&(this.target.angle=this._startAngle+this._angle*S)}}),cc.rotateTo=function(S,T){return new cc.RotateTo(S,T)},cc.RotateBy=cc.Class({name:"cc.RotateBy",extends:cc.ActionInterval,statics:{_reverse:!1},ctor:function(S,T){T*=cc.RotateBy._reverse?1:-1,this._deltaAngle=0,this._startAngle=0,T!==void 0&&this.initWithDuration(S,T)},initWithDuration:function(S,T){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._deltaAngle=T,!0)},clone:function(){var S=new cc.RotateBy;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._deltaAngle),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._startAngle=S.angle},update:function(S){S=this._computeEaseTime(S),this.target&&(this.target.angle=this._startAngle+this._deltaAngle*S)},reverse:function(){var S=new cc.RotateBy;return S.initWithDuration(this._duration,-this._deltaAngle),this._cloneDecoration(S),this._reverseEaseList(S),S}}),cc.rotateBy=function(S,T){return new cc.RotateBy(S,T)},cc.MoveBy=cc.Class({name:"cc.MoveBy",extends:cc.ActionInterval,ctor:function(S,T,_){this._positionDelta=cc.v2(0,0),this._startPosition=cc.v2(0,0),this._previousPosition=cc.v2(0,0),T!==void 0&&cc.MoveBy.prototype.initWithDuration.call(this,S,T,_)},initWithDuration:function(S,T,_){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(T.x!==void 0&&(_=T.y,T=T.x),this._positionDelta.x=T,this._positionDelta.y=_,!0)},clone:function(){var S=new cc.MoveBy;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._positionDelta),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S);var T=S.x,_=S.y;this._previousPosition.x=T,this._previousPosition.y=_,this._startPosition.x=T,this._startPosition.y=_},update:function(S){if(S=this._computeEaseTime(S),this.target){var T=this._positionDelta.x*S,_=this._positionDelta.y*S,w=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var B=this.target.x,A=this.target.y,O=this._previousPosition;w.x=w.x+B-O.x,w.y=w.y+A-O.y,T+=w.x,_+=w.y,O.x=T,O.y=_,this.target.setPosition(T,_)}else this.target.setPosition(w.x+T,w.y+_)}},reverse:function(){var S=new cc.MoveBy(this._duration,cc.v2(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(S),this._reverseEaseList(S),S}}),cc.moveBy=function(S,T,_){return new cc.MoveBy(S,T,_)},cc.MoveTo=cc.Class({name:"cc.MoveTo",extends:cc.MoveBy,ctor:function(S,T,_){this._endPosition=cc.v2(0,0),T!==void 0&&this.initWithDuration(S,T,_)},initWithDuration:function(S,T,_){return!!cc.MoveBy.prototype.initWithDuration.call(this,S,T,_)&&(T.x!==void 0&&(_=T.y,T=T.x),this._endPosition.x=T,this._endPosition.y=_,!0)},clone:function(){var S=new cc.MoveTo;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._endPosition),S},startWithTarget:function(S){cc.MoveBy.prototype.startWithTarget.call(this,S),this._positionDelta.x=this._endPosition.x-S.x,this._positionDelta.y=this._endPosition.y-S.y}}),cc.moveTo=function(S,T,_){return new cc.MoveTo(S,T,_)},cc.SkewTo=cc.Class({name:"cc.SkewTo",extends:cc.ActionInterval,ctor:function(S,T,_){this._skewX=0,this._skewY=0,this._startSkewX=0,this._startSkewY=0,this._endSkewX=0,this._endSkewY=0,this._deltaX=0,this._deltaY=0,_!==void 0&&cc.SkewTo.prototype.initWithDuration.call(this,S,T,_)},initWithDuration:function(S,T,_){var w=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._endSkewX=T,this._endSkewY=_,w=!0),w},clone:function(){var S=new cc.SkewTo;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._endSkewX,this._endSkewY),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._startSkewX=S.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=S.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(S){S=this._computeEaseTime(S),this.target.skewX=this._startSkewX+this._deltaX*S,this.target.skewY=this._startSkewY+this._deltaY*S}}),cc.skewTo=function(S,T,_){return new cc.SkewTo(S,T,_)},cc.SkewBy=cc.Class({name:"cc.SkewBy",extends:cc.SkewTo,ctor:function(S,T,_){_!==void 0&&this.initWithDuration(S,T,_)},initWithDuration:function(S,T,_){var w=!1;return cc.SkewTo.prototype.initWithDuration.call(this,S,T,_)&&(this._skewX=T,this._skewY=_,w=!0),w},clone:function(){var S=new cc.SkewBy;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._skewX,this._skewY),S},startWithTarget:function(S){cc.SkewTo.prototype.startWithTarget.call(this,S),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var S=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(S),this._reverseEaseList(S),S}}),cc.skewBy=function(S,T,_){return new cc.SkewBy(S,T,_)},cc.JumpBy=cc.Class({name:"cc.JumpBy",extends:cc.ActionInterval,ctor:function(S,T,_,w,B){this._startPosition=cc.v2(0,0),this._previousPosition=cc.v2(0,0),this._delta=cc.v2(0,0),this._height=0,this._jumps=0,w!==void 0&&cc.JumpBy.prototype.initWithDuration.call(this,S,T,_,w,B)},initWithDuration:function(S,T,_,w,B){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(B===void 0&&(B=w,w=_,_=T.y,T=T.x),this._delta.x=T,this._delta.y=_,this._height=w,this._jumps=B,!0)},clone:function(){var S=new cc.JumpBy;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._delta,this._height,this._jumps),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S);var T=S.x,_=S.y;this._previousPosition.x=T,this._previousPosition.y=_,this._startPosition.x=T,this._startPosition.y=_},update:function(S){if(S=this._computeEaseTime(S),this.target){var T=S*this._jumps%1,_=4*this._height*T*(1-T);_+=this._delta.y*S;var w=this._delta.x*S,B=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var A=this.target.x,O=this.target.y,R=this._previousPosition;B.x=B.x+A-R.x,B.y=B.y+O-R.y,w+=B.x,_+=B.y,R.x=w,R.y=_,this.target.setPosition(w,_)}else this.target.setPosition(B.x+w,B.y+_)}},reverse:function(){var S=new cc.JumpBy(this._duration,cc.v2(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(S),this._reverseEaseList(S),S}}),cc.jumpBy=function(S,T,_,w,B){return new cc.JumpBy(S,T,_,w,B)},cc.JumpTo=cc.Class({name:"cc.JumpTo",extends:cc.JumpBy,ctor:function(S,T,_,w,B){this._endPosition=cc.v2(0,0),w!==void 0&&this.initWithDuration(S,T,_,w,B)},initWithDuration:function(S,T,_,w,B){return!!cc.JumpBy.prototype.initWithDuration.call(this,S,T,_,w,B)&&(B===void 0&&(_=T.y,T=T.x),this._endPosition.x=T,this._endPosition.y=_,!0)},startWithTarget:function(S){cc.JumpBy.prototype.startWithTarget.call(this,S),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var S=new cc.JumpTo;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),S}}),cc.jumpTo=function(S,T,_,w,B){return new cc.JumpTo(S,T,_,w,B)},cc.BezierBy=cc.Class({name:"cc.BezierBy",extends:cc.ActionInterval,ctor:function(S,T){this._config=[],this._startPosition=cc.v2(0,0),this._previousPosition=cc.v2(0,0),T&&cc.BezierBy.prototype.initWithDuration.call(this,S,T)},initWithDuration:function(S,T){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._config=T,!0)},clone:function(){var S=new cc.BezierBy;this._cloneDecoration(S);for(var T=[],_=0;_<this._config.length;_++){var w=this._config[_];T.push(cc.v2(w.x,w.y))}return S.initWithDuration(this._duration,T),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S);var T=S.x,_=S.y;this._previousPosition.x=T,this._previousPosition.y=_,this._startPosition.x=T,this._startPosition.y=_},update:function(S){if(S=this._computeEaseTime(S),this.target){var T=this._config,_=T[0].x,w=T[1].x,B=T[2].x,A=T[0].y,O=T[1].y,R=T[2].y,P=L(0,_,w,B,S),E=L(0,A,O,R,S),D=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var I=this.target.x,M=this.target.y,N=this._previousPosition;D.x=D.x+I-N.x,D.y=D.y+M-N.y,P+=D.x,E+=D.y,N.x=P,N.y=E,this.target.setPosition(P,E)}else this.target.setPosition(D.x+P,D.y+E)}},reverse:function(){var S=this._config,T=S[0].x,_=S[0].y,w=S[1].x,B=S[1].y,A=S[2].x,O=S[2].y,R=[cc.v2(w-A,B-O),cc.v2(T-A,_-O),cc.v2(-A,-O)],P=new cc.BezierBy(this._duration,R);return this._cloneDecoration(P),this._reverseEaseList(P),P}}),cc.bezierBy=function(S,T){return new cc.BezierBy(S,T)},cc.BezierTo=cc.Class({name:"cc.BezierTo",extends:cc.BezierBy,ctor:function(S,T){this._toConfig=[],T&&this.initWithDuration(S,T)},initWithDuration:function(S,T){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._toConfig=T,!0)},clone:function(){var S=new cc.BezierTo;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._toConfig),S},startWithTarget:function(S){cc.BezierBy.prototype.startWithTarget.call(this,S);var T=this._startPosition,_=this._toConfig,w=this._config;w[0]=_[0].sub(T),w[1]=_[1].sub(T),w[2]=_[2].sub(T)}}),cc.bezierTo=function(S,T){return new cc.BezierTo(S,T)},cc.ScaleTo=cc.Class({name:"cc.ScaleTo",extends:cc.ActionInterval,ctor:function(S,T,_){this._scaleX=1,this._scaleY=1,this._startScaleX=1,this._startScaleY=1,this._endScaleX=0,this._endScaleY=0,this._deltaX=0,this._deltaY=0,T!==void 0&&cc.ScaleTo.prototype.initWithDuration.call(this,S,T,_)},initWithDuration:function(S,T,_){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._endScaleX=T,this._endScaleY=_!=null?_:T,!0)},clone:function(){var S=new cc.ScaleTo;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._endScaleX,this._endScaleY),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._startScaleX=S.scaleX,this._startScaleY=S.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(S){S=this._computeEaseTime(S),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*S,this.target.scaleY=this._startScaleY+this._deltaY*S)}}),cc.scaleTo=function(S,T,_){return new cc.ScaleTo(S,T,_)},cc.ScaleBy=cc.Class({name:"cc.ScaleBy",extends:cc.ScaleTo,startWithTarget:function(S){cc.ScaleTo.prototype.startWithTarget.call(this,S),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var S=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(S),this._reverseEaseList(S),S},clone:function(){var S=new cc.ScaleBy;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._endScaleX,this._endScaleY),S}}),cc.scaleBy=function(S,T,_){return new cc.ScaleBy(S,T,_)},cc.Blink=cc.Class({name:"cc.Blink",extends:cc.ActionInterval,ctor:function(S,T){this._times=0,this._originalState=!1,T!==void 0&&this.initWithDuration(S,T)},initWithDuration:function(S,T){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._times=T,!0)},clone:function(){var S=new cc.Blink;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._times),S},update:function(S){if(S=this._computeEaseTime(S),this.target&&!this.isDone()){var T=1/this._times,_=S%T;this.target.opacity=_>T/2?255:0}},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._originalState=S.opacity},stop:function(){this.target.opacity=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var S=new cc.Blink(this._duration,this._times);return this._cloneDecoration(S),this._reverseEaseList(S),S}}),cc.blink=function(S,T){return new cc.Blink(S,T)},cc.FadeTo=cc.Class({name:"cc.FadeTo",extends:cc.ActionInterval,ctor:function(S,T){this._toOpacity=0,this._fromOpacity=0,T!==void 0&&cc.FadeTo.prototype.initWithDuration.call(this,S,T)},initWithDuration:function(S,T){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._toOpacity=T,!0)},clone:function(){var S=new cc.FadeTo;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._toOpacity),S},update:function(S){S=this._computeEaseTime(S);var T=this._fromOpacity!==void 0?this._fromOpacity:255;this.target.opacity=T+(this._toOpacity-T)*S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._fromOpacity=S.opacity}}),cc.fadeTo=function(S,T){return new cc.FadeTo(S,T)},cc.FadeIn=cc.Class({name:"cc.FadeIn",extends:cc.FadeTo,ctor:function(S){S==null&&(S=0),this._reverseAction=null,this.initWithDuration(S,255)},reverse:function(){var S=new cc.FadeOut;return S.initWithDuration(this._duration,0),this._cloneDecoration(S),this._reverseEaseList(S),S},clone:function(){var S=new cc.FadeIn;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._toOpacity),S},startWithTarget:function(S){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,S)}}),cc.fadeIn=function(S){return new cc.FadeIn(S)},cc.FadeOut=cc.Class({name:"cc.FadeOut",extends:cc.FadeTo,ctor:function(S){S==null&&(S=0),this._reverseAction=null,this.initWithDuration(S,0)},reverse:function(){var S=new cc.FadeIn;return S._reverseAction=this,S.initWithDuration(this._duration,255),this._cloneDecoration(S),this._reverseEaseList(S),S},clone:function(){var S=new cc.FadeOut;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._toOpacity),S}}),cc.fadeOut=function(S){return new cc.FadeOut(S)},cc.TintTo=cc.Class({name:"cc.TintTo",extends:cc.ActionInterval,ctor:function(S,T,_,w){this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),T instanceof cc.Color&&(w=T.b,_=T.g,T=T.r),w!==void 0&&this.initWithDuration(S,T,_,w)},initWithDuration:function(S,T,_,w){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._to=cc.color(T,_,w),!0)},clone:function(){var S=new cc.TintTo;this._cloneDecoration(S);var T=this._to;return S.initWithDuration(this._duration,T.r,T.g,T.b),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._from=this.target.color},update:function(S){S=this._computeEaseTime(S);var T=this._from,_=this._to;T&&(this.target.color=cc.color(T.r+(_.r-T.r)*S,T.g+(_.g-T.g)*S,T.b+(_.b-T.b)*S))}}),cc.tintTo=function(S,T,_,w){return new cc.TintTo(S,T,_,w)},cc.TintBy=cc.Class({name:"cc.TintBy",extends:cc.ActionInterval,ctor:function(S,T,_,w){this._deltaR=0,this._deltaG=0,this._deltaB=0,this._fromR=0,this._fromG=0,this._fromB=0,w!==void 0&&this.initWithDuration(S,T,_,w)},initWithDuration:function(S,T,_,w){return!!cc.ActionInterval.prototype.initWithDuration.call(this,S)&&(this._deltaR=T,this._deltaG=_,this._deltaB=w,!0)},clone:function(){var S=new cc.TintBy;return this._cloneDecoration(S),S.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S);var T=S.color;this._fromR=T.r,this._fromG=T.g,this._fromB=T.b},update:function(S){S=this._computeEaseTime(S),this.target.color=cc.color(this._fromR+this._deltaR*S,this._fromG+this._deltaG*S,this._fromB+this._deltaB*S)},reverse:function(){var S=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(S),this._reverseEaseList(S),S}}),cc.tintBy=function(S,T,_,w){return new cc.TintBy(S,T,_,w)},cc.DelayTime=cc.Class({name:"cc.DelayTime",extends:cc.ActionInterval,update:function(){},reverse:function(){var S=new cc.DelayTime(this._duration);return this._cloneDecoration(S),this._reverseEaseList(S),S},clone:function(){var S=new cc.DelayTime;return this._cloneDecoration(S),S.initWithDuration(this._duration),S}}),cc.delayTime=function(S){return new cc.DelayTime(S)},cc.ReverseTime=cc.Class({name:"cc.ReverseTime",extends:cc.ActionInterval,ctor:function(S){this._other=null,S&&this.initWithAction(S)},initWithAction:function(S){return S?S===this._other?(cc.errorID(1029),!1):!!cc.ActionInterval.prototype.initWithDuration.call(this,S._duration)&&(this._other=S,!0):(cc.errorID(1028),!1)},clone:function(){var S=new cc.ReverseTime;return this._cloneDecoration(S),S.initWithAction(this._other.clone()),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._other.startWithTarget(S)},update:function(S){S=this._computeEaseTime(S),this._other&&this._other.update(1-S)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(S){return new cc.ReverseTime(S)},cc.TargetedAction=cc.Class({name:"cc.TargetedAction",extends:cc.ActionInterval,ctor:function(S,T){this._action=null,this._forcedTarget=null,T&&this.initWithTarget(S,T)},initWithTarget:function(S,T){return!!this.initWithDuration(T._duration)&&(this._forcedTarget=S,this._action=T,!0)},clone:function(){var S=new cc.TargetedAction;return this._cloneDecoration(S),S.initWithTarget(this._forcedTarget,this._action.clone()),S},startWithTarget:function(S){cc.ActionInterval.prototype.startWithTarget.call(this,S),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(S){S=this._computeEaseTime(S),this._action.update(S)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(S){this._forcedTarget!==S&&(this._forcedTarget=S)}}),cc.targetedAction=function(S,T){return new cc.TargetedAction(S,T)}},{}],6:[function(L){L("../core/platform/CCClass");var S=L("../core/platform/js"),T=function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.paused=!1,this.lock=!1};cc.ActionManager=function(){this._hashTargets=S.createMap(!0),this._arrayTargets=[],this._currentTarget=null,cc.director._scheduler&&cc.director._scheduler.enableForTarget(this)},cc.ActionManager.prototype={constructor:cc.ActionManager,_elementPool:[],_searchElementByTarget:function(_,w){for(var B=0;B<_.length;B++)if(w===_[B].target)return _[B];return null},_getElement:function(_,w){var B=this._elementPool.pop();return B||(B=new T),B.target=_,B.paused=!!w,B},_putElement:function(_){_.actions.length=0,_.actionIndex=0,_.currentAction=null,_.paused=!1,_.target=null,_.lock=!1,this._elementPool.push(_)},addAction:function(_,w,B){if(_&&w){var A=this._hashTargets[w._id];A?A.actions||(A.actions=[]):(A=this._getElement(w,B),this._hashTargets[w._id]=A,this._arrayTargets.push(A)),A.actions.push(_),_.startWithTarget(w)}else cc.errorID(1e3)},removeAllActions:function(){for(var _=this._arrayTargets,w=0;w<_.length;w++){var B=_[w];B&&this._putElement(B)}this._arrayTargets.length=0,this._hashTargets=S.createMap(!0)},removeAllActionsFromTarget:function(_){if(_!=null){var w=this._hashTargets[_._id];w&&(w.actions.length=0,this._deleteHashElement(w))}},removeAction:function(_){if(_){var w=_.getOriginalTarget(),B=this._hashTargets[w._id];if(B){for(var A=0;A<B.actions.length;A++)if(B.actions[A]===_){B.actions.splice(A,1),B.actionIndex>=A&&B.actionIndex--;break}}}},_removeActionByTag:function(_,w,B){for(var A=0,O=w.actions.length;A<O;++A){var R=w.actions[A];if(R&&R.getTag()===_){if(B&&R.getOriginalTarget()!==B)continue;this._removeActionAtIndex(A,w);break}}},_removeAllActionsByTag:function(_,w,B){for(var A=w.actions.length-1;A>=0;--A){var O=w.actions[A];if(O&&O.getTag()===_){if(B&&O.getOriginalTarget()!==B)continue;this._removeActionAtIndex(A,w)}}},removeActionByTag:function(_,w){_===cc.Action.TAG_INVALID&&cc.logID(1002);var B=this._hashTargets;if(w){var A=B[w._id];A&&this._removeActionByTag(_,A,w)}else for(var O in B){var R=B[O];this._removeActionByTag(_,R)}},removeAllActionsByTag:function(_,w){_===cc.Action.TAG_INVALID&&cc.logID(1002);var B=this._hashTargets;if(w){var A=B[w._id];A&&this._removeAllActionsByTag(_,A,w)}else for(var O in B){var R=B[O];this._removeAllActionsByTag(_,R)}},getActionByTag:function(_,w){_===cc.Action.TAG_INVALID&&cc.logID(1004);var B=this._hashTargets[w._id];if(B){if(B.actions!=null)for(var A=0;A<B.actions.length;++A){var O=B.actions[A];if(O&&O.getTag()===_)return O}cc.logID(1005,_)}return null},getNumberOfRunningActionsInTarget:function(_){var w=this._hashTargets[_._id];return w&&w.actions?w.actions.length:0},pauseTarget:function(_){var w=this._hashTargets[_._id];w&&(w.paused=!0)},resumeTarget:function(_){var w=this._hashTargets[_._id];w&&(w.paused=!1)},pauseAllRunningActions:function(){for(var _=[],w=this._arrayTargets,B=0;B<w.length;B++){var A=w[B];A&&!A.paused&&(A.paused=!0,_.push(A.target))}return _},resumeTargets:function(_){if(_)for(var w=0;w<_.length;w++)_[w]&&this.resumeTarget(_[w])},pauseTargets:function(_){if(_)for(var w=0;w<_.length;w++)_[w]&&this.pauseTarget(_[w])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(_,w){w.actions[_],w.actions.splice(_,1),w.actionIndex>=_&&w.actionIndex--,w.actions.length===0&&this._deleteHashElement(w)},_deleteHashElement:function(_){var w=!1;if(_&&!_.lock&&this._hashTargets[_.target._id]){delete this._hashTargets[_.target._id];for(var B=this._arrayTargets,A=0,O=B.length;A<O;A++)if(B[A]===_){B.splice(A,1);break}this._putElement(_),w=!0}return w},update:function(_){for(var w,B=this._arrayTargets,A=0;A<B.length;A++){if(this._currentTarget=B[A],!(w=this._currentTarget).paused&&w.actions){for(w.lock=!0,w.actionIndex=0;w.actionIndex<w.actions.length;w.actionIndex++)if(w.currentAction=w.actions[w.actionIndex],w.currentAction){if(w.currentAction.step(_*(w.currentAction._speedMethod?w.currentAction._speed:1)),w.currentAction&&w.currentAction.isDone()){w.currentAction.stop();var O=w.currentAction;w.currentAction=null,this.removeAction(O)}w.currentAction=null}w.lock=!1}w.actions.length===0&&this._deleteHashElement(w)&&A--}}}},{"../core/platform/CCClass":196,"../core/platform/js":217}],7:[function(L){L("./CCActionManager"),L("./CCAction"),L("./CCActionInterval"),L("./CCActionInstant"),L("./CCActionEase"),L("./CCActionCatmullRom"),L("./tween")},{"./CCAction":1,"./CCActionCatmullRom":2,"./CCActionEase":3,"./CCActionInstant":4,"./CCActionInterval":5,"./CCActionManager":6,"./tween":8}],8:[function(L){var S=L("../animation/bezier"),T=0,_=cc.Class({name:"cc.TweenAction",extends:cc.ActionInterval,ctor:function(k,F,G){if(this._opts=G=G||Object.create(null),this._props=Object.create(null),G.progress=G.progress||this.progress,G.easing&&typeof G.easing=="string"){var V=G.easing;G.easing=cc.easing[V],!G.easing&&cc.warnID(1031,V)}var j=this._opts.relative;for(var H in F){var U=F[H],X=void 0,Y=void 0;if(U.value!==void 0&&(U.easing||U.progress)&&(typeof U.easing=="string"?!(X=cc.easing[U.easing])&&cc.warnID(1031,U.easing):X=U.easing,Y=U.progress,U=U.value),typeof U=="number"||U.lerp&&(!j||U.add||U.mul)&&U.clone){var z=Object.create(null);z.value=U,z.easing=X,z.progress=Y,this._props[H]=z}else cc.warn("Can not animate "+H+" property, because it do not have [lerp, (add|mul), clone] function.")}this._originProps=F,this.initWithDuration(k)},clone:function(){var k=new _(this._duration,this._originProps,this._opts);return this._cloneDecoration(k),k},startWithTarget:function(k){cc.ActionInterval.prototype.startWithTarget.call(this,k);var F=!!this._opts.relative,G=this._props;for(var V in G){var j=k[V],H=G[V];typeof j=="number"?(H.start=j,H.current=j,H.end=F?j+H.value:H.value):(H.start=j.clone(),H.current=j.clone(),H.end=F?(j.add||j.mul).call(j,H.value):H.value)}},update:function(k){var F=this._opts,G=k;F.easing&&(G=F.easing(k));var V=this.target;if(V){var j=this._props,H=F.progress;for(var U in j){var X=j[U],Y=X.easing?X.easing(k):G,z=X.current=(X.progress||H)(X.start,X.end,X.current,Y);V[U]=z}var W=F.onUpdate;W&&W(V,k)}},progress:function(k,F,G,V){return typeof k=="number"?G=k+(F-k)*V:k.lerp(F,V,G),G}}),w=cc.Class({name:"cc.SetAction",extends:cc.ActionInstant,ctor:function(k){this._props={},k!==void 0&&this.init(k)},init:function(k){for(var F in k)this._props[F]=k[F];return!0},update:function(){var k=this._props,F=this.target;for(var G in k)F[G]=k[G]},clone:function(){var k=new w;return k.init(this._props),k}});function B(k){this._actions=[],this._finalAction=null,this._target=k,this._tag=cc.Action.TAG_INVALID}B.stopAll=function(){cc.director.getActionManager().removeAllActions()},B.stopAllByTag=function(k){cc.director.getActionManager().removeAllActionsByTag(k)},B.stopAllByTarget=function(k){cc.director.getActionManager().removeAllActionsFromTarget(k)},B.prototype.then=function(k){return k instanceof cc.Action?this._actions.push(k.clone()):this._actions.push(k._union()),this},B.prototype.target=function(k){return this._target=k,this},B.prototype.start=function(){var k=this._target;return k?k instanceof cc.Object&&!k.isValid?void 0:(this._finalAction&&cc.director.getActionManager().removeAction(this._finalAction),this._finalAction=this._union(),k._id===void 0&&(k._id=++T),this._finalAction.setTag(this._tag),cc.director.getActionManager().addAction(this._finalAction,k,!1),this):(cc.warn("Please set target to tween first"),this)},B.prototype.stop=function(){return this._finalAction&&(cc.director.getActionManager().removeAction(this._finalAction),this._finalAction=null),this},B.prototype.tag=function(k){return this._tag=k,this},B.prototype.clone=function(k){var F=this._union();return cc.tween(k).then(F.clone())},B.prototype.union=function(){var k=this._union();return this._actions.length=0,this._actions.push(k),this},B.prototype._union=function(){var k=this._actions;return k.length===1?k[0]:cc.sequence(k)},Object.assign(B.prototype,{bezierTo:function(k,F,G,V,j){var H=F.x,U=F.y,X=G.x,Y=G.y;return(j=j||Object.create(null)).progress=function(z,W,Z,Q){return Z.x=(0,S.bezier)(z.x,H,X,W.x,Q),Z.y=(0,S.bezier)(z.y,U,Y,W.y,Q),Z},this.to(k,{position:V},j)},bezierBy:function(k,F,G,V,j){var H=F.x,U=F.y,X=G.x,Y=G.y;return(j=j||Object.create(null)).progress=function(z,W,Z,Q){var ee=z.x,te=z.y;return Z.x=(0,S.bezier)(ee,H+ee,X+ee,W.x,Q),Z.y=(0,S.bezier)(te,U+te,Y+te,W.y,Q),Z},this.by(k,{position:V},j)},flipX:function(){var k=this;return this.call(function(){k._target.scaleX*=-1},this)},flipY:function(){var k=this;return this.call(function(){k._target.scaleY*=-1},this)},blink:function(k,F,G){var V=1/F;return(G=G||Object.create(null)).progress=function(j,H,U,X){return X>=1?j:X%V>V/2?255:0},this.to(k,{opacity:1},G)}});var A=[];function O(k){return function(){A.length=0;for(var F=arguments.length,G=0;G<F;G++){var V=A[G]=arguments[G];V instanceof B&&(A[G]=V._union())}return k.apply(this,A)}}for(var R={to:function(k,F,G){return(G=G||Object.create(null)).relative=!1,new _(k,F,G)},by:function(k,F,G){return(G=G||Object.create(null)).relative=!0,new _(k,F,G)},set:function(k){return new w(k)},delay:cc.delayTime,call:cc.callFunc,hide:cc.hide,show:cc.show,removeSelf:cc.removeSelf,sequence:O(cc.sequence),parallel:O(cc.spawn)},P={repeat:cc.repeat,repeatForever:cc.repeatForever,reverseTime:cc.reverseTime},E=Object.keys(R),D=function(k){var F=E[k];B.prototype[F]=function(){var G=R[F].apply(this,arguments);return this._actions.push(G),this}},I=0;I<E.length;I++)D(I);E=Object.keys(P);for(var M=function(k){var F=E[k];B.prototype[F]=function(){var G=this._actions,V=arguments[arguments.length-1],j=arguments.length-1;V instanceof cc.Tween?V=V._union():V instanceof cc.Action||(V=G[G.length-1],G.length-=1,j+=1);for(var H=[V],U=0;U<j;U++)H.push(arguments[U]);return V=P[F].apply(this,H),G.push(V),this}},N=0;N<E.length;N++)M(N);cc.tween=function(k){return new B(k)},cc.Tween=B},{"../animation/bezier":14}],9:[function(L,S){var T=cc.js,_=L("./playable"),w=L("./animation-curves"),B=w.EventAnimCurve,A=w.EventInfo,O=L("./types").WrapModeMask,R=L("../core/utils/binary-search").binarySearchEpsilon;function P(I,M){_.call(this),this.target=I,this.animation=M,this._anims=new T.array.MutableForwardIterator([])}T.extend(P,_);var E=P.prototype;function D(I,M){var N=M.clip;M.duration=N.duration,M.speed=N.speed,M.wrapMode=N.wrapMode,M.frameRate=N.sample,(M.wrapMode&O.Loop)===O.Loop?M.repeatCount=1/0:M.repeatCount=1;var k=M.curves=N.createCurves(M,I),F=N.events;if(F)for(var G,V=0,j=F.length;V<j;V++){G||((G=new B).target=I,k.push(G));var H=F[V],U=H.frame/M.duration,X=void 0,Y=R(G.ratios,U);Y>=0?X=G.events[Y]:(X=new A,G.ratios.push(U),G.events.push(X)),X.add(H.func,H.params)}}E.playState=function(I,M){I.clip&&(I.curveLoaded||D(this.target,I),I.animator=this,I.play(),typeof M=="number"&&I.setTime(M),this.play())},E.stopStatesExcept=function(I){var M=this._anims,N=M.array;for(M.i=0;M.i<N.length;++M.i){var k=N[M.i];k!==I&&this.stopState(k)}},E.addAnimation=function(I){this._anims.array.indexOf(I)===-1&&this._anims.push(I),I._setEventTarget(this.animation)},E.removeAnimation=function(I){var M=this._anims.array.indexOf(I);M>=0?(this._anims.fastRemoveAt(M),this._anims.array.length===0&&this.stop()):cc.errorID(3907),I.animator=null},E.sample=function(){var I=this._anims,M=I.array;for(I.i=0;I.i<M.length;++I.i)M[I.i].sample()},E.stopState=function(I){I&&I.stop()},E.pauseState=function(I){I&&I.pause()},E.resumeState=function(I){I&&I.resume(),this.isPaused&&this.resume()},E.setStateTime=function(I,M){if(M!==void 0)I&&(I.setTime(M),I.sample());else{M=I;for(var N=this._anims.array,k=0;k<N.length;++k){var F=N[k];F.setTime(M),F.sample()}}},E.onStop=function(){var I=this._anims,M=I.array;for(I.i=0;I.i<M.length;++I.i)M[I.i].stop()},E.onPause=function(){for(var I=this._anims.array,M=0;M<I.length;++M){var N=I[M];N.pause(),N.animator=null}},E.onResume=function(){for(var I=this._anims.array,M=0;M<I.length;++M){var N=I[M];N.animator=this,N.resume()}},E._reloadClip=function(I){D(this.target,I)},S.exports=P},{"../core/utils/binary-search":264,"./animation-curves":11,"./playable":18,"./types":19}],10:[function(L,S){var T=L("./types").WrapMode,_=L("./animation-curves"),w=_.DynamicAnimCurve,B=_.quickFindIndex,A=L("./motion-path-helper").sampleMotionPaths,O=L("../core/utils/binary-search").binarySearchEpsilon,R=cc.Class({name:"cc.AnimationClip",extends:cc.Asset,properties:{_duration:{default:0,type:cc.Float},duration:{get:function(){return this._duration}},sample:{default:60},speed:{default:1},wrapMode:{default:T.Normal},curveData:{default:{},visible:!1},events:{default:[],visible:!1}},statics:{createWithSpriteFrames:function(P,E){if(!Array.isArray(P))return cc.errorID(3905),null;var D=new R;D.sample=E||D.sample,D._duration=P.length/D.sample;for(var I=[],M=1/D.sample,N=0,k=P.length;N<k;N++)I[N]={frame:N*M,value:P[N]};return D.curveData={comps:{"cc.Sprite":{spriteFrame:I}}},D}},onLoad:function(){this._duration=Number.parseFloat(this.duration),this.speed=Number.parseFloat(this.speed),this.wrapMode=Number.parseInt(this.wrapMode),this.frameRate=Number.parseFloat(this.sample)},createPropCurve:function(P,E,D){var I=[],M=P instanceof cc.Node&&E==="position",N=new w;N.target=P,N.prop=E;for(var k=0,F=D.length;k<F;k++){var G=D[k],V=G.frame/this.duration;N.ratios.push(V),M&&I.push(G.motionPath);var j=G.value;N.values.push(j);var H=G.curve;if(H){if(typeof H=="string"){N.types.push(H);continue}if(Array.isArray(H)){H[0]===H[1]&&H[2]===H[3]?N.types.push(w.Linear):N.types.push(w.Bezier(H));continue}}N.types.push(w.Linear)}M&&A(I,N,this.duration,this.sample,P);for(var U,X,Y=N.ratios,z=!0,W=1,Z=Y.length;W<Z;W++)if(U=Y[W]-Y[W-1],W===1)X=U;else if(Math.abs(U-X)>1e-6){z=!1;break}N._findFrameIndex=z?B:O;var Q=N.values[0];return Q==null||N._lerp||(typeof Q=="number"?N._lerp=w.prototype._lerpNumber:Q instanceof cc.Quat?N._lerp=w.prototype._lerpQuat:Q instanceof cc.Vec2?N._lerp=w.prototype._lerpVector2:Q instanceof cc.Vec3?N._lerp=w.prototype._lerpVector3:Q.lerp&&(N._lerp=w.prototype._lerpObject)),N},createTargetCurves:function(P,E,D){var I=E.props,M=E.comps;if(I)for(var N in I){var k=I[N],F=this.createPropCurve(P,N,k);D.push(F)}if(M)for(var G in M){var V=P.getComponent(G);if(V){var j=M[G];for(var H in j){var U=j[H],X=this.createPropCurve(V,H,U);D.push(X)}}}},createCurves:function(P,E){var D=this.curveData,I=D.paths,M=[];for(var N in this.createTargetCurves(E,D,M),I){var k=cc.find(N,E);if(k){var F=I[N];this.createTargetCurves(k,F,M)}}return M}});cc.AnimationClip=S.exports=R},{"../core/utils/binary-search":264,"./animation-curves":11,"./motion-path-helper":17,"./types":19}],11:[function(L,S){var T=L("./bezier").bezierByTime,_=L("../core/utils/binary-search").binarySearchEpsilon,w=L("./types").WrapModeMask,B=L("./types").WrappedInfo;function A(I,M){if(typeof M=="string"){var N=cc.easing[M];N?I=N(I):cc.errorID(3906,M)}else Array.isArray(M)&&(I=T(M,I));return I}var O=cc.Class({name:"cc.AnimCurve",sample:function(){},onTimeChangedManually:void 0}),R,P=cc.Class({name:"cc.DynamicAnimCurve",extends:O,ctor:function(){this._cachedIndex=0},properties:{target:null,prop:"",values:[],ratios:[],types:[]},_findFrameIndex:_,_lerp:void 0,_lerpNumber:function(I,M,N){return I+(M-I)*N},_lerpObject:function(I,M,N){return I.lerp(M,N)},_lerpQuat:(R=cc.quat(),function(I,M,N){return I.lerp(M,N,R)}),_lerpVector2:function(){var I=cc.v2();return function(M,N,k){return M.lerp(N,k,I)}}(),_lerpVector3:function(){var I=cc.v3();return function(M,N,k){return M.lerp(N,k,I)}}(),sample:function(I,M){var N=this.values,k=this.ratios,F=k.length;if(F!==0){var G,V=!0,j=this._cachedIndex;if(j<0&&(j=~j)>0&&j<k.length){var H=k[j-1],U=k[j];M>H&&M<U&&(V=!1)}V&&(this._cachedIndex=this._findFrameIndex(k,M));var X=this._cachedIndex;if(X<0)if((X=~X)<=0)G=N[0];else if(X>=F)G=N[F-1];else{var Y=N[X-1];if(this._lerp){var z=k[X-1],W=k[X],Z=this.types[X-1],Q=(M-z)/(W-z);Z&&(Q=A(Q,Z));var ee=N[X];G=this._lerp(Y,ee,Q)}else G=Y}else G=N[X];this.target[this.prop]=G}}});P.Linear=null,P.Bezier=function(I){return I};var E=function(){this.events=[]};E.prototype.add=function(I,M){this.events.push({func:I||"",params:M||[]})};var D=cc.Class({name:"cc.EventAnimCurve",extends:O,properties:{target:null,ratios:[],events:[],_wrappedInfo:{default:function(){return new B}},_lastWrappedInfo:null,_ignoreIndex:NaN},_wrapIterations:function(I){return I-(0|I)==0&&(I-=1),0|I},sample:function(I,M,N){var k=this.ratios.length,F=N.getWrappedInfo(N.time,this._wrappedInfo),G=F.direction,V=_(this.ratios,F.ratio);if(V<0&&(V=~V-1,G<0&&(V+=1)),this._ignoreIndex!==V&&(this._ignoreIndex=NaN),F.frameIndex=V,!this._lastWrappedInfo)return this._fireEvent(V),void(this._lastWrappedInfo=new B(F));var j=N.wrapMode,H=this._wrapIterations(F.iterations),U=this._lastWrappedInfo,X=this._wrapIterations(U.iterations),Y=U.frameIndex,z=U.direction,W=X!==-1&&H!==X;if(Y===V&&W&&k===1)this._fireEvent(0);else if(Y!==V||W){G=z;do{if(Y!==V&&(G===-1&&Y===0&&V>0?((j&w.PingPong)===w.PingPong?G*=-1:Y=k,X++):G===1&&Y===k-1&&V<k-1&&((j&w.PingPong)===w.PingPong?G*=-1:Y=-1,X++),Y===V||X>H))break;Y+=G,cc.director.getAnimationManager().pushDelayEvent(this,"_fireEvent",[Y])}while(Y!==V&&Y>-1&&Y<k)}this._lastWrappedInfo.set(F)},_fireEvent:function(I){if(!(I<0||I>=this.events.length||this._ignoreIndex===I)){var M=this.events[I].events;if(this.target.isValid)for(var N=this.target._components,k=0;k<M.length;k++)for(var F=M[k],G=F.func,V=0;V<N.length;V++){var j=N[V],H=j[G];H&&H.apply(j,F.params)}}},onTimeChangedManually:function(I,M){this._lastWrappedInfo=null,this._ignoreIndex=NaN;var N=M.getWrappedInfo(I,this._wrappedInfo),k=N.direction,F=_(this.ratios,N.ratio);F<0&&(F=~F-1,k<0&&(F+=1),this._ignoreIndex=F)}});S.exports={AnimCurve:O,DynamicAnimCurve:P,EventAnimCurve:D,EventInfo:E,computeRatioByType:A,quickFindIndex:function(I,M){var N=I.length-1;if(N===0)return 0;var k=I[0];if(M<k)return 0;var F=I[N];if(M>F)return~I.length;var G=(M=(M-k)/(F-k))/(1/N),V=0|G;return G-V<1e-6?V:V+1-G<1e-6?V+1:~(V+1)}}},{"../core/utils/binary-search":264,"./bezier":14,"./types":19}],12:[function(L,S){var T=cc.js,_=cc.Class({ctor:function(){this._anims=new T.array.MutableForwardIterator([]),this._delayEvents=[],cc.director._scheduler&&cc.director._scheduler.enableForTarget(this)},update:function(w){var B=this._anims,A=B.array;for(B.i=0;B.i<A.length;++B.i){var O=A[B.i];O._isPlaying&&!O._isPaused&&O.update(w)}for(var R=this._delayEvents,P=0;P<R.length;P++){var E=R[P];E.target[E.func].apply(E.target,E.args)}R.length=0},destruct:function(){},addAnimation:function(w){this._anims.array.indexOf(w)===-1&&this._anims.push(w)},removeAnimation:function(w){var B=this._anims.array.indexOf(w);B>=0?this._anims.fastRemoveAt(B):cc.errorID(3907)},pushDelayEvent:function(w,B,A){this._delayEvents.push({target:w,func:B,args:A})}});cc.AnimationManager=S.exports=_},{}],13:[function(L,S){var T=cc.js,_=L("./playable"),w=L("./types"),B=w.WrappedInfo,A=w.WrapMode,O=w.WrapModeMask;function R(I,M){_.call(this),this._currentFramePlayed=!1,this._delay=0,this._delayTime=0,this._wrappedInfo=new B,this._lastWrappedInfo=null,this._process=E,this._clip=I,this._name=M||I&&I.name,this.animator=null,this.curves=[],this.delay=0,this.repeatCount=1,this.duration=1,this.speed=1,this.wrapMode=A.Normal,this.time=0,this._target=null,this._lastframeEventOn=!1,this.emit=function(){for(var N=new Array(arguments.length),k=0,F=N.length;k<F;k++)N[k]=arguments[k];cc.director.getAnimationManager().pushDelayEvent(this,"_emit",N)}}T.extend(R,_);var P=R.prototype;function E(){var I,M=this.sample();this._lastframeEventOn&&(I=this._lastWrappedInfo?this._lastWrappedInfo:this._lastWrappedInfo=new B(M),this.repeatCount>1&&(0|M.iterations)>(0|I.iterations)&&this.emit("lastframe",this),I.set(M)),M.stopped&&(this.stop(),this.emit("finished",this))}function D(){var I=this.time,M=this.duration;I>M?(I%=M)==0&&(I=M):I<0&&(I%=M)!=0&&(I+=M);for(var N=I/M,k=this.curves,F=0,G=k.length;F<G;F++)k[F].sample(I,N,this);this._lastframeEventOn&&(this._lastIterations===void 0&&(this._lastIterations=N),(this.time>0&&this._lastIterations>N||this.time<0&&this._lastIterations<N)&&this.emit("lastframe",this),this._lastIterations=N)}P._emit=function(I,M){this._target&&this._target.isValid&&this._target.emit(I,I,M)},P.on=function(I,M,N){return this._target&&this._target.isValid?(I==="lastframe"&&(this._lastframeEventOn=!0),this._target.on(I,M,N)):null},P.once=function(I,M,N){if(this._target&&this._target.isValid){I==="lastframe"&&(this._lastframeEventOn=!0);var k=this;return this._target.once(I,function(F){M.call(N,F),k._lastframeEventOn=!1})}return null},P.off=function(I,M,N){this._target&&this._target.isValid&&(I==="lastframe"&&(this._target.hasEventListener(I)||(this._lastframeEventOn=!1)),this._target.off(I,M,N))},P._setEventTarget=function(I){this._target=I},P.onPlay=function(){this.setTime(0),this._delayTime=this._delay,cc.director.getAnimationManager().addAnimation(this),this.animator&&this.animator.addAnimation(this),this.emit("play",this)},P.onStop=function(){this.isPaused||cc.director.getAnimationManager().removeAnimation(this),this.animator&&this.animator.removeAnimation(this),this.emit("stop",this)},P.onResume=function(){cc.director.getAnimationManager().addAnimation(this),this.emit("resume",this)},P.onPause=function(){cc.director.getAnimationManager().removeAnimation(this),this.emit("pause",this)},P.setTime=function(I){this._currentFramePlayed=!1,this.time=I||0;for(var M=this.curves,N=0,k=M.length;N<k;N++){var F=M[N];F.onTimeChangedManually&&F.onTimeChangedManually(I,this)}},P.update=function(I){this._delayTime>0&&(this._delayTime-=I,this._delayTime>0)||(this._currentFramePlayed?this.time+=I*this.speed:this._currentFramePlayed=!0,this._process())},P._needRevers=function(I){var M=this.wrapMode,N=!1;return(M&O.PingPong)===O.PingPong&&(I-(0|I)==0&&I>0&&(I-=1),1&I&&(N=!N)),(M&O.Reverse)===O.Reverse&&(N=!N),N},P.getWrappedInfo=function(I,M){M=M||new B;var N=!1,k=this.duration,F=this.repeatCount,G=I>0?I/k:-I/k;if(G>=F){G=F,N=!0;var V=F-(0|F);V===0&&(V=1),I=V*k*(I>0?1:-1)}if(I>k){var j=I%k;I=j===0?k:j}else I<0&&(I%=k)!=0&&(I+=k);var H=!1,U=this._wrapMode&O.ShouldWrap;U&&(H=this._needRevers(G));var X=H?-1:1;return this.speed<0&&(X*=-1),U&&H&&(I=k-I),M.ratio=I/k,M.time=I,M.direction=X,M.stopped=N,M.iterations=G,M},P.sample=function(){for(var I=this.getWrappedInfo(this.time,this._wrappedInfo),M=this.curves,N=0,k=M.length;N<k;N++)M[N].sample(I.time,I.ratio,this);return I},T.get(P,"clip",function(){return this._clip}),T.get(P,"name",function(){return this._name}),T.obsolete(P,"AnimationState.length","duration"),T.getset(P,"curveLoaded",function(){return this.curves.length>0},function(){this.curves.length=0}),T.getset(P,"wrapMode",function(){return this._wrapMode},function(I){this._wrapMode=I,this.time=0,I&O.Loop?this.repeatCount=1/0:this.repeatCount=1}),T.getset(P,"repeatCount",function(){return this._repeatCount},function(I){this._repeatCount=I;var M=this._wrapMode&O.ShouldWrap,N=(this.wrapMode&O.Reverse)===O.Reverse;this._process=I!==1/0||M||N?E:D}),T.getset(P,"delay",function(){return this._delay},function(I){this._delayTime=this._delay=I}),cc.AnimationState=S.exports=R},{"./playable":18,"./types":19}],14:[function(L,S){var T=Math.cos,_=Math.acos,w=Math.max,B=2*Math.PI,A=Math.sqrt;function O(P){return P<0?-Math.pow(-P,1/3):Math.pow(P,1/3)}function R(P,E){var D,I,M,N,k=E-0,F=E-P[0],G=3*k,V=3*F,j=3*(E-P[2]),H=1/(-k+V-j+(E-1)),U=(G-6*F+j)*H,X=U*(1/3),Y=(-G+V)*H,z=1/3*(3*Y-U*U),W=z*(1/3),Z=(2*U*U*U-9*U*Y+k*H*27)/27,Q=Z/2,ee=Q*Q+W*W*W;if(ee<0){var te=.3333333333333333*-z,re=A(te*te*te),ie=-Z/(2*re),ne=_(ie<-1?-1:ie>1?1:ie),he=2*O(re);return I=he*T(ne*(1/3))-X,M=he*T((ne+B)*(1/3))-X,N=he*T((ne+2*B)*(1/3))-X,0<=I&&I<=1?0<=M&&M<=1?0<=N&&N<=1?w(I,M,N):w(I,M):0<=N&&N<=1?w(I,N):I:0<=M&&M<=1?0<=N&&N<=1?w(M,N):M:N}if(ee===0)return M=-(D=Q<0?O(-Q):-O(Q))-X,0<=(I=2*D-X)&&I<=1?0<=M&&M<=1?w(I,M):I:M;var pe=A(ee);return(D=O(-Q+pe))-O(Q+pe)-X}S.exports={bezier:function(P,E,D,I,M){var N=1-M;return N*(N*(P+(3*E-P)*M)+3*D*M*M)+I*M*M*M},bezierByTime:function(P,E){var D=R(P,E),I=P[1];return((1-D)*(I+(P[3]-I)*D)*3+D*D)*D}}},{}],15:[function(L,S){var T={constant:function(){return 0},linear:function(w){return w},quadIn:function(w){return w*w},quadOut:function(w){return w*(2-w)},quadInOut:function(w){return(w*=2)<1?.5*w*w:-.5*(--w*(w-2)-1)},cubicIn:function(w){return w*w*w},cubicOut:function(w){return--w*w*w+1},cubicInOut:function(w){return(w*=2)<1?.5*w*w*w:.5*((w-=2)*w*w+2)},quartIn:function(w){return w*w*w*w},quartOut:function(w){return 1- --w*w*w*w},quartInOut:function(w){return(w*=2)<1?.5*w*w*w*w:-.5*((w-=2)*w*w*w-2)},quintIn:function(w){return w*w*w*w*w},quintOut:function(w){return--w*w*w*w*w+1},quintInOut:function(w){return(w*=2)<1?.5*w*w*w*w*w:.5*((w-=2)*w*w*w*w+2)},sineIn:function(w){return 1-Math.cos(w*Math.PI/2)},sineOut:function(w){return Math.sin(w*Math.PI/2)},sineInOut:function(w){return .5*(1-Math.cos(Math.PI*w))},expoIn:function(w){return w===0?0:Math.pow(1024,w-1)},expoOut:function(w){return w===1?1:1-Math.pow(2,-10*w)},expoInOut:function(w){return w===0?0:w===1?1:(w*=2)<1?.5*Math.pow(1024,w-1):.5*(2-Math.pow(2,-10*(w-1)))},circIn:function(w){return 1-Math.sqrt(1-w*w)},circOut:function(w){return Math.sqrt(1- --w*w)},circInOut:function(w){return(w*=2)<1?-.5*(Math.sqrt(1-w*w)-1):.5*(Math.sqrt(1-(w-=2)*w)+1)},elasticIn:function(w){var B,A=.1;return w===0?0:w===1?1:(!A||A<1?(A=1,B=.1):B=.4*Math.asin(1/A)/(2*Math.PI),-A*Math.pow(2,10*(w-=1))*Math.sin(2*(w-B)*Math.PI/.4))},elasticOut:function(w){var B,A=.1;return w===0?0:w===1?1:(!A||A<1?(A=1,B=.1):B=.4*Math.asin(1/A)/(2*Math.PI),A*Math.pow(2,-10*w)*Math.sin(2*(w-B)*Math.PI/.4)+1)},elasticInOut:function(w){var B,A=.1;return w===0?0:w===1?1:(!A||A<1?(A=1,B=.1):B=.4*Math.asin(1/A)/(2*Math.PI),(w*=2)<1?A*Math.pow(2,10*(w-=1))*Math.sin(2*(w-B)*Math.PI/.4)*-.5:A*Math.pow(2,-10*(w-=1))*Math.sin(2*(w-B)*Math.PI/.4)*.5+1)},backIn:function(w){var B=1.70158;return w*w*((B+1)*w-B)},backOut:function(w){var B=1.70158;return--w*w*((B+1)*w+B)+1},backInOut:function(w){var B=2.5949095;return(w*=2)<1?w*w*((B+1)*w-B)*.5:.5*((w-=2)*w*((B+1)*w+B)+2)},bounceIn:function(w){return 1-T.bounceOut(1-w)},bounceOut:function(w){return w<.36363636363636365?7.5625*w*w:w<.7272727272727273?7.5625*(w-=.5454545454545454)*w+.75:w<.9090909090909091?7.5625*(w-=.8181818181818182)*w+.9375:7.5625*(w-=.9545454545454546)*w+.984375},bounceInOut:function(w){return w<.5?.5*T.bounceIn(2*w):.5*T.bounceOut(2*w-1)+.5},smooth:function(w){return w<=0?0:w>=1?1:w*w*(3-2*w)},fade:function(w){return w<=0?0:w>=1?1:w*w*w*(w*(6*w-15)+10)}};function _(w,B){return function(A){return A<.5?B(2*A)/2:w(2*A-1)/2+.5}}T.quadOutIn=_(T.quadIn,T.quadOut),T.cubicOutIn=_(T.cubicIn,T.cubicOut),T.quartOutIn=_(T.quartIn,T.quartOut),T.quintOutIn=_(T.quintIn,T.quintOut),T.sineOutIn=_(T.sineIn,T.sineOut),T.expoOutIn=_(T.expoIn,T.expoOut),T.circOutIn=_(T.circIn,T.circOut),T.backOutIn=_(T.backIn,T.backOut),T.bounceIn=function(w){return 1-T.bounceOut(1-w)},T.bounceInOut=function(w){return w<.5?.5*T.bounceIn(2*w):.5*T.bounceOut(2*w-1)+.5},T.bounceOutIn=_(T.bounceIn,T.bounceOut),cc.easing=S.exports=T},{}],16:[function(L){L("./bezier"),L("./easing"),L("./types"),L("./motion-path-helper"),L("./animation-curves"),L("./animation-clip"),L("./animation-manager"),L("./animation-state"),L("./animation-animator")},{"./animation-animator":9,"./animation-clip":10,"./animation-curves":11,"./animation-manager":12,"./animation-state":13,"./bezier":14,"./easing":15,"./motion-path-helper":17,"./types":19}],17:[function(L,S){var T=L("./animation-curves").DynamicAnimCurve,_=L("./animation-curves").computeRatioByType,w=L("./bezier").bezier,B=L("../core/utils/binary-search").binarySearchEpsilon,A=cc.v2;function O(E){this.points=E||[],this.beziers=[],this.ratios=[],this.progresses=[],this.length=0,this.computeBeziers()}function R(){this.start=A(),this.end=A(),this.startCtrlPoint=A(),this.endCtrlPoint=A()}function P(E){if(!Array.isArray(E))return!1;for(var D=0,I=E.length;D<I;D++){var M=E[D];if(!Array.isArray(M)||M.length!==6)return!1}return!0}O.prototype.computeBeziers=function(){var E;this.beziers.length=0,this.ratios.length=0,this.progresses.length=0,this.length=0;for(var D=1;D<this.points.length;D++){var I=this.points[D-1],M=this.points[D];(E=new R).start=I.pos,E.startCtrlPoint=I.out,E.end=M.pos,E.endCtrlPoint=M.in,this.beziers.push(E),this.length+=E.getLength()}var N=0;for(D=0;D<this.beziers.length;D++)E=this.beziers[D],this.ratios[D]=E.getLength()/this.length,this.progresses[D]=N+=this.ratios[D];return this.beziers},R.prototype.getPointAt=function(E){var D=this.getUtoTmapping(E);return this.getPoint(D)},R.prototype.getPoint=function(E){var D=w(this.start.x,this.startCtrlPoint.x,this.endCtrlPoint.x,this.end.x,E),I=w(this.start.y,this.startCtrlPoint.y,this.endCtrlPoint.y,this.end.y,E);return new A(D,I)},R.prototype.getLength=function(){var E=this.getLengths();return E[E.length-1]},R.prototype.getLengths=function(E){if(E||(E=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===E+1)return this.cacheArcLengths;var D,I,M=[],N=this.getPoint(0),k=A(),F=0;for(M.push(0),I=1;I<=E;I++)D=this.getPoint(I/E),k.x=N.x-D.x,k.y=N.y-D.y,F+=k.mag(),M.push(F),N=D;return this.cacheArcLengths=M,M},R.prototype.getUtoTmapping=function(E,D){var I,M=this.getLengths(),N=0,k=M.length;I=D||E*M[k-1];for(var F,G=0,V=k-1;G<=V;)if((F=M[N=Math.floor(G+(V-G)/2)]-I)<0)G=N+1;else{if(!(F>0)){V=N;break}V=N-1}if(M[N=V]===I)return N/(k-1);var j=M[N];return(N+(I-j)/(M[N+1]-j))/(k-1)},S.exports={sampleMotionPaths:function(E,D,I,M,N){function k(be){return be instanceof cc.Vec2?{in:be,pos:be,out:be}:Array.isArray(be)&&be.length===6?{in:A(be[2],be[3]),pos:A(be[0],be[1]),out:A(be[4],be[5])}:{in:cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}var F=D.values=D.values.map(function(be){return Array.isArray(be)&&(be=be.length===2?cc.v2(be[0],be[1]):cc.v3(be[0],be[1],be[2])),be});if(E.length!==0&&F.length!==0){for(var G=!1,V=0;V<E.length;V++){var j=E[V];if(j&&!P(j)&&(cc.errorID(3904,N?N.name:"","position",V),j=null),j&&j.length>0){G=!0;break}}if(G&&F.length!==1){for(var H=D.types,U=D.ratios,X=D.values=[],Y=D.types=[],z=D.ratios=[],W=0,Z=T.Linear,Q=0,ee=E.length;Q<ee-1;Q++){var te,re=E[Q],ie=U[Q],ne=U[Q+1]-ie,he=F[Q],pe=F[Q+1],K=H[Q],ue=[],le=W/ne,ce=1/(ne*I*M);if(re&&re.length>0){var _e=[];_e.push(k(he));for(var oe=0,de=re.length;oe<de;oe++){var me=k(re[oe]);_e.push(me)}_e.push(k(pe));var ye=new O(_e);ye.computeBeziers();for(var ge=ye.progresses;1-le>1e-6;){var we,Te,Ee,De;if((te=_(te=le,K))<0)De=(0-te)*(Te=ye.beziers[0]).getLength(),Ee=Te.start.sub(Te.endCtrlPoint).normalize(),we=Te.start.add(Ee.mul(De));else if(te>1)De=(te-1)*(Te=ye.beziers[ye.beziers.length-1]).getLength(),Ee=Te.end.sub(Te.startCtrlPoint).normalize(),we=Te.end.add(Ee.mul(De));else{var fe=B(ge,te);fe<0&&(fe=~fe),te-=fe>0?ge[fe-1]:0,te/=ye.ratios[fe],we=ye.beziers[fe].getPointAt(te)}ue.push(we),le+=ce}}else for(;1-le>1e-6;)te=_(te=le,K),ue.push(he.lerp(pe,te)),le+=ce;for(Z=K==="constant"?K:T.Linear,oe=0,de=ue.length;oe<de;oe++){var Ce=ie+W+ce*oe*ne;Se(ue[oe],Z,Ce)}W=Math.abs(le-1)>1e-6?(le-1)*ne:0}U[U.length-1]!==z[z.length-1]&&Se(F[F.length-1],Z,U[U.length-1])}}function Se(be,Re,Ve){X.push(be),Y.push(Re),z.push(Ve)}},Curve:O,Bezier:R}},{"../core/utils/binary-search":264,"./animation-curves":11,"./bezier":14}],18:[function(L,S){var T=cc.js,_=L("../core/CCDebug");function w(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var B=w.prototype;T.get(B,"isPlaying",function(){return this._isPlaying},!0),T.get(B,"isPaused",function(){return this._isPaused},!0);var A=function(){};B.onPlay=A,B.onPause=A,B.onResume=A,B.onStop=A,B.onError=A,B.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError(_.getError(3912)):(this._isPlaying=!0,this.onPlay())},B.stop=function(){this._isPlaying&&(this._isPlaying=!1,this.onStop(),this._isPaused=!1)},B.pause=function(){this._isPlaying&&!this._isPaused&&(this._isPaused=!0,this.onPause())},B.resume=function(){this._isPlaying&&this._isPaused&&(this._isPaused=!1,this.onResume())},B.step=function(){this.pause(),this._stepOnce=!0,this._isPlaying||this.play()},S.exports=w},{"../core/CCDebug":26}],19:[function(L,S){var T={Loop:2,ShouldWrap:4,PingPong:22,Reverse:36},_=cc.Enum({Default:0,Normal:1,Reverse:T.Reverse,Loop:T.Loop,LoopReverse:T.Loop|T.Reverse,PingPong:T.PingPong,PingPongReverse:T.PingPong|T.Reverse});function w(B){B?this.set(B):(this.ratio=0,this.time=0,this.direction=1,this.stopped=!0,this.iterations=0,this.frameIndex=void 0)}cc.WrapMode=_,w.prototype.set=function(B){this.ratio=B.ratio,this.time=B.time,this.direction=B.direction,this.stopped=B.stopped,this.iterations=B.iterations,this.frameIndex=B.frameIndex},S.exports={WrapModeMask:T,WrapMode:_,WrappedInfo:w}},{}],20:[function(L,S){var T,_,w=L("../core/event/event-target"),B=L("../core/platform/CCSys"),A=L("../core/assets/CCAudioClip").LoadMode,O=!1,R=[],P=function D(I){w.call(this),this._shouldRecycleOnEnded=!1,this._src=I,this._element=null,this.id=0,this._state=D.State.INITIALZING;var M=this;this._onended=function(){M._state=D.State.STOPPED,M.emit("ended")},this._onendedSecond=function(){M._unbindEnded(M._onendedSecond),M._bindEnded()}};cc.js.extend(P,w),P.State={ERROR:-1,INITIALZING:0,PLAYING:1,PAUSED:2,STOPPED:3},(T=P.prototype)._bindEnded=function(D){if(!(D=D||this._onended)._binded){D._binded=!0;var I=this._element;this._src&&I instanceof HTMLAudioElement?I.addEventListener("ended",D):I.onended=D}},T._unbindEnded=function(D){if((D=D||this._onended)._binded){D._binded=!1;var I=this._element;I instanceof HTMLAudioElement?I.removeEventListener("ended",D):I&&(I.onended=null)}},T._onLoaded=function(){this._createElement(),this._state=P.State.INITIALZING,this.setVolume(1),this.setLoop(!1)},T._createElement=function(){var D=this._src._nativeAsset;D instanceof HTMLAudioElement?(this._element||(this._element=document.createElement("audio")),this._element.src=D.src):this._element=new E(D,this)},T.play=function(){var D=this;this._src&&this._src._ensureLoaded(function(){D._state=P.State.PLAYING,D._bindEnded();var I=D._element.play();window.Promise&&I instanceof Promise&&I.catch(function(){}),D._touchToPlay()})},T._touchToPlay=function(){if(this._src&&this._src.loadMode===A.DOM_AUDIO&&this._element.paused&&R.push({instance:this,offset:0,audio:this._element}),!O){O=!0;var D="ontouchend"in window?"touchend":"mousedown";cc.game.canvas.addEventListener(D,function(){for(var I;I=R.pop();)I.audio.play(I.offset)})}},T.destroy=function(){this._element=null},T.pause=function(){if(this.getState()===P.State.PLAYING){var D=this;this._src&&this._src._ensureLoaded(function(){D._unbindEnded(),D._element.pause(),D._state=P.State.PAUSED})}},T.resume=function(){if(this.getState()===P.State.PAUSED){var D=this;this._src&&this._src._ensureLoaded(function(){D._bindEnded(),D._element.play(),D._state=P.State.PLAYING})}},T.stop=function(){var D=this;this._src&&this._src._ensureLoaded(function(){D._element.pause(),D._element.currentTime=0;for(var I=0;I<R.length;I++)if(R[I].instance===D){R.splice(I,1);break}D._unbindEnded(),D.emit("stop"),D._state=P.State.STOPPED})},T.setLoop=function(D){var I=this;this._src&&this._src._ensureLoaded(function(){I._element.loop=D})},T.getLoop=function(){return!!this._element&&this._element.loop},T.setVolume=function(D){var I=this;this._src&&this._src._ensureLoaded(function(){I._element.volume=D})},T.getVolume=function(){return this._element?this._element.volume:1},T.setCurrentTime=function(D){var I=this;this._src&&this._src._ensureLoaded(function(){I._unbindEnded(),I._bindEnded(I._onendedSecond),I._element.currentTime=D})},T.getCurrentTime=function(){return this._element?this._element.currentTime:0},T.getDuration=function(){return this._src?this._src.duration:0},T.getState=function(D){return D===void 0&&(D=!0),D&&this._forceUpdatingState(),this._state},T._forceUpdatingState=function(){var D=this._element;D&&(P.State.PLAYING===this._state&&D.paused?this._state=P.State.STOPPED:P.State.STOPPED!==this._state||D.paused||(this._state=P.State.PLAYING))},Object.defineProperty(T,"src",{get:function(){return this._src},set:function(D){if(this._unbindEnded(),D&&D.isValid){if(D!==this._src)if(this._src=D,D.loaded)this._onLoaded();else{var I=this;D.once("load",function(){D===I._src&&I._onLoaded()})}}else this._src=null,this._element instanceof E?this._element=null:this._element&&(this._element.src=""),this._state=P.State.INITIALZING},enumerable:!0,configurable:!0}),Object.defineProperty(T,"paused",{get:function(){return!this._element||this._element.paused},enumerable:!0,configurable:!0}),_=cc.sys.browserType===cc.sys.BROWSER_TYPE_EDGE||cc.sys.browserType===cc.sys.BROWSER_TYPE_BAIDU||cc.sys.browserType===cc.sys.BROWSER_TYPE_UC?.01:0;var E=function(D,I){this._audio=I,this._context=B.__audioSupport.context,this._buffer=D,this._gainObj=this._context.createGain(),this.volume=1,this._gainObj.connect(this._context.destination),this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currentTimer=null,this._endCallback=(function(){this.onended&&this.onended(this)}).bind(this)};(function(D){D.play=function(I){this._currentSource&&!this.paused&&(this._currentSource.onended=null,this._currentSource.stop(0),this.playedLength=0);var M=this._context.createBufferSource();M.buffer=this._buffer,M.connect(this._gainObj),M.loop=this._loop,this._startTime=this._context.currentTime,(I=I||this.playedLength)&&(this._startTime-=I);var N,k=this._buffer.duration,F=I;if(this._loop?M.start?M.start(0,F):M.notoGrainOn?M.noteGrainOn(0,F):M.noteOn(0,F):(N=k-I,M.start?M.start(0,F,N):M.noteGrainOn?M.noteGrainOn(0,F,N):M.noteOn(0,F,N)),this._currentSource=M,M.onended=this._endCallback,(!M.context.state||M.context.state==="suspended")&&this._context.currentTime===0){var G=this;clearTimeout(this._currentTimer),this._currentTimer=setTimeout(function(){G._context.currentTime===0&&R.push({instance:G._audio,offset:I,audio:G})},10)}var V=cc.sys;V.os===V.OS_IOS&&V.isBrowser&&V.isMobile&&(M.context.state==="suspended"&&this._context.currentTime!==0||M.context.state==="interrupted")&&M.context.resume()},D.pause=function(){if(clearTimeout(this._currentTimer),!this.paused){this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration;var I=this._currentSource;I&&(I.onended&&(I.onended._binded=!1,I.onended=null),I.stop(0)),this._currentSource=null,this._startTime=-1}},Object.defineProperty(D,"paused",{get:function(){return(!this._currentSource||!this._currentSource.loop)&&(this._startTime===-1||this._context.currentTime-this._startTime>this._buffer.duration)},enumerable:!0,configurable:!0}),Object.defineProperty(D,"loop",{get:function(){return this._loop},set:function(I){this._currentSource&&(this._currentSource.loop=I),this._loop=I},enumerable:!0,configurable:!0}),Object.defineProperty(D,"volume",{get:function(){return this._volume},set:function(I){if(this._volume=I,this._gainObj.gain.setTargetAtTime)try{this._gainObj.gain.setTargetAtTime(I,this._context.currentTime,_)}catch(M){this._gainObj.gain.setTargetAtTime(I,this._context.currentTime,.01)}else this._gainObj.gain.value=I;B.os===B.OS_IOS&&!this.paused&&this._currentSource&&(this._currentSource.onended=null,this.pause(),this.play())},enumerable:!0,configurable:!0}),Object.defineProperty(D,"currentTime",{get:function(){return this.paused?this.playedLength:(this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration,this.playedLength)},set:function(I){this.paused?this.playedLength=I:(this.pause(),this.playedLength=I,this.play())},enumerable:!0,configurable:!0}),Object.defineProperty(D,"duration",{get:function(){return this._buffer.duration},enumerable:!0,configurable:!0})})(E.prototype),S.exports=cc._Audio=P},{"../core/assets/CCAudioClip":63,"../core/event/event-target":143,"../core/platform/CCSys":205}],21:[function(L,S){var T=L("./CCAudio"),_=L("../core/assets/CCAudioClip"),w=cc.js,B=0,A=w.createMap(!0),O={},R=[],P=function(N){N._shouldRecycleOnEnded&&(N._finishCallback=null,N.off("ended"),N.off("stop"),N.src=null,cc.sys.platform===cc.sys.ALIPAY_GAME?N.destroy():R.includes(N)||(R.length<M._maxPoolSize?R.push(N):N.destroy()),N._shouldRecycleOnEnded=!1)},E=function(N){var k=++B,F=O[N];if(F||(F=O[N]=[]),M._maxAudioInstance<=F.length){var G=F.shift();D(G).stop()}var V=R.pop()||new T,j=function(){if(D(this.id)){delete A[this.id];var H=F.indexOf(this.id);cc.js.array.fastRemoveAt(F,H)}P(this)};return V.on("ended",function(){this._finishCallback&&this._finishCallback(),this.getLoop()||j.call(this)},V),V.on("stop",j,V),V.id=k,A[k]=V,F.push(k),V},D=function(N){return A[N]},I=function(N){return N===void 0?N=1:typeof N=="string"&&(N=Number.parseFloat(N)),N},M={AudioState:T.State,_maxAudioInstance:24,_maxPoolSize:32,_id2audio:A,play:function(N,k,F){if(!(N instanceof _))return cc.error("Wrong type of AudioClip.");var G=N.nativeUrl,V=E(G);return V.src=N,N._ensureLoaded(),V._shouldRecycleOnEnded=!0,V.setLoop(k||!1),F=I(F),V.setVolume(F),V.play(),V.id},setLoop:function(N,k){var F=D(N);F&&F.setLoop&&F.setLoop(k)},isLoop:function(N){var k=D(N);return!(!k||!k.getLoop)&&k.getLoop()},setVolume:function(N,k){var F=D(N);F&&F.setVolume(k)},getVolume:function(N){var k=D(N);return k?k.getVolume():1},setCurrentTime:function(N,k){var F=D(N);return!!F&&(F.setCurrentTime(k),!0)},getCurrentTime:function(N){var k=D(N);return k?k.getCurrentTime():0},getDuration:function(N){var k=D(N);return k?k.getDuration():0},getState:function(N){var k=D(N);return k?k.getState():this.AudioState.ERROR},isPlaying:function(N){return this.getState(N)===this.AudioState.PLAYING},setFinishCallback:function(N,k){var F=D(N);F&&(F._finishCallback=k)},pause:function(N){var k=D(N);return!!k&&(k.pause(),!0)},_pauseIDCache:[],pauseAll:function(){for(var N in A){var k=A[N];k.getState()===T.State.PLAYING&&(this._pauseIDCache.push(N),k.pause())}},resume:function(N){var k=D(N);k&&k.resume()},resumeAll:function(){for(var N=0;N<this._pauseIDCache.length;++N){var k=this._pauseIDCache[N],F=D(k);F&&F.resume()}this._pauseIDCache.length=0},stop:function(N){var k=D(N);return!!k&&(k.stop(),!0)},stopAll:function(){for(var N in A){var k=A[N];k&&k.stop()}},setMaxAudioInstance:function(){},getMaxAudioInstance:function(){return this._maxAudioInstance},uncache:function(N){var k=N;if(typeof N=="string")cc.warnID(8401,"cc.audioEngine","cc.AudioClip","AudioClip","cc.AudioClip","audio"),k=N;else{if(!N)return;k=N.nativeUrl}var F=O[k];if(F)for(;F.length>0;){var G=F.pop(),V=A[G];V&&(V.stop(),delete A[G])}},uncacheAll:function(){var N;for(var k in this.stopAll(),A)(N=A[k])&&N.destroy();for(;N=R.pop();)N.destroy();A=w.createMap(!0),O={}},_breakCache:null,_break:function(){for(var N in this._breakCache=[],A){var k=A[N];k.getState()===T.State.PLAYING&&(this._breakCache.push(N),k.pause())}},_restore:function(){if(this._breakCache){for(;this._breakCache.length>0;){var N=this._breakCache.pop(),k=D(N);k&&k.resume&&k.resume()}this._breakCache=null}},_music:{id:-1,loop:!1,volume:1},_effect:{volume:1,pauseCache:[]},playMusic:function(N,k){var F=this._music;return this.stop(F.id),F.id=this.play(N,k,F.volume),F.loop=k,F.id},stopMusic:function(){this.stop(this._music.id)},pauseMusic:function(){return this.pause(this._music.id),this._music.id},resumeMusic:function(){return this.resume(this._music.id),this._music.id},getMusicVolume:function(){return this._music.volume},setMusicVolume:function(N){N=I(N);var k=this._music;return k.volume=N,this.setVolume(k.id,k.volume),k.volume},isMusicPlaying:function(){return this.getState(this._music.id)===this.AudioState.PLAYING},playEffect:function(N,k){return this.play(N,k||!1,this._effect.volume)},setEffectsVolume:function(N){N=I(N);var k=this._music.id;for(var F in this._effect.volume=N,A){var G=A[F];G&&G.id!==k&&M.setVolume(F,N)}},getEffectsVolume:function(){return this._effect.volume},pauseEffect:function(N){return this.pause(N)},pauseAllEffects:function(){var N=this._music.id,k=this._effect;for(var F in k.pauseCache.length=0,A){var G=A[F];G&&G.id!==N&&G.getState()===this.AudioState.PLAYING&&(k.pauseCache.push(F),G.pause())}},resumeEffect:function(N){this.resume(N)},resumeAllEffects:function(){for(var N=this._effect.pauseCache,k=0;k<N.length;++k){var F=N[k],G=A[F];G&&G.resume()}},stopEffect:function(N){return this.stop(N)},stopAllEffects:function(){var N=this._music.id;for(var k in A){var F=A[k];F&&F.id!==N&&F.getState()===M.AudioState.PLAYING&&F.stop()}}};S.exports=cc.audioEngine=M},{"../core/assets/CCAudioClip":63,"./CCAudio":20}],22:[function(L,S){var T={name:"Jacob__Codec"};T.Base64=L("./base64"),T.GZip=L("./gzip"),T.unzip=function(){return T.GZip.gunzip.apply(T.GZip,arguments)},T.unzipBase64=function(){var _=T.Base64.decode.apply(T.Base64,arguments);try{return T.GZip.gunzip.call(T.GZip,_)}catch(w){return _.slice(7)}},T.unzipBase64AsArray=function(_,w){w=w||1;var B,A,O,R=this.unzipBase64(_),P=[];for(B=0,O=R.length/w;B<O;B++)for(P[B]=0,A=w-1;A>=0;--A)P[B]+=R.charCodeAt(B*w+A)<<8*A;return P},T.unzipAsArray=function(_,w){w=w||1;var B,A,O,R=this.unzip(_),P=[];for(B=0,O=R.length/w;B<O;B++)for(P[B]=0,A=w-1;A>=0;--A)P[B]+=R.charCodeAt(B*w+A)<<8*A;return P},cc.codec=S.exports=T},{"./base64":23,"./gzip":24}],23:[function(L,S){var T=L("../core/utils/misc").BASE64_VALUES,_={name:"Jacob__Codec__Base64",decode:function(w){var B,A,O,R,P,E,D=[],I=0;for(w=w.replace(/[^A-Za-z0-9\+\/\=]/g,"");I<w.length;)B=T[w.charCodeAt(I++)]<<2|(R=T[w.charCodeAt(I++)])>>4,A=(15&R)<<4|(P=T[w.charCodeAt(I++)])>>2,O=(3&P)<<6|(E=T[w.charCodeAt(I++)]),D.push(String.fromCharCode(B)),P!==64&&D.push(String.fromCharCode(A)),E!==64&&D.push(String.fromCharCode(O));return D.join("")},decodeAsArray:function(w,B){var A,O,R,P=this.decode(w),E=[];for(A=0,R=P.length/B;A<R;A++)for(E[A]=0,O=B-1;O>=0;--O)E[A]+=P.charCodeAt(A*B+O)<<8*O;return E}};S.exports=_},{"../core/utils/misc":271}],24:[function(L,S){var T=function(_){this.data=_,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=new Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=new Array(T.LITERALS),this.distanceTree=new Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=new Array(17),this.fpos[0]=0,this.flens=void 0,this.fmax=void 0};T.gunzip=function(_){return _.constructor===Array||_.constructor,new T(_).gunzip()[0][0]},T.HufNode=function(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1},T.LITERALS=288,T.NAMEMAX=256,T.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],T.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],T.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],T.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],T.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},T.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},T.prototype.byteAlign=function(){this.bb=1},T.prototype.readBit=function(){var _;return this.bits++,_=1&this.bb,this.bb>>=1,this.bb===0&&(this.bb=this.readByte(),_=1&this.bb,this.bb=this.bb>>1|128),_},T.prototype.readBits=function(_){for(var w=0,B=_;B--;)w=w<<1|this.readBit();return _&&(w=T.bitReverse[w]>>8-_),w},T.prototype.flushBuffer=function(){this.bIdx=0},T.prototype.addBuffer=function(_){this.buf32k[this.bIdx++]=_,this.outputArr.push(String.fromCharCode(_)),this.bIdx===32768&&(this.bIdx=0)},T.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},T.prototype.Rec=function(){var _,w=this.Places[this.treepos];if(this.len===17)return-1;if(this.treepos++,this.len++,(_=this.IsPat())>=0)w.b0=_;else if(w.b0=32768,this.Rec())return-1;if((_=this.IsPat())>=0)w.b1=_,w.jump=null;else if(w.b1=32768,w.jump=this.Places[this.treepos],w.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},T.prototype.CreateTree=function(_,w,B){var A;for(this.Places=_,this.treepos=0,this.flens=B,this.fmax=w,A=0;A<17;A++)this.fpos[A]=0;return this.len=0,this.Rec()?-1:0},T.prototype.DecodeValue=function(_){for(var w,B,A=0,O=_[A];;)if(this.readBit()){if(!(32768&O.b1))return O.b1;for(O=O.jump,w=_.length,B=0;B<w;B++)if(_[B]===O){A=B;break}}else{if(!(32768&O.b0))return O.b0;O=_[++A]}return-1},T.prototype.DeflateLoop=function(){var _,w,B;do{var A,O;if(_=this.readBit(),(w=this.readBits(2))===0)for(this.byteAlign(),A=this.readByte(),A|=this.readByte()<<8,O=this.readByte(),65535&(A^~(O|=this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");A--;)R=this.readByte(),this.addBuffer(R);else if(w===1)for(;;)if((P=T.bitReverse[this.readBits(7)]>>1)>23?(P=P<<1|this.readBit())>199?P=(P-=128)<<1|this.readBit():(P-=48)>143&&(P+=136):P+=256,P<256)this.addBuffer(P);else{if(P===256)break;for(P-=257,G=this.readBits(T.cplext[P])+T.cplens[P],P=T.bitReverse[this.readBits(5)]>>3,T.cpdext[P]>8?(V=this.readBits(8),V|=this.readBits(T.cpdext[P]-8)<<8):V=this.readBits(T.cpdext[P]),V+=T.cpdist[P],P=0;P<G;P++){var R=this.buf32k[this.bIdx-V&32767];this.addBuffer(R)}}else if(w===2){var P,E,D,I,M,N=new Array(320);for(D=257+this.readBits(5),I=1+this.readBits(5),M=4+this.readBits(4),P=0;P<19;P++)N[P]=0;for(P=0;P<M;P++)N[T.border[P]]=this.readBits(3);for(G=this.distanceTree.length,B=0;B<G;B++)this.distanceTree[B]=new T.HufNode;if(this.CreateTree(this.distanceTree,19,N,0))return this.flushBuffer(),1;for(E=D+I,B=0;B<E;)if((P=this.DecodeValue(this.distanceTree))<16)N[B++]=P;else if(P===16){var k;if(B+(P=3+this.readBits(2))>E)return this.flushBuffer(),1;for(k=B?N[B-1]:0;P--;)N[B++]=k}else{if(B+(P=P===17?3+this.readBits(3):11+this.readBits(7))>E)return this.flushBuffer(),1;for(;P--;)N[B++]=0}for(G=this.literalTree.length,B=0;B<G;B++)this.literalTree[B]=new T.HufNode;if(this.CreateTree(this.literalTree,D,N,0))return this.flushBuffer(),1;for(G=this.literalTree.length,B=0;B<G;B++)this.distanceTree[B]=new T.HufNode;var F=new Array;for(B=D;B<N.length;B++)F[B-D]=N[B];if(this.CreateTree(this.distanceTree,I,F,0))return this.flushBuffer(),1;for(;;)if((P=this.DecodeValue(this.literalTree))>=256){var G,V;if((P-=256)==0)break;for(P--,G=this.readBits(T.cplext[P])+T.cplens[P],P=this.DecodeValue(this.distanceTree),T.cpdext[P]>8?(V=this.readBits(8),V|=this.readBits(T.cpdext[P]-8)<<8):V=this.readBits(T.cpdext[P]),V+=T.cpdist[P];G--;)R=this.buf32k[this.bIdx-V&32767],this.addBuffer(R)}else this.addBuffer(P)}}while(!_);return this.flushBuffer(),this.byteAlign(),0},T.prototype.unzipFile=function(_){var w;for(this.gunzip(),w=0;w<this.unzipped.length;w++)if(this.unzipped[w][1]===_)return this.unzipped[w][0]},T.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var _=[];if(_[0]=this.readByte(),_[1]=this.readByte(),_[0]===120&&_[1]===218&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),_[0]===31&&_[1]===139&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),_[0]===80&&_[1]===75&&(this.modeZIP=!0,_[2]=this.readByte(),_[3]=this.readByte(),_[2]===3&&_[3]===4)){_[0]=this.readByte(),_[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8;var w=this.readByte();w|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte();var B=this.readByte();B|=this.readByte()<<8;var A=this.readByte();for(A|=this.readByte()<<8,R=0,this.nameBuf=[];B--;){var O=this.readByte();O==="/"|O===":"?R=0:R<T.NAMEMAX-1&&(this.nameBuf[R++]=String.fromCharCode(O))}this.fileout||(this.fileout=this.nameBuf);for(var R=0;R<A;)O=this.readByte(),R++;w===8&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},T.prototype.skipdir=function(){var _,w,B=[];if(8&this.gpflags&&(B[0]=this.readByte(),B[1]=this.readByte(),B[2]=this.readByte(),B[3]=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte()),this.modeZIP&&this.nextFile(),B[0]=this.readByte(),B[0]!==8)return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(B[0]=this.readByte(),B[2]=this.readByte(),this.len=B[0]+256*B[1],_=0;_<this.len;_++)this.readByte();if(8&this.gpflags)for(_=0,this.nameBuf=[];w=this.readByte();)w!=="7"&&w!==":"||(_=0),_<T.NAMEMAX-1&&(this.nameBuf[_++]=w);if(16&this.gpflags)for(;w=this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.modeZIP&&this.nextFile()},S.exports=T},{}],25:[function(L,S){(function(){function _(Ue){throw Ue}var w=void 0,B=!0,A=this;function O(Ue,We){var ht,Be=Ue.split("."),je=A;for(!(Be[0]in je)&&je.execScript&&je.execScript("var "+Be[0]);Be.length&&(ht=Be.shift());)Be.length||We===w?je=je[ht]?je[ht]:je[ht]={}:je[ht]=We}var R=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u";function P(Ue){if(typeof Ue=="string"){var We,ht,Be=Ue.split("");for(We=0,ht=Be.length;We<ht;We++)Be[We]=(255&Be[We].charCodeAt(0))>>>0;Ue=Be}for(var je,Qe=1,st=0,pt=Ue.length,qe=0;0<pt;){pt-=je=1024<pt?1024:pt;do st+=Qe+=Ue[qe++];while(--je);Qe%=65521,st%=65521}return(st<<16|Qe)>>>0}function E(Ue,We){this.index=typeof We=="number"?We:0,this.i=0,this.buffer=Ue instanceof(R?Uint8Array:Array)?Ue:new(R?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&_(Error("invalid index")),this.buffer.length<=this.index&&this.f()}E.prototype.f=function(){var Ue,We=this.buffer,ht=We.length,Be=new(R?Uint8Array:Array)(ht<<1);if(R)Be.set(We);else for(Ue=0;Ue<ht;++Ue)Be[Ue]=We[Ue];return this.buffer=Be},E.prototype.d=function(Ue,We,ht){var Be,je=this.buffer,Qe=this.index,st=this.i,pt=je[Qe];if(ht&&1<We&&(Ue=8<We?(F[255&Ue]<<24|F[Ue>>>8&255]<<16|F[Ue>>>16&255]<<8|F[Ue>>>24&255])>>32-We:F[Ue]>>8-We),8>We+st)pt=pt<<We|Ue,st+=We;else for(Be=0;Be<We;++Be)pt=pt<<1|Ue>>We-Be-1&1,++st==8&&(st=0,je[Qe++]=F[pt],pt=0,Qe===je.length&&(je=this.f()));je[Qe]=pt,this.buffer=je,this.i=st,this.index=Qe},E.prototype.finish=function(){var Ue,We=this.buffer,ht=this.index;return 0<this.i&&(We[ht]<<=8-this.i,We[ht]=F[We[ht]],ht++),R?Ue=We.subarray(0,ht):(We.length=ht,Ue=We),Ue};var D,I=new(R?Uint8Array:Array)(256);for(D=0;256>D;++D){for(var M=k=D,N=7,k=k>>>1;k;k>>>=1)M<<=1,M|=1&k,--N;I[D]=(M<<N&255)>>>0}var F=I;function G(Ue){this.buffer=new(R?Uint16Array:Array)(2*Ue),this.length=0}function V(Ue){var We,ht,Be,je,Qe,st,pt,qe,rt,bt=Ue.length,Dt=0,Et=Number.POSITIVE_INFINITY;for(qe=0;qe<bt;++qe)Ue[qe]>Dt&&(Dt=Ue[qe]),Ue[qe]<Et&&(Et=Ue[qe]);for(We=1<<Dt,ht=new(R?Uint32Array:Array)(We),Be=1,je=0,Qe=2;Be<=Dt;){for(qe=0;qe<bt;++qe)if(Ue[qe]===Be){for(st=0,pt=je,rt=0;rt<Be;++rt)st=st<<1|1&pt,pt>>=1;for(rt=st;rt<We;rt+=Qe)ht[rt]=Be<<16|qe;++je}++Be,je<<=1,Qe<<=1}return[ht,Dt,Et]}function j(Ue,We){this.h=U,this.w=0,this.input=Ue,this.b=0,We&&(We.lazy&&(this.w=We.lazy),typeof We.compressionType=="number"&&(this.h=We.compressionType),We.outputBuffer&&(this.a=R&&We.outputBuffer instanceof Array?new Uint8Array(We.outputBuffer):We.outputBuffer),typeof We.outputIndex=="number"&&(this.b=We.outputIndex)),this.a||(this.a=new(R?Uint8Array:Array)(32768))}G.prototype.getParent=function(Ue){return 2*((Ue-2)/4|0)},G.prototype.push=function(Ue,We){var ht,Be,je,Qe=this.buffer;for(ht=this.length,Qe[this.length++]=We,Qe[this.length++]=Ue;0<ht&&(Be=this.getParent(ht),Qe[ht]>Qe[Be]);)je=Qe[ht],Qe[ht]=Qe[Be],Qe[Be]=je,je=Qe[ht+1],Qe[ht+1]=Qe[Be+1],Qe[Be+1]=je,ht=Be;return this.length},G.prototype.pop=function(){var Ue,We,ht,Be,je,Qe=this.buffer;for(We=Qe[0],Ue=Qe[1],this.length-=2,Qe[0]=Qe[this.length],Qe[1]=Qe[this.length+1],je=0;!((Be=2*je+2)>=this.length)&&(Be+2<this.length&&Qe[Be+2]>Qe[Be]&&(Be+=2),Qe[Be]>Qe[je]);)ht=Qe[je],Qe[je]=Qe[Be],Qe[Be]=ht,ht=Qe[je+1],Qe[je+1]=Qe[Be+1],Qe[Be+1]=ht,je=Be;return{index:Ue,value:We,length:this.length}};var H,U=2,X={NONE:0,r:1,j:U,N:3},Y=[];for(H=0;288>H;H++)switch(B){case 143>=H:Y.push([H+48,8]);break;case 255>=H:Y.push([H-144+400,9]);break;case 279>=H:Y.push([H-256+0,7]);break;case 287>=H:Y.push([H-280+192,8]);break;default:_("invalid literal: "+H)}function z(Ue,We){this.length=Ue,this.G=We}function W(){var Ue=Z;switch(B){case Ue===3:return[257,Ue-3,0];case Ue===4:return[258,Ue-4,0];case Ue===5:return[259,Ue-5,0];case Ue===6:return[260,Ue-6,0];case Ue===7:return[261,Ue-7,0];case Ue===8:return[262,Ue-8,0];case Ue===9:return[263,Ue-9,0];case Ue===10:return[264,Ue-10,0];case 12>=Ue:return[265,Ue-11,1];case 14>=Ue:return[266,Ue-13,1];case 16>=Ue:return[267,Ue-15,1];case 18>=Ue:return[268,Ue-17,1];case 22>=Ue:return[269,Ue-19,2];case 26>=Ue:return[270,Ue-23,2];case 30>=Ue:return[271,Ue-27,2];case 34>=Ue:return[272,Ue-31,2];case 42>=Ue:return[273,Ue-35,3];case 50>=Ue:return[274,Ue-43,3];case 58>=Ue:return[275,Ue-51,3];case 66>=Ue:return[276,Ue-59,3];case 82>=Ue:return[277,Ue-67,4];case 98>=Ue:return[278,Ue-83,4];case 114>=Ue:return[279,Ue-99,4];case 130>=Ue:return[280,Ue-115,4];case 162>=Ue:return[281,Ue-131,5];case 194>=Ue:return[282,Ue-163,5];case 226>=Ue:return[283,Ue-195,5];case 257>=Ue:return[284,Ue-227,5];case Ue===258:return[285,Ue-258,0];default:_("invalid length: "+Ue)}}j.prototype.n=function(){var Ue,We,ht,Be,je=this.input;switch(this.h){case 0:for(ht=0,Be=je.length;ht<Be;){var Qe,st,pt,qe=We=R?je.subarray(ht,ht+65535):je.slice(ht,ht+65535),rt=(ht+=We.length)===Be,bt=w,Dt=w,Et=this.a,Lt=this.b;if(R){for(Et=new Uint8Array(this.a.buffer);Et.length<=Lt+qe.length+5;)Et=new Uint8Array(Et.length<<1);Et.set(this.a)}if(Qe=rt?1:0,Et[Lt++]=0|Qe,pt=65536+~(st=qe.length)&65535,Et[Lt++]=255&st,Et[Lt++]=st>>>8&255,Et[Lt++]=255&pt,Et[Lt++]=pt>>>8&255,R)Et.set(qe,Lt),Lt+=qe.length,Et=Et.subarray(0,Lt);else{for(bt=0,Dt=qe.length;bt<Dt;++bt)Et[Lt++]=qe[bt];Et.length=Lt}this.b=Lt,this.a=Et}break;case 1:var Ot=new E(new Uint8Array(this.a.buffer),this.b);Ot.d(1,1,B),Ot.d(1,2,B);var Kt,Jt,Yt,Wt=re(this,je);for(Kt=0,Jt=Wt.length;Kt<Jt;Kt++)if(Yt=Wt[Kt],E.prototype.d.apply(Ot,Y[Yt]),256<Yt)Ot.d(Wt[++Kt],Wt[++Kt],B),Ot.d(Wt[++Kt],5),Ot.d(Wt[++Kt],Wt[++Kt],B);else if(Yt===256)break;this.a=Ot.finish(),this.b=this.a.length;break;case U:var rr,Ft,zt,lr,nr,tt,ft,lt,at,dt,_t,Ct,It,xt,yt,At=new E(new Uint8Array(this.a),this.b),Rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Gt=Array(19);for(rr=U,At.d(1,1,B),At.d(rr,2,B),Ft=re(this,je),ft=ne(tt=ie(this.L,15)),at=ne(lt=ie(this.K,7)),zt=286;257<zt&&tt[zt-1]===0;zt--);for(lr=30;1<lr&&lt[lr-1]===0;lr--);var Mt,Nt,kt,er,hr,cr,xr=zt,Ar=lr,Er=new(R?Uint32Array:Array)(xr+Ar),br=new(R?Uint32Array:Array)(316),gr=new(R?Uint8Array:Array)(19);for(Mt=Nt=0;Mt<xr;Mt++)Er[Nt++]=tt[Mt];for(Mt=0;Mt<Ar;Mt++)Er[Nt++]=lt[Mt];if(!R)for(Mt=0,er=gr.length;Mt<er;++Mt)gr[Mt]=0;for(Mt=hr=0,er=Er.length;Mt<er;Mt+=Nt){for(Nt=1;Mt+Nt<er&&Er[Mt+Nt]===Er[Mt];++Nt);if(kt=Nt,Er[Mt]===0)if(3>kt)for(;0<kt--;)br[hr++]=0,gr[0]++;else for(;0<kt;)(cr=138>kt?kt:138)>kt-3&&cr<kt&&(cr=kt-3),10>=cr?(br[hr++]=17,br[hr++]=cr-3,gr[17]++):(br[hr++]=18,br[hr++]=cr-11,gr[18]++),kt-=cr;else if(br[hr++]=Er[Mt],gr[Er[Mt]]++,3>--kt)for(;0<kt--;)br[hr++]=Er[Mt],gr[Er[Mt]]++;else for(;0<kt;)(cr=6>kt?kt:6)>kt-3&&cr<kt&&(cr=kt-3),br[hr++]=16,br[hr++]=cr-3,gr[16]++,kt-=cr}for(Ue=R?br.subarray(0,hr):br.slice(0,hr),dt=ie(gr,7),xt=0;19>xt;xt++)Gt[xt]=dt[Rt[xt]];for(nr=19;4<nr&&Gt[nr-1]===0;nr--);for(_t=ne(dt),At.d(zt-257,5,B),At.d(lr-1,5,B),At.d(nr-4,4,B),xt=0;xt<nr;xt++)At.d(Gt[xt],3,B);for(xt=0,yt=Ue.length;xt<yt;xt++)if(Ct=Ue[xt],At.d(_t[Ct],dt[Ct],B),16<=Ct){switch(xt++,Ct){case 16:It=2;break;case 17:It=3;break;case 18:It=7;break;default:_("invalid code: "+Ct)}At.d(Ue[xt],It,B)}var Dr,Ir,$r,Br,Qr,yi,xi,ui,Hi=[ft,tt],Xi=[at,lt];for(Qr=Hi[0],yi=Hi[1],xi=Xi[0],ui=Xi[1],Dr=0,Ir=Ft.length;Dr<Ir;++Dr)if($r=Ft[Dr],At.d(Qr[$r],yi[$r],B),256<$r)At.d(Ft[++Dr],Ft[++Dr],B),Br=Ft[++Dr],At.d(xi[Br],ui[Br],B),At.d(Ft[++Dr],Ft[++Dr],B);else if($r===256)break;this.a=At.finish(),this.b=this.a.length;break;default:_("invalid compression type")}return this.a};var Z,Q,ee=[];for(Z=3;258>=Z;Z++)Q=W(),ee[Z]=Q[2]<<24|Q[1]<<16|Q[0];var te=R?new Uint32Array(ee):ee;function re(Ue,We){function ht(at,dt){var _t,Ct,It,xt,yt=at.G,At=[],Rt=0;switch(_t=te[at.length],At[Rt++]=65535&_t,At[Rt++]=_t>>16&255,At[Rt++]=_t>>24,B){case yt===1:Ct=[0,yt-1,0];break;case yt===2:Ct=[1,yt-2,0];break;case yt===3:Ct=[2,yt-3,0];break;case yt===4:Ct=[3,yt-4,0];break;case 6>=yt:Ct=[4,yt-5,1];break;case 8>=yt:Ct=[5,yt-7,1];break;case 12>=yt:Ct=[6,yt-9,2];break;case 16>=yt:Ct=[7,yt-13,2];break;case 24>=yt:Ct=[8,yt-17,3];break;case 32>=yt:Ct=[9,yt-25,3];break;case 48>=yt:Ct=[10,yt-33,4];break;case 64>=yt:Ct=[11,yt-49,4];break;case 96>=yt:Ct=[12,yt-65,5];break;case 128>=yt:Ct=[13,yt-97,5];break;case 192>=yt:Ct=[14,yt-129,6];break;case 256>=yt:Ct=[15,yt-193,6];break;case 384>=yt:Ct=[16,yt-257,7];break;case 512>=yt:Ct=[17,yt-385,7];break;case 768>=yt:Ct=[18,yt-513,8];break;case 1024>=yt:Ct=[19,yt-769,8];break;case 1536>=yt:Ct=[20,yt-1025,9];break;case 2048>=yt:Ct=[21,yt-1537,9];break;case 3072>=yt:Ct=[22,yt-2049,10];break;case 4096>=yt:Ct=[23,yt-3073,10];break;case 6144>=yt:Ct=[24,yt-4097,11];break;case 8192>=yt:Ct=[25,yt-6145,11];break;case 12288>=yt:Ct=[26,yt-8193,12];break;case 16384>=yt:Ct=[27,yt-12289,12];break;case 24576>=yt:Ct=[28,yt-16385,13];break;case 32768>=yt:Ct=[29,yt-24577,13];break;default:_("invalid distance")}for(_t=Ct,At[Rt++]=_t[0],At[Rt++]=_t[1],At[Rt++]=_t[2],It=0,xt=At.length;It<xt;++It)Lt[Ot++]=At[It];Jt[At[0]]++,Yt[At[3]]++,Kt=at.length+dt-1,bt=null}var Be,je,Qe,st,pt,qe,rt,bt,Dt,Et={},Lt=R?new Uint16Array(2*We.length):[],Ot=0,Kt=0,Jt=new(R?Uint32Array:Array)(286),Yt=new(R?Uint32Array:Array)(30),Wt=Ue.w;if(!R){for(Qe=0;285>=Qe;)Jt[Qe++]=0;for(Qe=0;29>=Qe;)Yt[Qe++]=0}for(Jt[256]=1,Be=0,je=We.length;Be<je;++Be){for(Qe=pt=0,st=3;Qe<st&&Be+Qe!==je;++Qe)pt=pt<<8|We[Be+Qe];if(Et[pt]===w&&(Et[pt]=[]),qe=Et[pt],!(0<Kt--)){for(;0<qe.length&&32768<Be-qe[0];)qe.shift();if(Be+3>=je){for(bt&&ht(bt,-1),Qe=0,st=je-Be;Qe<st;++Qe)Dt=We[Be+Qe],Lt[Ot++]=Dt,++Jt[Dt];break}if(0<qe.length){var rr=w,Ft=w,zt=0,lr=w,nr=w,tt=w,ft=We.length,lt=(nr=0,qe.length);e:for(;nr<lt;nr++){if(rr=qe[lt-nr-1],lr=3,3<zt){for(tt=zt;3<tt;tt--)if(We[rr+tt-1]!==We[Be+tt-1])continue e;lr=zt}for(;258>lr&&Be+lr<ft&&We[rr+lr]===We[Be+lr];)++lr;if(lr>zt&&(Ft=rr,zt=lr),lr===258)break}rt=new z(zt,Be-Ft),bt?bt.length<rt.length?(Dt=We[Be-1],Lt[Ot++]=Dt,++Jt[Dt],ht(rt,0)):ht(bt,-1):rt.length<Wt?bt=rt:ht(rt,0)}else bt?ht(bt,-1):(Dt=We[Be],Lt[Ot++]=Dt,++Jt[Dt])}qe.push(Be)}return Lt[Ot++]=256,Jt[256]++,Ue.L=Jt,Ue.K=Yt,R?Lt.subarray(0,Ot):Lt}function ie(Ue,We){function ht(ft){var lt=zt[ft][lr[ft]];lt===Jt?(ht(ft+1),ht(ft+1)):--rr[lt],++lr[ft]}var Be,je,Qe,st,pt,qe=Ue.length,rt=new G(572),bt=new(R?Uint8Array:Array)(qe);if(!R)for(st=0;st<qe;st++)bt[st]=0;for(st=0;st<qe;++st)0<Ue[st]&&rt.push(st,Ue[st]);if(Be=Array(rt.length/2),je=new(R?Uint32Array:Array)(rt.length/2),Be.length===1)return bt[rt.pop().index]=1,bt;for(st=0,pt=rt.length/2;st<pt;++st)Be[st]=rt.pop(),je[st]=Be[st].value;var Dt,Et,Lt,Ot,Kt,Jt=je.length,Yt=new(R?Uint16Array:Array)(We),Wt=new(R?Uint8Array:Array)(We),rr=new(R?Uint8Array:Array)(Jt),Ft=Array(We),zt=Array(We),lr=Array(We),nr=(1<<We)-Jt,tt=1<<We-1;for(Yt[We-1]=Jt,Et=0;Et<We;++Et)nr<tt?Wt[Et]=0:(Wt[Et]=1,nr-=tt),nr<<=1,Yt[We-2-Et]=(Yt[We-1-Et]/2|0)+Jt;for(Yt[0]=Wt[0],Ft[0]=Array(Yt[0]),zt[0]=Array(Yt[0]),Et=1;Et<We;++Et)Yt[Et]>2*Yt[Et-1]+Wt[Et]&&(Yt[Et]=2*Yt[Et-1]+Wt[Et]),Ft[Et]=Array(Yt[Et]),zt[Et]=Array(Yt[Et]);for(Dt=0;Dt<Jt;++Dt)rr[Dt]=We;for(Lt=0;Lt<Yt[We-1];++Lt)Ft[We-1][Lt]=je[Lt],zt[We-1][Lt]=Lt;for(Dt=0;Dt<We;++Dt)lr[Dt]=0;for(Wt[We-1]===1&&(--rr[0],++lr[We-1]),Et=We-2;0<=Et;--Et){for(Ot=Dt=0,Kt=lr[Et+1],Lt=0;Lt<Yt[Et];Lt++)(Ot=Ft[Et+1][Kt]+Ft[Et+1][Kt+1])>je[Dt]?(Ft[Et][Lt]=Ot,zt[Et][Lt]=Jt,Kt+=2):(Ft[Et][Lt]=je[Dt],zt[Et][Lt]=Dt,++Dt);lr[Et]=0,Wt[Et]===1&&ht(Et)}for(Qe=rr,st=0,pt=Be.length;st<pt;++st)bt[Be[st].index]=Qe[st];return bt}function ne(Ue){var We,ht,Be,je,Qe=new(R?Uint16Array:Array)(Ue.length),st=[],pt=[],qe=0;for(We=0,ht=Ue.length;We<ht;We++)st[Ue[We]]=1+(0|st[Ue[We]]);for(We=1,ht=16;We<=ht;We++)pt[We]=qe,(qe+=0|st[We])>1<<We&&_("overcommitted"),qe<<=1;for(65536>qe&&_("undercommitted"),We=0,ht=Ue.length;We<ht;We++)for(qe=pt[Ue[We]],pt[Ue[We]]+=1,Be=Qe[We]=0,je=Ue[We];Be<je;Be++)Qe[We]=Qe[We]<<1|1&qe,qe>>>=1;return Qe}function he(Ue,We){this.input=Ue,this.a=new(R?Uint8Array:Array)(32768),this.h=pe.j;var ht,Be={};for(ht in!We&&(We={})||typeof We.compressionType!="number"||(this.h=We.compressionType),We)Be[ht]=We[ht];Be.outputBuffer=this.a,this.z=new j(this.input,Be)}var pe=X;function K(Ue,We){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=R?new Uint8Array(Ue):Ue,this.s=!1,this.m=le,this.B=!1,!We&&(We={})||(We.index&&(this.c=We.index),We.bufferSize&&(this.l=We.bufferSize),We.bufferType&&(this.m=We.bufferType),We.resize&&(this.B=We.resize)),this.m){case ue:this.b=32768,this.a=new(R?Uint8Array:Array)(32768+this.l+258);break;case le:this.b=0,this.a=new(R?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:_(Error("invalid inflate mode"))}}he.prototype.n=function(){var Ue,We,ht,Be,je,Qe,st,pt=0;switch(st=this.a,Ue=gt){case gt:We=Math.LOG2E*Math.log(32768)-8;break;default:_(Error("invalid compression method"))}switch(ht=We<<4|Ue,st[pt++]=ht,Ue){case gt:switch(this.h){case pe.NONE:je=0;break;case pe.r:je=1;break;case pe.j:je=2;break;default:_(Error("unsupported compression type"))}break;default:_(Error("invalid compression method"))}return Be=je<<6|0,st[pt++]=Be|31-(256*ht+Be)%31,Qe=P(this.input),this.z.b=pt,pt=(st=this.z.n()).length,R&&((st=new Uint8Array(st.buffer)).length<=pt+4&&(this.a=new Uint8Array(st.length+4),this.a.set(st),st=this.a),st=st.subarray(0,pt+4)),st[pt++]=Qe>>24&255,st[pt++]=Qe>>16&255,st[pt++]=Qe>>8&255,st[pt++]=255&Qe,st},O("Zlib.Deflate",he),O("Zlib.Deflate.compress",function(Ue,We){return new he(Ue,We).n()}),O("Zlib.Deflate.CompressionType",pe),O("Zlib.Deflate.CompressionType.NONE",pe.NONE),O("Zlib.Deflate.CompressionType.FIXED",pe.r),O("Zlib.Deflate.CompressionType.DYNAMIC",pe.j);var ue=0,le=1,ce={D:ue,C:le};K.prototype.p=function(){for(;!this.s;){var Ue=Ne(this,3);switch(1&Ue&&(this.s=B),Ue>>>=1){case 0:var We=this.input,ht=this.c,Be=this.a,je=this.b,Qe=w,st=w,pt=w,qe=Be.length,rt=w;switch(this.e=this.g=0,(Qe=We[ht++])===w&&_(Error("invalid uncompressed block header: LEN (first byte)")),st=Qe,(Qe=We[ht++])===w&&_(Error("invalid uncompressed block header: LEN (second byte)")),st|=Qe<<8,(Qe=We[ht++])===w&&_(Error("invalid uncompressed block header: NLEN (first byte)")),pt=Qe,(Qe=We[ht++])===w&&_(Error("invalid uncompressed block header: NLEN (second byte)")),st===~(pt|=Qe<<8)&&_(Error("invalid uncompressed block header: length verify")),ht+st>We.length&&_(Error("input buffer is broken")),this.m){case ue:for(;je+st>Be.length;){if(st-=rt=qe-je,R)Be.set(We.subarray(ht,ht+rt),je),je+=rt,ht+=rt;else for(;rt--;)Be[je++]=We[ht++];this.b=je,Be=this.f(),je=this.b}break;case le:for(;je+st>Be.length;)Be=this.f({v:2});break;default:_(Error("invalid inflate mode"))}if(R)Be.set(We.subarray(ht,ht+st),je),je+=st,ht+=st;else for(;st--;)Be[je++]=We[ht++];this.c=ht,this.b=je,this.a=Be;break;case 1:this.o(Ve,ke);break;case 2:Oe(this);break;default:_(Error("unknown BTYPE: "+Ue))}}return this.t()};var _e,oe,de=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=R?new Uint16Array(de):de,ye=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],ge=R?new Uint16Array(ye):ye,we=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],Te=R?new Uint8Array(we):we,Ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],De=R?new Uint16Array(Ee):Ee,fe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ce=R?new Uint8Array(fe):fe,Se=new(R?Uint8Array:Array)(288);for(_e=0,oe=Se.length;_e<oe;++_e)Se[_e]=143>=_e?8:255>=_e?9:279>=_e?7:8;var be,Re,Ve=V(Se),Pe=new(R?Uint8Array:Array)(30);for(be=0,Re=Pe.length;be<Re;++be)Pe[be]=5;var ke=V(Pe);function Ne(Ue,We){for(var ht,Be=Ue.g,je=Ue.e,Qe=Ue.input,st=Ue.c;je<We;)(ht=Qe[st++])===w&&_(Error("input buffer is broken")),Be|=ht<<je,je+=8;return ht=Be&(1<<We)-1,Ue.g=Be>>>We,Ue.e=je-We,Ue.c=st,ht}function Ae(Ue,We){for(var ht,Be,je,Qe=Ue.g,st=Ue.e,pt=Ue.input,qe=Ue.c,rt=We[0],bt=We[1];st<bt;)(ht=pt[qe++])===w&&_(Error("input buffer is broken")),Qe|=ht<<st,st+=8;return je=(Be=rt[Qe&(1<<bt)-1])>>>16,Ue.g=Qe>>je,Ue.e=st-je,Ue.c=qe,65535&Be}function Oe(Ue){function We(bt,Dt,Et){var Lt,Ot,Kt,Jt;for(Jt=0;Jt<bt;)switch(Lt=Ae(this,Dt)){case 16:for(Kt=3+Ne(this,2);Kt--;)Et[Jt++]=Ot;break;case 17:for(Kt=3+Ne(this,3);Kt--;)Et[Jt++]=0;Ot=0;break;case 18:for(Kt=11+Ne(this,7);Kt--;)Et[Jt++]=0;Ot=0;break;default:Ot=Et[Jt++]=Lt}return Et}var ht,Be,je,Qe,st=Ne(Ue,5)+257,pt=Ne(Ue,5)+1,qe=Ne(Ue,4)+4,rt=new(R?Uint8Array:Array)(me.length);for(Qe=0;Qe<qe;++Qe)rt[me[Qe]]=Ne(Ue,3);ht=V(rt),Be=new(R?Uint8Array:Array)(st),je=new(R?Uint8Array:Array)(pt),Ue.o(V(We.call(Ue,st,ht,Be)),V(We.call(Ue,pt,ht,je)))}function Fe(Ue,We){var ht,Be;switch(this.input=Ue,this.c=0,!We&&(We={})||(We.index&&(this.c=We.index),We.verify&&(this.M=We.verify)),ht=Ue[this.c++],Be=Ue[this.c++],15&ht){case gt:this.method=gt;break;default:_(Error("unsupported compression method"))}((ht<<8)+Be)%31!=0&&_(Error("invalid fcheck flag:"+((ht<<8)+Be)%31)),32&Be&&_(Error("fdict flag is not supported")),this.A=new K(Ue,{index:this.c,bufferSize:We.bufferSize,bufferType:We.bufferType,resize:We.resize})}K.prototype.o=function(Ue,We){var ht=this.a,Be=this.b;this.u=Ue;for(var je,Qe,st,pt,qe=ht.length-258;(je=Ae(this,Ue))!==256;)if(256>je)Be>=qe&&(this.b=Be,ht=this.f(),Be=this.b),ht[Be++]=je;else for(pt=ge[Qe=je-257],0<Te[Qe]&&(pt+=Ne(this,Te[Qe])),je=Ae(this,We),st=De[je],0<Ce[je]&&(st+=Ne(this,Ce[je])),Be>=qe&&(this.b=Be,ht=this.f(),Be=this.b);pt--;)ht[Be]=ht[Be++-st];for(;8<=this.e;)this.e-=8,this.c--;this.b=Be},K.prototype.I=function(Ue,We){var ht=this.a,Be=this.b;this.u=Ue;for(var je,Qe,st,pt,qe=ht.length;(je=Ae(this,Ue))!==256;)if(256>je)Be>=qe&&(qe=(ht=this.f()).length),ht[Be++]=je;else for(pt=ge[Qe=je-257],0<Te[Qe]&&(pt+=Ne(this,Te[Qe])),je=Ae(this,We),st=De[je],0<Ce[je]&&(st+=Ne(this,Ce[je])),Be+pt>qe&&(qe=(ht=this.f()).length);pt--;)ht[Be]=ht[Be++-st];for(;8<=this.e;)this.e-=8,this.c--;this.b=Be},K.prototype.f=function(){var Ue,We,ht=new(R?Uint8Array:Array)(this.b-32768),Be=this.b-32768,je=this.a;if(R)ht.set(je.subarray(32768,ht.length));else for(Ue=0,We=ht.length;Ue<We;++Ue)ht[Ue]=je[Ue+32768];if(this.k.push(ht),this.q+=ht.length,R)je.set(je.subarray(Be,Be+32768));else for(Ue=0;32768>Ue;++Ue)je[Ue]=je[Be+Ue];return this.b=32768,je},K.prototype.J=function(Ue){var We,ht,Be,je=this.input.length/this.c+1|0,Qe=this.input,st=this.a;return Ue&&(typeof Ue.v=="number"&&(je=Ue.v),typeof Ue.F=="number"&&(je+=Ue.F)),ht=2>je?(Be=(Qe.length-this.c)/this.u[2]/2*258|0)<st.length?st.length+Be:st.length<<1:st.length*je,R?(We=new Uint8Array(ht)).set(st):We=st,this.a=We},K.prototype.t=function(){var Ue,We,ht,Be,je,Qe=0,st=this.a,pt=this.k,qe=new(R?Uint8Array:Array)(this.q+(this.b-32768));if(pt.length===0)return R?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(We=0,ht=pt.length;We<ht;++We)for(Be=0,je=(Ue=pt[We]).length;Be<je;++Be)qe[Qe++]=Ue[Be];for(We=32768,ht=this.b;We<ht;++We)qe[Qe++]=st[We];return this.k=[],this.buffer=qe},K.prototype.H=function(){var Ue,We=this.b;return R?this.B?(Ue=new Uint8Array(We)).set(this.a.subarray(0,We)):Ue=this.a.subarray(0,We):(this.a.length>We&&(this.a.length=We),Ue=this.a),this.buffer=Ue},Fe.prototype.p=function(){var Ue,We=this.input;return Ue=this.A.p(),this.c=this.A.c,this.M&&(We[this.c++]<<24|We[this.c++]<<16|We[this.c++]<<8|We[this.c++])>>>0!==P(Ue)&&_(Error("invalid adler-32 checksum")),Ue},O("Zlib.Inflate",Fe),O("Zlib.Inflate.BufferType",ce),ce.ADAPTIVE=ce.C,ce.BLOCK=ce.D,O("Zlib.Inflate.prototype.decompress",Fe.prototype.p);var nt,Ze,Xe=new(R?Uint8Array:Array)(288);for(nt=0,Ze=Xe.length;nt<Ze;++nt)Xe[nt]=143>=nt?8:255>=nt?9:279>=nt?7:8;V(Xe);var $e,ot,ut=new(R?Uint8Array:Array)(30);for($e=0,ot=ut.length;$e<ot;++$e)ut[$e]=5;V(ut);var gt=8}).call(window);var T=window.Zlib;T.Deflate=T.Deflate,T.Deflate.compress=T.Deflate.compress,T.Inflate=T.Inflate,T.Inflate.BufferType=T.Inflate.BufferType,T.Inflate.prototype.decompress=T.Inflate.prototype.decompress,S.exports=T},{}],26:[function(L,S){var T,_=L("./platform/utils"),w=(L("../../DebugInfos"),"https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md");function B(D){return function(){var I=arguments[0],M=D+" "+I+", please go to "+w+"#"+I+" to see details.";if(arguments.length===1)return M;if(arguments.length===2)return M+" Arguments: "+arguments[1];var N=cc.js.shiftArguments.apply(null,arguments);return M+" Arguments: "+N.join(", ")}}cc.log=cc.warn=cc.error=cc.assert=console.log.bind?console.log.bind(console):console.log,cc._throw=function(D){_.callInNextTick(function(){throw D})};var A=B("Log");cc.logID=function(){cc.log(A.apply(null,arguments))};var O=B("Warning");cc.warnID=function(){cc.warn(O.apply(null,arguments))};var R=B("Error");cc.errorID=function(){cc.error(R.apply(null,arguments))};var P=B("Assert");cc.assertID=function(D){D||cc.assert(!1,P.apply(null,cc.js.shiftArguments.apply(null,arguments)))};var E=cc.Enum({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});S.exports=cc.debug={DebugMode:E,_resetDebugSetting:function(D){if(cc.log=cc.warn=cc.error=cc.assert=function(){},D!==E.NONE){if(D>E.ERROR){var I=function(M){if(cc.game.canvas){if(!T){var N=document.createElement("Div");N.setAttribute("id","logInfoDiv"),N.setAttribute("width","200"),N.setAttribute("height",cc.game.canvas.height);var k=N.style;k.zIndex="99999",k.position="absolute",k.top=k.left="0",(T=document.createElement("textarea")).setAttribute("rows","20"),T.setAttribute("cols","30"),T.setAttribute("disabled","true");var F=T.style;F.backgroundColor="transparent",F.borderBottom="1px solid #cccccc",F.borderTopWidth=F.borderLeftWidth=F.borderRightWidth="0px",F.borderTopStyle=F.borderLeftStyle=F.borderRightStyle="none",F.padding="0px",F.margin=0,N.appendChild(T),cc.game.canvas.parentNode.appendChild(N)}T.value=T.value+M+"\r\n",T.scrollTop=T.scrollHeight}};cc.error=function(){I("ERROR :  "+cc.js.formatStr.apply(null,arguments))},cc.assert=function(M,N){!M&&N&&(N=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments)),I("ASSERT: "+N))},D!==E.ERROR_FOR_WEB_PAGE&&(cc.warn=function(){I("WARN :  "+cc.js.formatStr.apply(null,arguments))}),D===E.INFO_FOR_WEB_PAGE&&(cc.log=function(){I(cc.js.formatStr.apply(null,arguments))})}else console&&console.log.apply&&(console.error||(console.error=console.log),console.warn||(console.warn=console.log),console.error.bind?cc.error=console.error.bind(console):cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(M,N){if(!M)throw N&&(N=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments))),new Error(N)});D!==E.ERROR&&(console.warn.bind?cc.warn=console.warn.bind(console):cc.warn=function(){return console.warn.apply(console,arguments)}),D===E.INFO&&(console.log.bind?cc.log=console.log.bind(console):cc.log=function(){return console.log.apply(console,arguments)})}},getError:B("ERROR"),isDisplayStats:function(){return!!cc.profiler&&cc.profiler.isShowingStats()},setDisplayStats:function(D){cc.profiler&&cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS&&(D?cc.profiler.showStats():cc.profiler.hideStats(),cc.game.config.showFPS=!!D)}}},{"../../DebugInfos":void 0,"./platform/utils":220}],27:[function(L,S){var T=L("./event/event-target"),_=L("./component-scheduler"),w=L("./node-activator"),B=L("./platform/CCObject"),A=L("./CCGame"),O=L("./renderer"),R=L("./event-manager"),P=L("./CCScheduler");cc.Director=function(){T.call(this),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=null,this._scene=null,this._loadingScene="",this._totalFrames=0,this._lastUpdate=0,this._deltaTime=0,this._startTime=0,this._maxParticleDeltaTime=0,this._scheduler=null,this._compScheduler=null,this._nodeActivator=null,this._actionManager=null;var E=this;A.on(A.EVENT_SHOW,function(){E._lastUpdate=performance.now()}),A.once(A.EVENT_ENGINE_INITED,this.init,this)},cc.Director.prototype={constructor:cc.Director,init:function(){return this._totalFrames=0,this._lastUpdate=performance.now(),this._startTime=this._lastUpdate,this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._scheduler=new P,cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,P.PRIORITY_SYSTEM,!1)):this._actionManager=null,this.sharedInit(),!0},sharedInit:function(){this._compScheduler=new _,this._nodeActivator=new w,R&&R.setEnabled(!0),cc.AnimationManager?(this._animationManager=new cc.AnimationManager,this._scheduler.scheduleUpdate(this._animationManager,P.PRIORITY_SYSTEM,!1)):this._animationManager=null,cc.CollisionManager?(this._collisionManager=new cc.CollisionManager,this._scheduler.scheduleUpdate(this._collisionManager,P.PRIORITY_SYSTEM,!1)):this._collisionManager=null,cc.PhysicsManager?(this._physicsManager=new cc.PhysicsManager,this._scheduler.scheduleUpdate(this._physicsManager,P.PRIORITY_SYSTEM,!1)):this._physicsManager=null,cc.Physics3DManager,this._physics3DManager=null,cc._widgetManager&&cc._widgetManager.init(this)},calculateDeltaTime:function(E){E||(E=performance.now()),this._deltaTime=E>this._lastUpdate?(E-this._lastUpdate)/1e3:0,this._lastUpdate=E},convertToGL:function(E){var D=A.container,I=cc.view,M=D.getBoundingClientRect(),N=M.left+window.pageXOffset-D.clientLeft,k=M.top+window.pageYOffset-D.clientTop,F=I._devicePixelRatio*(E.x-N),G=I._devicePixelRatio*(k+M.height-E.y);return I._isRotated?cc.v2(I._viewportRect.width-G,F):cc.v2(F,G)},convertToUI:function(E){var D=A.container,I=cc.view,M=D.getBoundingClientRect(),N=M.left+window.pageXOffset-D.clientLeft,k=M.top+window.pageYOffset-D.clientTop,F=cc.v2(0,0);return I._isRotated?(F.x=N+E.y/I._devicePixelRatio,F.y=k+M.height-(I._viewportRect.width-E.x)/I._devicePixelRatio):(F.x=N+E.x*I._devicePixelRatio,F.y=k+M.height-E.y*I._devicePixelRatio),F},end:function(){this._purgeDirectorInNextLoop=!0},getWinSize:function(){return cc.size(cc.winSize)},getWinSizeInPixels:function(){return cc.size(cc.winSize)},pause:function(){this._paused||(this._paused=!0)},purgeCachedData:function(){cc.assetManager.releaseAll()},purgeDirector:function(){this._scheduler.unscheduleAll(),this._compScheduler.unscheduleAll(),this._nodeActivator.reset(),R&&R.setEnabled(!1),cc.isValid(this._scene)&&this._scene.destroy(),this._scene=null,cc.renderer.clear(),cc.assetManager.builtins.clear(),cc.game.pause(),cc.assetManager.releaseAll()},reset:function(){this.purgeDirector(),R&&R.setEnabled(!0),this._actionManager&&this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._animationManager&&this._scheduler.scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._collisionManager&&this._scheduler.scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._physicsManager&&this._scheduler.scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1),cc.game.resume()},runSceneImmediate:function(E,D,I){cc.assertID(E instanceof cc.Scene||E instanceof cc.SceneAsset,1216),E instanceof cc.SceneAsset&&(E=E.scene),E._load();for(var M=Object.keys(A._persistRootNodes).map(function(j){return A._persistRootNodes[j]}),N=0;N<M.length;N++){var k=M[N],F=E.getChildByUuid(k.uuid);if(F){var G=F.getSiblingIndex();F._destroyImmediate(),E.insertChild(k,G)}else k.parent=E}var V=this._scene;cc.assetManager._releaseManager._autoRelease(V,E,A._persistRootNodes),cc.isValid(V)&&V.destroy(),this._scene=null,B._deferredDestroy(),D&&D(),this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,E),this._scene=E,E._activate(),cc.game.resume(),I&&I(null,E),this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,E)},runScene:function(E,D,I){cc.assertID(E,1205),cc.assertID(E instanceof cc.Scene||E instanceof cc.SceneAsset,1216),E instanceof cc.SceneAsset&&(E=E.scene),E._load(),this.once(cc.Director.EVENT_AFTER_DRAW,function(){this.runSceneImmediate(E,D,I)},this)},loadScene:function(E,D,I){if(this._loadingScene)return cc.warnID(1208,E,this._loadingScene),!1;var M=cc.assetManager.bundles.find(function(k){return k.getSceneInfo(E)});if(M){this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,E),this._loadingScene=E;var N=this;return console.time("LoadScene "+E),M.loadScene(E,function(k,F){console.timeEnd("LoadScene "+E),N._loadingScene="",k?(k="Failed to load scene: "+k,cc.error(k),D&&D(k)):N.runSceneImmediate(F,I,D)}),!0}return cc.errorID(1209,E),!1},preloadScene:function(E,D,I){var M=cc.assetManager.bundles.find(function(N){return N.getSceneInfo(E)});if(!M)return cc.errorID(1209,E),null;M.preloadScene(E,null,D,I)},resume:function(){this._paused&&(this._lastUpdate=performance.now(),this._lastUpdate||cc.logID(1200),this._paused=!1,this._deltaTime=0)},setDepthTest:function(E){cc.Camera.main&&(cc.Camera.main.depth=!!E)},setClearColor:function(E){cc.Camera.main&&(cc.Camera.main.backgroundColor=E)},getRunningScene:function(){return this._scene},getScene:function(){return this._scene},getAnimationInterval:function(){return 1e3/A.getFrameRate()},setAnimationInterval:function(E){A.setFrameRate(Math.round(1e3/E))},getDeltaTime:function(){return this._deltaTime},getTotalTime:function(){return performance.now()-this._startTime},getTotalFrames:function(){return this._totalFrames},isPaused:function(){return this._paused},getScheduler:function(){return this._scheduler},setScheduler:function(E){this._scheduler!==E&&(this._scheduler=E)},getActionManager:function(){return this._actionManager},setActionManager:function(E){this._actionManager!==E&&(this._actionManager&&this._scheduler.unscheduleUpdate(this._actionManager),this._actionManager=E,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1))},getAnimationManager:function(){return this._animationManager},getCollisionManager:function(){return this._collisionManager},getPhysicsManager:function(){return this._physicsManager},getPhysics3DManager:function(){return this._physics3DManager},startAnimation:function(){cc.game.resume()},stopAnimation:function(){cc.game.pause()},_resetDeltaTime:function(){this._lastUpdate=performance.now(),this._deltaTime=0},mainLoop:function(E){if(this._purgeDirectorInNextLoop)this._purgeDirectorInNextLoop=!1,this.purgeDirector();else{this.calculateDeltaTime(E);var D=this._deltaTime;this._paused||(this.emit(cc.Director.EVENT_BEFORE_UPDATE,D),this._compScheduler.startPhase(),this._compScheduler.updatePhase(D),this._scheduler.update(D),this._compScheduler.lateUpdatePhase(D),this.emit(cc.Director.EVENT_AFTER_UPDATE,D),B._deferredDestroy()),this.emit(cc.Director.EVENT_BEFORE_DRAW,D),O.render(this._scene,D),this.emit(cc.Director.EVENT_AFTER_DRAW,D),R.frameUpdateListeners(),this._totalFrames++}},__fastOn:function(E,D,I){this.on(E,D,I)},__fastOff:function(E,D,I){this.off(E,D,I)}},cc.js.addon(cc.Director.prototype,T.prototype),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading",cc.Director.EVENT_BEFORE_SCENE_LAUNCH="director_before_scene_launch",cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch",cc.Director.EVENT_BEFORE_UPDATE="director_before_update",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_BEFORE_VISIT="director_before_draw",cc.Director.EVENT_AFTER_VISIT="director_before_draw",cc.Director.EVENT_BEFORE_DRAW="director_before_draw",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_2D,cc.Director.EVENT_BEFORE_PHYSICS="director_before_physics",cc.Director.EVENT_AFTER_PHYSICS="director_after_physics",cc.director=new cc.Director,S.exports=cc.director},{"./CCGame":28,"./CCScheduler":32,"./component-scheduler":100,"./event-manager":141,"./event/event-target":143,"./node-activator":169,"./platform/CCObject":202,"./renderer":227}],28:[function(L,S){var T=L("./event/event-target");L("../audio/CCAudioEngine");var _=L("./CCDebug"),w=L("./renderer/index.js"),B=L("../core/renderer/utils/dynamic-atlas/manager"),A={EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_RESTART:"game_on_restart",EVENT_GAME_INITED:"game_inited",EVENT_ENGINE_INITED:"engine_inited",EVENT_RENDERER_INITED:"engine_inited",RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,_persistRootNodes:{},_paused:!0,_configLoaded:!1,_isCloning:!1,_prepared:!1,_rendererInitialized:!1,_renderContext:null,_intervalId:null,_lastTime:null,_frameTime:null,frame:null,container:null,canvas:null,renderType:-1,config:null,onStart:null,setFrameRate:function(O){this.config.frameRate=O,this._intervalId&&window.cancelAnimFrame(this._intervalId),this._intervalId=0,this._paused=!0,this._setAnimFrame(),this._runMainLoop()},getFrameRate:function(){return this.config.frameRate},step:function(){cc.director.mainLoop()},pause:function(){this._paused||(this._paused=!0,cc.audioEngine&&cc.audioEngine._break(),this._intervalId&&window.cancelAnimFrame(this._intervalId),this._intervalId=0)},resume:function(){this._paused&&(this._paused=!1,cc.audioEngine&&cc.audioEngine._restore(),cc.director._resetDeltaTime(),this._runMainLoop())},isPaused:function(){return this._paused},restart:function(){cc.director.once(cc.Director.EVENT_AFTER_DRAW,function(){for(var O in A._persistRootNodes)A.removePersistRootNode(A._persistRootNodes[O]);cc.director.getScene().destroy(),cc.Object._deferredDestroy(),cc.audioEngine&&cc.audioEngine.uncacheAll(),cc.director.reset(),A.pause(),cc.assetManager.builtins.init(function(){A.onStart(),A.emit(A.EVENT_RESTART)})})},end:function(){close()},_initEngine:function(){this._rendererInitialized||(this._initRenderer(),this._initEvents(),this.emit(this.EVENT_ENGINE_INITED))},_loadPreviewScript:function(O){O()},_prepareFinished:function(O){var R=this;this._initEngine(),this._setAnimFrame(),cc.assetManager.builtins.init(function(){console.log("Cocos Creator v"+cc.ENGINE_VERSION),R._prepared=!0,R._runMainLoop(),R.emit(R.EVENT_GAME_INITED),O&&O()})},eventTargetOn:T.prototype.on,eventTargetOnce:T.prototype.once,on:function(O,R,P,E){this._prepared&&O===this.EVENT_ENGINE_INITED||!this._paused&&O===this.EVENT_GAME_INITED?R.call(P):this.eventTargetOn(O,R,P,E)},once:function(O,R,P){this._prepared&&O===this.EVENT_ENGINE_INITED||!this._paused&&O===this.EVENT_GAME_INITED?R.call(P):this.eventTargetOnce(O,R,P)},prepare:function(O){var R=this;this._prepared?O&&O():this._loadPreviewScript(function(){R._prepareFinished(O)})},run:function(O,R){this._initConfig(O),this.onStart=R,this.prepare(A.onStart&&A.onStart.bind(A))},addPersistRootNode:function(O){if(cc.Node.isNode(O)&&O.uuid){var R=O.uuid;if(!this._persistRootNodes[R]){var P=cc.director._scene;if(cc.isValid(P))if(O.parent){if(!(O.parent instanceof cc.Scene))return void cc.warnID(3801);if(O.parent!==P)return void cc.warnID(3802)}else O.parent=P;this._persistRootNodes[R]=O,O._persistNode=!0,cc.assetManager._releaseManager._addPersistNodeRef(O)}}else cc.warnID(3800)},removePersistRootNode:function(O){var R=O.uuid||"";O===this._persistRootNodes[R]&&(delete this._persistRootNodes[R],O._persistNode=!1,cc.assetManager._releaseManager._removePersistNodeRef(O))},isPersistRootNode:function(O){return O._persistNode},_setAnimFrame:function(){this._lastTime=performance.now();var O=A.config.frameRate;this._frameTime=1e3/O,cc.director._maxParticleDeltaTime=this._frameTime/1e3*2;var R=window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;O!==60&&O!==30?(window.requestAnimFrame=R?this._stTimeWithRAF:this._stTime,window.cancelAnimFrame=this._ctTime):(window.requestAnimFrame=R||this._stTime,window.cancelAnimFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTimeWithRAF:function(O){var R=performance.now(),P=Math.max(0,A._frameTime-(R-A._lastTime)),E=window.setTimeout(function(){window.requestAnimationFrame(O)},P);return A._lastTime=R+P,E},_stTime:function(O){var R=performance.now(),P=Math.max(0,A._frameTime-(R-A._lastTime)),E=window.setTimeout(function(){O()},P);return A._lastTime=R+P,E},_ctTime:function(O){window.clearTimeout(O)},_runMainLoop:function(){if(this._prepared){var O,R=this,P=R.config,E=cc.director,D=!0,I=P.frameRate;_.setDisplayStats(P.showFPS),O=function(M){if(!R._paused){if(R._intervalId=window.requestAnimFrame(O),I===30&&(D=!D))return;E.mainLoop(M)}},R._intervalId=window.requestAnimFrame(O),R._paused=!1}},_initConfig:function(O){typeof O.debugMode!="number"&&(O.debugMode=0),O.exposeClassName=!!O.exposeClassName,typeof O.frameRate!="number"&&(O.frameRate=60);var R=O.renderMode;(typeof R!="number"||R>2||R<0)&&(O.renderMode=0),typeof O.registerSystemEvent!="boolean"&&(O.registerSystemEvent=!0),O.showFPS=R!==1&&!!O.showFPS,this.collisionMatrix=O.collisionMatrix||[],this.groupList=O.groupList||[],_._resetDebugSetting(O.debugMode),this.config=O,this._configLoaded=!0},_determineRenderType:function(){var O=this.config,R=parseInt(O.renderMode)||0;this.renderType=this.RENDER_TYPE_CANVAS;var P=!1;if(R===0?cc.sys.capabilities.opengl?(this.renderType=this.RENDER_TYPE_WEBGL,P=!0):cc.sys.capabilities.canvas&&(this.renderType=this.RENDER_TYPE_CANVAS,P=!0):R===1&&cc.sys.capabilities.canvas?(this.renderType=this.RENDER_TYPE_CANVAS,P=!0):R===2&&cc.sys.capabilities.opengl&&(this.renderType=this.RENDER_TYPE_WEBGL,P=!0),!P)throw new Error(_.getError(3820,R))},_initRenderer:function(){if(!this._rendererInitialized){var O,R,P,E,D=this.config.id,I=D instanceof HTMLElement?D:document.querySelector(D)||document.querySelector("#"+D);if(I.tagName==="CANVAS"?(O=I.width,R=I.height,this.canvas=P=I,this.container=E=document.createElement("DIV"),P.parentNode&&P.parentNode.insertBefore(E,P)):(I.tagName!=="DIV"&&cc.warnID(3819),O=I.clientWidth,R=I.clientHeight,this.canvas=P=document.createElement("CANVAS"),this.container=E=document.createElement("DIV"),I.appendChild(E)),E.setAttribute("id","Cocos2dGameContainer"),E.appendChild(P),this.frame=E.parentNode===document.body?document.documentElement:E.parentNode,function(N){(" "+N.className+" ").indexOf(" gameCanvas ")>-1||(N.className&&(N.className+=" "),N.className+="gameCanvas")}(P),P.setAttribute("width",O||480),P.setAttribute("height",R||320),P.setAttribute("tabindex",99),this._determineRenderType(),this.renderType===this.RENDER_TYPE_WEBGL){var M={stencil:!0,antialias:cc.macro.ENABLE_WEBGL_ANTIALIAS,alpha:cc.macro.ENABLE_TRANSPARENT_CANVAS};w.initWebGL(P,M),this._renderContext=w.device._gl,!cc.macro.CLEANUP_IMAGE_CACHE&&B&&(B.enabled=!0)}this._renderContext||(this.renderType=this.RENDER_TYPE_CANVAS,w.initCanvas(P),this._renderContext=w.device._ctx),this.canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1},this._rendererInitialized=!0}},_initEvents:function(){var O,R=window;this.config.registerSystemEvent&&cc.internal.inputManager.registerSystemEvent(this.canvas),document.hidden!==void 0?O="hidden":document.mozHidden!==void 0?O="mozHidden":document.msHidden!==void 0?O="msHidden":document.webkitHidden!==void 0&&(O="webkitHidden");var P=!1;function E(){P||(P=!0,A.emit(A.EVENT_HIDE))}function D(N,k,F,G,V){P&&(P=!1,A.emit(A.EVENT_SHOW,N,k,F,G,V))}if(O)for(var I=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"],M=0;M<I.length;M++)document.addEventListener(I[M],function(N){var k=document[O];(k=k||N.hidden)?E():D()});else R.addEventListener("blur",E),R.addEventListener("focus",D);navigator.userAgent.indexOf("MicroMessenger")>-1&&(R.onfocus=D),"onpageshow"in window&&"onpagehide"in window&&(R.addEventListener("pagehide",E),R.addEventListener("pageshow",D),document.addEventListener("pagehide",E),document.addEventListener("pageshow",D)),this.on(A.EVENT_HIDE,function(){A.pause()}),this.on(A.EVENT_SHOW,function(){A.resume()})}};T.call(A),cc.js.addon(A,T.prototype),cc.game=S.exports=A},{"../audio/CCAudioEngine":21,"../core/renderer/utils/dynamic-atlas/manager":230,"./CCDebug":26,"./event/event-target":143,"./renderer/index.js":227}],29:[function(L,S){var T=L("./value-types"),_=L("./value-types/utils"),w=L("./utils/base-node"),B=L("./utils/prefab-helper"),A=L("./utils/trans-pool").NodeMemPool,O=L("./utils/affine-transform"),R=L("./event-manager"),P=L("./platform/CCMacro"),E=L("./platform/js"),D=(L("./event/event"),L("./event/event-target")),I=L("./renderer/render-flow"),M=cc.Object.Flags.Destroying,N=Math.PI/180,k=!!cc.ActionManager,F=function(){},G=new T.Vec3,V=new T.Quat,j=new T.Vec3,H=new T.Vec3,U=new T.Quat,X=new T.Quat,Y=new T.Vec3,z=new T.Vec3,W=new T.Vec3,Z=new T.Vec3,Q=new T.Vec3,ee=new T.Quat,te=new T.Quat,re=new T.Vec3,ie=new T.Quat,ne=new T.Vec3,he=new T.Quat,pe=new T.Vec3,K=new T.Vec3,ue=new T.Quat,le=new T.Quat,ce=(new T.Quat,cc.mat4()),_e=new T.Vec3,oe=new E.Pool;oe.get=function(){return this._get()||[]};var de=cc.Enum({DEBUG:31}),me=cc.Enum({POSITION:1,SCALE:2,ROTATION:4,SKEW:8,TRS:7,RS:6,TRSS:15,PHYSICS_POSITION:16,PHYSICS_SCALE:32,PHYSICS_ROTATION:64,PHYSICS_TRS:112,PHYSICS_RS:96,ALL_POSITION:17,ALL_SCALE:34,ALL_ROTATION:68,ALL_TRS:119,ALL:65535}),ye=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel",POSITION_CHANGED:"position-changed",ROTATION_CHANGED:"rotation-changed",SCALE_CHANGED:"scale-changed",SIZE_CHANGED:"size-changed",ANCHOR_CHANGED:"anchor-changed",COLOR_CHANGED:"color-changed",CHILD_ADDED:"child-added",CHILD_REMOVED:"child-removed",CHILD_REORDER:"child-reorder",GROUP_CHANGED:"group-changed",SIBLING_ORDER_CHANGED:"sibling-order-changed"}),ge=[ye.TOUCH_START,ye.TOUCH_MOVE,ye.TOUCH_END,ye.TOUCH_CANCEL],we=[ye.MOUSE_DOWN,ye.MOUSE_ENTER,ye.MOUSE_MOVE,ye.MOUSE_LEAVE,ye.MOUSE_UP,ye.MOUSE_WHEEL],Te=!0,Ee=function(Be){Be!==0&&(Te&&cc.warn("`cc.Node.skewX/Y` is deprecated since v2.2.1, please use 3D node instead.",""),Te=!1)},De=null,fe=function(Be,je){var Qe=Be.getLocation(),st=this.owner;return!!st._hitTest(Qe,this)&&(je.type=ye.TOUCH_START,je.touch=Be,je.bubbles=!0,st.dispatchEvent(je),!0)},Ce=function(Be,je){var Qe=this.owner;je.type=ye.TOUCH_MOVE,je.touch=Be,je.bubbles=!0,Qe.dispatchEvent(je)},Se=function(Be,je){var Qe=Be.getLocation(),st=this.owner;st._hitTest(Qe,this)?je.type=ye.TOUCH_END:je.type=ye.TOUCH_CANCEL,je.touch=Be,je.bubbles=!0,st.dispatchEvent(je)},be=function(Be,je){Be.getLocation();var Qe=this.owner;je.type=ye.TOUCH_CANCEL,je.touch=Be,je.bubbles=!0,Qe.dispatchEvent(je)},Re=function(Be){var je=Be.getLocation(),Qe=this.owner;Qe._hitTest(je,this)&&(Be.type=ye.MOUSE_DOWN,Be.bubbles=!0,Qe.dispatchEvent(Be))},Ve=function(Be){var je=Be.getLocation(),Qe=this.owner;if(Qe._hitTest(je,this))this._previousIn||(De&&De._mouseListener&&(Be.type=ye.MOUSE_LEAVE,De.dispatchEvent(Be),De._mouseListener._previousIn=!1),De=this.owner,Be.type=ye.MOUSE_ENTER,Qe.dispatchEvent(Be),this._previousIn=!0),Be.type=ye.MOUSE_MOVE,Be.bubbles=!0,Qe.dispatchEvent(Be);else{if(!this._previousIn)return;Be.type=ye.MOUSE_LEAVE,Qe.dispatchEvent(Be),this._previousIn=!1,De=null}Be.stopPropagation()},Pe=function(Be){var je=Be.getLocation(),Qe=this.owner;Qe._hitTest(je,this)&&(Be.type=ye.MOUSE_UP,Be.bubbles=!0,Qe.dispatchEvent(Be),Be.stopPropagation())},ke=function(Be){var je=Be.getLocation(),Qe=this.owner;Qe._hitTest(je,this)&&(Be.type=ye.MOUSE_WHEEL,Be.bubbles=!0,Qe.dispatchEvent(Be),Be.stopPropagation())};function Ne(Be,je){if(je){for(var Qe=0,st=null,pt=Be;pt&&cc.Node.isNode(pt);pt=pt._parent,++Qe)if(pt.getComponent(je)){var qe={index:Qe,node:pt};st?st.push(qe):st=[qe]}return st}return null}function Ae(Be,je){if(!(Be._objFlags&M)){if(Be._bubblingListeners){for(var Qe=0,st=je.length;Qe<st;++Qe)if(Be._bubblingListeners.hasEventListener(je[Qe]))return!0}if(Be._capturingListeners){for(var pt=0,qe=je.length;pt<qe;++pt)if(Be._capturingListeners.hasEventListener(je[pt]))return!0}return!1}return!0}function Oe(Be,je,Qe){var st,pt;for(je.target=Be,Qe.length=0,Be._getCapturingTargets(je.type,Qe),je.eventPhase=1,pt=Qe.length-1;pt>=0;--pt)if((st=Qe[pt])._capturingListeners&&(je.currentTarget=st,st._capturingListeners.emit(je.type,je,Qe),je._propagationStopped))return void(Qe.length=0);if(Qe.length=0,je.eventPhase=2,je.currentTarget=Be,Be._capturingListeners&&Be._capturingListeners.emit(je.type,je),!je._propagationImmediateStopped&&Be._bubblingListeners&&Be._bubblingListeners.emit(je.type,je),!je._propagationStopped&&je.bubbles){for(Be._getBubblingTargets(je.type,Qe),je.eventPhase=3,pt=0;pt<Qe.length;++pt)if((st=Qe[pt])._bubblingListeners&&(je.currentTarget=st,st._bubblingListeners.emit(je.type,je),je._propagationStopped))return void(Qe.length=0)}Qe.length=0}function Fe(Be){var je=Be.groupIndex;return je===0&&Be.parent&&(je=Fe(Be.parent)),je}function nt(Be){var je=Fe(Be);Be._cullingMask=1<<je;for(var Qe=0;Qe<Be._children.length;Qe++)nt(Be._children[Qe])}function Ze(){if(this._localMatDirty&me.TRSS){var Be=this._matrix,je=Be.m;if(T.Trs.toMat4(Be,this._trs),this._skewX||this._skewY){var Qe=je[0],st=je[1],pt=je[4],qe=je[5],rt=Math.tan(this._skewX*N),bt=Math.tan(this._skewY*N);rt===1/0&&(rt=99999999),bt===1/0&&(bt=99999999),je[0]=Qe+pt*bt,je[1]=st+qe*bt,je[4]=pt+Qe*rt,je[5]=qe+st*rt}this._localMatDirty&=~me.TRSS,this._worldMatDirty=!0}}function Xe(){var Be=this._localMatDirty;if(Be&me.TRSS){var je=this._matrix.m,Qe=this._trs;if(Be&(me.RS|me.SKEW)){var st=-this._eulerAngles.z,pt=this._skewX||this._skewY,qe=Qe[7],rt=Qe[8];if(st||pt){var bt=1,Dt=0,Et=0,Lt=1;if(st){var Ot=st*N;Et=Math.sin(Ot),bt=Lt=Math.cos(Ot),Dt=-Et}if(je[0]=bt*=qe,je[1]=Dt*=qe,je[4]=Et*=rt,je[5]=Lt*=rt,pt){var Kt=je[0],Jt=je[1],Yt=je[4],Wt=je[5],rr=Math.tan(this._skewX*N),Ft=Math.tan(this._skewY*N);rr===1/0&&(rr=99999999),Ft===1/0&&(Ft=99999999),je[0]=Kt+Yt*Ft,je[1]=Jt+Wt*Ft,je[4]=Yt+Kt*rr,je[5]=Wt+Jt*rr}}else je[0]=qe,je[1]=0,je[4]=0,je[5]=rt}je[12]=Qe[0],je[13]=Qe[1],this._localMatDirty&=~me.TRSS,this._worldMatDirty=!0}}function $e(){if(this._localMatDirty&me.TRSS&&this._updateLocalMatrix(),this._parent){var Be=this._parent._worldMatrix;T.Mat4.mul(this._worldMatrix,Be,this._matrix)}else T.Mat4.copy(this._worldMatrix,this._matrix);this._worldMatDirty=!1}function ot(){this._localMatDirty&me.TRSS&&this._updateLocalMatrix();var Be=this._parent;Be?this._mulMat(this._worldMatrix,Be._worldMatrix,this._matrix):T.Mat4.copy(this._worldMatrix,this._matrix),this._worldMatDirty=!1}function ut(Be,je,Qe){var st=je.m,pt=Qe.m,qe=Be.m,rt=st[0],bt=st[1],Dt=st[4],Et=st[5],Lt=st[12],Ot=st[13],Kt=pt[0],Jt=pt[1],Yt=pt[4],Wt=pt[5],rr=pt[12],Ft=pt[13];bt!==0||Dt!==0?(qe[0]=Kt*rt+Jt*Dt,qe[1]=Kt*bt+Jt*Et,qe[4]=Yt*rt+Wt*Dt,qe[5]=Yt*bt+Wt*Et,qe[12]=rt*rr+Dt*Ft+Lt,qe[13]=bt*rr+Et*Ft+Ot):(qe[0]=Kt*rt,qe[1]=Jt*Et,qe[4]=Yt*rt,qe[5]=Wt*Et,qe[12]=rt*rr+Lt,qe[13]=Et*Ft+Ot)}var gt=T.Mat4.mul,Ue={name:"cc.Node",extends:w,properties:{_opacity:255,_color:cc.Color.WHITE,_contentSize:cc.Size,_anchorPoint:cc.v2(.5,.5),_position:void 0,_scale:void 0,_trs:null,_eulerAngles:cc.Vec3,_skewX:0,_skewY:0,_zIndex:{default:void 0,type:cc.Integer},_localZOrder:{default:0,serializable:!1},_is3DNode:!1,_groupIndex:{default:0,formerlySerializedAs:"groupIndex"},groupIndex:{get:function(){return this._groupIndex},set:function(Be){this._groupIndex=Be,nt(this),this.emit(ye.GROUP_CHANGED,this)}},group:{get:function(){return cc.game.groupList[this.groupIndex]||""},set:function(Be){this.groupIndex=cc.game.groupList.indexOf(Be)}},x:{get:function(){return this._trs[0]},set:function(Be){var je=this._trs;Be!==je[0]&&(je[0]=Be,this.setLocalDirty(me.ALL_POSITION),1&this._eventMask&&this.emit(ye.POSITION_CHANGED))}},y:{get:function(){return this._trs[1]},set:function(Be){var je=this._trs;Be!==je[1]&&(je[1]=Be,this.setLocalDirty(me.ALL_POSITION),1&this._eventMask&&this.emit(ye.POSITION_CHANGED))}},z:{get:function(){return this._trs[2]},set:function(Be){var je=this._trs;Be!==je[2]&&(je[2]=Be,this.setLocalDirty(me.ALL_POSITION),this._renderFlag|=I.FLAG_WORLD_TRANSFORM,1&this._eventMask&&this.emit(ye.POSITION_CHANGED))}},rotation:{get:function(){return-this.angle},set:function(Be){this.angle=-Be}},angle:{get:function(){return this._eulerAngles.z},set:function(Be){T.Vec3.set(this._eulerAngles,0,0,Be),T.Trs.fromAngleZ(this._trs,Be),this.setLocalDirty(me.ALL_ROTATION),4&this._eventMask&&this.emit(ye.ROTATION_CHANGED)}},rotationX:{get:function(){return this._eulerAngles.x},set:function(Be){this._eulerAngles.x!==Be&&(this._eulerAngles.x=Be,this._eulerAngles.x===this._eulerAngles.y?T.Trs.fromAngleZ(this._trs,-Be):T.Trs.fromEulerNumber(this._trs,Be,this._eulerAngles.y,0),this.setLocalDirty(me.ALL_ROTATION),4&this._eventMask&&this.emit(ye.ROTATION_CHANGED))}},rotationY:{get:function(){return this._eulerAngles.y},set:function(Be){this._eulerAngles.y!==Be&&(this._eulerAngles.y=Be,this._eulerAngles.x===this._eulerAngles.y?T.Trs.fromAngleZ(this._trs,-Be):T.Trs.fromEulerNumber(this._trs,this._eulerAngles.x,Be,0),this.setLocalDirty(me.ALL_ROTATION),4&this._eventMask&&this.emit(ye.ROTATION_CHANGED))}},eulerAngles:{get:function(){return T.Trs.toEuler(this._eulerAngles,this._trs)},set:function(Be){T.Trs.fromEuler(this._trs,Be),this.setLocalDirty(me.ALL_ROTATION),this._renderFlag|=I.FLAG_TRANSFORM,4&this._eventMask&&this.emit(ye.ROTATION_CHANGED)}},quat:{get:function(){var Be=this._trs;return new T.Quat(Be[3],Be[4],Be[5],Be[6])},set:function(Be){this.setRotation(Be)}},scale:{get:function(){return this._trs[7]},set:function(Be){this.setScale(Be)}},scaleX:{get:function(){return this._trs[7]},set:function(Be){this._trs[7]!==Be&&(this._trs[7]=Be,this.setLocalDirty(me.ALL_SCALE),2&this._eventMask&&this.emit(ye.SCALE_CHANGED))}},scaleY:{get:function(){return this._trs[8]},set:function(Be){this._trs[8]!==Be&&(this._trs[8]=Be,this.setLocalDirty(me.ALL_SCALE),2&this._eventMask&&this.emit(ye.SCALE_CHANGED))}},scaleZ:{get:function(){return this._trs[9]},set:function(Be){this._trs[9]!==Be&&(this._trs[9]=Be,this.setLocalDirty(me.ALL_SCALE),this._renderFlag|=I.FLAG_TRANSFORM,2&this._eventMask&&this.emit(ye.SCALE_CHANGED))}},skewX:{get:function(){return this._skewX},set:function(Be){Ee(Be),this._skewX=Be,this.setLocalDirty(me.SKEW)}},skewY:{get:function(){return this._skewY},set:function(Be){Ee(Be),this._skewY=Be,this.setLocalDirty(me.SKEW)}},opacity:{get:function(){return this._opacity},set:function(Be){Be=cc.misc.clampf(Be,0,255),this._opacity!==Be&&(this._opacity=Be,this._renderFlag|=I.FLAG_OPACITY_COLOR)},range:[0,255]},color:{get:function(){return this._color.clone()},set:function(Be){this._color.equals(Be)||(this._color.set(Be),this._renderFlag|=I.FLAG_COLOR,32&this._eventMask&&this.emit(ye.COLOR_CHANGED,Be))}},anchorX:{get:function(){return this._anchorPoint.x},set:function(Be){var je=this._anchorPoint;je.x!==Be&&(je.x=Be,16&this._eventMask&&this.emit(ye.ANCHOR_CHANGED))}},anchorY:{get:function(){return this._anchorPoint.y},set:function(Be){var je=this._anchorPoint;je.y!==Be&&(je.y=Be,16&this._eventMask&&this.emit(ye.ANCHOR_CHANGED))}},width:{get:function(){return this._contentSize.width},set:function(Be){Be!==this._contentSize.width&&(this._contentSize.width=Be,8&this._eventMask&&this.emit(ye.SIZE_CHANGED))}},height:{get:function(){return this._contentSize.height},set:function(Be){Be!==this._contentSize.height&&(this._contentSize.height=Be,8&this._eventMask&&this.emit(ye.SIZE_CHANGED))}},zIndex:{get:function(){return this._localZOrder>>16},set:function(Be){Be>P.MAX_ZINDEX?(cc.warnID(1636),Be=P.MAX_ZINDEX):Be<P.MIN_ZINDEX&&(cc.warnID(1637),Be=P.MIN_ZINDEX),this.zIndex!==Be&&(this._localZOrder=65535&this._localZOrder|Be<<16,this.emit(ye.SIBLING_ORDER_CHANGED),this._onSiblingIndexChanged())}},is3DNode:{get:function(){return this._is3DNode},set:function(Be){this._is3DNode!==Be&&(this._is3DNode=Be,this._update3DFunction())}},up:{get:function(){return T.Vec3.transformQuat(ne,T.Vec3.UP,this.getWorldRotation(he)).clone()}},right:{get:function(){return T.Vec3.transformQuat(ne,T.Vec3.RIGHT,this.getWorldRotation(he)).clone()}},forward:{get:function(){return T.Vec3.transformQuat(ne,T.Vec3.FORWARD,this.getWorldRotation(he)).clone()}}},ctor:function(){this._reorderChildDirty=!1,this._widget=null,this._renderComponent=null,this._capturingListeners=null,this._bubblingListeners=null,this._touchListener=null,this._mouseListener=null,this._initDataFromPool(),this._eventMask=0,this._cullingMask=1,this._childArrivalOrder=1,this._renderFlag=I.FLAG_TRANSFORM|I.FLAG_OPACITY_COLOR},statics:{EventType:ye,_LocalDirtyFlag:me,isNode:function(Be){return Be instanceof We&&(Be.constructor===We||!(Be instanceof cc.Scene))},BuiltinGroupIndex:de},_onSiblingIndexChanged:function(){this._parent&&this._parent._delaySort()},_onPreDestroy:function(){this._onPreDestroyBase(),k&&cc.director.getActionManager().removeAllActionsFromTarget(this),De===this&&(De=null),this._bubblingListeners&&this._bubblingListeners.clear(),this._capturingListeners&&this._capturingListeners.clear(),(this._touchListener||this._mouseListener)&&(R.removeListeners(this),this._touchListener&&(this._touchListener.owner=null,this._touchListener.mask=null,this._touchListener=null),this._mouseListener&&(this._mouseListener.owner=null,this._mouseListener.mask=null,this._mouseListener=null)),this._backDataIntoPool(),this._reorderChildDirty&&cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_onPostActivated:function(Be){var je=k?cc.director.getActionManager():null;Be?(this._renderFlag|=I.FLAG_WORLD_TRANSFORM,je&&je.resumeTarget(this),R.resumeTarget(this),this._checkListenerMask()):(je&&je.pauseTarget(this),R.pauseTarget(this))},_onHierarchyChanged:function(Be){this._updateOrderOfArrival(),nt(this),this._parent&&this._parent._delaySort(),this._renderFlag|=I.FLAG_WORLD_TRANSFORM|I.FLAG_OPACITY_COLOR,this._onHierarchyChangedBase(Be),cc._widgetManager&&(cc._widgetManager._nodesOrderDirty=!0),Be&&this._activeInHierarchy&&this._checkListenerMask()},_update3DFunction:function(){this._is3DNode?(this._updateLocalMatrix=Ze,this._calculWorldMatrix=$e,this._mulMat=gt):(this._updateLocalMatrix=Xe,this._calculWorldMatrix=ot,this._mulMat=ut),this._renderComponent&&this._renderComponent._on3DNodeChanged&&this._renderComponent._on3DNodeChanged(),this._renderFlag|=I.FLAG_TRANSFORM,this._localMatDirty=me.ALL},_initDataFromPool:function(){this._spaceInfo||(this._spaceInfo=A.pop());var Be=this._spaceInfo;this._matrix=cc.mat4(Be.localMat),T.Mat4.identity(this._matrix),this._worldMatrix=cc.mat4(Be.worldMat),T.Mat4.identity(this._worldMatrix),this._localMatDirty=me.ALL,this._worldMatDirty=!0;var je=this._trs=Be.trs;je[0]=0,je[1]=0,je[2]=0,je[3]=0,je[4]=0,je[5]=0,je[6]=1,je[7]=1,je[8]=1,je[9]=1},_backDataIntoPool:function(){A.push(this._spaceInfo),this._matrix=null,this._worldMatrix=null,this._trs=null,this._spaceInfo=null},_toEuler:function(){if(this.is3DNode)T.Trs.toEuler(this._eulerAngles,this._trs);else{var Be=Math.asin(this._trs[5])/N*2;T.Vec3.set(this._eulerAngles,0,0,Be)}},_fromEuler:function(){this.is3DNode?T.Trs.fromEuler(this._trs,this._eulerAngles):T.Trs.fromAngleZ(this._trs,this._eulerAngles.z)},_initProperties:function(){this._is3DNode&&this._update3DFunction();var Be=this._trs;if(Be){var je=Be;Be=this._trs=this._spaceInfo.trs,je.length===11?Be.set(je.subarray(1)):Be.set(je)}else Be=this._trs=this._spaceInfo.trs;this._fromEuler()},_onBatchCreated:function(Be){this._initProperties(),this._cullingMask=1<<Fe(this),this._activeInHierarchy||(k&&cc.director.getActionManager().pauseTarget(this),R.pauseTarget(this));for(var je=this._children,Qe=0,st=je.length;Qe<st;Qe++){var pt=je[Qe];if(!Be){var qe=pt._prefab;qe&&qe.sync&&qe.root===pt&&B.syncWithPrefab(pt),pt._updateOrderOfArrival()}pt._onBatchCreated(Be)}je.length>0&&(this._renderFlag|=I.FLAG_CHILDREN)},_checkListenerMask:function(){if(this._touchListener){var Be=this._touchListener.mask=Ne(this,cc.Mask);this._mouseListener&&(this._mouseListener.mask=Be)}else this._mouseListener&&(this._mouseListener.mask=Ne(this,cc.Mask))},_checknSetupSysEvent:function(Be){var je=!1,Qe=!1;return ge.indexOf(Be)!==-1?(this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this,mask:Ne(this,cc.Mask),onTouchBegan:fe,onTouchMoved:Ce,onTouchEnded:Se,onTouchCancelled:be}),R.addListener(this._touchListener,this),je=!0),Qe=!0):we.indexOf(Be)!==-1&&(this._mouseListener||(this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:Ne(this,cc.Mask),onMouseDown:Re,onMouseMove:Ve,onMouseUp:Pe,onMouseScroll:ke}),R.addListener(this._mouseListener,this),je=!0),Qe=!0),je&&!this._activeInHierarchy&&cc.director.getScheduler().schedule(function(){this._activeInHierarchy||R.pauseTarget(this)},this,0,0,0,!1),Qe},on:function(Be,je,Qe,st){if(this._checknSetupSysEvent(Be))return this._onDispatch(Be,je,Qe,st);switch(Be){case ye.POSITION_CHANGED:this._eventMask|=1;break;case ye.SCALE_CHANGED:this._eventMask|=2;break;case ye.ROTATION_CHANGED:this._eventMask|=4;break;case ye.SIZE_CHANGED:this._eventMask|=8;break;case ye.ANCHOR_CHANGED:this._eventMask|=16;break;case ye.COLOR_CHANGED:this._eventMask|=32}return this._bubblingListeners||(this._bubblingListeners=new D),this._bubblingListeners.on(Be,je,Qe)},once:function(Be,je,Qe,st){var pt=this,qe=null;(qe=this._checknSetupSysEvent(Be)&&st?this._capturingListeners=this._capturingListeners||new D:this._bubblingListeners=this._bubblingListeners||new D).once(Be,je,Qe),qe.once(Be,function(){pt.off(Be,je,Qe)},void 0)},_onDispatch:function(Be,je,Qe,st){if(typeof Qe=="boolean"?(st=Qe,Qe=void 0):st=!!st,je){var pt=null;return(pt=st?this._capturingListeners=this._capturingListeners||new D:this._bubblingListeners=this._bubblingListeners||new D).hasEventListener(Be,je,Qe)||(pt.on(Be,je,Qe),Qe&&Qe.__eventTargets&&Qe.__eventTargets.push(this)),je}cc.errorID(6800)},off:function(Be,je,Qe,st){var pt=ge.indexOf(Be)!==-1,qe=!pt&&we.indexOf(Be)!==-1;if(pt||qe)this._offDispatch(Be,je,Qe,st),pt?this._touchListener&&!Ae(this,ge)&&(R.removeListener(this._touchListener),this._touchListener=null):qe&&this._mouseListener&&!Ae(this,we)&&(R.removeListener(this._mouseListener),this._mouseListener=null);else if(this._bubblingListeners&&(this._bubblingListeners.off(Be,je,Qe),!this._bubblingListeners.hasEventListener(Be)))switch(Be){case ye.POSITION_CHANGED:this._eventMask&=-2;break;case ye.SCALE_CHANGED:this._eventMask&=-3;break;case ye.ROTATION_CHANGED:this._eventMask&=-5;break;case ye.SIZE_CHANGED:this._eventMask&=-9;break;case ye.ANCHOR_CHANGED:this._eventMask&=-17;break;case ye.COLOR_CHANGED:this._eventMask&=-33}},_offDispatch:function(Be,je,Qe,st){if(typeof Qe=="boolean"?(st=Qe,Qe=void 0):st=!!st,je){var pt=st?this._capturingListeners:this._bubblingListeners;pt&&(pt.off(Be,je,Qe),Qe&&Qe.__eventTargets&&E.array.fastRemove(Qe.__eventTargets,this))}else this._capturingListeners&&this._capturingListeners.removeAll(Be),this._bubblingListeners&&this._bubblingListeners.removeAll(Be)},targetOff:function(Be){var je=this._bubblingListeners;je&&(je.targetOff(Be),1&this._eventMask&&!je.hasEventListener(ye.POSITION_CHANGED)&&(this._eventMask&=-2),2&this._eventMask&&!je.hasEventListener(ye.SCALE_CHANGED)&&(this._eventMask&=-3),4&this._eventMask&&!je.hasEventListener(ye.ROTATION_CHANGED)&&(this._eventMask&=-5),8&this._eventMask&&!je.hasEventListener(ye.SIZE_CHANGED)&&(this._eventMask&=-9),16&this._eventMask&&!je.hasEventListener(ye.ANCHOR_CHANGED)&&(this._eventMask&=-17),32&this._eventMask&&!je.hasEventListener(ye.COLOR_CHANGED)&&(this._eventMask&=-33)),this._capturingListeners&&this._capturingListeners.targetOff(Be),Be&&Be.__eventTargets&&E.array.fastRemove(Be.__eventTargets,this),this._touchListener&&!Ae(this,ge)&&(R.removeListener(this._touchListener),this._touchListener=null),this._mouseListener&&!Ae(this,we)&&(R.removeListener(this._mouseListener),this._mouseListener=null)},hasEventListener:function(Be){var je=!1;return this._bubblingListeners&&(je=this._bubblingListeners.hasEventListener(Be)),!je&&this._capturingListeners&&(je=this._capturingListeners.hasEventListener(Be)),je},emit:function(Be,je,Qe,st,pt,qe){this._bubblingListeners&&this._bubblingListeners.emit(Be,je,Qe,st,pt,qe)},dispatchEvent:function(Be){var je=oe.get();Oe(this,Be,je),oe.put(je)},pauseSystemEvents:function(Be){R.pauseTarget(this,Be)},resumeSystemEvents:function(Be){R.resumeTarget(this,Be)},_hitTest:function(Be,je){var Qe=this._contentSize.width,st=this._contentSize.height,pt=pe,qe=K,rt=cc.Camera.findCamera(this);if(rt?rt.getScreenToWorldPoint(Be,pt):pt.set(Be),this._updateWorldMatrix(),!T.Mat4.invert(ce,this._worldMatrix))return!1;T.Vec2.transformMat4(qe,pt,ce),qe.x+=this._anchorPoint.x*Qe,qe.y+=this._anchorPoint.y*st;var bt=!1;if(qe.x>=0&&qe.y>=0&&qe.x<=Qe&&qe.y<=st&&(bt=!0,je&&je.mask))for(var Dt=je.mask,Et=this,Lt=Dt?Dt.length:0,Ot=0,Kt=0;Et&&Kt<Lt;++Ot,Et=Et.parent){var Jt=Dt[Kt];if(Ot===Jt.index){if(Et!==Jt.node){Dt.length=Kt;break}var Yt=Et.getComponent(cc.Mask);if(Yt&&Yt._enabled&&!Yt._hitTest(pt)){bt=!1;break}Kt++}else if(Ot>Jt.index){Dt.length=Kt;break}}return bt},_getCapturingTargets:function(Be,je){for(var Qe=this.parent;Qe;)Qe._capturingListeners&&Qe._capturingListeners.hasEventListener(Be)&&je.push(Qe),Qe=Qe.parent},_getBubblingTargets:function(Be,je){for(var Qe=this.parent;Qe;)Qe._bubblingListeners&&Qe._bubblingListeners.hasEventListener(Be)&&je.push(Qe),Qe=Qe.parent},runAction:k?function(Be){if(this.active){cc.assertID(Be,1618);var je=cc.director.getActionManager();return je._suppressDeprecation||(je._suppressDeprecation=!0,cc.warnID(1639)),je.addAction(Be,this,!1),Be}}:F,pauseAllActions:k?function(){cc.director.getActionManager().pauseTarget(this)}:F,resumeAllActions:k?function(){cc.director.getActionManager().resumeTarget(this)}:F,stopAllActions:k?function(){cc.director.getActionManager().removeAllActionsFromTarget(this)}:F,stopAction:k?function(Be){cc.director.getActionManager().removeAction(Be)}:F,stopActionByTag:k?function(Be){Be!==cc.Action.TAG_INVALID?cc.director.getActionManager().removeActionByTag(Be,this):cc.logID(1612)}:F,getActionByTag:k?function(Be){return Be===cc.Action.TAG_INVALID?(cc.logID(1613),null):cc.director.getActionManager().getActionByTag(Be,this)}:function(){return null},getNumberOfRunningActions:k?function(){return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)}:function(){return 0},getPosition:function(Be){return Be=Be||new T.Vec3,T.Trs.toPosition(Be,this._trs)},setPosition:function(Be,je,Qe){var st;je===void 0?(st=Be.x,je=Be.y,Qe=Be.z):st=Be;var pt=this._trs;Qe===void 0&&(Qe=pt[2]),(pt[0]!==st||pt[1]!==je||pt[2]!==Qe)&&(pt[0]=st,pt[1]=je,pt[2]=Qe,this.setLocalDirty(me.ALL_POSITION),this._renderFlag|=I.FLAG_WORLD_TRANSFORM,1&this._eventMask&&this.emit(ye.POSITION_CHANGED))},getScale:function(Be){return Be!==void 0?T.Trs.toScale(Be,this._trs):(cc.errorID(1400,"cc.Node.getScale","cc.Node.scale or cc.Node.getScale(cc.Vec3)"),this._trs[7])},setScale:function(Be,je,Qe){var st;Be&&typeof Be!="number"?(st=Be.x,je=Be.y,Qe=Be.z):Be!==void 0&&je===void 0?(st=Be,je=Be,Qe=Be):st=Be;var pt=this._trs;Qe===void 0&&(Qe=pt[9]),pt[7]===st&&pt[8]===je&&pt[9]===Qe||(pt[7]=st,pt[8]=je,pt[9]=Qe,this.setLocalDirty(me.ALL_SCALE),this._renderFlag|=I.FLAG_TRANSFORM,2&this._eventMask&&this.emit(ye.SCALE_CHANGED))},getRotation:function(Be){return Be instanceof T.Quat?T.Trs.toRotation(Be,this._trs):-this.angle},setRotation:function(Be,je,Qe,st){if(typeof Be=="number"&&je===void 0)this.angle=-Be;else{var pt=Be;je===void 0&&(pt=Be.x,je=Be.y,Qe=Be.z,st=Be.w);var qe=this._trs;qe[3]===pt&&qe[4]===je&&qe[5]===Qe&&qe[6]===st||(qe[3]=pt,qe[4]=je,qe[5]=Qe,qe[6]=st,this.setLocalDirty(me.ALL_ROTATION),4&this._eventMask&&this.emit(ye.ROTATION_CHANGED))}},getContentSize:function(){return cc.size(this._contentSize.width,this._contentSize.height)},setContentSize:function(Be,je){var Qe=this._contentSize;if(je===void 0){if((0,_.approx)(Be.width,Qe.width)&&(0,_.approx)(Be.height,Qe.height))return;Qe.width=Be.width,Qe.height=Be.height}else{if((0,_.approx)(Be,Qe.width)&&(0,_.approx)(je,Qe.height))return;Qe.width=Be,Qe.height=je}8&this._eventMask&&this.emit(ye.SIZE_CHANGED)},getAnchorPoint:function(){return cc.v2(this._anchorPoint)},setAnchorPoint:function(Be,je){var Qe=this._anchorPoint;if(je===void 0){if(Be.x===Qe.x&&Be.y===Qe.y)return;Qe.x=Be.x,Qe.y=Be.y}else{if(Be===Qe.x&&je===Qe.y)return;Qe.x=Be,Qe.y=je}this.setLocalDirty(me.ALL_POSITION),16&this._eventMask&&this.emit(ye.ANCHOR_CHANGED)},_invTransformPoint:function(Be,je){this._parent?this._parent._invTransformPoint(Be,je):T.Vec3.copy(Be,je);var Qe=this._trs;return T.Trs.toPosition(j,Qe),T.Vec3.sub(Be,Be,j),T.Trs.toRotation(U,Qe),T.Quat.conjugate(X,U),T.Vec3.transformQuat(Be,Be,X),T.Trs.toScale(j,Qe),T.Vec3.inverseSafe(H,j),T.Vec3.mul(Be,Be,H),Be},getWorldPosition:function(Be){T.Trs.toPosition(Be,this._trs);for(var je,Qe=this._parent;Qe;)je=Qe._trs,T.Trs.toScale(G,je),T.Vec3.mul(Be,Be,G),T.Trs.toRotation(V,je),T.Vec3.transformQuat(Be,Be,V),T.Trs.toPosition(G,je),T.Vec3.add(Be,Be,G),Qe=Qe._parent;return Be},setWorldPosition:function(Be){var je=this._trs;this._parent?this._parent._invTransformPoint(Y,Be):T.Vec3.copy(Y,Be),T.Trs.fromPosition(je,Y),this.setLocalDirty(me.ALL_POSITION),1&this._eventMask&&this.emit(ye.POSITION_CHANGED)},getWorldRotation:function(Be){T.Trs.toRotation(ue,this._trs),T.Quat.copy(Be,ue);for(var je=this._parent;je;)T.Trs.toRotation(ue,je._trs),T.Quat.mul(Be,ue,Be),je=je._parent;return Be},setWorldRotation:function(Be){this._parent?(this._parent.getWorldRotation(le),T.Quat.conjugate(le,le),T.Quat.mul(le,le,Be)):T.Quat.copy(le,Be),T.Trs.fromRotation(this._trs,le),this.setLocalDirty(me.ALL_ROTATION)},getWorldScale:function(Be){T.Trs.toScale(z,this._trs),T.Vec3.copy(Be,z);for(var je=this._parent;je;)T.Trs.toScale(z,je._trs),T.Vec3.mul(Be,Be,z),je=je._parent;return Be},setWorldScale:function(Be){this._parent?(this._parent.getWorldScale(W),T.Vec3.div(W,Be,W)):T.Vec3.copy(W,Be),T.Trs.fromScale(this._trs,W),this.setLocalDirty(me.ALL_SCALE)},getWorldRT:function(Be){var je=Z,Qe=ee,st=this._trs;T.Trs.toPosition(je,st),T.Trs.toRotation(Qe,st);for(var pt=this._parent;pt;)st=pt._trs,T.Trs.toScale(Q,st),T.Vec3.mul(je,je,Q),T.Trs.toRotation(te,st),T.Vec3.transformQuat(je,je,te),T.Trs.toPosition(Q,st),T.Vec3.add(je,je,Q),T.Quat.mul(Qe,te,Qe),pt=pt._parent;return T.Mat4.fromRT(Be,Qe,je),Be},lookAt:function(Be,je){this.getWorldPosition(re),T.Vec3.sub(re,re,Be),T.Vec3.normalize(re,re),T.Quat.fromViewUp(ie,re,je),this.setWorldRotation(ie)},_updateLocalMatrix:Xe,_calculWorldMatrix:function(){this._localMatDirty&me.TRSS&&this._updateLocalMatrix();var Be=this._parent;Be?this._mulMat(this._worldMatrix,Be._worldMatrix,this._matrix):T.Mat4.copy(this._worldMatrix,this._matrix),this._worldMatDirty=!1},_mulMat:ut,_updateWorldMatrix:function(){if(this._parent&&this._parent._updateWorldMatrix(),this._worldMatDirty){this._calculWorldMatrix();for(var Be=this._children,je=0,Qe=Be.length;je<Qe;je++)Be[je]._worldMatDirty=!0}},setLocalDirty:function(Be){this._localMatDirty|=Be,this._worldMatDirty=!0,Be===me.ALL_POSITION||Be===me.POSITION?this._renderFlag|=I.FLAG_WORLD_TRANSFORM:this._renderFlag|=I.FLAG_TRANSFORM},setWorldDirty:function(){this._worldMatDirty=!0},getLocalMatrix:function(Be){return this._updateLocalMatrix(),T.Mat4.copy(Be,this._matrix)},getWorldMatrix:function(Be){return this._updateWorldMatrix(),T.Mat4.copy(Be,this._worldMatrix)},convertToNodeSpaceAR:function(Be,je){return this._updateWorldMatrix(),T.Mat4.invert(ce,this._worldMatrix),Be instanceof cc.Vec2?(je=je||new cc.Vec2,T.Vec2.transformMat4(je,Be,ce)):(je=je||new cc.Vec3,T.Vec3.transformMat4(je,Be,ce))},convertToWorldSpaceAR:function(Be,je){return this._updateWorldMatrix(),Be instanceof cc.Vec2?(je=je||new cc.Vec2,T.Vec2.transformMat4(je,Be,this._worldMatrix)):(je=je||new cc.Vec3,T.Vec3.transformMat4(je,Be,this._worldMatrix))},convertToNodeSpace:function(Be){this._updateWorldMatrix(),T.Mat4.invert(ce,this._worldMatrix);var je=new cc.Vec2;return T.Vec2.transformMat4(je,Be,ce),je.x+=this._anchorPoint.x*this._contentSize.width,je.y+=this._anchorPoint.y*this._contentSize.height,je},convertToWorldSpace:function(Be){this._updateWorldMatrix();var je=new cc.Vec2(Be.x-this._anchorPoint.x*this._contentSize.width,Be.y-this._anchorPoint.y*this._contentSize.height);return T.Vec2.transformMat4(je,je,this._worldMatrix)},getNodeToParentTransform:function(Be){Be||(Be=O.identity()),this._updateLocalMatrix();var je=this._contentSize;return _e.x=-this._anchorPoint.x*je.width,_e.y=-this._anchorPoint.y*je.height,T.Mat4.copy(ce,this._matrix),T.Mat4.transform(ce,ce,_e),O.fromMat4(Be,ce)},getNodeToParentTransformAR:function(Be){return Be||(Be=O.identity()),this._updateLocalMatrix(),O.fromMat4(Be,this._matrix)},getNodeToWorldTransform:function(Be){Be||(Be=O.identity()),this._updateWorldMatrix();var je=this._contentSize;return _e.x=-this._anchorPoint.x*je.width,_e.y=-this._anchorPoint.y*je.height,T.Mat4.copy(ce,this._worldMatrix),T.Mat4.transform(ce,ce,_e),O.fromMat4(Be,ce)},getNodeToWorldTransformAR:function(Be){return Be||(Be=O.identity()),this._updateWorldMatrix(),O.fromMat4(Be,this._worldMatrix)},getParentToNodeTransform:function(Be){return Be||(Be=O.identity()),this._updateLocalMatrix(),T.Mat4.invert(ce,this._matrix),O.fromMat4(Be,ce)},getWorldToNodeTransform:function(Be){return Be||(Be=O.identity()),this._updateWorldMatrix(),T.Mat4.invert(ce,this._worldMatrix),O.fromMat4(Be,ce)},convertTouchToNodeSpace:function(Be){return this.convertToNodeSpace(Be.getLocation())},convertTouchToNodeSpaceAR:function(Be){return this.convertToNodeSpaceAR(Be.getLocation())},getBoundingBox:function(){this._updateLocalMatrix();var Be=this._contentSize.width,je=this._contentSize.height,Qe=cc.rect(-this._anchorPoint.x*Be,-this._anchorPoint.y*je,Be,je);return Qe.transformMat4(Qe,this._matrix)},getBoundingBoxToWorld:function(){return this._parent?(this._parent._updateWorldMatrix(),this._getBoundingBoxTo()):this.getBoundingBox()},_getBoundingBoxTo:function(){var Be=this._contentSize.width,je=this._contentSize.height,Qe=cc.rect(-this._anchorPoint.x*Be,-this._anchorPoint.y*je,Be,je);if(this._calculWorldMatrix(),Qe.transformMat4(Qe,this._worldMatrix),!this._children)return Qe;for(var st=this._children,pt=0;pt<st.length;pt++){var qe=st[pt];if(qe&&qe.active){var rt=qe._getBoundingBoxTo();rt&&Qe.union(Qe,rt)}}return Qe},_updateOrderOfArrival:function(){var Be=this._parent?++this._parent._childArrivalOrder:0;this._localZOrder=4294901760&this._localZOrder|Be,this.emit(ye.SIBLING_ORDER_CHANGED)},setSelfGroupIndex:function(Be){this._groupIndex=Be||0,this._cullingMask=1<<Be},addChild:function(Be,je,Qe){cc.assertID(Be,1606),cc.assertID(Be._parent===null,1605),Be.parent=this,je!==void 0&&(Be.zIndex=je),Qe!==void 0&&(Be.name=Qe)},cleanup:function(){k&&cc.director.getActionManager().removeAllActionsFromTarget(this),R.removeListeners(this);var Be,je,Qe=this._children.length;for(Be=0;Be<Qe;++Be)(je=this._children[Be])&&je.cleanup()},sortAllChildren:function(){if(this._reorderChildDirty){this._reorderChildDirty=!1;var Be=this._children;this._childArrivalOrder=1;for(var je=0,Qe=Be.length;je<Qe;je++)Be[je]._updateOrderOfArrival();if(R._setDirtyForNode(this),Be.length>1){for(var st,pt,qe=1,rt=Be.length;qe<rt;qe++){st=Be[qe];for(var bt=qe;bt>0&&(pt=Be[bt-1])._localZOrder>st._localZOrder;bt--)Be[bt]=pt;Be[bt]=st}this.emit(ye.CHILD_REORDER,this)}cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)}},_delaySort:function(){this._reorderChildDirty||(this._reorderChildDirty=!0,cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this))},_restoreProperties:!1,onRestore:!1},We=cc.Class(Ue),ht=We.prototype;E.getset(ht,"position",ht.getPosition,ht.setPosition,!1,!0),cc.Node=S.exports=We},{"./event-manager":141,"./event/event":144,"./event/event-target":143,"./platform/CCMacro":201,"./platform/js":217,"./renderer/render-flow":228,"./utils/affine-transform":262,"./utils/base-node":263,"./utils/prefab-helper":274,"./utils/trans-pool":280,"./value-types":286,"./value-types/utils":293}],30:[function(L,S){var T=L("./CCNode"),_=L("./renderer/render-flow"),w=(cc.Object.Flags.HideInHierarchy,T._LocalDirtyFlag),B=cc.Class({name:"cc.PrivateNode",extends:T,properties:{x:{get:function(){return this._originPos.x},set:function(O){var R=this._originPos;O!==R.x&&(R.x=O,this._posDirty(!0))},override:!0},y:{get:function(){return this._originPos.y},set:function(O){var R=this._originPos;O!==R.y&&(R.y=O,this._posDirty(!0))},override:!0},zIndex:{get:function(){return cc.macro.MIN_ZINDEX},set:function(){},override:!0},showInEditor:{default:!1,editorOnly:!0,override:!0}},ctor:function(){this._localZOrder=cc.macro.MIN_ZINDEX<<16,this._originPos=cc.v2()},_posDirty:function(O){this.setLocalDirty(w.POSITION),this._renderFlag|=_.FLAG_TRANSFORM,O===!0&&1&this._eventMask&&this.emit(T.EventType.POSITION_CHANGED)},_updateLocalMatrix:function(){if(this._localMatDirty){var O=this.parent;O&&(this._trs[0]=this._originPos.x-(O._anchorPoint.x-.5)*O._contentSize.width,this._trs[1]=this._originPos.y-(O._anchorPoint.y-.5)*O._contentSize.height),this._super()}},getPosition:function(){return new cc.Vec2(this._originPos)},setPosition:function(O,R){R===void 0&&(R=(O=O.x).y);var P=this._originPos;P.x===O&&P.y===R||(P.x=O,P.y=R,this._posDirty(!0))},setParent:function(O){var R=this._parent;this._super(O),R!==O&&(R&&R.off(T.EventType.ANCHOR_CHANGED,this._posDirty,this),O&&O.on(T.EventType.ANCHOR_CHANGED,this._posDirty,this))},_updateOrderOfArrival:function(){}}),A=B.prototype;cc.js.getset(A,"parent",A.getParent,A.setParent),cc.js.getset(A,"position",A.getPosition,A.setPosition),cc.PrivateNode=S.exports=B},{"./CCNode":29,"./renderer/render-flow":228}],31:[function(L,S){cc.Scene=cc.Class({name:"cc.Scene",extends:L("./CCNode"),properties:{_is3DNode:{default:!0,override:!0},autoReleaseAssets:!1},ctor:function(){this._anchorPoint.x=0,this._anchorPoint.y=0,this._activeInHierarchy=!1,this._inited=!cc.game._isCloning,this.dependAssets=null},destroy:function(){if(cc.Object.prototype.destroy.call(this))for(var T=this._children,_=0;_<T.length;++_)T[_].active=!1;this._active=!1,this._activeInHierarchy=!1},_onHierarchyChanged:function(){},_instantiate:null,_load:function(){this._inited||(this._onBatchCreated(!1),this._inited=!0)},_activate:function(T){T=T!==!1,cc.director._nodeActivator.activateNode(this,T)}}),S.exports=cc.Scene},{"./CCNode":29}],32:[function(L,S){var T=L("./platform/js"),_=new(L("./platform/id-generater"))("Scheduler"),w=function(M,N,k,F){this.target=M,this.priority=N,this.paused=k,this.markedForDeletion=F},B=[];w.get=function(M,N,k,F){var G=B.pop();return G?(G.target=M,G.priority=N,G.paused=k,G.markedForDeletion=F):G=new w(M,N,k,F),G},w.put=function(M){B.length<20&&(M.target=null,B.push(M))};var A=function(M,N,k,F){this.list=M,this.entry=N,this.target=k,this.callback=F},O=[];A.get=function(M,N,k,F){var G=O.pop();return G?(G.list=M,G.entry=N,G.target=k,G.callback=F):G=new A(M,N,k,F),G},A.put=function(M){O.length<20&&(M.list=M.entry=M.target=M.callback=null,O.push(M))};var R=function(M,N,k,F,G,V){var j=this;j.timers=M,j.target=N,j.timerIndex=k,j.currentTimer=F,j.currentTimerSalvaged=G,j.paused=V},P=[];function E(){this._lock=!1,this._scheduler=null,this._elapsed=-1,this._runForever=!1,this._useDelay=!1,this._timesExecuted=0,this._repeat=0,this._delay=0,this._interval=0,this._target=null,this._callback=null}R.get=function(M,N,k,F,G,V){var j=P.pop();return j?(j.timers=M,j.target=N,j.timerIndex=k,j.currentTimer=F,j.currentTimerSalvaged=G,j.paused=V):j=new R(M,N,k,F,G,V),j},R.put=function(M){P.length<20&&(M.timers=M.target=M.currentTimer=null,P.push(M))};var D=E.prototype;D.initWithCallback=function(M,N,k,F,G,V){return this._lock=!1,this._scheduler=M,this._target=k,this._callback=N,this._elapsed=-1,this._interval=F,this._delay=V,this._useDelay=this._delay>0,this._repeat=G,this._runForever=this._repeat===cc.macro.REPEAT_FOREVER,!0},D.getInterval=function(){return this._interval},D.setInterval=function(M){this._interval=M},D.update=function(M){this._elapsed===-1?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=M,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),this._callback&&!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))},D.getCallback=function(){return this._callback},D.trigger=function(){this._target&&this._callback&&(this._lock=!0,this._callback.call(this._target,this._elapsed),this._lock=!1)},D.cancel=function(){this._scheduler.unschedule(this._callback,this._target)};var I=[];E.get=function(){return I.pop()||new E},E.put=function(M){I.length<20&&!M._lock&&(M._scheduler=M._target=M._callback=null,I.push(M))},cc.Scheduler=function(){this._timeScale=1,this._updatesNegList=[],this._updates0List=[],this._updatesPosList=[],this._hashForUpdates=T.createMap(!0),this._hashForTimers=T.createMap(!0),this._currentTarget=null,this._currentTargetSalvaged=!1,this._updateHashLocked=!1,this._arrayForTimers=[]},cc.Scheduler.prototype={constructor:cc.Scheduler,_removeHashElement:function(M){delete this._hashForTimers[M.target._id];for(var N=this._arrayForTimers,k=0,F=N.length;k<F;k++)if(N[k]===M){N.splice(k,1);break}R.put(M)},_removeUpdateFromHash:function(M){var N=M.target._id,k=this._hashForUpdates[N];if(k){for(var F=k.list,G=k.entry,V=0,j=F.length;V<j;V++)if(F[V]===G){F.splice(V,1);break}delete this._hashForUpdates[N],w.put(G),A.put(k)}},_priorityIn:function(M,N,k){for(var F=0;F<M.length;F++)if(k<M[F].priority)return void M.splice(F,0,N);M.push(N)},_appendIn:function(M,N){M.push(N)},enableForTarget:function(M){M._id||(M.__instanceId?cc.warnID(1513):M._id=_.getNewId())},setTimeScale:function(M){this._timeScale=M},getTimeScale:function(){return this._timeScale},update:function(M){var N,k,F,G;for(this._updateHashLocked=!0,this._timeScale!==1&&(M*=this._timeScale),N=0,F=(k=this._updatesNegList).length;N<F;N++)(G=k[N]).paused||G.markedForDeletion||G.target.update(M);for(N=0,F=(k=this._updates0List).length;N<F;N++)(G=k[N]).paused||G.markedForDeletion||G.target.update(M);for(N=0,F=(k=this._updatesPosList).length;N<F;N++)(G=k[N]).paused||G.markedForDeletion||G.target.update(M);var V,j=this._arrayForTimers;for(N=0;N<j.length;N++){if(V=j[N],this._currentTarget=V,this._currentTargetSalvaged=!1,!V.paused)for(V.timerIndex=0;V.timerIndex<V.timers.length;++V.timerIndex)V.currentTimer=V.timers[V.timerIndex],V.currentTimerSalvaged=!1,V.currentTimer.update(M),V.currentTimer=null;this._currentTargetSalvaged&&this._currentTarget.timers.length===0&&(this._removeHashElement(this._currentTarget),--N)}for(N=0,k=this._updatesNegList;N<k.length;)(G=k[N]).markedForDeletion?this._removeUpdateFromHash(G):N++;for(N=0,k=this._updates0List;N<k.length;)(G=k[N]).markedForDeletion?this._removeUpdateFromHash(G):N++;for(N=0,k=this._updatesPosList;N<k.length;)(G=k[N]).markedForDeletion?this._removeUpdateFromHash(G):N++;this._updateHashLocked=!1,this._currentTarget=null},schedule:function(M,N,k,F,G,V){if(typeof M!="function"){var j=M;M=N,N=j}arguments.length!==4&&arguments.length!==5||(V=!!F,F=cc.macro.REPEAT_FOREVER,G=0),cc.assertID(N,1502);var H=N._id;H||(N.__instanceId?(cc.warnID(1513),H=N._id=N.__instanceId):cc.errorID(1510));var U,X,Y=this._hashForTimers[H];if(Y?Y.paused!==V&&cc.warnID(1511):(Y=R.get(null,N,0,null,null,V),this._arrayForTimers.push(Y),this._hashForTimers[H]=Y),Y.timers==null)Y.timers=[];else for(X=0;X<Y.timers.length;++X)if((U=Y.timers[X])&&M===U._callback)return cc.logID(1507,U.getInterval(),k),void(U._interval=k);(U=E.get()).initWithCallback(this,M,N,k,F,G),Y.timers.push(U),this._currentTarget===Y&&this._currentTargetSalvaged&&(this._currentTargetSalvaged=!1)},scheduleUpdate:function(M,N,k){var F=M._id;F||(M.__instanceId?(cc.warnID(1513),F=M._id=M.__instanceId):cc.errorID(1510));var G=this._hashForUpdates[F];if(G&&G.entry){if(G.entry.priority===N)return G.entry.markedForDeletion=!1,void(G.entry.paused=k);if(this._updateHashLocked)return cc.logID(1506),G.entry.markedForDeletion=!1,void(G.entry.paused=k);this.unscheduleUpdate(M)}var V,j=w.get(M,N,k,!1);N===0?(V=this._updates0List,this._appendIn(V,j)):(V=N<0?this._updatesNegList:this._updatesPosList,this._priorityIn(V,j,N)),this._hashForUpdates[F]=A.get(V,j,M,null)},unschedule:function(M,N){if(N&&M){var k=N._id;k||(N.__instanceId?(cc.warnID(1513),k=N._id=N.__instanceId):cc.errorID(1510));var F=this._hashForTimers[k];if(F)for(var G=F.timers,V=0,j=G.length;V<j;V++){var H=G[V];if(M===H._callback)return H!==F.currentTimer||F.currentTimerSalvaged||(F.currentTimerSalvaged=!0),G.splice(V,1),E.put(H),F.timerIndex>=V&&F.timerIndex--,void(G.length===0&&(this._currentTarget===F?this._currentTargetSalvaged=!0:this._removeHashElement(F)))}}},unscheduleUpdate:function(M){if(M){var N=M._id;N||(M.__instanceId?(cc.warnID(1513),N=M._id=M.__instanceId):cc.errorID(1510));var k=this._hashForUpdates[N];k&&(this._updateHashLocked?k.entry.markedForDeletion=!0:this._removeUpdateFromHash(k.entry))}},unscheduleAllForTarget:function(M){if(M){var N=M._id;N||(M.__instanceId?(cc.warnID(1513),N=M._id=M.__instanceId):cc.errorID(1510));var k=this._hashForTimers[N];if(k){var F=k.timers;F.indexOf(k.currentTimer)>-1&&!k.currentTimerSalvaged&&(k.currentTimerSalvaged=!0);for(var G=0,V=F.length;G<V;G++)E.put(F[G]);F.length=0,this._currentTarget===k?this._currentTargetSalvaged=!0:this._removeHashElement(k)}this.unscheduleUpdate(M)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(M){var N,k,F,G=this._arrayForTimers;for(N=G.length-1;N>=0;N--)k=G[N],this.unscheduleAllForTarget(k.target);var V=0;if(M<0)for(N=0;N<this._updatesNegList.length;)V=this._updatesNegList.length,(F=this._updatesNegList[N])&&F.priority>=M&&this.unscheduleUpdate(F.target),V==this._updatesNegList.length&&N++;if(M<=0)for(N=0;N<this._updates0List.length;)V=this._updates0List.length,(F=this._updates0List[N])&&this.unscheduleUpdate(F.target),V==this._updates0List.length&&N++;for(N=0;N<this._updatesPosList.length;)V=this._updatesPosList.length,(F=this._updatesPosList[N])&&F.priority>=M&&this.unscheduleUpdate(F.target),V==this._updatesPosList.length&&N++},isScheduled:function(M,N){cc.assertID(M,1508),cc.assertID(N,1509);var k=N._id;k||(N.__instanceId?(cc.warnID(1513),k=N._id=N.__instanceId):cc.errorID(1510));var F=this._hashForTimers[k];if(!F||F.timers==null)return!1;for(var G=F.timers,V=0;V<G.length;++V)if(M===G[V]._callback)return!0;return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(M){var N,k,F,G,V=[],j=this._arrayForTimers;for(k=0,F=j.length;k<F;k++)(N=j[k])&&(N.paused=!0,V.push(N.target));if(M<0)for(k=0;k<this._updatesNegList.length;k++)(G=this._updatesNegList[k])&&G.priority>=M&&(G.paused=!0,V.push(G.target));if(M<=0)for(k=0;k<this._updates0List.length;k++)(G=this._updates0List[k])&&(G.paused=!0,V.push(G.target));for(k=0;k<this._updatesPosList.length;k++)(G=this._updatesPosList[k])&&G.priority>=M&&(G.paused=!0,V.push(G.target));return V},resumeTargets:function(M){if(M)for(var N=0;N<M.length;N++)this.resumeTarget(M[N])},pauseTarget:function(M){cc.assertID(M,1503);var N=M._id;N||(M.__instanceId?(cc.warnID(1513),N=M._id=M.__instanceId):cc.errorID(1510));var k=this._hashForTimers[N];k&&(k.paused=!0);var F=this._hashForUpdates[N];F&&(F.entry.paused=!0)},resumeTarget:function(M){cc.assertID(M,1504);var N=M._id;N||(M.__instanceId?(cc.warnID(1513),N=M._id=M.__instanceId):cc.errorID(1510));var k=this._hashForTimers[N];k&&(k.paused=!1);var F=this._hashForUpdates[N];F&&(F.entry.paused=!1)},isTargetPaused:function(M){cc.assertID(M,1505);var N=M._id;N||(M.__instanceId?(cc.warnID(1513),N=M._id=M.__instanceId):cc.errorID(1510));var k=this._hashForTimers[N];if(k)return k.paused;var F=this._hashForUpdates[N];return!!F&&F.entry.paused}},cc.Scheduler.PRIORITY_SYSTEM=1<<31,cc.Scheduler.PRIORITY_NON_SYSTEM=cc.Scheduler.PRIORITY_SYSTEM+1,S.exports=cc.Scheduler},{"./platform/id-generater":213,"./platform/js":217}],33:[function(L,S){var T=L("./preprocess"),_=L("./fetch"),w=L("./cache"),B=L("./helper"),A=L("./releaseManager"),O=L("./depend-util"),R=L("./load"),P=L("./pipeline"),E=L("./task"),D=L("./request-item"),I=L("./downloader"),M=L("./parser"),N=L("./pack-manager"),k=L("./bundle"),F=L("./builtins"),G=L("./factory"),V=L("./urlTransformer"),j=V.parse,H=V.combine,U=L("./utilities"),X=U.parseParameters,Y=U.asyncify,z=L("./shared"),W=z.assets,Z=z.files,Q=z.parsed,ee=z.pipeline,te=z.transformPipeline,re=z.fetchPipeline,ie=z.RequestType,ne=z.bundles,he=z.BuiltinBundleName;function pe(){this._preprocessPipe=T,this._fetchPipe=_,this._loadPipe=R,this.pipeline=ee.append(T).append(R),this.fetchPipeline=re.append(T).append(_),this.transformPipeline=te.append(j).append(H),this.bundles=ne,this.assets=W,this._files=Z,this._parsed=Q,this.generalImportBase="",this.generalNativeBase="",this.dependUtil=O,this._releaseManager=A,this.cacheAsset=!0,this.force=!1,this.utils=B,this.downloader=I,this.parser=M,this.builtins=F,this.packManager=N,this.factory=G,this.cacheManager=null,this.presets={default:{priority:0},preload:{maxConcurrency:2,maxRequestsPerFrame:2,priority:-1},scene:{maxConcurrency:8,maxRequestsPerFrame:8,priority:1},bundle:{maxConcurrency:8,maxRequestsPerFrame:8,priority:2},remote:{maxRetryCount:4},script:{maxConcurrency:1024,maxRequestsPerFrame:1024,priority:2}}}pe.Pipeline=P,pe.Task=E,pe.Cache=w,pe.RequestItem=D,pe.Bundle=k,pe.BuiltinBundleName=he,pe.prototype={constructor:pe,get main(){return ne.get(he.MAIN)},get resources(){return ne.get(he.RESOURCES)},get internal(){return ne.get(he.INTERNAL)},init:function(K){K=K||Object.create(null),this._files.clear(),this._parsed.clear(),this._releaseManager.init(),this.assets.clear(),this.bundles.clear(),this.packManager.init(),this.downloader.init(K.bundleVers,K.server),this.parser.init(),this.dependUtil.init(),this.generalImportBase=K.importBase,this.generalNativeBase=K.nativeBase},getBundle:function(K){return ne.get(K)},removeBundle:function(K){K._destroy(),ne.remove(K.name)},loadAny:function(K,ue,le,ce){var _e=X(ue,le,ce);ue=_e.options,le=_e.onProgress,ce=_e.onComplete,ue.preset=ue.preset||"default",K=Array.isArray(K)?K.concat():K;var oe=new E({input:K,onProgress:le,onComplete:Y(ce),options:ue});ee.async(oe)},preloadAny:function(K,ue,le,ce){var _e=X(ue,le,ce);ue=_e.options,le=_e.onProgress,ce=_e.onComplete,ue.preset=ue.preset||"preload",K=Array.isArray(K)?K.concat():K;var oe=new E({input:K,onProgress:le,onComplete:Y(ce),options:ue});re.async(oe)},postLoadNative:function(K,ue,le){if(!(K instanceof cc.Asset))throw new Error("input is not asset");var ce=X(ue,void 0,le);if(ue=ce.options,le=ce.onComplete,!K._native||K._nativeAsset)return Y(le)(null);var _e=O.getNativeDep(K._uuid);if(_e){if(!ne.has(_e.bundle)){var oe=ne.find(function(de){return de.getAssetInfo(K._uuid)});oe&&(_e.bundle=oe.name)}this.loadAny(_e,ue,function(de,me){de?cc.error(de.message,de.stack):K.isValid&&!K._nativeAsset&&(K._nativeAsset=me),le&&le(de)})}},loadRemote:function(K,ue,le){var ce=X(ue,void 0,le);if(ue=ce.options,le=ce.onComplete,this.assets.has(K))return Y(le)(null,this.assets.get(K));ue.__isNative__=!0,ue.preset=ue.preset||"remote",this.loadAny({url:K},ue,null,function(_e,oe){_e?(cc.error(_e.message,_e.stack),le&&le(_e,null)):G.create(K,oe,ue.ext||cc.path.extname(K),ue,function(de,me){le&&le(de,me)})})},loadScript:function(K,ue,le){var ce=X(ue,void 0,le);ue=ce.options,le=ce.onComplete,ue.__requestType__=ie.URL,ue.preset=ue.preset||"script",this.loadAny(K,ue,le)},loadBundle:function(K,ue,le){var ce=X(ue,void 0,le),_e=(ue=ce.options,le=ce.onComplete,cc.path.basename(K));if(this.bundles.has(_e))return Y(le)(null,this.getBundle(_e));ue.preset=ue.preset||"bundle",ue.ext="bundle",this.loadRemote(K,ue,le)},releaseAsset:function(K){A.tryRelease(K,!0)},releaseUnusedAssets:function(){W.forEach(function(K){A.tryRelease(K)})},releaseAll:function(){W.forEach(function(K){A.tryRelease(K,!0)})},_transform:function(K,ue){var le=E.create({input:K,options:ue}),ce=[];try{for(var _e=te.sync(le),oe=0,de=_e.length;oe<de;oe++){var me=_e[oe],ye=me.url;me.recycle(),ce.push(ye)}}catch(ge){for(oe=0,de=le.output.length;oe<de;oe++)le.output[oe].recycle();cc.error(ge.message,ge.stack)}return le.recycle(),ce.length>1?ce:ce[0]}},cc.AssetManager=pe,cc.assetManager=new pe,Object.defineProperty(cc,"resources",{get:function(){return ne.get(he.RESOURCES)}}),S.exports=cc.assetManager},{"./builtins":34,"./bundle":35,"./cache":36,"./depend-util":38,"./downloader":45,"./factory":46,"./fetch":47,"./helper":49,"./load":51,"./pack-manager":52,"./parser":53,"./pipeline":54,"./preprocess":55,"./releaseManager":56,"./request-item":57,"./shared":58,"./task":59,"./urlTransformer":60,"./utilities":61}],34:[function(L,S){var T=L("./cache"),_=L("./releaseManager"),w=L("./shared").BuiltinBundleName,B={_assets:new T({material:new T,effect:new T}),_loadBuiltins:function(A,O){var R=A+"s",P=this._assets.get(A);return cc.assetManager.internal.loadDir(R,null,null,function(E,D){if(E)cc.error(E.message,E.stack);else for(var I=0;I<D.length;I++){var M=D[I];P.add(M.name,M.addRef())}O()})},init:function(A){var O=this;if(this.clear(),cc.game.renderType===cc.game.RENDER_TYPE_CANVAS||!cc.assetManager.bundles.has(w.INTERNAL))return A&&A();this._loadBuiltins("effect",function(){O._loadBuiltins("material",A)})},getBuiltin:function(A,O){return arguments.length===0?this._assets:arguments.length===1?this._assets.get(A):this._assets.get(A).get(O)},clear:function(){this._assets.forEach(function(A){A.forEach(function(O){_.tryRelease(O,!0)}),A.clear()})}};S.exports=B},{"./cache":36,"./releaseManager":56,"./shared":58}],35:[function(L,S){var T=L("./config"),_=L("./releaseManager"),w=L("./utilities"),B=w.parseParameters,A=w.parseLoadResArgs,O=L("./shared"),R=O.RequestType,P=O.assets,E=O.bundles;function D(){this._config=new T}D.prototype={constructor:D,get name(){return this._config.name},get deps(){return this._config.deps},get base(){return this._config.base},getInfoWithPath:function(I,M){return this._config.getInfoWithPath(I,M)},getDirWithPath:function(I,M,N){return this._config.getDirWithPath(I,M,N)},getAssetInfo:function(I){return this._config.getAssetInfo(I)},getSceneInfo:function(I){return this._config.getSceneInfo(I)},init:function(I){this._config.init(I),E.add(I.name,this)},load:function(I,M,N,k){var F=A(M,N,k);M=F.type,N=F.onProgress,k=F.onComplete,cc.assetManager.loadAny(I,{__requestType__:R.PATH,type:M,bundle:this.name,__outputAsArray__:Array.isArray(I)},N,k)},preload:function(I,M,N,k){var F=A(M,N,k);M=F.type,N=F.onProgress,k=F.onComplete,cc.assetManager.preloadAny(I,{__requestType__:R.PATH,type:M,bundle:this.name},N,k)},loadDir:function(I,M,N,k){var F=A(M,N,k);M=F.type,N=F.onProgress,k=F.onComplete,cc.assetManager.loadAny(I,{__requestType__:R.DIR,type:M,bundle:this.name,__outputAsArray__:!0},N,k)},preloadDir:function(I,M,N,k){var F=A(M,N,k);M=F.type,N=F.onProgress,k=F.onComplete,cc.assetManager.preloadAny(I,{__requestType__:R.DIR,type:M,bundle:this.name},N,k)},loadScene:function(I,M,N,k){var F=B(M,N,k);M=F.options,N=F.onProgress,k=F.onComplete,M.preset=M.preset||"scene",M.bundle=this.name,cc.assetManager.loadAny({scene:I},M,N,function(G,V){if(G)cc.error(G.message,G.stack),k&&k(G);else if(V instanceof cc.SceneAsset){var j=V.scene;j._id=V._uuid,j._name=V._name,k&&k(null,V)}else k&&k(new Error("The asset "+V._uuid+" is not a scene"))})},preloadScene:function(I,M,N,k){var F=B(M,N,k);M=F.options,N=F.onProgress,k=F.onComplete,M.bundle=this.name,cc.assetManager.preloadAny({scene:I},M,N,function(G){G&&cc.errorID(1210,I,G.message),k&&k(G)})},get:function(I,M){var N=this.getInfoWithPath(I,M);return P.get(N&&N.uuid)},release:function(I,M){_.tryRelease(this.get(I,M),!0)},releaseUnusedAssets:function(){var I=this;P.forEach(function(M){var N=I.getAssetInfo(M._uuid);N&&!N.redirect&&_.tryRelease(M)})},releaseAll:function(){var I=this;P.forEach(function(M){var N=I.getAssetInfo(M._uuid);N&&!N.redirect&&_.tryRelease(M,!0)})},_destroy:function(){this._config.destroy()}},S.exports=D},{"./config":37,"./releaseManager":56,"./shared":58,"./utilities":61}],36:[function(L,S){var T=L("../platform/js");function _(w){w?(this._map=w,this._count=Object.keys(w).length):(this._map=T.createMap(!0),this._count=0)}_.prototype={constructor:_,add:function(w,B){return w in this._map||this._count++,this._map[w]=B},get:function(w){return this._map[w]},has:function(w){return w in this._map},remove:function(w){var B=this._map[w];return w in this._map&&(delete this._map[w],this._count--),B},clear:function(){this._count!==0&&(this._map=T.createMap(!0),this._count=0)},forEach:function(w){for(var B in this._map)w(this._map[B],B)},find:function(w){for(var B in this._map)if(w(this._map[B],B))return this._map[B];return null},get count(){return this._count},destroy:function(){this._map=null}},S.exports=_},{"../platform/js":217}],37:[function(L,S){var T=L("../platform/js"),_=L("./cache"),w=L("./helper").normalize,B=L("./utilities").processOptions;function A(){this.name="",this.base="",this.importBase="",this.nativeBase="",this.deps=null,this.assetInfos=new _,this.scenes=new _,this.paths=new _}A.prototype={constructor:A,init:function(O){B(O),this.importBase=O.importBase||"",this.nativeBase=O.nativeBase||"",this.base=O.base||"",this.name=O.name||"",this.deps=O.deps||[],this._initUuid(O.uuids),this._initPath(O.paths),this._initScene(O.scenes),this._initPackage(O.packs),this._initVersion(O.versions),this._initRedirect(O.redirect)},_initUuid:function(O){if(O){this.assetInfos.clear();for(var R=0,P=O.length;R<P;R++){var E=O[R];this.assetInfos.add(E,{uuid:E})}}},_initPath:function(O){if(O){var R=this.paths;for(var P in R.clear(),O){var E=O[P],D=E[0],I=E[1],M=E.length===3,N=this.assetInfos.get(P);N.path=D,N.ctor=T._getClassById(I),R.has(D)?M?R.get(D).push(N):R.get(D).unshift(N):R.add(D,[N])}}},_initScene:function(O){if(O){var R=this.scenes;R.clear();var P=this.assetInfos;for(var E in O){var D=O[E],I=P.get(D);I.url=E,R.add(E,I)}}},_initPackage:function(O){if(O){var R=this.assetInfos;for(var P in O){var E=O[P],D={uuid:P,packs:E,ext:".json"};R.add(P,D);for(var I=0,M=E.length;I<M;I++){var N=E[I],k=R.get(N),F=k.packs;F?M===1?F.unshift(D):F.push(D):k.packs=[D]}}}},_initVersion:function(O){if(O){var R=this.assetInfos,P=O.import;if(P)for(var E=0,D=P.length;E<D;E+=2){var I=P[E];R.get(I).ver=P[E+1]}if(P=O.native)for(E=0,D=P.length;E<D;E+=2)I=P[E],R.get(I).nativeVer=P[E+1]}},_initRedirect:function(O){if(O)for(var R=this.assetInfos,P=0,E=O.length;P<E;P+=2){var D=O[P];R.get(D).redirect=O[P+1]}},getInfoWithPath:function(O,R){if(!O)return null;O=w(O);var P=this.paths.get(O);if(P){if(!R)return P[0];for(var E=0,D=P.length;E<D;E++){var I=P[E];if(T.isChildClassOf(I.ctor,R))return I}}return null},getDirWithPath:function(O,R,P){(O=w(O))[O.length-1]==="/"&&(O=O.slice(0,-1));var E=P||[];function D(I,M){return!(I.length>M.length)||I.charCodeAt(M.length)===47}return this.paths.forEach(function(I,M){if(M.startsWith(O)&&D(M,O)||!O)for(var N=0,k=I.length;N<k;N++){var F=I[N];R&&!T.isChildClassOf(F.ctor,R)||E.push(F)}}),E},getAssetInfo:function(O){return this.assetInfos.get(O)},getSceneInfo:function(O){return O.endsWith(".fire")||(O+=".fire"),O[0]==="/"||O.startsWith("db://")||(O="/"+O),this.scenes.find(function(R,P){return P.endsWith(O)})},destroy:function(){this.paths.destroy(),this.scenes.destroy(),this.assetInfos.destroy()}},S.exports=A},{"../platform/js":217,"./cache":36,"./helper":49,"./utilities":61}],38:[function(L,S){var T=function(E){if(E&&E.__esModule)return E;if(E===null||typeof E!="object"&&typeof E!="function")return{default:E};var D=_(void 0);if(D&&D.has(E))return D.get(E);var I={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in E)if(N!=="default"&&Object.prototype.hasOwnProperty.call(E,N)){var k=M?Object.getOwnPropertyDescriptor(E,N):null;k&&(k.get||k.set)?Object.defineProperty(I,N,k):I[N]=E[N]}return I.default=E,D&&D.set(E,I),I}(L("../platform/deserialize-compiled"));function _(E){if(typeof WeakMap!="function")return null;var D=new WeakMap,I=new WeakMap;return(_=function(M){return M?I:D})(E)}var w=L("./cache"),B=L("./deserialize"),A=L("./shared"),O=A.files,R=A.parsed,P={_depends:new w,init:function(){this._depends.clear()},getNativeDep:function(E){var D=this._depends.get(E);return D?D.nativeDep&&Object.assign({},D.nativeDep):null},getDeps:function(E){return this._depends.has(E)?this._depends.get(E).deps:[]},getDepsRecursively:function(E){var D=Object.create(null),I=[];return this._descend(E,D,I),I},_descend:function(E,D,I){for(var M=this.getDeps(E),N=0;N<M.length;N++){var k=M[N];D[k]||(D[k]=!0,I.push(k),this._descend(k,D,I))}},remove:function(E){this._depends.remove(E)},parse:function(E,D){var I=null;if(Array.isArray(D)||D.__type__){if(I=this._depends.get(E))return I;if(Array.isArray(D)&&!(0,T.hasNativeDep)(D))I={deps:this._parseDepsFromJson(D)};else try{var M=B(D);(I=this._parseDepsFromAsset(M)).nativeDep&&(I.nativeDep.uuid=E),R.add(E+"@import",M)}catch(N){O.remove(E+"@import"),I={deps:[]}}}else{if((I=this._depends.get(E))&&I.parsedFromExistAsset)return I;I=this._parseDepsFromAsset(D)}return this._depends.add(E,I),I},_parseDepsFromAsset:function(E){for(var D={deps:[],parsedFromExistAsset:!0,preventPreloadNativeObject:E.constructor.preventPreloadNativeObject,preventDeferredLoadDependents:E.constructor.preventDeferredLoadDependents},I=E.__depends__,M=0,N=I.length;M<N;M++){var k=I[M].uuid;D.deps.push(k)}return E.__nativeDepend__&&(D.nativeDep=E._nativeDep),D},_parseDepsFromJson:function(E){var D=(0,T.getDependUuidList)(E);return D.forEach(function(I,M){return D[M]=cc.assetManager.utils.decodeUuid(I)}),D}};S.exports=P},{"../platform/deserialize-compiled":211,"./cache":36,"./deserialize":40,"./shared":58}],39:[function(L){var S=L("../platform/js");L("../CCDirector");var T=L("./utilities"),_=L("./depend-util"),w=L("./releaseManager"),B=L("./downloader"),A=L("./factory"),O=L("./helper"),R=[".png",".jpg",".bmp",".jpeg",".gif",".ico",".tiff",".webp",".image",".pvr",".pkm"],P=[".mp3",".ogg",".wav",".m4a"];function E(){return!0}var D={transformURL:function(F){var G=O.getUuidFromURL(F);if(!G)return F;var V=cc.assetManager.bundles.find(function(z){return!!z.getAssetInfo(G)});if(!V)return F;var j,H=V.getAssetInfo(G);if(!(j=F.startsWith(V.base+V._config.nativeBase)?H.nativeVer||"":H.ver||"")||F.indexOf(j)!==-1)return F;var U=!1;if(cc.path.extname(F)===".ttf"&&(U=!0),U){var X=cc.path.dirname(F),Y=cc.path.basename(F);F=X+"."+j+"/"+Y}else F=F.replace(/.*[/\\][0-9a-fA-F]{2}[/\\]([0-9a-fA-F-]{8,})/,function(z){return z+"."+j});return F}},I={onProgress:null,_autoReleaseSetting:Object.create(null),get _cache(){return cc.assetManager.assets._map},load:function(F,G,V){V===void 0&&G!==void 0&&(V=G,G=null),F=Array.isArray(F)?F:[F];for(var j=0;j<F.length;j++){var H=F[j];typeof H=="string"?F[j]={url:H,__isNative__:!0}:(H.type&&(H.ext="."+H.type,H.type=void 0),H.url&&(H.__isNative__=!0))}var U=[],X=[];cc.assetManager.loadAny(F,null,function(Y,z,W){W.content&&(R.includes(W.ext)?U.push(W.content):P.includes(W.ext)&&X.push(W.content)),G&&G(Y,z,W)},function(Y,z){var W=null;if(!Y){z=Array.isArray(z)?z:[z];for(var Z=0;Z<z.length;Z++){var Q=z[Z];if(!(Q instanceof cc.Asset)){var ee=Q,te=F[Z].url;U.includes(ee)?A.create(te,Q,".png",null,function(ie,ne){ee=z[Z]=ne}):X.includes(ee)&&A.create(te,Q,".mp3",null,function(ie,ne){ee=z[Z]=ne}),cc.assetManager.assets.add(te,ee)}}if(z.length>1){var re=Object.create(null);z.forEach(function(ie){re[ie._uuid]=ie}),W={isCompleted:E,_map:re}}else W=z[0]}V&&V(Y,W)})},getXMLHttpRequest:function(){return new XMLHttpRequest},_parseLoadResArgs:T.parseLoadResArgs,getItem:function(F){return cc.assetManager.assets.has(F)?{content:cc.assetManager.assets.get(F)}:null},loadRes:function(F,G,V,j){var H=this._parseLoadResArgs(G,V,j),U=(G=H.type,H.onProgress),X=H.onComplete,Y=cc.path.extname(F);Y&&(F=F.slice(0,-Y.length)),cc.resources.load(F,G,U,X)},loadResArray:function(F,G,V,j){var H=this._parseLoadResArgs(G,V,j),U=(G=H.type,H.onProgress),X=H.onComplete;F.forEach(function(Y,z){var W=cc.path.extname(Y);W&&(F[z]=Y.slice(0,-W.length))}),cc.resources.load(F,G,U,X)},loadResDir:function(F,G,V,j){var H=this._parseLoadResArgs(G,V,j),U=(G=H.type,H.onProgress),X=H.onComplete;cc.resources.loadDir(F,G,U,function(Y,z){var W=[];Y||(W=cc.resources.getDirWithPath(F,G).map(function(Z){return Z.path})),X&&X(Y,z,W)})},getRes:function(F,G){return cc.assetManager.assets.has(F)?cc.assetManager.assets.get(F):cc.resources.get(F,G)},getResCount:function(){return cc.assetManager.assets.count},getDependsRecursively:function(F){return F?_.getDepsRecursively(typeof F=="string"?F:F._uuid).concat([F._uuid]):[]},get assetLoader(){},get md5Pipe(){return D},get downloader(){return cc.assetManager.downloader},get loader(){return cc.assetManager.parser},addDownloadHandlers:function(F){var G=Object.create(null);for(var V in F){var j=F[V];G["."+V]=function(H,U,X){j({url:H},X)}}cc.assetManager.downloader.register(G)},addLoadHandlers:function(F){var G=Object.create(null);for(var V in F){var j=F[V];G["."+V]=function(H,U,X){j({content:H},X)}}cc.assetManager.parser.register(G)},flowInDeps:function(){},release:function(F){if(Array.isArray(F))for(var G=0;G<F.length;G++){var V=F[G];typeof V=="string"&&(V=cc.assetManager.assets.get(V)),cc.assetManager.builtins._assets.find(function(j){return j.find(function(H){return H===V})})||cc.assetManager.releaseAsset(V)}else if(F){if(typeof F=="string"&&(F=cc.assetManager.assets.get(F)),cc.assetManager.builtins._assets.find(function(j){return j.find(function(H){return H===F})}))return;cc.assetManager.releaseAsset(F)}},releaseAsset:function(F){cc.assetManager.releaseAsset(F)},releaseRes:function(F,G){cc.resources.release(F,G)},releaseResDir:function(){},releaseAll:function(){cc.assetManager.releaseAll(),cc.assetManager.assets.clear()},removeItem:function(F){cc.assetManager.assets.remove(F)},setAutoRelease:function(F,G){typeof F=="object"&&(F=F._uuid),this._autoReleaseSetting[F]=!!G},setAutoReleaseRecursively:function(F,G){typeof F=="object"&&(F=F._uuid),G=!!G,this._autoReleaseSetting[F]=G;for(var V=_.getDepsRecursively(F),j=0;j<V.length;j++){var H=V[j];this._autoReleaseSetting[H]=G}},isAutoRelease:function(F){return typeof F=="object"&&(F=F._uuid),!!this._autoReleaseSetting[F]}};B.loadSubpackage=function(F,G){cc.assetManager.loadBundle(F,null,G)};var M={init:function(F){F.importBase=F.libraryPath,F.nativeBase=F.rawAssetsBase,cc.assetManager.init(F),F.rawAssets&&new cc.AssetManager.Bundle().init({name:cc.AssetManager.BuiltinBundleName.RESOURCES,importBase:F.importBase,nativeBase:F.nativeBase,paths:F.rawAssets.assets,uuids:Object.keys(F.rawAssets.assets)})},loadAsset:function(F,G){cc.assetManager.loadAny(F,G)},getLibUrlNoExt:function(){},queryAssetInfo:function(){}};cc.url={normalize:function(F){return cc.warnID(1400,"cc.url.normalize","cc.assetManager.utils.normalize"),cc.assetManager.utils.normalize(F)},raw:function(F){return cc.warnID(1400,"cc.url.raw","cc.resources.load"),F.startsWith("resources/")?cc.assetManager._transform({path:cc.path.changeExtname(F.substr(10)),bundle:cc.AssetManager.BuiltinBundleName.RESOURCES,__isNative__:!0,ext:cc.path.extname(F)}):""}},Object.defineProperties(cc,{loader:{get:function(){return I}},AssetLibrary:{get:function(){return M}},LoadingItems:{get:function(){return cc.warnID(1400,"cc.LoadingItems","cc.AssetManager.Task"),cc.AssetManager.Task}},Pipeline:{get:function(){return cc.warnID(1400,"cc.Pipeline","cc.AssetManager.Pipeline"),cc.AssetManager.Pipeline}}}),S.obsolete(cc,"cc.RawAsset","cc.Asset"),S.obsolete(cc.Asset.prototype,"cc.Asset.url","nativeUrl"),Object.defineProperties(cc.macro,{DOWNLOAD_MAX_CONCURRENT:{get:function(){return cc.assetManager.downloader.maxConcurrency},set:function(F){cc.assetManager.downloader.maxConcurrency=F}}}),Object.assign(cc.director,{_getSceneUuid:function(F){cc.assetManager.main.getSceneInfo(F)}}),Object.defineProperties(cc.game,{_sceneInfos:{get:function(){var F=[];return cc.assetManager.main._config.scenes.forEach(function(G){F.push(G)}),F}}});var N=T.parseParameters;T.parseParameters=function(F,G,V){var j=N(F,G,V);return j.onProgress=j.onProgress||I.onProgress,j};var k=w._autoRelease;w._autoRelease=function(){k.apply(this,arguments);for(var F=I._autoReleaseSetting,G=Object.keys(F),V=0;V<G.length;V++){var j=G[V];if(F[j]===!0){var H=cc.assetManager.assets.get(j);H&&w.tryRelease(H)}}}},{"../CCDirector":27,"../platform/js":217,"./depend-util":38,"./downloader":45,"./factory":46,"./helper":49,"./releaseManager":56,"./utilities":61}],40:[function(L,S){var T=L("./helper");L("../platform/deserialize"),S.exports=function(_,w){var B;B=cc._MissingScript.safeFindClass;var A,O=null,R=(O=cc.deserialize.Details.pool).get();try{A=cc.deserialize(_,R,{classFinder:B,customEnv:w})}catch(k){throw O.put(R),k}for(var P=R.uuidList,E=R.uuidObjList,D=R.uuidPropList,I=[],M=0;M<P.length;M++){var N=P[M];I[M]={uuid:T.decodeUuid(N),owner:E[M],prop:D[M]}}return A.__depends__=I,A._native&&(A.__nativeDepend__=!0),O.put(R),A}},{"../platform/deserialize":212,"../platform/deserialize-compiled":211,"../platform/deserialize-editor":void 0,"./helper":49}],41:[function(L,S){var T=cc.sys.__audioSupport,_=L("./utilities").parseParameters;S.exports=function(w,B,A){var O=_(B,void 0,A),R=(B=O.options,A=O.onComplete,document.createElement("audio"));R.src=w;var P=function(){clearTimeout(E),R.removeEventListener("canplaythrough",D,!1),R.removeEventListener("error",I,!1),T.USE_LOADER_EVENT&&R.removeEventListener(T.USE_LOADER_EVENT,D,!1)},E=setTimeout(function(){R.readyState===0?I():D()},8e3),D=function(){P(),A&&A(null,R)},I=function(){P();var M="load audio failure - "+w;cc.log(M),A&&A(new Error(M))};return R.addEventListener("canplaythrough",D,!1),R.addEventListener("error",I,!1),T.USE_LOADER_EVENT&&R.addEventListener(T.USE_LOADER_EVENT,D,!1),R}},{"./utilities":61}],42:[function(L,S){var T=L("./utilities").parseParameters;S.exports=function(_,w,B){var A=T(w,void 0,B),O=(w=A.options,B=A.onComplete,new Image);function R(){O.removeEventListener("load",R),O.removeEventListener("error",P),B&&B(null,O)}function P(){O.removeEventListener("load",R),O.removeEventListener("error",P),B&&B(new Error(cc.debug.getError(4930,_)))}return window.location.protocol!=="file:"&&(O.crossOrigin="anonymous"),O.addEventListener("load",R),O.addEventListener("error",P),O.src=_,O}},{"./utilities":61}],43:[function(L,S){var T=L("./utilities").parseParameters;S.exports=function(_,w,B,A){var O=T(w,B,A),R=(w=O.options,B=O.onProgress,A=O.onComplete,new XMLHttpRequest),P="download failed: "+_+", status: ";if(R.open("GET",_,!0),w.responseType!==void 0&&(R.responseType=w.responseType),w.withCredentials!==void 0&&(R.withCredentials=w.withCredentials),w.mimeType!==void 0&&R.overrideMimeType&&R.overrideMimeType(w.mimeType),w.timeout!==void 0&&(R.timeout=w.timeout),w.header)for(var E in w.header)R.setRequestHeader(E,w.header[E]);return R.onload=function(){R.status===200||R.status===0?A&&A(null,R.response):A&&A(new Error(P+R.status+"(no response)"))},B&&(R.onprogress=function(D){D.lengthComputable&&B(D.loaded,D.total)}),R.onerror=function(){A&&A(new Error(P+R.status+"(error)"))},R.ontimeout=function(){A&&A(new Error(P+R.status+"(time out)"))},R.onabort=function(){A&&A(new Error(P+R.status+"(abort)"))},R.send(null),R}},{"./utilities":61}],44:[function(L,S){var T=L("./utilities").parseParameters,_={};S.exports=function(w,B,A){var O=T(B,void 0,A);if(B=O.options,A=O.onComplete,_[w])return A&&A(null);var R=document,P=document.createElement("script");function E(){P.parentNode.removeChild(P),P.removeEventListener("load",E,!1),P.removeEventListener("error",D,!1),_[w]=!0,A&&A(null)}function D(){P.parentNode.removeChild(P),P.removeEventListener("load",E,!1),P.removeEventListener("error",D,!1),A&&A(new Error(cc.debug.getError(4928,w)))}window.location.protocol!=="file:"&&(P.crossOrigin="anonymous"),P.async=B.async,P.src=w,P.addEventListener("load",E,!1),P.addEventListener("error",D,!1),R.body.appendChild(P)}},{"./utilities":61}],45:[function(L,S){var T=L("../platform/js"),_=L("../CCDebug"),w=L("./font-loader").loadFont,B=L("../platform/utils").callInNextTick,A=L("./download-dom-image"),O=L("./download-dom-audio"),R=L("./download-file"),P=L("./download-script.js"),E=L("./cache"),D=L("./shared").files,I=L("../platform/CCSys"),M=I.__audioSupport,N=I.capabilities,k=L("./utilities"),F=k.urlAppendTimestamp,G=k.retry,V=/^(?:\w+:\/\/|\.+\/).+/,j=function(le,ce,_e){ce.audioLoadMode!==cc.AudioClip.LoadMode.DOM_AUDIO?Y(le,ce,_e):O(le,ce,_e)},H=(j=(M.format||[]).length===0?function(le,ce,_e){_e(new Error(_.getError(4927)))}:M.WEB_AUDIO?j:O,function(){var le=N.imageBitmap&&cc.macro.ALLOW_IMAGE_BITMAP?U:A;le.apply(this,arguments)}),U=function(le,ce,_e){ce.responseType="blob",R(le,ce,ce.onFileProgress,_e)},X=function(le,ce,_e){ce.responseType="json",R(le,ce,ce.onFileProgress,function(oe,de){if(!oe&&typeof de=="string")try{de=JSON.parse(de)}catch(me){oe=me}_e&&_e(oe,de)})},Y=function(le,ce,_e){ce.responseType="arraybuffer",R(le,ce,ce.onFileProgress,_e)},z=function(le,ce,_e){ce.responseType="text",R(le,ce,ce.onFileProgress,_e)},W=function(le,ce,_e){_e(null,le)},Z=new E,Q=[],ee=!1,te=0,re=0,ie=-1,ne=!1,he=function(){var le=Date.now(),ce=cc.director._deltaTime>K._maxInterval?K._maxInterval:cc.director._deltaTime;le-ie>1e3*ce&&(re=0,ie=le)},pe=function le(ce,_e){for(ne=!1,he();Q.length>0&&te<ce&&re<_e;){ee&&(Q.sort(function(de,me){return de.priority-me.priority}),ee=!1);var oe=Q.pop();if(!oe)break;te++,re++,oe.invoke()}Q.length>0&&te<ce&&(B(le,ce,_e),ne=!0)},K={_remoteServerAddress:"",_maxInterval:1/30,get remoteServerAddress(){return this._remoteServerAddress},maxConcurrency:6,maxRequestsPerFrame:6,maxRetryCount:3,appendTimeStamp:!1,limited:!0,retryInterval:2e3,bundleVers:null,downloadDomImage:A,downloadDomAudio:O,downloadFile:R,downloadScript:P,init:function(le,ce){Z.clear(),Q.length=0,this._remoteServerAddress=ce||"",this.bundleVers=le||Object.create(null)},register:function(le,ce){typeof le=="object"?T.mixin(ue,le):ue[le]=ce},download:function(le,ce,_e,oe,de){var me,ye,ge=ue[_e]||ue.default,we=this;if(me=D.get(le))de(null,me);else if(ye=Z.get(le)){ye.push(de);for(var Te=0,Ee=Q.length;Te<Ee;Te++){var De=Q[Te];if(De.id===le){var fe=oe.priority||0;return void(De.priority<fe&&(De.priority=fe,ee=!0))}}}else{var Ce=oe.maxRetryCount!==void 0?oe.maxRetryCount:this.maxRetryCount,Se=oe.maxConcurrency!==void 0?oe.maxConcurrency:this.maxConcurrency,be=oe.maxRequestsPerFrame!==void 0?oe.maxRequestsPerFrame:this.maxRequestsPerFrame;G(function(Re,Ve){if(Re===0&&Z.add(le,[de]),!we.limited)return ge(F(ce),oe,Ve);function Pe(){ge(F(ce),oe,function(){te--,!ne&&Q.length>0&&(B(pe,Se,be),ne=!0),Ve.apply(this,arguments)})}he(),te<Se&&re<be?(Pe(),te++,re++):(Q.push({id:le,priority:oe.priority||0,invoke:Pe}),ee=!0,!ne&&te<Se&&(B(pe,Se,be),ne=!0))},Ce,this.retryInterval,function(Re,Ve){Re||D.add(le,Ve);for(var Pe=Z.remove(le),ke=0,Ne=Pe.length;ke<Ne;ke++)Pe[ke](Re,Ve)})}}},ue={".png":H,".jpg":H,".bmp":H,".jpeg":H,".gif":H,".ico":H,".tiff":H,".webp":H,".image":H,".pvr":Y,".pkm":Y,".astc":Y,".mp3":j,".ogg":j,".wav":j,".m4a":j,".txt":z,".xml":z,".vsh":z,".fsh":z,".atlas":z,".tmx":z,".tsx":z,".json":X,".ExportJson":X,".plist":z,".fnt":z,".font":w,".eot":w,".ttf":w,".woff":w,".svg":w,".ttc":w,".mp4":W,".avi":W,".mov":W,".mpg":W,".mpeg":W,".rm":W,".rmvb":W,".binary":Y,".bin":Y,".dbbin":Y,".skel":Y,".js":P,bundle:function(le,ce,_e){var oe=cc.path.basename(le),de=le;V.test(de)||(de="assets/"+oe);var me=ce.version||K.bundleVers[oe],ye=0,ge=null,we=null;X(de+"/config."+(me?me+".":"")+"json",ce,function(Te,Ee){Te&&(we=Te),(ge=Ee)&&(ge.base=de+"/"),++ye==2&&_e(we,ge)}),P(de+"/index."+(me?me+".":"")+"js",ce,function(Te){Te&&(we=Te),++ye==2&&_e(we,ge)})},default:z};K._downloaders=ue,S.exports=K},{"../CCDebug":26,"../platform/CCSys":205,"../platform/js":217,"../platform/utils":220,"./cache":36,"./download-dom-audio":41,"./download-dom-image":42,"./download-file":43,"./download-script.js":44,"./font-loader":48,"./shared":58,"./utilities":61}],46:[function(L,S){var T=L("./bundle"),_=L("./cache"),w=L("./shared"),B=w.assets,A=w.bundles,O=new _;function R(G,V,j,H){var U=null,X=null;try{(U=new cc.Texture2D)._nativeUrl=G,U._nativeAsset=V}catch(Y){X=Y}H&&H(X,U)}function P(G,V,j,H){var U=new cc.AudioClip;U._nativeUrl=G,U._nativeAsset=V,U.duration=V.duration,H&&H(null,U)}function E(G,V,j,H){var U=new cc.VideoClip;U._nativeUrl=G,U._nativeAsset=V,H&&H(null,U)}function D(G,V,j,H){var U=new cc.JsonAsset;U.json=V,H&&H(null,U)}function I(G,V,j,H){var U=new cc.TextAsset;U.text=V,H&&H(null,U)}function M(G,V,j,H){var U=new cc.TTFFont;U._nativeUrl=G,U._nativeAsset=V,H&&H(null,U)}function N(G,V,j,H){var U=new cc.BufferAsset;U._nativeUrl=G,U._nativeAsset=V,H&&H(null,U)}var k={register:function(G,V){typeof G=="object"?cc.js.mixin(F,G):F[G]=V},create:function(G,V,j,H,U){var X,Y,z=F[j]||F.default;(X=B.get(G))?U(null,X):(Y=O.get(G))?Y.push(U):(O.add(G,[U]),z(G,V,H,function(W,Z){!W&&Z instanceof cc.Asset&&(Z._uuid=G,B.add(G,Z));for(var Q=O.remove(G),ee=0,te=Q.length;ee<te;ee++)Q[ee](W,Z)}))}},F={".png":R,".jpg":R,".bmp":R,".jpeg":R,".gif":R,".ico":R,".tiff":R,".webp":R,".image":R,".pvr":R,".pkm":R,".astc":R,".mp3":P,".ogg":P,".wav":P,".m4a":P,".mp4":E,".avi":E,".mov":E,".mpg":E,".mpeg":E,".rm":E,".rmvb":E,".txt":I,".xml":I,".vsh":I,".fsh":I,".atlas":I,".tmx":I,".tsx":I,".fnt":I,".json":D,".ExportJson":D,".font":M,".eot":M,".ttf":M,".woff":M,".svg":M,".ttc":M,".binary":N,".bin":N,".dbbin":N,".skel":N,bundle:function(G,V,j,H){var U=A.get(V.name);U||(U=new T,V.base=V.base||G+"/",U.init(V)),H&&H(null,U)},default:function(G,V,j,H){var U=new cc.Asset;U._nativeUrl=G,U._nativeAsset=V,H&&H(null,U)}};S.exports=k},{"./bundle":35,"./cache":36,"./shared":58}],47:[function(L,S){var T=L("./pack-manager"),_=L("./task"),w=L("./utilities"),B=w.getDepends,A=w.clear,O=w.forEach,R=L("./shared"),P=R.assets,E=R.fetchPipeline;function D(M){for(var N=M.output,k=0,F=N.length;k<F;k++)N[k].content&&N[k].content.decRef(!1)}function I(M,N,k,F,G,V,j){var H=N.options.__exclude__,U=N.progress;M.content=k,M.file=F,N.output.push(M),G&&(H[M.uuid]=!0,B(M.uuid,F||k,H,V,!0,!1,M.config),U.total=j+V.length),U.canInvoke&&N.dispatch("progress",++U.finish,U.total,M)}S.exports=function(M,N){var k=!1;M.progress||(M.progress={finish:0,total:M.input.length,canInvoke:!0},k=!0);var F=M.options,G=[],V=M.progress,j=V.total;F.__exclude__=F.__exclude__||Object.create(null),M.output=[],O(M.input,function(H,U){if(!H.isNative&&P.has(H.uuid)){var X=P.get(H.uuid);return X.addRef(),I(H,M,X,null,X.__asyncLoadAssets__,G,j),U()}T.load(H,M.options,function(Y,z){Y?M.isFinish||(!cc.assetManager.force||k?(cc.error(Y.message,Y.stack),V.canInvoke=!1,N(Y)):I(H,M,null,null,!1,G,j)):M.isFinish||I(H,M,null,z,!H.isNative,G,j),U()})},function(){if(M.isFinish)return A(M,!0),M.dispatch("error");if(G.length>0){var H=_.create({name:M.name+" dependencies",input:G,progress:V,options:F,onProgress:M.onProgress,onError:_.prototype.recycle,onComplete:function(U){U||(M.output.push.apply(M.output,this.output),H.recycle()),k&&D(M),N(U)}});E.async(H)}else k&&D(M),N()})}},{"./pack-manager":52,"./shared":58,"./task":59,"./utilities":61}],48:[function(L,S){var T,_=L("../utils/text-utils"),w=null,B="BES bswy:->@123丁ぁᄁ",A=Object.create(null),O=-1,R=[],P=3e3,E=(T=void 0,function(){if(T===void 0)if(window.FontFace){var M=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),N=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);T=M?parseInt(M[1],10)>42:!N}else T=!1;return T});function D(){for(var M=!0,N=Date.now(),k=R.length-1;k>=0;k--){var F=R[k],G=F.fontFamilyName;if(N-F.startTime>P)cc.warnID(4933,G),F.onComplete(null,G),R.splice(k,1);else{var V=F.refWidth,j="40px "+G;w.font=j,V!==_.safeMeasureText(w,B,j)?(R.splice(k,1),F.onComplete(null,G)):M=!1}}M&&(clearInterval(O),O=-1)}var I={loadFont:function(M,N,k){var F=I._getFontFamily(M);if(A[F])return k(null,F);if(!w){var G=document.createElement("canvas");G.width=100,G.height=100,w=G.getContext("2d")}var V="40px "+F;w.font=V;var j=_.safeMeasureText(w,B,V),H=document.createElement("style");H.type="text/css";var U="";isNaN(F-0)?U+="@font-face { font-family:"+F+"; src:":U+="@font-face { font-family:'"+F+"'; src:",U+="url('"+M+"');",H.textContent=U+"}",document.body.appendChild(H);var X,Y,z,W,Z,Q,ee=document.createElement("div"),te=ee.style;if(te.fontFamily=F,ee.innerHTML=".",te.position="absolute",te.left="-100px",te.top="-100px",document.body.appendChild(ee),E())X=Date.now(),Y=F,z=k,W=new Promise(function(ie,ne){(function he(){Date.now()-X>=P?ne():document.fonts.load("40px "+Y).then(function(pe){pe.length>=1?ie():setTimeout(he,100)},function(){ne()})})()}),Z=null,Q=new Promise(function(ie,ne){Z=setTimeout(ne,P)}),Promise.race([Q,W]).then(function(){Z&&(clearTimeout(Z),Z=null),z(null,Y)},function(){cc.warnID(4933,Y),z(null,Y)});else{var re={fontFamilyName:F,refWidth:j,onComplete:k,startTime:Date.now()};R.push(re),O===-1&&(O=setInterval(D,100))}A[F]=H},_getFontFamily:function(M){var N=M.lastIndexOf(".ttf");if(N===-1)return M;var k,F=M.lastIndexOf("/");return(k=F===-1?M.substring(0,N)+"_LABEL":M.substring(F+1,N)+"_LABEL").indexOf(" ")!==-1&&(k='"'+k+'"'),k}};S.exports=I},{"../utils/text-utils":278}],49:[function(L,S){var T,_=L("./shared").bundles,w={decodeUuid:L("../utils/decode-uuid"),getUuidFromURL:(T=/.*[/\\][0-9a-fA-F]{2}[/\\]([0-9a-fA-F-]{8,})/,function(B){var A=B.match(T);return A?A[1]:""}),getUrlWithUuid:function(B,A){(A=A||Object.create(null)).__isNative__=A.isNative,A.ext=A.nativeExt;var O=_.find(function(R){return R.getAssetInfo(B)});return O&&(A.bundle=O.name),cc.assetManager._transform(B,A)},isScene:function(B){return B&&(B.constructor===cc.SceneAsset||B instanceof cc.Scene)},normalize:function(B){return B&&(B.charCodeAt(0)===46&&B.charCodeAt(1)===47?B=B.slice(2):B.charCodeAt(0)===47&&(B=B.slice(1))),B}};S.exports=w},{"../utils/decode-uuid":266,"./shared":58}],50:[function(L){L("./deprecated"),L("./CCAssetManager")},{"./CCAssetManager":33,"./deprecated":39}],51:[function(L,S){var T=L("./pack-manager"),_=L("./pipeline"),w=L("./parser"),B=L("./utilities"),A=B.getDepends,O=B.cache,R=B.gatherAsset,P=B.setProperties,E=B.forEach,D=B.clear,I=B.checkCircleReference,M=L("./shared"),N=M.assets,k=M.files,F=M.parsed,G=M.pipeline,V=L("./task"),j=new _("loadOneAsset",[function(U,X){var Y=U.output=U.input,z=Y.options,W=Y.isNative,Z=Y.uuid,Q=Y.file,ee=z.reload;if(Q||!ee&&!W&&N.has(Z))return X();T.load(Y,U.options,function(te,re){Y.file=re,X(te)})},function(U,X){var Y=U.output=U.input,z=U.progress,W=U.options.__exclude__,Z=Y.id,Q=Y.file,ee=Y.options;if(Y.isNative)w.parse(Z,Q,Y.ext,ee,function(ue,le){if(ue)return X(ue);Y.content=le,z.canInvoke&&U.dispatch("progress",++z.finish,z.total,Y),k.remove(Z),F.remove(Z),X()});else{var te=Y.uuid;if(te in W){var re=W[te],ie=re.finish,ne=re.content,he=re.err,pe=re.callbacks;z.canInvoke&&U.dispatch("progress",++z.finish,z.total,Y),ie||I(te,te,W)?(ne&&ne.addRef&&ne.addRef(),Y.content=ne,X(he)):pe.push({done:X,item:Y})}else if(!ee.reload&&N.has(te)){var K=N.get(te);ee.__asyncLoadAssets__||!K.__asyncLoadAssets__?(Y.content=K.addRef(),z.canInvoke&&U.dispatch("progress",++z.finish,z.total,Y),X()):H(U,K,X,!1)}else w.parse(Z,Q,"import",ee,function(ue,le){if(ue)return X(ue);le._uuid=te,H(U,le,X,!0)})}}]);function H(U,X,Y,z){var W=U.input,Z=U.progress,Q=W.uuid,ee=W.id,te=W.options,re=W.config,ie=te.__asyncLoadAssets__,ne=te.cacheAsset,he=[];X.addRef&&X.addRef(),A(Q,X,Object.create(null),he,!1,ie,re),Z.canInvoke&&U.dispatch("progress",++Z.finish,Z.total+=he.length,W);var pe=U.options.__exclude__[Q]={content:X,finish:!1,callbacks:[{done:Y,item:W}]},K=V.create({input:he,options:U.options,onProgress:U.onProgress,onError:V.prototype.recycle,progress:Z,onComplete:function(ue){if(X.decRef&&X.decRef(!1),X.__asyncLoadAssets__=ie,pe.finish=!0,pe.err=ue,!ue){for(var le=Array.isArray(K.output)?K.output:[K.output],ce=Object.create(null),_e=0,oe=le.length;_e<oe;_e++){var de=le[_e];de&&(ce[de instanceof cc.Asset?de._uuid+"@import":Q+"@native"]=de)}if(z){if(!P(Q,X,ce)&&!X.__onLoadInvoked__)try{X.onLoad&&X.onLoad(),X.__onLoadInvoked__=!0}catch(Te){cc.error(Te.message,Te.stack)}k.remove(ee),F.remove(ee),O(Q,X,ne!==void 0?ne:cc.assetManager.cacheAsset)}else if(X.__nativeDepend__&&!X._nativeAsset&&!P(Q,X,ce)&&!X.__onLoadInvoked__)try{X.onLoad&&X.onLoad(),X.__onLoadInvoked__=!0}catch(Te){cc.error(Te.message,Te.stack)}K.recycle()}for(var me=pe.callbacks,ye=0,ge=me.length;ye<ge;ye++){var we=me[ye];X.addRef&&X.addRef(),we.item.content=X,we.done(ue)}me.length=0}});G.async(K)}S.exports=function(U,X){var Y=!1;U.progress||(U.progress={finish:0,total:U.input.length,canInvoke:!0},Y=!0);var z=U.options,W=U.progress;z.__exclude__=z.__exclude__||Object.create(null),U.output=[],E(U.input,function(Z,Q){var ee=V.create({input:Z,onProgress:U.onProgress,options:z,progress:W,onComplete:function(te,re){te&&!U.isFinish&&(!cc.assetManager.force||Y?(cc.error(te.message,te.stack),W.canInvoke=!1,X(te)):W.canInvoke&&U.dispatch("progress",++W.finish,W.total,re)),U.output.push(re),ee.recycle(),Q()}});j.async(ee)},function(){if(z.__exclude__=null,U.isFinish)return D(U,!0),U.dispatch("error");R(U),D(U,!0),X()})}},{"./pack-manager":52,"./parser":53,"./pipeline":54,"./shared":58,"./task":59,"./utilities":61}],52:[function(L,S){var T=L("../platform/deserialize-compiled"),_=L("./downloader"),w=L("./cache"),B=L("../platform/js"),A=L("./shared").files,O=new w;function R(D){return O.has(D.uuid)}var P={unpackJson:function(D,I,M,N){var k=B.createMap(!0),F=null;if(Array.isArray(I)){(I=(0,T.unpackJSONs)(I)).length!==D.length&&cc.errorID(4915);for(var G=0;G<D.length;G++)k[D[G]+"@import"]=I[G]}else{var V=B._getClassId(cc.Texture2D);if(I.type===V){if(I.data){var j=I.data.split("|");j.length!==D.length&&cc.errorID(4915);for(var H=0;H<D.length;H++)k[D[H]+"@import"]=(0,T.packCustomObjData)(V,j[H],!0)}}else F=new Error("unmatched type pack!"),k=null}N&&N(F,k)},init:function(){O.clear()},register:function(D,I){typeof D=="object"?B.mixin(E,D):E[D]=I},unpack:function(D,I,M,N,k){I?(0,E[M])(D,I,N,k):k&&k(new Error("package data is wrong!"))},load:function(D,I,M){if(D.isNative||!D.info||!D.info.packs)return _.download(D.id,D.url,D.ext,D.options,M);if(A.has(D.id))return M(null,A.get(D.id));var N=D.info.packs,k=N.find(R);if(k)return O.get(k.uuid).push({onComplete:M,id:D.id});k=N[0],O.add(k.uuid,[{onComplete:M,id:D.id}]);var F=cc.assetManager._transform(k.uuid,{ext:k.ext,bundle:D.config.name});_.download(k.uuid,F,k.ext,D.options,function(G,V){A.remove(k.uuid),G&&cc.error(G.message,G.stack),P.unpack(k.packs,V,k.ext,D.options,function(j,H){if(j)j.message="unpack "+F+" failed! details: "+j.message;else for(var U in H)A.add(U,H[U]);for(var X=O.remove(k.uuid),Y=0,z=X.length;Y<z;Y++){var W=X[Y];if(j)W.onComplete(j);else{var Z=H[W.id];Z?W.onComplete(null,Z):W.onComplete(new Error("can not retrieve data from package"))}}})})}},E={".json":P.unpackJson};S.exports=P},{"../platform/deserialize-compiled":211,"../platform/js":217,"./cache":36,"./downloader":45,"./shared":58}],53:[function(L,S){var T=L("../platform/CCSAXParser").plistParser,_=L("../platform/js"),w=L("./deserialize"),B=L("./cache"),A=L("./helper").isScene,O=L("./shared"),R=O.parsed,P=O.files,E=L("../platform/CCSys"),D=E.__audioSupport,I=E.capabilities,M=new B,N={parseImage:function(F,G,V){if(I.imageBitmap&&F instanceof Blob){var j={};j.imageOrientation=G.__flipY__?"flipY":"none",j.premultiplyAlpha=G.__premultiplyAlpha__?"premultiply":"none",createImageBitmap(F,j).then(function(H){H.flipY=!!G.__flipY__,H.premultiplyAlpha=!!G.__premultiplyAlpha__,V&&V(null,H)},function(H){V&&V(H,null)})}else V&&V(null,F)},parseAudio:function(F,G,V){F instanceof ArrayBuffer?D.context.decodeAudioData(F,function(j){V&&V(null,j)},function(j){V&&V(j,null)}):V&&V(null,F)},parsePVRTex:function(F,G,V){var j=null,H=null;try{var U=F instanceof ArrayBuffer?F:F.buffer,X=new Int32Array(U,0,13);if(X[0]!=55727696)throw new Error("Invalid magic number in PVR header");var Y=X[7],z=X[6],W=X[12]+52;H={_data:new Uint8Array(U,W),_compressed:!0,width:Y,height:z}}catch(Z){j=Z}V&&V(j,H)},parsePKMTex:function(){function F(G,V){return G[V]<<8|G[V+1]}return function(G,V,j){var H=null,U=null;try{var X=G instanceof ArrayBuffer?G:G.buffer,Y=new Uint8Array(X),z=F(Y,6);if(z!==0&&z!==1&&z!==3)return new Error("Invalid magic number in ETC header");var W=F(Y,12),Z=F(Y,14);F(Y,8),F(Y,10),U={_data:new Uint8Array(X,16),_compressed:!0,width:W,height:Z}}catch(Q){H=Q}j&&j(H,U)}}(),parseASTCTex:function(){function F(G,V){return G===4?cc.Texture2D.PixelFormat.RGBA_ASTC_4x4:G===5?V===4?cc.Texture2D.PixelFormat.RGBA_ASTC_5x4:cc.Texture2D.PixelFormat.RGBA_ASTC_5x5:G===6?V===5?cc.Texture2D.PixelFormat.RGBA_ASTC_6x5:cc.Texture2D.PixelFormat.RGBA_ASTC_6x6:G===8?V===5?cc.Texture2D.PixelFormat.RGBA_ASTC_8x5:V===6?cc.Texture2D.PixelFormat.RGBA_ASTC_8x6:cc.Texture2D.PixelFormat.RGBA_ASTC_8x8:G===10?V===5?cc.Texture2D.PixelFormat.RGBA_ASTC_10x5:V===6?cc.Texture2D.PixelFormat.RGBA_ASTC_10x6:V===8?cc.Texture2D.PixelFormat.RGBA_ASTC_10x8:cc.Texture2D.PixelFormat.RGBA_ASTC_10x10:V===10?cc.Texture2D.PixelFormat.RGBA_ASTC_12x10:cc.Texture2D.PixelFormat.RGBA_ASTC_12x12}return function(G,V,j){var H=null,U=null;try{var X=G instanceof ArrayBuffer?G:G.buffer,Y=new Uint8Array(X);if(Y[0]+(Y[1]<<8)+(Y[2]<<16)+(Y[3]<<24)!==1554098963)return new Error("Invalid magic number in ASTC header");var z=Y[4],W=Y[5],Z=Y[6];if((z<3||z>6||W<3||W>6||Z<3||Z>6)&&(z<4||z===7||z===9||z===11||z>12||W<4||W===7||W===9||W===11||W>12||Z!==1))return new Error("Invalid block number in ASTC header");var Q=F(z,W),ee=Y[7]+(Y[8]<<8)+(Y[9]<<16),te=Y[10]+(Y[11]<<8)+(Y[12]<<16);Y[13],Y[14],Y[15],U={_data:new Uint8Array(X,16),_compressed:!0,width:ee,height:te,format:Q}}catch(re){H=re}j(H,U)}}(),parsePlist:function(F,G,V){var j=null,H=T.parse(F);H||(j=new Error("parse failed")),V&&V(j,H)},parseImport:function(F,G,V){if(!F)return V&&V(new Error("Json is empty"));var j,H=null;try{j=w(F,G)}catch(U){H=U}V&&V(H,j)},init:function(){M.clear()},register:function(F,G){typeof F=="object"?_.mixin(k,F):k[F]=G},parse:function(F,G,V,j,H){var U,X,Y;(U=R.get(F))?H(null,U):(X=M.get(F))?X.push(H):(Y=k[V])?(M.add(F,[H]),Y(G,j,function(z,W){z?P.remove(F):A(W)||R.add(F,W);for(var Z=M.remove(F),Q=0,ee=Z.length;Q<ee;Q++)Z[Q](z,W)})):H(null,G)}},k={".png":N.parseImage,".jpg":N.parseImage,".bmp":N.parseImage,".jpeg":N.parseImage,".gif":N.parseImage,".ico":N.parseImage,".tiff":N.parseImage,".webp":N.parseImage,".image":N.parseImage,".pvr":N.parsePVRTex,".pkm":N.parsePKMTex,".astc":N.parseASTCTex,".mp3":N.parseAudio,".ogg":N.parseAudio,".wav":N.parseAudio,".m4a":N.parseAudio,".plist":N.parsePlist,import:N.parseImport};S.exports=N},{"../platform/CCSAXParser":203,"../platform/CCSys":205,"../platform/js":217,"./cache":36,"./deserialize":40,"./helper":49,"./shared":58}],54:[function(L,S){var T=L("./task"),_=0;function w(B,A){if(Array.isArray(A)){this.id=_++,this.name=B,this.pipes=[];for(var O=0,R=A.length;O<R;O++)typeof A[O]=="function"&&this.pipes.push(A[O])}else cc.warn("funcs must be an array")}w.prototype={constructor:w,insert:function(B,A){if(!(typeof B!="function"||A>this.pipes.length))return this.pipes.splice(A,0,B),this;cc.warnID(4921)},append:function(B){if(typeof B=="function")return this.pipes.push(B),this},remove:function(B){if(typeof B=="number")return this.pipes.splice(B,1),this},sync:function(B){var A=this.pipes;if(B instanceof T&&A.length!==0){B.output!=null&&(B.input=B.output,B.output=null),B._isFinish=!1;for(var O=0,R=A.length;O<R;){var P=(0,A[O])(B);if(P)return B._isFinish=!0,P;++O!==R&&(B.input=B.output,B.output=null)}return B._isFinish=!0,B.output}},async:function(B){var A=this.pipes;B instanceof T&&A.length!==0&&(B.output!=null&&(B.input=B.output,B.output=null),B._isFinish=!1,this._flow(0,B))},_flow:function(B,A){var O=this;(0,this.pipes[B])(A,function(R){R?(A._isFinish=!0,A.onComplete&&A.onComplete(R)):++B<O.pipes.length?(A.input=A.output,A.output=null,O._flow(B,A)):(A._isFinish=!0,A.onComplete&&A.onComplete(R,A.output))})}},S.exports=w},{"./task":59}],55:[function(L,S){var T=L("./task"),_=L("./shared"),w=_.transformPipeline,B=_.RequestType;S.exports=function(A,O){var R=A.options,P=Object.create(null),E=Object.create(null);for(var D in R)switch(D){case B.PATH:case B.UUID:case B.DIR:case B.SCENE:case B.URL:break;case"__requestType__":case"__isNative__":case"ext":case"type":case"__nativeName__":case"audioLoadMode":case"bundle":P[D]=R[D];break;case"__exclude__":case"__outputAsArray__":E[D]=R[D];break;default:P[D]=R[D],E[D]=R[D]}A.options=E;var I=T.create({input:A.input,options:P}),M=null;try{A.output=A.source=w.sync(I)}catch(F){M=F;for(var N=0,k=I.output.length;N<k;N++)I.output[N].recycle()}I.recycle(),O(M)}},{"./shared":58,"./task":59}],56:[function(L,S){var T=L("./depend-util"),_=L("./cache");L("../assets/CCAsset");var w=L("./shared").assets,B=L("../platform/utils").callInNextTick;function A(G,V){G._uuid&&V.push(G._uuid)}function O(G,V){for(var j=Object.getOwnPropertyNames(G),H=0;H<j.length;H++){var U=j[H];if(U!=="node"&&U!=="__eventTargets"){var X=G[U];if(typeof X=="object"&&X)if(Array.isArray(X))for(var Y=0;Y<X.length;Y++){var z=X[Y];z instanceof cc.Asset&&A(z,V)}else if(X.constructor&&X.constructor!==Object)X instanceof cc.Asset&&A(X,V);else for(var W=Object.getOwnPropertyNames(X),Z=0;Z<W.length;Z++){var Q=X[W[Z]];Q instanceof cc.Asset&&A(Q,V)}}}}var R=[];function P(G,V){for(var j=0;j<G._components.length;j++)O(G._components[j],V);for(var H=0;H<G._children.length;H++)P(G._children[H],V)}function E(G,V,j,H){j.push(G._uuid);for(var U=T.getDeps(G._uuid),X=0,Y=U.length;X<Y;X++){var z=w.get(U[X]);if(z){var W=z._uuid;if(W in V?V[W]+=H:V[W]=z.refCount+H,j.includes(W))continue;E(z,V,j,H)}}}function D(G){var V=Object.create(null);if(V[G._uuid]=G.refCount,E(G,V,R,-1),R.length=0,V[G._uuid]!==0)return V[G._uuid];for(var j in V)V[j]!==0&&E(w.get(j),V,R,1);return R.length=0,V[G._uuid]}var I=new _,M=new _,N=!1;function k(){N=!1,M.forEach(function(G){F._free(G)}),M.clear()}var F={init:function(){I.clear(),M.clear()},_addPersistNodeRef:function(G){var V=[];P(G,V);for(var j=0,H=V.length;j<H;j++){var U=w.get(V[j]);U&&U.addRef()}I.add(G.uuid,V)},_removePersistNodeRef:function(G){if(I.has(G.uuid)){for(var V=I.get(G.uuid),j=0,H=V.length;j<H;j++){var U=w.get(V[j]);U&&U.decRef()}I.remove(G.uuid)}},_autoRelease:function(G,V,j){if(G){for(var H=T.getDeps(G._id),U=0,X=H.length;U<X;U++){var Y=w.get(H[U]);Y&&Y.decRef(G.autoReleaseAssets)}var z=T._depends.get(G._id);if(z&&z.persistDeps)for(var W=z.persistDeps,Z=0,Q=W.length;Z<Q;Z++){var ee=w.get(W[Z]);ee&&ee.decRef(G.autoReleaseAssets)}G._id!==V._id&&T.remove(G._id)}var te=T._depends.get(V._id);for(var re in te&&(te.persistDeps=[]),j){for(var ie=j[re],ne=I.get(ie.uuid),he=0,pe=ne.length;he<pe;he++){var K=w.get(ne[he]);K&&K.addRef()}te&&te.persistDeps.push.apply(te.persistDeps,ne)}},_free:function(G,V){if(M.remove(G._uuid),cc.isValid(G,!0)&&!(!V&&G.refCount>0&&D(G)>0)){w.remove(G._uuid);for(var j=T.getDeps(G._uuid),H=0,U=j.length;H<U;H++){var X=w.get(j[H]);X&&(X.decRef(!1),F._free(X,!1))}G.destroy(),T.remove(G._uuid)}},tryRelease:function(G,V){G instanceof cc.Asset&&(V?F._free(G,V):(M.add(G._uuid,G),N||(N=!0,B(k))))}};S.exports=F},{"../assets/CCAsset":62,"../platform/utils":220,"./cache":36,"./depend-util":38,"./shared":58}],57:[function(L,S){var T=[];function _(){this._id="",this.uuid="",this.url="",this.ext=".json",this.content=null,this.file=null,this.info=null,this.config=null,this.isNative=!1,this.options=Object.create(null)}_.prototype={constructor:_,get id(){return this._id||(this._id=this.uuid+"@"+(this.isNative?"native":"import")),this._id},recycle:function(){T.length!==500&&(this._id="",this.uuid="",this.url="",this.ext=".json",this.content=null,this.file=null,this.info=null,this.config=null,this.isNative=!1,this.options=Object.create(null),T.push(this))}},_.create=function(){return T.length!==0?T.pop():new _},S.exports=_},{}],58:[function(L,S){var T=L("./cache"),_=L("./pipeline"),w=new T,B=new T,A=new T,O=new T,R=new _("normal load",[]),P=new _("fetch",[]),E=new _("transform url",[]);S.exports={assets:w,files:B,parsed:A,pipeline:R,fetchPipeline:P,transformPipeline:E,RequestType:{UUID:"uuid",PATH:"path",DIR:"dir",URL:"url",SCENE:"scene"},bundles:O,BuiltinBundleName:{RESOURCES:"resources",INTERNAL:"internal",MAIN:"main",START_SCENE:"start-scene"}}},{"./cache":36,"./pipeline":54}],59:[function(L,S){var T=0,_=[];function w(B){this.id=T++,this._isFinish=!0,this.onComplete=null,this.onProgress=null,this.onError=null,this.source=null,this.output=null,this.input=null,this.progress=null,this.options=null,this.set(B)}w.prototype={constructor:w,set:function(B){B=B||Object.create(null),this.onComplete=B.onComplete,this.onProgress=B.onProgress,this.onError=B.onError,this.source=this.input=B.input,this.output=null,this.progress=B.progress,this.options=B.options||Object.create(null)},dispatch:function(B,A,O,R,P){switch(B){case"complete":this.onComplete&&this.onComplete(A,O,R,P);break;case"progress":this.onProgress&&this.onProgress(A,O,R,P);break;case"error":this.onError&&this.onError(A,O,R,P);break;default:var E="on"+B[0].toUpperCase()+B.substr(1);typeof this[E]=="function"&&this[E](A,O,R,P)}},recycle:function(){_.length!==500&&(this.onComplete=null,this.onProgress=null,this.onError=null,this.source=this.output=this.input=null,this.progress=null,this.options=null,_.push(this))},get isFinish(){return this._isFinish}},w.create=function(B){var A=null;return _.length!==0?(A=_.pop()).set(B):A=new w(B),A},S.exports=w},{}],60:[function(L,S){var T=L("./helper").decodeUuid,_=L("./request-item"),w=L("./shared"),B=w.RequestType,A=w.bundles;S.exports={parse:function(O){var R=O.input,P=O.options;R=Array.isArray(R)?R:[R],O.output=[];for(var E=0;E<R.length;E++){var D=R[E],I=_.create();if(typeof D=="string"&&((D=Object.create(null))[P.__requestType__||B.UUID]=R[E]),typeof D=="object")for(var M in cc.js.addon(D,P),D.preset&&cc.js.addon(D,cc.assetManager.presets[D.preset]),D){switch(M){case B.UUID:var N=I.uuid=T(D.uuid);if(A.has(D.bundle)){if((V=(j=A.get(D.bundle)._config).getAssetInfo(N))&&V.redirect){if(!A.has(V.redirect))throw new Error("Please load bundle "+V.redirect+" first");V=(j=A.get(V.redirect)._config).getAssetInfo(N)}I.config=j,I.info=V}I.ext=D.ext||".json";break;case"__requestType__":case"ext":case"bundle":case"preset":case"type":break;case B.DIR:if(A.has(D.bundle)){var k=[];A.get(D.bundle)._config.getDirWithPath(D.dir,D.type,k);for(var F=0,G=k.length;F<G;F++){var V=k[F];R.push({uuid:V.uuid,__isNative__:!1,ext:".json",bundle:D.bundle})}}I.recycle(),I=null;break;case B.PATH:if(A.has(D.bundle)){if((V=(j=A.get(D.bundle)._config).getInfoWithPath(D.path,D.type))&&V.redirect){if(!A.has(V.redirect))throw new Error("you need to load bundle "+V.redirect+" first");V=(j=A.get(V.redirect)._config).getAssetInfo(V.uuid)}if(!V)throw I.recycle(),new Error("Bundle "+D.bundle+" doesn't contain "+D.path);I.config=j,I.uuid=V.uuid,I.info=V}I.ext=D.ext||".json";break;case B.SCENE:if(A.has(D.bundle)){var j;if((V=(j=A.get(D.bundle)._config).getSceneInfo(D.scene))&&V.redirect){if(!A.has(V.redirect))throw new Error("you need to load bundle "+V.redirect+" first");V=(j=A.get(V.redirect)._config).getAssetInfo(V.uuid)}if(!V)throw I.recycle(),new Error("Bundle "+j.name+" doesn't contain scene "+D.scene);I.config=j,I.uuid=V.uuid,I.info=V}break;case"__isNative__":I.isNative=D.__isNative__;break;case B.URL:I.url=D.url,I.uuid=D.uuid||D.url,I.ext=D.ext||cc.path.extname(D.url),I.isNative=D.__isNative__===void 0||D.__isNative__;break;default:I.options[M]=D[M]}if(!I)break}if(I&&(O.output.push(I),!I.uuid&&!I.url))throw new Error("Can not parse this input:"+JSON.stringify(D))}return null},combine:function(O){for(var R=O.output=O.input,P=0;P<R.length;P++){var E=R[P];if(!E.url){var D,I,M=E.config;I=E.isNative?M&&M.nativeBase?M.base+M.nativeBase:cc.assetManager.generalNativeBase:M&&M.importBase?M.base+M.importBase:cc.assetManager.generalImportBase;var N=E.uuid,k="";E.info&&(k=E.isNative?E.info.nativeVer?"."+E.info.nativeVer:"":E.info.ver?"."+E.info.ver:""),D=E.ext===".ttf"?I+"/"+N.slice(0,2)+"/"+N+k+"/"+E.options.__nativeName__:I+"/"+N.slice(0,2)+"/"+N+k+E.ext,E.url=D}}return null}}},{"./helper":49,"./request-item":57,"./shared":58}],61:[function(L,S){var T=L("./depend-util"),_=L("./helper"),w=_.isScene,B=_.decodeUuid,A=L("./shared").assets,O=L("../platform/utils").callInNextTick;L("../assets/CCAsset");var R={processOptions:function(P){var E=P.uuids,D=P.paths,I=P.types,M=P.deps,N=P.paths=Object.create(null);if(P.debug===!1){for(var k=0,F=E.length;k<F;k++)E[k]=B(E[k]);for(var G in D){var V=D[G],j=V[1];V[1]=I[j]}}else{for(var H=Object.create(null),U=0,X=E.length;U<X;U++){var Y=E[U];E[U]=H[Y]=B(Y)}E=H}for(var z in D){var W=D[z];N[E[z]]=W}var Z=P.scenes;for(var Q in Z){var ee=Z[Q];Z[Q]=E[ee]}var te=P.packs;for(var re in te)for(var ie=te[re],ne=0;ne<ie.length;++ne)ie[ne]=E[ie[ne]];var he=P.versions;if(he)for(var pe in he)for(var K=he[pe],ue=0;ue<K.length;ue+=2){var le=K[ue];K[ue]=E[le]||le}var ce=P.redirect;if(ce)for(var _e=0;_e<ce.length;_e+=2)ce[_e]=E[ce[_e]],ce[_e+1]=M[ce[_e+1]]},clear:function(P,E){for(var D=0,I=P.input.length;D<I;D++){var M=P.input[D];E&&!M.isNative&&M.content&&M.content.decRef&&M.content.decRef(!1),M.recycle()}P.input=null},urlAppendTimestamp:function(P){return cc.assetManager.downloader.appendTimeStamp&&typeof P=="string"?/\?/.test(P)?P+"&_t="+(new Date-0):P+"?_t="+(new Date-0):P},retry:function(P,E,D,I,M){P(M=M||0,function(N,k){M++,!N||M>E?I&&I(N,k):setTimeout(function(){R.retry(P,E,D,I,M)},D)})},getDepends:function(P,E,D,I,M,N,k){try{var F=T.parse(P,E),G=!0;if(E instanceof cc.Asset&&(!E.__nativeDepend__||E._nativeAsset)&&(G=!1),M){for(var V=0,j=F.deps.length;V<j;V++){var H=F.deps[V];H in D||(D[H]=!0,I.push({uuid:H,bundle:k&&k.name}))}G&&F.nativeDep&&(k&&(F.nativeDep.bundle=k.name),I.push(Object.assign({},F.nativeDep)))}else{N=!!E.asyncLoadAssets||N&&!F.preventDeferredLoadDependents;for(var U=0,X=F.deps.length;U<X;U++){var Y=F.deps[U];Y in D||(D[Y]=!0,I.push({uuid:Y,__asyncLoadAssets__:N,bundle:k&&k.name}))}G&&!N&&!F.preventPreloadNativeObject&&F.nativeDep&&(k&&(F.nativeDep.bundle=k.name),I.push(Object.assign({},F.nativeDep)))}}catch(z){cc.error(z.message,z.stack)}},cache:function(P,E,D){E&&!w(E)&&D&&A.add(P,E)},setProperties:function(P,E,D){var I=!1,M=E.__depends__;if(M){for(var N=0,k=M.length;N<k;N++){var F=M[N],G=D[F.uuid+"@import"];G?F.owner[F.prop]=G.addRef():(cc.error("The asset "+F.uuid+" is missing!"),I=!0)}E.__depends__=void 0}return E.__nativeDepend__&&(E._nativeAsset||(D[P+"@native"]?E._nativeAsset=D[P+"@native"]:I=!0),E.__nativeDepend__=void 0),I},gatherAsset:function(P){var E=P.source;if(P.options.__outputAsArray__||E.length!==1)for(var D=P.output=[],I=0,M=E.length;I<M;I++)D.push(E[I].content);else P.output=E[0].content},forEach:function(P,E,D){var I=0,M=[];P.length===0&&D&&D(M);for(var N=0,k=P.length;N<k;N++)E(P[N],function(F){F&&M.push(F),++I===k&&D&&D(M)})},parseParameters:function(P,E,D){if(D===void 0){var I=typeof P=="function";E?(D=E,I||(E=null)):E===void 0&&I&&(D=P,P=null,E=null),E!==void 0&&I&&(E=P,P=null)}return{options:P=P||Object.create(null),onProgress:E,onComplete:D}},parseLoadResArgs:function(P,E,D){if(D===void 0){var I=cc.js.isChildClassOf(P,cc.Asset);E?(D=E,I&&(E=null)):E!==void 0||I||(D=P,E=null,P=null),E===void 0||I||(E=P,P=null)}return{type:P,onProgress:E,onComplete:D}},checkCircleReference:function(P,E,D,I){if(I||(I=Object.create(null)),!D[E]||I[E])return!1;I[E]=!0;var M=!1,N=T.getDeps(E);if(N)for(var k=0,F=N.length;k<F;k++){var G=N[k];if(G===P||R.checkCircleReference(P,G,D,I)){M=!0;break}}return M},asyncify:function(P){return function(E,D){if(P){var I=[];Array.isArray(D)?D.forEach(function(M){return M instanceof cc.Asset&&I.push(M.addRef())}):D instanceof cc.Asset&&I.push(D.addRef()),O(function(){I.forEach(function(M){return M.decRef(!1)}),P(E,D)})}}}};S.exports=R},{"../assets/CCAsset":62,"../platform/utils":220,"./depend-util":38,"./helper":49,"./shared":58}],62:[function(L,S){var T=L("../platform/CCObject");cc.Asset=cc.Class({name:"cc.Asset",extends:T,ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0}),this.loaded=!0,this._nativeUrl="",this._ref=0},properties:{nativeUrl:{get:function(){if(!this._nativeUrl&&this._native){var _=this._native;if(_.charCodeAt(0)===47)return _.slice(1);_.charCodeAt(0)===46?this._nativeUrl=cc.assetManager.utils.getUrlWithUuid(this._uuid,{nativeExt:_,isNative:!0}):this._nativeUrl=cc.assetManager.utils.getUrlWithUuid(this._uuid,{__nativeName__:_,nativeExt:cc.path.extname(_),isNative:!0})}return this._nativeUrl},visible:!1},refCount:{get:function(){return this._ref}},_native:"",_nativeAsset:{get:function(){return this._$nativeAsset},set:function(_){this._$nativeAsset=_}},_nativeDep:{get:function(){if(this._native)return{__isNative__:!0,uuid:this._uuid,ext:this._native}}}},statics:{deserialize:!1,preventDeferredLoadDependents:!1,preventPreloadNativeObject:!1},toString:function(){return this.nativeUrl},serialize:!1,createNode:null,_setRawAsset:function(_,w){this._native=w!==!1?_||void 0:"/"+_},addRef:function(){return this._ref++,this},decRef:function(_){return this._ref>0&&this._ref--,_!==!1&&cc.assetManager._releaseManager.tryRelease(this),this},destroy:function(){return this.loaded=!1,this._super()}}),S.exports=cc.Asset},{"../platform/CCObject":202}],63:[function(L,S){var T=L("./CCAsset"),_=L("../event/event-target"),w=cc.Enum({WEB_AUDIO:0,DOM_AUDIO:1}),B=cc.Class({name:"cc.AudioClip",extends:T,mixins:[_],ctor:function(){this._loading=!1,this.loaded=!1,this._audio=null},properties:{duration:0,loadMode:{default:w.WEB_AUDIO,type:w},_nativeAsset:{get:function(){return this._audio},set:function(A){A instanceof cc.AudioClip?this._audio=A._nativeAsset:this._audio=A,this._audio&&(this.loaded=!0,this.emit("load"))},override:!0},_nativeDep:{get:function(){return{uuid:this._uuid,audioLoadMode:this.loadMode,ext:cc.path.extname(this._native),__isNative__:!0}},override:!0}},statics:{LoadMode:w,_loadByUrl:function(A,O){var R=cc.assetManager.assets.get(A);R?O(null,R):cc.assetManager.loadRemote(A,function(P,E){if(P)return O(P);O(null,E)})}},_ensureLoaded:function(A){if(this.isValid){if(this.loaded)return A&&A();if(A&&this.once("load",A),!this._loading){this._loading=!0;var O=this;cc.assetManager.postLoadNative(this,function(){O._loading=!1})}}},destroy:function(){cc.audioEngine.uncache(this),this._super()}});cc.AudioClip=B,S.exports=B},{"../event/event-target":143,"./CCAsset":62}],64:[function(L,S){var T=function(){this.u=0,this.v=0,this.w=0,this.h=0,this.offsetX=0,this.offsetY=0,this.textureID=0,this.valid=!1,this.xAdvance=0},_=function(B){this._letterDefinitions={},this._texture=B};_.prototype={constructor:_,addLetterDefinitions:function(B,A){this._letterDefinitions[B]=A},cloneLetterDefinition:function(){var B={};for(var A in this._letterDefinitions){var O=new T;cc.js.mixin(O,this._letterDefinitions[A]),B[A]=O}return B},getTexture:function(){return this._texture},getLetter:function(B){return this._letterDefinitions[B]},getLetterDefinitionForChar:function(B){var A=B.charCodeAt(0);return this._letterDefinitions.hasOwnProperty(A)?this._letterDefinitions[A]:null},clear:function(){this._letterDefinitions={}}};var w=cc.Class({name:"cc.BitmapFont",extends:cc.Font,properties:{fntDataStr:{default:""},spriteFrame:{default:null,type:cc.SpriteFrame},fontSize:{default:-1},_fntConfig:null,_fontDefDictionary:null},onLoad:function(){var B=this.spriteFrame;this._fontDefDictionary||(this._fontDefDictionary=new _,B&&(this._fontDefDictionary._texture=B._texture));var A=this._fntConfig;if(A){var O=A.fontDefDictionary;for(var R in O){var P=new T,E=O[R].rect;P.offsetX=O[R].xOffset,P.offsetY=O[R].yOffset,P.w=E.width,P.h=E.height,P.u=E.x,P.v=E.y,P.textureID=0,P.valid=!0,P.xAdvance=O[R].xAdvance,this._fontDefDictionary.addLetterDefinitions(R,P)}}}});cc.BitmapFont=w,cc.BitmapFont.FontLetterDefinition=T,cc.BitmapFont.FontAtlas=_,S.exports=w},{}],65:[function(L,S){var T=cc.Class({name:"cc.BufferAsset",extends:cc.Asset,ctor:function(){this._buffer=null},properties:{_nativeAsset:{get:function(){return this._buffer},set:function(_){this._buffer=_.buffer||_},override:!0},buffer:function(){return this._buffer}}});cc.BufferAsset=S.exports=T},{}],66:[function(L,S){var T=cc.Class({name:"cc.Font",extends:cc.Asset});cc.Font=S.exports=T},{}],67:[function(L,S){var T=cc.Class({name:"cc.JsonAsset",extends:cc.Asset,properties:{json:null}});S.exports=cc.JsonAsset=T},{}],68:[function(L,S){var T=cc.Class({name:"cc.LabelAtlas",extends:cc.BitmapFont,onLoad:function(){this.spriteFrame?this._fntConfig?this._super():cc.warnID(9101,this.name):cc.warnID(9100,this.name)}});cc.LabelAtlas=T,S.exports=T},{}],69:[function(L,S){var T=cc.Enum({AUTO:0,SINGLE_INSTANCE:1,MULTI_INSTANCE:2}),_=cc.Class({name:"cc.Prefab",extends:cc.Asset,ctor:function(){this._createFunction=null,this._instantiatedTimes=0},properties:{data:null,optimizationPolicy:T.AUTO,asyncLoadAssets:!1,readonly:{default:!1,editorOnly:!0}},statics:{OptimizationPolicy:T,OptimizationPolicyThreshold:3},createNode:!1,compileCreateFunction:function(){var w=L("../platform/instantiate-jit");this._createFunction=w.compile(this.data)},_doInstantiate:function(w){return this.data._prefab||cc.warnID(3700),this._createFunction||this.compileCreateFunction(),this._createFunction(w)},_instantiate:function(){var w;return this.optimizationPolicy!==T.SINGLE_INSTANCE&&(this.optimizationPolicy===T.MULTI_INSTANCE||this._instantiatedTimes+1>=_.OptimizationPolicyThreshold)?(w=this._doInstantiate(),this.data._instantiate(w)):w=this.data._instantiate(),++this._instantiatedTimes,w},destroy:function(){this.data&&this.data.destroy(),this._super()}});cc.Prefab=S.exports=_,cc.js.obsolete(cc,"cc._Prefab","Prefab")},{"../platform/instantiate-jit":215}],70:[function(L,S){var T,_=(T=L("../../renderer/gfx"))&&T.__esModule?T:{default:T},w=L("../renderer"),B=L("./CCTexture2D"),A=cc.Enum({RB_FMT_D24S8:_.default.RB_FMT_D24S8,RB_FMT_S8:_.default.RB_FMT_S8,RB_FMT_D16:_.default.RB_FMT_D16}),O=cc.Class({name:"cc.RenderTexture",extends:B,statics:{DepthStencilFormat:A},ctor:function(){this._framebuffer=null},initWithSize:function(R,P,E){this.width=Math.floor(R||cc.visibleRect.width),this.height=Math.floor(P||cc.visibleRect.height),this._resetUnderlyingMipmaps();var D,I={colors:[this._texture]};this._depthStencilBuffer&&this._depthStencilBuffer.destroy(),E&&(D=new _.default.RenderBuffer(w.device,E,R,P),E===_.default.RB_FMT_D24S8?I.depthStencil=D:E===_.default.RB_FMT_S8?I.stencil=D:E===_.default.RB_FMT_D16&&(I.depth=D)),this._depthStencilBuffer=D,this._framebuffer&&this._framebuffer.destroy(),this._framebuffer=new _.default.FrameBuffer(w.device,R,P,I),this._packable=!1,this.loaded=!0,this.emit("load")},updateSize:function(R,P){this.width=Math.floor(R||cc.visibleRect.width),this.height=Math.floor(P||cc.visibleRect.height),this._resetUnderlyingMipmaps();var E=this._depthStencilBuffer;E&&E.update(this.width,this.height),this._framebuffer._width=R,this._framebuffer._height=P},drawTextureAt:function(R,P,E){R._image&&R._image.width!==0&&this._texture.updateSubImage({x:P,y:E,image:R._image,width:R.width,height:R.height,level:0,flipY:!1,premultiplyAlpha:R._premultiplyAlpha})},readPixels:function(R,P,E,D,I){if(!this._framebuffer||!this._texture)return R;P=P||0,E=E||0;var M=D||this.width,N=I||this.height;R=R||new Uint8Array(M*N*4);var k=cc.game._renderContext,F=k.getParameter(k.FRAMEBUFFER_BINDING);return k.bindFramebuffer(k.FRAMEBUFFER,this._framebuffer.getHandle()),k.readPixels(P,E,M,N,k.RGBA,k.UNSIGNED_BYTE,R),k.bindFramebuffer(k.FRAMEBUFFER,F),R},destroy:function(){this._super(),this._framebuffer&&(this._framebuffer.destroy(),this._framebuffer=null)}});cc.RenderTexture=S.exports=O},{"../../renderer/gfx":319,"../renderer":227,"./CCTexture2D":77}],71:[function(L,S){var T=cc.Class({name:"cc.SceneAsset",extends:cc.Asset,properties:{scene:null,asyncLoadAssets:void 0}});cc.SceneAsset=T,S.exports=T},{}],72:[function(){var L=cc.Class({name:"cc.Script",extends:cc.Asset});cc._Script=L;var S=cc.Class({name:"cc.JavaScript",extends:L});cc._JavaScript=S;var T=cc.Class({name:"cc.TypeScript",extends:L});cc._TypeScript=T},{}],73:[function(L,S){var T=cc.Class({name:"cc.SpriteAtlas",extends:cc.Asset,properties:{_spriteFrames:{default:{}}},getTexture:function(){var _=Object.keys(this._spriteFrames);if(_.length>0){var w=this._spriteFrames[_[0]];return w?w.getTexture():null}return null},getSpriteFrame:function(_){var w=this._spriteFrames[_];return w?(w.name||(w.name=_),w):null},getSpriteFrames:function(){var _=[],w=this._spriteFrames;for(var B in w)_.push(this.getSpriteFrame(B));return _}});cc.SpriteAtlas=T,S.exports=T},{}],74:[function(L,S){var T=L("../event/event-target"),_=[{u:0,v:0},{u:0,v:0},{u:0,v:0},{u:0,v:0}],w=cc.Class({name:"cc.SpriteFrame",extends:L("../assets/CCAsset"),mixins:[T],properties:{_textureSetter:{set:function(A){A&&this._texture!==A&&this._refreshTexture(A)}},insetTop:{get:function(){return this._capInsets[1]},set:function(A){this._capInsets[1]=A,this._texture&&this._calculateSlicedUV()}},insetBottom:{get:function(){return this._capInsets[3]},set:function(A){this._capInsets[3]=A,this._texture&&this._calculateSlicedUV()}},insetLeft:{get:function(){return this._capInsets[0]},set:function(A){this._capInsets[0]=A,this._texture&&this._calculateSlicedUV()}},insetRight:{get:function(){return this._capInsets[2]},set:function(A){this._capInsets[2]=A,this._texture&&this._calculateSlicedUV()}}},ctor:function(){T.call(this);var A=arguments[0],O=arguments[1],R=arguments[2],P=arguments[3],E=arguments[4];this._rect=null,this.uv=[],this._texture=null,this._original=null,this._offset=null,this._originalSize=null,this._rotated=!1,this._flipX=!1,this._flipY=!1,this.vertices=null,this._capInsets=[0,0,0,0],this.uvSliced=[],A!==void 0&&this.setTexture(A,O,R,P,E)},textureLoaded:function(){return this._texture&&this._texture.loaded},onTextureLoaded:function(A,O){return this.textureLoaded()?(A.call(O),!0):(this.once("load",A,O),this.ensureLoadTexture(),!1)},isRotated:function(){return this._rotated},setRotated:function(A){this._rotated=A,this._texture&&this._calculateUV()},isFlipX:function(){return this._flipX},isFlipY:function(){return this._flipY},setFlipX:function(A){this._flipX=A,this._texture&&this._calculateUV()},setFlipY:function(A){this._flipY=A,this._texture&&this._calculateUV()},getRect:function(){return cc.rect(this._rect)},setRect:function(A){this._rect=A,this._texture&&this._calculateUV()},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(A){this._originalSize?(this._originalSize.width=A.width,this._originalSize.height=A.height):this._originalSize=cc.size(A)},getTexture:function(){return this._texture},_textureLoadedCallback:function(){var A=this._texture;if(A){var O=A.width,R=A.height;this._rect?this._checkRect(this._texture):this._rect=cc.rect(0,0,O,R),this._originalSize||(this._originalSize=cc.size(O,R)),this._offset||(this._offset=cc.v2(0,0)),this._calculateUV(),this.emit("load")}},_refreshTexture:function(A){this._texture=A,A.loaded?this._textureLoadedCallback():A.once("load",this._textureLoadedCallback,this)},getOffset:function(){return cc.v2(this._offset)},setOffset:function(A){this._offset=cc.v2(A)},clone:function(){return new w(this._texture,this.getRect(),this._rotated,this.getOffset(),this.getOriginalSize())},setTexture:function(A,O,R,P,E){if(arguments.length!==1||A!==this._texture){if(this._rect=O||null,P?this.setOffset(P):this._offset=null,E?this.setOriginalSize(E):this._originalSize=null,this._rotated=R||!1,typeof A!="string")return A instanceof cc.Texture2D&&this._refreshTexture(A),!0;cc.errorID(3401)}},ensureLoadTexture:function(){this._texture&&(this._texture.loaded||(this._refreshTexture(this._texture),cc.assetManager.postLoadNative(this._texture)))},_checkRect:function(A){var O=this._rect,R=O.x,P=O.y;this._rotated?(R+=O.height,P+=O.width):(R+=O.width,P+=O.height),R>A.width&&cc.errorID(3300,A.nativeUrl+"/"+this.name,R,A.width),P>A.height&&cc.errorID(3400,A.nativeUrl+"/"+this.name,P,A.height)},_flipXY:function(A){if(this._flipX){var O=A[0];A[0]=A[1],A[1]=O,O=A[2],A[2]=A[3],A[3]=O}if(this._flipY){var R=A[0];A[0]=A[2],A[2]=R,R=A[1],A[1]=A[3],A[3]=R}},_calculateSlicedUV:function(){var A=this._rect,O=this._texture.width,R=this._texture.height,P=this._capInsets[0],E=this._capInsets[2],D=A.width-P-E,I=this._capInsets[1],M=this._capInsets[3],N=A.height-I-M,k=this.uvSliced;if(k.length=0,this._rotated){_[0].u=A.x/O,_[1].u=(A.x+M)/O,_[2].u=(A.x+M+N)/O,_[3].u=(A.x+A.height)/O,_[3].v=A.y/R,_[2].v=(A.y+P)/R,_[1].v=(A.y+P+D)/R,_[0].v=(A.y+A.width)/R,this._flipXY(_);for(var F=0;F<4;++F)for(var G=_[F],V=0;V<4;++V){var j=_[3-V];k.push({u:G.u,v:j.v})}}else{_[0].u=A.x/O,_[1].u=(A.x+P)/O,_[2].u=(A.x+P+D)/O,_[3].u=(A.x+A.width)/O,_[3].v=A.y/R,_[2].v=(A.y+I)/R,_[1].v=(A.y+I+N)/R,_[0].v=(A.y+A.height)/R,this._flipXY(_);for(var H=0;H<4;++H)for(var U=_[H],X=0;X<4;++X){var Y=_[X];k.push({u:Y.u,v:U.v})}}},_setDynamicAtlasFrame:function(A){A&&(this._original={_texture:this._texture,_x:this._rect.x,_y:this._rect.y},this._texture=A.texture,this._rect.x=A.x,this._rect.y=A.y,this._calculateUV())},_resetDynamicAtlasFrame:function(){this._original&&(this._rect.x=this._original._x,this._rect.y=this._original._y,this._texture=this._original._texture,this._original=null,this._texture.loaded?this._calculateUV():this.ensureLoadTexture())},_calculateUV:function(){var A=this._rect,O=this._texture,R=this.uv,P=O.width,E=O.height;if(this._rotated){var D=P===0?0:A.x/P,I=P===0?0:(A.x+A.height)/P,M=E===0?0:(A.y+A.width)/E,N=E===0?0:A.y/E;R[0]=D,R[1]=N,R[2]=D,R[3]=M,R[4]=I,R[5]=N,R[6]=I,R[7]=M}else{var k=P===0?0:A.x/P,F=P===0?0:(A.x+A.width)/P,G=E===0?0:(A.y+A.height)/E,V=E===0?0:A.y/E;R[0]=k,R[1]=G,R[2]=F,R[3]=G,R[4]=k,R[5]=V,R[6]=F,R[7]=V}if(this._flipX){var j=R[0];R[0]=R[2],R[2]=j,j=R[1],R[1]=R[3],R[3]=j,j=R[4],R[4]=R[6],R[6]=j,j=R[5],R[5]=R[7],R[7]=j}if(this._flipY){var H=R[0];R[0]=R[4],R[4]=H,H=R[1],R[1]=R[5],R[5]=H,H=R[2],R[2]=R[6],R[6]=H,H=R[3],R[3]=R[7],R[7]=H}var U=this.vertices;if(U){U.nu.length=0,U.nv.length=0;for(var X=0;X<U.u.length;X++)U.nu[X]=U.u[X]/P,U.nv[X]=U.v[X]/E}this._calculateSlicedUV()},_serialize:!1,_deserialize:function(A){var O=A.rect;O&&(this._rect=new cc.Rect(O[0],O[1],O[2],O[3])),A.offset&&this.setOffset(new cc.Vec2(A.offset[0],A.offset[1])),A.originalSize&&this.setOriginalSize(new cc.Size(A.originalSize[0],A.originalSize[1])),this._rotated=A.rotated===1,this._name=A.name;var R=A.capInsets;R&&(this._capInsets[0]=R[0],this._capInsets[1]=R[1],this._capInsets[2]=R[2],this._capInsets[3]=R[3]),this.vertices=A.vertices,this.vertices&&(this.vertices.nu=[],this.vertices.nv=[])}}),B=w.prototype;B.copyWithZone=B.clone,B.copy=B.clone,B.initWithTexture=B.setTexture,cc.SpriteFrame=w,S.exports=w},{"../assets/CCAsset":62,"../event/event-target":143}],75:[function(L,S){var T=L("./CCFont"),_=cc.Class({name:"cc.TTFFont",extends:T,properties:{_fontFamily:null,_nativeAsset:{type:cc.String,get:function(){return this._fontFamily},set:function(w){this._fontFamily=w||"Arial"},override:!0},_nativeDep:{get:function(){return{uuid:this._uuid,__nativeName__:this._native,ext:cc.path.extname(this._native),__isNative__:!0}},override:!0}}});cc.TTFFont=S.exports=_},{"./CCFont":66}],76:[function(L,S){var T=cc.Class({name:"cc.TextAsset",extends:cc.Asset,properties:{text:""},toString:function(){return this.text}});S.exports=cc.TextAsset=T},{}],77:[function(L,S){var T,_=(T=L("../../renderer/gfx"))&&T.__esModule?T:{default:T},w=L("../event/event-target"),B=L("../renderer");L("../platform/CCClass");var A=new(L("../platform/id-generater"))("Tex"),O=1024,R=cc.Enum({RGB565:_.default.TEXTURE_FMT_R5_G6_B5,RGB5A1:_.default.TEXTURE_FMT_R5_G5_B5_A1,RGBA4444:_.default.TEXTURE_FMT_R4_G4_B4_A4,RGB888:_.default.TEXTURE_FMT_RGB8,RGBA8888:_.default.TEXTURE_FMT_RGBA8,RGBA32F:_.default.TEXTURE_FMT_RGBA32F,A8:_.default.TEXTURE_FMT_A8,I8:_.default.TEXTURE_FMT_L8,AI8:_.default.TEXTURE_FMT_L8_A8,RGB_PVRTC_2BPPV1:_.default.TEXTURE_FMT_RGB_PVRTC_2BPPV1,RGBA_PVRTC_2BPPV1:_.default.TEXTURE_FMT_RGBA_PVRTC_2BPPV1,RGB_A_PVRTC_2BPPV1:O++,RGB_PVRTC_4BPPV1:_.default.TEXTURE_FMT_RGB_PVRTC_4BPPV1,RGBA_PVRTC_4BPPV1:_.default.TEXTURE_FMT_RGBA_PVRTC_4BPPV1,RGB_A_PVRTC_4BPPV1:O++,RGB_ETC1:_.default.TEXTURE_FMT_RGB_ETC1,RGBA_ETC1:O++,RGB_ETC2:_.default.TEXTURE_FMT_RGB_ETC2,RGBA_ETC2:_.default.TEXTURE_FMT_RGBA_ETC2,RGBA_ASTC_4x4:_.default.TEXTURE_FMT_RGBA_ASTC_4X4,RGBA_ASTC_5x4:_.default.TEXTURE_FMT_RGBA_ASTC_5X4,RGBA_ASTC_5x5:_.default.TEXTURE_FMT_RGBA_ASTC_5X5,RGBA_ASTC_6x5:_.default.TEXTURE_FMT_RGBA_ASTC_6X5,RGBA_ASTC_6x6:_.default.TEXTURE_FMT_RGBA_ASTC_6X6,RGBA_ASTC_8x5:_.default.TEXTURE_FMT_RGBA_ASTC_8X5,RGBA_ASTC_8x6:_.default.TEXTURE_FMT_RGBA_ASTC_8X6,RGBA_ASTC_8x8:_.default.TEXTURE_FMT_RGBA_ASTC_8X8,RGBA_ASTC_10x5:_.default.TEXTURE_FMT_RGBA_ASTC_10X5,RGBA_ASTC_10x6:_.default.TEXTURE_FMT_RGBA_ASTC_10X6,RGBA_ASTC_10x8:_.default.TEXTURE_FMT_RGBA_ASTC_10X8,RGBA_ASTC_10x10:_.default.TEXTURE_FMT_RGBA_ASTC_10X10,RGBA_ASTC_12x10:_.default.TEXTURE_FMT_RGBA_ASTC_12X10,RGBA_ASTC_12x12:_.default.TEXTURE_FMT_RGBA_ASTC_12X12}),P=cc.Enum({REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648}),E=cc.Enum({LINEAR:9729,NEAREST:9728}),D={9728:0,9729:1},I=[],M={width:void 0,height:void 0,minFilter:void 0,magFilter:void 0,wrapS:void 0,wrapT:void 0,format:void 0,genMipmaps:void 0,images:void 0,image:void 0,flipY:void 0,premultiplyAlpha:void 0};function N(){for(var F in M)M[F]=void 0;return I.length=0,M.images=I,M}var k=cc.Class({name:"cc.Texture2D",extends:L("../assets/CCAsset"),mixins:[w],properties:{_nativeAsset:{get:function(){return this._image},set:function(F){F._compressed&&F._data?this.initWithData(F._data,this._format,F.width,F.height):this.initWithElement(F)},override:!0},_format:R.RGBA8888,_premultiplyAlpha:!1,_flipY:!1,_minFilter:E.LINEAR,_magFilter:E.LINEAR,_mipFilter:E.LINEAR,_wrapS:P.CLAMP_TO_EDGE,_wrapT:P.CLAMP_TO_EDGE,_isAlphaAtlas:!1,_genMipmaps:!1,genMipmaps:{get:function(){return this._genMipmaps},set:function(F){if(this._genMipmaps!==F){var G=N();G.genMipmaps=F,this.update(G)}}},_packable:!0,packable:{get:function(){return this._packable},set:function(F){this._packable=F}},_nativeDep:{get:function(){return{__isNative__:!0,uuid:this._uuid,ext:this._native,__flipY__:this._flipY,__premultiplyAlpha__:this._premultiplyAlpha}},override:!0}},statics:{PixelFormat:R,WrapMode:P,Filter:E,_FilterIndex:D,extnames:[".png",".jpg",".jpeg",".bmp",".webp",".pvr",".pkm",".astc"],_parseExt:function(F,G){for(var V=cc.renderer.device,j=F.split("_"),H="",U="",X=999,Y=G,z=cc.macro.SUPPORT_TEXTURE_FORMATS,W=0;W<j.length;W++){var Z=j[W].split("@"),Q=Z[0];Q=k.extnames[Q.charCodeAt(0)-48]||Q;var ee=z.indexOf(Q);if(ee!==-1&&ee<X){var te=Z[1]?parseInt(Z[1]):G;if(Q===".astc"&&!V.ext("WEBGL_compressed_texture_astc")||Q===".pvr"&&!V.ext("WEBGL_compressed_texture_pvrtc")||!(te!==R.RGB_ETC1&&te!==R.RGBA_ETC1||V.ext("WEBGL_compressed_texture_etc1"))||!(te!==R.RGB_ETC2&&te!==R.RGBA_ETC2||V.ext("WEBGL_compressed_texture_etc"))||Q===".webp"&&!cc.sys.capabilities.webp)continue;X=ee,U=Q,Y=te}else H||(H=Q)}return{bestExt:U,bestFormat:Y,defaultExt:H}}},ctor:function(){this._id=A.getNewId(),this.loaded=!1,this.width=0,this.height=0,this._hashDirty=!0,this._hash=0,this._texture=null},getImpl:function(){return this._texture||(this._texture=new B.Texture2D(B.device,{})),this._texture},getId:function(){return this._id},toString:function(){return this.nativeUrl||""},update:function(F){if(F){var G=!1;F.width!==void 0&&(this.width=F.width),F.height!==void 0&&(this.height=F.height),F.minFilter!==void 0&&(this._minFilter=F.minFilter,F.minFilter=D[F.minFilter]),F.magFilter!==void 0&&(this._magFilter=F.magFilter,F.magFilter=D[F.magFilter]),F.mipFilter!==void 0&&(this._mipFilter=F.mipFilter,F.mipFilter=D[F.mipFilter]),F.wrapS!==void 0&&(this._wrapS=F.wrapS),F.wrapT!==void 0&&(this._wrapT=F.wrapT),F.format!==void 0&&(this._format=F.format),F.flipY!==void 0&&(this._flipY=F.flipY,G=!0),F.premultiplyAlpha!==void 0&&(this._premultiplyAlpha=F.premultiplyAlpha,G=!0),F.genMipmaps!==void 0&&(this._genMipmaps=F.genMipmaps),cc.sys.capabilities.imageBitmap&&this._image instanceof ImageBitmap?this._checkImageBitmap(this._upload.bind(this,F,G)):this._upload(F,G)}},_upload:function(F,G){G&&this._image&&(F.image=this._image),F.images&&F.images.length>0?this._image=F.images[0]:F.image!==void 0&&(this._image=F.image,F.images||(I.length=0,F.images=I),F.images.push(F.image)),this._texture&&this._texture.update(F),this._hashDirty=!0},initWithElement:function(F){if(F)if(this._image=F,F.complete||F instanceof HTMLCanvasElement)this.handleLoadedTexture();else if(cc.sys.capabilities.imageBitmap&&F instanceof ImageBitmap)this._checkImageBitmap(this.handleLoadedTexture.bind(this));else{var G=this;F.addEventListener("load",function(){G.handleLoadedTexture()}),F.addEventListener("error",function(V){cc.warnID(3119,V.message)})}},initWithData:function(F,G,V,j){var H=N();return H.image=F,H.images=[H.image],H.genMipmaps=this._genMipmaps,H.premultiplyAlpha=this._premultiplyAlpha,H.flipY=this._flipY,H.minFilter=D[this._minFilter],H.magFilter=D[this._magFilter],H.wrapS=this._wrapS,H.wrapT=this._wrapT,H.format=this._getGFXPixelFormat(G),H.width=V,H.height=j,this._texture?this._texture.update(H):this._texture=new B.Texture2D(B.device,H),this.width=V,this.height=j,this._updateFormat(),this._checkPackable(),this.loaded=!0,this.emit("load"),!0},getHtmlElementObj:function(){return this._image},destroy:function(){cc.sys.capabilities.imageBitmap&&this._image instanceof ImageBitmap&&this._image.close&&this._image.close(),this._packable&&cc.dynamicAtlasManager&&cc.dynamicAtlasManager.deleteAtlasTexture(this),this._image=null,this._texture&&this._texture.destroy(),this._super()},getPixelFormat:function(){return this._format},hasPremultipliedAlpha:function(){return this._premultiplyAlpha||!1},isAlphaAtlas:function(){return this._isAlphaAtlas},handleLoadedTexture:function(){if(this._image&&this._image.width&&this._image.height){this.width=this._image.width,this.height=this._image.height;var F=N();F.image=this._image,F.images=[F.image],F.width=this.width,F.height=this.height,F.genMipmaps=this._genMipmaps,F.format=this._getGFXPixelFormat(this._format),F.premultiplyAlpha=this._premultiplyAlpha,F.flipY=this._flipY,F.minFilter=D[this._minFilter],F.magFilter=D[this._magFilter],F.wrapS=this._wrapS,F.wrapT=this._wrapT,this._texture?this._texture.update(F):this._texture=new B.Texture2D(B.device,F),this._updateFormat(),this._checkPackable(),this.loaded=!0,this.emit("load"),cc.macro.CLEANUP_IMAGE_CACHE&&this._cleanupImageCache()}},_cleanupImageCache:function(){this._image instanceof HTMLImageElement?this._clearImage():cc.sys.capabilities.imageBitmap&&this._image instanceof ImageBitmap&&this._image.close&&this._image.close()},description:function(){return"<cc.Texture2D | Name = "+this.nativeUrl+" | Dimensions = "+this.width+" x "+this.height+">"},releaseTexture:function(){this._image=null,this._texture&&this._texture.destroy()},setWrapMode:function(F,G){if(this._wrapS!==F||this._wrapT!==G){var V=N();V.wrapS=F,V.wrapT=G,this.update(V)}},setFilters:function(F,G){if(this._minFilter!==F||this._magFilter!==G){var V=N();V.minFilter=F,V.magFilter=G,this.update(V)}},setFlipY:function(F){if(this._flipY!==F){var G=N();G.flipY=F,G.premultiplyAlpha=this._premultiplyAlpha,this.update(G)}},setPremultiplyAlpha:function(F){if(this._premultiplyAlpha!==F){var G=N();G.flipY=this._flipY,G.premultiplyAlpha=F,this.update(G)}},_updateFormat:function(){this._isAlphaAtlas=this._format===R.RGBA_ETC1||this._format===R.RGB_A_PVRTC_4BPPV1||this._format===R.RGB_A_PVRTC_2BPPV1},_checkPackable:function(){var F=cc.dynamicAtlasManager;if(F)if(this._isCompressed())this._packable=!1;else{var G=this.width,V=this.height;!this._image||G>F.maxFrameSize||V>F.maxFrameSize||this._getHash()!==F.Atlas.DEFAULT_HASH?this._packable=!1:this._image&&this._image instanceof HTMLCanvasElement&&(this._packable=!0)}},_getOpts:function(){var F=N();return F.width=this.width,F.height=this.height,F.genMipmaps=this._genMipmaps,F.format=this._format,F.premultiplyAlpha=this._premultiplyAlpha,F.anisotropy=this._anisotropy,F.flipY=this._flipY,F.minFilter=D[this._minFilter],F.magFilter=D[this._magFilter],F.mipFilter=D[this._mipFilter],F.wrapS=this._wrapS,F.wrapT=this._wrapT,F},_getGFXPixelFormat:function(F){return F===R.RGBA_ETC1?F=R.RGB_ETC1:F===R.RGB_A_PVRTC_4BPPV1?F=R.RGB_PVRTC_4BPPV1:F===R.RGB_A_PVRTC_2BPPV1&&(F=R.RGB_PVRTC_2BPPV1),F},_resetUnderlyingMipmaps:function(F){var G=this._getOpts();G.images=F||[null],this._texture?this._texture.update(G):this._texture=new B.Texture2D(B.device,G)},_serialize:!1,_deserialize:function(F){var G=F.split(","),V=G[0];if(V){var j=k._parseExt(V,this._format);if(j.bestExt)this._setRawAsset(j.bestExt),this._format=j.bestFormat;else{if(!j.defaultExt)throw new Error(cc.debug.getError(3121));this._setRawAsset(j.defaultExt),cc.warnID(3120,j.defaultExt,j.defaultExt)}}G.length===8&&(this._minFilter=parseInt(G[1]),this._magFilter=parseInt(G[2]),this._wrapS=parseInt(G[3]),this._wrapT=parseInt(G[4]),this._premultiplyAlpha=G[5].charCodeAt(0)===49,this._genMipmaps=G[6].charCodeAt(0)===49,this._packable=G[7].charCodeAt(0)===49)},_getHash:function(){if(!this._hashDirty)return this._hash;var F=this._genMipmaps?1:0,G=this._premultiplyAlpha?1:0,V=this._flipY?1:0,j=this._minFilter===E.LINEAR?1:2,H=this._magFilter===E.LINEAR?1:2,U=this._wrapS===P.REPEAT?1:this._wrapS===P.CLAMP_TO_EDGE?2:3,X=this._wrapT===P.REPEAT?1:this._wrapT===P.CLAMP_TO_EDGE?2:3,Y=this._format;return this._image,this._hash=+(""+j+H+Y+U+X+F+G+V),this._hashDirty=!1,this._hash},_isCompressed:function(){return this._format<R.A8||this._format>R.RGBA32F},_clearImage:function(){this._image.src=""},_checkImageBitmap:function(F){var G=this,V=this._image,j=this._flipY,H=this._premultiplyAlpha;this._flipY!==V.flipY||this._premultiplyAlpha!==V.premultiplyAlpha?createImageBitmap(V,{imageOrientation:j!==V.flipY?"flipY":"none",premultiplyAlpha:H?"premultiply":"none"}).then(function(U){V.close&&V.close(),U.flipY=j,U.premultiplyAlpha=H,G._image=U,F()},function(U){cc.error(U.message)}):F()}});cc.Texture2D=S.exports=k},{"../../renderer/gfx":319,"../assets/CCAsset":62,"../event/event-target":143,"../platform/CCClass":196,"../platform/id-generater":213,"../renderer":227}],78:[function(L,S){var T=L("./CCAsset"),_=L("../event/event-target"),w=cc.Class({name:"cc.VideoClip",extends:T,mixins:[_]});cc.VideoClip=w,S.exports=w},{"../event/event-target":143,"./CCAsset":62}],79:[function(L){L("./CCAsset"),L("./CCFont"),L("./CCPrefab"),L("./CCAudioClip"),L("./CCVideoClip"),L("./CCScripts"),L("./CCSceneAsset"),L("./CCSpriteFrame"),L("./CCTexture2D"),L("./CCRenderTexture"),L("./CCTTFFont"),L("./CCSpriteAtlas"),L("./CCBitmapFont"),L("./CCLabelAtlas"),L("./CCTextAsset"),L("./CCJsonAsset"),L("./CCBufferAsset"),L("./material")},{"./CCAsset":62,"./CCAudioClip":63,"./CCBitmapFont":64,"./CCBufferAsset":65,"./CCFont":66,"./CCJsonAsset":67,"./CCLabelAtlas":68,"./CCPrefab":69,"./CCRenderTexture":70,"./CCSceneAsset":71,"./CCScripts":72,"./CCSpriteAtlas":73,"./CCSpriteFrame":74,"./CCTTFFont":75,"./CCTextAsset":76,"./CCTexture2D":77,"./CCVideoClip":78,"./material":86}],80:[function(L,S){var T,_=(T=L("../CCAsset"))&&T.__esModule?T:{default:T},w=L("./effect-parser"),B=cc.Class({name:"cc.EffectAsset",extends:_.default,ctor:function(){this._effect=null},properties:{properties:Object,techniques:[],shaders:[]},onLoad:function(){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){for(var A=cc.renderer._forward._programLib,O=0;O<this.shaders.length;O++)A.define(this.shaders[O]);this._initEffect()}},_initEffect:function(){this._effect||(this._effect=(0,w.parseEffect)(this),Object.freeze(this._effect))},getInstantiatedEffect:function(){return this._initEffect(),this._effect.clone()},getEffect:function(){return this._initEffect(),this._effect}});S.exports=cc.EffectAsset=B},{"../CCAsset":62,"./effect-parser":83}],81:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("../CCAsset"),w=L("../CCTexture2D"),B=(w.PixelFormat,L("./CCEffectAsset")),A=(L("../../utils/texture-util"),cc.gfx),O=cc.Enum({SPRITE:"2d-sprite",GRAY_SPRITE:"2d-gray-sprite",UNLIT:"unlit"}),R=cc.Class({name:"cc.Material",extends:_,ctor:function(){this.loaded=!1,this._manualHash=!1,this._dirty=!0,this._effect=null},properties:{_defines:{default:void 0,type:Object},_props:{default:void 0,type:Object},_effectAsset:{type:B,default:null},_techniqueIndex:0,_techniqueData:Object,effectName:void 0,effectAsset:{get:function(){return this._effectAsset},set:function(E){cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS&&(this._effectAsset=E,E?this._effect=this._effectAsset.getInstantiatedEffect():cc.error("Can not set an empty effect asset."))}},effect:{get:function(){return this._effect}},techniqueIndex:{get:function(){return this._techniqueIndex},set:function(E){this._techniqueIndex=E,this._effect.switchTechnique(E)}}},statics:{getBuiltinMaterial:function(E){return cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?new cc.Material:cc.assetManager.builtins.getBuiltin("material","builtin-"+E)},BUILTIN_NAME:O,createWithBuiltin:function(E,D){D===void 0&&(D=0);var I=cc.assetManager.builtins.getBuiltin("effect","builtin-"+E);return R.create(I,D)},create:function(E,D){if(D===void 0&&(D=0),!E)return null;var I=new R;return I.effectAsset=E,I.techniqueIndex=D,I}},setProperty:function(E,D,I,M){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){if(typeof I=="string"&&(I=parseInt(I)),D instanceof w){var N=D.isAlphaAtlas(),k="CC_USE_ALPHA_ATLAS_"+E,F=this.getDefine(k,I);(N||F)&&this.define(k,N),D.loaded||cc.assetManager.postLoadNative(D)}this._effect.setProperty(E,D,I,M)}},getProperty:function(E,D){return typeof D=="string"&&(D=parseInt(D)),this._effect.getProperty(E,D)},define:function(E,D,I,M){cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS&&(typeof I=="string"&&(I=parseInt(I)),this._effect.define(E,D,I,M))},getDefine:function(E,D){return typeof D=="string"&&(D=parseInt(D)),this._effect.getDefine(E,D)},setCullMode:function(E,D){E===void 0&&(E=A.CULL_BACK),this._effect.setCullMode(E,D)},setDepth:function(E,D,I,M){E===void 0&&(E=!1),D===void 0&&(D=!1),I===void 0&&(I=A.DS_FUNC_LESS),this._effect.setDepth(E,D,I,M)},setBlend:function(E,D,I,M,N,k,F,G,V){E===void 0&&(E=!1),D===void 0&&(D=A.BLEND_FUNC_ADD),I===void 0&&(I=A.BLEND_SRC_ALPHA),M===void 0&&(M=A.BLEND_ONE_MINUS_SRC_ALPHA),N===void 0&&(N=A.BLEND_FUNC_ADD),k===void 0&&(k=A.BLEND_SRC_ALPHA),F===void 0&&(F=A.BLEND_ONE_MINUS_SRC_ALPHA),G===void 0&&(G=4294967295),this._effect.setBlend(E,D,I,M,N,k,F,G,V)},setStencilEnabled:function(E,D){E===void 0&&(E=A.STENCIL_INHERIT),this._effect.setStencilEnabled(E,D)},setStencil:function(E,D,I,M,N,k,F,G,V){E===void 0&&(E=A.STENCIL_INHERIT),D===void 0&&(D=A.DS_FUNC_ALWAYS),I===void 0&&(I=0),M===void 0&&(M=255),N===void 0&&(N=A.STENCIL_OP_KEEP),k===void 0&&(k=A.STENCIL_OP_KEEP),F===void 0&&(F=A.STENCIL_OP_KEEP),G===void 0&&(G=255),this._effect.setStencil(E,D,I,M,N,k,F,G,V)},updateHash:function(E){this._manualHash=E,this._effect&&this._effect.updateHash(E)},getHash:function(){return this._manualHash||this._effect&&this._effect.getHash()},onLoad:function(){if(this.effectAsset=this._effectAsset,this._effect){this._techniqueIndex&&this._effect.switchTechnique(this._techniqueIndex),this._techniqueData=this._techniqueData||{};var E=this._techniqueData;for(var D in E){var I=E[D=parseInt(D)];if(I){for(var M in I.defines)this.define(M,I.defines[M],D);for(var N in I.props)this.setProperty(N,I.props[N],D)}}}}}),P=R;T.default=P,cc.Material=R,S.exports=T.default},{"../../utils/texture-util":279,"../CCAsset":62,"../CCTexture2D":77,"./CCEffectAsset":80}],82:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=B(L("../../../renderer/core/pass")),w=B(L("../../../renderer/enums"));function B(P){return P&&P.__esModule?P:{default:P}}function A(P,E){for(var D=0;D<E.length;D++){var I=E[D];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(P,I.key,I)}}var O=cc.gfx,R=function(){function P(){this._dirty=!0,this._name="",this._technique=null}var E,D,I=P.prototype;return I._createPassProp=function(M,N){var k=N._properties[M];if(k){var F=Object.create(null);return F.name=M,F.type=k.type,k.value instanceof Float32Array?F.value=new Float32Array(k.value):k.value instanceof Float64Array?F.value=new Float64Array(k.value):F.value=k.value,N._properties[M]=F,F}},I._setPassProperty=function(M,N,k,F){var G=k._properties;G.hasOwnProperty(M)||this._createPassProp(M,k);var V=G[M],j=N;return V.type===w.default.PARAM_TEXTURE_2D&&(j=N&&N.getImpl()),V.value===j||(this._dirty=!0,_.default.prototype.setProperty.call(k,M,N,F))},I.setProperty=function(M,N,k,F){var G=!1,V=this.passes,j=0,H=V.length;k!==void 0&&(j=k,H=k+1);for(var U=j;U<H;U++)this._setPassProperty(M,N,V[U],F)&&(G=!0);G||cc.warnID(9103,this.name,M)},I.getProperty=function(M,N){var k=this.passes;if(!(N>=k.length)){var F=0,G=k.length;N!==void 0&&(F=N,G=N+1);for(var V=F;V<G;V++){var j=k[V].getProperty(M);if(j!==void 0)return j}}},I.define=function(M,N,k,F){var G=!1,V=this.passes,j=0,H=V.length;k!==void 0&&(j=k,H=k+1);for(var U=j;U<H;U++)V[U].define(M,N,F)&&(G=!0);G||cc.warnID(9104,this.name,M)},I.getDefine=function(M,N){var k=this.passes;if(!(N>=k.length)){var F=0,G=k.length;N!==void 0&&(F=N,G=N+1);for(var V=F;V<G;V++){var j=k[V].getDefine(M);if(j!==void 0)return j}}},I.setCullMode=function(M,N){M===void 0&&(M=O.CULL_BACK);var k=this.passes,F=0,G=k.length;N!==void 0&&(F=N,G=N+1);for(var V=F;V<G;V++)k[V].setCullMode(M);this._dirty=!0},I.setDepth=function(M,N,k,F){var G=this.passes,V=0,j=G.length;F!==void 0&&(V=F,j=F+1);for(var H=V;H<j;H++)G[H].setDepth(M,N,k);this._dirty=!0},I.setBlend=function(M,N,k,F,G,V,j,H,U){var X=this.passes,Y=0,z=X.length;U!==void 0&&(Y=U,z=U+1);for(var W=Y;W<z;W++)X[W].setBlend(M,N,k,F,G,V,j,H);this._dirty=!0},I.setStencilEnabled=function(M,N){M===void 0&&(M=O.STENCIL_INHERIT);var k=this.passes,F=0,G=k.length;N!==void 0&&(F=N,G=N+1);for(var V=F;V<G;V++)k[V].setStencilEnabled(M);this._dirty=!0},I.setStencil=function(M,N,k,F,G,V,j,H,U){var X=this.passes,Y=0,z=X.length;U!==void 0&&(Y=U,z=U+1);for(var W=Y;W<z;W++){var Z=X[W];Z.setStencilFront(M,N,k,F,G,V,j,H),Z.setStencilBack(M,N,k,F,G,V,j,H)}this._dirty=!0},E=P,(D=[{key:"name",get:function(){return this._name}},{key:"technique",get:function(){return this._technique}},{key:"passes",get:function(){return[]}}])&&A(E.prototype,D),Object.defineProperty(E,"prototype",{writable:!1}),P}();T.default=R,cc.EffectBase=R,S.exports=T.default},{"../../../renderer/core/pass":310,"../../../renderer/enums":314}],83:[function(L,S,T){T.__esModule=!0,T.parseEffect=function(M){var N=I(M);return new A.default(M.name,N,0,M)};var _=R(L("../../../renderer/core/pass")),w=L("../../../renderer/types"),B=R(L("../../../renderer/enums")),A=R(L("./effect")),O=R(L("../../../renderer/core/technique"));function R(M){return M&&M.__esModule?M:{default:M}}function P(M){return cc.renderer._forward._programLib.getTemplate(M)}function E(M,N){var k=N.properties||{},F=P(N.program),G=function(H){if(!F.uniforms.find(function(U){return U.name===H}))return cc.warnID(9107,M.name,H),"continue"};for(var V in k)G(V);var j={};return F.uniforms.forEach(function(H){var U,X=H.name,Y=j[X]=Object.assign({},H),z=k[X];(U=z?z.type===B.default.PARAM_TEXTURE_2D?null:z.type===B.default.PARAM_INT||z.type===B.default.PARAM_FLOAT?Array.isArray(z.value)?z.value[0]:z.value:new Float32Array(z.value):w.enums2default[H.type])===void 0&&(U=null),Y.value=U}),j}function D(M){var N={};return P(M.program).defines.forEach(function(k){N[k.name]=w.enums2default[k.type]}),N}function I(M){for(var N=M.techniques.length,k=new Array(N),F=0;F<N;++F){for(var G=M.techniques[F],V=G.name||F,j=G.passes.length,H=new Array(j),U=0;U<j;++U){var X=G.passes[U],Y=X.name||U,z=M.name+"-"+V+"-"+Y,W=X.stage||"opaque",Z=E(M,X),Q=D(X),ee=H[U]=new _.default(Y,z,X.program,W,Z,Q);X.rasterizerState&&ee.setCullMode(X.rasterizerState.cullMode);var te=X.blendState&&X.blendState.targets[0];te&&ee.setBlend(te.blend,te.blendEq,te.blendSrc,te.blendDst,te.blendAlphaEq,te.blendSrcAlpha,te.blendDstAlpha,te.blendColor);var re=X.depthStencilState;re&&(ee.setDepth(re.depthTest,re.depthWrite,re.depthFunc),ee.setStencilFront(re.stencilTest,re.stencilFuncFront,re.stencilRefFront,re.stencilMaskFront,re.stencilFailOpFront,re.stencilZFailOpFront,re.stencilZPassOpFront,re.stencilWriteMaskFront),ee.setStencilBack(re.stencilTest,re.stencilFuncBack,re.stencilRefBack,re.stencilMaskBack,re.stencilFailOpBack,re.stencilZFailOpBack,re.stencilZPassOpBack,re.stencilWriteMaskBack))}k[F]=new O.default(V,H)}return k}},{"../../../renderer/core/pass":310,"../../../renderer/core/technique":312,"../../../renderer/enums":314,"../../../renderer/types":342,"./effect":85}],84:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=A(L("../../../renderer/murmurhash2_gc")),w=A(L("./utils")),B=A(L("./effect-base"));function A(E){return E&&E.__esModule?E:{default:E}}function O(E,D){for(var I=0;I<D.length;I++){var M=D[I];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(E,M.key,M)}}function R(E,D){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(I,M){return I.__proto__=M,I})(E,D)}cc.gfx;var P=function(E){var D,I;function M(G){var V;return(V=E.call(this)||this)._effect=void 0,V._passes=[],V._stagePasses={},V._hash=0,V.init(G),V}I=E,(D=M).prototype=Object.create(I.prototype),D.prototype.constructor=D,R(D,I);var N,k,F=M.prototype;return F._onEffectChanged=function(){},F.init=function(G){if(G instanceof M&&(G=G.effect),this._effect=G,this._dirty=!0,G){var V=G.passes,j=this._passes;j.length=0;for(var H=this._stagePasses={},U=0;U<V.length;U++){var X=j[U]=Object.setPrototypeOf({},V[U]);X._properties=Object.setPrototypeOf({},V[U]._properties),X._defines=Object.setPrototypeOf({},V[U]._defines),H[X._stage]||(H[X._stage]=[]),H[X._stage].push(X)}}},F.updateHash=function(){},F.getHash=function(){if(!this._dirty)return this._hash;this._dirty=!1;var G="";G+=w.default.serializePasses(this._passes);var V=this._effect;return V&&(G+=w.default.serializePasses(V.passes)),this._hash=(0,_.default)(G,666),this.updateHash(this._hash),this._hash},N=M,(k=[{key:"effect",get:function(){return this._effect}},{key:"name",get:function(){return this._effect&&this._effect.name+" (variant)"}},{key:"passes",get:function(){return this._passes}},{key:"stagePasses",get:function(){return this._stagePasses}}])&&O(N.prototype,k),Object.defineProperty(N,"prototype",{writable:!1}),M}(B.default);T.default=P,cc.EffectVariant=P,S.exports=T.default},{"../../../renderer/murmurhash2_gc":337,"./effect-base":82,"./utils":89}],85:[function(L,S,T){var _;function w(O,R){for(var P=0;P<R.length;P++){var E=R[P];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(O,E.key,E)}}function B(O,R){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(P,E){return P.__proto__=E,P})(O,R)}T.__esModule=!0,T.default=void 0;var A=function(O){var R,P;function E(N,k,F,G){var V;return(V=O.call(this)||this)._techniques=[],V._asset=null,V.init(N,k,F,G,!0),V}P=O,(R=E).prototype=Object.create(P.prototype),R.prototype.constructor=R,B(R,P);var D,I,M=E.prototype;return M.init=function(N,k,F,G){this._name=N,this._techniques=k,this._technique=k[F],this._asset=G},M.switchTechnique=function(N){N>=this._techniques.length?cc.warn("Can not switch to technique with index ["+N+"]"):this._technique=this._techniques[N]},M.clear=function(){this._techniques=[]},M.clone=function(){for(var N=[],k=0;k<this._techniques.length;k++)N.push(this._techniques[k].clone());var F=this._techniques.indexOf(this._technique);return new E(this._name,N,F,this._asset)},D=E,(I=[{key:"technique",get:function(){return this._technique}},{key:"passes",get:function(){return this._technique.passes}}])&&w(D.prototype,I),Object.defineProperty(D,"prototype",{writable:!1}),E}(((_=L("./effect-base"))&&_.__esModule?_:{default:_}).default);T.default=A,cc.Effect=A,S.exports=T.default},{"./effect-base":82}],86:[function(L){L("./CCEffectAsset"),L("./CCMaterial"),L("./material-variant")},{"./CCEffectAsset":80,"./CCMaterial":81,"./material-variant":88}],87:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=B(L("./utils")),w=B(L("../../utils/pool"));function B(P){return P&&P.__esModule?P:{default:P}}function A(P,E){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,I){return D.__proto__=I,D})(P,E)}var O=new(function(P){var E,D;function I(){for(var N,k=arguments.length,F=new Array(k),G=0;G<k;G++)F[G]=arguments[G];return(N=P.call.apply(P,[this].concat(F))||this).enabled=!1,N._pool={},N}D=P,(E=I).prototype=Object.create(D.prototype),E.prototype.constructor=E,A(E,D);var M=I.prototype;return M.get=function(N,k){var F,G=this._pool;if(N instanceof cc.MaterialVariant){if(!N._owner)return N._owner=k,N;if(N._owner===k)return N;N=N.material}if(this.enabled){var V=N.effectAsset._uuid;if(G[V]){var j=_.default.serializeDefines(N._effect._defines)+_.default.serializeTechniques(N._effect._techniques);F=G[V][j]&&G[V][j].pop()}}return F?this.count--:((F=new cc.MaterialVariant(N))._name=N._name+" (Instance)",F._uuid=N._uuid),F._owner=k,F},M.put=function(N){if(this.enabled&&N._owner){var k=this._pool,F=N.effectAsset._uuid;k[F]||(k[F]={});var G=_.default.serializeDefines(N._effect._defines)+_.default.serializeTechniques(N._effect._techniques);k[F][G]||(k[F][G]=[]),this.count>this.maxSize||(this._clean(N),k[F][G].push(N),this.count++)}},M.clear=function(){this._pool={},this.count=0},M._clean=function(N){N._owner=null},I}(w.default));w.default.register("material",O);var R=O;T.default=R,S.exports=T.default},{"../../utils/pool":273,"./utils":89}],88:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=O(L("./CCMaterial")),B=O(L("./effect-variant")),A=O(L("./material-pool"));function O(D){return D&&D.__esModule?D:{default:D}}function R(D,I){for(var M=0;M<I.length;M++){var N=I[M];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(D,N.key,N)}}function P(D,I){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,N){return M.__proto__=N,M})(D,I)}var E=(0,cc._decorator.ccclass)("cc.MaterialVariant")(_=function(D){var I,M,N,k;function F(G){var V;return(V=D.call(this)||this)._owner=null,V._material=null,V.init(G),V}return M=D,(I=F).prototype=Object.create(M.prototype),I.prototype.constructor=I,P(I,M),F.createWithBuiltin=function(G,V){return F.create(w.default.getBuiltinMaterial(G),V)},F.create=function(G,V){return G?A.default.get(G,V):null},F.prototype.init=function(G){this._effect=new B.default(G.effect),this._effectAsset=G._effectAsset,this._material=G},N=F,(k=[{key:"uuid",get:function(){return this._material._uuid}},{key:"owner",get:function(){return this._owner}},{key:"material",get:function(){return this._material}}])&&R(N.prototype,k),Object.defineProperty(N,"prototype",{writable:!1}),F}(w.default))||_;T.default=E,cc.MaterialVariant=E,S.exports=T.default},{"./CCMaterial":81,"./effect-variant":84,"./material-pool":87}],89:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../../renderer/enums"))&&_.__esModule?_:{default:_},B=[];function A(P,E){for(var D=E.length,I=0;I<D;I++){var M=E[I];B[I]=M+P[M]}return B.length=D,B.join("")}function O(P,E){for(var D=0,I=0,M=E.length;I<M;I++){var N=P[E[I]],k=N.value;k&&(N.type===w.default.PARAM_TEXTURE_2D||N.type===w.default.PARAM_TEXTURE_CUBE?B[D]=k._id:B[D]=k.toString(),D++)}return B.length=D,B.join(";")}var R={serializeDefines:A,serializePasses:function(P){for(var E,D,I="",M=0;M<P.length;M++)I+=(D=void 0,D=(E=P[M])._programName+E._cullMode,E._blend&&(D+=E._blendEq+E._blendAlphaEq+E._blendSrc+E._blendDst+E._blendSrcAlpha+E._blendDstAlpha+E._blendColor),E._depthTest&&(D+=E._depthWrite+E._depthFunc),E._stencilTest&&(D+=E._stencilFuncFront+E._stencilRefFront+E._stencilMaskFront+E._stencilFailOpFront+E._stencilZFailOpFront+E._stencilZPassOpFront+E._stencilWriteMaskFront+E._stencilFuncBack+E._stencilRefBack+E._stencilMaskBack+E._stencilFailOpBack+E._stencilZFailOpBack+E._stencilZPassOpBack+E._stencilWriteMaskBack),D+=O(E._properties,E._propertyNames),D+=A(E._defines,E._defineNames));return I},serializeUniforms:O};T.default=R,S.exports=T.default},{"../../../renderer/enums":314}],90:[function(L,S){L("../CCNode").EventType;var T=56,_=7,w=cc.Enum({ONCE:0,ON_WINDOW_RESIZE:1,ALWAYS:2});function B(M,N,k,F){for(var G=M._parent.scaleX,V=M._parent.scaleY,j=0,H=0,U=M._parent;;){if(j+=U.x,H+=U.y,!(U=U._parent))return k.x=k.y=0,void(F.x=F.y=1);if(U===N)break;var X=U.scaleX,Y=U.scaleY;j*=X,H*=Y,G*=X,V*=Y}F.x=G!==0?1/G:1,F.y=V!==0?1/V:1,k.x=-j,k.y=-H}var A=cc.Vec2.ZERO,O=cc.Vec2.ONE;function R(M,N){var k,F,G,V=N._target;V?B(M,k=V,F=A,G=O):k=M._parent;var j,H=(j=k)instanceof cc.Scene?cc.visibleRect:j._contentSize,U=k._anchorPoint,X=k instanceof cc.Scene,Y=M.x,z=M.y,W=M._anchorPoint;if(N._alignFlags&T){var Z,Q,ee=H.width;X?(Z=cc.visibleRect.left.x,Q=cc.visibleRect.right.x):Q=(Z=-U.x*ee)+ee,Z+=N._isAbsLeft?N._left:N._left*ee,Q-=N._isAbsRight?N._right:N._right*ee,V&&(Z+=F.x,Z*=G.x,Q+=F.x,Q*=G.x);var te,re=W.x,ie=M.scaleX;if(ie<0&&(re=1-re,ie=-ie),N.isStretchWidth)te=Q-Z,ie!==0&&(M.width=te/ie),Y=Z+re*te;else if(te=M.width*ie,N.isAlignHorizontalCenter){var ne=N._isAbsHorizontalCenter?N._horizontalCenter:N._horizontalCenter*ee,he=(.5-U.x)*H.width;V&&(ne*=G.x,he+=F.x,he*=G.x),Y=he+(re-.5)*te+ne}else Y=N.isAlignLeft?Z+re*te:Q+(re-1)*te}if(N._alignFlags&_){var pe,K,ue=H.height;X?(K=cc.visibleRect.bottom.y,pe=cc.visibleRect.top.y):pe=(K=-U.y*ue)+ue,K+=N._isAbsBottom?N._bottom:N._bottom*ue,pe-=N._isAbsTop?N._top:N._top*ue,V&&(K+=F.y,K*=G.y,pe+=F.y,pe*=G.y);var le,ce=W.y,_e=M.scaleY;if(_e<0&&(ce=1-ce,_e=-_e),N.isStretchHeight)le=pe-K,_e!==0&&(M.height=le/_e),z=K+ce*le;else if(le=M.height*_e,N.isAlignVerticalCenter){var oe=N._isAbsVerticalCenter?N._verticalCenter:N._verticalCenter*ue,de=(.5-U.y)*H.height;V&&(oe*=G.y,de+=F.y,de*=G.y),z=de+(ce-.5)*le+oe}else z=N.isAlignBottom?K+ce*le:pe+(ce-1)*le}M.setPosition(Y,z)}function P(M){var N=M._widget;N&&(R(M,N),N.alignMode!==w.ALWAYS?I.remove(N):D.push(N));for(var k=M._children,F=0;F<k.length;F++){var G=k[F];G._active&&P(G)}}function E(){var M=cc.director.getScene();if(M){if(I.isAligning=!0,I._nodesOrderDirty)D.length=0,P(M),I._nodesOrderDirty=!1;else{var N,k=I._activeWidgetsIterator;for(k.i=0;k.i<D.length;++k.i)R((N=D[k.i]).node,N)}I.isAligning=!1}}var D=[],I=cc._widgetManager=S.exports={_AlignFlags:{TOP:1,MID:2,BOT:4,LEFT:8,CENTER:16,RIGHT:32},isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new cc.js.array.MutableForwardIterator(D),init:function(M){M.on(cc.Director.EVENT_AFTER_UPDATE,E);var N=this.onResized.bind(this);cc.view.on("canvas-resize",N),window.addEventListener("orientationchange",N)},add:function(M){M.node._widget=M,this._nodesOrderDirty=!0},remove:function(M){M.node._widget=null,this._activeWidgetsIterator.remove(M)},onResized:function(){var M=cc.director.getScene();M&&this.refreshWidgetOnResized(M)},refreshWidgetOnResized:function(M){var N=cc.Node.isNode(M)&&M.getComponent(cc.Widget);N&&N.enabled&&N.alignMode===w.ON_WINDOW_RESIZE&&this.add(N);for(var k=M._children,F=0;F<k.length;F++){var G=k[F];this.refreshWidgetOnResized(G)}},updateAlignment:function M(N){var k=N._parent;cc.Node.isNode(k)&&M(k);var F=N._widget||N.getComponent(cc.Widget);F&&k&&R(N,F)},AlignMode:w}},{"../CCNode":29}],91:[function(L,S){var T=L("../value-types"),_=L("../geom-utils"),w=L("../utils/affine-transform"),B=L("../renderer/index"),A=L("../renderer/render-flow"),O=L("../CCGame"),R=null;R=L("../../renderer/scene/camera");var P=cc.mat4(),E=cc.mat4(),D=cc.v3(),I=cc.v3(),M=cc.v3(),N=[];function k(){for(var U=0,X=Number.MAX_VALUE;U<N.length;U++){var Y=N[U];Y._depth<X&&(H.main=Y,X=Y._depth)}}var F=null;function G(){if(F){var U=F.getNode(),X=cc.game.canvas;U.z=X.height/1.1566,U.x=X.width/2,U.y=X.height/2}}var V=cc.Enum({COLOR:1,DEPTH:2,STENCIL:4}),j=cc.Enum({OPAQUE:1,TRANSPARENT:2}),H=cc.Class({name:"cc.Camera",extends:cc.Component,ctor:function(){if(O.renderType!==O.RENDER_TYPE_CANVAS){var U=new R;U.setStages(["opaque"]),U.dirty=!0,this._inited=!1,this._camera=U}else this._inited=!0},editor:!1,properties:{_cullingMask:4294967295,_clearFlags:V.DEPTH|V.STENCIL,_backgroundColor:cc.color(0,0,0,255),_depth:0,_zoomRatio:1,_targetTexture:null,_fov:60,_orthoSize:10,_nearClip:1,_farClip:4096,_ortho:!0,_rect:cc.rect(0,0,1,1),_renderStages:1,_alignWithScreen:!0,zoomRatio:{get:function(){return this._zoomRatio},set:function(U){this._zoomRatio=U},tooltip:!1},fov:{get:function(){return this._fov},set:function(U){this._fov=U},tooltip:!1},orthoSize:{get:function(){return this._orthoSize},set:function(U){this._orthoSize=U},tooltip:!1},nearClip:{get:function(){return this._nearClip},set:function(U){this._nearClip=U,this._updateClippingpPlanes()},tooltip:!1},farClip:{get:function(){return this._farClip},set:function(U){this._farClip=U,this._updateClippingpPlanes()},tooltip:!1},ortho:{get:function(){return this._ortho},set:function(U){this._ortho=U,this._updateProjection()},tooltip:!1},rect:{get:function(){return this._rect},set:function(U){this._rect=U,this._updateRect()},tooltip:!1},cullingMask:{get:function(){return this._cullingMask},set:function(U){this._cullingMask=U,this._updateCameraMask()},tooltip:!1},clearFlags:{get:function(){return this._clearFlags},set:function(U){this._clearFlags=U,this._camera&&this._camera.setClearFlags(U)},tooltip:!1},backgroundColor:{get:function(){return this._backgroundColor},set:function(U){this._backgroundColor.equals(U)||(this._backgroundColor.set(U),this._updateBackgroundColor())},tooltip:!1},depth:{get:function(){return this._depth},set:function(U){H.main===this?this._depth<U&&k():H.main&&U<H.main._depth&&N.includes(this)&&(H.main=this),this._depth=U,this._camera&&this._camera.setPriority(U)},tooltip:!1},targetTexture:{get:function(){return this._targetTexture},set:function(U){this._targetTexture=U,this._updateTargetTexture()},tooltip:!1},renderStages:{get:function(){return this._renderStages},set:function(U){this._renderStages=U,this._updateStages()},tooltip:!1},alignWithScreen:{get:function(){return this._alignWithScreen},set:function(U){this._alignWithScreen=U}},_is3D:{get:function(){return this.node&&this.node._is3DNode}}},statics:{main:null,cameras:N,ClearFlags:V,findCamera:function(U){for(var X=0,Y=N.length;X<Y;X++){var z=N[X];if(z.containsNode(U))return z}return null},_findRendererCamera:function(U){for(var X=B.scene._cameras,Y=0;Y<X._count;Y++)if(X._data[Y]._cullingMask&U._cullingMask)return X._data[Y];return null},_setupDebugCamera:function(){if(!F&&O.renderType!==O.RENDER_TYPE_CANVAS){var U=new R;F=U,U.setStages(["opaque"]),U.setFov(60*Math.PI/180),U.setNear(.1),U.setFar(4096),U.dirty=!0,U.cullingMask=1<<cc.Node.BuiltinGroupIndex.DEBUG,U.setPriority(cc.macro.MAX_ZINDEX),U.setClearFlags(0),U.setColor(0,0,0,0);var X=new cc.Node;U.setNode(X),G(),cc.view.on("design-resolution-changed",G),B.scene.addCamera(U)}}},_updateCameraMask:function(){if(this._camera){var U=this._cullingMask&~(1<<cc.Node.BuiltinGroupIndex.DEBUG);this._camera.cullingMask=U}},_updateBackgroundColor:function(){if(this._camera){var U=this._backgroundColor;this._camera.setColor(U.r/255,U.g/255,U.b/255,U.a/255)}},_updateTargetTexture:function(){if(this._camera){var U=this._targetTexture;this._camera.setFrameBuffer(U?U._framebuffer:null)}},_updateClippingpPlanes:function(){this._camera&&(this._camera.setNear(this._nearClip),this._camera.setFar(this._farClip))},_updateProjection:function(){if(this._camera){var U=this._ortho?1:0;this._camera.setType(U)}},_updateRect:function(){if(this._camera){var U=this._rect;this._camera.setRect(U.x,U.y,U.width,U.height)}},_updateStages:function(){var U=this._renderStages,X=[];U&j.OPAQUE&&X.push("opaque"),U&j.TRANSPARENT&&X.push("transparent"),this._camera.setStages(X)},_init:function(){if(!this._inited){this._inited=!0;var U=this._camera;U&&(U.setNode(this.node),U.setClearFlags(this._clearFlags),U.setPriority(this._depth),this._updateBackgroundColor(),this._updateCameraMask(),this._updateTargetTexture(),this._updateClippingpPlanes(),this._updateProjection(),this._updateStages(),this._updateRect(),this.beforeDraw())}},__preload:function(){this._init()},onEnable:function(){O.renderType!==O.RENDER_TYPE_CANVAS&&(cc.director.on(cc.Director.EVENT_BEFORE_DRAW,this.beforeDraw,this),B.scene.addCamera(this._camera)),N.push(this),(!H.main||this._depth<H.main._depth)&&(H.main=this)},onDisable:function(){O.renderType!==O.RENDER_TYPE_CANVAS&&(cc.director.off(cc.Director.EVENT_BEFORE_DRAW,this.beforeDraw,this),B.scene.removeCamera(this._camera)),cc.js.array.fastRemove(N,this),H.main===this&&(H.main=null,k())},getScreenToWorldMatrix2D:function(U){return this.getWorldToScreenMatrix2D(U),T.Mat4.invert(U,U),U},getWorldToScreenMatrix2D:function(U){this.node.getWorldRT(P);var X=this.zoomRatio,Y=P.m;Y[0]*=X,Y[1]*=X,Y[4]*=X,Y[5]*=X;var z=Y[12],W=Y[13],Z=cc.visibleRect.center;return Y[12]=Z.x-(Y[0]*z+Y[4]*W),Y[13]=Z.y-(Y[1]*z+Y[5]*W),U!==P&&T.Mat4.copy(U,P),U},getScreenToWorldPoint:function(U,X){return this.node.is3DNode?(X=X||new cc.Vec3,this._camera.screenToWorld(X,U,cc.visibleRect.width,cc.visibleRect.height)):(X=X||new cc.Vec2,this.getScreenToWorldMatrix2D(P),T.Vec2.transformMat4(X,U,P)),X},getWorldToScreenPoint:function(U,X){return this.node.is3DNode?(X=X||new cc.Vec3,this._camera.worldToScreen(X,U,cc.visibleRect.width,cc.visibleRect.height)):(X=X||new cc.Vec2,this.getWorldToScreenMatrix2D(P),T.Vec2.transformMat4(X,U,P)),X},getRay:function(U){return cc.geomUtils?(T.Vec3.set(M,U.x,U.y,1),this._camera.screenToWorld(I,M,cc.visibleRect.width,cc.visibleRect.height),this.ortho?(T.Vec3.set(M,U.x,U.y,-1),this._camera.screenToWorld(D,M,cc.visibleRect.width,cc.visibleRect.height)):this.node.getWorldPosition(D),_.Ray.fromPoints(new _.Ray,D,I)):U},containsNode:function(U){return(U._cullingMask&this.cullingMask)>0},render:function(U){if(!(U=U||cc.director.getScene()))return null;this.node.getWorldMatrix(P),this.beforeDraw(),A.renderCamera(this._camera,U)},_onAlignWithScreen:function(){var U=cc.game.canvas.height/cc.view._scaleY;this._targetTexture&&(U=cc.visibleRect.height);var X=this._fov*cc.macro.RAD;this.node.z=U/(2*Math.tan(X/2)),X=2*Math.atan(Math.tan(X/2)/this.zoomRatio),this._camera.setFov(X),this._camera.setOrthoHeight(U/2/this.zoomRatio),this.node.setRotation(0,0,0,1)},beforeDraw:function(){if(this._camera){if(this._alignWithScreen)this._onAlignWithScreen();else{var U=this._fov*cc.macro.RAD;U=2*Math.atan(Math.tan(U/2)/this.zoomRatio),this._camera.setFov(U),this._camera.setOrthoHeight(this._orthoSize/this.zoomRatio)}this._camera.dirty=!0}}});cc.js.mixin(H.prototype,{getNodeToCameraTransform:function(U){var X=w.identity();return U.getWorldMatrix(E),this.containsNode(U)&&(this.getWorldToCameraMatrix(P),T.Mat4.mul(E,E,P)),w.fromMat4(X,E),X},getCameraToWorldPoint:function(U,X){return this.getScreenToWorldPoint(U,X)},getWorldToCameraPoint:function(U,X){return this.getWorldToScreenPoint(U,X)},getCameraToWorldMatrix:function(U){return this.getScreenToWorldMatrix2D(U)},getWorldToCameraMatrix:function(U){return this.getWorldToScreenMatrix2D(U)}}),S.exports=cc.Camera=H},{"../../renderer/scene/camera":339,"../CCGame":28,"../geom-utils":151,"../renderer/index":227,"../renderer/render-flow":228,"../utils/affine-transform":262,"../value-types":286}],92:[function(L,S){cc.Collider.Box=cc.Class({properties:{_offset:cc.v2(0,0),_size:cc.size(100,100),offset:{tooltip:!1,get:function(){return this._offset},set:function(_){this._offset=_},type:cc.Vec2},size:{tooltip:!1,get:function(){return this._size},set:function(_){this._size.width=_.width<0?0:_.width,this._size.height=_.height<0?0:_.height},type:cc.Size}},resetInEditor:!1});var T=cc.Class({name:"cc.BoxCollider",extends:cc.Collider,mixins:[cc.Collider.Box],editor:!1});cc.BoxCollider=S.exports=T},{}],93:[function(L,S){cc.Collider.Circle=cc.Class({properties:{_offset:cc.v2(0,0),_radius:50,offset:{tooltip:!1,get:function(){return this._offset},set:function(_){this._offset=_},type:cc.Vec2},radius:{tooltip:!1,get:function(){return this._radius},set:function(_){this._radius=_<0?0:_}}},resetInEditor:!1});var T=cc.Class({name:"cc.CircleCollider",extends:cc.Collider,mixins:[cc.Collider.Circle],editor:!1});cc.CircleCollider=S.exports=T},{}],94:[function(L,S){var T=cc.Class({name:"cc.Collider",extends:cc.Component,properties:{editing:{default:!1,serializable:!1,tooltip:!1},tag:{tooltip:!1,default:0,range:[0,1e7],type:cc.Integer}},onDisable:function(){cc.director.getCollisionManager().removeCollider(this)},onEnable:function(){cc.director.getCollisionManager().addCollider(this)}});cc.Collider=S.exports=T},{}],95:[function(L,S){var T,_=(T=L("../value-types/vec2"))&&T.__esModule?T:{default:T},w=L("./CCContact"),B=w.CollisionType,A=L("../CCNode").EventType,O=new _.default;function R(E,D,I,M,N,k){var F=E.x,G=E.y,V=E.width,j=E.height,H=D.m,U=H[0],X=H[1],Y=H[4],z=H[5],W=U*F+Y*G+H[12],Z=X*F+z*G+H[13],Q=U*V,ee=X*V,te=Y*j,re=z*j;M.x=W,M.y=Z,N.x=Q+W,N.y=ee+Z,I.x=te+W,I.y=re+Z,k.x=Q+te+W,k.y=ee+re+Z}var P=cc.Class({mixins:[cc.EventTarget],properties:{enabled:!1,enabledDrawBoundingBox:!1},ctor:function(){this._contacts=[],this._colliders=[],this._debugDrawer=null,this._enabledDebugDraw=!1,cc.director._scheduler&&cc.director._scheduler.enableForTarget(this)},update:function(){if(this.enabled){var E,D,I=this._colliders;for(E=0,D=I.length;E<D;E++)this.updateCollider(I[E]);var M=this._contacts,N=[];for(E=0,D=M.length;E<D;E++){var k=M[E].updateState();k!==B.None&&N.push([k,M[E]])}for(E=0,D=N.length;E<D;E++){var F=N[E];this._doCollide(F[0],F[1])}this.drawColliders()}},_doCollide:function(E,D){var I;switch(E){case B.CollisionEnter:I="onCollisionEnter";break;case B.CollisionStay:I="onCollisionStay";break;case B.CollisionExit:I="onCollisionExit"}var M,N,k,F=D.collider1,G=D.collider2,V=F.node._components,j=G.node._components;for(M=0,N=V.length;M<N;M++)(k=V[M])[I]&&k[I](G,F);for(M=0,N=j.length;M<N;M++)(k=j[M])[I]&&k[I](F,G)},shouldCollide:function(E,D){var I=E.node,M=D.node,N=cc.game.collisionMatrix;return I!==M&&N[I.groupIndex][M.groupIndex]},initCollider:function(E){if(!E.world){var D=E.world={};D.aabb=cc.rect(),D.preAabb=cc.rect(),D.matrix=cc.mat4(),D.radius=0,E instanceof cc.BoxCollider?(D.position=null,D.points=[cc.v2(),cc.v2(),cc.v2(),cc.v2()]):E instanceof cc.PolygonCollider?(D.position=null,D.points=E.points.map(function(I){return cc.v2(I.x,I.y)})):E instanceof cc.CircleCollider&&(D.position=cc.v2(),D.points=null)}},updateCollider:function(E){var D=E.offset,I=E.world,M=I.aabb,N=I.matrix;E.node.getWorldMatrix(N);var k=I.preAabb;if(k.x=M.x,k.y=M.y,k.width=M.width,k.height=M.height,E instanceof cc.BoxCollider){var F=E.size;M.x=D.x-F.width/2,M.y=D.y-F.height/2,M.width=F.width,M.height=F.height;var G=I.points,V=G[0],j=G[1],H=G[2],U=G[3];R(M,N,V,j,H,U);var X=Math.min(V.x,j.x,H.x,U.x),Y=Math.min(V.y,j.y,H.y,U.y),z=Math.max(V.x,j.x,H.x,U.x),W=Math.max(V.y,j.y,H.y,U.y);M.x=X,M.y=Y,M.width=z-X,M.height=W-Y}else if(E instanceof cc.CircleCollider){_.default.transformMat4(O,E.offset,N),I.position.x=O.x,I.position.y=O.y;var Z=N.m,Q=Z[12],ee=Z[13];Z[12]=Z[13]=0,O.x=E.radius,O.y=0,_.default.transformMat4(O,O,N);var te=Math.sqrt(O.x*O.x+O.y*O.y);I.radius=te,M.x=I.position.x-te,M.y=I.position.y-te,M.width=2*te,M.height=2*te,Z[12]=Q,Z[13]=ee}else if(E instanceof cc.PolygonCollider){var re=E.points,ie=I.points;ie.length=re.length;for(var ne=1e6,he=1e6,pe=-1e6,K=-1e6,ue=0,le=re.length;ue<le;ue++){ie[ue]||(ie[ue]=cc.v2()),O.x=re[ue].x+D.x,O.y=re[ue].y+D.y,_.default.transformMat4(O,O,N);var ce=O.x,_e=O.y;ie[ue].x=ce,ie[ue].y=_e,ce>pe&&(pe=ce),ce<ne&&(ne=ce),_e>K&&(K=_e),_e<he&&(he=_e)}M.x=ne,M.y=he,M.width=pe-ne,M.height=K-he}},addCollider:function(E){var D=this._colliders;if(D.indexOf(E)===-1){for(var I=0,M=D.length;I<M;I++){var N=D[I];if(this.shouldCollide(E,N)){var k=new w(E,N);this._contacts.push(k)}}D.push(E),this.initCollider(E)}E.node.on(A.GROUP_CHANGED,this.onNodeGroupChanged,this)},removeCollider:function(E){var D=this._colliders,I=D.indexOf(E);if(I>=0){D.splice(I,1);for(var M=this._contacts,N=M.length-1;N>=0;N--){var k=M[N];k.collider1!==E&&k.collider2!==E||(k.touching&&this._doCollide(B.CollisionExit,k),M.splice(N,1))}E.node.off(A.GROUP_CHANGED,this.onNodeGroupChanged,this)}else cc.errorID(6600)},onNodeGroupChanged:function(E){for(var D=E.getComponents(cc.Collider),I=0,M=D.length;I<M;I++){var N=D[I];cc.PhysicsCollider&&N instanceof cc.PhysicsCollider||(this.removeCollider(N),this.addCollider(N))}},drawColliders:function(){if(this._enabledDebugDraw){this._checkDebugDrawValid();var E=this._debugDrawer;E.clear();for(var D=this._colliders,I=0,M=D.length;I<M;I++){var N=D[I];if(E.strokeColor=cc.Color.WHITE,N instanceof cc.BoxCollider||N instanceof cc.PolygonCollider){var k=N.world.points;if(k.length>0){E.moveTo(k[0].x,k[0].y);for(var F=1;F<k.length;F++)E.lineTo(k[F].x,k[F].y);E.close(),E.stroke()}}else N instanceof cc.CircleCollider&&(E.circle(N.world.position.x,N.world.position.y,N.world.radius),E.stroke());if(this.enabledDrawBoundingBox){var G=N.world.aabb;E.strokeColor=cc.Color.BLUE,E.moveTo(G.xMin,G.yMin),E.lineTo(G.xMin,G.yMax),E.lineTo(G.xMax,G.yMax),E.lineTo(G.xMax,G.yMin),E.close(),E.stroke()}}}},_checkDebugDrawValid:function(){if(!this._debugDrawer||!this._debugDrawer.isValid){var E=new cc.Node("COLLISION_MANAGER_DEBUG_DRAW");E.zIndex=cc.macro.MAX_ZINDEX,cc.game.addPersistRootNode(E),this._debugDrawer=E.addComponent(cc.Graphics)}}});cc.js.getset(P.prototype,"enabledDebugDraw",function(){return this._enabledDebugDraw},function(E){E&&!this._enabledDebugDraw?(this._checkDebugDrawValid(),this._debugDrawer.node.active=!0):!E&&this._enabledDebugDraw&&(this._debugDrawer.clear(!0),this._debugDrawer.node.active=!1),this._enabledDebugDraw=E}),cc.CollisionManager=S.exports=P},{"../CCNode":29,"../value-types/vec2":295,"./CCContact":96}],96:[function(L,S){var T=L("./CCIntersection"),_=cc.Enum({None:0,CollisionEnter:1,CollisionStay:2,CollisionExit:3});function w(B,A){this.collider1=B,this.collider2=A,this.touching=!1;var O=B instanceof cc.BoxCollider||B instanceof cc.PolygonCollider,R=A instanceof cc.BoxCollider||A instanceof cc.PolygonCollider,P=B instanceof cc.CircleCollider,E=A instanceof cc.CircleCollider;O&&R?this.testFunc=T.polygonPolygon:P&&E?this.testFunc=T.circleCircle:O&&E?this.testFunc=T.polygonCircle:P&&R?(this.testFunc=T.polygonCircle,this.collider1=A,this.collider2=B):cc.errorID(6601,cc.js.getClassName(B),cc.js.getClassName(A))}w.prototype.test=function(){var B=this.collider1.world,A=this.collider2.world;return!!B.aabb.intersects(A.aabb)&&(this.testFunc===T.polygonPolygon?this.testFunc(B.points,A.points):this.testFunc===T.circleCircle?this.testFunc(B,A):this.testFunc===T.polygonCircle&&this.testFunc(B.points,A))},w.prototype.updateState=function(){var B=this.test(),A=_.None;return B&&!this.touching?(this.touching=!0,A=_.CollisionEnter):B&&this.touching?A=_.CollisionStay:!B&&this.touching&&(this.touching=!1,A=_.CollisionExit),A},w.CollisionType=_,S.exports=w},{"./CCIntersection":97}],97:[function(L,S){var T={};function _(O,R,P,E){var D=(E.x-P.x)*(O.y-P.y)-(E.y-P.y)*(O.x-P.x),I=(R.x-O.x)*(O.y-P.y)-(R.y-O.y)*(O.x-P.x),M=(E.y-P.y)*(R.x-O.x)-(E.x-P.x)*(R.y-O.y);if(M!==0){var N=D/M,k=I/M;if(0<=N&&N<=1&&0<=k&&k<=1)return!0}return!1}function w(O,R,P){for(var E=P.length,D=0;D<E;++D)if(_(O,R,P[D],P[(D+1)%E]))return!0;return!1}function B(O,R){for(var P=!1,E=O.x,D=O.y,I=R.length,M=0,N=I-1;M<I;N=M++){var k=R[M].x,F=R[M].y,G=R[N].x,V=R[N].y;F>D!=V>D&&E<(G-k)*(D-F)/(V-F)+k&&(P=!P)}return P}function A(O,R,P,E){var D,I=P.x-R.x,M=P.y-R.y,N=I*I+M*M,k=((O.x-R.x)*I+(O.y-R.y)*M)/N;return D=E?N?k<0?R:k>1?P:cc.v2(R.x+k*I,R.y+k*M):R:cc.v2(R.x+k*I,R.y+k*M),I=O.x-D.x,M=O.y-D.y,Math.sqrt(I*I+M*M)}T.lineLine=_,T.lineRect=function(O,R,P){var E=new cc.Vec2(P.x,P.y),D=new cc.Vec2(P.x,P.yMax),I=new cc.Vec2(P.xMax,P.yMax),M=new cc.Vec2(P.xMax,P.y);return!!(_(O,R,E,D)||_(O,R,D,I)||_(O,R,I,M)||_(O,R,M,E))},T.linePolygon=w,T.rectRect=function(O,R){var P=O.x,E=O.y,D=O.x+O.width,I=O.y+O.height,M=R.x,N=R.y,k=R.x+R.width,F=R.y+R.height;return P<=k&&D>=M&&E<=F&&I>=N},T.rectPolygon=function(O,R){var P,E,D=new cc.Vec2(O.x,O.y),I=new cc.Vec2(O.x,O.yMax),M=new cc.Vec2(O.xMax,O.yMax),N=new cc.Vec2(O.xMax,O.y);if(w(D,I,R)||w(I,M,R)||w(M,N,R)||w(N,D,R))return!0;for(P=0,E=R.length;P<E;++P)if(B(R[P],O))return!0;return!!(B(D,R)||B(I,R)||B(M,R)||B(N,R))},T.polygonPolygon=function(O,R){var P,E;for(P=0,E=O.length;P<E;++P)if(w(O[P],O[(P+1)%E],R))return!0;for(P=0,E=R.length;P<E;++P)if(B(R[P],O))return!0;for(P=0,E=O.length;P<E;++P)if(B(O[P],R))return!0;return!1},T.circleCircle=function(O,R){return O.position.sub(R.position).mag()<O.radius+R.radius},T.polygonCircle=function(O,R){var P=R.position;if(B(P,O))return!0;for(var E=0,D=O.length;E<D;E++)if(A(P,E===0?O[O.length-1]:O[E-1],O[E],!0)<R.radius)return!0;return!1},T.pointInPolygon=B,T.pointLineDistance=A,cc.Intersection=S.exports=T},{}],98:[function(L,S){cc.Collider.Polygon=cc.Class({properties:{threshold:{default:1,serializable:!1,visible:!1},_offset:cc.v2(0,0),offset:{get:function(){return this._offset},set:function(_){this._offset=_},type:cc.Vec2},points:{tooltip:!1,default:function(){return[cc.v2(-50,-50),cc.v2(50,-50),cc.v2(50,50),cc.v2(-50,50)]},type:[cc.Vec2]}},resetPointsByContour:!1});var T=cc.Class({name:"cc.PolygonCollider",extends:cc.Collider,mixins:[cc.Collider.Polygon],editor:!1});cc.PolygonCollider=S.exports=T},{}],99:[function(L){L("./CCCollisionManager"),L("./CCCollider"),L("./CCBoxCollider"),L("./CCCircleCollider"),L("./CCPolygonCollider")},{"./CCBoxCollider":92,"./CCCircleCollider":93,"./CCCollider":94,"./CCCollisionManager":95,"./CCPolygonCollider":98}],100:[function(L,S){L("./platform/CCClass");var T=L("./platform/CCObject").Flags,_=L("./platform/js").array,w=T.IsStartCalled,B=T.IsOnEnableCalled;function A(V,j){for(var H=j.constructor._executionOrder,U=j._id,X=0,Y=V.length-1,z=Y>>>1;X<=Y;z=X+Y>>>1){var W=V[z],Z=W.constructor._executionOrder;if(Z>H)Y=z-1;else if(Z<H)X=z+1;else{var Q=W._id;if(Q>U)Y=z-1;else{if(!(Q<U))return z;X=z+1}}}return~X}function O(V,j){for(var H=V.array,U=V.i+1;U<H.length;){var X=H[U];X._enabled&&X.node&&X.node._activeInHierarchy?++U:(V.removeAt(U),j&&(X._objFlags&=~j))}}T.IsEditorOnEnableCalled;var R=cc.Class({__ctor__:function(V){var j=_.MutableForwardIterator;this._zero=new j([]),this._neg=new j([]),this._pos=new j([]),this._invoke=V},statics:{stableRemoveInactive:O},add:null,remove:null,invoke:null});function P(V,j){return V.constructor._executionOrder-j.constructor._executionOrder}var E=cc.Class({extends:R,add:function(V){var j=V.constructor._executionOrder;(j===0?this._zero:j<0?this._neg:this._pos).array.push(V)},remove:function(V){var j=V.constructor._executionOrder;(j===0?this._zero:j<0?this._neg:this._pos).fastRemove(V)},cancelInactive:function(V){O(this._zero,V),O(this._neg,V),O(this._pos,V)},invoke:function(){var V=this._neg;V.array.length>0&&(V.array.sort(P),this._invoke(V),V.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var j=this._pos;j.array.length>0&&(j.array.sort(P),this._invoke(j),j.array.length=0)}}),D=cc.Class({extends:R,add:function(V){var j=V.constructor._executionOrder;if(j===0)this._zero.array.push(V);else{var H=j<0?this._neg.array:this._pos.array,U=A(H,V);U<0&&H.splice(~U,0,V)}},remove:function(V){var j=V.constructor._executionOrder;if(j===0)this._zero.fastRemove(V);else{var H=j<0?this._neg:this._pos,U=A(H.array,V);U>=0&&H.removeAt(U)}},invoke:function(V){this._neg.array.length>0&&this._invoke(this._neg,V),this._invoke(this._zero,V),this._pos.array.length>0&&this._invoke(this._pos,V)}});function I(V,j,H,U){var X="var a=it.array;for(it.i=0;it.i<a.length;++it.i){var c=a[it.i];"+V+"}";return U=j?Function("it","dt",X):Function("it",X),V=Function("c","dt",V),function(Y,z){try{U(Y,z)}catch(Z){cc._throw(Z);var W=Y.array;for(H&&(W[Y.i]._objFlags|=H),++Y.i;Y.i<W.length;++Y.i)try{V(W[Y.i],z)}catch(Q){cc._throw(Q),H&&(W[Y.i]._objFlags|=H)}}}}var M=I("c.start();c._objFlags|="+w,!1,w),N=I("c.update(dt)",!0),k=I("c.lateUpdate(dt)",!0);function F(){this.startInvoker=new E(M),this.updateInvoker=new D(N),this.lateUpdateInvoker=new D(k),this._deferredComps=[],this._updating=!1}var G=cc.Class({ctor:F,unscheduleAll:F,statics:{LifeCycleInvoker:R,OneOffInvoker:E,createInvokeImpl:I,invokeOnEnable:function(V){var j=cc.director._compScheduler,H=V.array;for(V.i=0;V.i<H.length;++V.i){var U=H[V.i];U._enabled&&(U.onEnable(),!U.node._activeInHierarchy||j._onEnabled(U))}}},_onEnabled:function(V){cc.director.getScheduler().resumeTarget(V),V._objFlags|=B,this._updating?this._deferredComps.push(V):this._scheduleImmediate(V)},_onDisabled:function(V){cc.director.getScheduler().pauseTarget(V),V._objFlags&=~B;var j=this._deferredComps.indexOf(V);j>=0?_.fastRemoveAt(this._deferredComps,j):(!V.start||V._objFlags&w||this.startInvoker.remove(V),V.update&&this.updateInvoker.remove(V),V.lateUpdate&&this.lateUpdateInvoker.remove(V))},enableComp:function(V,j){if(!(V._objFlags&B)){if(V.onEnable){if(j)return void j.add(V);if(V.onEnable(),!V.node._activeInHierarchy)return}this._onEnabled(V)}},disableComp:function(V){V._objFlags&B&&(V.onDisable&&V.onDisable(),this._onDisabled(V))},_scheduleImmediate:function(V){typeof V.start!="function"||V._objFlags&w||this.startInvoker.add(V),typeof V.update=="function"&&this.updateInvoker.add(V),typeof V.lateUpdate=="function"&&this.lateUpdateInvoker.add(V)},_deferredSchedule:function(){for(var V=this._deferredComps,j=0,H=V.length;j<H;j++)this._scheduleImmediate(V[j]);V.length=0},_startForNewComps:function(){this._deferredComps.length>0&&(this._deferredSchedule(),this.startInvoker.invoke())},startPhase:function(){this._updating=!0,this.startInvoker.invoke(),this._startForNewComps()},updatePhase:function(V){this.updateInvoker.invoke(V)},lateUpdatePhase:function(V){this.lateUpdateInvoker.invoke(V),this._updating=!1,this._startForNewComps()}});S.exports=G},{"./platform/CCClass":196,"./platform/CCObject":202,"./platform/js":217,"./utils/misc":271}],101:[function(L,S){var T=L("../../animation/animation-animator"),_=L("../../animation/animation-clip"),w=L("../event/event-target"),B=L("../platform/js"),A=function(P,E){return P===E},O=cc.Enum({PLAY:"play",STOP:"stop",PAUSE:"pause",RESUME:"resume",LASTFRAME:"lastframe",FINISHED:"finished"}),R=cc.Class({name:"cc.Animation",extends:L("./CCComponent"),mixins:[w],editor:!1,statics:{EventType:O},ctor:function(){cc.EventTarget.call(this),this._animator=null,this._nameToState=B.createMap(!0),this._didInit=!1,this._currentClip=null},properties:{_defaultClip:{default:null,type:_},defaultClip:{type:_,get:function(){return this._defaultClip},set:function(){},tooltip:!1},currentClip:{get:function(){return this._currentClip},set:function(P){this._currentClip=P},type:_,visible:!1},_writableClips:{get:function(){return this._clips},set:function(P){this._didInit=!1,this._clips=P,this._init()},type:[_]},_clips:{default:[],type:[_],tooltip:!1,visible:!0},playOnLoad:{default:!1,tooltip:!1}},start:function(){if(this.playOnLoad&&this._defaultClip&&(!this._animator||!this._animator.isPlaying)){var P=this.getAnimationState(this._defaultClip.name);this._animator.playState(P)}},onEnable:function(){this._animator&&this._animator.resume()},onDisable:function(){this._animator&&this._animator.pause()},onDestroy:function(){this.stop()},getClips:function(){return this._clips},play:function(P,E){var D=this.playAdditive(P,E);return this._animator.stopStatesExcept(D),D},playAdditive:function(P,E){this._init();var D=this.getAnimationState(P||this._defaultClip&&this._defaultClip.name);if(D){this.enabled=!0;var I=this._animator;I.isPlaying&&D.isPlaying?D.isPaused?I.resumeState(D):(I.stopState(D),I.playState(D,E)):I.playState(D,E),this.enabledInHierarchy||I.pause(),this.currentClip=D.clip}return D},stop:function(P){if(this._didInit)if(P){var E=this._nameToState[P];E&&this._animator.stopState(E)}else this._animator.stop()},pause:function(P){if(this._didInit)if(P){var E=this._nameToState[P];E&&this._animator.pauseState(E)}else this.enabled=!1},resume:function(P){if(this._didInit)if(P){var E=this.getAnimationState(P);E&&this._animator.resumeState(E)}else this.enabled=!0},setCurrentTime:function(P,E){if(this._init(),E){var D=this.getAnimationState(E);D&&this._animator.setStateTime(D,P)}else this._animator.setStateTime(P)},getAnimationState:function(P){this._init();var E=this._nameToState[P];return E&&!E.curveLoaded&&this._animator._reloadClip(E),E||null},hasAnimationState:function(P){return this._init(),!!this._nameToState[P]},addClip:function(P,E){if(P){this._init(),cc.js.array.contains(this._clips,P)||this._clips.push(P),E=E||P.name;var D=this._nameToState[E];if(D){if(D.clip===P)return D;var I=this._clips.indexOf(D.clip);I!==-1&&this._clips.splice(I,1)}var M=new cc.AnimationState(P,E);return this._nameToState[E]=M,M}cc.warnID(3900)},removeClip:function(P,E){if(P){var D;for(var I in this._init(),this._nameToState)if(D=this._nameToState[I],A(D.clip,P))break;if(P===this._defaultClip){if(!E)return void cc.warnID(3902);this._defaultClip=null}if(D&&D.isPlaying){if(!E)return void cc.warnID(3903);this.stop(D.name)}this._clips=this._clips.filter(function(M){return!A(M,P)}),D&&delete this._nameToState[D.name]}else cc.warnID(3901)},sample:function(P){if(this._init(),P){var E=this.getAnimationState(P);E&&E.sample()}else this._animator.sample()},on:function(P,E,D,I){this._init();var M=this._EventTargetOn(P,E,D,I);if(P==="lastframe"){var N=this._nameToState;for(var k in N)N[k]._lastframeEventOn=!0}return M},off:function(P,E,D,I){if(this._init(),P==="lastframe"){var M=this._nameToState;for(var N in M)M[N]._lastframeEventOn=!1}this._EventTargetOff(P,E,D,I)},_init:function(){this._didInit||(this._didInit=!0,this._animator=new T(this.node,this),this._createStates())},_createStates:function(){this._nameToState=B.createMap(!0);for(var P=null,E=!1,D=0;D<this._clips.length;++D){var I=this._clips[D];I&&(P=new cc.AnimationState(I),this._nameToState[P.name]=P,A(this._defaultClip,I)&&(E=P))}this._defaultClip&&!E&&(P=new cc.AnimationState(this._defaultClip),this._nameToState[P.name]=P)}});R.prototype._EventTargetOn=w.prototype.on,R.prototype._EventTargetOff=w.prototype.off,cc.Animation=S.exports=R},{"../../animation/animation-animator":9,"../../animation/animation-clip":10,"../event/event-target":143,"../platform/js":217,"./CCComponent":106}],102:[function(L,S){var T=L("../utils/misc"),_=L("./CCComponent"),w=L("../assets/CCAudioClip"),B=cc.Class({name:"cc.AudioSource",extends:_,editor:!1,ctor:function(){this.audio=new cc._Audio},properties:{_clip:{default:null,type:w},_volume:1,_mute:!1,_loop:!1,_pausedFlag:{default:!1,serializable:!1},_firstlyEnabled:!0,isPlaying:{get:function(){return this.audio.getState()===cc._Audio.State.PLAYING},visible:!1},clip:{get:function(){return this._clip},set:function(A){if(A!==this._clip){if(!(A instanceof w))return cc.error("Wrong type of AudioClip.");this._clip=A,this.audio.stop(),this.audio.src=this._clip,this.preload&&this._clip._ensureLoaded()}},type:w,tooltip:!1,animatable:!1},volume:{get:function(){return this._volume},set:function(A){return A=T.clamp01(A),this._volume=A,this._mute||this.audio.setVolume(A),A},tooltip:!1},mute:{get:function(){return this._mute},set:function(A){return this._mute=A,this.audio.setVolume(A?0:this._volume),A},animatable:!1,tooltip:!1},loop:{get:function(){return this._loop},set:function(A){return this._loop=A,this.audio.setLoop(A),A},animatable:!1,tooltip:!1},playOnLoad:{default:!1,tooltip:!1,animatable:!1},preload:{default:!1,animatable:!1}},_pausedCallback:function(){this.audio.getState()===cc._Audio.State.PLAYING&&(this.audio.pause(),this._pausedFlag=!0)},_restoreCallback:function(){this._pausedFlag&&this.audio.resume(),this._pausedFlag=!1},onLoad:function(){this.audio.src||(this.audio.src=this._clip),this.preload&&this._clip._ensureLoaded()},onEnable:function(){this.playOnLoad&&this._firstlyEnabled&&(this._firstlyEnabled=!1,this.play()),cc.game.on(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.on(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDisable:function(){this.stop(),cc.game.off(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.off(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDestroy:function(){this.audio.destroy()},play:function(){if(this._clip){var A=this.audio;A.setVolume(this._mute?0:this._volume),A.setLoop(this._loop),A.setCurrentTime(0),A.play()}},stop:function(){this.audio.stop()},pause:function(){this.audio.pause()},resume:function(){this.audio.resume()},rewind:function(){this.audio.setCurrentTime(0)},getCurrentTime:function(){return this.audio.getCurrentTime()},setCurrentTime:function(A){return this.audio.setCurrentTime(A),A},getDuration:function(){return this.audio.getDuration()}});cc.AudioSource=S.exports=B},{"../assets/CCAudioClip":63,"../utils/misc":271,"./CCComponent":106}],103:[function(L,S){var T=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","mouseenter","mouseleave","mousewheel"];function _(B){B.stopPropagation()}var w=cc.Class({name:"cc.BlockInputEvents",extends:L("./CCComponent"),editor:{menu:"i18n:MAIN_MENU.component.ui/Block Input Events",inspector:"packages://inspector/inspectors/comps/block-input-events.js",help:"i18n:COMPONENT.help_url.block_input_events"},onEnable:function(){for(var B=0;B<T.length;B++)this.node.on(T[B],_,this)},onDisable:function(){for(var B=0;B<T.length;B++)this.node.off(T[B],_,this)}});cc.BlockInputEvents=S.exports=w},{"./CCComponent":106}],104:[function(L,S){var T=L("./CCComponent"),_=L("../utils/gray-sprite-state"),w=cc.Enum({NONE:0,COLOR:1,SPRITE:2,SCALE:3}),B=cc.Enum({NORMAL:0,HOVER:1,PRESSED:2,DISABLED:3}),A=cc.Class({name:"cc.Button",extends:T,mixins:[_],ctor:function(){this._pressed=!1,this._hovered=!1,this._fromColor=null,this._toColor=null,this._time=0,this._transitionFinished=!0,this._fromScale=cc.Vec2.ZERO,this._toScale=cc.Vec2.ZERO,this._originalScale=null,this._graySpriteMaterial=null,this._spriteMaterial=null,this._sprite=null},editor:!1,properties:{interactable:{default:!0,tooltip:!1,notify:function(){this._updateState(),this.interactable||this._resetState()},animatable:!1},_resizeToTarget:{animatable:!1,set:function(O){O&&this._resizeNodeToTargetNode()}},enableAutoGrayEffect:{default:!1,tooltip:!1,notify:function(){this._updateDisabledState(!0)}},transition:{default:w.NONE,tooltip:!1,type:w,animatable:!1,notify:function(O){this._updateTransition(O)},formerlySerializedAs:"transition"},normalColor:{default:cc.Color.WHITE,displayName:"Normal",tooltip:!1,notify:function(){this.transition===w.Color&&this._getButtonState()===B.NORMAL&&(this._getTarget().opacity=this.normalColor.a),this._updateState()}},pressedColor:{default:cc.color(211,211,211),displayName:"Pressed",tooltip:!1,notify:function(){this.transition===w.Color&&this._getButtonState()===B.PRESSED&&(this._getTarget().opacity=this.pressedColor.a),this._updateState()},formerlySerializedAs:"pressedColor"},hoverColor:{default:cc.Color.WHITE,displayName:"Hover",tooltip:!1,notify:function(){this.transition===w.Color&&this._getButtonState()===B.HOVER&&(this._getTarget().opacity=this.hoverColor.a),this._updateState()},formerlySerializedAs:"hoverColor"},disabledColor:{default:cc.color(124,124,124),displayName:"Disabled",tooltip:!1,notify:function(){this.transition===w.Color&&this._getButtonState()===B.DISABLED&&(this._getTarget().opacity=this.disabledColor.a),this._updateState()}},duration:{default:.1,range:[0,10],tooltip:!1},zoomScale:{default:1.2,tooltip:!1},normalSprite:{default:null,type:cc.SpriteFrame,displayName:"Normal",tooltip:!1,notify:function(){this._updateState()}},pressedSprite:{default:null,type:cc.SpriteFrame,displayName:"Pressed",tooltip:!1,formerlySerializedAs:"pressedSprite",notify:function(){this._updateState()}},hoverSprite:{default:null,type:cc.SpriteFrame,displayName:"Hover",tooltip:!1,formerlySerializedAs:"hoverSprite",notify:function(){this._updateState()}},disabledSprite:{default:null,type:cc.SpriteFrame,displayName:"Disabled",tooltip:!1,notify:function(){this._updateState()}},target:{default:null,type:cc.Node,tooltip:!1,notify:function(O){this._applyTarget(),O&&this.target!==O&&this._unregisterTargetEvent(O)}},clickEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Transition:w},__preload:function(){this._applyTarget(),this._resetState()},_resetState:function(){this._pressed=!1,this._hovered=!1;var O=this._getTarget(),R=this.transition,P=this._originalScale;R===w.COLOR&&this.interactable?this._setTargetColor(this.normalColor):R===w.SCALE&&P&&O.setScale(P.x,P.y),this._transitionFinished=!0},onEnable:function(){this.normalSprite&&this.normalSprite.ensureLoadTexture(),this.hoverSprite&&this.hoverSprite.ensureLoadTexture(),this.pressedSprite&&this.pressedSprite.ensureLoadTexture(),this.disabledSprite&&this.disabledSprite.ensureLoadTexture(),this._registerNodeEvent(),this._updateState()},onDisable:function(){this._resetState(),this._unregisterNodeEvent()},_getTarget:function(){return this.target?this.target:this.node},_onTargetSpriteFrameChanged:function(O){this.transition===w.SPRITE&&this._setCurrentStateSprite(O.spriteFrame)},_onTargetColorChanged:function(O){this.transition===w.COLOR&&this._setCurrentStateColor(O)},_onTargetScaleChanged:function(){var O=this._getTarget();this._originalScale&&(this.transition!==w.SCALE||this._transitionFinished)&&(this._originalScale.x=O.scaleX,this._originalScale.y=O.scaleY)},_setTargetColor:function(O){var R=this._getTarget(),P=O.clone();R.opacity=P.a,P.a=255,R.color=P},_getStateColor:function(O){switch(O){case B.NORMAL:return this.normalColor;case B.HOVER:return this.hoverColor;case B.PRESSED:return this.pressedColor;case B.DISABLED:return this.disabledColor}},_getStateSprite:function(O){switch(O){case B.NORMAL:return this.normalSprite;case B.HOVER:return this.hoverSprite;case B.PRESSED:return this.pressedSprite;case B.DISABLED:return this.disabledSprite}},_setCurrentStateColor:function(O){switch(this._getButtonState()){case B.NORMAL:this.normalColor=O;break;case B.HOVER:this.hoverColor=O;break;case B.PRESSED:this.pressedColor=O;break;case B.DISABLED:this.disabledColor=O}},_setCurrentStateSprite:function(O){switch(this._getButtonState()){case B.NORMAL:this.normalSprite=O;break;case B.HOVER:this.hoverSprite=O;break;case B.PRESSED:this.pressedSprite=O;break;case B.DISABLED:this.disabledSprite=O}},update:function(O){var R=this._getTarget();if(!this._transitionFinished&&(this.transition===w.COLOR||this.transition===w.SCALE)){this.time+=O;var P=1;if(this.duration>0&&(P=this.time/this.duration),P>=1&&(P=1),this.transition===w.COLOR){var E=this._fromColor.lerp(this._toColor,P);this._setTargetColor(E)}else this.transition===w.SCALE&&this._originalScale&&(R.scale=this._fromScale.lerp(this._toScale,P));P===1&&(this._transitionFinished=!0)}},_registerNodeEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_unregisterNodeEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_registerTargetEvent:function(O){O.on(cc.Node.EventType.SCALE_CHANGED,this._onTargetScaleChanged,this)},_unregisterTargetEvent:function(O){O.off(cc.Node.EventType.SCALE_CHANGED,this._onTargetScaleChanged,this)},_getTargetSprite:function(O){var R=null;return O&&(R=O.getComponent(cc.Sprite)),R},_applyTarget:function(){var O=this._getTarget();this._sprite=this._getTargetSprite(O),this._originalScale||(this._originalScale=cc.Vec2.ZERO),this._originalScale.x=O.scaleX,this._originalScale.y=O.scaleY,this._registerTargetEvent(O)},_onTouchBegan:function(O){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),O.stopPropagation())},_onTouchMove:function(O){if(this.interactable&&this.enabledInHierarchy&&this._pressed){var R,P=O.touch,E=this.node._hitTest(P.getLocation()),D=this._getTarget(),I=this._originalScale;this.transition===w.SCALE&&I?E?(this._fromScale.x=I.x,this._fromScale.y=I.y,this._toScale.x=I.x*this.zoomScale,this._toScale.y=I.y*this.zoomScale,this._transitionFinished=!1):(this.time=0,this._transitionFinished=!0,D.setScale(I.x,I.y)):(R=E?B.PRESSED:B.NORMAL,this._applyTransition(R)),O.stopPropagation()}},_onTouchEnded:function(O){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,O),this.node.emit("click",this)),this._pressed=!1,this._updateState(),O.stopPropagation())},_onTouchCancel:function(){this.interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},_onMouseMoveIn:function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this.transition!==w.SPRITE||this.hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},_onMouseMoveOut:function(){this._hovered&&(this._hovered=!1,this._updateState())},_updateState:function(){var O=this._getButtonState();this._applyTransition(O),this._updateDisabledState()},_getButtonState:function(){return this.interactable?this._pressed?B.PRESSED:this._hovered?B.HOVER:B.NORMAL:B.DISABLED},_updateColorTransitionImmediately:function(O){var R=this._getStateColor(O);this._setTargetColor(R),this._fromColor=R.clone(),this._toColor=R},_updateColorTransition:function(O){if(O===B.DISABLED)this._updateColorTransitionImmediately(O);else{var R=this._getTarget(),P=this._getStateColor(O);this._fromColor=R.color.clone(),this._toColor=P,this.time=0,this._transitionFinished=!1}},_updateSpriteTransition:function(O){var R=this._getStateSprite(O);this._sprite&&R&&(this._sprite.spriteFrame=R)},_updateScaleTransition:function(O){O===B.PRESSED?this._zoomUp():this._zoomBack()},_zoomUp:function(){this._originalScale&&(this._fromScale.x=this._originalScale.x,this._fromScale.y=this._originalScale.y,this._toScale.x=this._originalScale.x*this.zoomScale,this._toScale.y=this._originalScale.y*this.zoomScale,this.time=0,this._transitionFinished=!1)},_zoomBack:function(){if(this._originalScale){var O=this._getTarget();this._fromScale.x=O.scaleX,this._fromScale.y=O.scaleY,this._toScale.x=this._originalScale.x,this._toScale.y=this._originalScale.y,this.time=0,this._transitionFinished=!1}},_updateTransition:function(O){O===w.COLOR?this._updateColorTransitionImmediately(B.NORMAL):O===w.SPRITE&&this._updateSpriteTransition(B.NORMAL),this._updateState()},_applyTransition:function(O){var R=this.transition;R===w.COLOR?this._updateColorTransition(O):R===w.SPRITE?this._updateSpriteTransition(O):R===w.SCALE&&this._updateScaleTransition(O)},_resizeNodeToTargetNode:!1,_updateDisabledState:function(O){if(this._sprite&&(this.enableAutoGrayEffect||O)){var R=!1;this.transition===w.SPRITE&&this.disabledSprite||(R=this.enableAutoGrayEffect&&!this.interactable),this._switchGrayMaterial(R,this._sprite)}}});cc.Button=S.exports=A},{"../utils/gray-sprite-state":268,"./CCComponent":106}],105:[function(L,S){var T=L("../camera/CCCamera"),_=L("./CCComponent"),w=cc.Class({name:"cc.Canvas",extends:_,editor:!1,resetInEditor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},set:function(B){this._designResolution.width=B.width,this._designResolution.height=B.height,this.applySettings()},tooltip:!1},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(B){this._fitHeight!==B&&(this._fitHeight=B,this.applySettings())},tooltip:!1},fitWidth:{get:function(){return this._fitWidth},set:function(B){this._fitWidth!==B&&(this._fitWidth=B,this.applySettings())},tooltip:!1}},_fitDesignResolution:!1,__preload:function(){if(w.instance)return cc.warnID(6700,this.node.name,w.instance.node.name);w.instance=this,this.applySettings();var B=this.getComponent(cc.Widget);B&&B.updateAlignment()},start:function(){if(!T.main&&cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){var B=new cc.Node("Main Camera");B.parent=this.node,B.setSiblingIndex(0);var A=B.addComponent(T),O=T.ClearFlags;A.clearFlags=O.COLOR|O.DEPTH|O.STENCIL,A.depth=-1}},onDestroy:function(){w.instance===this&&(w.instance=null)},applySettings:function(){var B,A=cc.ResolutionPolicy;B=this.fitHeight&&this.fitWidth?A.SHOW_ALL:this.fitHeight||this.fitWidth?this.fitWidth?A.FIXED_WIDTH:A.FIXED_HEIGHT:A.NO_BORDER;var O=this._designResolution;cc.view.setDesignResolutionSize(O.width,O.height,B)}});cc.Canvas=S.exports=w},{"../camera/CCCamera":91,"./CCComponent":106}],106:[function(L,S){var T=L("../platform/CCObject"),_=L("../platform/js"),w=new(L("../platform/id-generater"))("Comp"),B=(T.Flags.IsOnEnableCalled,T.Flags.IsOnLoadCalled),A=!!cc.ActionManager,O=cc.Class({name:"cc.Component",extends:T,ctor:function(){this._id=w.getNewId(),this.__eventTargets=[]},properties:{node:{default:null,visible:!1},name:{get:function(){if(this._name)return this._name;var R=cc.js.getClassName(this),P=R.lastIndexOf(".");return P>=0&&(R=R.slice(P+1)),this.node.name+"<"+R+">"},set:function(R){this._name=R},visible:!1},uuid:{get:function(){return this._id},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(R){if(this._enabled!==R&&(this._enabled=R,this.node._activeInHierarchy)){var P=cc.director._compScheduler;R?P.enableComp(this):P.disableComp(this)}},visible:!1,animatable:!0},enabledInHierarchy:{get:function(){return this._enabled&&this.node&&this.node._activeInHierarchy},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&B}}},update:null,lateUpdate:null,__preload:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,resetInEditor:null,addComponent:function(R){return this.node.addComponent(R)},getComponent:function(R){return this.node.getComponent(R)},getComponents:function(R){return this.node.getComponents(R)},getComponentInChildren:function(R){return this.node.getComponentInChildren(R)},getComponentsInChildren:function(R){return this.node.getComponentsInChildren(R)},_getLocalBounds:null,onRestore:null,destroy:function(){this._super()&&this._enabled&&this.node._activeInHierarchy&&cc.director._compScheduler.disableComp(this)},_onPreDestroy:function(){A&&cc.director.getActionManager().removeAllActionsFromTarget(this),this.unscheduleAllCallbacks();for(var R=this.__eventTargets,P=R.length-1;P>=0;--P){var E=R[P];E&&E.targetOff(this)}R.length=0,cc.director._nodeActivator.destroyComp(this),this.node._removeComponent(this)},_instantiate:function(R){return R||(R=cc.instantiate._clone(this,this)),R.node=null,R},schedule:function(R,P,E,D){cc.assertID(R,1619),P=P||0,cc.assertID(P>=0,1620),E=isNaN(E)?cc.macro.REPEAT_FOREVER:E,D=D||0;var I=cc.director.getScheduler(),M=I.isTargetPaused(this);I.schedule(R,this,P,E,D,M)},scheduleOnce:function(R,P){this.schedule(R,0,0,P)},unschedule:function(R){R&&cc.director.getScheduler().unschedule(R,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});O._requireComponent=null,O._executionOrder=0,_.value(O,"_registerEditorProps",function(R,P){var E=P.requireComponent;E&&(R._requireComponent=E);var D=P.executionOrder;D&&typeof D=="number"&&(R._executionOrder=D)}),O.prototype.__scriptUuid="",cc.Component=S.exports=O},{"../platform/CCObject":202,"../platform/id-generater":213,"../platform/js":217}],107:[function(){cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{default:null,type:cc.Node},component:"",_componentId:"",_componentName:{get:function(){return this._genCompIdIfNeeded(),this._compId2Name(this._componentId)},set:function(L){this._componentId=this._compName2Id(L)}},handler:{default:""},customEventData:{default:""}},statics:{emitEvents:function(L){var S;if(arguments.length>0)for(var T=0,_=(S=new Array(arguments.length-1)).length;T<_;T++)S[T]=arguments[T+1];for(var w=0,B=L.length;w<B;w++){var A=L[w];A instanceof cc.Component.EventHandler&&A.emit(S)}}},emit:function(L){var S=this.target;if(cc.isValid(S)){this._genCompIdIfNeeded();var T=cc.js._getClassById(this._componentId),_=S.getComponent(T);if(cc.isValid(_)){var w=_[this.handler];typeof w=="function"&&(this.customEventData!=null&&this.customEventData!==""&&(L=L.slice()).push(this.customEventData),w.apply(_,L))}}},_compName2Id:function(L){var S=cc.js.getClassByName(L);return cc.js._getClassId(S)},_compId2Name:function(L){var S=cc.js._getClassById(L);return cc.js.getClassName(S)},_genCompIdIfNeeded:function(){this._componentId||(this._componentName=this.component,this.component="")}})},{}],108:[function(L,S){var T=L("../platform/CCMacro"),_=L("./CCRenderComponent"),w=(L("../assets/material/CCMaterial"),L("../renderer/utils/label/label-frame")),B=L("../utils/blend-func"),A=L("../renderer/utils/utils").deleteFromDynamicAtlas,O=T.TextAlignment,R=T.VerticalTextAlignment,P=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3}),E=cc.Enum({NONE:0,BITMAP:1,CHAR:2}),D=cc.Class({name:"cc.Label",extends:_,mixins:[B],ctor:function(){this._actualFontSize=0,this._assemblerData=null,this._frame=null,this._ttfTexture=null,this._letterTexture=null,cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?this._updateMaterial=this._updateMaterialCanvas:this._updateMaterial=this._updateMaterialWebgl},editor:!1,properties:{_string:{default:"",formerlySerializedAs:"_N$string"},string:{get:function(){return this._string},set:function(I){var M=this._string;this._string=""+I,this.string!==M&&this.setVertsDirty(),this._checkStringEmpty()},multiline:!0,tooltip:!1},horizontalAlign:{default:O.LEFT,type:O,tooltip:!1,notify:function(I){this.horizontalAlign!==I&&this.setVertsDirty()},animatable:!1},verticalAlign:{default:R.TOP,type:R,tooltip:!1,notify:function(I){this.verticalAlign!==I&&this.setVertsDirty()},animatable:!1},actualFontSize:{displayName:"Actual Font Size",animatable:!1,readonly:!0,get:function(){return this._actualFontSize},tooltip:!1},_fontSize:40,fontSize:{get:function(){return this._fontSize},set:function(I){this._fontSize!==I&&(this._fontSize=I,this.setVertsDirty())},range:[0,512],tooltip:!1},fontFamily:{default:"Arial",tooltip:!1,notify:function(I){this.fontFamily!==I&&this.setVertsDirty()},animatable:!1},_lineHeight:40,lineHeight:{get:function(){return this._lineHeight},set:function(I){this._lineHeight!==I&&(this._lineHeight=I,this.setVertsDirty())},tooltip:!1},overflow:{default:P.NONE,type:P,tooltip:!1,notify:function(I){this.overflow!==I&&this.setVertsDirty()},animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){return this._enableWrapText},set:function(I){this._enableWrapText!==I&&(this._enableWrapText=I,this.setVertsDirty())},animatable:!1,tooltip:!1},_N$file:null,font:{get:function(){return this._N$file},set:function(I){this.font!==I&&(I||(this._isSystemFontUsed=!0),this._N$file=I,I&&this._isSystemFontUsed&&(this._isSystemFontUsed=!1),this.enabledInHierarchy&&this._forceUpdateRenderData())},type:cc.Font,tooltip:!1,animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(I){if(this._isSystemFontUsed!==I){if(this._isSystemFontUsed=!!I,I){if(this.font=null,!this.enabledInHierarchy)return;this._forceUpdateRenderData()}this.markForValidate()}},animatable:!1,tooltip:!1},_bmFontOriginalSize:{displayName:"BMFont Original Size",get:function(){return this._N$file instanceof cc.BitmapFont?this._N$file.fontSize:-1},visible:!0,animatable:!1},_spacingX:0,spacingX:{get:function(){return this._spacingX},set:function(I){this._spacingX=I,this.setVertsDirty()},tooltip:!1},_batchAsBitmap:!1,cacheMode:{default:E.NONE,type:E,tooltip:!1,notify:function(I){this.cacheMode!==I&&(I!==E.BITMAP||this.font instanceof cc.BitmapFont||this._frame&&this._frame._resetDynamicAtlasFrame(),I===E.CHAR&&(this._ttfTexture=null),this.enabledInHierarchy&&this._forceUpdateRenderData())},animatable:!1},_styleFlags:0,enableBold:{get:function(){return!!(1&this._styleFlags)},set:function(I){I?this._styleFlags|=1:this._styleFlags&=-2,this.setVertsDirty()},animatable:!1,tooltip:!1},enableItalic:{get:function(){return!!(2&this._styleFlags)},set:function(I){I?this._styleFlags|=2:this._styleFlags&=-3,this.setVertsDirty()},animatable:!1,tooltip:!1},enableUnderline:{get:function(){return!!(4&this._styleFlags)},set:function(I){I?this._styleFlags|=4:this._styleFlags&=-5,this.setVertsDirty()},animatable:!1,tooltip:!1},_underlineHeight:0,underlineHeight:{get:function(){return this._underlineHeight},set:function(I){this._underlineHeight!==I&&(this._underlineHeight=I,this.setVertsDirty())},tooltip:!1}},statics:{HorizontalAlign:O,VerticalAlign:R,Overflow:P,CacheMode:E,_shareAtlas:null,clearCharCache:function(){D._shareAtlas&&D._shareAtlas.clearAllCache()}},onLoad:function(){this._batchAsBitmap&&this.cacheMode===E.NONE&&(this.cacheMode=E.BITMAP,this._batchAsBitmap=!1),cc.game.renderType===cc.game.RENDER_TYPE_CANVAS&&(this.cacheMode=E.NONE)},onEnable:function(){this._super(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this._nodeSizeChanged,this),this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this),this.node.on(cc.Node.EventType.COLOR_CHANGED,this._nodeColorChanged,this),this._forceUpdateRenderData()},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.SIZE_CHANGED,this._nodeSizeChanged,this),this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this),this.node.off(cc.Node.EventType.COLOR_CHANGED,this._nodeColorChanged,this)},onDestroy:function(){this._assembler&&this._assembler._resetAssemblerData&&this._assembler._resetAssemblerData(this._assemblerData),this._assemblerData=null,this._letterTexture=null,this._ttfTexture&&(this._ttfTexture.destroy(),this._ttfTexture=null),this._super()},onRestore:!1,_nodeSizeChanged:function(){this.overflow!==P.NONE&&this.setVertsDirty()},_nodeColorChanged:function(){this.font instanceof cc.BitmapFont||this.setVertsDirty()},setVertsDirty:function(){this._super()},_updateColor:function(){this.font instanceof cc.BitmapFont||this._srcBlendFactor===cc.macro.BlendFactor.SRC_ALPHA&&this.node._renderFlag&cc.RenderFlow.FLAG_OPACITY||this.setVertsDirty(),_.prototype._updateColor.call(this)},_validateRender:function(){if(this.string){if(this._materials[0]){var I=this.font;if(!(I instanceof cc.BitmapFont))return;var M=I.spriteFrame;if(M&&M.textureLoaded()&&I._fntConfig)return}this.disableRender()}else this.disableRender()},_resetAssembler:function(){this._resetFrame(),_.prototype._resetAssembler.call(this)},_resetFrame:function(){!this._frame||this.font instanceof cc.BitmapFont||(A(this,this._frame),this._frame=null)},_checkStringEmpty:function(){this.markForRender(!!this.string)},_on3DNodeChanged:function(){this._resetAssembler(),this._applyFontTexture()},_onBMFontTextureLoaded:function(){this._frame._texture=this.font.spriteFrame._texture,this.markForRender(!0),this._updateMaterial(),this._assembler&&this._assembler.updateRenderData(this)},_onBlendChanged:function(){this.useSystemFont&&this.enabledInHierarchy&&this._forceUpdateRenderData()},_applyFontTexture:function(){var I=this.font;if(I instanceof cc.BitmapFont){var M=I.spriteFrame;this._frame=M,M&&M.onTextureLoaded(this._onBMFontTextureLoaded,this)}else this._nativeTTF()||(this._frame||(this._frame=new w),this.cacheMode===E.CHAR?(this._letterTexture=this._assembler._getAssemblerData(),this._frame._refreshTexture(this._letterTexture)):this._ttfTexture||(this._ttfTexture=new cc.Texture2D,this._assemblerData=this._assembler._getAssemblerData(),this._ttfTexture.initWithElement(this._assemblerData.canvas)),this.cacheMode!==E.CHAR&&(this._frame._resetDynamicAtlasFrame(),this._frame._refreshTexture(this._ttfTexture),this._srcBlendFactor===cc.macro.BlendFactor.ONE&&this._ttfTexture.setPremultiplyAlpha(!0)),this._updateMaterial()),this._assembler&&this._assembler.updateRenderData(this);this.markForValidate()},_updateMaterialCanvas:function(){this._frame&&(this._frame._texture._nativeUrl=this.uuid+"_texture")},_updateMaterialWebgl:function(){var I=this.getMaterial(0);this._nativeTTF()?I&&this._assembler._updateTTFMaterial(this):this._frame&&(I&&I.setProperty("texture",this._frame._texture),B.prototype._updateMaterial.call(this))},_forceUseCanvas:!1,_useNativeTTF:function(){return cc.macro.ENABLE_NATIVE_TTF_RENDERER&&!this._forceUseCanvas},_nativeTTF:function(){return this._useNativeTTF()&&!!this._assembler&&!!this._assembler._updateTTFMaterial},_forceUpdateRenderData:function(){this.setVertsDirty(),this._resetAssembler(),this._applyFontTexture()},_enableBold:function(I){this.enableBold=!!I},_enableItalics:function(I){this.enableItalic=!!I},_enableUnderline:function(I){this.enableUnderline=!!I}});cc.Label=S.exports=D},{"../assets/material/CCMaterial":81,"../platform/CCMacro":201,"../renderer/utils/label/label-frame":232,"../renderer/utils/utils":235,"../utils/blend-func":265,"./CCRenderComponent":117}],109:[function(L,S){var T=cc.Class({name:"cc.LabelOutline",extends:L("./CCComponent"),editor:!1,properties:{_color:cc.Color.WHITE,_width:1,color:{tooltip:!1,get:function(){return this._color.clone()},set:function(_){this._color.equals(_)||this._color.set(_),this._updateRenderData()}},width:{tooltip:!1,get:function(){return this._width},set:function(_){this._width!==_&&(this._width=_,this._updateRenderData())},range:[0,512]}},onEnable:function(){this._updateRenderData()},onDisable:function(){this._updateRenderData()},_updateRenderData:function(){var _=this.node.getComponent(cc.Label);_&&_.setVertsDirty()}});cc.LabelOutline=S.exports=T},{"./CCComponent":106}],110:[function(L,S){var T=cc.Class({name:"cc.LabelShadow",extends:L("./CCComponent"),editor:!1,properties:{_color:cc.Color.WHITE,_offset:cc.v2(2,2),_blur:2,color:{tooltip:!1,get:function(){return this._color.clone()},set:function(_){this._color.equals(_)||this._color.set(_),this._updateRenderData()}},offset:{tooltip:!1,get:function(){return this._offset},set:function(_){this._offset=_,this._updateRenderData()}},blur:{tooltip:!1,get:function(){return this._blur},set:function(_){this._blur=_,this._updateRenderData()},range:[0,1024]}},onEnable:function(){this._updateRenderData()},onDisable:function(){this._updateRenderData()},_updateRenderData:function(){var _=this.node.getComponent(cc.Label);_&&_.setVertsDirty()}});cc.LabelShadow=S.exports=T},{"./CCComponent":106}],111:[function(L,S){var T=L("../CCNode").EventType,_=cc.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3}),w=cc.Enum({NONE:0,CONTAINER:1,CHILDREN:2}),B=cc.Enum({HORIZONTAL:0,VERTICAL:1}),A=cc.Enum({BOTTOM_TO_TOP:0,TOP_TO_BOTTOM:1}),O=cc.Enum({LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1}),R=cc.Class({name:"cc.Layout",extends:L("./CCComponent"),editor:!1,properties:{_layoutSize:cc.size(300,200),_layoutDirty:{default:!0,serializable:!1},_resize:w.NONE,_N$layoutType:_.NONE,type:{type:_,get:function(){return this._N$layoutType},set:function(P){this._N$layoutType=P,this._doLayoutDirty()},tooltip:!1,animatable:!1},resizeMode:{type:w,tooltip:!1,animatable:!1,get:function(){return this._resize},set:function(P){this.type===_.NONE&&P===w.CHILDREN||(this._resize=P,this._doLayoutDirty())}},cellSize:{default:cc.size(40,40),tooltip:!1,type:cc.Size,notify:function(){this._doLayoutDirty()}},startAxis:{default:B.HORIZONTAL,tooltip:!1,type:B,notify:function(){this._doLayoutDirty()},animatable:!1},paddingLeft:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingRight:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingTop:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingBottom:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},spacingX:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},spacingY:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},verticalDirection:{default:A.TOP_TO_BOTTOM,type:A,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},horizontalDirection:{default:O.LEFT_TO_RIGHT,type:O,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},affectedByScale:{default:!1,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:!1}},statics:{Type:_,VerticalDirection:A,HorizontalDirection:O,ResizeMode:w,AxisDirection:B},onEnable:function(){this._addEventListeners(),this.node.getContentSize().equals(cc.size(0,0))&&this.node.setContentSize(this._layoutSize),this._doLayoutDirty()},onDisable:function(){this._removeEventListeners()},_doLayoutDirty:function(){this._layoutDirty=!0},_doScaleDirty:function(){this._layoutDirty=this._layoutDirty||this.affectedByScale},_addEventListeners:function(){cc.director.on(cc.Director.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.on(T.SIZE_CHANGED,this._resized,this),this.node.on(T.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.on(T.CHILD_ADDED,this._childAdded,this),this.node.on(T.CHILD_REMOVED,this._childRemoved,this),this.node.on(T.CHILD_REORDER,this._doLayoutDirty,this),this._addChildrenEventListeners()},_removeEventListeners:function(){cc.director.off(cc.Director.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.off(T.SIZE_CHANGED,this._resized,this),this.node.off(T.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.off(T.CHILD_ADDED,this._childAdded,this),this.node.off(T.CHILD_REMOVED,this._childRemoved,this),this.node.off(T.CHILD_REORDER,this._doLayoutDirty,this),this._removeChildrenEventListeners()},_addChildrenEventListeners:function(){for(var P=this.node.children,E=0;E<P.length;++E){var D=P[E];D.on(T.SCALE_CHANGED,this._doScaleDirty,this),D.on(T.SIZE_CHANGED,this._doLayoutDirty,this),D.on(T.POSITION_CHANGED,this._doLayoutDirty,this),D.on(T.ANCHOR_CHANGED,this._doLayoutDirty,this),D.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}},_removeChildrenEventListeners:function(){for(var P=this.node.children,E=0;E<P.length;++E){var D=P[E];D.off(T.SCALE_CHANGED,this._doScaleDirty,this),D.off(T.SIZE_CHANGED,this._doLayoutDirty,this),D.off(T.POSITION_CHANGED,this._doLayoutDirty,this),D.off(T.ANCHOR_CHANGED,this._doLayoutDirty,this),D.off("active-in-hierarchy-changed",this._doLayoutDirty,this)}},_childAdded:function(P){P.on(T.SCALE_CHANGED,this._doScaleDirty,this),P.on(T.SIZE_CHANGED,this._doLayoutDirty,this),P.on(T.POSITION_CHANGED,this._doLayoutDirty,this),P.on(T.ANCHOR_CHANGED,this._doLayoutDirty,this),P.on("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_childRemoved:function(P){P.off(T.SCALE_CHANGED,this._doScaleDirty,this),P.off(T.SIZE_CHANGED,this._doLayoutDirty,this),P.off(T.POSITION_CHANGED,this._doLayoutDirty,this),P.off(T.ANCHOR_CHANGED,this._doLayoutDirty,this),P.off("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_resized:function(){this._layoutSize=this.node.getContentSize(),this._doLayoutDirty()},_doLayoutHorizontally:function(P,E,D,I){var M=this.node.getAnchorPoint(),N=this.node.children,k=1,F=this.paddingLeft,G=-M.x*P;this.horizontalDirection===O.RIGHT_TO_LEFT&&(k=-1,G=(1-M.x)*P,F=this.paddingRight);for(var V=G+k*F-k*this.spacingX,j=0,H=0,U=0,X=0,Y=0,z=0,W=0,Z=0;Z<N.length;++Z)(ee=N[Z]).activeInHierarchy&&W++;var Q=this.cellSize.width;for(this.type!==_.GRID&&this.resizeMode===w.CHILDREN&&(Q=(P-(this.paddingLeft+this.paddingRight)-(W-1)*this.spacingX)/W),Z=0;Z<N.length;++Z){var ee=N[Z],te=this._getUsedScaleValue(ee.scaleX),re=this._getUsedScaleValue(ee.scaleY);if(ee.activeInHierarchy){this._resize===w.CHILDREN&&(ee.width=Q/te,this.type===_.GRID&&(ee.height=this.cellSize.height/re));var ie=ee.anchorX,ne=ee.width*te,he=ee.height*re;U>H&&(H=U),he>=H&&(U=H,H=he,z=ee.getAnchorPoint().y),this.horizontalDirection===O.RIGHT_TO_LEFT&&(ie=1-ee.anchorX),V=V+k*ie*ne+k*this.spacingX;var pe=k*(1-ie)*ne;if(E){var K=V+pe+k*(k>0?this.paddingRight:this.paddingLeft),ue=this.horizontalDirection===O.LEFT_TO_RIGHT&&K>(1-M.x)*P,le=this.horizontalDirection===O.RIGHT_TO_LEFT&&K<-M.x*P;(ue||le)&&(he>=H?(U===0&&(U=H),j+=U,U=H):(j+=H,U=he,H=0),V=G+k*(F+ie*ne),X++)}var ce=D(ee,j,X);P>=ne+this.paddingLeft+this.paddingRight&&I&&ee.setPosition(cc.v2(V,ce));var _e,oe=1,de=H===0?he:H;this.verticalDirection===A.TOP_TO_BOTTOM?(Y=Y||this.node._contentSize.height,(_e=ce+(oe=-1)*(de*z+this.paddingBottom))<Y&&(Y=_e)):(Y=Y||-this.node._contentSize.height,(_e=ce+oe*(de*z+this.paddingTop))>Y&&(Y=_e)),V+=pe}}return Y},_getVerticalBaseHeight:function(P){var E=0,D=0;if(this.resizeMode===w.CONTAINER){for(var I=0;I<P.length;++I){var M=P[I];M.activeInHierarchy&&(D++,E+=M.height*this._getUsedScaleValue(M.scaleY))}E+=(D-1)*this.spacingY+this.paddingBottom+this.paddingTop}else E=this.node.getContentSize().height;return E},_doLayoutVertically:function(P,E,D,I){var M=this.node.getAnchorPoint(),N=this.node.children,k=1,F=this.paddingBottom,G=-M.y*P;this.verticalDirection===A.TOP_TO_BOTTOM&&(k=-1,G=(1-M.y)*P,F=this.paddingTop);for(var V=G+k*F-k*this.spacingY,j=0,H=0,U=0,X=0,Y=0,z=0,W=0,Z=0;Z<N.length;++Z)(ee=N[Z]).activeInHierarchy&&W++;var Q=this.cellSize.height;for(this.type!==_.GRID&&this.resizeMode===w.CHILDREN&&(Q=(P-(this.paddingTop+this.paddingBottom)-(W-1)*this.spacingY)/W),Z=0;Z<N.length;++Z){var ee=N[Z],te=this._getUsedScaleValue(ee.scaleX),re=this._getUsedScaleValue(ee.scaleY);if(ee.activeInHierarchy){this.resizeMode===w.CHILDREN&&(ee.height=Q/re,this.type===_.GRID&&(ee.width=this.cellSize.width/te));var ie=ee.anchorY,ne=ee.width*te,he=ee.height*re;U>H&&(H=U),ne>=H&&(U=H,H=ne,z=ee.getAnchorPoint().x),this.verticalDirection===A.TOP_TO_BOTTOM&&(ie=1-ee.anchorY),V=V+k*ie*he+k*this.spacingY;var pe=k*(1-ie)*he;if(E){var K=V+pe+k*(k>0?this.paddingTop:this.paddingBottom),ue=this.verticalDirection===A.BOTTOM_TO_TOP&&K>(1-M.y)*P,le=this.verticalDirection===A.TOP_TO_BOTTOM&&K<-M.y*P;(ue||le)&&(ne>=H?(U===0&&(U=H),j+=U,U=H):(j+=H,U=ne,H=0),V=G+k*(F+ie*he),X++)}var ce=D(ee,j,X);P>=he+(this.paddingTop+this.paddingBottom)&&I&&ee.setPosition(cc.v2(ce,V));var _e,oe=1,de=H===0?ne:H;this.horizontalDirection===O.RIGHT_TO_LEFT?(oe=-1,Y=Y||this.node._contentSize.width,(_e=ce+oe*(de*z+this.paddingLeft))<Y&&(Y=_e)):(Y=Y||-this.node._contentSize.width,(_e=ce+oe*(de*z+this.paddingRight))>Y&&(Y=_e)),V+=pe}}return Y},_doLayoutBasic:function(){for(var P=this.node.children,E=null,D=0;D<P.length;++D){var I=P[D];I.activeInHierarchy&&(E?E.union(E,I.getBoundingBoxToWorld()):E=I.getBoundingBoxToWorld())}if(E){var M=this.node.convertToNodeSpaceAR(cc.v2(E.x,E.y));M=cc.v2(M.x-this.paddingLeft,M.y-this.paddingBottom);var N=this.node.convertToNodeSpaceAR(cc.v2(E.xMax,E.yMax)),k=(N=cc.v2(N.x+this.paddingRight,N.y+this.paddingTop)).sub(M);if((k=cc.size(parseFloat(k.x.toFixed(2)),parseFloat(k.y.toFixed(2)))).width!==0){var F=-M.x/k.width;this.node.anchorX=parseFloat(F.toFixed(2))}if(k.height!==0){var G=-M.y/k.height;this.node.anchorY=parseFloat(G.toFixed(2))}this.node.setContentSize(k)}},_doLayoutGridAxisHorizontal:function(P,E){var D=E.width,I=1,M=-P.y*E.height,N=this.paddingBottom;this.verticalDirection===A.TOP_TO_BOTTOM&&(I=-1,M=(1-P.y)*E.height,N=this.paddingTop);var k=(function(V,j,H){return M+I*(j+V.anchorY*V.height*this._getUsedScaleValue(V.scaleY)+N+H*this.spacingY)}).bind(this),F=0;if(this.resizeMode===w.CONTAINER){var G=this._doLayoutHorizontally(D,!0,k,!1);(F=M-G)<0&&(F*=-1),M=-P.y*F,this.verticalDirection===A.TOP_TO_BOTTOM&&(I=-1,M=(1-P.y)*F)}this._doLayoutHorizontally(D,!0,k,!0),this.resizeMode===w.CONTAINER&&this.node.setContentSize(D,F)},_doLayoutGridAxisVertical:function(P,E){var D=E.height,I=1,M=-P.x*E.width,N=this.paddingLeft;this.horizontalDirection===O.RIGHT_TO_LEFT&&(I=-1,M=(1-P.x)*E.width,N=this.paddingRight);var k=(function(V,j,H){return M+I*(j+V.anchorX*V.width*this._getUsedScaleValue(V.scaleX)+N+H*this.spacingX)}).bind(this),F=0;if(this.resizeMode===w.CONTAINER){var G=this._doLayoutVertically(D,!0,k,!1);(F=M-G)<0&&(F*=-1),M=-P.x*F,this.horizontalDirection===O.RIGHT_TO_LEFT&&(I=-1,M=(1-P.x)*F)}this._doLayoutVertically(D,!0,k,!0),this.resizeMode===w.CONTAINER&&this.node.setContentSize(F,D)},_doLayoutGrid:function(){var P=this.node.getAnchorPoint(),E=this.node.getContentSize();this.startAxis===B.HORIZONTAL?this._doLayoutGridAxisHorizontal(P,E):this.startAxis===B.VERTICAL&&this._doLayoutGridAxisVertical(P,E)},_getHorizontalBaseWidth:function(P){var E=0,D=0;if(this.resizeMode===w.CONTAINER){for(var I=0;I<P.length;++I){var M=P[I];M.activeInHierarchy&&(D++,E+=M.width*this._getUsedScaleValue(M.scaleX))}E+=(D-1)*this.spacingX+this.paddingLeft+this.paddingRight}else E=this.node.getContentSize().width;return E},_doLayout:function(){if(this.type===_.HORIZONTAL){var P=this._getHorizontalBaseWidth(this.node.children);this._doLayoutHorizontally(P,!1,function(D){return D.y},!0),this.node.width=P}else if(this.type===_.VERTICAL){var E=this._getVerticalBaseHeight(this.node.children);this._doLayoutVertically(E,!1,function(D){return D.x},!0),this.node.height=E}else this.type===_.NONE?this.resizeMode===w.CONTAINER&&this._doLayoutBasic():this.type===_.GRID&&this._doLayoutGrid()},_getUsedScaleValue:function(P){return this.affectedByScale?Math.abs(P):1},updateLayout:function(){this._layoutDirty&&this.node.children.length>0&&this.node.children.find(function(P){return P.activeInHierarchy})&&(this._doLayout(),this._layoutDirty=!1)}});cc.Layout=S.exports=R},{"../CCNode":29,"./CCComponent":106}],112:[function(L,S){var T=A(L("../../renderer/gfx")),_=A(L("../value-types/mat4")),w=A(L("../value-types/vec2")),B=A(L("../assets/material/material-variant"));function A(G){return G&&G.__esModule?G:{default:G}}var O=L("../utils/misc"),R=L("./CCRenderComponent"),P=L("../renderer/render-flow"),E=L("../graphics/graphics"),D=new w.default,I=new _.default,M=[];function N(G,V,j){M.length=0;for(var H=2*Math.PI/j,U=0;U<j;++U)M.push(cc.v2(V.x*Math.cos(H*U)+G.x,V.y*Math.sin(H*U)+G.y));return M}var k=cc.Enum({RECT:0,ELLIPSE:1,IMAGE_STENCIL:2}),F=cc.Class({name:"cc.Mask",extends:R,editor:!1,ctor:function(){this._graphics=null,this._enableMaterial=null,this._exitMaterial=null,this._clearMaterial=null},properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:k.RECT,type:{get:function(){return this._type},set:function(G){this._type!==G&&this._resetAssembler(),this._type=G,this._type!==k.IMAGE_STENCIL&&(this.spriteFrame=null,this.alphaThreshold=0,this._updateGraphics()),this._activateMaterial()},type:k,tooltip:!1},spriteFrame:{type:cc.SpriteFrame,tooltip:!1,get:function(){return this._spriteFrame},set:function(G){var V=this._spriteFrame;V!==G&&(V&&V.off("load",this.setVertsDirty,this),this._spriteFrame=G,this.setVertsDirty(),this._updateMaterial())}},alphaThreshold:{default:.1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS?this._updateMaterial():cc.warnID(4201)}},inverted:{default:!1,type:cc.Boolean,tooltip:!1,notify:function(){cc.game.renderType===cc.game.RENDER_TYPE_CANVAS&&cc.warnID(4202)}},_segments:64,segements:{get:function(){return this._segments},set:function(G){this._segments=O.clampf(G,3,1e4),this._updateGraphics()},type:cc.Integer,tooltip:!1},_resizeToTarget:{animatable:!1,set:function(G){G&&this._resizeNodeToTargetNode()}}},statics:{Type:k},onRestore:function(){this._activateMaterial()},onEnable:function(){this._super(),this._type!==k.IMAGE_STENCIL?this._updateGraphics():this._spriteFrame&&this._spriteFrame.once("load",this.setVertsDirty,this),this.node.on(cc.Node.EventType.POSITION_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.ROTATION_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.SCALE_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.SIZE_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this._updateGraphics,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.POSITION_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.ROTATION_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.SCALE_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.SIZE_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this._updateGraphics,this),this.node._renderFlag&=~P.FLAG_POST_RENDER},onDestroy:function(){this._super(),this._removeGraphics(),this._spriteFrame&&this._spriteFrame.off("load",this.setVertsDirty,this)},_resizeNodeToTargetNode:!1,_validateRender:function(){if(this._type===k.IMAGE_STENCIL){var G=this._spriteFrame;G&&G.textureLoaded()||this.disableRender()}},_activateMaterial:function(){this._createGraphics();var G=this._materials[0];(G=G?B.default.create(G,this):B.default.createWithBuiltin("2d-sprite",this)).define("USE_ALPHA_TEST",!0),this._type===k.IMAGE_STENCIL?(G.define("CC_USE_MODEL",!1),G.define("USE_TEXTURE",!0)):(G.define("CC_USE_MODEL",!0),G.define("USE_TEXTURE",!1)),this._enableMaterial||(this._enableMaterial=B.default.createWithBuiltin("2d-sprite",this)),this._exitMaterial||(this._exitMaterial=B.default.createWithBuiltin("2d-sprite",this),this._exitMaterial.setStencilEnabled(T.default.STENCIL_DISABLE)),this._clearMaterial||(this._clearMaterial=B.default.createWithBuiltin("clear-stencil",this)),this.setMaterial(0,G),this._graphics._materials[0]=G,this._updateMaterial()},_updateMaterial:function(){var G=this._materials[0];if(G){if(this._type===k.IMAGE_STENCIL&&this.spriteFrame){var V=this.spriteFrame.getTexture();G.setProperty("texture",V)}G.setProperty("alphaThreshold",this.alphaThreshold)}},_createGraphics:function(){this._graphics||(this._graphics=new E,cc.Assembler.init(this._graphics),this._graphics.node=this.node,this._graphics.lineWidth=0,this._graphics.strokeColor=cc.color(0,0,0,0))},_updateGraphics:function(){if(this.enabledInHierarchy){var G=this.node,V=this._graphics;V.clear(!1);var j=G._contentSize.width,H=G._contentSize.height,U=-j*G._anchorPoint.x,X=-H*G._anchorPoint.y;if(this._type===k.RECT)V.rect(U,X,j,H);else if(this._type===k.ELLIPSE){for(var Y=N(cc.v2(U+j/2,X+H/2),{x:j/2,y:H/2},this._segments),z=0;z<Y.length;++z){var W=Y[z];z===0?V.moveTo(W.x,W.y):V.lineTo(W.x,W.y)}V.close()}cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?V.stroke():V.fill(),this.setVertsDirty()}},_removeGraphics:function(){this._graphics&&(this._graphics.destroy(),this._graphics._destroyImmediate(),this._graphics=null)},_hitTest:function(G){var V=this.node,j=V.getContentSize(),H=j.width,U=j.height,X=D;if(V._updateWorldMatrix(),!_.default.invert(I,V._worldMatrix))return!1;w.default.transformMat4(X,G,I),X.x+=V._anchorPoint.x*H,X.y+=V._anchorPoint.y*U;var Y=!1;if(this.type===k.RECT||this.type===k.IMAGE_STENCIL)Y=X.x>=0&&X.y>=0&&X.x<=H&&X.y<=U;else if(this.type===k.ELLIPSE){var z=H/2,W=U/2,Z=X.x-.5*H,Q=X.y-.5*U;Y=Z*Z/(z*z)+Q*Q/(W*W)<1}return this.inverted&&(Y=!Y),Y},markForRender:function(G){var V=P.FLAG_RENDER|P.FLAG_UPDATE_RENDER_DATA|P.FLAG_POST_RENDER;G?(this.node._renderFlag|=V,this.markForValidate()):G||(this.node._renderFlag&=~V)},disableRender:function(){this.node._renderFlag&=~(P.FLAG_RENDER|P.FLAG_UPDATE_RENDER_DATA|P.FLAG_POST_RENDER)}});cc.Mask=S.exports=F},{"../../renderer/gfx":319,"../assets/material/material-variant":88,"../graphics/graphics":159,"../renderer/render-flow":228,"../utils/misc":271,"../value-types/mat4":288,"../value-types/vec2":295,"./CCRenderComponent":117}],113:[function(L,S){var T=L("../components/CCRenderComponent"),_=L("../../core/utils/blend-func"),w=cc.Class({name:"cc.MotionStreak",extends:T,mixins:[_],editor:!1,ctor:function(){this._points=[],this._lastWPos=new cc.Vec2,this._lastWPosUpdated=!1},properties:{preview:{default:!1,editorOnly:!0,notify:!1,animatable:!1},_fadeTime:1,fadeTime:{get:function(){return this._fadeTime},set:function(B){this._fadeTime=B,this.reset()},animatable:!1,tooltip:!1},_minSeg:1,minSeg:{get:function(){return this._minSeg},set:function(B){this._minSeg=B},animatable:!1,tooltip:!1},_stroke:64,stroke:{get:function(){return this._stroke},set:function(B){this._stroke=B},animatable:!1,tooltip:!1},_texture:{default:null,type:cc.Texture2D},texture:{get:function(){return this._texture},set:function(B){this._texture!==B&&(this._texture=B,this._updateMaterial())},type:cc.Texture2D,animatable:!1,tooltip:!1},_color:cc.Color.WHITE,color:{get:function(){return this._color.clone()},set:function(B){this._color.equals(B)||this._color.set(B)},type:cc.Color,tooltip:!1},_fastMode:!1,fastMode:{get:function(){return this._fastMode},set:function(B){this._fastMode=B},animatable:!1,tooltip:!1}},onEnable:function(){this._super(),this.reset()},_updateMaterial:function(){var B=this.getMaterial(0);B&&B.setProperty("texture",this._texture),_.prototype._updateMaterial.call(this)},onFocusInEditor:!1,onLostFocusInEditor:!1,reset:function(){this._points.length=0,this._assembler&&this._assembler._renderData.clear(),this._lastWPosUpdated=!1},lateUpdate:function(B){this._assembler&&this._assembler.update(this,B)}});cc.MotionStreak=S.exports=w},{"../../core/utils/blend-func":265,"../components/CCRenderComponent":117}],114:[function(L,S){var T=cc.Enum({Unified:0,Free:1}),_=cc.Enum({Horizontal:0,Vertical:1}),w=cc.Enum({PAGE_TURNING:0}),B=cc.Class({name:"cc.PageView",extends:cc.ScrollView,editor:!1,ctor:function(){this._curPageIdx=0,this._lastPageIdx=0,this._pages=[],this._initContentPos=cc.v2(),this._scrollCenterOffsetX=[],this._scrollCenterOffsetY=[]},properties:{sizeMode:{default:T.Unified,type:T,tooltip:!1,notify:function(){this._syncSizeMode()}},direction:{default:_.Horizontal,type:_,tooltip:!1,notify:function(){this._syncScrollDirection()}},scrollThreshold:{default:.5,type:cc.Float,slide:!0,range:[0,1,.01],tooltip:!1},autoPageTurningThreshold:{default:100,type:cc.Float,tooltip:!1},pageTurningEventTiming:{default:.1,type:cc.Float,range:[0,1,.01],tooltip:!1},indicator:{default:null,type:cc.PageViewIndicator,tooltip:!1,notify:function(){this.indicator&&this.indicator.setPageView(this)}},pageTurningSpeed:{default:.3,type:cc.Float,tooltip:!1},pageEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{SizeMode:T,Direction:_,EventType:w},onEnable:function(){this._super(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.on("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.off("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onLoad:function(){this._initPages(),this.indicator&&this.indicator.setPageView(this)},getCurrentPageIndex:function(){return this._curPageIdx},setCurrentPageIndex:function(A){this.scrollToPage(A,!0)},getPages:function(){return this._pages},addPage:function(A){A&&this._pages.indexOf(A)===-1&&this.content&&(this.content.addChild(A),this._pages.push(A),this._updatePageView())},insertPage:function(A,O){O<0||!A||this._pages.indexOf(A)!==-1||!this.content||(O>=this._pages.length?this.addPage(A):(this._pages.splice(O,0,A),this.content.addChild(A),this._updatePageView()))},removePage:function(A){if(A&&this.content){var O=this._pages.indexOf(A);O!==-1?this.removePageAtIndex(O):cc.warnID(4300,A.name)}},removePageAtIndex:function(A){var O=this._pages;if(!(A<0||A>=O.length)){var R=O[A];R&&(this.content.removeChild(R),O.splice(A,1),this._updatePageView())}},removeAllPages:function(){if(this.content){for(var A=this._pages,O=0,R=A.length;O<R;O++)this.content.removeChild(A[O]);this._pages.length=0,this._updatePageView()}},scrollToPage:function(A,O){A<0||A>=this._pages.length||(O=O!==void 0?O:.3,this._curPageIdx=A,this.scrollToOffset(this._moveOffsetValue(A),O,!0),this.indicator&&this.indicator._changedState())},getScrollEndedEventTiming:function(){return this.pageTurningEventTiming},_syncScrollDirection:function(){this.horizontal=this.direction===_.Horizontal,this.vertical=this.direction===_.Vertical},_syncSizeMode:function(){if(this.content){var A=this.content.getComponent(cc.Layout);if(A){if(this.sizeMode===T.Free&&this._pages.length>0){var O=this._pages[this._pages.length-1];this.direction===_.Horizontal?(A.paddingLeft=(this._view.width-this._pages[0].width)/2,A.paddingRight=(this._view.width-O.width)/2):this.direction===_.Vertical&&(A.paddingTop=(this._view.height-this._pages[0].height)/2,A.paddingBottom=(this._view.height-O.height)/2)}A.updateLayout()}}},_updatePageView:function(){var A=this.content.getComponent(cc.Layout);A&&A.enabled&&A.updateLayout();var O=this._pages.length;this._curPageIdx>=O&&(this._curPageIdx=O===0?0:O-1,this._lastPageIdx=this._curPageIdx);for(var R=this._initContentPos,P=0;P<O;++P){var E=this._pages[P];E.setSiblingIndex(P),this.direction===_.Horizontal?this._scrollCenterOffsetX[P]=Math.abs(R.x+E.x):this._scrollCenterOffsetY[P]=Math.abs(R.y+E.y)}this.indicator&&this.indicator._refresh()},_updateAllPagesSize:function(){if(this.sizeMode===T.Unified&&this._view)for(var A=this._pages,O=this._view.getContentSize(),R=0,P=A.length;R<P;R++)A[R].setContentSize(O)},_initPages:function(){if(this.content){this._initContentPos=this.content.position;for(var A=this.content.children,O=0;O<A.length;++O){var R=A[O];this._pages.indexOf(R)>=0||this._pages.push(R)}this._syncScrollDirection(),this._syncSizeMode(),this._updatePageView()}},_dispatchPageTurningEvent:function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,cc.Component.EventHandler.emitEvents(this.pageEvents,this,w.PAGE_TURNING),this.node.emit("page-turning",this))},_isScrollable:function(A,O,R){if(this.sizeMode===T.Free){var P,E;if(this.direction===_.Horizontal)return P=this._scrollCenterOffsetX[O],E=this._scrollCenterOffsetX[R],Math.abs(A.x)>=Math.abs(P-E)*this.scrollThreshold;if(this.direction===_.Vertical)return P=this._scrollCenterOffsetY[O],E=this._scrollCenterOffsetY[R],Math.abs(A.y)>=Math.abs(P-E)*this.scrollThreshold}else{if(this.direction===_.Horizontal)return Math.abs(A.x)>=this._view.width*this.scrollThreshold;if(this.direction===_.Vertical)return Math.abs(A.y)>=this._view.height*this.scrollThreshold}},_isQuicklyScrollable:function(A){if(this.direction===_.Horizontal){if(Math.abs(A.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===_.Vertical&&Math.abs(A.y)>this.autoPageTurningThreshold)return!0;return!1},_moveOffsetValue:function(A){var O=cc.v2(0,0);return this.sizeMode===T.Free?this.direction===_.Horizontal?O.x=this._scrollCenterOffsetX[A]:this.direction===_.Vertical&&(O.y=this._scrollCenterOffsetY[A]):this.direction===_.Horizontal?O.x=A*this._view.width:this.direction===_.Vertical&&(O.y=A*this._view.height),O},_getDragDirection:function(A){return this.direction===_.Horizontal?A.x===0?0:A.x>0?1:-1:this.direction===_.Vertical?A.y===0?0:A.y<0?1:-1:void 0},_handleReleaseLogic:function(){this._autoScrollToPage(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent("scroll-ended"))},_autoScrollToPage:function(){if(this._startBounceBackIfNeeded()){var A=this._getHowMuchOutOfBoundary();((A=this._clampDelta(A)).x>0||A.y<0)&&(this._curPageIdx=this._pages.length===0?0:this._pages.length-1),(A.x<0||A.y>0)&&(this._curPageIdx=0),this.indicator&&this.indicator._changedState()}else{var O=this._touchBeganPosition.sub(this._touchEndPosition),R=this._curPageIdx,P=R+this._getDragDirection(O),E=this.pageTurningSpeed*Math.abs(R-P);if(P<this._pages.length){if(this._isScrollable(O,R,P))return void this.scrollToPage(P,E);var D=this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(D))return void this.scrollToPage(P,E)}this.scrollToPage(R,E)}},_onTouchBegan:function(A,O){this._touchBeganPosition=A.touch.getLocation(),this._super(A,O)},_onTouchMoved:function(A,O){this._super(A,O)},_onTouchEnded:function(A,O){this._touchEndPosition=A.touch.getLocation(),this._super(A,O)},_onTouchCancelled:function(A,O){this._touchEndPosition=A.touch.getLocation(),this._super(A,O)},_onMouseWheel:function(){}});cc.PageView=S.exports=B},{}],115:[function(L,S){var T=cc.Enum({HORIZONTAL:0,VERTICAL:1}),_=cc.Class({name:"cc.PageViewIndicator",extends:L("./CCComponent"),editor:!1,properties:{_layout:null,_pageView:null,_indicators:[],spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1},direction:{default:T.HORIZONTAL,type:T,tooltip:!1},cellSize:{default:cc.size(20,20),tooltip:!1},spacing:{default:0,tooltip:!1}},statics:{Direction:T},onLoad:function(){this._updateLayout()},setPageView:function(w){this._pageView=w,this._refresh()},_updateLayout:function(){this._layout=this.getComponent(cc.Layout),this._layout||(this._layout=this.addComponent(cc.Layout)),this.direction===T.HORIZONTAL?(this._layout.type=cc.Layout.Type.HORIZONTAL,this._layout.spacingX=this.spacing):this.direction===T.VERTICAL&&(this._layout.type=cc.Layout.Type.VERTICAL,this._layout.spacingY=this.spacing),this._layout.resizeMode=cc.Layout.ResizeMode.CONTAINER},_createIndicator:function(){var w=new cc.Node,B=w.addComponent(cc.Sprite);return B.spriteFrame=this.spriteFrame,B.sizeMode=cc.Sprite.SizeMode.CUSTOM,w.parent=this.node,w.width=this.cellSize.width,w.height=this.cellSize.height,w},_changedState:function(){var w=this._indicators;if(w.length!==0){var B=this._pageView._curPageIdx;if(!(B>=w.length)){for(var A=0;A<w.length;++A)w[A].opacity=127.5;w[B].opacity=255}}},_refresh:function(){if(this._pageView){var w=this._indicators,B=this._pageView.getPages();if(B.length!==w.length){var A=0;if(B.length>w.length)for(A=0;A<B.length;++A)w[A]||(w[A]=this._createIndicator());else for(A=w.length-B.length;A>0;--A){var O=w[A-1];this.node.removeChild(O),w.splice(A-1,1)}this._layout&&this._layout.enabledInHierarchy&&this._layout.updateLayout(),this._changedState()}}}});cc.PageViewIndicator=S.exports=_},{"./CCComponent":106}],116:[function(L,S){var T=L("../utils/misc"),_=L("./CCComponent"),w=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2}),B=cc.Class({name:"cc.ProgressBar",extends:_,editor:!1,_initBarSprite:function(){if(this.barSprite){var A=this.barSprite.node;if(!A)return;var O=this.node.getContentSize(),R=this.node.getAnchorPoint(),P=A.getContentSize();A.parent===this.node&&this.node.setContentSize(P),this.barSprite.fillType===cc.Sprite.FillType.RADIAL&&(this.mode=w.FILLED);var E=A.getContentSize();if(this.mode===w.HORIZONTAL?this.totalLength=E.width:this.mode===w.VERTICAL?this.totalLength=E.height:this.totalLength=this.barSprite.fillRange,A.parent===this.node){var D=-O.width*R.x;A.setPosition(cc.v2(D,0))}}},_updateBarStatus:function(){if(this.barSprite){var A=this.barSprite.node;if(!A)return;var O,R,P,E=A.getAnchorPoint(),D=A.getContentSize(),I=A.getPosition(),M=cc.v2(0,.5),N=T.clamp01(this.progress),k=this.totalLength*N;switch(this.mode){case w.HORIZONTAL:this.reverse&&(M=cc.v2(1,.5)),O=cc.size(k,D.height),R=this.totalLength,P=D.height;break;case w.VERTICAL:M=this.reverse?cc.v2(.5,1):cc.v2(.5,0),O=cc.size(D.width,k),R=D.width,P=this.totalLength}if(this.mode===w.FILLED)this.barSprite.type!==cc.Sprite.Type.FILLED?cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this.reverse&&(k*=-1),this.barSprite.fillRange=k);else if(this.barSprite.type!==cc.Sprite.Type.FILLED){var F=M.x-E.x,G=M.y-E.y,V=cc.v2(R*F,P*G);A.setPosition(I.x+V.x,I.y+V.y),A.setAnchorPoint(M),A.setContentSize(O)}else cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}},properties:{barSprite:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._initBarSprite()},animatable:!1},mode:{default:w.HORIZONTAL,type:w,tooltip:!1,notify:function(){if(this.barSprite){var A=this.barSprite.node;if(!A)return;var O=A.getContentSize();this.mode===w.HORIZONTAL?this.totalLength=O.width:this.mode===w.VERTICAL?this.totalLength=O.height:this.mode===w.FILLED&&(this.totalLength=this.barSprite.fillRange)}},animatable:!1},_N$totalLength:1,totalLength:{range:[0,Number.MAX_VALUE],tooltip:!1,get:function(){return this._N$totalLength},set:function(A){this.mode===w.FILLED&&(A=T.clamp01(A)),this._N$totalLength=A,this._updateBarStatus()}},progress:{default:1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateBarStatus()}},reverse:{default:!1,tooltip:!1,notify:function(){this.barSprite&&(this.barSprite.fillStart=1-this.barSprite.fillStart),this._updateBarStatus()},animatable:!1}},statics:{Mode:w}});cc.ProgressBar=S.exports=B},{"../utils/misc":271,"./CCComponent":106}],117:[function(L,S){var T=B(L("../renderer/assembler")),_=B(L("../assets/material/material-variant")),w=L("../value-types");function B(D){return D&&D.__esModule?D:{default:D}}var A=L("./CCComponent"),O=L("../renderer/render-flow"),R=L("../assets/material/CCMaterial"),P=new w.Color,E=cc.Class({name:"RenderComponent",extends:A,editor:!1,properties:{_materials:{default:[],type:R},materials:{get:function(){return this._materials},set:function(D){this._materials=D,this._activateMaterial()},type:[R],displayName:"Materials",animatable:!1}},ctor:function(){this._vertsDirty=!0,this._assembler=null},_resetAssembler:function(){T.default.init(this),this._updateColor(),this.setVertsDirty()},__preload:function(){this._resetAssembler(),this._activateMaterial()},onEnable:function(){this.node._renderComponent&&(this.node._renderComponent.enabled=!1),this.node._renderComponent=this,this.node._renderFlag|=O.FLAG_OPACITY_COLOR,this.setVertsDirty()},onDisable:function(){this.node._renderComponent=null,this.disableRender()},onDestroy:function(){for(var D=this._materials,I=0;I<D.length;I++)cc.pool.material.put(D[I]);D.length=0,cc.pool.assembler.put(this._assembler),this.disableRender()},setVertsDirty:function(){this._vertsDirty=!0,this.markForRender(!0)},_on3DNodeChanged:function(){this._resetAssembler()},_validateRender:function(){},markForValidate:function(){cc.RenderFlow.registerValidate(this)},markForRender:function(D){var I=O.FLAG_RENDER|O.FLAG_UPDATE_RENDER_DATA;D?(this.node._renderFlag|=I,this.markForValidate()):this.node._renderFlag&=~I},disableRender:function(){this.node._renderFlag&=~(O.FLAG_RENDER|O.FLAG_UPDATE_RENDER_DATA)},getMaterial:function(D){if(D<0||D>=this._materials.length)return null;var I=this._materials[D];if(!I)return null;var M=_.default.create(I,this);return M!==I&&this.setMaterial(D,M),M},getMaterials:function(){for(var D=this._materials,I=0;I<D.length;I++)D[I]=_.default.create(D[I],this);return D},setMaterial:function(D,I){return I!==this._materials[D]&&(I=_.default.create(I,this),this._materials[D]=I),this._updateMaterial(),this.markForRender(!0),I},_getDefaultMaterial:function(){return R.getBuiltinMaterial("2d-sprite")},_activateMaterial:function(){var D=this._materials;if(!D[0]){var I=this._getDefaultMaterial();D[0]=I}for(var M=0;M<D.length;M++)D[M]=_.default.create(D[M],this);this._updateMaterial()},_updateMaterial:function(){},_updateColor:function(){if(this._assembler.updateColor){var D=this.srcBlendFactor===cc.macro.BlendFactor.ONE;D&&w.Color.premultiplyAlpha(P,this.node._color);var I=D?P._val:null;this._assembler.updateColor(this,I)}},_checkBacth:function(D,I){var M=this._materials[0];(M&&M.getHash()!==D.material.getHash()||D.cullingMask!==I)&&(D._flush(),D.node=M.getDefine("CC_USE_MODEL")?this.node:D._dummyNode,D.material=M,D.cullingMask=I)}});cc.RenderComponent=S.exports=E},{"../assets/material/CCMaterial":81,"../assets/material/material-variant":88,"../renderer/assembler":224,"../renderer/render-flow":228,"../value-types":286,"./CCComponent":106}],118:[function(L,S){var T=L("../platform/js"),_=L("../platform/CCMacro"),w=L("../utils/text-utils"),B=new(L("../utils/html-text-parser")),A=_.TextAlignment,O=_.VerticalTextAlignment,R=cc.Label.CacheMode,P=new T.Pool(function(D){if(!cc.isValid(D))return!1;var I=D.getComponent(cc.LabelOutline);return I&&(I.width=0),!0},20);P.get=function(){var D=this._get();D||((D=new cc.PrivateNode("RICHTEXT_CHILD"))._objFlags|=cc.Object.Flags.DontSave),D.setPosition(0,0),D.setAnchorPoint(.5,.5),D.skewX=0;var I=D.getComponent(cc.Label);return I||(I=D.addComponent(cc.Label)),I.string="",I.horizontalAlign=A.LEFT,I.verticalAlign=O.CENTER,I._forceUseCanvas=!0,D};var E=cc.Class({name:"cc.RichText",extends:cc.Component,ctor:function(){this._textArray=null,this._labelSegments=[],this._labelSegmentsCache=[],this._linesWidth=[],this._updateRichTextStatus=this._updateRichText},editor:!1,properties:{string:{default:"<color=#00ff00>Rich</c><color=#0fffff>Text</color>",multiline:!0,tooltip:!1,notify:function(){this._updateRichTextStatus()}},horizontalAlign:{default:A.LEFT,type:A,tooltip:!1,animatable:!1,notify:function(D){this.horizontalAlign!==D&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{default:40,tooltip:!1,notify:function(D){this.fontSize!==D&&(this._layoutDirty=!0,this._updateRichTextStatus())}},_fontFamily:"Arial",fontFamily:{tooltip:!1,get:function(){return this._fontFamily},set:function(D){this._fontFamily!==D&&(this._fontFamily=D,this._layoutDirty=!0,this._updateRichTextStatus())},animatable:!1},font:{default:null,type:cc.TTFFont,tooltip:!1,notify:function(D){this.font!==D&&(this._layoutDirty=!0,this.font?(this.useSystemFont=!1,this._onTTFLoaded()):this.useSystemFont=!0,this._updateRichTextStatus())}},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(D){this._isSystemFontUsed!==D&&(this._isSystemFontUsed=D,this._layoutDirty=!0,this._updateRichTextStatus())},animatable:!1,tooltip:!1},cacheMode:{default:R.NONE,type:R,tooltip:!1,notify:function(D){this.cacheMode!==D&&this._updateRichTextStatus()},animatable:!1},maxWidth:{default:0,tooltip:!1,notify:function(D){this.maxWidth!==D&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{default:40,tooltip:!1,notify:function(D){this.lineHeight!==D&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,notify:function(D){this.imageAtlas!==D&&(this._layoutDirty=!0,this._updateRichTextStatus())}},handleTouchEvent:{default:!0,tooltip:!1,notify:function(D){this.handleTouchEvent!==D&&this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners())}}},statics:{HorizontalAlign:A,VerticalAlign:O},onEnable:function(){this.handleTouchEvent&&this._addEventListeners(),this._onTTFLoaded(),this._activateChildren(!0)},onDisable:function(){this.handleTouchEvent&&this._removeEventListeners(),this._activateChildren(!1)},_onColorChanged:function(D){this.node.children.forEach(function(I){I.color=D})},_addEventListeners:function(){this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_removeEventListeners:function(){this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach((function(D){this._applyTextAttribute(D,null,!0)}).bind(this))},_createFontLabel:function(D){return P.get(D,this)},_onTTFLoaded:function(){if(this.font instanceof cc.TTFFont)if(this.font._nativeAsset)this._layoutDirty=!0,this._updateRichTextStatus();else{var D=this;cc.assetManager.postLoadNative(this.font,function(){D._layoutDirty=!0,D._updateRichTextStatus()})}else this._layoutDirty=!0,this._updateRichTextStatus()},_measureText:function(D,I){var M=this,N=function(k){var F;return M._labelSegmentsCache.length===0?(F=M._createFontLabel(k),M._labelSegmentsCache.push(F)):F=M._labelSegmentsCache[0],F._styleIndex=D,M._applyTextAttribute(F,k,!0),F.getContentSize().width};return I?N(I):N},_onTouchEnded:function(D){for(var I=this,M=this.node.getComponents(cc.Component),N=function(F){var G=I._labelSegments[F],V=G._clickHandler,j=G._clickParam;V&&I._containsTouchLocation(G,D.touch.getLocation())&&(M.forEach(function(H){H.enabledInHierarchy&&H[V]&&H[V](D,j)}),D.stopPropagation())},k=0;k<this._labelSegments.length;++k)N(k)},_containsTouchLocation:function(D,I){return D.getBoundingBoxToWorld().contains(I)},_resetState:function(){for(var D=this.node.children,I=D.length-1;I>=0;I--){var M=D[I];M.name!=="RICHTEXT_CHILD"&&M.name!=="RICHTEXT_Image_CHILD"||(M.parent===this.node?M.parent=null:D.splice(I,1),M.name==="RICHTEXT_CHILD"&&P.put(M))}this._labelSegments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},onRestore:!1,_activateChildren:function(D){for(var I=this.node.children.length-1;I>=0;I--){var M=this.node.children[I];M.name!=="RICHTEXT_CHILD"&&M.name!=="RICHTEXT_Image_CHILD"||(M.active=D)}},_addLabelSegment:function(D,I){var M;return(M=this._labelSegmentsCache.length===0?this._createFontLabel(D):this._labelSegmentsCache.pop())._styleIndex=I,M._lineCount=this._lineCount,M.active=this.node.active,M.setAnchorPoint(0,0),this._applyTextAttribute(M,D,!1),this.node.addChild(M),this._labelSegments.push(M),M},_updateRichTextWithMaxWidth:function(D,I,M){var N=I;if(this._lineOffsetX>0&&N+this._lineOffsetX>this.maxWidth)for(var k=0;this._lineOffsetX<=this.maxWidth;){var F=this._getFirstWordLen(D,k,D.length),G=D.substr(k,F),V=this._measureText(M,G);if(!(this._lineOffsetX+V<=this.maxWidth)){if(k>0){var j=D.substr(0,k);this._addLabelSegment(j,M),D=D.substr(k,D.length),N=this._measureText(M,D)}this._updateLineInfo();break}this._lineOffsetX+=V,k+=F}if(N>this.maxWidth)for(var H=w.fragmentText(D,N,this.maxWidth,this._measureText(M)),U=0;U<H.length;++U){var X=H[U],Y=this._addLabelSegment(X,M).getContentSize();this._lineOffsetX+=Y.width,H.length>1&&U<H.length-1&&this._updateLineInfo()}else this._lineOffsetX+=N,this._addLabelSegment(D,M)},_isLastComponentCR:function(D){return D.length-1===D.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},_needsUpdateTextLayout:function(D){if(this._layoutDirty||!this._textArray||!D||this._textArray.length!==D.length)return!0;for(var I=0;I<this._textArray.length;++I){var M=this._textArray[I],N=D[I];if(M.text!==N.text)return!0;var k=M.style,F=N.style;if(k){if(F){if(!k.outline!=!F.outline||k.size!==F.size||!k.italic!=!F.italic||k.isImage!==F.isImage||k.src!==F.src||k.imageAlign!==F.imageAlign||k.imageHeight!==F.imageHeight||k.imageWidth!==F.imageWidth||k.imageOffset!==F.imageOffset)return!0}else if(k.size||k.italic||k.isImage||k.outline)return!0}else if(F&&(F.size||F.italic||F.isImage||F.outline))return!0}return!1},_addRichTextImageElement:function(D){var I=D.style.src,M=this.imageAtlas.getSpriteFrame(I);if(M){var N=new cc.PrivateNode("RICHTEXT_Image_CHILD");N._objFlags|=cc.Object.Flags.DontSave;var k=N.addComponent(cc.Sprite);switch(D.style.imageAlign){case"top":N.setAnchorPoint(0,1);break;case"center":N.setAnchorPoint(0,.5);break;default:N.setAnchorPoint(0,0)}D.style.imageOffset&&(N._imageOffset=D.style.imageOffset),k.type=cc.Sprite.Type.SLICED,k.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node.addChild(N),this._labelSegments.push(N);var F=M.getRect(),G=1,V=F.width,j=F.height,H=D.style.imageWidth,U=D.style.imageHeight;U>0?(V*=G=U/j,j*=G):(V*=G=this.lineHeight/j,j*=G),H>0&&(V=H),this.maxWidth>0?(this._lineOffsetX+V>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=V):(this._lineOffsetX+=V,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),k.spriteFrame=M,N.setContentSize(V,j),N._lineCount=this._lineCount,D.style.event?(D.style.event.click&&(N._clickHandler=D.style.event.click),D.style.event.param?N._clickParam=D.style.event.param:N._clickParam=""):N._clickHandler=null}else cc.warnID(4400)},_updateRichText:function(){if(this.enabledInHierarchy){var D=B.parse(this.string);if(!this._needsUpdateTextLayout(D))return this._textArray=D,void this._updateLabelSegmentTextAttributes();this._textArray=D,this._resetState();for(var I,M=!1,N=0;N<this._textArray.length;++N){var k=this._textArray[N],F=k.text;if(F===""){if(k.style&&k.style.newline){this._updateLineInfo();continue}if(k.style&&k.style.isImage&&this.imageAtlas){this._addRichTextImageElement(k);continue}}for(var G=F.split("\n"),V=0;V<G.length;++V){var j=G[V];if(j!=="")if(M=!1,this.maxWidth>0){var H=this._measureText(N,j);this._updateRichTextWithMaxWidth(j,H,N),G.length>1&&V<G.length-1&&this._updateLineInfo()}else I=this._addLabelSegment(j,N).getContentSize(),this._lineOffsetX+=I.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),G.length>1&&V<G.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(F)&&V===G.length-1)continue;this._updateLineInfo(),M=!0}}}M||this._linesWidth.push(this._lineOffsetX),this.maxWidth>0&&(this._labelWidth=this.maxWidth),this._labelHeight=(this._lineCount+w.BASELINE_RATIO)*this.lineHeight,this.node.setContentSize(this._labelWidth,this._labelHeight),this._updateRichTextPosition(),this._layoutDirty=!1}},_getFirstWordLen:function(D,I,M){var N=D.charAt(I);if(w.isUnicodeCJK(N)||w.isUnicodeSpace(N))return 1;for(var k=1,F=I+1;F<M&&(N=D.charAt(F),!w.isUnicodeSpace(N)&&!w.isUnicodeCJK(N));++F)k++;return k},_updateRichTextPosition:function(){for(var D=0,I=1,M=this._lineCount,N=0;N<this._labelSegments.length;++N){var k=this._labelSegments[N],F=k._lineCount;F>I&&(D=0,I=F);var G=0;switch(this.horizontalAlign){case A.LEFT:G=-this._labelWidth/2;break;case A.CENTER:G=-this._linesWidth[F-1]/2;break;case A.RIGHT:G=this._labelWidth/2-this._linesWidth[F-1]}k.x=D+G;var V=k.getContentSize();if(k.y=this.lineHeight*(M-F)-this._labelHeight/2,F===I&&(D+=V.width),k.getComponent(cc.Sprite)){var j=this.lineHeight,H=this.lineHeight*(1+w.BASELINE_RATIO);switch(k.anchorY){case 1:k.y+=j+(H-j)/2;break;case .5:k.y+=H/2;break;default:k.y+=(H-j)/2}if(k._imageOffset){var U=k._imageOffset.split(",");if(U.length===1&&U[0]){var X=parseFloat(U[0]);Number.isInteger(X)&&(k.y+=X)}else if(U.length===2){var Y=parseFloat(U[0]),z=parseFloat(U[1]);Number.isInteger(Y)&&(k.x+=Y),Number.isInteger(z)&&(k.y+=z)}}}var W=k.getComponent(cc.LabelOutline);W&&W.width&&(k.y=k.y-W.width)}},_convertLiteralColorValue:function(D){var I=D.toUpperCase();return cc.Color[I]?cc.Color[I]:cc.color().fromHEX(D)},_applyTextAttribute:function(D,I,M){var N=D.getComponent(cc.Label);if(N){var k=D._styleIndex,F=null;if(this._textArray[k]&&(F=this._textArray[k].style),F&&F.color?D.color=this._convertLiteralColorValue(F.color):D.color=this.node.color,N.cacheMode=this.cacheMode,this.font instanceof cc.Font&&!this._isSystemFontUsed?N.font=this.font:N.fontFamily=this.fontFamily,N.useSystemFont=this._isSystemFontUsed,N.lineHeight=this.lineHeight,N.enableBold=F&&F.bold,N.enableItalics=F&&F.italic,F&&F.italic&&(D.skewX=12),N.enableUnderline=F&&F.underline,F&&F.outline){var G=D.getComponent(cc.LabelOutline);G||(G=D.addComponent(cc.LabelOutline)),G.color=this._convertLiteralColorValue(F.outline.color),G.width=F.outline.width}F&&F.size?N.fontSize=F.size:N.fontSize=this.fontSize,I!==null&&(typeof I!="string"&&(I=""+I),N.string=I),M&&N._forceUpdateRenderData(),F&&F.event?(F.event.click&&(D._clickHandler=F.event.click),F.event.param?D._clickParam=F.event.param:D._clickParam=""):D._clickHandler=null}},onDestroy:function(){for(var D=0;D<this._labelSegments.length;++D)this._labelSegments[D].removeFromParent(),P.put(this._labelSegments[D])}});cc.RichText=S.exports=E},{"../platform/CCMacro":201,"../platform/js":217,"../utils/html-text-parser":269,"../utils/text-utils":278}],119:[function(L,S){var T=L("./CCWidget"),_=L("../base-ui/CCWidgetManager"),w=cc.Class({name:"cc.SafeArea",extends:L("./CCComponent"),editor:!1,onEnable:function(){this.updateArea(),cc.view.on("canvas-resize",this.updateArea,this)},onDisable:function(){cc.view.off("canvas-resize",this.updateArea,this)},updateArea:function(){var B=this.node.getComponent(T);if(B){B.updateAlignment();var A=this.node.position,O=this.node.getAnchorPoint();B.isAlignTop=B.isAlignBottom=B.isAlignLeft=B.isAlignRight=!0;var R=cc.winSize.width,P=cc.winSize.height,E=cc.sys.getSafeAreaRect();B.top=P-E.y-E.height,B.bottom=E.y,B.left=E.x,B.right=R-E.x-E.width,B.updateAlignment();var D=this.node.position,I=O.x-(D.x-A.x)/this.node.width,M=O.y-(D.y-A.y)/this.node.height;this.node.setAnchorPoint(I,M),_.add(B)}}});cc.SafeArea=S.exports=w},{"../base-ui/CCWidgetManager":90,"./CCComponent":106,"./CCWidget":129}],120:[function(L,S){var T=L("../utils/misc"),_=(L("./CCComponent"),cc.Enum({HORIZONTAL:0,VERTICAL:1})),w=cc.Class({name:"cc.Scrollbar",extends:L("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{default:0,serializable:!1},_opacity:255,handle:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._onScroll(cc.v2(0,0))},animatable:!1},direction:{default:_.HORIZONTAL,type:_,tooltip:!1,notify:function(){this._onScroll(cc.v2(0,0))},animatable:!1},enableAutoHide:{default:!0,animatable:!1,tooltip:!1},autoHideTime:{default:1,animatable:!1,tooltip:!1}},statics:{Direction:_},setTargetScrollView:function(B){this._scrollView=B},_convertToScrollViewSpace:function(B){var A=this._scrollView.node,O=B.convertToWorldSpaceAR(cc.v2(-B.anchorX*B.width,-B.anchorY*B.height)),R=A.convertToNodeSpaceAR(O);return R.x+=A.anchorX*A.width,R.y+=A.anchorY*A.height,R},_setOpacity:function(B){this.handle&&(this.node.opacity=B,this.handle.node.opacity=B)},_onScroll:function(B){if(this._scrollView){var A=this._scrollView.content;if(A){var O=A.getContentSize(),R=this._scrollView.node.getContentSize(),P=this.node.getContentSize();if(this._conditionalDisableScrollBar(O,R))return;this.enableAutoHide&&(this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity));var E=0,D=0,I=0,M=0,N=0;this.direction===_.HORIZONTAL?(E=O.width,D=R.width,N=P.width,I=B.x,M=-this._convertToScrollViewSpace(A).x):this.direction===_.VERTICAL&&(E=O.height,D=R.height,N=P.height,I=B.y,M=-this._convertToScrollViewSpace(A).y);var k=this._calculateLength(E,D,N,I),F=this._calculatePosition(E,D,N,M,I,k);this._updateLength(k),this._updateHanlderPosition(F)}}},_updateHanlderPosition:function(B){if(this.handle){var A=this._fixupHandlerPosition();this.handle.node.setPosition(B.x+A.x,B.y+A.y)}},_fixupHandlerPosition:function(){var B=this.node.getContentSize(),A=this.node.getAnchorPoint(),O=this.handle.node.getContentSize(),R=this.handle.node.parent,P=this.node.convertToWorldSpaceAR(cc.v2(-B.width*A.x,-B.height*A.y)),E=R.convertToNodeSpaceAR(P);return this.direction===_.HORIZONTAL?E=cc.v2(E.x,E.y+(B.height-O.height)/2):this.direction===_.VERTICAL&&(E=cc.v2(E.x+(B.width-O.width)/2,E.y)),this.handle.node.setPosition(E),E},_onTouchBegan:function(){this.enableAutoHide&&(this._touching=!0)},_conditionalDisableScrollBar:function(B,A){return B.width<=A.width&&this.direction===_.HORIZONTAL||B.height<=A.height&&this.direction===_.VERTICAL},_onTouchEnded:function(){if(this.enableAutoHide&&(this._touching=!1,!(this.autoHideTime<=0))){if(this._scrollView){var B=this._scrollView.content;if(B){var A=B.getContentSize(),O=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(A,O))return}}this._autoHideRemainingTime=this.autoHideTime}},_calculateLength:function(B,A,O,R){var P=B;return R&&(P+=20*(R>0?R:-R)),O*(A/P)},_calculatePosition:function(B,A,O,R,P,E){var D=B-A;P&&(D+=Math.abs(P));var I=0;D&&(I=R/D,I=T.clamp01(I));var M=(O-E)*I;return this.direction===_.VERTICAL?cc.v2(0,M):cc.v2(M,0)},_updateLength:function(B){if(this.handle){var A=this.handle.node,O=A.getContentSize();A.setAnchorPoint(cc.v2(0,0)),this.direction===_.HORIZONTAL?A.setContentSize(B,O.height):A.setContentSize(O.width,B)}},_processAutoHide:function(B){if(this.enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autoHideRemainingTime-=B,this._autoHideRemainingTime<=this.autoHideTime)){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var A=this._opacity*(this._autoHideRemainingTime/this.autoHideTime);this._setOpacity(A)}},start:function(){this.enableAutoHide&&this._setOpacity(0)},hide:function(){this._autoHideRemainingTime=0,this._setOpacity(0)},show:function(){this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity)},update:function(B){this._processAutoHide(B)}});cc.Scrollbar=S.exports=w},{"../utils/misc":271,"./CCComponent":106}],121:[function(L,S){var T=L("../CCNode").EventType,_=cc.v2(),w=cc.v2(),B=function(){return new Date().getMilliseconds()},A=cc.Enum({SCROLL_TO_TOP:0,SCROLL_TO_BOTTOM:1,SCROLL_TO_LEFT:2,SCROLL_TO_RIGHT:3,SCROLLING:4,BOUNCE_TOP:5,BOUNCE_BOTTOM:6,BOUNCE_LEFT:7,BOUNCE_RIGHT:8,SCROLL_ENDED:9,TOUCH_UP:10,AUTOSCROLL_ENDED_WITH_THRESHOLD:11,SCROLL_BEGAN:12}),O={"scroll-to-top":A.SCROLL_TO_TOP,"scroll-to-bottom":A.SCROLL_TO_BOTTOM,"scroll-to-left":A.SCROLL_TO_LEFT,"scroll-to-right":A.SCROLL_TO_RIGHT,scrolling:A.SCROLLING,"bounce-bottom":A.BOUNCE_BOTTOM,"bounce-left":A.BOUNCE_LEFT,"bounce-right":A.BOUNCE_RIGHT,"bounce-top":A.BOUNCE_TOP,"scroll-ended":A.SCROLL_ENDED,"touch-up":A.TOUCH_UP,"scroll-ended-with-threshold":A.AUTOSCROLL_ENDED_WITH_THRESHOLD,"scroll-began":A.SCROLL_BEGAN},R=cc.Class({name:"cc.ScrollView",extends:L("./CCViewGroup"),editor:!1,ctor:function(){this._topBoundary=0,this._bottomBoundary=0,this._leftBoundary=0,this._rightBoundary=0,this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._touchMoved=!1,this._autoScrolling=!1,this._autoScrollAttenuate=!1,this._autoScrollStartPosition=cc.v2(0,0),this._autoScrollTargetDelta=cc.v2(0,0),this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0,this._autoScrollCurrentlyOutOfBoundary=!1,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.v2(0,0),this._outOfBoundaryAmount=cc.v2(0,0),this._outOfBoundaryAmountDirty=!0,this._stopMouseWheel=!1,this._mouseWheelEventElapsedTime=0,this._isScrollEndedWithThresholdEventFired=!1,this._scrollEventEmitMask=0,this._isBouncing=!1,this._scrolling=!1},properties:{content:{default:void 0,type:cc.Node,tooltip:!1,formerlySerializedAs:"content",notify:function(){this._calculateBoundary()}},horizontal:{default:!0,animatable:!1,tooltip:!1},vertical:{default:!0,animatable:!1,tooltip:!1},inertia:{default:!0,tooltip:!1},brake:{default:.5,type:cc.Float,range:[0,1,.1],tooltip:!1},elastic:{default:!0,animatable:!1,tooltip:!1},bounceDuration:{default:1,range:[0,10],tooltip:!1},horizontalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.horizontalScrollBar&&(this.horizontalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},verticalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.verticalScrollBar&&(this.verticalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},scrollEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1},cancelInnerEvents:{default:!0,animatable:!1,tooltip:!1},_view:{get:function(){if(this.content)return this.content.parent}}},statics:{EventType:A},scrollToBottom:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!1,applyToVertical:!0});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D,!0)},scrollToTop:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(0,1),applyToHorizontal:!1,applyToVertical:!0});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D)},scrollToLeft:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!0,applyToVertical:!1});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D)},scrollToRight:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(1,0),applyToHorizontal:!0,applyToVertical:!1});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D)},scrollToTopLeft:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(0,1),applyToHorizontal:!0,applyToVertical:!0});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D)},scrollToTopRight:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(1,1),applyToHorizontal:!0,applyToVertical:!0});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D)},scrollToBottomLeft:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!0,applyToVertical:!0});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D)},scrollToBottomRight:function(P,E){var D=this._calculateMovePercentDelta({anchor:cc.v2(1,0),applyToHorizontal:!0,applyToVertical:!0});P?this._startAutoScroll(D,P,E!==!1):this._moveContent(D)},scrollToOffset:function(P,E,D){var I=this.getMaxScrollOffset(),M=cc.v2(0,0);I.x===0?M.x=0:M.x=P.x/I.x,I.y===0?M.y=1:M.y=(I.y-P.y)/I.y,this.scrollTo(M,E,D)},getScrollOffset:function(){var P=this._getContentTopBoundary()-this._topBoundary,E=this._getContentLeftBoundary()-this._leftBoundary;return cc.v2(E,P)},getMaxScrollOffset:function(){var P=this._view.getContentSize(),E=this.content.getContentSize(),D=E.width-P.width,I=E.height-P.height;return D=D>=0?D:0,I=I>=0?I:0,cc.v2(D,I)},scrollToPercentHorizontal:function(P,E,D){var I=this._calculateMovePercentDelta({anchor:cc.v2(P,0),applyToHorizontal:!0,applyToVertical:!1});E?this._startAutoScroll(I,E,D!==!1):this._moveContent(I)},scrollTo:function(P,E,D){var I=this._calculateMovePercentDelta({anchor:cc.v2(P),applyToHorizontal:!0,applyToVertical:!0});E?this._startAutoScroll(I,E,D!==!1):this._moveContent(I)},scrollToPercentVertical:function(P,E,D){var I=this._calculateMovePercentDelta({anchor:cc.v2(0,P),applyToHorizontal:!1,applyToVertical:!0});E?this._startAutoScroll(I,E,D!==!1):this._moveContent(I)},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},setContentPosition:function(P){P.fuzzyEquals(this.getContentPosition(),1e-4)||(this.content.setPosition(P),this._outOfBoundaryAmountDirty=!0)},getContentPosition:function(){return this.content.getPosition()},isScrolling:function(){return this._scrolling},isAutoScrolling:function(){return this._autoScrolling},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.off(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_onMouseWheel:function(P,E){if(this.enabledInHierarchy&&!this.hasNestedViewGroup(P,E)){var D=cc.v2(0,0),I=-.1;cc.sys.os===cc.sys.OS_WINDOWS&&cc.sys.browserType===cc.sys.BROWSER_TYPE_FIREFOX&&(I=-.1/3),this.vertical?D=cc.v2(0,P.getScrollY()*I):this.horizontal&&(D=cc.v2(P.getScrollY()*I,0)),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(D),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(P)}},_checkMouseWheel:function(P){if(!this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1e-4))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),this._dispatchEvent("scroll-ended"),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=P,this._mouseWheelEventElapsedTime>.1&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._dispatchEvent("scroll-ended"),this._stopMouseWheel=!1)},_calculateMovePercentDelta:function(P){var E=P.anchor,D=P.applyToHorizontal,I=P.applyToVertical;this._calculateBoundary(),E=E.clampf(cc.v2(0,0),cc.v2(1,1));var M=this._view.getContentSize(),N=this.content.getContentSize(),k=this._getContentBottomBoundary()-this._bottomBoundary;k=-k;var F=this._getContentLeftBoundary()-this._leftBoundary;F=-F;var G=cc.v2(0,0),V=0;return D&&(V=N.width-M.width,G.x=F-V*E.x),I&&(V=N.height-M.height,G.y=k-V*E.y),G},_moveContentToTopLeft:function(P){var E=this.content.getContentSize(),D=this._getContentBottomBoundary()-this._bottomBoundary;D=-D;var I=cc.v2(0,0),M=0,N=this._getContentLeftBoundary()-this._leftBoundary;N=-N,E.height<P.height&&(M=E.height-P.height,I.y=D-M),E.width<P.width&&(M=E.width-P.width,I.x=N),this._updateScrollBarState(),this._moveContent(I),this._adjustContentOutOfBoundary()},_calculateBoundary:function(){if(this.content){var P=this.content.getComponent(cc.Layout);P&&P.enabledInHierarchy&&P.updateLayout();var E=this._view.getContentSize(),D=E.width*this._view.anchorX,I=E.height*this._view.anchorY;this._leftBoundary=-D,this._bottomBoundary=-I,this._rightBoundary=this._leftBoundary+E.width,this._topBoundary=this._bottomBoundary+E.height,this._moveContentToTopLeft(E)}},hasNestedViewGroup:function(P,E){if(P.eventPhase===cc.Event.CAPTURING_PHASE){if(E)for(var D=0;D<E.length;++D){var I=E[D];if(this.node===I)return!!P.target.getComponent(cc.ViewGroup);if(I.getComponent(cc.ViewGroup))return!0}return!1}},_stopPropagationIfTargetIsMe:function(P){P.eventPhase===cc.Event.AT_TARGET&&P.target===this.node&&P.stopPropagation()},_onTouchBegan:function(P,E){if(this.enabledInHierarchy&&!this.hasNestedViewGroup(P,E)){var D=P.touch;this.content&&this._handlePressLogic(D),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(P)}},_onTouchMoved:function(P,E){if(this.enabledInHierarchy&&!this.hasNestedViewGroup(P,E)){var D=P.touch;if(this.content&&this._handleMoveLogic(D),this.cancelInnerEvents){if(D.getLocation().sub(D.getStartLocation()).mag()>7&&!this._touchMoved&&P.target!==this.node){var I=new cc.Event.EventTouch(P.getTouches(),P.bubbles);I.type=cc.Node.EventType.TOUCH_CANCEL,I.touch=P.touch,I.simulate=!0,P.target.dispatchEvent(I),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(P)}}},_onTouchEnded:function(P,E){if(this.enabledInHierarchy&&!this.hasNestedViewGroup(P,E)){this._dispatchEvent("touch-up");var D=P.touch;this.content&&this._handleReleaseLogic(D),this._touchMoved?P.stopPropagation():this._stopPropagationIfTargetIsMe(P)}},_onTouchCancelled:function(P,E){if(this.enabledInHierarchy&&!this.hasNestedViewGroup(P,E)){if(!P.simulate){var D=P.touch;this.content&&this._handleReleaseLogic(D)}this._stopPropagationIfTargetIsMe(P)}},_processDeltaMove:function(P){this._scrollChildren(P),this._gatherTouchMove(P)},_getLocalAxisAlignDelta:function(P){return this.node.convertToNodeSpaceAR(P.getLocation(),_),this.node.convertToNodeSpaceAR(P.getPreviousLocation(),w),_.sub(w)},_handleMoveLogic:function(P){var E=this._getLocalAxisAlignDelta(P);this._processDeltaMove(E)},_scrollChildren:function(P){var E,D=P=this._clampDelta(P);this.elastic&&(E=this._getHowMuchOutOfBoundary(),D.x*=E.x===0?1:.5,D.y*=E.y===0?1:.5),this.elastic||(E=this._getHowMuchOutOfBoundary(D),D=D.add(E));var I="",M="";this.vertical&&(D.y>0?this.content.y-this.content.anchorY*this.content.height+D.y>=this._bottomBoundary&&(I="scroll-to-bottom"):D.y<0&&this.content.y-this.content.anchorY*this.content.height+this.content.height+D.y<=this._topBoundary&&(I="scroll-to-top")),this.horizontal&&(D.x<0?this.content.x-this.content.anchorX*this.content.width+this.content.width+D.x<=this._rightBoundary&&(M="scroll-to-right"):D.x>0&&this.content.x-this.content.anchorX*this.content.width+D.x>=this._leftBoundary&&(M="scroll-to-left")),this._moveContent(D,!1),(this.horizontal&&D.x!==0||this.vertical&&D.y!==0)&&(this._scrolling||(this._scrolling=!0,this._dispatchEvent("scroll-began")),this._dispatchEvent("scrolling")),I!==""&&this._dispatchEvent(I),M!==""&&this._dispatchEvent(M)},_handlePressLogic:function(){this._autoScrolling&&this._dispatchEvent("scroll-ended"),this._autoScrolling=!1,this._isBouncing=!1,this._touchMovePreviousTimestamp=B(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._onScrollBarTouchBegan()},_clampDelta:function(P){var E=this.content.getContentSize(),D=this._view.getContentSize();return E.width<D.width&&(P.x=0),E.height<D.height&&(P.y=0),P},_gatherTouchMove:function(P){for(P=this._clampDelta(P);this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(P);var E=B();this._touchMoveTimeDeltas.push((E-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=E},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var P=this._getHowMuchOutOfBoundary();if((P=this._clampDelta(P)).fuzzyEquals(cc.v2(0,0),1e-4))return!1;var E=Math.max(this.bounceDuration,0);return this._startAutoScroll(P,E,!0),this._isBouncing||(P.y>0&&this._dispatchEvent("bounce-top"),P.y<0&&this._dispatchEvent("bounce-bottom"),P.x>0&&this._dispatchEvent("bounce-right"),P.x<0&&this._dispatchEvent("bounce-left"),this._isBouncing=!0),!0},_processInertiaScroll:function(){if(!this._startBounceBackIfNeeded()&&this.inertia){var P=this._calculateTouchMoveVelocity();!P.fuzzyEquals(cc.v2(0,0),1e-4)&&this.brake<1&&this._startInertiaScroll(P)}this._onScrollBarTouchEnded()},_handleReleaseLogic:function(P){var E=this._getLocalAxisAlignDelta(P);this._gatherTouchMove(E),this._processInertiaScroll(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent("scroll-ended"))},_isOutOfBoundary:function(){return!this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1e-4)},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},getScrollEndedEventTiming:function(){return 1e-4},_processAutoScrolling:function(P){var E=this._isNecessaryAutoScrollBrake(),D=E?.05:1;this._autoScrollAccumulatedTime+=P*(1/D);var I,M=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(I=M,M=(I-=1)*I*I*I*I+1);var N=this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(M)),k=Math.abs(M-1)<=1e-4;if(Math.abs(M-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent("scroll-ended-with-threshold"),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var F=N.sub(this._autoScrollBrakingStartPosition);E&&(F=F.mul(D)),N=this._autoScrollBrakingStartPosition.add(F)}else{var G=N.sub(this.getContentPosition()),V=this._getHowMuchOutOfBoundary(G);V.fuzzyEquals(cc.v2(0,0),1e-4)||(N=N.add(V),k=!0)}k&&(this._autoScrolling=!1);var j=N.sub(this.getContentPosition());this._moveContent(this._clampDelta(j),k),this._dispatchEvent("scrolling"),this._autoScrolling||(this._isBouncing=!1,this._scrolling=!1,this._dispatchEvent("scroll-ended"))},_startInertiaScroll:function(P){var E=P.mul(.7);this._startAttenuatingAutoScroll(E,P)},_calculateAttenuatedFactor:function(P){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*P+P*P*8e-9))},_startAttenuatingAutoScroll:function(P,E){var D=this._calculateAutoScrollTimeByInitalSpeed(E.mag()),I=P.normalize(),M=this.content.getContentSize(),N=this._view.getContentSize(),k=M.width-N.width,F=M.height-N.height,G=this._calculateAttenuatedFactor(k),V=this._calculateAttenuatedFactor(F);I=cc.v2(I.x*k*(1-this.brake)*G,I.y*F*V*(1-this.brake));var j=P.mag(),H=I.mag()/j;I=I.add(P),this.brake>0&&H>7&&(H=Math.sqrt(H),I=P.mul(H).add(P)),this.brake>0&&H>3&&(D*=H=3),this.brake===0&&H>1&&(D*=H),this._startAutoScroll(I,D,!0)},_calculateAutoScrollTimeByInitalSpeed:function(P){return Math.sqrt(Math.sqrt(P/5))},_startAutoScroll:function(P,E,D){var I=this._flattenVectorByDirection(P);this._autoScrolling=!0,this._autoScrollTargetDelta=I,this._autoScrollAttenuate=D,this._autoScrollStartPosition=this.getContentPosition(),this._autoScrollTotalTime=E,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition=cc.v2(0,0),this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1e-4)||(this._autoScrollCurrentlyOutOfBoundary=!0)},_calculateTouchMoveVelocity:function(){var P=0;if((P=this._touchMoveTimeDeltas.reduce(function(D,I){return D+I},P))<=0||P>=.5)return cc.v2(0,0);var E=cc.v2(0,0);return E=this._touchMoveDisplacements.reduce(function(D,I){return D.add(I)},E),cc.v2(E.x*(1-this.brake)/P,E.y*(1-this.brake)/P)},_flattenVectorByDirection:function(P){var E=P;return E.x=this.horizontal?E.x:0,E.y=this.vertical?E.y:0,E},_moveContent:function(P,E){var D=this._flattenVectorByDirection(P),I=this.getContentPosition().add(D);this.setContentPosition(I);var M=this._getHowMuchOutOfBoundary();this._updateScrollBar(M),this.elastic&&E&&this._startBounceBackIfNeeded()},_getContentLeftBoundary:function(){return this.getContentPosition().x-this.content.getAnchorPoint().x*this.content.getContentSize().width},_getContentRightBoundary:function(){var P=this.content.getContentSize();return this._getContentLeftBoundary()+P.width},_getContentTopBoundary:function(){var P=this.content.getContentSize();return this._getContentBottomBoundary()+P.height},_getContentBottomBoundary:function(){return this.getContentPosition().y-this.content.getAnchorPoint().y*this.content.getContentSize().height},_getHowMuchOutOfBoundary:function(P){if((P=P||cc.v2(0,0)).fuzzyEquals(cc.v2(0,0),1e-4)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var E=cc.v2(0,0);return this._getContentLeftBoundary()+P.x>this._leftBoundary?E.x=this._leftBoundary-(this._getContentLeftBoundary()+P.x):this._getContentRightBoundary()+P.x<this._rightBoundary&&(E.x=this._rightBoundary-(this._getContentRightBoundary()+P.x)),this._getContentTopBoundary()+P.y<this._topBoundary?E.y=this._topBoundary-(this._getContentTopBoundary()+P.y):this._getContentBottomBoundary()+P.y>this._bottomBoundary&&(E.y=this._bottomBoundary-(this._getContentBottomBoundary()+P.y)),P.fuzzyEquals(cc.v2(0,0),1e-4)&&(this._outOfBoundaryAmount=E,this._outOfBoundaryAmountDirty=!1),this._clampDelta(E)},_updateScrollBarState:function(){if(this.content){var P=this.content.getContentSize(),E=this._view.getContentSize();this.verticalScrollBar&&(P.height<E.height?this.verticalScrollBar.hide():this.verticalScrollBar.show()),this.horizontalScrollBar&&(P.width<E.width?this.horizontalScrollBar.hide():this.horizontalScrollBar.show())}},_updateScrollBar:function(P){this.horizontalScrollBar&&this.horizontalScrollBar._onScroll(P),this.verticalScrollBar&&this.verticalScrollBar._onScroll(P)},_onScrollBarTouchBegan:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchBegan(),this.verticalScrollBar&&this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchEnded(),this.verticalScrollBar&&this.verticalScrollBar._onTouchEnded()},_dispatchEvent:function(P){if(P==="scroll-ended")this._scrollEventEmitMask=0;else if(P==="scroll-to-top"||P==="scroll-to-bottom"||P==="scroll-to-left"||P==="scroll-to-right"){var E=1<<O[P];if(this._scrollEventEmitMask&E)return;this._scrollEventEmitMask|=E}cc.Component.EventHandler.emitEvents(this.scrollEvents,this,O[P]),this.node.emit(P,this)},_adjustContentOutOfBoundary:function(){if(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary()){var P=this._getHowMuchOutOfBoundary(cc.v2(0,0)),E=this.getContentPosition().add(P);this.content&&(this.content.setPosition(E),this._updateScrollBar(0))}},start:function(){this._calculateBoundary(),this.content&&cc.director.once(cc.Director.EVENT_BEFORE_DRAW,this._adjustContentOutOfBoundary,this)},_hideScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.hide(),this.verticalScrollBar&&this.verticalScrollBar.hide()},onDisable:function(){this._unregisterEvent(),this.content&&(this.content.off(T.SIZE_CHANGED,this._calculateBoundary,this),this.content.off(T.SCALE_CHANGED,this._calculateBoundary,this),this._view&&(this._view.off(T.POSITION_CHANGED,this._calculateBoundary,this),this._view.off(T.SCALE_CHANGED,this._calculateBoundary,this),this._view.off(T.SIZE_CHANGED,this._calculateBoundary,this))),this._hideScrollbar(),this.stopAutoScroll()},onEnable:function(){this._registerEvent(),this.content&&(this.content.on(T.SIZE_CHANGED,this._calculateBoundary,this),this.content.on(T.SCALE_CHANGED,this._calculateBoundary,this),this._view&&(this._view.on(T.POSITION_CHANGED,this._calculateBoundary,this),this._view.on(T.SCALE_CHANGED,this._calculateBoundary,this),this._view.on(T.SIZE_CHANGED,this._calculateBoundary,this))),this._updateScrollBarState()},update:function(P){this._autoScrolling&&this._processAutoScrolling(P)}});cc.ScrollView=S.exports=R},{"../CCNode":29,"./CCViewGroup":128}],122:[function(L,S){var T=L("../utils/misc"),_=L("./CCComponent"),w=cc.Enum({Horizontal:0,Vertical:1}),B=cc.Class({name:"cc.Slider",extends:_,editor:!1,ctor:function(){this._offset=cc.v2(),this._touchHandle=!1,this._dragging=!1},properties:{handle:{default:null,type:cc.Button,tooltip:!1,notify:function(){}},direction:{default:w.Horizontal,type:w,tooltip:!1},progress:{default:.5,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateHandlePosition()}},slideEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Direction:w},__preload:function(){this._updateHandlePosition()},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.on(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.off(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},_onHandleDragStart:function(A){this._dragging=!0,this._touchHandle=!0,this._offset=this.handle.node.convertToNodeSpaceAR(A.touch.getLocation()),A.stopPropagation()},_onTouchBegan:function(A){this.handle&&(this._dragging=!0,this._touchHandle||this._handleSliderLogic(A.touch),A.stopPropagation())},_onTouchMoved:function(A){this._dragging&&(this._handleSliderLogic(A.touch),A.stopPropagation())},_onTouchEnded:function(A){this._dragging=!1,this._touchHandle=!1,this._offset=cc.v2(),A.stopPropagation()},_onTouchCancelled:function(A){this._dragging=!1,A.stopPropagation()},_handleSliderLogic:function(A){this._updateProgress(A),this._emitSlideEvent()},_emitSlideEvent:function(){cc.Component.EventHandler.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},_updateProgress:function(A){if(this.handle){var O=this.node,R=O.convertToNodeSpaceAR(A.getLocation());this.direction===w.Horizontal?this.progress=T.clamp01((R.x-this._offset.x+O.anchorX*O.width)/O.width):this.progress=T.clamp01((R.y-this._offset.y+O.anchorY*O.height)/O.height)}},_updateHandlePosition:function(){if(this.handle){var A;A=this.direction===w.Horizontal?cc.v2(-this.node.width*this.node.anchorX+this.progress*this.node.width,0):cc.v2(0,-this.node.height*this.node.anchorY+this.progress*this.node.height);var O=this.node.convertToWorldSpaceAR(A);this.handle.node.position=this.handle.node.parent.convertToNodeSpaceAR(O)}}});cc.Slider=S.exports=B},{"../utils/misc":271,"./CCComponent":106}],123:[function(L,S){var T=L("../utils/misc"),_=(L("../CCNode").EventType,L("./CCRenderComponent")),w=L("../utils/blend-func"),B=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3,MESH:4}),A=cc.Enum({HORIZONTAL:0,VERTICAL:1,RADIAL:2}),O=cc.Enum({CUSTOM:0,TRIMMED:1,RAW:2}),R=cc.Enum({NORMAL:0,GRAY:1}),P=cc.Class({name:"cc.Sprite",extends:_,mixins:[w],editor:!1,properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:B.SIMPLE,_sizeMode:O.TRIMMED,_fillType:0,_fillCenter:cc.v2(0,0),_fillStart:0,_fillRange:0,_isTrimmedMode:!0,_atlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,editorOnly:!0,visible:!0,animatable:!1},spriteFrame:{get:function(){return this._spriteFrame},set:function(E){var D=this._spriteFrame;D!==E&&(this._spriteFrame=E,this._applySpriteFrame(D))},type:cc.SpriteFrame},type:{get:function(){return this._type},set:function(E){this._type!==E&&(this._type=E,this.setVertsDirty(),this._resetAssembler())},type:B,animatable:!1,tooltip:!1},fillType:{get:function(){return this._fillType},set:function(E){E!==this._fillType&&(this._fillType=E,this.setVertsDirty(),this._resetAssembler())},type:A,tooltip:!1},fillCenter:{get:function(){return this._fillCenter},set:function(E){this._fillCenter.x=E.x,this._fillCenter.y=E.y,this._type===B.FILLED&&this.setVertsDirty()},tooltip:!1},fillStart:{get:function(){return this._fillStart},set:function(E){this._fillStart=T.clampf(E,-1,1),this._type===B.FILLED&&this.setVertsDirty()},tooltip:!1},fillRange:{get:function(){return this._fillRange},set:function(E){this._fillRange=T.clampf(E,-1,1),this._type===B.FILLED&&this.setVertsDirty()},tooltip:!1},trim:{get:function(){return this._isTrimmedMode},set:function(E){this._isTrimmedMode!==E&&(this._isTrimmedMode=E,this._type!==B.SIMPLE&&this._type!==B.MESH||this.setVertsDirty())},animatable:!1,tooltip:!1},sizeMode:{get:function(){return this._sizeMode},set:function(E){this._sizeMode=E,E!==O.CUSTOM&&this._applySpriteSize()},animatable:!1,type:O,tooltip:!1}},statics:{FillType:A,Type:B,SizeMode:O,State:R},setVisible:function(E){this.enabled=E},setState:function(){},getState:function(){},__preload:function(){this._super(),this._applySpriteFrame()},onEnable:function(){this._super(),this._validateRender(),this._spriteFrame&&this._spriteFrame.isValid&&this._spriteFrame.ensureLoadTexture(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this.setVertsDirty,this),this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.SIZE_CHANGED,this.setVertsDirty,this),this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this)},onRestore:!1,_updateMaterial:function(){var E=null;this._spriteFrame&&(E=this._spriteFrame.getTexture());var D=this.getMaterial(0);if(D){var I=D.getDefine("USE_TEXTURE");I===void 0||I||D.define("USE_TEXTURE",!0);var M=E&&E.getImpl();D.getProperty("texture")!==M&&D.setProperty("texture",E)}w.prototype._updateMaterial.call(this)},_applyAtlas:!1,_validateRender:function(){var E=this._spriteFrame;this._materials[0]&&E&&E.textureLoaded()||this.disableRender()},_applySpriteSize:function(){if(this.isValid&&this._spriteFrame&&this._spriteFrame.isValid){if(O.RAW===this._sizeMode){var E=this._spriteFrame._originalSize;this.node.setContentSize(E)}else if(O.TRIMMED===this._sizeMode){var D=this._spriteFrame._rect;this.node.setContentSize(D.width,D.height)}this.setVertsDirty()}},_applySpriteFrame:function(E){if(this.isValid){var D=E&&E.isValid&&E.getTexture();D&&!D.loaded&&E.off("load",this._applySpriteSize,this);var I=this._spriteFrame,M=I&&I.isValid,N=M&&I.getTexture();D!==N&&this._updateMaterial(),N&&N.loaded?this._applySpriteSize():(this.disableRender(),M&&I.once("load",this._applySpriteSize,this))}}});cc.Sprite=S.exports=P},{"../CCNode":29,"../utils/blend-func":265,"../utils/misc":271,"./CCRenderComponent":117}],124:[function(L,S){var T=cc.Enum({NONE:0,CHECKBOX:1,TEXT_ATLAS:2,SLIDER_BAR:3,LIST_VIEW:4,PAGE_VIEW:5}),_=cc.Enum({VERTICAL:0,HORIZONTAL:1}),w=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),B=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),A=cc.Class({name:"cc.StudioComponent",extends:cc.Component,editor:!1,properties:!1,statics:{ComponentType:T,ListDirection:_,VerticalAlign:w,HorizontalAlign:B}});cc.StudioComponent=S.exports=A;var O=cc.Class({name:"cc.StudioWidget",extends:cc.Widget,editor:!1,_validateTargetInDEV:function(){}});cc.StudioWidget=S.exports=O},{}],125:[function(L,S){var T=L("../utils/gray-sprite-state"),_=cc.Class({name:"cc.Toggle",extends:L("./CCButton"),mixins:[T],editor:!1,properties:{_N$isChecked:!0,isChecked:{get:function(){return this._N$isChecked},set:function(w){if(w!==this._N$isChecked){var B=this.toggleGroup||this._toggleContainer;B&&B.enabled&&this._N$isChecked&&!B.allowSwitchOff||(this._N$isChecked=w,this._updateCheckMark(),B&&B.enabled&&B.updateToggles(this),cc.Toggle._triggerEventInScript_isChecked&&this._emitToggleEvents())}},tooltip:!1},toggleGroup:{default:null,tooltip:!1,type:L("./CCToggleGroup")},checkMark:{default:null,type:cc.Sprite,tooltip:!1},checkEvents:{default:[],type:cc.Component.EventHandler},_resizeToTarget:{animatable:!1,set:function(w){w&&this._resizeNodeToTargetNode()}}},statics:{_triggerEventInScript_check:!1,_triggerEventInScript_isChecked:!1},onEnable:function(){this._super(),this._registerToggleEvent(),this.toggleGroup&&this.toggleGroup.enabledInHierarchy&&this.toggleGroup.addToggle(this)},onDisable:function(){this._super(),this._unregisterToggleEvent(),this.toggleGroup&&this.toggleGroup.enabledInHierarchy&&this.toggleGroup.removeToggle(this)},_hideCheckMark:function(){this._N$isChecked=!1,this._updateCheckMark()},toggle:function(w){this.isChecked=!this.isChecked,cc.Toggle._triggerEventInScript_isChecked||!cc.Toggle._triggerEventInScript_check&&!w||this._emitToggleEvents()},check:function(){this.isChecked=!0,!cc.Toggle._triggerEventInScript_isChecked&&cc.Toggle._triggerEventInScript_check&&this._emitToggleEvents()},uncheck:function(){this.isChecked=!1,!cc.Toggle._triggerEventInScript_isChecked&&cc.Toggle._triggerEventInScript_check&&this._emitToggleEvents()},_updateCheckMark:function(){this.checkMark&&(this.checkMark.node.active=!!this.isChecked)},_updateDisabledState:function(){if(this._super(),this.enableAutoGrayEffect&&this.checkMark){var w=!this.interactable;this._switchGrayMaterial(w,this.checkMark)}},_registerToggleEvent:function(){this.node.on("click",this.toggle,this)},_unregisterToggleEvent:function(){this.node.off("click",this.toggle,this)},_emitToggleEvents:function(){this.node.emit("toggle",this),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,this)}});cc.Toggle=S.exports=_,L("../platform/js").get(_.prototype,"_toggleContainer",function(){var w=this.node.parent;return cc.Node.isNode(w)?w.getComponent(cc.ToggleContainer):null})},{"../platform/js":217,"../utils/gray-sprite-state":268,"./CCButton":104,"./CCToggleGroup":127}],126:[function(L,S){var T=cc.Class({name:"cc.ToggleContainer",extends:cc.Component,editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},checkEvents:{default:[],type:cc.Component.EventHandler}},updateToggles:function(_){this.enabledInHierarchy&&_.isChecked&&(this.toggleItems.forEach(function(w){w!==_&&w.isChecked&&w.enabled&&w._hideCheckMark()}),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,_))},_allowOnlyOneToggleChecked:function(){var _=!1;return this.toggleItems.forEach(function(w){_?w._hideCheckMark():w.isChecked&&(_=!0)}),_},_makeAtLeastOneToggleChecked:function(){if(!this._allowOnlyOneToggleChecked()&&!this.allowSwitchOff){var _=this.toggleItems;_.length>0&&_[0].check()}},onEnable:function(){this._makeAtLeastOneToggleChecked(),this.node.on("child-added",this._allowOnlyOneToggleChecked,this),this.node.on("child-removed",this._makeAtLeastOneToggleChecked,this)},onDisable:function(){this.node.off("child-added",this._allowOnlyOneToggleChecked,this),this.node.off("child-removed",this._makeAtLeastOneToggleChecked,this)}});L("../platform/js").get(T.prototype,"toggleItems",function(){return this.node._children.map(function(_){return _.getComponent(cc.Toggle)}).filter(Boolean)}),cc.ToggleContainer=S.exports=T},{"../platform/js":217}],127:[function(L,S){var T=cc.Class({name:"cc.ToggleGroup",extends:cc.Component,ctor:function(){this._toggleItems=[]},editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},toggleItems:{get:function(){return this._toggleItems}}},updateToggles:function(B){this.enabledInHierarchy&&this._toggleItems.forEach(function(A){B.isChecked&&A!==B&&A.isChecked&&A.enabled&&A._hideCheckMark()})},addToggle:function(B){this._toggleItems.indexOf(B)===-1&&this._toggleItems.push(B),this._allowOnlyOneToggleChecked()},removeToggle:function(B){var A=this._toggleItems.indexOf(B);A>-1&&this._toggleItems.splice(A,1),this._makeAtLeastOneToggleChecked()},_allowOnlyOneToggleChecked:function(){var B=!1;return this._toggleItems.forEach(function(A){B&&A.enabled&&A._hideCheckMark(),A.isChecked&&A.enabled&&(B=!0)}),B},_makeAtLeastOneToggleChecked:function(){this._allowOnlyOneToggleChecked()||this.allowSwitchOff||this._toggleItems.length>0&&(this._toggleItems[0].isChecked=!0)},start:function(){this._makeAtLeastOneToggleChecked()}}),_=L("../platform/js"),w=!1;_.get(cc,"ToggleGroup",function(){return w||(cc.errorID(1405,"cc.ToggleGroup","cc.ToggleContainer"),w=!0),T}),S.exports=T},{"../platform/js":217}],128:[function(L,S){var T=cc.Class({name:"cc.ViewGroup",extends:L("./CCComponent")});cc.ViewGroup=S.exports=T},{"./CCComponent":106}],129:[function(L,S){var T=L("../base-ui/CCWidgetManager"),_=T.AlignMode,w=T._AlignFlags,B=w.TOP,A=w.MID,O=w.BOT,R=w.LEFT,P=w.CENTER,E=w.RIGHT,D=B|O,I=R|E,M=cc.Class({name:"cc.Widget",extends:L("./CCComponent"),editor:!1,properties:{target:{get:function(){return this._target},set:function(N){this._target=N},type:cc.Node,tooltip:!1},isAlignTop:{get:function(){return(this._alignFlags&B)>0},set:function(N){this._setAlign(B,N)},animatable:!1,tooltip:!1},isAlignVerticalCenter:{get:function(){return(this._alignFlags&A)>0},set:function(N){N?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=A):this._alignFlags&=~A},animatable:!1,tooltip:!1},isAlignBottom:{get:function(){return(this._alignFlags&O)>0},set:function(N){this._setAlign(O,N)},animatable:!1,tooltip:!1},isAlignLeft:{get:function(){return(this._alignFlags&R)>0},set:function(N){this._setAlign(R,N)},animatable:!1,tooltip:!1},isAlignHorizontalCenter:{get:function(){return(this._alignFlags&P)>0},set:function(N){N?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=P):this._alignFlags&=~P},animatable:!1,tooltip:!1},isAlignRight:{get:function(){return(this._alignFlags&E)>0},set:function(N){this._setAlign(E,N)},animatable:!1,tooltip:!1},isStretchWidth:{get:function(){return(this._alignFlags&I)===I},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&D)===D},visible:!1},top:{get:function(){return this._top},set:function(N){this._top=N},tooltip:!1},bottom:{get:function(){return this._bottom},set:function(N){this._bottom=N},tooltip:!1},left:{get:function(){return this._left},set:function(N){this._left=N},tooltip:!1},right:{get:function(){return this._right},set:function(N){this._right=N},tooltip:!1},horizontalCenter:{get:function(){return this._horizontalCenter},set:function(N){this._horizontalCenter=N},tooltip:!1},verticalCenter:{get:function(){return this._verticalCenter},set:function(N){this._verticalCenter=N},tooltip:!1},isAbsoluteHorizontalCenter:{get:function(){return this._isAbsHorizontalCenter},set:function(N){this._isAbsHorizontalCenter=N},animatable:!1},isAbsoluteVerticalCenter:{get:function(){return this._isAbsVerticalCenter},set:function(N){this._isAbsVerticalCenter=N},animatable:!1},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(N){this._isAbsTop=N},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(N){this._isAbsBottom=N},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(N){this._isAbsLeft=N},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(N){this._isAbsRight=N},animatable:!1},alignMode:{default:_.ON_WINDOW_RESIZE,type:_,tooltip:!1},_wasAlignOnce:{default:void 0,formerlySerializedAs:"isAlignOnce"},_target:null,_alignFlags:0,_left:0,_right:0,_top:0,_bottom:0,_verticalCenter:0,_horizontalCenter:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_isAbsHorizontalCenter:!0,_isAbsVerticalCenter:!0,_originalWidth:0,_originalHeight:0},statics:{AlignMode:_},onLoad:function(){this._wasAlignOnce!==void 0&&(this.alignMode=this._wasAlignOnce?_.ONCE:_.ALWAYS,this._wasAlignOnce=void 0)},onEnable:function(){T.add(this)},onDisable:function(){T.remove(this)},_validateTargetInDEV:!1,_setAlign:function(N,k){if(k!==(this._alignFlags&N)>0){var F=(N&I)>0;k?(this._alignFlags|=N,F?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=this.node.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=this.node.height))):(F?this.isStretchWidth&&(this.node.width=this._originalWidth):this.isStretchHeight&&(this.node.height=this._originalHeight),this._alignFlags&=~N)}},updateAlignment:function(){T.updateAlignment(this.node)}});Object.defineProperty(M.prototype,"isAlignOnce",{get:function(){return this.alignMode===_.ONCE},set:function(N){this.alignMode=N?_.ONCE:_.ALWAYS}}),cc.Widget=S.exports=M},{"../base-ui/CCWidgetManager":90,"./CCComponent":106}],130:[function(L,S){var T=L("../../platform/CCMacro"),_=L("../editbox/EditBoxImplBase"),w=L("../CCLabel"),B=L("./types"),A=B.InputMode,O=B.InputFlag,R=B.KeyboardReturnType;function P(D){return D.charAt(0).toUpperCase()+D.slice(1)}var E=cc.Class({name:"cc.EditBox",extends:cc.Component,editor:!1,properties:{_string:"",string:{tooltip:!1,get:function(){return this._string},set:function(D){D=""+D,this.maxLength>=0&&D.length>=this.maxLength&&(D=D.slice(0,this.maxLength)),this._string=D,this._updateString(D)}},textLabel:{tooltip:!1,default:null,type:w,notify:function(D){this.textLabel&&this.textLabel!==D&&(this._updateTextLabel(),this._updateLabels())}},placeholderLabel:{tooltip:!1,default:null,type:w,notify:function(D){this.placeholderLabel&&this.placeholderLabel!==D&&(this._updatePlaceholderLabel(),this._updateLabels())}},background:{tooltip:!1,default:null,type:cc.Sprite,notify:function(D){this.background&&this.background!==D&&this._updateBackgroundSprite()}},_N$backgroundImage:{default:void 0,type:cc.SpriteFrame},backgroundImage:{get:function(){return this.background?this.background.spriteFrame:null},set:function(D){this.background&&(this.background.spriteFrame=D)}},returnType:{default:R.DEFAULT,tooltip:!1,displayName:"KeyboardReturnType",type:R},_N$returnType:{default:void 0,type:cc.Float},inputFlag:{tooltip:!1,default:O.DEFAULT,type:O,notify:function(){this._updateString(this._string)}},inputMode:{tooltip:!1,default:A.ANY,type:A,notify:function(D){this.inputMode!==D&&(this._updateTextLabel(),this._updatePlaceholderLabel())}},fontSize:{get:function(){return this.textLabel?this.textLabel.fontSize:0},set:function(D){this.textLabel&&(this.textLabel.fontSize=D)}},_N$fontSize:{default:void 0,type:cc.Float},lineHeight:{get:function(){return this.textLabel?this.textLabel.lineHeight:0},set:function(D){this.textLabel&&(this.textLabel.lineHeight=D)}},_N$lineHeight:{default:void 0,type:cc.Float},fontColor:{get:function(){return this.textLabel?this.textLabel.node.color:cc.Color.BLACK},set:function(D){this.textLabel&&(this.textLabel.node.color=D,this.textLabel.node.opacity=D.a)}},_N$fontColor:void 0,placeholder:{tooltip:!1,get:function(){return this.placeholderLabel?this.placeholderLabel.string:""},set:function(D){this.placeholderLabel&&(this.placeholderLabel.string=D)}},_N$placeholder:{default:void 0,type:cc.String},placeholderFontSize:{get:function(){return this.placeholderLabel?this.placeholderLabel.fontSize:0},set:function(D){this.placeholderLabel&&(this.placeholderLabel.fontSize=D)}},_N$placeholderFontSize:{default:void 0,type:cc.Float},placeholderFontColor:{get:function(){return this.placeholderLabel?this.placeholderLabel.node.color:cc.Color.BLACK},set:function(D){this.placeholderLabel&&(this.placeholderLabel.node.color=D,this.placeholderLabel.node.opacity=D.a)}},_N$placeholderFontColor:void 0,maxLength:{tooltip:!1,default:20},_N$maxLength:{default:void 0,type:cc.Float},stayOnTop:{default:!1,notify:function(){cc.warn("editBox.stayOnTop is removed since v2.1.")}},_tabIndex:0,tabIndex:{tooltip:!1,get:function(){return this._tabIndex},set:function(D){this._tabIndex!==D&&(this._tabIndex=D,this._impl&&this._impl.setTabIndex(D))}},editingDidBegan:{default:[],type:cc.Component.EventHandler},textChanged:{default:[],type:cc.Component.EventHandler},editingDidEnded:{default:[],type:cc.Component.EventHandler},editingReturn:{default:[],type:cc.Component.EventHandler}},statics:{_ImplClass:_,KeyboardReturnType:R,InputFlag:O,InputMode:A},_init:function(){this._upgradeComp(),this._isLabelVisible=!0,this.node.on(cc.Node.EventType.SIZE_CHANGED,this._syncSize,this),(this._impl=new E._ImplClass).init(this),this._updateString(this._string),this._syncSize()},_updateBackgroundSprite:function(){var D=this.background;if(!D){var I=this.node.getChildByName("BACKGROUND_SPRITE");I||(I=new cc.Node("BACKGROUND_SPRITE")),(D=I.getComponent(cc.Sprite))||(D=I.addComponent(cc.Sprite)),I.parent=this.node,this.background=D}D.type=cc.Sprite.Type.SLICED,this._N$backgroundImage!==void 0&&(D.spriteFrame=this._N$backgroundImage,this._N$backgroundImage=void 0)},_updateTextLabel:function(){var D=this.textLabel;if(!D){var I=this.node.getChildByName("TEXT_LABEL");I||(I=new cc.Node("TEXT_LABEL")),(D=I.getComponent(w))||(D=I.addComponent(w)),I.parent=this.node,this.textLabel=D}D.node.setAnchorPoint(0,1),D.overflow=w.Overflow.CLAMP,this.inputMode===A.ANY?(D.verticalAlign=T.VerticalTextAlignment.TOP,D.enableWrapText=!0):(D.verticalAlign=T.VerticalTextAlignment.CENTER,D.enableWrapText=!1),D.string=this._updateLabelStringStyle(this._string),this._N$fontColor!==void 0&&(D.node.color=this._N$fontColor,D.node.opacity=this._N$fontColor.a,this._N$fontColor=void 0),this._N$fontSize!==void 0&&(D.fontSize=this._N$fontSize,this._N$fontSize=void 0),this._N$lineHeight!==void 0&&(D.lineHeight=this._N$lineHeight,this._N$lineHeight=void 0)},_updatePlaceholderLabel:function(){var D=this.placeholderLabel;if(!D){var I=this.node.getChildByName("PLACEHOLDER_LABEL");I||(I=new cc.Node("PLACEHOLDER_LABEL")),(D=I.getComponent(w))||(D=I.addComponent(w)),I.parent=this.node,this.placeholderLabel=D}D.node.setAnchorPoint(0,1),D.overflow=w.Overflow.CLAMP,this.inputMode===A.ANY?(D.verticalAlign=T.VerticalTextAlignment.TOP,D.enableWrapText=!0):(D.verticalAlign=T.VerticalTextAlignment.CENTER,D.enableWrapText=!1),D.string=this.placeholder,this._N$placeholderFontColor!==void 0&&(D.node.color=this._N$placeholderFontColor,D.node.opacity=this._N$placeholderFontColor.a,this._N$placeholderFontColor=void 0),this._N$placeholderFontSize!==void 0&&(D.fontSize=this._N$placeholderFontSize,this._N$placeholderFontSize=void 0)},_upgradeComp:function(){this._N$returnType!==void 0&&(this.returnType=this._N$returnType,this._N$returnType=void 0),this._N$maxLength!==void 0&&(this.maxLength=this._N$maxLength,this._N$maxLength=void 0),this._N$backgroundImage!==void 0&&this._updateBackgroundSprite(),this._N$fontColor===void 0&&this._N$fontSize===void 0&&this._N$lineHeight===void 0||this._updateTextLabel(),this._N$placeholderFontColor===void 0&&this._N$placeholderFontSize===void 0||this._updatePlaceholderLabel(),this._N$placeholder!==void 0&&(this.placeholder=this._N$placeholder,this._N$placeholder=void 0)},_syncSize:function(){if(this._impl){var D=this.node.getContentSize();this._impl.setSize(D.width,D.height)}},_showLabels:function(){this._isLabelVisible=!0,this._updateLabels()},_hideLabels:function(){this._isLabelVisible=!1,this.textLabel&&(this.textLabel.node.active=!1),this.placeholderLabel&&(this.placeholderLabel.node.active=!1)},_updateLabels:function(){if(this._isLabelVisible){var D=this._string;this.textLabel&&(this.textLabel.node.active=D!==""),this.placeholderLabel&&(this.placeholderLabel.node.active=D==="")}},_updateString:function(D){var I=this.textLabel;if(I){var M=D;M&&(M=this._updateLabelStringStyle(M)),I.string=M,this._updateLabels()}},_updateLabelStringStyle:function(D,I){var M=this.inputFlag;if(I||M!==O.PASSWORD)M===O.INITIAL_CAPS_ALL_CHARACTERS?D=D.toUpperCase():M===O.INITIAL_CAPS_WORD?D=D.replace(/(?:^|\s)\S/g,function(G){return G.toUpperCase()}):M===O.INITIAL_CAPS_SENTENCE&&(D=P(D));else{for(var N="",k=D.length,F=0;F<k;++F)N+="●";D=N}return D},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan,this),this.node.emit("editing-did-began",this)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded,this),this.node.emit("editing-did-ended",this)},editBoxTextChanged:function(D){D=this._updateLabelStringStyle(D,!0),this.string=D,cc.Component.EventHandler.emitEvents(this.textChanged,D,this),this.node.emit("text-changed",this)},editBoxEditingReturn:function(){cc.Component.EventHandler.emitEvents(this.editingReturn,this),this.node.emit("editing-return",this)},onEnable:function(){this._registerEvent(),this._impl&&this._impl.enable()},onDisable:function(){this._unregisterEvent(),this._impl&&this._impl.disable()},onDestroy:function(){this._impl&&this._impl.clear()},__preload:function(){this._init()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_onTouchBegan:function(D){D.stopPropagation()},_onTouchCancel:function(D){D.stopPropagation()},_onTouchEnded:function(D){this._impl&&this._impl.beginEditing(),D.stopPropagation()},setFocus:function(){cc.errorID(1400,"setFocus()","focus()"),this._impl&&this._impl.setFocus(!0)},focus:function(){this._impl&&this._impl.setFocus(!0)},blur:function(){this._impl&&this._impl.setFocus(!1)},isFocused:function(){return!!this._impl&&this._impl.isFocused()},update:function(){this._impl&&this._impl.update()}});cc.EditBox=S.exports=E,cc.sys.isBrowser&&L("./WebEditBoxImpl")},{"../../platform/CCMacro":201,"../CCLabel":108,"../editbox/EditBoxImplBase":131,"./WebEditBoxImpl":132,"./types":134}],131:[function(L,S){var T=cc.Class({ctor:function(){this._delegate=null,this._editing=!1},init:function(){},enable:function(){},disable:function(){this._editing&&this.endEditing()},clear:function(){},update:function(){},setTabIndex:function(){},setSize:function(){},setFocus:function(_){_?this.beginEditing():this.endEditing()},isFocused:function(){return this._editing},beginEditing:function(){},endEditing:function(){}});S.exports=T},{}],132:[function(L){var S,T=(S=L("../../value-types/mat4"))&&S.__esModule?S:{default:S},_=L("../../platform/utils"),w=L("../../platform/CCMacro"),B=L("./types"),A=L("../CCLabel"),O=L("./tabIndexUtil"),R=cc.EditBox,P=cc.js,E=B.InputMode,D=B.InputFlag,I=B.KeyboardReturnType,M={zoomInvalid:!1};cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(M.zoomInvalid=!0);var N=0,k=cc.v3(),F=null,G=!1,V=!1,j=R._ImplClass;function H(){j.call(this),this._domId="EditBoxId_"+ ++N,this._placeholderStyleSheet=null,this._elem=null,this._isTextArea=!1,this._worldMat=new T.default,this._cameraMat=new T.default,this._m00=0,this._m01=0,this._m04=0,this._m05=0,this._m12=0,this._m13=0,this._w=0,this._h=0,this._cacheViewportRect=cc.rect(0,0,0,0),this._inputMode=null,this._inputFlag=null,this._returnType=null,this._eventListeners={},this._textLabelFont=null,this._textLabelFontSize=null,this._textLabelFontColor=null,this._textLabelAlign=null,this._placeholderLabelFont=null,this._placeholderLabelFontSize=null,this._placeholderLabelFontColor=null,this._placeholderLabelAlign=null,this._placeholderLineHeight=null}P.extend(H,j),R._ImplClass=H,Object.assign(H.prototype,{init:function(U){U&&(this._delegate=U,U.inputMode===E.ANY?this._createTextArea():this._createInput(),O.add(this),this.setTabIndex(U.tabIndex),this._initStyleSheet(),this._registerEventListeners(),this._addDomToGameContainer(),G=cc.view.isAutoFullScreenEnabled(),V=cc.view._resizeWithBrowserSize)},clear:function(){this._removeEventListeners(),this._removeDomFromGameContainer(),O.remove(this),F===this&&(F=null)},update:function(){this._updateMatrix()},setTabIndex:function(U){this._elem.tabIndex=U,O.resort()},setSize:function(U,X){var Y=this._elem;Y.style.width=U+"px",Y.style.height=X+"px"},beginEditing:function(){F&&F!==this&&F.setFocus(!1),this._editing=!0,F=this,this._delegate.editBoxEditingDidBegan(),this._showDom(),this._elem.focus()},endEditing:function(){this._elem&&this._elem.blur()},_createInput:function(){this._isTextArea=!1,this._elem=document.createElement("input")},_createTextArea:function(){this._isTextArea=!0,this._elem=document.createElement("textarea")},_addDomToGameContainer:function(){cc.game.container.appendChild(this._elem),document.head.appendChild(this._placeholderStyleSheet)},_removeDomFromGameContainer:function(){_.contains(cc.game.container,this._elem)&&cc.game.container.removeChild(this._elem),_.contains(document.head,this._placeholderStyleSheet)&&document.head.removeChild(this._placeholderStyleSheet),delete this._elem,delete this._placeholderStyleSheet},_showDom:function(){this._updateMaxLength(),this._updateInputType(),this._updateStyleSheet(),this._elem.style.display="",this._delegate._hideLabels(),cc.sys.isMobile&&this._showDomOnMobile()},_hideDom:function(){this._elem.style.display="none",this._delegate._showLabels(),cc.sys.isMobile&&this._hideDomOnMobile()},_showDomOnMobile:function(){cc.sys.os===cc.sys.OS_ANDROID&&(G&&(cc.view.enableAutoFullScreen(!1),cc.screen.exitFullScreen()),V&&cc.view.resizeWithBrowserSize(!1),this._adjustWindowScroll())},_hideDomOnMobile:function(){cc.sys.os===cc.sys.OS_ANDROID&&(V&&cc.view.resizeWithBrowserSize(!0),setTimeout(function(){F||G&&cc.view.enableAutoFullScreen(!0)},800))},_adjustWindowScroll:function(){var U=this;setTimeout(function(){window.scrollY<100&&U._elem.scrollIntoView({block:"start",inline:"nearest",behavior:"smooth"})},800)},_scrollBackWindow:function(){setTimeout(function(){var U=cc.sys;U.browserType!==U.BROWSER_TYPE_WECHAT||U.os!==U.OS_IOS?window.scrollTo(0,0):window.top&&window.top.scrollTo(0,0)},800)},_updateCameraMatrix:function(){var U=this._delegate.node;U.getWorldMatrix(this._worldMat);var X=this._worldMat,Y=U._contentSize,z=U._anchorPoint;k.x=-z.x*Y.width,k.y=-z.y*Y.height,T.default.transform(X,X,k);var W=cc.Camera.findCamera(U);return!!W&&(W.getWorldToScreenMatrix2D(this._cameraMat),T.default.mul(this._cameraMat,this._cameraMat,X),!0)},_updateMatrix:function(){if(this._updateCameraMatrix()){var U=this._cameraMat.m,X=this._delegate.node,Y=cc.view;if(this._m00!==U[0]||this._m01!==U[1]||this._m04!==U[4]||this._m05!==U[5]||this._m12!==U[12]||this._m13!==U[13]||this._w!==X._contentSize.width||this._h!==X._contentSize.height||!this._cacheViewportRect.equals(Y._viewportRect)){this._m00=U[0],this._m01=U[1],this._m04=U[4],this._m05=U[5],this._m12=U[12],this._m13=U[13],this._w=X._contentSize.width,this._h=X._contentSize.height,this._cacheViewportRect.set(Y._viewportRect);var z=Y._scaleX,W=Y._scaleY,Z=Y._viewportRect,Q=Y._devicePixelRatio;z/=Q,W/=Q;var ee=cc.game.container,te=U[0]*z,re=U[1],ie=U[4],ne=U[5]*W,he=ee&&ee.style.paddingLeft&&parseInt(ee.style.paddingLeft);he+=Z.x/Q;var pe=ee&&ee.style.paddingBottom&&parseInt(ee.style.paddingBottom);pe+=Z.y/Q;var K=U[12]*z+he,ue=U[13]*W+pe;M.zoomInvalid&&(this.setSize(X.width*te,X.height*ne),te=1,ne=1);var le=this._elem,ce="matrix("+te+","+-re+","+-ie+","+ne+","+K+","+-ue+")";le.style.transform=ce,le.style["-webkit-transform"]=ce,le.style["transform-origin"]="0px 100% 0px",le.style["-webkit-transform-origin"]="0px 100% 0px"}}},_updateInputType:function(){var U=this._delegate,X=U.inputMode,Y=U.inputFlag,z=U.returnType,W=this._elem;if(this._inputMode!==X||this._inputFlag!==Y||this._returnType!==z){if(this._inputMode=X,this._inputFlag=Y,this._returnType=z,this._isTextArea){var Z="none";return Y===D.INITIAL_CAPS_ALL_CHARACTERS?Z="uppercase":Y===D.INITIAL_CAPS_WORD&&(Z="capitalize"),void(W.style.textTransform=Z)}if(Y===D.PASSWORD)return W.type="password",void(W.style.textTransform="none");var Q=W.type;X===E.EMAIL_ADDR?Q="email":X===E.NUMERIC||X===E.DECIMAL?Q="number":X===E.PHONE_NUMBER?(Q="number",W.pattern="[0-9]*",W.onmousewheel=function(){return!1}):X===E.URL?Q="url":(Q="text",z===I.SEARCH&&(Q="search")),W.type=Q;var ee="none";Y===D.INITIAL_CAPS_ALL_CHARACTERS?ee="uppercase":Y===D.INITIAL_CAPS_WORD&&(ee="capitalize"),W.style.textTransform=ee}},_updateMaxLength:function(){var U=this._delegate.maxLength;U<0&&(U=65535),this._elem.maxLength=U},_initStyleSheet:function(){var U=this._elem;U.style.display="none",U.style.border=0,U.style.background="transparent",U.style.width="100%",U.style.height="100%",U.style.active=0,U.style.outline="medium",U.style.padding="0",U.style.textTransform="none",U.style.position="absolute",U.style.bottom="0px",U.style.left="2px",U.className="cocosEditBox",U.id=this._domId,this._isTextArea?(U.style.resize="none",U.style.overflow_y="scroll"):(U.type="text",U.style["-moz-appearance"]="textfield"),this._placeholderStyleSheet=document.createElement("style")},_updateStyleSheet:function(){var U=this._delegate,X=this._elem;X.value=U.string,X.placeholder=U.placeholder,this._updateTextLabel(U.textLabel),this._updatePlaceholderLabel(U.placeholderLabel)},_updateTextLabel:function(U){if(U){var X=U.font;X=!X||X instanceof cc.BitmapFont?U.fontFamily:X._fontFamily;var Y=U.fontSize*U.node.scaleY;if(this._textLabelFont!==X||this._textLabelFontSize!==Y||this._textLabelFontColor!==U.fontColor||this._textLabelAlign!==U.horizontalAlign){this._textLabelFont=X,this._textLabelFontSize=Y,this._textLabelFontColor=U.fontColor,this._textLabelAlign=U.horizontalAlign;var z=this._elem;switch(z.style.fontSize=Y+"px",z.style.color=U.node.color.toCSS(),z.style.fontFamily=X,U.horizontalAlign){case A.HorizontalAlign.LEFT:z.style.textAlign="left";break;case A.HorizontalAlign.CENTER:z.style.textAlign="center";break;case A.HorizontalAlign.RIGHT:z.style.textAlign="right"}}}},_updatePlaceholderLabel:function(U){if(U){var X=U.font;X=!X||X instanceof cc.BitmapFont?U.fontFamily:U.font._fontFamily;var Y=U.fontSize*U.node.scaleY;if(this._placeholderLabelFont!==X||this._placeholderLabelFontSize!==Y||this._placeholderLabelFontColor!==U.fontColor||this._placeholderLabelAlign!==U.horizontalAlign||this._placeholderLineHeight!==U.fontSize){this._placeholderLabelFont=X,this._placeholderLabelFontSize=Y,this._placeholderLabelFontColor=U.fontColor,this._placeholderLabelAlign=U.horizontalAlign,this._placeholderLineHeight=U.fontSize;var z,W=this._placeholderStyleSheet,Z=U.node.color.toCSS(),Q=U.fontSize;switch(U.horizontalAlign){case A.HorizontalAlign.LEFT:z="left";break;case A.HorizontalAlign.CENTER:z="center";break;case A.HorizontalAlign.RIGHT:z="right"}W.innerHTML="#"+this._domId+"::-webkit-input-placeholder,#"+this._domId+"::-moz-placeholder,#"+this._domId+":-ms-input-placeholder{text-transform: initial; font-family: "+X+"; font-size: "+Y+"px; color: "+Z+"; line-height: "+Q+"px; text-align: "+z+";}",cc.sys.browserType===cc.sys.BROWSER_TYPE_EDGE&&(W.innerHTML+="#"+this._domId+"::-ms-clear{display: none;}")}}},_registerEventListeners:function(){var U=this,X=this._elem,Y=!1,z=this._eventListeners;z.compositionStart=function(){Y=!0},z.compositionEnd=function(){Y=!1,U._delegate.editBoxTextChanged(X.value)},z.onInput=function(){if(!Y){var W=U._delegate.maxLength;W>=0&&(X.value=X.value.slice(0,W)),U._delegate.editBoxTextChanged(X.value)}},z.onClick=function(){U._editing&&cc.sys.isMobile&&U._adjustWindowScroll()},z.onKeydown=function(W){W.keyCode===w.KEY.enter?(W.stopPropagation(),U._delegate.editBoxEditingReturn(),U._isTextArea||X.blur()):W.keyCode===w.KEY.tab&&(W.stopPropagation(),W.preventDefault(),O.next(U))},z.onBlur=function(){cc.sys.isMobile&&Y&&z.compositionEnd(),U._editing=!1,F=null,U._hideDom(),U._delegate.editBoxEditingDidEnded()},X.addEventListener("compositionstart",z.compositionStart),X.addEventListener("compositionend",z.compositionEnd),X.addEventListener("input",z.onInput),X.addEventListener("keydown",z.onKeydown),X.addEventListener("blur",z.onBlur),X.addEventListener("touchstart",z.onClick)},_removeEventListeners:function(){var U=this._elem,X=this._eventListeners;U.removeEventListener("compositionstart",X.compositionStart),U.removeEventListener("compositionend",X.compositionEnd),U.removeEventListener("input",X.onInput),U.removeEventListener("keydown",X.onKeydown),U.removeEventListener("blur",X.onBlur),U.removeEventListener("touchstart",X.onClick),X.compositionStart=null,X.compositionEnd=null,X.onInput=null,X.onKeydown=null,X.onBlur=null,X.onClick=null}})},{"../../platform/CCMacro":201,"../../platform/utils":220,"../../value-types/mat4":288,"../CCLabel":108,"./tabIndexUtil":133,"./types":134}],133:[function(L,S){S.exports={_tabIndexList:[],add:function(T){var _=this._tabIndexList;_.indexOf(T)===-1&&_.push(T)},remove:function(T){var _=this._tabIndexList,w=_.indexOf(T);w!==-1&&_.splice(w,1)},resort:function(){this._tabIndexList.sort(function(T,_){return T._delegate._tabIndex-_._delegate._tabIndex})},next:function(T){var _=this._tabIndexList,w=_.indexOf(T);if(T.setFocus(!1),w!==-1){var B=_[w+1];B&&B._delegate._tabIndex>=0&&B.setFocus(!0)}}}},{}],134:[function(L,S){var T=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4,NEXT:5}),_=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),w=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5});S.exports={KeyboardReturnType:T,InputMode:_,InputFlag:w}},{}],135:[function(L,S){L("./CCComponent"),L("./CCComponentEventHandler"),L("./missing-script");var T=L("./SubContextView");T||(T=cc.Class({name:"cc.SubContextView",extends:cc.Component}),cc.SubContextView=cc.WXSubContextView=cc.SwanSubContextView=T);var _=[L("./CCSprite"),L("./CCWidget"),L("./CCCanvas"),L("./CCAudioSource"),L("./CCAnimation"),L("./CCButton"),L("./CCLabel"),L("./CCProgressBar"),L("./CCMask"),L("./CCScrollBar"),L("./CCScrollView"),L("./CCPageViewIndicator"),L("./CCPageView"),L("./CCSlider"),L("./CCLayout"),L("./editbox/CCEditBox"),L("./CCLabelOutline"),L("./CCLabelShadow"),L("./CCRichText"),L("./CCToggleContainer"),L("./CCToggleGroup"),L("./CCToggle"),L("./CCBlockInputEvents"),L("./CCMotionStreak"),L("./CCSafeArea"),T];S.exports=_},{"./CCAnimation":101,"./CCAudioSource":102,"./CCBlockInputEvents":103,"./CCButton":104,"./CCCanvas":105,"./CCComponent":106,"./CCComponentEventHandler":107,"./CCLabel":108,"./CCLabelOutline":109,"./CCLabelShadow":110,"./CCLayout":111,"./CCMask":112,"./CCMotionStreak":113,"./CCPageView":114,"./CCPageViewIndicator":115,"./CCProgressBar":116,"./CCRichText":118,"./CCSafeArea":119,"./CCScrollBar":120,"./CCScrollView":121,"./CCSlider":122,"./CCSprite":123,"./CCToggle":125,"./CCToggleContainer":126,"./CCToggleGroup":127,"./CCWidget":129,"./SubContextView":void 0,"./editbox/CCEditBox":130,"./missing-script":136}],136:[function(L,S){var T=cc.js,_=cc.Class({name:"cc.MissingScript",extends:cc.Component,editor:{inspector:"packages://inspector/inspectors/comps/missing-script.js"},properties:{compiled:{default:!1,serializable:!1},_$erialized:{default:null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(w){return T._getClassById(w)||(cc.deserialize.reportMissingClass(w),_)}},onLoad:function(){cc.warnID(4600,this.node.name)}});cc._MissingScript=S.exports=_},{}],137:[function(L,S){var T=cc.js;L("../event/event");var _=function(R,P){cc.Event.call(this,cc.Event.MOUSE,P),this._eventType=R,this._button=0,this._x=0,this._y=0,this._prevX=0,this._prevY=0,this._scrollX=0,this._scrollY=0};T.extend(_,cc.Event);var w=_.prototype;w.setScrollData=function(R,P){this._scrollX=R,this._scrollY=P},w.getScrollX=function(){return this._scrollX},w.getScrollY=function(){return this._scrollY},w.setLocation=function(R,P){this._x=R,this._y=P},w.getLocation=function(){return cc.v2(this._x,this._y)},w.getLocationInView=function(){return cc.v2(this._x,cc.view._designResolutionSize.height-this._y)},w._setPrevCursor=function(R,P){this._prevX=R,this._prevY=P},w.getPreviousLocation=function(){return cc.v2(this._prevX,this._prevY)},w.getDelta=function(){return cc.v2(this._x-this._prevX,this._y-this._prevY)},w.getDeltaX=function(){return this._x-this._prevX},w.getDeltaY=function(){return this._y-this._prevY},w.setButton=function(R){this._button=R},w.getButton=function(){return this._button},w.getLocationX=function(){return this._x},w.getLocationY=function(){return this._y},_.NONE=0,_.DOWN=1,_.UP=2,_.MOVE=3,_.SCROLL=4,_.BUTTON_LEFT=0,_.BUTTON_RIGHT=2,_.BUTTON_MIDDLE=1,_.BUTTON_4=3,_.BUTTON_5=4,_.BUTTON_6=5,_.BUTTON_7=6,_.BUTTON_8=7;var B=function(R,P){cc.Event.call(this,cc.Event.TOUCH,P),this._eventCode=0,this._touches=R||[],this.touch=null,this.currentTouch=null};T.extend(B,cc.Event),(w=B.prototype).getEventCode=function(){return this._eventCode},w.getTouches=function(){return this._touches},w._setEventCode=function(R){this._eventCode=R},w._setTouches=function(R){this._touches=R},w.setLocation=function(R,P){this.touch&&this.touch.setTouchInfo(this.touch.getID(),R,P)},w.getLocation=function(){return this.touch?this.touch.getLocation():cc.v2()},w.getLocationInView=function(){return this.touch?this.touch.getLocationInView():cc.v2()},w.getPreviousLocation=function(){return this.touch?this.touch.getPreviousLocation():cc.v2()},w.getStartLocation=function(){return this.touch?this.touch.getStartLocation():cc.v2()},w.getID=function(){return this.touch?this.touch.getID():null},w.getDelta=function(){return this.touch?this.touch.getDelta():cc.v2()},w.getDeltaX=function(){return this.touch?this.touch.getDelta().x:0},w.getDeltaY=function(){return this.touch?this.touch.getDelta().y:0},w.getLocationX=function(){return this.touch?this.touch.getLocationX():0},w.getLocationY=function(){return this.touch?this.touch.getLocationY():0},B.MAX_TOUCHES=5,B.BEGAN=0,B.MOVED=1,B.ENDED=2,B.CANCELED=3;var A=function(R,P){cc.Event.call(this,cc.Event.ACCELERATION,P),this.acc=R};T.extend(A,cc.Event);var O=function(R,P,E){cc.Event.call(this,cc.Event.KEYBOARD,E),this.keyCode=R,this.isPressed=P};T.extend(O,cc.Event),cc.Event.EventMouse=_,cc.Event.EventTouch=B,cc.Event.EventAcceleration=A,cc.Event.EventKeyboard=O,S.exports=cc.Event},{"../event/event":144}],138:[function(L,S){var T=L("../platform/js");cc.EventListener=function(E,D,I){this._onEvent=I,this._type=E||0,this._listenerID=D||"",this._registered=!1,this._fixedPriority=0,this._node=null,this._target=null,this._paused=!0,this._isEnabled=!0},cc.EventListener.prototype={constructor:cc.EventListener,_setPaused:function(E){this._paused=E},_isPaused:function(){return this._paused},_setRegistered:function(E){this._registered=E},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(E){this._fixedPriority=E},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(E){this._target=E,this._node=E},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return this._onEvent!==null},clone:function(){return null},setEnabled:function(E){this._isEnabled=E},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}},cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=6,cc.EventListener.CUSTOM=8;var _=cc.EventListener.ListenerID={MOUSE:"__cc_mouse",TOUCH_ONE_BY_ONE:"__cc_touch_one_by_one",TOUCH_ALL_AT_ONCE:"__cc_touch_all_at_once",KEYBOARD:"__cc_keyboard",ACCELERATION:"__cc_acceleration"},w=function(E,D){this._onCustomEvent=D,cc.EventListener.call(this,cc.EventListener.CUSTOM,E,this._callback)};T.extend(w,cc.EventListener),T.mixin(w.prototype,{_onCustomEvent:null,_callback:function(E){this._onCustomEvent!==null&&this._onCustomEvent(E)},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&this._onCustomEvent!==null},clone:function(){return new w(this._listenerID,this._onCustomEvent)}});var B=function(){cc.EventListener.call(this,cc.EventListener.MOUSE,_.MOUSE,this._callback)};T.extend(B,cc.EventListener),T.mixin(B.prototype,{onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,_callback:function(E){var D=cc.Event.EventMouse;switch(E._eventType){case D.DOWN:this.onMouseDown&&this.onMouseDown(E);break;case D.UP:this.onMouseUp&&this.onMouseUp(E);break;case D.MOVE:this.onMouseMove&&this.onMouseMove(E);break;case D.SCROLL:this.onMouseScroll&&this.onMouseScroll(E)}},clone:function(){var E=new B;return E.onMouseDown=this.onMouseDown,E.onMouseUp=this.onMouseUp,E.onMouseMove=this.onMouseMove,E.onMouseScroll=this.onMouseScroll,E},checkAvailable:function(){return!0}});var A=function(){cc.EventListener.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,_.TOUCH_ONE_BY_ONE,null),this._claimedTouches=[]};T.extend(A,cc.EventListener),T.mixin(A.prototype,{constructor:A,_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,setSwallowTouches:function(E){this.swallowTouches=E},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var E=new A;return E.onTouchBegan=this.onTouchBegan,E.onTouchMoved=this.onTouchMoved,E.onTouchEnded=this.onTouchEnded,E.onTouchCancelled=this.onTouchCancelled,E.swallowTouches=this.swallowTouches,E},checkAvailable:function(){return!!this.onTouchBegan||(cc.logID(1801),!1)}});var O=function(){cc.EventListener.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,_.TOUCH_ALL_AT_ONCE,null)};T.extend(O,cc.EventListener),T.mixin(O.prototype,{constructor:O,onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,clone:function(){var E=new O;return E.onTouchesBegan=this.onTouchesBegan,E.onTouchesMoved=this.onTouchesMoved,E.onTouchesEnded=this.onTouchesEnded,E.onTouchesCancelled=this.onTouchesCancelled,E},checkAvailable:function(){return this.onTouchesBegan!==null||this.onTouchesMoved!==null||this.onTouchesEnded!==null||this.onTouchesCancelled!==null||(cc.logID(1802),!1)}});var R=function(E){this._onAccelerationEvent=E,cc.EventListener.call(this,cc.EventListener.ACCELERATION,_.ACCELERATION,this._callback)};T.extend(R,cc.EventListener),T.mixin(R.prototype,{constructor:R,_onAccelerationEvent:null,_callback:function(E){this._onAccelerationEvent(E.acc,E)},checkAvailable:function(){return cc.assertID(this._onAccelerationEvent,1803),!0},clone:function(){return new R(this._onAccelerationEvent)}});var P=function(){cc.EventListener.call(this,cc.EventListener.KEYBOARD,_.KEYBOARD,this._callback)};T.extend(P,cc.EventListener),T.mixin(P.prototype,{constructor:P,onKeyPressed:null,onKeyReleased:null,_callback:function(E){E.isPressed?this.onKeyPressed&&this.onKeyPressed(E.keyCode,E):this.onKeyReleased&&this.onKeyReleased(E.keyCode,E)},clone:function(){var E=new P;return E.onKeyPressed=this.onKeyPressed,E.onKeyReleased=this.onKeyReleased,E},checkAvailable:function(){return this.onKeyPressed!==null||this.onKeyReleased!==null||(cc.logID(1800),!1)}}),cc.EventListener.create=function(E){cc.assertID(E&&E.event,1900);var D=E.event;delete E.event;var I=null;for(var M in D===cc.EventListener.TOUCH_ONE_BY_ONE?I=new A:D===cc.EventListener.TOUCH_ALL_AT_ONCE?I=new O:D===cc.EventListener.MOUSE?I=new B:D===cc.EventListener.CUSTOM?(I=new w(E.eventName,E.callback),delete E.eventName,delete E.callback):D===cc.EventListener.KEYBOARD?I=new P:D===cc.EventListener.ACCELERATION&&(I=new R(E.callback),delete E.callback),E)I[M]=E[M];return I},S.exports=cc.EventListener},{"../platform/js":217}],139:[function(L,S){var T=L("../platform/js");L("./CCEventListener");var _=cc.EventListener.ListenerID,w=function(){this._fixedListeners=[],this._sceneGraphListeners=[],this.gt0Index=0};w.prototype={constructor:w,size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return this._fixedListeners.length===0&&this._sceneGraphListeners.length===0},push:function(O){O._getFixedPriority()===0?this._sceneGraphListeners.push(O):this._fixedListeners.push(O)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}};var B=function(O){var R=cc.Event,P=O.type;return P===R.ACCELERATION?_.ACCELERATION:P===R.KEYBOARD?_.KEYBOARD:P.startsWith(R.MOUSE)?_.MOUSE:(P.startsWith(R.TOUCH)&&cc.logID(2e3),"")},A={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_toAddedListeners:[],_toRemovedListeners:[],_dirtyListeners:{},_inDispatch:0,_isEnabled:!1,_currentTouch:null,_currentTouchListener:null,_internalCustomListenerIDs:[],_setDirtyForNode:function(O){var R=this._nodeListenersMap[O._id];if(R)for(var P=0,E=R.length;P<E;P++){var D=R[P]._getListenerID();this._dirtyListeners[D]==null&&(this._dirtyListeners[D]=!0)}if(O.childrenCount>0)for(var I=O._children,M=0,N=I.length;M<N;M++)this._setDirtyForNode(I[M])},pauseTarget:function(O,R){if(O instanceof cc._BaseNode){var P,E,D=this._nodeListenersMap[O._id];if(D)for(P=0,E=D.length;P<E;P++){var I=D[P];I._setPaused(!0),I._claimedTouches&&I._claimedTouches.includes(this._currentTouch)&&this._clearCurTouch()}if(R===!0){var M=O._children;for(P=0,E=M?M.length:0;P<E;P++)this.pauseTarget(M[P],!0)}}else cc.warnID(3506)},resumeTarget:function(O,R){if(O instanceof cc._BaseNode){var P,E,D=this._nodeListenersMap[O._id];if(D)for(P=0,E=D.length;P<E;P++)D[P]._setPaused(!1);if(this._setDirtyForNode(O),R===!0){var I=O._children;for(P=0,E=I?I.length:0;P<E;P++)this.resumeTarget(I[P],!0)}}else cc.warnID(3506)},_addListener:function(O){this._inDispatch===0?this._forceAddEventListener(O):this._toAddedListeners.push(O)},_forceAddEventListener:function(O){var R=O._getListenerID(),P=this._listenersMap[R];if(P||(P=new w,this._listenersMap[R]=P),P.push(O),O._getFixedPriority()===0){this._setDirty(R,this.DIRTY_SCENE_GRAPH_PRIORITY);var E=O._getSceneGraphPriority();E===null&&cc.logID(3507),this._associateNodeAndEventListener(E,O),E.activeInHierarchy&&this.resumeTarget(E)}else this._setDirty(R,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(O){return this._listenersMap[O]},_updateDirtyFlagForSceneGraph:function(){var O=this._dirtyListeners;for(var R in O)this._setDirty(R,this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyListeners={}},_removeAllListenersInVector:function(O){if(O)for(var R,P=O.length-1;P>=0;P--)(R=O[P])._setRegistered(!1),R._getSceneGraphPriority()!=null&&(this._dissociateNodeAndEventListener(R._getSceneGraphPriority(),R),R._setSceneGraphPriority(null)),this._inDispatch===0&&cc.js.array.removeAt(O,P)},_removeListenersForListenerID:function(O){var R,P=this._listenersMap[O];if(P){var E=P.getFixedPriorityListeners(),D=P.getSceneGraphPriorityListeners();this._removeAllListenersInVector(D),this._removeAllListenersInVector(E),delete this._priorityDirtyFlagMap[O],this._inDispatch||(P.clear(),delete this._listenersMap[O])}var I,M=this._toAddedListeners;for(R=M.length-1;R>=0;R--)(I=M[R])&&I._getListenerID()===O&&cc.js.array.removeAt(M,R)},_sortEventListeners:function(O){var R=this.DIRTY_NONE,P=this._priorityDirtyFlagMap;P[O]&&(R=P[O]),R!==this.DIRTY_NONE&&(P[O]=this.DIRTY_NONE,R&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(O),R&this.DIRTY_SCENE_GRAPH_PRIORITY&&cc.director.getScene()&&this._sortListenersOfSceneGraphPriority(O))},_sortListenersOfSceneGraphPriority:function(O){var R=this._getListeners(O);if(R){var P=R.getSceneGraphPriorityListeners();P&&P.length!==0&&R.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes)}},_sortEventListenersOfSceneGraphPriorityDes:function(O,R){var P=O._getSceneGraphPriority(),E=R._getSceneGraphPriority();if(!(R&&E&&E._activeInHierarchy&&E._parent!==null))return-1;if(!O||!P||!P._activeInHierarchy||P._parent===null)return 1;for(var D=P,I=E,M=!1;D._parent._id!==I._parent._id;)D=D._parent._parent===null?(M=!0)&&E:D._parent,I=I._parent._parent===null?(M=!0)&&P:I._parent;if(D._id===I._id){if(D._id===E._id)return-1;if(D._id===P._id)return 1}return M?D._localZOrder-I._localZOrder:I._localZOrder-D._localZOrder},_sortListenersOfFixedPriority:function(O){var R=this._listenersMap[O];if(R){var P=R.getFixedPriorityListeners();if(P&&P.length!==0){P.sort(this._sortListenersOfFixedPriorityAsc);for(var E=0,D=P.length;E<D&&!(P[E]._getFixedPriority()>=0);)++E;R.gt0Index=E}}},_sortListenersOfFixedPriorityAsc:function(O,R){return O._getFixedPriority()-R._getFixedPriority()},_onUpdateListeners:function(O){var R,P,E,D=O.getFixedPriorityListeners(),I=O.getSceneGraphPriorityListeners(),M=this._toRemovedListeners;if(I)for(R=I.length-1;R>=0;R--)(P=I[R])._isRegistered()||(cc.js.array.removeAt(I,R),(E=M.indexOf(P))!==-1&&M.splice(E,1));if(D)for(R=D.length-1;R>=0;R--)(P=D[R])._isRegistered()||(cc.js.array.removeAt(D,R),(E=M.indexOf(P))!==-1&&M.splice(E,1));I&&I.length===0&&O.clearSceneGraphListeners(),D&&D.length===0&&O.clearFixedListeners()},frameUpdateListeners:function(){var O=this._listenersMap,R=this._priorityDirtyFlagMap;for(var P in O)O[P].empty()&&(delete R[P],delete O[P]);var E=this._toAddedListeners;if(E.length!==0){for(var D=0,I=E.length;D<I;D++)this._forceAddEventListener(E[D]);E.length=0}this._toRemovedListeners.length!==0&&this._cleanToRemovedListeners()},_updateTouchListeners:function(){var O=this._inDispatch;if(cc.assertID(O>0,3508),!(O>1)){var R;(R=this._listenersMap[_.TOUCH_ONE_BY_ONE])&&this._onUpdateListeners(R),(R=this._listenersMap[_.TOUCH_ALL_AT_ONCE])&&this._onUpdateListeners(R),cc.assertID(O===1,3509);var P=this._toAddedListeners;if(P.length!==0){for(var E=0,D=P.length;E<D;E++)this._forceAddEventListener(P[E]);this._toAddedListeners.length=0}this._toRemovedListeners.length!==0&&this._cleanToRemovedListeners()}},_cleanToRemovedListeners:function(){for(var O=this._toRemovedListeners,R=0;R<O.length;R++){var P=O[R],E=this._listenersMap[P._getListenerID()];if(E){var D,I=E.getFixedPriorityListeners(),M=E.getSceneGraphPriorityListeners();M&&(D=M.indexOf(P))!==-1&&M.splice(D,1),I&&(D=I.indexOf(P))!==-1&&I.splice(D,1)}}O.length=0},_onTouchEventCallback:function(O,R){if(!O._isRegistered())return!1;var P=R.event,E=P.currentTouch;P.currentTarget=O._node;var D,I=!1,M=P.getEventCode(),N=cc.Event.EventTouch;if(M===N.BEGAN){if(!cc.macro.ENABLE_MULTI_TOUCH&&A._currentTouch){var k=A._currentTouchListener._node;if(k&&k.activeInHierarchy)return!1}O.onTouchBegan&&(I=O.onTouchBegan(E,P))&&O._registered&&(O._claimedTouches.push(E),A._currentTouchListener=O,A._currentTouch=E)}else if(O._claimedTouches.length>0&&(D=O._claimedTouches.indexOf(E))!==-1){if(I=!0,!cc.macro.ENABLE_MULTI_TOUCH&&A._currentTouch&&A._currentTouch!==E)return!1;M===N.MOVED&&O.onTouchMoved?O.onTouchMoved(E,P):M===N.ENDED?(O.onTouchEnded&&O.onTouchEnded(E,P),O._registered&&O._claimedTouches.splice(D,1),A._clearCurTouch()):M===N.CANCELED&&(O.onTouchCancelled&&O.onTouchCancelled(E,P),O._registered&&O._claimedTouches.splice(D,1),A._clearCurTouch())}return P.isStopped()?(A._updateTouchListeners(P),!0):!(!I||!O.swallowTouches||(R.needsMutableSet&&R.touches.splice(E,1),0))},_dispatchTouchEvent:function(O){this._sortEventListeners(_.TOUCH_ONE_BY_ONE),this._sortEventListeners(_.TOUCH_ALL_AT_ONCE);var R=this._getListeners(_.TOUCH_ONE_BY_ONE),P=this._getListeners(_.TOUCH_ALL_AT_ONCE);if(R!==null||P!==null){var E=O.getTouches(),D=cc.js.array.copy(E),I={event:O,needsMutableSet:R&&P,touches:D,selTouch:null};if(R)for(var M=0;M<E.length;M++)O.currentTouch=E[M],O._propagationStopped=O._propagationImmediateStopped=!1,this._dispatchEventToListeners(R,this._onTouchEventCallback,I);P&&D.length>0&&(this._dispatchEventToListeners(P,this._onTouchesEventCallback,{event:O,touches:D}),O.isStopped())||this._updateTouchListeners(O)}},_onTouchesEventCallback:function(O,R){if(!O._registered)return!1;var P=cc.Event.EventTouch,E=R.event,D=R.touches,I=E.getEventCode();return E.currentTarget=O._node,I===P.BEGAN&&O.onTouchesBegan?O.onTouchesBegan(D,E):I===P.MOVED&&O.onTouchesMoved?O.onTouchesMoved(D,E):I===P.ENDED&&O.onTouchesEnded?O.onTouchesEnded(D,E):I===P.CANCELED&&O.onTouchesCancelled&&O.onTouchesCancelled(D,E),!!E.isStopped()&&(A._updateTouchListeners(E),!0)},_associateNodeAndEventListener:function(O,R){var P=this._nodeListenersMap[O._id];P||(P=[],this._nodeListenersMap[O._id]=P),P.push(R)},_dissociateNodeAndEventListener:function(O,R){var P=this._nodeListenersMap[O._id];P&&(cc.js.array.remove(P,R),P.length===0&&delete this._nodeListenersMap[O._id])},_dispatchEventToListeners:function(O,R,P){var E,D,I=!1,M=O.getFixedPriorityListeners(),N=O.getSceneGraphPriorityListeners(),k=0;if(M&&M.length!==0){for(;k<O.gt0Index;++k)if((D=M[k]).isEnabled()&&!D._isPaused()&&D._isRegistered()&&R(D,P)){I=!0;break}}if(N&&!I){for(E=0;E<N.length;E++)if((D=N[E]).isEnabled()&&!D._isPaused()&&D._isRegistered()&&R(D,P)){I=!0;break}}if(M&&!I){for(;k<M.length;++k)if((D=M[k]).isEnabled()&&!D._isPaused()&&D._isRegistered()&&R(D,P)){I=!0;break}}},_setDirty:function(O,R){var P=this._priorityDirtyFlagMap;P[O]==null?P[O]=R:P[O]=R|P[O]},_sortNumberAsc:function(O,R){return O-R},hasEventListener:function(O){return!!this._getListeners(O)},addListener:function(O,R){if(cc.assertID(O&&R,3503),cc.js.isNumber(R)||R instanceof cc._BaseNode){if(O instanceof cc.EventListener){if(O._isRegistered())return void cc.logID(3505)}else cc.assertID(!cc.js.isNumber(R),3504),O=cc.EventListener.create(O);if(O.checkAvailable()){if(cc.js.isNumber(R)){if(R===0)return void cc.logID(3500);O._setSceneGraphPriority(null),O._setFixedPriority(R),O._setRegistered(!0),O._setPaused(!1),this._addListener(O)}else O._setSceneGraphPriority(R),O._setFixedPriority(0),O._setRegistered(!0),this._addListener(O);return O}}else cc.warnID(3506)},addCustomListener:function(O,R){var P=new cc.EventListener.create({event:cc.EventListener.CUSTOM,eventName:O,callback:R});return this.addListener(P,1),P},removeListener:function(O){if(O!=null){var R,P=this._listenersMap;for(var E in P){var D=P[E],I=D.getFixedPriorityListeners(),M=D.getSceneGraphPriorityListeners();if((R=this._removeListenerInVector(M,O))?this._setDirty(O._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(R=this._removeListenerInVector(I,O))&&this._setDirty(O._getListenerID(),this.DIRTY_FIXED_PRIORITY),D.empty()&&(delete this._priorityDirtyFlagMap[O._getListenerID()],delete P[E]),R)break}if(!R)for(var N=this._toAddedListeners,k=N.length-1;k>=0;k--){var F=N[k];if(F===O){cc.js.array.removeAt(N,k),F._setRegistered(!1);break}}this._currentTouchListener===O&&this._clearCurTouch()}},_clearCurTouch:function(){this._currentTouchListener=null,this._currentTouch=null},_removeListenerInCallback:function(O,R){if(O==null)return!1;for(var P=O.length-1;P>=0;P--){var E=O[P];if(E._onCustomEvent===R||E._onEvent===R)return E._setRegistered(!1),E._getSceneGraphPriority()!=null&&(this._dissociateNodeAndEventListener(E._getSceneGraphPriority(),E),E._setSceneGraphPriority(null)),this._inDispatch===0?cc.js.array.removeAt(O,P):this._toRemovedListeners.push(E),!0}return!1},_removeListenerInVector:function(O,R){if(O==null)return!1;for(var P=O.length-1;P>=0;P--){var E=O[P];if(E===R)return E._setRegistered(!1),E._getSceneGraphPriority()!=null&&(this._dissociateNodeAndEventListener(E._getSceneGraphPriority(),E),E._setSceneGraphPriority(null)),this._inDispatch===0?cc.js.array.removeAt(O,P):this._toRemovedListeners.push(E),!0}return!1},removeListeners:function(O,R){var P=this;if(cc.js.isNumber(O)||O instanceof cc._BaseNode)if(O._id!==void 0){var E,D=P._nodeListenersMap[O._id];if(D){var I=cc.js.array.copy(D);for(E=0;E<I.length;E++)P.removeListener(I[E]);delete P._nodeListenersMap[O._id]}var M=P._toAddedListeners;for(E=0;E<M.length;){var N=M[E];N._getSceneGraphPriority()===O?(N._setSceneGraphPriority(null),N._setRegistered(!1),M.splice(E,1)):++E}if(R===!0){var k,F=O.children;for(E=0,k=F.length;E<k;E++)P.removeListeners(F[E],!0)}}else O===cc.EventListener.TOUCH_ONE_BY_ONE?P._removeListenersForListenerID(_.TOUCH_ONE_BY_ONE):O===cc.EventListener.TOUCH_ALL_AT_ONCE?P._removeListenersForListenerID(_.TOUCH_ALL_AT_ONCE):O===cc.EventListener.MOUSE?P._removeListenersForListenerID(_.MOUSE):O===cc.EventListener.ACCELERATION?P._removeListenersForListenerID(_.ACCELERATION):O===cc.EventListener.KEYBOARD?P._removeListenersForListenerID(_.KEYBOARD):cc.logID(3501);else cc.warnID(3506)},removeCustomListeners:function(O){this._removeListenersForListenerID(O)},removeAllListeners:function(){var O=this._listenersMap,R=this._internalCustomListenerIDs;for(var P in O)R.indexOf(P)===-1&&this._removeListenersForListenerID(P)},setPriority:function(O,R){if(O!=null){var P=this._listenersMap;for(var E in P){var D=P[E].getFixedPriorityListeners();if(D&&D.indexOf(O)!==-1)return O._getSceneGraphPriority()!=null&&cc.logID(3502),void(O._getFixedPriority()!==R&&(O._setFixedPriority(R),this._setDirty(O._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(O){this._isEnabled=O},isEnabled:function(){return this._isEnabled},dispatchEvent:function(O){if(this._isEnabled)if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,O&&O.getType){if(O.getType().startsWith(cc.Event.TOUCH))return this._dispatchTouchEvent(O),void this._inDispatch--;var R=B(O);this._sortEventListeners(R);var P=this._listenersMap[R];P!=null&&(this._dispatchEventToListeners(P,this._onListenerCallback,O),this._onUpdateListeners(P)),this._inDispatch--}else cc.errorID(3511)},_onListenerCallback:function(O,R){return R.currentTarget=O._target,O._onEvent(R),R.isStopped()},dispatchCustomEvent:function(O,R){var P=new cc.Event.EventCustom(O);P.setUserData(R),this.dispatchEvent(P)}};T.get(cc,"eventManager",function(){return cc.errorID(1405,"cc.eventManager","cc.EventTarget or cc.systemEvent"),A}),S.exports=cc.internal.eventManager=A},{"../platform/js":217,"./CCEventListener":138}],140:[function(){cc.Touch=function(L,S,T){this._lastModified=0,this.setTouchInfo(T,L,S)},cc.Touch.prototype={constructor:cc.Touch,getLocation:function(){return cc.v2(this._point.x,this._point.y)},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return cc.v2(this._prevPoint.x,this._prevPoint.y)},getStartLocation:function(){return cc.v2(this._startPoint.x,this._startPoint.y)},getDelta:function(){return this._point.sub(this._prevPoint)},getLocationInView:function(){return cc.v2(this._point.x,cc.view._designResolutionSize.height-this._point.y)},getPreviousLocationInView:function(){return cc.v2(this._prevPoint.x,cc.view._designResolutionSize.height-this._prevPoint.y)},getStartLocationInView:function(){return cc.v2(this._startPoint.x,cc.view._designResolutionSize.height-this._startPoint.y)},getID:function(){return this._id},setTouchInfo:function(L,S,T){this._prevPoint=this._point,this._point=cc.v2(S||0,T||0),this._id=L,this._startPointCaptured||(this._startPoint=cc.v2(this._point),cc.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(L,S){S===void 0?(this._point.x=L.x,this._point.y=L.y):(this._point.x=L,this._point.y=S)},_setPrevPoint:function(L,S){this._prevPoint=S===void 0?cc.v2(L.x,L.y):cc.v2(L||0,S||0)}}},{}],141:[function(L,S){L("./CCEvent"),L("./CCTouch"),L("./CCEventListener");var T=L("./CCEventManager");S.exports=T},{"./CCEvent":137,"./CCEventListener":138,"./CCEventManager":139,"./CCTouch":140}],142:[function(L,S){var T=cc.js,_=L("../platform/callbacks-invoker");function w(){_.call(this)}T.extend(w,_),w.prototype.emit=function(B,A){var O=B.type,R=this._callbackTable[O];if(R){var P=!R.isInvoking;R.isInvoking=!0;for(var E=R.callbackInfos,D=0,I=E.length;D<I;++D){var M=E[D];if(M&&M.callback&&(M.callback.call(M.target,B,A),B._propagationImmediateStopped))break}P&&(R.isInvoking=!1,R.containCanceled&&R.purgeCanceled())}},S.exports=w},{"../platform/callbacks-invoker":209}],143:[function(L,S){var T=L("../platform/js"),_=L("../platform/callbacks-invoker"),w=T.array.fastRemove;function B(){_.call(this)}T.extend(B,_);var A=B.prototype;A.__on=A.on,A.on=function(O,R,P,E){if(R)return this.hasEventListener(O,R,P)||(this.__on(O,R,P,E),P&&P.__eventTargets&&P.__eventTargets.push(this)),R;cc.errorID(6800)},A.__off=A.off,A.off=function(O,R,P){if(R)this.__off(O,R,P),P&&P.__eventTargets&&w(P.__eventTargets,this);else{var E=this._callbackTable[O];if(!E)return;for(var D=E.callbackInfos,I=0;I<D.length;++I){var M=D[I]&&D[I].target;M&&M.__eventTargets&&w(M.__eventTargets,this)}this.removeAll(O)}},A.targetOff=function(O){this.removeAll(O),O&&O.__eventTargets&&w(O.__eventTargets,this)},A.once=function(O,R,P){this.on(O,R,P,!0)},A.dispatchEvent=function(O){this.emit(O.type,O)},A.clear=function(){for(var O in this._callbackTable)for(var R=this._callbackTable[O].callbackInfos,P=R.length-1;P>=0;P--){var E=R[P];E&&this.off(O,E.callback,E.target)}},cc.EventTarget=S.exports=B},{"../platform/callbacks-invoker":209,"../platform/js":217}],144:[function(L,S){var T=L("../platform/js");cc.Event=function(B,A){this.type=B,this.bubbles=!!A,this.target=null,this.currentTarget=null,this.eventPhase=0,this._propagationStopped=!1,this._propagationImmediateStopped=!1},cc.Event.prototype={constructor:cc.Event,unuse:function(){this.type=cc.Event.NO_TYPE,this.target=null,this.currentTarget=null,this.eventPhase=cc.Event.NONE,this._propagationStopped=!1,this._propagationImmediateStopped=!1},reuse:function(B,A){this.type=B,this.bubbles=A||!1},stopPropagation:function(){this._propagationStopped=!0},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0},isStopped:function(){return this._propagationStopped||this._propagationImmediateStopped},getCurrentTarget:function(){return this.currentTarget},getType:function(){return this.type}},cc.Event.NO_TYPE="no_type",cc.Event.TOUCH="touch",cc.Event.MOUSE="mouse",cc.Event.KEYBOARD="keyboard",cc.Event.ACCELERATION="acceleration",cc.Event.NONE=0,cc.Event.CAPTURING_PHASE=1,cc.Event.AT_TARGET=2,cc.Event.BUBBLING_PHASE=3;var _=function(B,A){cc.Event.call(this,B,A),this.detail=null};T.extend(_,cc.Event),_.prototype.reset=_,_.prototype.setUserData=function(B){this.detail=B},_.prototype.getUserData=function(){return this.detail},_.prototype.getEventName=cc.Event.prototype.getType;var w=new T.Pool(10);_.put=function(B){w.put(B)},_.get=function(B,A){var O=w._get();return O?O.reset(B,A):O=new _(B,A),O},cc.Event.EventCustom=_,S.exports=cc.Event},{"../platform/js":217}],145:[function(L){L("./event"),L("./event-listeners"),L("./event-target"),L("./system-event")},{"./event":144,"./event-listeners":142,"./event-target":143,"./system-event":146}],146:[function(L,S){var T=L("../event/event-target"),_=L("../event-manager"),w=L("../platform/CCInputManager"),B=cc.Enum({KEY_DOWN:"keydown",KEY_UP:"keyup",DEVICEMOTION:"devicemotion"}),A=null,O=null,R=cc.Class({name:"SystemEvent",extends:T,statics:{EventType:B},setAccelerometerEnabled:function(P){P&&window.DeviceMotionEvent&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceMotionEvent.requestPermission().then(function(E){console.log("Device Motion Event request permission: "+E),w.setAccelerometerEnabled(E==="granted")}):w.setAccelerometerEnabled(P)},setAccelerometerInterval:function(P){w.setAccelerometerInterval(P)},on:function(P,E,D,I){this._super(P,E,D,I),P!==B.KEY_DOWN&&P!==B.KEY_UP||(A||(A=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(M,N){N.type=B.KEY_DOWN,cc.systemEvent.dispatchEvent(N)},onKeyReleased:function(M,N){N.type=B.KEY_UP,cc.systemEvent.dispatchEvent(N)}})),_.hasEventListener(cc.EventListener.ListenerID.KEYBOARD)||_.addListener(A,1)),P===B.DEVICEMOTION&&(O||(O=cc.EventListener.create({event:cc.EventListener.ACCELERATION,callback:function(M,N){N.type=B.DEVICEMOTION,cc.systemEvent.dispatchEvent(N)}})),_.hasEventListener(cc.EventListener.ListenerID.ACCELERATION)||_.addListener(O,1))},off:function(P,E,D){if(this._super(P,E,D),A&&(P===B.KEY_DOWN||P===B.KEY_UP)){var I=this.hasEventListener(B.KEY_DOWN),M=this.hasEventListener(B.KEY_UP);I||M||_.removeListener(A)}O&&P===B.DEVICEMOTION&&_.removeListener(O)}});cc.SystemEvent=S.exports=R,cc.systemEvent=new cc.SystemEvent},{"../event-manager":141,"../event/event-target":143,"../platform/CCInputManager":200}],147:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=A(L("../value-types/vec3")),w=A(L("../value-types/mat3")),B=A(L("./enums"));function A(I){return I&&I.__esModule?I:{default:I}}var O=new _.default,R=new _.default,P=new w.default,E=function(I,M,N){var k=P.m,F=N.m;k[0]=Math.abs(F[0]),k[1]=Math.abs(F[1]),k[2]=Math.abs(F[2]),k[3]=Math.abs(F[4]),k[4]=Math.abs(F[5]),k[5]=Math.abs(F[6]),k[6]=Math.abs(F[8]),k[7]=Math.abs(F[9]),k[8]=Math.abs(F[10]),_.default.transformMat3(I,M,P)},D=function(){function I(N,k,F,G,V,j){this.center=void 0,this.halfExtents=void 0,this._type=void 0,this._type=B.default.SHAPE_AABB,this.center=new _.default(N,k,F),this.halfExtents=new _.default(G,V,j)}I.create=function(N,k,F,G,V,j){return new I(N,k,F,G,V,j)},I.clone=function(N){return new I(N.center.x,N.center.y,N.center.z,N.halfExtents.x,N.halfExtents.y,N.halfExtents.z)},I.copy=function(N,k){return _.default.copy(N.center,k.center),_.default.copy(N.halfExtents,k.halfExtents),N},I.fromPoints=function(N,k,F){return _.default.scale(N.center,_.default.add(O,k,F),.5),_.default.scale(N.halfExtents,_.default.sub(R,F,k),.5),N},I.set=function(N,k,F,G,V,j,H){return _.default.set(N.center,k,F,G),_.default.set(N.halfExtents,V,j,H),N};var M=I.prototype;return M.getBoundary=function(N,k){_.default.sub(N,this.center,this.halfExtents),_.default.add(k,this.center,this.halfExtents)},M.transform=function(N,k,F,G,V){V||(V=this),_.default.transformMat4(V.center,this.center,N),E(V.halfExtents,this.halfExtents,N)},I}();T.default=D,S.exports=T.default},{"../value-types/mat3":287,"../value-types/vec3":296,"./enums":149}],148:[function(L,S,T){T.__esModule=!0,T.point_plane=I,T.pt_point_aabb=function(M,N,k){return _.Vec3.copy(M,N),_.Vec3.subtract(R,k.center,k.halfExtents),_.Vec3.add(P,k.center,k.halfExtents),M.x=M.x<R.x?R.x:M.x,M.y=M.y<R.x?R.y:M.y,M.z=M.z<R.x?R.z:M.z,M.x=M.x>P.x?P.x:M.x,M.y=M.y>P.x?P.y:M.y,M.z=M.z>P.x?P.z:M.z,M},T.pt_point_obb=function(M,N,k){var F=k.orientation.m;_.Vec3.set(w,F[0],F[1],F[2]),_.Vec3.set(B,F[3],F[4],F[5]),_.Vec3.set(A,F[6],F[7],F[8]),E[0]=w,E[1]=B,E[2]=A,D[0]=k.halfExtents.x,D[1]=k.halfExtents.y,D[2]=k.halfExtents.z,_.Vec3.subtract(O,N,k.center),_.Vec3.set(M,k.center.x,k.center.y,k.center.z);for(var G=0;G<3;G++){var V=_.Vec3.dot(O,E[G]);V>D[G]&&(V=D[G]),V<-D[G]&&(V=-D[G]),M.x+=V*E[G].x,M.y+=V*E[G].y,M.z+=V*E[G].z}return M},T.pt_point_plane=function(M,N,k){var F=I(N,k);return _.Vec3.subtract(M,N,_.Vec3.multiplyScalar(M,k.n,F))};var _=L("../value-types"),w=new _.Vec3,B=new _.Vec3,A=new _.Vec3,O=new _.Vec3,R=new _.Vec3,P=new _.Vec3,E=new Array(3),D=new Array(3);function I(M,N){return _.Vec3.dot(N.n,M)-N.d}},{"../value-types":286}],149:[function(L,S,T){T.__esModule=!0,T.default=void 0,T.default={SHAPE_RAY:1,SHAPE_LINE:2,SHAPE_SPHERE:4,SHAPE_AABB:8,SHAPE_OBB:16,SHAPE_PLANE:32,SHAPE_TRIANGLE:64,SHAPE_FRUSTUM:128,SHAPE_FRUSTUM_ACCURATE:256},S.exports=T.default},{}],150:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("../value-types"),w=A(L("./enums")),B=A(L("./plane"));function A(D){return D&&D.__esModule?D:{default:D}}function O(D,I){for(var M=0;M<I.length;M++){var N=I[M];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(D,N.key,N)}}var R=new Array(8);R[0]=new _.Vec3(1,1,1),R[1]=new _.Vec3(-1,1,1),R[2]=new _.Vec3(-1,-1,1),R[3]=new _.Vec3(1,-1,1),R[4]=new _.Vec3(1,1,-1),R[5]=new _.Vec3(-1,1,-1),R[6]=new _.Vec3(-1,-1,-1),R[7]=new _.Vec3(1,-1,-1);var P,E=function(){function D(){this.planes=void 0,this.vertices=void 0,this._type=void 0,this._type=w.default.SHAPE_FRUSTUM,this.planes=new Array(6);for(var k=0;k<6;++k)this.planes[k]=B.default.create(0,0,0,0);this.vertices=new Array(8);for(var F=0;F<8;++F)this.vertices[F]=new _.Vec3}D.create=function(){return new D},D.clone=function(k){return D.copy(new D,k)},D.copy=function(k,F){k._type=F._type;for(var G=0;G<6;++G)B.default.copy(k.planes[G],F.planes[G]);for(var V=0;V<8;++V)_.Vec3.copy(k.vertices[V],F.vertices[V]);return k};var I,M,N=D.prototype;return N.update=function(k,F){var G=k.m;if(_.Vec3.set(this.planes[0].n,G[3]+G[0],G[7]+G[4],G[11]+G[8]),this.planes[0].d=-(G[15]+G[12]),_.Vec3.set(this.planes[1].n,G[3]-G[0],G[7]-G[4],G[11]-G[8]),this.planes[1].d=-(G[15]-G[12]),_.Vec3.set(this.planes[2].n,G[3]+G[1],G[7]+G[5],G[11]+G[9]),this.planes[2].d=-(G[15]+G[13]),_.Vec3.set(this.planes[3].n,G[3]-G[1],G[7]-G[5],G[11]-G[9]),this.planes[3].d=-(G[15]-G[13]),_.Vec3.set(this.planes[4].n,G[3]+G[2],G[7]+G[6],G[11]+G[10]),this.planes[4].d=-(G[15]+G[14]),_.Vec3.set(this.planes[5].n,G[3]-G[2],G[7]-G[6],G[11]-G[10]),this.planes[5].d=-(G[15]-G[14]),this._type===w.default.SHAPE_FRUSTUM_ACCURATE){for(var V=0;V<6;V++){var j=this.planes[V],H=1/j.n.length();_.Vec3.multiplyScalar(j.n,j.n,H),j.d*=H}for(var U=0;U<8;U++)_.Vec3.transformMat4(this.vertices[U],R[U],F)}},N.transform=function(k){if(this._type===w.default.SHAPE_FRUSTUM_ACCURATE){for(var F=0;F<8;F++)_.Vec3.transformMat4(this.vertices[F],this.vertices[F],k);B.default.fromPoints(this.planes[0],this.vertices[1],this.vertices[5],this.vertices[6]),B.default.fromPoints(this.planes[1],this.vertices[3],this.vertices[7],this.vertices[4]),B.default.fromPoints(this.planes[2],this.vertices[6],this.vertices[7],this.vertices[3]),B.default.fromPoints(this.planes[3],this.vertices[0],this.vertices[4],this.vertices[5]),B.default.fromPoints(this.planes[4],this.vertices[2],this.vertices[3],this.vertices[0]),B.default.fromPoints(this.planes[0],this.vertices[7],this.vertices[6],this.vertices[5])}},I=D,(M=[{key:"accurate",set:function(k){this._type=k?w.default.SHAPE_FRUSTUM_ACCURATE:w.default.SHAPE_FRUSTUM}}])&&O(I.prototype,M),Object.defineProperty(I,"prototype",{writable:!1}),D}();T.default=E,E.createOrtho=(P=new _.Vec3,function(D,I,M,N,k,F){var G=I/2,V=M/2;_.Vec3.set(P,G,V,N),_.Vec3.transformMat4(D.vertices[0],P,F),_.Vec3.set(P,-G,V,N),_.Vec3.transformMat4(D.vertices[1],P,F),_.Vec3.set(P,-G,-V,N),_.Vec3.transformMat4(D.vertices[2],P,F),_.Vec3.set(P,G,-V,N),_.Vec3.transformMat4(D.vertices[3],P,F),_.Vec3.set(P,G,V,k),_.Vec3.transformMat4(D.vertices[4],P,F),_.Vec3.set(P,-G,V,k),_.Vec3.transformMat4(D.vertices[5],P,F),_.Vec3.set(P,-G,-V,k),_.Vec3.transformMat4(D.vertices[6],P,F),_.Vec3.set(P,G,-V,k),_.Vec3.transformMat4(D.vertices[7],P,F),B.default.fromPoints(D.planes[0],D.vertices[1],D.vertices[6],D.vertices[5]),B.default.fromPoints(D.planes[1],D.vertices[3],D.vertices[4],D.vertices[7]),B.default.fromPoints(D.planes[2],D.vertices[6],D.vertices[3],D.vertices[7]),B.default.fromPoints(D.planes[3],D.vertices[0],D.vertices[5],D.vertices[4]),B.default.fromPoints(D.planes[4],D.vertices[2],D.vertices[0],D.vertices[3]),B.default.fromPoints(D.planes[0],D.vertices[7],D.vertices[5],D.vertices[6])}),S.exports=T.default},{"../value-types":286,"./enums":149,"./plane":155}],151:[function(L,S,T){T.__esModule=!0;var _={enums:!0,Triangle:!0,Aabb:!0,Ray:!0,intersect:!0,Sphere:!0,Obb:!0,Frustum:!0,Line:!0,Plane:!0};T.intersect=T.enums=T.Triangle=T.Sphere=T.Ray=T.Plane=T.Obb=T.Line=T.Frustum=T.Aabb=void 0;var w=k(L("./enums"));T.enums=w.default;var B=k(L("./triangle"));T.Triangle=B.default;var A=k(L("./aabb"));T.Aabb=A.default;var O=k(L("./ray"));T.Ray=O.default;var R=k(L("./intersect"));T.intersect=R.default;var P=k(L("./sphere"));T.Sphere=P.default;var E=k(L("./obb"));T.Obb=E.default;var D=k(L("./frustum"));T.Frustum=D.default;var I=k(L("./line"));T.Line=I.default;var M=k(L("./plane"));T.Plane=M.default;var N=L("./distance");function k(F){return F&&F.__esModule?F:{default:F}}Object.keys(N).forEach(function(F){F!=="default"&&F!=="__esModule"&&(Object.prototype.hasOwnProperty.call(_,F)||F in T&&T[F]===N[F]||(T[F]=N[F]))}),cc.geomUtils=S.exports},{"./aabb":147,"./distance":148,"./enums":149,"./frustum":150,"./intersect":152,"./line":153,"./obb":154,"./plane":155,"./ray":156,"./sphere":157,"./triangle":158}],152:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=I(L("../../renderer/gfx")),w=I(L("../../renderer/memop/recycle-pool")),B=L("../value-types"),A=I(L("./aabb")),O=function(Ze){if(Ze&&Ze.__esModule)return Ze;if(Ze===null||typeof Ze!="object"&&typeof Ze!="function")return{default:Ze};var Xe=D(void 0);if(Xe&&Xe.has(Ze))return Xe.get(Ze);var $e={},ot=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ut in Ze)if(ut!=="default"&&Object.prototype.hasOwnProperty.call(Ze,ut)){var gt=ot?Object.getOwnPropertyDescriptor(Ze,ut):null;gt&&(gt.get||gt.set)?Object.defineProperty($e,ut,gt):$e[ut]=Ze[ut]}return $e.default=Ze,Xe&&Xe.set(Ze,$e),$e}(L("./distance")),R=I(L("./enums")),P=I(L("./ray")),E=I(L("./triangle"));function D(Ze){if(typeof WeakMap!="function")return null;var Xe=new WeakMap,$e=new WeakMap;return(D=function(ot){return ot?$e:Xe})(Ze)}function I(Ze){return Ze&&Ze.__esModule?Ze:{default:Ze}}var M,N,k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee=function(){var Ze=E.default.create(),Xe=1/0;function $e(ot,ut,gt,Ue){B.Vec3.set(ot,ut[gt*Ue],ut[gt*Ue+1],ut[gt*Ue+2])}return function(ot,ut){Xe=1/0;for(var gt=ut._subMeshes,Ue=0;Ue<gt.length;Ue++)if(gt[Ue]._primitiveType===_.default.PT_TRIANGLES)for(var We=ut._subDatas[Ue]||ut._subDatas[0],ht=ut._getAttrMeshData(Ue,_.default.ATTR_POSITION),Be=We.getIData(Uint16Array),je=We.vfm.element(_.default.ATTR_POSITION).num,Qe=0;Qe<Be.length;Qe+=3){$e(Ze.a,ht,Be[Qe],je),$e(Ze.b,ht,Be[Qe+1],je),$e(Ze.c,ht,Be[Qe+2],je);var st=ne(ot,Ze);st>0&&st<Xe&&(Xe=st)}return Xe}}(),te=function(){function Ze(pt,qe){for(var rt=pt.children,bt=rt.length-1;bt>=0;bt--)Ze(rt[bt],qe);qe(pt)}function Xe(pt,qe){return pt.distance-qe.distance}function $e(pt,qe,rt){var bt=rt.m,Dt=qe.x,Et=qe.y,Lt=qe.z,Ot=bt[3]*Dt+bt[7]*Et+bt[11]*Lt;return Ot=Ot?1/Ot:1,pt.x=(bt[0]*Dt+bt[4]*Et+bt[8]*Lt)*Ot,pt.y=(bt[1]*Dt+bt[5]*Et+bt[9]*Lt)*Ot,pt.z=(bt[2]*Dt+bt[6]*Et+bt[10]*Lt)*Ot,pt}var ot=new w.default(function(){return{distance:0,node:null}},1),ut=[],gt=A.default.create(),Ue=new B.Vec3,We=new B.Vec3,ht=new P.default,Be=cc.mat4(),je=cc.mat4(),Qe=new B.Vec3;function st(pt){return pt>0&&pt<1/0}return function(pt,qe,rt,bt){return ot.reset(),ut.length=0,Ze(pt=pt||cc.director.getScene(),function(Dt){if(!bt||bt(Dt)){B.Mat4.invert(je,Dt.getWorldMatrix(Be)),B.Vec3.transformMat4(ht.o,qe.o,je),B.Vec3.normalize(ht.d,$e(ht.d,qe.d,je));var Et=1/0,Lt=Dt._renderComponent;if(Lt instanceof cc.MeshRenderer?Et=le(ht,Lt._boundingBox):Dt.width&&Dt.height&&(B.Vec3.set(Ue,-Dt.width*Dt.anchorX,-Dt.height*Dt.anchorY,Dt.z),B.Vec3.set(We,Dt.width*(1-Dt.anchorX),Dt.height*(1-Dt.anchorY),Dt.z),A.default.fromPoints(gt,Ue,We),Et=le(ht,gt)),st(Et)&&(rt&&(Et=rt(ht,Dt,Et)),st(Et))){B.Vec3.scale(Qe,ht.d,Et),$e(Qe,Qe,Be);var Ot=ot.add();Ot.node=Dt,Ot.distance=B.Vec3.mag(Qe),ut.push(Ot)}}}),ut.sort(Xe),ut}}(),re=(M=new B.Vec3(0,0,0),function(Ze,Xe){var $e=B.Vec3.dot(Ze.d,Xe.n);if(Math.abs($e)<Number.EPSILON)return 0;B.Vec3.multiplyScalar(M,Xe.n,Xe.d);var ot=B.Vec3.dot(B.Vec3.subtract(M,M,Ze.o),Xe.n)/$e;return ot<0?0:ot}),ie=(N=new B.Vec3(0,0,0),function(Ze,Xe){B.Vec3.subtract(N,Ze.e,Ze.s);var $e=(Xe.d-B.Vec3.dot(Ze.s,Xe.n))/B.Vec3.dot(N,Xe.n);return $e<0||$e>1?0:$e}),ne=function(){var Ze=new B.Vec3(0,0,0),Xe=new B.Vec3(0,0,0),$e=new B.Vec3(0,0,0),ot=new B.Vec3(0,0,0),ut=new B.Vec3(0,0,0);return function(gt,Ue,We){B.Vec3.subtract(Ze,Ue.b,Ue.a),B.Vec3.subtract(Xe,Ue.c,Ue.a),B.Vec3.cross($e,gt.d,Xe);var ht=B.Vec3.dot(Ze,$e);if(ht<Number.EPSILON&&(!We||ht>-Number.EPSILON))return 0;var Be=1/ht;B.Vec3.subtract(ot,gt.o,Ue.a);var je=B.Vec3.dot(ot,$e)*Be;if(je<0||je>1)return 0;B.Vec3.cross(ut,ot,Ze);var Qe=B.Vec3.dot(gt.d,ut)*Be;if(Qe<0||je+Qe>1)return 0;var st=B.Vec3.dot(Xe,ut)*Be;return st<0?0:st}}(),he=ne,pe=function(){var Ze=new B.Vec3(0,0,0),Xe=new B.Vec3(0,0,0),$e=new B.Vec3(0,0,0),ot=new B.Vec3(0,0,0),ut=new B.Vec3(0,0,0),gt=new B.Vec3(0,0,0);return function(Ue,We,ht){B.Vec3.subtract(Ze,We.b,We.a),B.Vec3.subtract(Xe,We.c,We.a),B.Vec3.subtract($e,Ue.s,Ue.e),B.Vec3.cross(ut,Ze,Xe);var Be=B.Vec3.dot($e,ut);if(Be<=0)return 0;B.Vec3.subtract(ot,Ue.s,We.a);var je=B.Vec3.dot(ot,ut);if(je<0||je>Be)return 0;B.Vec3.cross(gt,$e,ot);var Qe=B.Vec3.dot(Xe,gt);if(Qe<0||Qe>Be)return 0;var st=-B.Vec3.dot(Ze,gt);if(st<0||Qe+st>Be)return 0;if(ht){var pt=1/Be,qe=1-(Qe*=pt)-(st*=pt);B.Vec3.set(ht,We.a.x*qe+We.b.x*Qe+We.c.x*st,We.a.y*qe+We.b.y*Qe+We.c.y*st,We.a.z*qe+We.b.z*Qe+We.c.z*st)}return 1}}(),K=(k=new B.Vec3(0,0,0),F=new B.Vec3(0,0,0),G=new B.Vec3(0,0,0),V=new B.Vec3(0,0,0),j=new B.Vec3(0,0,0),H=new B.Vec3(0,0,0),U=new B.Vec3(0,0,0),function(Ze,Xe,$e,ot,ut,gt,Ue){B.Vec3.subtract(k,Xe,Ze),B.Vec3.subtract(F,$e,Ze),B.Vec3.subtract(G,ot,Ze),B.Vec3.subtract(V,ut,Ze),B.Vec3.cross(H,V,k);var We=B.Vec3.dot(F,H);if(We>=0){var ht=-B.Vec3.dot(G,H);if(ht<0)return 0;var Be=B.Vec3.dot(B.Vec3.cross(U,k,G),F);if(Be<0)return 0;if(Ue){var je=1/(ht+We+Be);ht*=je,We*=je,Be*=je,B.Vec3.set(Ue,$e.x*ht+ot.x*We+ut.x*Be,$e.y*ht+ot.y*We+ut.y*Be,$e.z*ht+ot.z*We+ut.z*Be)}}else{B.Vec3.subtract(j,gt,Ze);var Qe=B.Vec3.dot(j,H);if(Qe<0)return 0;var st=B.Vec3.dot(B.Vec3.cross(U,k,F),j);if(st<0)return 0;if(Ue){var pt=1/(Qe+(We=-We)+st);Qe*=pt,We*=pt,st*=pt,B.Vec3.set(Ue,$e.x*Qe+gt.x*We+ut.x*st,$e.y*Qe+gt.y*We+ut.y*st,$e.z*Qe+gt.z*We+ut.z*st)}}return 1}),ue=function(){var Ze=new B.Vec3(0,0,0);return function(Xe,$e){var ot=$e.radius,ut=$e.center,gt=Xe.o,Ue=Xe.d,We=ot*ot;B.Vec3.subtract(Ze,ut,gt);var ht=Ze.lengthSqr(),Be=B.Vec3.dot(Ze,Ue),je=We-(ht-Be*Be);if(je<0)return 0;var Qe=Math.sqrt(je),st=ht<We?Be+Qe:Be-Qe;return st<0?0:st}}(),le=(X=new B.Vec3,Y=new B.Vec3,function(Ze,Xe){var $e=Ze.o,ot=Ze.d,ut=1/ot.x,gt=1/ot.y,Ue=1/ot.z;B.Vec3.subtract(X,Xe.center,Xe.halfExtents),B.Vec3.add(Y,Xe.center,Xe.halfExtents);var We=(X.x-$e.x)*ut,ht=(Y.x-$e.x)*ut,Be=(X.y-$e.y)*gt,je=(Y.y-$e.y)*gt,Qe=(X.z-$e.z)*Ue,st=(Y.z-$e.z)*Ue,pt=Math.max(Math.max(Math.min(We,ht),Math.min(Be,je)),Math.min(Qe,st)),qe=Math.min(Math.min(Math.max(We,ht),Math.max(Be,je)),Math.max(Qe,st));return qe<0||pt>qe?0:pt}),ce=le,_e=function(){var Ze=new B.Vec3,Xe=new B.Vec3,$e=new B.Vec3,ot=new B.Vec3,ut=new B.Vec3,gt=new B.Vec3,Ue=new B.Vec3,We=new Array(3),ht=new Array(3),Be=new Array(3),je=new Array(6);return function(Qe,st){We[0]=st.halfExtents.x,We[1]=st.halfExtents.y,We[2]=st.halfExtents.z,Ze=st.center,Xe=Qe.o,$e=Qe.d;var pt=st.orientation.m;B.Vec3.set(ot,pt[0],pt[1],pt[2]),B.Vec3.set(ut,pt[3],pt[4],pt[5]),B.Vec3.set(gt,pt[6],pt[7],pt[8]),B.Vec3.subtract(Ue,Ze,Xe),ht[0]=B.Vec3.dot(ot,$e),ht[1]=B.Vec3.dot(ut,$e),ht[2]=B.Vec3.dot(gt,$e),Be[0]=B.Vec3.dot(ot,Ue),Be[1]=B.Vec3.dot(ut,Ue),Be[2]=B.Vec3.dot(gt,Ue);for(var qe=0;qe<3;++qe){if(ht[qe]===0){if(-Be[qe]-We[qe]>0||-Be[qe]+We[qe]<0)return 0;ht[qe]=1e-7}je[2*qe+0]=(Be[qe]+We[qe])/ht[qe],je[2*qe+1]=(Be[qe]-We[qe])/ht[qe]}var rt=Math.max(Math.max(Math.min(je[0],je[1]),Math.min(je[2],je[3])),Math.min(je[4],je[5])),bt=Math.min(Math.min(Math.max(je[0],je[1]),Math.max(je[2],je[3])),Math.max(je[4],je[5]));return bt<0||rt>bt||rt<0?0:rt}}(),oe=(z=new B.Vec3,W=new B.Vec3,Z=new B.Vec3,Q=new B.Vec3,function(Ze,Xe){return B.Vec3.subtract(z,Ze.center,Ze.halfExtents),B.Vec3.add(W,Ze.center,Ze.halfExtents),B.Vec3.subtract(Z,Xe.center,Xe.halfExtents),B.Vec3.add(Q,Xe.center,Xe.halfExtents),z.x<=Q.x&&W.x>=Z.x&&z.y<=Q.y&&W.y>=Z.y&&z.z<=Q.z&&W.z>=Z.z});function de(Ze,Xe,$e){B.Vec3.set($e[0],Ze.x,Xe.y,Xe.z),B.Vec3.set($e[1],Ze.x,Xe.y,Ze.z),B.Vec3.set($e[2],Ze.x,Ze.y,Xe.z),B.Vec3.set($e[3],Ze.x,Ze.y,Ze.z),B.Vec3.set($e[4],Xe.x,Xe.y,Xe.z),B.Vec3.set($e[5],Xe.x,Xe.y,Ze.z),B.Vec3.set($e[6],Xe.x,Ze.y,Xe.z),B.Vec3.set($e[7],Xe.x,Ze.y,Ze.z)}function me(Ze,Xe,$e,ot,ut,gt){B.Vec3.set(gt[0],Ze.x+$e.x*Xe.x+ot.x*Xe.y+ut.x*Xe.z,Ze.y+$e.y*Xe.x+ot.y*Xe.y+ut.y*Xe.z,Ze.z+$e.z*Xe.x+ot.z*Xe.y+ut.z*Xe.z),B.Vec3.set(gt[1],Ze.x-$e.x*Xe.x+ot.x*Xe.y+ut.x*Xe.z,Ze.y-$e.y*Xe.x+ot.y*Xe.y+ut.y*Xe.z,Ze.z-$e.z*Xe.x+ot.z*Xe.y+ut.z*Xe.z),B.Vec3.set(gt[2],Ze.x+$e.x*Xe.x-ot.x*Xe.y+ut.x*Xe.z,Ze.y+$e.y*Xe.x-ot.y*Xe.y+ut.y*Xe.z,Ze.z+$e.z*Xe.x-ot.z*Xe.y+ut.z*Xe.z),B.Vec3.set(gt[3],Ze.x+$e.x*Xe.x+ot.x*Xe.y-ut.x*Xe.z,Ze.y+$e.y*Xe.x+ot.y*Xe.y-ut.y*Xe.z,Ze.z+$e.z*Xe.x+ot.z*Xe.y-ut.z*Xe.z),B.Vec3.set(gt[4],Ze.x-$e.x*Xe.x-ot.x*Xe.y-ut.x*Xe.z,Ze.y-$e.y*Xe.x-ot.y*Xe.y-ut.y*Xe.z,Ze.z-$e.z*Xe.x-ot.z*Xe.y-ut.z*Xe.z),B.Vec3.set(gt[5],Ze.x+$e.x*Xe.x-ot.x*Xe.y-ut.x*Xe.z,Ze.y+$e.y*Xe.x-ot.y*Xe.y-ut.y*Xe.z,Ze.z+$e.z*Xe.x-ot.z*Xe.y-ut.z*Xe.z),B.Vec3.set(gt[6],Ze.x-$e.x*Xe.x+ot.x*Xe.y-ut.x*Xe.z,Ze.y-$e.y*Xe.x+ot.y*Xe.y-ut.y*Xe.z,Ze.z-$e.z*Xe.x+ot.z*Xe.y-ut.z*Xe.z),B.Vec3.set(gt[7],Ze.x-$e.x*Xe.x-ot.x*Xe.y+ut.x*Xe.z,Ze.y-$e.y*Xe.x-ot.y*Xe.y+ut.y*Xe.z,Ze.z-$e.z*Xe.x-ot.z*Xe.y+ut.z*Xe.z)}function ye(Ze,Xe){for(var $e=B.Vec3.dot(Xe,Ze[0]),ot=$e,ut=1;ut<8;++ut){var gt=B.Vec3.dot(Xe,Ze[ut]);$e=gt<$e?gt:$e,ot=gt>ot?gt:ot}return[$e,ot]}var ge,we=function(){for(var Ze=new Array(15),Xe=0;Xe<15;Xe++)Ze[Xe]=new B.Vec3(0,0,0);for(var $e=new Array(8),ot=new Array(8),ut=0;ut<8;ut++)$e[ut]=new B.Vec3(0,0,0),ot[ut]=new B.Vec3(0,0,0);var gt=new B.Vec3,Ue=new B.Vec3;return function(We,ht){var Be=ht.orientation.m;B.Vec3.set(Ze[0],1,0,0),B.Vec3.set(Ze[1],0,1,0),B.Vec3.set(Ze[2],0,0,1),B.Vec3.set(Ze[3],Be[0],Be[1],Be[2]),B.Vec3.set(Ze[4],Be[3],Be[4],Be[5]),B.Vec3.set(Ze[5],Be[6],Be[7],Be[8]);for(var je=0;je<3;++je)B.Vec3.cross(Ze[6+3*je],Ze[je],Ze[0]),B.Vec3.cross(Ze[7+3*je],Ze[je],Ze[1]),B.Vec3.cross(Ze[7+3*je],Ze[je],Ze[2]);B.Vec3.subtract(gt,We.center,We.halfExtents),B.Vec3.add(Ue,We.center,We.halfExtents),de(gt,Ue,$e),me(ht.center,ht.halfExtents,Ze[3],Ze[4],Ze[5],ot);for(var Qe=0;Qe<15;++Qe){var st=ye($e,Ze[Qe]),pt=ye(ot,Ze[Qe]);if(pt[0]>st[1]||st[0]>pt[1])return 0}return 1}}(),Te=function(Ze,Xe){var $e=Ze.halfExtents.x*Math.abs(Xe.n.x)+Ze.halfExtents.y*Math.abs(Xe.n.y)+Ze.halfExtents.z*Math.abs(Xe.n.z),ot=B.Vec3.dot(Xe.n,Ze.center);return ot+$e<Xe.d?-1:ot-$e>Xe.d?0:1},Ee=function(Ze,Xe){for(var $e=0;$e<Xe.planes.length;$e++)if(Te(Ze,Xe.planes[$e])===-1)return 0;return 1},De=function(){for(var Ze=new Array(8),Xe=0,$e=0,ot=0;ot<Ze.length;ot++)Ze[ot]=new B.Vec3(0,0,0);return function(ut,gt){for(var Ue=0,We=!1,ht=0;ht<gt.planes.length;ht++){if((Ue=Te(ut,gt.planes[ht]))===-1)return 0;Ue===1&&(We=!0)}if(!We)return 1;for(var Be=0;Be<gt.vertices.length;Be++)B.Vec3.subtract(Ze[Be],gt.vertices[Be],ut.center);Xe=0,$e=0;for(var je=0;je<gt.vertices.length;je++)Ze[je].x>ut.halfExtents.x?Xe++:Ze[je].x<-ut.halfExtents.x&&$e++;if(Xe===gt.vertices.length||$e===gt.vertices.length)return 0;Xe=0,$e=0;for(var Qe=0;Qe<gt.vertices.length;Qe++)Ze[Qe].y>ut.halfExtents.y?Xe++:Ze[Qe].y<-ut.halfExtents.y&&$e++;if(Xe===gt.vertices.length||$e===gt.vertices.length)return 0;Xe=0,$e=0;for(var st=0;st<gt.vertices.length;st++)Ze[st].z>ut.halfExtents.z?Xe++:Ze[st].z<-ut.halfExtents.z&&$e++;return Xe===gt.vertices.length||$e===gt.vertices.length?0:1}}(),fe=function(){var Ze=new B.Vec3(0,0,0),Xe=new B.Mat3;return function($e,ot){return B.Vec3.subtract(Ze,ot,$e.center),B.Vec3.transformMat3(Ze,Ze,B.Mat3.transpose(Xe,$e.orientation)),ut=Ze,gt=$e.halfExtents,Math.abs(ut.x)<gt.x&&Math.abs(ut.y)<gt.y&&Math.abs(ut.z)<gt.z;var ut,gt}}(),Ce=(ge=function(Ze,Xe,$e,ot){return Math.abs(Ze.x*Xe+Ze.y*$e+Ze.z*ot)},function(Ze,Xe){var $e=Ze.orientation.m,ot=Ze.halfExtents.x*ge(Xe.n,$e[0],$e[1],$e[2])+Ze.halfExtents.y*ge(Xe.n,$e[3],$e[4],$e[5])+Ze.halfExtents.z*ge(Xe.n,$e[6],$e[7],$e[8]),ut=B.Vec3.dot(Xe.n,Ze.center);return ut+ot<Xe.d?-1:ut-ot>Xe.d?0:1}),Se=function(Ze,Xe){for(var $e=0;$e<Xe.planes.length;$e++)if(Ce(Ze,Xe.planes[$e])===-1)return 0;return 1},be=function(){for(var Ze=new Array(8),Xe=0,$e=0,ot=0,ut=0;ut<Ze.length;ut++)Ze[ut]=new B.Vec3(0,0,0);var gt=function(Ue,We,ht,Be){return Ue.x*We+Ue.y*ht+Ue.z*Be};return function(Ue,We){for(var ht=0,Be=!1,je=0;je<We.planes.length;je++){if((ht=Ce(Ue,We.planes[je]))===-1)return 0;ht===1&&(Be=!0)}if(!Be)return 1;for(var Qe=0;Qe<We.vertices.length;Qe++)B.Vec3.subtract(Ze[Qe],We.vertices[Qe],Ue.center);$e=0,ot=0;for(var st=Ue.orientation.m,pt=0;pt<We.vertices.length;pt++)(Xe=gt(Ze[pt],st[0],st[1],st[2]))>Ue.halfExtents.x?$e++:Xe<-Ue.halfExtents.x&&ot++;if($e===We.vertices.length||ot===We.vertices.length)return 0;$e=0,ot=0;for(var qe=0;qe<We.vertices.length;qe++)(Xe=gt(Ze[qe],st[3],st[4],st[5]))>Ue.halfExtents.y?$e++:Xe<-Ue.halfExtents.y&&ot++;if($e===We.vertices.length||ot===We.vertices.length)return 0;$e=0,ot=0;for(var rt=0;rt<We.vertices.length;rt++)(Xe=gt(Ze[rt],st[6],st[7],st[8]))>Ue.halfExtents.z?$e++:Xe<-Ue.halfExtents.z&&ot++;return $e===We.vertices.length||ot===We.vertices.length?0:1}}(),Re=function(){for(var Ze=new Array(15),Xe=0;Xe<15;Xe++)Ze[Xe]=new B.Vec3(0,0,0);for(var $e=new Array(8),ot=new Array(8),ut=0;ut<8;ut++)$e[ut]=new B.Vec3(0,0,0),ot[ut]=new B.Vec3(0,0,0);return function(gt,Ue){var We=gt.orientation.m,ht=Ue.orientation.m;B.Vec3.set(Ze[0],We[0],We[1],We[2]),B.Vec3.set(Ze[1],We[3],We[4],We[5]),B.Vec3.set(Ze[2],We[6],We[7],We[8]),B.Vec3.set(Ze[3],ht[0],ht[1],ht[2]),B.Vec3.set(Ze[4],ht[3],ht[4],ht[5]),B.Vec3.set(Ze[5],ht[6],ht[7],ht[8]);for(var Be=0;Be<3;++Be)B.Vec3.cross(Ze[6+3*Be],Ze[Be],Ze[0]),B.Vec3.cross(Ze[7+3*Be],Ze[Be],Ze[1]),B.Vec3.cross(Ze[7+3*Be],Ze[Be],Ze[2]);me(gt.center,gt.halfExtents,Ze[0],Ze[1],Ze[2],$e),me(Ue.center,Ue.halfExtents,Ze[3],Ze[4],Ze[5],ot);for(var je=0;je<15;++je){var Qe=ye($e,Ze[je]),st=ye(ot,Ze[je]);if(st[0]>Qe[1]||Qe[0]>st[1])return 0}return 1}}(),Ve=function(Ze,Xe){var $e=B.Vec3.dot(Xe.n,Ze.center),ot=Ze.radius*Xe.n.length();return $e+ot<Xe.d?-1:$e-ot>Xe.d?0:1},Pe=function(Ze,Xe){for(var $e=0;$e<Xe.planes.length;$e++)if(Ve(Ze,Xe.planes[$e])===-1)return 0;return 1},ke=function(){var Ze=new B.Vec3(0,0,0),Xe=[1,-1,1,-1,1,-1];return function($e,ot){for(var ut=0;ut<6;ut++){var gt=ot.planes[ut],Ue=$e.radius,We=$e.center,ht=gt.n,Be=gt.d,je=B.Vec3.dot(ht,We);if(je+Ue<Be)return 0;if(!(je-Ue>Be)){B.Vec3.add(Ze,We,B.Vec3.multiplyScalar(Ze,ht,Ue));for(var Qe=0;Qe<6;Qe++)if(Qe!==ut&&Qe!==ut+Xe[ut]){var st=ot.planes[Qe];if(B.Vec3.dot(st.n,Ze)<st.d)return 0}}}return 1}}(),Ne=function(Ze,Xe){var $e=Ze.radius+Xe.radius;return B.Vec3.squaredDistance(Ze.center,Xe.center)<$e*$e},Ae=function(){var Ze=new B.Vec3;return function(Xe,$e){return O.pt_point_aabb(Ze,Xe.center,$e),B.Vec3.squaredDistance(Xe.center,Ze)<Xe.radius*Xe.radius}}(),Oe=function(){var Ze=new B.Vec3;return function(Xe,$e){return O.pt_point_obb(Ze,Xe.center,$e),B.Vec3.squaredDistance(Xe.center,Ze)<Xe.radius*Xe.radius}}(),Fe={rayAabb:ce,rayMesh:ee,raycast:te,rayTriangle:he,ray_sphere:ue,ray_aabb:le,ray_obb:_e,ray_plane:re,ray_triangle:ne,line_plane:ie,line_triangle:pe,line_quad:K,sphere_sphere:Ne,sphere_aabb:Ae,sphere_obb:Oe,sphere_plane:Ve,sphere_frustum:Pe,sphere_frustum_accurate:ke,aabb_aabb:oe,aabb_obb:we,aabb_plane:Te,aabb_frustum:Ee,aabb_frustum_accurate:De,obb_obb:Re,obb_plane:Ce,obb_frustum:Se,obb_frustum_accurate:be,obb_point:fe,resolve:function(Ze,Xe,$e){$e===void 0&&($e=null);var ot=Ze._type,ut=Xe._type,gt=this[ot|ut];return ot<ut?gt(Ze,Xe,$e):gt(Xe,Ze,$e)}};Fe[R.default.SHAPE_RAY|R.default.SHAPE_SPHERE]=ue,Fe[R.default.SHAPE_RAY|R.default.SHAPE_AABB]=le,Fe[R.default.SHAPE_RAY|R.default.SHAPE_OBB]=_e,Fe[R.default.SHAPE_RAY|R.default.SHAPE_PLANE]=re,Fe[R.default.SHAPE_RAY|R.default.SHAPE_TRIANGLE]=ne,Fe[R.default.SHAPE_LINE|R.default.SHAPE_PLANE]=ie,Fe[R.default.SHAPE_LINE|R.default.SHAPE_TRIANGLE]=pe,Fe[R.default.SHAPE_SPHERE]=Ne,Fe[R.default.SHAPE_SPHERE|R.default.SHAPE_AABB]=Ae,Fe[R.default.SHAPE_SPHERE|R.default.SHAPE_OBB]=Oe,Fe[R.default.SHAPE_SPHERE|R.default.SHAPE_PLANE]=Ve,Fe[R.default.SHAPE_SPHERE|R.default.SHAPE_FRUSTUM]=Pe,Fe[R.default.SHAPE_SPHERE|R.default.SHAPE_FRUSTUM_ACCURATE]=ke,Fe[R.default.SHAPE_AABB]=oe,Fe[R.default.SHAPE_AABB|R.default.SHAPE_OBB]=we,Fe[R.default.SHAPE_AABB|R.default.SHAPE_PLANE]=Te,Fe[R.default.SHAPE_AABB|R.default.SHAPE_FRUSTUM]=Ee,Fe[R.default.SHAPE_AABB|R.default.SHAPE_FRUSTUM_ACCURATE]=De,Fe[R.default.SHAPE_OBB]=Re,Fe[R.default.SHAPE_OBB|R.default.SHAPE_PLANE]=Ce,Fe[R.default.SHAPE_OBB|R.default.SHAPE_FRUSTUM]=Se,Fe[R.default.SHAPE_OBB|R.default.SHAPE_FRUSTUM_ACCURATE]=be;var nt=Fe;T.default=nt,S.exports=T.default},{"../../renderer/gfx":319,"../../renderer/memop/recycle-pool":334,"../value-types":286,"./aabb":147,"./distance":148,"./enums":149,"./ray":156,"./triangle":158}],153:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../value-types"),B=(_=L("./enums"))&&_.__esModule?_:{default:_},A=function(){function O(R,P,E,D,I,M){R===void 0&&(R=0),P===void 0&&(P=0),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=0),M===void 0&&(M=-1),this.s=void 0,this.e=void 0,this._type=void 0,this._type=B.default.SHAPE_LINE,this.s=new w.Vec3(R,P,E),this.e=new w.Vec3(D,I,M)}return O.create=function(R,P,E,D,I,M){return new O(R,P,E,D,I,M)},O.clone=function(R){return new O(R.s.x,R.s.y,R.s.z,R.e.x,R.e.y,R.e.z)},O.copy=function(R,P){return w.Vec3.copy(R.s,P.s),w.Vec3.copy(R.e,P.e),R},O.fromPoints=function(R,P,E){return w.Vec3.copy(R.s,P),w.Vec3.copy(R.e,E),R},O.set=function(R,P,E,D,I,M,N){return R.s.x=P,R.s.y=E,R.s.z=D,R.e.x=I,R.e.y=M,R.e.z=N,R},O.len=function(R){return w.Vec3.distance(R.s,R.e)},O.prototype.length=function(){return w.Vec3.distance(this.s,this.e)},O}();T.default=A,S.exports=T.default},{"../value-types":286,"./enums":149}],154:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../value-types"),B=(_=L("./enums"))&&_.__esModule?_:{default:_};function A(D,I){for(var M=0;M<I.length;M++){var N=I[M];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(D,N.key,N)}}var O=new w.Vec3,R=new w.Vec3,P=new w.Mat3,E=function(){function D(k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee,te){k===void 0&&(k=0),F===void 0&&(F=0),G===void 0&&(G=0),V===void 0&&(V=1),j===void 0&&(j=1),H===void 0&&(H=1),U===void 0&&(U=1),X===void 0&&(X=0),Y===void 0&&(Y=0),z===void 0&&(z=0),W===void 0&&(W=1),Z===void 0&&(Z=0),Q===void 0&&(Q=0),ee===void 0&&(ee=0),te===void 0&&(te=1),this.center=void 0,this.halfExtents=void 0,this.orientation=void 0,this._type=void 0,this._type=B.default.SHAPE_OBB,this.center=new w.Vec3(k,F,G),this.halfExtents=new w.Vec3(V,j,H),this.orientation=new w.Mat3(U,X,Y,z,W,Z,Q,ee,te)}D.create=function(k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee,te){return new D(k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee,te)},D.clone=function(k){var F=k.orientation.m;return new D(k.center.x,k.center.y,k.center.z,k.halfExtents.x,k.halfExtents.y,k.halfExtents.z,F[0],F[1],F[2],F[3],F[4],F[5],F[6],F[7],F[8])},D.copy=function(k,F){return w.Vec3.copy(k.center,F.center),w.Vec3.copy(k.halfExtents,F.halfExtents),w.Mat3.copy(k.orientation,F.orientation),k},D.fromPoints=function(k,F,G){return w.Vec3.multiplyScalar(k.center,w.Vec3.add(O,F,G),.5),w.Vec3.multiplyScalar(k.halfExtents,w.Vec3.subtract(R,G,F),.5),w.Mat3.identity(k.orientation),k},D.set=function(k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee,te,re){return w.Vec3.set(k.center,F,G,V),w.Vec3.set(k.halfExtents,j,H,U),w.Mat3.set(k.orientation,X,Y,z,W,Z,Q,ee,te,re),k};var I,M,N=D.prototype;return N.getBoundary=function(k,F){var G,V,j,H,U;G=O,V=this.halfExtents,j=this.orientation,H=P.m,U=j.m,H[0]=Math.abs(U[0]),H[1]=Math.abs(U[1]),H[2]=Math.abs(U[2]),H[3]=Math.abs(U[3]),H[4]=Math.abs(U[4]),H[5]=Math.abs(U[5]),H[6]=Math.abs(U[6]),H[7]=Math.abs(U[7]),H[8]=Math.abs(U[8]),w.Vec3.transformMat3(G,V,P),w.Vec3.subtract(k,this.center,O),w.Vec3.add(F,this.center,O)},N.transform=function(k,F,G,V,j){w.Vec3.transformMat4(j.center,this.center,k),w.Mat3.fromQuat(j.orientation,G),w.Vec3.multiply(j.halfExtents,this.halfExtents,V)},N.translateAndRotate=function(k,F,G){w.Vec3.transformMat4(G.center,this.center,k),w.Mat3.fromQuat(G.orientation,F)},N.setScale=function(k,F){w.Vec3.multiply(F.halfExtents,this.halfExtents,k)},I=D,(M=[{key:"type",get:function(){return this._type}}])&&A(I.prototype,M),Object.defineProperty(I,"prototype",{writable:!1}),D}();T.default=E,S.exports=T.default},{"../value-types":286,"./enums":149}],155:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../value-types"),B=(_=L("./enums"))&&_.__esModule?_:{default:_},A=new w.Vec3(0,0,0),O=new w.Vec3(0,0,0),R=cc.mat4(),P=cc.v4(),E=function(){function D(I,M,N,k){I===void 0&&(I=0),M===void 0&&(M=1),N===void 0&&(N=0),k===void 0&&(k=0),this.n=void 0,this.d=void 0,this._type=void 0,this._type=B.default.SHAPE_PLANE,this.n=new w.Vec3(I,M,N),this.d=k}return D.create=function(I,M,N,k){return new D(I,M,N,k)},D.clone=function(I){return new D(I.n.x,I.n.y,I.n.z,I.d)},D.copy=function(I,M){return w.Vec3.copy(I.n,M.n),I.d=M.d,I},D.fromPoints=function(I,M,N,k){return w.Vec3.subtract(A,N,M),w.Vec3.subtract(O,k,M),w.Vec3.normalize(I.n,w.Vec3.cross(I.n,A,O)),I.d=w.Vec3.dot(I.n,M),I},D.set=function(I,M,N,k,F){return I.n.x=M,I.n.y=N,I.n.z=k,I.d=F,I},D.fromNormalAndPoint=function(I,M,N){return w.Vec3.copy(I.n,M),I.d=w.Vec3.dot(M,N),I},D.normalize=function(I,M){var N=M.n.len();return w.Vec3.normalize(I.n,M.n),N>0&&(I.d=M.d/N),I},D.prototype.transform=function(I){w.Mat4.invert(R,I),w.Mat4.transpose(R,R),w.Vec4.set(P,this.n.x,this.n.y,this.n.z,this.d),w.Vec4.transformMat4(P,P,R),w.Vec3.set(this.n,P.x,P.y,P.z),this.d=P.w},D}();T.default=E,S.exports=T.default},{"../value-types":286,"./enums":149}],156:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../value-types"),B=(_=L("./enums"))&&_.__esModule?_:{default:_},A=function(){function O(R,P,E,D,I,M){R===void 0&&(R=0),P===void 0&&(P=0),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=0),M===void 0&&(M=-1),this.o=void 0,this.d=void 0,this._type=void 0,this._type=B.default.SHAPE_RAY,this.o=new w.Vec3(R,P,E),this.d=new w.Vec3(D,I,M)}return O.create=function(R,P,E,D,I,M){return R===void 0&&(R=0),P===void 0&&(P=0),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=0),M===void 0&&(M=1),new O(R,P,E,D,I,M)},O.clone=function(R){return new O(R.o.x,R.o.y,R.o.z,R.d.x,R.d.y,R.d.z)},O.copy=function(R,P){return w.Vec3.copy(R.o,P.o),w.Vec3.copy(R.d,P.d),R},O.fromPoints=function(R,P,E){return w.Vec3.copy(R.o,P),w.Vec3.normalize(R.d,w.Vec3.subtract(R.d,E,P)),R},O.set=function(R,P,E,D,I,M,N){return R.o.x=P,R.o.y=E,R.o.z=D,R.d.x=I,R.d.y=M,R.d.z=N,R},O.prototype.computeHit=function(R,P){w.Vec3.normalize(R,this.d),w.Vec3.scaleAndAdd(R,this.o,R,P)},O}();T.default=A,S.exports=T.default},{"../value-types":286,"./enums":149}],157:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../value-types"),B=(_=L("./enums"))&&_.__esModule?_:{default:_},A=new w.Vec3,O=function(){function R(E,D,I,M){E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=0),M===void 0&&(M=1),this.center=void 0,this.radius=void 0,this._type=void 0,this._type=B.default.SHAPE_SPHERE,this.center=new w.Vec3(E,D,I),this.radius=M}R.create=function(E,D,I,M){return new R(E,D,I,M)},R.clone=function(E){return new R(E.center.x,E.center.y,E.center.z,E.radius)},R.copy=function(E,D){return w.Vec3.copy(E.center,D.center),E.radius=D.radius,E},R.fromPoints=function(E,D,I){return w.Vec3.multiplyScalar(E.center,w.Vec3.add(A,D,I),.5),E.radius=.5*w.Vec3.subtract(A,I,D).len(),E},R.set=function(E,D,I,M,N){return E.center.x=D,E.center.y=I,E.center.z=M,E.radius=N,E};var P=R.prototype;return P.clone=function(){return R.clone(this)},P.copy=function(E){return R.copy(this,E)},P.getBoundary=function(E,D){w.Vec3.set(E,this.center.x-this.radius,this.center.y-this.radius,this.center.z-this.radius),w.Vec3.set(D,this.center.x+this.radius,this.center.y+this.radius,this.center.z+this.radius)},P.transform=function(E,D,I,M,N){w.Vec3.transformMat4(N.center,this.center,E),N.radius=this.radius*M.maxAxis()},P.translateAndRotate=function(E,D,I){w.Vec3.transformMat4(I.center,this.center,E)},P.setScale=function(E,D){D.radius=this.radius*E.maxAxis()},R}();T.default=O,S.exports=T.default},{"../value-types":286,"./enums":149}],158:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=B(L("../value-types/vec3")),w=B(L("./enums"));function B(O){return O&&O.__esModule?O:{default:O}}var A=function(){function O(R,P,E,D,I,M,N,k,F){this.a=void 0,this.b=void 0,this.c=void 0,this._type=void 0,this.a=new _.default(R,P,E),this.b=new _.default(D,I,M),this.c=new _.default(N,k,F),this._type=w.default.SHAPE_TRIANGLE}return O.create=function(R,P,E,D,I,M,N,k,F){return new O(R,P,E,D,I,M,N,k,F)},O.clone=function(R){return new O(R.a.x,R.a.y,R.a.z,R.b.x,R.b.y,R.b.z,R.c.x,R.c.y,R.c.z)},O.copy=function(R,P){return _.default.copy(R.a,P.a),_.default.copy(R.b,P.b),_.default.copy(R.c,P.c),R},O.fromPoints=function(R,P,E,D){return _.default.copy(R.a,P),_.default.copy(R.b,E),_.default.copy(R.c,D),R},O.set=function(R,P,E,D,I,M,N,k,F,G){return R.a.x=P,R.a.y=E,R.a.z=D,R.b.x=I,R.b.y=M,R.b.z=N,R.c.x=k,R.c.y=F,R.c.z=G,R},O}();T.default=A,S.exports=T.default},{"../value-types/vec3":296,"./enums":149}],159:[function(L,S){var T=L("../components/CCRenderComponent"),_=L("../assets/material/CCMaterial"),w=L("./types"),B=w.LineCap,A=w.LineJoin,O=cc.Class({name:"cc.Graphics",extends:T,editor:!1,ctor:function(){this._impl=new O._Impl(this)},properties:{_lineWidth:2,_strokeColor:cc.Color.BLACK,_lineJoin:A.MITER,_lineCap:B.BUTT,_fillColor:cc.Color.WHITE,_miterLimit:10,lineWidth:{get:function(){return this._lineWidth},set:function(R){this._lineWidth=R,this._impl.lineWidth=R}},lineJoin:{get:function(){return this._lineJoin},set:function(R){this._lineJoin=R,this._impl.lineJoin=R},type:A},lineCap:{get:function(){return this._lineCap},set:function(R){this._lineCap=R,this._impl.lineCap=R},type:B},strokeColor:{get:function(){return this._strokeColor},set:function(R){this._impl.strokeColor=this._strokeColor=cc.color(R)}},fillColor:{get:function(){return this._fillColor},set:function(R){this._impl.fillColor=this._fillColor=cc.color(R)}},miterLimit:{get:function(){return this._miterLimit},set:function(R){this._miterLimit=R,this._impl.miterLimit=R}}},statics:{LineJoin:A,LineCap:B},onRestore:function(){this._impl||(this._impl=new O._Impl(this))},onDestroy:function(){this.clear(!0),this._super(),this._impl=null},_getDefaultMaterial:function(){return _.getBuiltinMaterial("2d-graphics")},_updateMaterial:function(){var R=this._materials[0];R&&(R.getDefine("CC_USE_MODEL")!==void 0&&R.define("CC_USE_MODEL",!0),R.getDefine("CC_SUPPORT_standard_derivatives")!==void 0&&cc.sys.glExtension("OES_standard_derivatives")&&R.define("CC_SUPPORT_standard_derivatives",!0))},moveTo:function(R,P){this._impl.moveTo(R,P)},lineTo:function(R,P){this._impl.lineTo(R,P)},bezierCurveTo:function(R,P,E,D,I,M){this._impl.bezierCurveTo(R,P,E,D,I,M)},quadraticCurveTo:function(R,P,E,D){this._impl.quadraticCurveTo(R,P,E,D)},arc:function(R,P,E,D,I,M){this._impl.arc(R,P,E,D,I,M)},ellipse:function(R,P,E,D){this._impl.ellipse(R,P,E,D)},circle:function(R,P,E){this._impl.circle(R,P,E)},rect:function(R,P,E,D){this._impl.rect(R,P,E,D)},roundRect:function(R,P,E,D,I){this._impl.roundRect(R,P,E,D,I)},fillRect:function(R,P,E,D){this.rect(R,P,E,D),this.fill()},clear:function(R){this._impl.clear(R),this._assembler&&this._assembler.clear(R)},close:function(){this._impl.close()},stroke:function(){this._assembler||this._resetAssembler(),this._assembler.stroke(this)},fill:function(){this._assembler||this._resetAssembler(),this._assembler.fill(this)}});cc.Graphics=S.exports=O,cc.Graphics.Types=w,cc.Graphics.Helper=L("./helper")},{"../assets/material/CCMaterial":81,"../components/CCRenderComponent":117,"./helper":160,"./types":162}],160:[function(L,S){var T=L("./types").PointFlags,_=Math.PI,w=Math.min,B=Math.max,A=Math.cos,O=Math.sin,R=Math.abs,P=Math.sign,E=.5522847493;S.exports={arc:function(D,I,M,N,k,F,G){var V,j,H,U=0,X=0,Y=0,z=0,W=0,Z=0,Q=0,ee=0,te=0,re=0,ie=0,ne=0,he=0;if(X=F-k,G=G||!1)if(R(X)>=2*_)X=2*_;else for(;X<0;)X+=2*_;else if(R(X)>=2*_)X=2*-_;else for(;X>0;)X-=2*_;for(H=0|B(1,w(R(X)/(.5*_)+.5,5)),Y=R(4/3*(1-A(V=X/H/2))/O(V)),G||(Y=-Y),j=0;j<=H;j++)Z=I+(z=A(U=k+X*(j/H)))*N,Q=M+(W=O(U))*N,ee=-W*N*Y,te=z*N*Y,j===0?D.moveTo(Z,Q):D.bezierCurveTo(re+ne,ie+he,Z-ee,Q-te,Z,Q),re=Z,ie=Q,ne=ee,he=te},ellipse:function(D,I,M,N,k){D.moveTo(I-N,M),D.bezierCurveTo(I-N,M+k*E,I-N*E,M+k,I,M+k),D.bezierCurveTo(I+N*E,M+k,I+N,M+k*E,I+N,M),D.bezierCurveTo(I+N,M-k*E,I+N*E,M-k,I,M-k),D.bezierCurveTo(I-N*E,M-k,I-N,M-k*E,I-N,M),D.close()},roundRect:function(D,I,M,N,k,F){if(F<.1)D.rect(I,M,N,k);else{var G=w(F,.5*R(N))*P(N),V=w(F,.5*R(k))*P(k);D.moveTo(I,M+V),D.lineTo(I,M+k-V),D.bezierCurveTo(I,M+k-V*(1-E),I+G*(1-E),M+k,I+G,M+k),D.lineTo(I+N-G,M+k),D.bezierCurveTo(I+N-G*(1-E),M+k,I+N,M+k-V*(1-E),I+N,M+k-V),D.lineTo(I+N,M+V),D.bezierCurveTo(I+N,M+V*(1-E),I+N-G*(1-E),M,I+N-G,M),D.lineTo(I+G,M),D.bezierCurveTo(I+G*(1-E),M,I,M+V*(1-E),I,M+V),D.close()}},tesselateBezier:function D(I,M,N,k,F,G,V,j,H,U,X){var Y,z,W,Z,Q,ee,te,re,ie,ne,he,pe,K,ue,le,ce;U>10||(Q=.5*(G+j),ee=.5*(V+H),te=.5*((Y=.5*(M+k))+(W=.5*(k+G))),re=.5*((z=.5*(N+F))+(Z=.5*(F+V))),((le=R((k-j)*(ue=H-N)-(F-H)*(K=j-M)))+(ce=R((G-j)*ue-(V-H)*K)))*(le+ce)<I._tessTol*(K*K+ue*ue)?I._addPoint(j,H,X===0?X|T.PT_BEVEL:X):(D(I,M,N,Y,z,te,re,he=.5*(te+(ie=.5*(W+Q))),pe=.5*(re+(ne=.5*(Z+ee))),U+1,0),D(I,he,pe,ie,ne,Q,ee,j,H,U+1,X)))}}},{"./types":162}],161:[function(L){L("./graphics")},{"./graphics":159}],162:[function(L,S){var T=cc.Enum({BUTT:0,ROUND:1,SQUARE:2}),_=cc.Enum({BEVEL:0,ROUND:1,MITER:2}),w=cc.Enum({PT_CORNER:1,PT_LEFT:2,PT_BEVEL:4,PT_INNERBEVEL:8});S.exports={LineCap:T,LineJoin:_,PointFlags:w}},{}],163:[function(L){L("./platform"),L("./assets"),L("./CCNode"),L("./CCPrivateNode"),L("./CCScene"),L("./components"),L("./graphics"),L("./collider"),L("./collider/CCIntersection"),L("./physics"),L("./camera/CCCamera"),L("./geom-utils"),L("./mesh"),L("./3d"),L("./base-ui/CCWidgetManager")},{"./3d":void 0,"./CCNode":29,"./CCPrivateNode":30,"./CCScene":31,"./assets":79,"./base-ui/CCWidgetManager":90,"./camera/CCCamera":91,"./collider":99,"./collider/CCIntersection":97,"./components":135,"./geom-utils":151,"./graphics":161,"./mesh":166,"./physics":181,"./platform":214}],164:[function(L,S){var T=B(L("../../renderer/core/input-assembler")),_=B(L("../../renderer/gfx")),w=L("./mesh-data");function B(F){return F&&F.__esModule?F:{default:F}}var A=L("../renderer"),O=L("../event/event-target");function R(F,G,V){F[G]=V._val}function P(F,G,V){F[G]=V.x,F[G+1]=V.y}function E(F,G,V){F[G]=V.x,F[G+1]=V.y,F[G+2]=V.z}var D,I={5120:"getInt8",5121:"getUint8",5122:"getInt16",5123:"getUint16",5124:"getInt32",5125:"getUint32",5126:"getFloat32"},M={5120:"setInt8",5121:"setUint8",5122:"setInt16",5123:"setUint16",5124:"setInt32",5125:"setUint32",5126:"setFloat32"},N=(D=new ArrayBuffer(2),new DataView(D).setInt16(0,256,!0),new Int16Array(D)[0]===256),k=cc.Class({name:"cc.Mesh",extends:cc.Asset,mixins:[O],properties:{_nativeAsset:{override:!0,get:function(){return this._buffer},set:function(F){this._buffer=ArrayBuffer.isView(F)?F.buffer:F,this.initWithBuffer()}},_vertexBundles:{default:null,type:w.VertexBundle},_primitives:{default:null,Primitive:w.Primitive},_minPos:cc.v3(),_maxPos:cc.v3(),subMeshes:{get:function(){return this._subMeshes},set:function(F){this._subMeshes=F}},subDatas:{get:function(){return this._subDatas}}},ctor:function(){this._subMeshes=[],this._subDatas=[],this.loaded=!1},initWithBuffer:function(){this._subMeshes.length=0;for(var F=this._primitives,G=0;G<F.length;G++){var V=F[G],j=V.data,H=new Uint8Array(this._buffer,j.offset,j.length),U=this._vertexBundles[V.vertexBundleIndices[0]],X=U.data,Y=new _.default.VertexFormat(U.formats),z=new Uint8Array(this._buffer,X.offset,X.length),W=this._canVertexFormatBatch(Y),Z=new w.MeshData;Z.vData=z,Z.iData=H,Z.vfm=Y,Z.offset=X.offset,Z.canBatch=W,this._subDatas.push(Z);var Q=new _.default.VertexBuffer(A.device,Y,_.default.USAGE_STATIC,z),ee=new _.default.IndexBuffer(A.device,V.indexUnit,_.default.USAGE_STATIC,H);this._subMeshes.push(new T.default(Q,ee))}this.loaded=!0,this.emit("load")},_canVertexFormatBatch:function(F){var G=F._attr2el[_.default.ATTR_POSITION];return!G||G.type===_.default.ATTR_TYPE_FLOAT32&&F._bytes%4==0},init:function(F,G,V,j){V===void 0&&(V=!1),j===void 0&&(j=0);var H=new Uint8Array(F._bytes*G),U=new w.MeshData;U.vData=H,U.vfm=F,U.vDirty=!0,U.canBatch=this._canVertexFormatBatch(F);var X=new _.default.VertexBuffer(A.device,F,V?_.default.USAGE_DYNAMIC:_.default.USAGE_STATIC,H);U.vb=X,this._subMeshes[j]=new T.default(U.vb);var Y=this._subDatas[j];Y&&(Y.vb&&Y.vb.destroy(),Y.ib&&Y.ib.destroy()),this._subDatas[j]=U,this.loaded=!0,this.emit("load"),this.emit("init-format")},setVertices:function(F,G,V){V=V||0;var j=this._subDatas[V],H=j.vfm.element(F);if(!H)return cc.warn("Cannot find "+F+" attribute in vertex defines.");var U,X=typeof G[0]=="number",Y=H.num,z=X?G.length/Y|0:G.length;j.vData.byteLength<z*H.stride&&j.setVData(new Uint8Array(z*j.vfm._bytes));var W=4;F===_.default.ATTR_COLOR?X?(U=j.getVData(),W=1):U=j.getVData(Uint32Array):U=j.getVData(Float32Array);var Z=H.stride/W,Q=H.offset/W;if(X)for(var ee=0,te=G.length/Y;ee<te;ee++)for(var re=ee*Y,ie=ee*Z+Q,ne=0;ne<Y;ne++)U[ie+ne]=G[re+ne];else{var he;he=F===_.default.ATTR_COLOR?R:Y===2?P:E;for(var pe=0,K=G.length;pe<K;pe++)he(U,pe*Z+Q,G[pe])}j.vDirty=!0},setIndices:function(F,G,V){G=G||0;var j=F;F instanceof Uint16Array?j=new Uint8Array(F.buffer,F.byteOffset,F.byteLength):Array.isArray(F)&&(j=new Uint16Array(F),j=new Uint8Array(j.buffer,j.byteOffset,j.byteLength));var H=V?_.default.USAGE_DYNAMIC:_.default.USAGE_STATIC,U=this._subDatas[G];if(U.ib)U.iData=j,U.iDirty=!0;else{U.iData=j;var X=new _.default.IndexBuffer(A.device,_.default.INDEX_FMT_UINT16,H,j,j.byteLength/_.default.IndexBuffer.BYTES_PER_INDEX[_.default.INDEX_FMT_UINT16]);U.ib=X,this._subMeshes[G]._indexBuffer=U.ib}},setPrimitiveType:function(F,G){G=G||0,this._subMeshes[G]?this._subMeshes[G]._primitiveType=F:cc.warn("Do not have sub mesh at index "+G)},clear:function(){this._subMeshes.length=0;for(var F=this._subDatas,G=0,V=F.length;G<V;G++){var j=F[G].vb;j&&j.destroy();var H=F[G].ib;H&&H.destroy()}F.length=0},setBoundingBox:function(F,G){this._minPos=F,this._maxPos=G},destroy:function(){this.clear()},_uploadData:function(){for(var F=this._subDatas,G=0,V=F.length;G<V;G++){var j=F[G];if(j.vDirty){var H=j.vb,U=j.vData;H.update(0,U),j.vDirty=!1}if(j.iDirty){var X=j.ib,Y=j.iData;X.update(0,Y),j.iDirty=!1}}},_getAttrMeshData:function(F,G){var V=this._subDatas[F];if(!V)return[];var j=V.vfm,H=j.element(G);if(!H)return[];V.attrDatas||(V.attrDatas={});var U=V.attrDatas,X=U[G];if(X)return X;X=U[G]=[];for(var Y=V.vData,z=new DataView(Y.buffer,Y.byteOffset,Y.byteLength),W=H.stride,Z=H.offset,Q=H.num,ee=H.bytes/Q,te=I[H.type],re=Y.byteLength/j._bytes,ie=0;ie<re;ie++)for(var ne=ie*W+Z,he=0;he<Q;he++){var pe=z[te](ne+he*ee,N);X.push(pe)}return X},copyAttribute:function(F,G,V,j,H){var U=!1,X=this._subDatas[F];if(!X)return U;var Y=X.vfm,z=Y.element(G);if(!z)return U;var W=M[z.type];if(!W)return U;var Z=this._getAttrMeshData(F,G),Q=X.vData.byteLength/Y._bytes,ee=z.bytes/z.num;if(Z.length>0){for(var te=new DataView(V,H),re=j,ie=z.num,ne=0;ne<Q;++ne)for(var he=ne*ie,pe=0;pe<ie;++pe){var K=he+pe,ue=re*ne+ee*pe;te[W](ue,Z[K],N)}U=!0}return U},copyIndices:function(F,G){var V=this._subDatas[F];if(!V)return!1;for(var j=V.iData,H=j.length/2,U=new DataView(j.buffer,j.byteOffset,j.byteLength),X=I[_.default.INDEX_FMT_UINT8],Y=0;Y<H;++Y)G[Y]=U[X](2*Y);return!0}});cc.Mesh=S.exports=k},{"../../renderer/core/input-assembler":309,"../../renderer/gfx":319,"../event/event-target":143,"../renderer":227,"./mesh-data":167}],165:[function(L,S){var T=B(L("../../renderer/gfx")),_=(B(L("../../renderer/core/input-assembler")),B(L("../geom-utils/aabb"))),w=(B(L("../value-types/vec3")),B(L("../value-types/mat4")),B(L("../assets/material/material-variant")));function B(I){return I&&I.__esModule?I:{default:I}}var A=L("../components/CCRenderComponent"),O=L("./CCMesh"),R=L("../renderer/render-flow"),P=(L("../renderer"),L("../assets/material/CCMaterial")),E=cc.Enum({OFF:0,ON:1}),D=cc.Class({name:"cc.MeshRenderer",extends:A,editor:!1,properties:{_mesh:{default:null,type:O},_receiveShadows:!1,_shadowCastingMode:E.OFF,_enableAutoBatch:!1,mesh:{get:function(){return this._mesh},set:function(I){this._mesh!==I&&(this._setMesh(I),I?(this.markForRender(!0),this.node._renderFlag|=R.FLAG_TRANSFORM):this.disableRender())},type:O,animatable:!1},textures:{default:[],type:cc.Texture2D,visible:!1},receiveShadows:{get:function(){return this._receiveShadows},set:function(I){this._receiveShadows=I,this._updateReceiveShadow()},animatable:!1},shadowCastingMode:{get:function(){return this._shadowCastingMode},set:function(I){this._shadowCastingMode=I,this._updateCastShadow()},type:E,animatable:!1},enableAutoBatch:{get:function(){return this._enableAutoBatch},set:function(I){this._enableAutoBatch=I}}},statics:{ShadowCastingMode:E},ctor:function(){this._boundingBox=cc.geomUtils&&new _.default},onEnable:function(){var I=this;this._super(),this._mesh&&!this._mesh.loaded?(this.disableRender(),this._mesh.once("load",function(){I.isValid&&(I._setMesh(I._mesh),I.markForRender(!0))}),cc.assetManager.postLoadNative(this._mesh)):this._setMesh(this._mesh),this._updateRenderNode(),this._updateMaterial()},onDestroy:function(){this._setMesh(null),cc.pool.assembler.put(this._assembler)},_updateRenderNode:function(){this._assembler.setRenderNode(this.node)},_setMesh:function(I){cc.geomUtils&&I&&_.default.fromPoints(this._boundingBox,I._minPos,I._maxPos),this._mesh&&this._mesh.off("init-format",this._updateMeshAttribute,this),I&&I.on("init-format",this._updateMeshAttribute,this),this._mesh=I,this._assembler&&(this._assembler._worldDatas={}),this._updateMeshAttribute()},_getDefaultMaterial:function(){return P.getBuiltinMaterial("unlit")},_validateRender:function(){var I=this._mesh;I&&I._subDatas.length>0||this.disableRender()},_updateMaterial:function(){var I=this.textures;if(I&&I.length>0)for(var M=this._getDefaultMaterial(),N=0;N<I.length;N++){var k=this._materials[N];k&&k._uuid!==M._uuid||(k||(k=w.default.create(M,this),this.setMaterial(N,k)),k.setProperty("diffuseTexture",I[N]))}this._updateReceiveShadow(),this._updateCastShadow(),this._updateMeshAttribute()},_updateReceiveShadow:function(){for(var I=this.getMaterials(),M=0;M<I.length;M++)I[M].define("CC_USE_SHADOW_MAP",this._receiveShadows,void 0,!0)},_updateCastShadow:function(){for(var I=this.getMaterials(),M=0;M<I.length;M++)I[M].define("CC_CASTING_SHADOW",this._shadowCastingMode===E.ON,void 0,!0)},_updateMeshAttribute:function(){var I=this._mesh&&this._mesh.subDatas;if(I)for(var M=this.getMaterials(),N=0;N<M.length&&I[N];N++){var k=I[N].vfm,F=M[N];F.define("CC_USE_ATTRIBUTE_COLOR",!!k.element(T.default.ATTR_COLOR),void 0,!0),F.define("CC_USE_ATTRIBUTE_UV0",!!k.element(T.default.ATTR_UV0),void 0,!0),F.define("CC_USE_ATTRIBUTE_NORMAL",!!k.element(T.default.ATTR_NORMAL),void 0,!0),F.define("CC_USE_ATTRIBUTE_TANGENT",!!k.element(T.default.ATTR_TANGENT),void 0,!0)}},_checkBacth:function(){}});cc.MeshRenderer=S.exports=D},{"../../renderer/core/input-assembler":309,"../../renderer/gfx":319,"../assets/material/CCMaterial":81,"../assets/material/material-variant":88,"../components/CCRenderComponent":117,"../geom-utils/aabb":147,"../renderer":227,"../renderer/render-flow":228,"../value-types/mat4":288,"../value-types/vec3":296,"./CCMesh":164}],166:[function(L){L("./CCMesh"),L("./CCMeshRenderer"),L("./mesh-renderer")},{"./CCMesh":164,"./CCMeshRenderer":165,"./mesh-renderer":168}],167:[function(L,S,T){T.__esModule=!0,T.BufferRange=void 0,T.MeshData=P,T.VertexFormat=T.VertexBundle=T.Primitive=void 0;var _,w=(_=L("../../renderer/gfx"))&&_.__esModule?_:{default:_},B=cc.Class({name:"cc.BufferRange",properties:{offset:0,length:0}});T.BufferRange=B;var A=cc.Class({name:"cc.mesh.VertexFormat",properties:{name:"",type:-1,num:-1,normalize:!1}});T.VertexFormat=A;var O=cc.Class({name:"cc.mesh.VertexBundle",properties:{data:{default:null,type:B},formats:{default:[],type:A},verticesCount:0}});T.VertexBundle=O;var R=cc.Class({name:"cc.mesh.Primitive",properties:{vertexBundleIndices:{default:[],type:cc.Float},data:{default:null,type:B},indexUnit:w.default.INDEX_FMT_UINT16,topology:w.default.PT_TRIANGLES}});function P(){this.vData=null,this.float32VData=null,this.uint32VData=null,this.iData=null,this.uint16IData=null,this.vfm=null,this.offset=0,this.vb=null,this.ib=null,this.vDirty=!1,this.iDirty=!1,this.enable=!0}T.Primitive=R,P.prototype.setVData=function(E){this.vData=E,this.float32VData=null,this.uint32VData=null},P.prototype.getVData=function(E){return E===Float32Array?(this.float32VData||(this.float32VData=new Float32Array(this.vData.buffer,this.vData.byteOffset,this.vData.byteLength/4)),this.float32VData):E===Uint32Array?(this.uint32VData||(this.uint32VData=new Uint32Array(this.vData.buffer,this.vData.byteOffset,this.vData.byteLength/4)),this.uint32VData):this.vData},P.prototype.getIData=function(E){return E===Uint16Array?(this.uint16IData||(this.uint16IData=new Uint16Array(this.iData.buffer,this.iData.byteOffset,this.iData.byteLength/2)),this.uint16IData):this.iData}},{"../../renderer/gfx":319}],168:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=A(L("../renderer/assembler")),w=A(L("../../renderer/gfx")),B=A(L("../value-types/vec3"));function A(D){return D&&D.__esModule?D:{default:D}}function O(D,I){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,N){return M.__proto__=N,M})(D,I)}var R=L("./CCMeshRenderer"),P=new B.default,E=function(D){var I,M;function N(){return D.apply(this,arguments)||this}M=D,(I=N).prototype=Object.create(M.prototype),I.prototype.constructor=I,O(I,M);var k=N.prototype;return k.init=function(F){D.prototype.init.call(this,F),this._worldDatas={},this._renderNode=null},k.setRenderNode=function(F){this._renderNode=F},k.fillBuffers=function(F,G){if(F.mesh){F.mesh._uploadData();for(var V=G.cullingMask===F.node._cullingMask,j=F.enableAutoBatch,H=F._materials,U=F.mesh._subMeshes,X=F.mesh.subDatas,Y=0;Y<U.length;Y++){var z=U[Y],W=X[Y],Z=H[Y]||H[0];j&&W.canBatch&&z._primitiveType===w.default.PT_TRIANGLES?(V&&Z.getHash()===G.material.getHash()||G._flush(),G.material=Z,G.cullingMask=F.node._cullingMask,G.node=G._dummyNode,this._fillBuffer(F,W,G,Y)):(G._flush(),G.material=Z,G.cullingMask=F.node._cullingMask,G.node=this._renderNode,G._flushIA(z))}}},k._fillBuffer=function(F,G,V,j){var H=G.getVData(Float32Array),U=G.vfm,X=H.byteLength/U._bytes|0,Y=G.getIData(Uint16Array),z=Y.length,W=V.getBuffer("mesh",U),Z=W.request(X,z),Q=Z.indiceOffset,ee=Z.byteOffset>>2,te=Z.vertexOffset,re=W._vData,ie=W._iData;!V.worldMatDirty&&this._worldDatas[j]||this._updateWorldVertices(j,X,H,U,F.node._worldMatrix),re.set(this._worldDatas[j],ee);for(var ne=0;ne<z;ne++)ie[Q+ne]=te+Y[ne]},k._updateWorldVertices=function(F,G,V,j,H){var U=this._worldDatas[F];U||(U=this._worldDatas[F]=new Float32Array(V.length)).set(V);for(var X=j._bytes/4,Y=j._elements,z=0,W=Y.length;z<W;z++){var Z=Y[z],Q=Z.offset/4;if(Z.name===w.default.ATTR_POSITION||Z.name===w.default.ATTR_NORMAL)for(var ee=Z.name===w.default.ATTR_NORMAL?B.default.transformMat4Normal:B.default.transformMat4,te=0;te<G;te++){var re=te*X+Q;P.x=V[re],P.y=V[re+1],P.z=V[re+2],ee(P,P,H),U[re]=P.x,U[re+1]=P.y,U[re+2]=P.z}}},k._drawDebugDatas=function(F,G,V){var j=F._debugDatas[V];if(j)for(var H=0;H<j.length;H++){var U=j[H];if(U){var X=U.material;G.material=X,G._flushIA(U.ia)}}},N}(_.default);T.default=E,_.default.register(R,E),S.exports=T.default},{"../../renderer/gfx":319,"../renderer/assembler":224,"../value-types/vec3":296,"./CCMeshRenderer":165}],169:[function(L,S){var T=L("./component-scheduler"),_=L("./platform/CCObject").Flags,w=L("./platform/js"),B=_.IsPreloadStarted,A=_.IsOnLoadStarted,O=_.IsOnLoadCalled,R=_.Deactivating,P=cc.Class({extends:T.LifeCycleInvoker,add:function(F){this._zero.array.push(F)},remove:function(F){this._zero.fastRemove(F)},cancelInactive:function(F){T.LifeCycleInvoker.stableRemoveInactive(this._zero,F)},invoke:function(){this._invoke(this._zero),this._zero.array.length=0}}),E=T.createInvokeImpl("c.__preload();"),D=T.createInvokeImpl("c.onLoad();c._objFlags|="+O,!1,O),I=new w.Pool(4);function M(F,G,V){G?F._removeComponent(G):w.array.removeAt(F._components,V)}function N(){this._activatingStack=[]}I.get=function(){var F=this._get()||{preload:new P(E),onLoad:new T.OneOffInvoker(D),onEnable:new T.OneOffInvoker(T.invokeOnEnable)};F.preload._zero.i=-1;var G=F.onLoad;return G._zero.i=-1,G._neg.i=-1,G._pos.i=-1,(G=F.onEnable)._zero.i=-1,G._neg.i=-1,G._pos.i=-1,F};var k=cc.Class({ctor:N,reset:N,_activateNodeRecursively:function(F,G,V,j){if(F._objFlags&R)cc.errorID(3816,F.name);else{F._activeInHierarchy=!0;for(var H=F._components.length,U=0;U<H;++U){var X=F._components[U];X instanceof cc.Component?this.activateComp(X,G,V,j):(M(F,X,U),--U,--H)}F._childArrivalOrder=F._children.length;for(var Y=0,z=F._children.length;Y<z;++Y){var W=F._children[Y];W._localZOrder=4294901760&W._localZOrder|Y+1,W._active&&this._activateNodeRecursively(W,G,V,j)}F._onPostActivated(!0)}},_deactivateNodeRecursively:function(F){F._objFlags|=R,F._activeInHierarchy=!1;for(var G=F._components.length,V=0;V<G;++V){var j=F._components[V];if(j._enabled&&(cc.director._compScheduler.disableComp(j),F._activeInHierarchy))return void(F._objFlags&=~R)}for(var H=0,U=F._children.length;H<U;++H){var X=F._children[H];if(X._activeInHierarchy&&(this._deactivateNodeRecursively(X),F._activeInHierarchy))return void(F._objFlags&=~R)}F._onPostActivated(!1),F._objFlags&=~R},activateNode:function(F,G){if(G){var V=I.get();this._activatingStack.push(V),this._activateNodeRecursively(F,V.preload,V.onLoad,V.onEnable),V.preload.invoke(),V.onLoad.invoke(),V.onEnable.invoke(),this._activatingStack.pop(),I.put(V)}else{this._deactivateNodeRecursively(F);for(var j=this._activatingStack,H=0;H<j.length;H++){var U=j[H];U.preload.cancelInactive(B),U.onLoad.cancelInactive(A),U.onEnable.cancelInactive()}}F.emit("active-in-hierarchy-changed",F)},activateComp:function(F,G,V,j){if(cc.isValid(F,!0)&&(F._objFlags&B||(F._objFlags|=B,F.__preload&&(G?G.add(F):F.__preload())),F._objFlags&A||(F._objFlags|=A,F.onLoad?V?V.add(F):(F.onLoad(),F._objFlags|=O):F._objFlags|=O),F._enabled)){if(!F.node._activeInHierarchy)return;cc.director._compScheduler.enableComp(F,j)}},destroyComp:function(F){cc.director._compScheduler.disableComp(F),F.onDestroy&&F._objFlags&O&&F.onDestroy()},resetComp:!1});S.exports=k},{"./component-scheduler":100,"./platform/CCObject":202,"./platform/js":217,"./utils/misc":271}],170:[function(L,S){var T=L("./CCPhysicsTypes").PTM_RATIO,_=L("./CCPhysicsTypes").ContactType,w=[],B=[cc.v2(),cc.v2()],A=new b2.WorldManifold,O={points:[],separations:[],normal:cc.v2()};function R(){this.localPoint=cc.v2(),this.normalImpulse=0,this.tangentImpulse=0}var P=[new R,new R],E=(new b2.Manifold,{type:0,localPoint:cc.v2(),localNormal:cc.v2(),points:[]}),D={normalImpulses:[],tangentImpulses:[]};function I(){}I.prototype.init=function(N){this.colliderA=N.GetFixtureA().collider,this.colliderB=N.GetFixtureB().collider,this.disabled=!1,this.disabledOnce=!1,this._impulse=null,this._inverted=!1,this._b2contact=N,N._contact=this},I.prototype.reset=function(){this.setTangentSpeed(0),this.resetFriction(),this.resetRestitution(),this.colliderA=null,this.colliderB=null,this.disabled=!1,this._impulse=null,this._b2contact._contact=null,this._b2contact=null},I.prototype.getWorldManifold=function(){var N=O.points,k=O.separations,F=O.normal;this._b2contact.GetWorldManifold(A);var G=A.points,V=A.separations,j=this._b2contact.GetManifold().pointCount;N.length=k.length=j;for(var H=0;H<j;H++){var U=B[H];U.x=G[H].x*T,U.y=G[H].y*T,N[H]=U,k[H]=V[H]*T}return F.x=A.normal.x,F.y=A.normal.y,this._inverted&&(F.x*=-1,F.y*=-1),O},I.prototype.getManifold=function(){for(var N=E.points,k=E.localNormal,F=E.localPoint,G=this._b2contact.GetManifold(),V=G.points,j=N.length=G.pointCount,H=0;H<j;H++){var U=P[H],X=V[H];U.localPoint.x=X.localPoint.x*T,U.localPoint.Y=X.localPoint.Y*T,U.normalImpulse=X.normalImpulse*T,U.tangentImpulse=X.tangentImpulse,N[H]=U}return F.x=G.localPoint.x*T,F.y=G.localPoint.y*T,k.x=G.localNormal.x,k.y=G.localNormal.y,E.type=G.type,this._inverted&&(k.x*=-1,k.y*=-1),E},I.prototype.getImpulse=function(){var N=this._impulse;if(!N)return null;for(var k=D.normalImpulses,F=D.tangentImpulses,G=N.count,V=0;V<G;V++)k[V]=N.normalImpulses[V]*T,F[V]=N.tangentImpulses[V];return F.length=k.length=G,D},I.prototype.emit=function(N){var k;switch(N){case _.BEGIN_CONTACT:k="onBeginContact";break;case _.END_CONTACT:k="onEndContact";break;case _.PRE_SOLVE:k="onPreSolve";break;case _.POST_SOLVE:k="onPostSolve"}var F,G,V,j,H=this.colliderA,U=this.colliderB,X=H.body,Y=U.body;if(X.enabledContactListener)for(F=X.node._components,this._inverted=!1,G=0,V=F.length;G<V;G++)(j=F[G])[k]&&j[k](this,H,U);if(Y.enabledContactListener)for(F=Y.node._components,this._inverted=!0,G=0,V=F.length;G<V;G++)(j=F[G])[k]&&j[k](this,U,H);(this.disabled||this.disabledOnce)&&(this.setEnabled(!1),this.disabledOnce=!1)},I.get=function(N){var k;return(k=w.length===0?new cc.PhysicsContact:w.pop()).init(N),k},I.put=function(N){var k=N._contact;k&&(w.push(k),k.reset())};var M=I.prototype;M.setEnabled=function(N){this._b2contact.SetEnabled(N)},M.isTouching=function(){return this._b2contact.IsTouching()},M.setTangentSpeed=function(N){this._b2contact.SetTangentSpeed(N/T)},M.getTangentSpeed=function(){return this._b2contact.GetTangentSpeed()*T},M.setFriction=function(N){this._b2contact.SetFriction(N)},M.getFriction=function(){return this._b2contact.GetFriction()},M.resetFriction=function(){return this._b2contact.ResetFriction()},M.setRestitution=function(N){this._b2contact.SetRestitution(N)},M.getRestitution=function(){return this._b2contact.GetRestitution()},M.resetRestitution=function(){return this._b2contact.ResetRestitution()},I.ContactType=_,cc.PhysicsContact=S.exports=I},{"./CCPhysicsTypes":172}],171:[function(L,S){var T=L("./CCPhysicsTypes"),_=T.ContactType,w=T.BodyType,B=T.RayCastType,A=T.DrawBits,O=T.PTM_RATIO,R=(T.ANGLE_TO_PHYSICS_ANGLE,T.PHYSICS_ANGLE_TO_ANGLE),P=L("./utils").convertToNodeRotation,E=L("./platform/CCPhysicsDebugDraw"),D=new b2.AABB,I=new b2.Vec2,M=new b2.Vec2,N=cc.v2(),k=cc.Class({mixins:[cc.EventTarget],statics:{DrawBits:A,PTM_RATIO:O,VELOCITY_ITERATIONS:10,POSITION_ITERATIONS:10,FIXED_TIME_STEP:1/60,MAX_ACCUMULATOR:.2},ctor:function(){this._debugDrawFlags=0,this._debugDrawer=null,this._world=null,this._bodies=[],this._joints=[],this._contactMap={},this._contactID=0,this._delayEvents=[],this._accumulator=0,cc.director._scheduler&&cc.director._scheduler.enableForTarget(this),this.enabledAccumulator=!1},pushDelayEvent:function(F,G,V){this._steping?this._delayEvents.push({target:F,func:G,args:V}):F[G].apply(F,V)},update:function(F){var G=this._world;if(G&&this.enabled){this.emit("before-step"),this._steping=!0;var V=k.VELOCITY_ITERATIONS,j=k.POSITION_ITERATIONS;if(this.enabledAccumulator){this._accumulator+=F;var H=k.FIXED_TIME_STEP,U=k.MAX_ACCUMULATOR;for(this._accumulator>U&&(this._accumulator=U);this._accumulator>H;)G.Step(H,V,j),this._accumulator-=H}else{var X=1/cc.game.config.frameRate;G.Step(X,V,j)}this.debugDrawFlags&&(this._checkDebugDrawValid(),this._debugDrawer.clear(),G.DrawDebugData()),this._steping=!1;for(var Y=this._delayEvents,z=0,W=Y.length;z<W;z++){var Z=Y[z];Z.target[Z.func].apply(Z.target,Z.args)}Y.length=0,this._syncNode()}},testPoint:function(F){var G=I.x=F.x/O,V=I.y=F.y/O,j=.2/O;D.lowerBound.x=G-j,D.lowerBound.y=V-j,D.upperBound.x=G+j,D.upperBound.y=V+j;var H=this._aabbQueryCallback;H.init(I),this._world.QueryAABB(H,D);var U=H.getFixture();return U?U.collider:null},testAABB:function(F){D.lowerBound.x=F.xMin/O,D.lowerBound.y=F.yMin/O,D.upperBound.x=F.xMax/O,D.upperBound.y=F.yMax/O;var G=this._aabbQueryCallback;return G.init(),this._world.QueryAABB(G,D),G.getFixtures().map(function(V){return V.collider})},rayCast:function(F,G,V){if(F.equals(G))return[];V=V||B.Closest,I.x=F.x/O,I.y=F.y/O,M.x=G.x/O,M.y=G.y/O;var j=this._raycastQueryCallback;j.init(V),this._world.RayCast(j,I,M);var H=j.getFixtures();if(H.length>0){for(var U=j.getPoints(),X=j.getNormals(),Y=j.getFractions(),z=[],W=0,Z=H.length;W<Z;W++){var Q=H[W],ee=Q.collider;if(V===B.AllClosest){var te=z.find(function(re){return re.collider===ee});if(te){Y[W]<te.fraction&&(te.fixtureIndex=ee._getFixtureIndex(Q),te.point.x=U[W].x*O,te.point.y=U[W].y*O,te.normal.x=X[W].x,te.normal.y=X[W].y,te.fraction=Y[W]);continue}}z.push({collider:ee,fixtureIndex:ee._getFixtureIndex(Q),point:cc.v2(U[W].x*O,U[W].y*O),normal:cc.v2(X[W]),fraction:Y[W]})}return z}return[]},syncPosition:function(){for(var F=this._bodies,G=0;G<F.length;G++)F[G].syncPosition()},syncRotation:function(){for(var F=this._bodies,G=0;G<F.length;G++)F[G].syncRotation()},_registerContactFixture:function(F){this._contactListener.registerContactFixture(F)},_unregisterContactFixture:function(F){this._contactListener.unregisterContactFixture(F)},_addBody:function(F,G){var V=this._world,j=F.node;V&&j&&(F._b2Body=V.CreateBody(G),F._b2Body.body=F,this._bodies.push(F))},_removeBody:function(F){var G=this._world;G&&(F._b2Body.body=null,G.DestroyBody(F._b2Body),F._b2Body=null,cc.js.array.remove(this._bodies,F))},_addJoint:function(F,G){var V=this._world.CreateJoint(G);V&&(V._joint=F,F._joint=V,this._joints.push(F))},_removeJoint:function(F){F._isValid()&&this._world.DestroyJoint(F._joint),F._joint&&(F._joint._joint=null),cc.js.array.remove(this._joints,F)},_initCallback:function(){if(this._world){if(!this._contactListener){var F=new cc.PhysicsContactListener;F.setBeginContact(this._onBeginContact),F.setEndContact(this._onEndContact),F.setPreSolve(this._onPreSolve),F.setPostSolve(this._onPostSolve),this._world.SetContactListener(F),this._contactListener=F,this._aabbQueryCallback=new cc.PhysicsAABBQueryCallback,this._raycastQueryCallback=new cc.PhysicsRayCastCallback}}else cc.warn("Please init PhysicsManager first")},_init:function(){this.enabled=!0,this.debugDrawFlags=A.e_shapeBit},_getWorld:function(){return this._world},_syncNode:function(){for(var F=this._bodies,G=0,V=F.length;G<V;G++){var j=F[G],H=j.node,U=j._b2Body,X=U.GetPosition();N.x=X.x*O,N.y=X.y*O;var Y=U.GetAngle()*R;H.parent.parent!==null&&(N=H.parent.convertToNodeSpaceAR(N),Y=P(H.parent,Y));var z=H._eventMask;H._eventMask=0,H.position=N,H.angle=-Y,H._eventMask=z,j.type===w.Animated&&j.resetVelocity()}},_onBeginContact:function(F){cc.PhysicsContact.get(F).emit(_.BEGIN_CONTACT)},_onEndContact:function(F){var G=F._contact;G&&(G.emit(_.END_CONTACT),cc.PhysicsContact.put(F))},_onPreSolve:function(F){var G=F._contact;G&&G.emit(_.PRE_SOLVE)},_onPostSolve:function(F,G){var V=F._contact;V&&(V._impulse=G,V.emit(_.POST_SOLVE),V._impulse=null)},_checkDebugDrawValid:function(){if(!this._debugDrawer||!this._debugDrawer.isValid){var F=new cc.Node("PHYSICS_MANAGER_DEBUG_DRAW");F.zIndex=cc.macro.MAX_ZINDEX,cc.game.addPersistRootNode(F),this._debugDrawer=F.addComponent(cc.Graphics);var G=new E(this._debugDrawer);G.SetFlags(this.debugDrawFlags),this._world.SetDebugDraw(G)}}});cc.js.getset(k.prototype,"enabled",function(){return this._enabled},function(F){if(F&&!this._world){var G=new b2.World(new b2.Vec2(0,-10));G.SetAllowSleeping(!0),this._world=G,this._initCallback()}this._enabled=F}),cc.js.getset(k.prototype,"debugDrawFlags",function(){return this._debugDrawFlags},function(F){F&&!this._debugDrawFlags?this._debugDrawer&&this._debugDrawer.node&&(this._debugDrawer.node.active=!0):!F&&this._debugDrawFlags&&this._debugDrawer&&this._debugDrawer.node&&(this._debugDrawer.node.active=!1),F&&(this._checkDebugDrawValid(),this._world.m_debugDraw.SetFlags(F)),this._debugDrawFlags=F,F&&(this._checkDebugDrawValid(),this._world.m_debugDraw.SetFlags(F))}),cc.js.getset(k.prototype,"gravity",function(){if(this._world){var F=this._world.GetGravity();return cc.v2(F.x*O,F.y*O)}return cc.v2()},function(F){this._world&&this._world.SetGravity(new b2.Vec2(F.x/O,F.y/O))}),cc.PhysicsManager=S.exports=k},{"./CCPhysicsTypes":172,"./platform/CCPhysicsDebugDraw":193,"./utils":195}],172:[function(L,S){var T=cc.Enum({Static:0,Kinematic:1,Dynamic:2,Animated:3});cc.RigidBodyType=T;var _=cc.Enum({Closest:0,Any:1,AllClosest:2,All:3});cc.RayCastType=_,S.exports={BodyType:T,ContactType:{BEGIN_CONTACT:"begin-contact",END_CONTACT:"end-contact",PRE_SOLVE:"pre-solve",POST_SOLVE:"post-solve"},RayCastType:_,DrawBits:b2.DrawFlags,PTM_RATIO:32,ANGLE_TO_PHYSICS_ANGLE:-Math.PI/180,PHYSICS_ANGLE_TO_ANGLE:-180/Math.PI}},{}],173:[function(L,S){function T(G,V){var j=V.length;return V[G<0?j- -G%j:G%j]}function _(G,V,j){for(var H=[];V<G;)V+=j.length;for(;G<=V;++G)H.push(T(G,j));return H}function w(G,V,j){if(B(G,j)){if(R(T(G,j),T(G-1,j),T(V,j))&&P(T(G,j),T(G+1,j),T(V,j)))return!1}else if(P(T(G,j),T(G+1,j),T(V,j))||R(T(G,j),T(G-1,j),T(V,j)))return!1;if(B(V,j)){if(R(T(V,j),T(V-1,j),T(G,j))&&P(T(V,j),T(V+1,j),T(G,j)))return!1}else if(P(T(V,j),T(V+1,j),T(G,j))||R(T(V,j),T(V-1,j),T(G,j)))return!1;for(var H=0;H<j.length;++H)if((H+1)%j.length!=G&&H!=G&&(H+1)%j.length!=V&&H!=V){var U=cc.v2();if(k(T(G,j),T(V,j),T(H,j),T(H+1,j),U))return!1}return!0}function B(G,V){return A(G,V)}function A(G,V,j){if(j===void 0){var H=G,U=V;G=T(H-1,U),V=T(H,U),j=T(H+1,U)}return F(G,V,j)<0}function O(G,V,j){return F(G,V,j)>0}function R(G,V,j){return F(G,V,j)>=0}function P(G,V,j){return F(G,V,j)<=0}function E(G,V){var j=V.x-G.x,H=V.y-G.y;return j*j+H*H}function D(G){I(G)||G.reverse()}function I(G){return G.length<3||M(G)>0}function M(G){var V,j=0;for(V=0;V<G.length;V++){var H=(V+1)%G.length;j+=G[V].x*G[H].y,j-=G[V].y*G[H].x}return j/2}function N(G,V,j,H){var U,X=cc.v2(),Y=V.y-G.y,z=G.x-V.x,W=Y*G.x+z*G.y,Z=H.y-j.y,Q=j.x-H.x,ee=Z*j.x+Q*j.y,te=Y*Q-Z*z;return U=te,Math.abs(U-0)<=1e-6||(X.x=(Q*W-z*ee)/te,X.y=(Y*ee-Z*W)/te),X}function k(G,V,j,H,U){if(G==j||G==H||V==j||V==H)return!1;var X=G.x,Y=G.y,z=V.x,W=V.y,Z=j.x,Q=j.y,ee=H.x,te=H.y;if(Math.max(X,z)<Math.min(Z,ee)||Math.max(Z,ee)<Math.min(X,z)||Math.max(Y,W)<Math.min(Q,te)||Math.max(Q,te)<Math.min(Y,W))return!1;var re=(ee-Z)*(Y-Q)-(te-Q)*(X-Z),ie=(z-X)*(Y-Q)-(W-Y)*(X-Z),ne=(te-Q)*(z-X)-(ee-Z)*(W-Y);return!(Math.abs(ne)<1e-6)&&(ie/=ne,0<(re/=ne)&&re<1&&0<ie&&ie<1&&(U.x=X+re*(z-X),U.y=Y+re*(W-Y),!0))}function F(G,V,j){return G.x*(V.y-j.y)+V.x*(j.y-G.y)+j.x*(G.y-V.y)}S.exports={ConvexPartition:function G(V){D(V);for(var j,H,U,X,Y,z,W=[],Z=null,Q=null,ee=0,te=0,re=0;re<V.length;++re)if(B(re,V)){H=U=Number.MAX_SAFE_INTEGER||9999999999999;for(var ie=0;ie<V.length;++ie)O(T(re-1,V),T(re,V),T(ie,V))&&P(T(re-1,V),T(re,V),T(ie-1,V))&&(X=N(T(re-1,V),T(re,V),T(ie,V),T(ie-1,V)),A(T(re+1,V),T(re,V),X)&&(j=E(T(re,V),X))<H&&(H=j,Z=X,ee=ie)),O(T(re+1,V),T(re,V),T(ie+1,V))&&P(T(re+1,V),T(re,V),T(ie,V))&&(X=N(T(re+1,V),T(re,V),T(ie,V),T(ie+1,V)),O(T(re-1,V),T(re,V),X)&&(j=E(T(re,V),X))<U&&(U=j,te=ie,Q=X));if(ee==(te+1)%V.length){var ne=Z.add(Q).div(2);(Y=_(re,te,V)).push(ne),(z=_(ee,re,V)).push(ne)}else{for(var he=0,pe=ee;te<ee;)te+=V.length;for(ie=ee;ie<=te;++ie)if(w(re,ie,V)){var K=1/(E(T(re,V),T(ie,V))+1);B(ie,V)?P(T(ie-1,V),T(ie,V),T(re,V))&&R(T(ie+1,V),T(ie,V),T(re,V))?K+=3:K+=2:K+=1,K>he&&(pe=ie,he=K)}Y=_(re,pe,V),z=_(pe,re,V)}return(W=W.concat(G(Y))).concat(G(z))}for(W.push(V),re=W.length-1;re>=0;re--)W[re].length==0&&W.splice(re,0);return W},ForceCounterClockWise:D,IsCounterClockWise:I}},{}],174:[function(L,S){var T=L("../CCNode").EventType,_=L("./CCPhysicsTypes").PTM_RATIO,w=L("./CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,B=L("./CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,A=L("./utils").getWorldRotation,O=L("./CCPhysicsTypes").BodyType,R=new b2.Vec2,P=new b2.Vec2,E=cc.Vec2.ZERO,D=cc.Class({name:"cc.RigidBody",extends:cc.Component,editor:!1,properties:{_type:O.Dynamic,_allowSleep:!0,_gravityScale:1,_linearDamping:0,_angularDamping:0,_linearVelocity:cc.v2(0,0),_angularVelocity:0,_fixedRotation:!1,enabled:{get:function(){return this._enabled},set:function(){cc.warnID(8200)},visible:!1,override:!0},enabledContactListener:{default:!1,tooltip:!1},bullet:{default:!1,tooltip:!1},type:{type:O,tooltip:!1,get:function(){return this._type},set:function(I){this._type=I,this._b2Body&&(I===O.Animated?this._b2Body.SetType(O.Kinematic):this._b2Body.SetType(I))}},allowSleep:{tooltip:!1,get:function(){return this._b2Body?this._b2Body.IsSleepingAllowed():this._allowSleep},set:function(I){this._allowSleep=I,this._b2Body&&this._b2Body.SetSleepingAllowed(I)}},gravityScale:{tooltip:!1,get:function(){return this._gravityScale},set:function(I){this._gravityScale=I,this._b2Body&&this._b2Body.SetGravityScale(I)}},linearDamping:{tooltip:!1,get:function(){return this._linearDamping},set:function(I){this._linearDamping=I,this._b2Body&&this._b2Body.SetLinearDamping(this._linearDamping)}},angularDamping:{tooltip:!1,get:function(){return this._angularDamping},set:function(I){this._angularDamping=I,this._b2Body&&this._b2Body.SetAngularDamping(I)}},linearVelocity:{tooltip:!1,type:cc.Vec2,get:function(){var I=this._linearVelocity;if(this._b2Body){var M=this._b2Body.GetLinearVelocity();I.x=M.x*_,I.y=M.y*_}return I},set:function(I){this._linearVelocity=I;var M=this._b2Body;if(M){var N=M.m_linearVelocity;N.Set(I.x/_,I.y/_),M.SetLinearVelocity(N)}}},angularVelocity:{tooltip:!1,get:function(){return this._b2Body?this._b2Body.GetAngularVelocity()*B:this._angularVelocity},set:function(I){this._angularVelocity=I,this._b2Body&&this._b2Body.SetAngularVelocity(I*w)}},fixedRotation:{tooltip:!1,get:function(){return this._fixedRotation},set:function(I){this._fixedRotation=I,this._b2Body&&this._b2Body.SetFixedRotation(I)}},awake:{visible:!1,tooltip:!1,get:function(){return!!this._b2Body&&this._b2Body.IsAwake()},set:function(I){this._b2Body&&this._b2Body.SetAwake(I)}},awakeOnLoad:{default:!0,tooltip:!1,animatable:!1},active:{visible:!1,get:function(){return!!this._b2Body&&this._b2Body.IsActive()},set:function(I){this._b2Body&&this._b2Body.SetActive(I)}}},getLocalPoint:function(I,M){if(M=M||cc.v2(),this._b2Body){R.Set(I.x/_,I.y/_);var N=this._b2Body.GetLocalPoint(R,M);M.x=N.x*_,M.y=N.y*_}return M},getWorldPoint:function(I,M){if(M=M||cc.v2(),this._b2Body){R.Set(I.x/_,I.y/_);var N=this._b2Body.GetWorldPoint(R,M);M.x=N.x*_,M.y=N.y*_}return M},getWorldVector:function(I,M){if(M=M||cc.v2(),this._b2Body){R.Set(I.x/_,I.y/_);var N=this._b2Body.GetWorldVector(R,M);M.x=N.x*_,M.y=N.y*_}return M},getLocalVector:function(I,M){if(M=M||cc.v2(),this._b2Body){R.Set(I.x/_,I.y/_);var N=this._b2Body.GetLocalVector(R,M);M.x=N.x*_,M.y=N.y*_}return M},getWorldPosition:function(I){if(I=I||cc.v2(),this._b2Body){var M=this._b2Body.GetPosition();I.x=M.x*_,I.y=M.y*_}return I},getWorldRotation:function(){return this._b2Body?this._b2Body.GetAngle()*B:0},getLocalCenter:function(I){if(I=I||cc.v2(),this._b2Body){var M=this._b2Body.GetLocalCenter();I.x=M.x*_,I.y=M.y*_}return I},getWorldCenter:function(I){if(I=I||cc.v2(),this._b2Body){var M=this._b2Body.GetWorldCenter();I.x=M.x*_,I.y=M.y*_}return I},getLinearVelocityFromWorldPoint:function(I,M){if(M=M||cc.v2(),this._b2Body){R.Set(I.x/_,I.y/_);var N=this._b2Body.GetLinearVelocityFromWorldPoint(R,M);M.x=N.x*_,M.y=N.y*_}return M},getMass:function(){return this._b2Body?this._b2Body.GetMass():0},getInertia:function(){return this._b2Body?this._b2Body.GetInertia()*_*_:0},getJointList:function(){if(!this._b2Body)return[];var I=[],M=this._b2Body.GetJointList();if(!M)return[];I.push(M.joint._joint);for(var N=M.prev;N;)I.push(N.joint._joint),N=N.prev;for(var k=M.next;k;)I.push(k.joint._joint),k=k.next;return I},applyForce:function(I,M,N){this._b2Body&&(R.Set(I.x/_,I.y/_),P.Set(M.x/_,M.y/_),this._b2Body.ApplyForce(R,P,N))},applyForceToCenter:function(I,M){this._b2Body&&(R.Set(I.x/_,I.y/_),this._b2Body.ApplyForceToCenter(R,M))},applyTorque:function(I,M){this._b2Body&&this._b2Body.ApplyTorque(I/_,M)},applyLinearImpulse:function(I,M,N){this._b2Body&&(R.Set(I.x/_,I.y/_),P.Set(M.x/_,M.y/_),this._b2Body.ApplyLinearImpulse(R,P,N))},applyAngularImpulse:function(I,M){this._b2Body&&this._b2Body.ApplyAngularImpulse(I/_/_,M)},syncPosition:function(I){var M=this._b2Body;if(M){var N,k=this.node.convertToWorldSpaceAR(E);if((N=this.type===O.Animated?M.GetLinearVelocity():M.GetPosition()).x=k.x/_,N.y=k.y/_,this.type===O.Animated&&I){var F=M.GetPosition(),G=cc.game.config.frameRate;N.x=(N.x-F.x)*G,N.y=(N.y-F.y)*G,M.SetAwake(!0),M.SetLinearVelocity(N)}else M.SetTransformVec(N,M.GetAngle())}},syncRotation:function(I){var M=this._b2Body;if(M){var N=w*A(this.node);if(this.type===O.Animated&&I){var k=M.GetAngle(),F=cc.game.config.frameRate;M.SetAwake(!0),M.SetAngularVelocity((N-k)*F)}else M.SetTransformVec(M.GetPosition(),N)}},resetVelocity:function(){var I=this._b2Body;if(I){var M=I.m_linearVelocity;M.Set(0,0),I.SetLinearVelocity(M),I.SetAngularVelocity(0)}},onEnable:function(){this._init()},onDisable:function(){this._destroy()},_registerNodeEvents:function(){var I=this.node;I.on(T.POSITION_CHANGED,this._onNodePositionChanged,this),I.on(T.ROTATION_CHANGED,this._onNodeRotationChanged,this),I.on(T.SCALE_CHANGED,this._onNodeScaleChanged,this)},_unregisterNodeEvents:function(){var I=this.node;I.off(T.POSITION_CHANGED,this._onNodePositionChanged,this),I.off(T.ROTATION_CHANGED,this._onNodeRotationChanged,this),I.off(T.SCALE_CHANGED,this._onNodeScaleChanged,this)},_onNodePositionChanged:function(){this.syncPosition(!0)},_onNodeRotationChanged:function(){this.syncRotation(!0)},_onNodeScaleChanged:function(){if(this._b2Body)for(var I=this.getComponents(cc.PhysicsCollider),M=0;M<I.length;M++)I[M].apply()},_init:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__init",[])},_destroy:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__destroy",[])},__init:function(){if(!this._inited){this._registerNodeEvents();var I=new b2.BodyDef;this.type===O.Animated?I.type=O.Kinematic:I.type=this.type,I.allowSleep=this.allowSleep,I.gravityScale=this.gravityScale,I.linearDamping=this.linearDamping,I.angularDamping=this.angularDamping;var M=this.linearVelocity;I.linearVelocity=new b2.Vec2(M.x/_,M.y/_),I.angularVelocity=this.angularVelocity*w,I.fixedRotation=this.fixedRotation,I.bullet=this.bullet;var N=this.node,k=N.convertToWorldSpaceAR(E);I.position=new b2.Vec2(k.x/_,k.y/_),I.angle=-Math.PI/180*A(N),I.awake=this.awakeOnLoad,cc.director.getPhysicsManager()._addBody(this,I),this._inited=!0}},__destroy:function(){this._inited&&(cc.director.getPhysicsManager()._removeBody(this),this._unregisterNodeEvents(),this._inited=!1)},_getBody:function(){return this._b2Body}});cc.RigidBody=S.exports=D},{"../CCNode":29,"./CCPhysicsTypes":172,"./utils":195}],175:[function(L){var S=L("../../../external/box2d/box2d");for(var T in window.b2={},S)if(T.indexOf("b2_")===-1){var _=T.replace("b2","");b2[_]=S[T]}b2.maxPolygonVertices=8},{"../../../external/box2d/box2d":381}],176:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=cc.Class({name:"cc.PhysicsBoxCollider",extends:cc.PhysicsCollider,mixins:[cc.Collider.Box],editor:{menu:!1,help:"i18n:COMPONENT.help_url.edit-collider-component",requireComponent:cc.RigidBody},_createShape:function(w){var B=Math.abs(w.x),A=Math.abs(w.y),O=this.size.width/2/T*B,R=this.size.height/2/T*A,P=this.offset.x/T*B,E=this.offset.y/T*A,D=new b2.PolygonShape;return D.SetAsBox(O,R,new b2.Vec2(P,E),0),D}});cc.PhysicsBoxCollider=S.exports=_},{"../CCPhysicsTypes":172}],177:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=cc.Class({name:"cc.PhysicsChainCollider",extends:cc.PhysicsCollider,editor:{menu:!1,inspector:!1,help:"i18n:COMPONENT.help_url.edit-collider-component",requireComponent:cc.RigidBody},properties:{loop:!1,points:{default:function(){return[cc.v2(-50,0),cc.v2(50,0)]},type:[cc.Vec2]},threshold:{default:1,serializable:!1,visible:!1}},_createShape:function(w){for(var B=new b2.ChainShape,A=this.points,O=[],R=0;R<A.length;R++){var P=A[R];O.push(new b2.Vec2(P.x/T*w.x,P.y/T*w.y))}return this.loop?B.CreateLoop(O,O.length):B.CreateChain(O,O.length),B},resetInEditor:!1,resetPointsByContour:!1});cc.PhysicsChainCollider=S.exports=_},{"../CCPhysicsTypes":172}],178:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=cc.Class({name:"cc.PhysicsCircleCollider",extends:cc.PhysicsCollider,mixins:[cc.Collider.Circle],editor:{menu:!1,help:"i18n:COMPONENT.help_url.edit-collider-component",requireComponent:cc.RigidBody},_createShape:function(w){var B=Math.abs(w.x),A=Math.abs(w.y),O=this.offset.x/T*B,R=this.offset.y/T*A,P=new b2.CircleShape;return P.m_radius=this.radius/T*B,P.m_p=new b2.Vec2(O,R),P}});cc.PhysicsCircleCollider=S.exports=_},{"../CCPhysicsTypes":172}],179:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=L("../utils").getWorldScale,w=new b2.AABB,B=cc.Class({name:"cc.PhysicsCollider",extends:cc.Collider,ctor:function(){this._fixtures=[],this._shapes=[],this._inited=!1,this._rect=cc.rect()},properties:{_density:1,_sensor:!1,_friction:.2,_restitution:0,density:{tooltip:!1,get:function(){return this._density},set:function(A){this._density=A}},sensor:{tooltip:!1,get:function(){return this._sensor},set:function(A){this._sensor=A}},friction:{tooltip:!1,get:function(){return this._friction},set:function(A){this._friction=A}},restitution:{tooltip:!1,get:function(){return this._restitution},set:function(A){this._restitution=A}},body:{default:null,type:cc.RigidBody,visible:!1}},onDisable:function(){this._destroy()},onEnable:function(){this._init()},start:function(){this._init()},_getFixtureIndex:function(A){return this._fixtures.indexOf(A)},_init:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__init",[])},_destroy:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__destroy",[])},__init:function(){if(!this._inited){var A=this.body||this.getComponent(cc.RigidBody);if(A){var O=A._getBody();if(O){var R=A.node,P=_(R);this._scale=P;var E=P.x===0&&P.y===0?[]:this._createShape(P);E instanceof Array||(E=[E]);for(var D=1<<R.groupIndex,I=0,M=cc.game.collisionMatrix[R.groupIndex],N=0;N<M.length;N++)M[N]&&(I|=1<<N);for(var k={categoryBits:D,maskBits:I,groupIndex:0},F=cc.director.getPhysicsManager(),G=0;G<E.length;G++){var V=E[G],j=new b2.FixtureDef;j.density=this.density,j.isSensor=this.sensor,j.friction=this.friction,j.restitution=this.restitution,j.shape=V,j.filter=k;var H=O.CreateFixture(j);H.collider=this,A.enabledContactListener&&F._registerContactFixture(H),this._shapes.push(V),this._fixtures.push(H)}this.body=A,this._inited=!0}}}},__destroy:function(){if(this._inited){for(var A=this._fixtures,O=this.body._getBody(),R=cc.director.getPhysicsManager(),P=A.length-1;P>=0;P--){var E=A[P];E.collider=null,R._unregisterContactFixture(E),O&&O.DestroyFixture(E)}this.body=null,this._fixtures.length=0,this._shapes.length=0,this._inited=!1}},_createShape:function(){},apply:function(){this._destroy(),this._init()},getAABB:function(){for(var A=1e7,O=1e7,R=-1e7,P=-1e7,E=this.body._getBody().GetTransform(),D=this._fixtures,I=0;I<D.length;I++)for(var M=D[I].GetShape(),N=M.GetChildCount(),k=0;k<N;k++)M.ComputeAABB(w,E,k),w.lowerBound.x<A&&(A=w.lowerBound.x),w.lowerBound.y<O&&(O=w.lowerBound.y),w.upperBound.x>R&&(R=w.upperBound.x),w.upperBound.y>P&&(P=w.upperBound.y);A*=T,O*=T,R*=T,P*=T;var F=this._rect;return F.x=A,F.y=O,F.width=R-A,F.height=P-O,F}});cc.PhysicsCollider=S.exports=B},{"../CCPhysicsTypes":172,"../utils":195}],180:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=L("../CCPolygonSeparator"),w=cc.Class({name:"cc.PhysicsPolygonCollider",extends:cc.PhysicsCollider,mixins:[cc.Collider.Polygon],editor:{menu:!1,inspector:!1,help:"i18n:COMPONENT.help_url.edit-collider-component",requireComponent:cc.RigidBody},_createShape:function(B){var A=[],O=this.points;O.length>0&&O[0].equals(O[O.length-1])&&(O.length-=1);for(var R=_.ConvexPartition(O),P=this.offset,E=0;E<R.length;E++){for(var D=R[E],I=null,M=[],N=null,k=0,F=D.length;k<F;k++){I||(I=new b2.PolygonShape);var G=D[k],V=(G.x+P.x)/T*B.x,j=(G.y+P.y)/T*B.y,H=new b2.Vec2(V,j);M.push(H),N||(N=H),M.length===b2.maxPolygonVertices&&(I.Set(M,M.length),A.push(I),I=null,k<F-1&&(M=[N,M[M.length-1]]))}I&&(I.Set(M,M.length),A.push(I))}return A}});cc.PhysicsPolygonCollider=S.exports=w},{"../CCPhysicsTypes":172,"../CCPolygonSeparator":173}],181:[function(L){L("./box2d-adapter"),L("./CCPhysicsManager"),L("./CCRigidBody"),L("./CCPhysicsContact"),L("./collider/CCPhysicsCollider"),L("./collider/CCPhysicsChainCollider"),L("./collider/CCPhysicsCircleCollider"),L("./collider/CCPhysicsBoxCollider"),L("./collider/CCPhysicsPolygonCollider"),L("./joint/CCJoint"),L("./joint/CCDistanceJoint"),L("./joint/CCRevoluteJoint"),L("./joint/CCMouseJoint"),L("./joint/CCMotorJoint"),L("./joint/CCPrismaticJoint"),L("./joint/CCWeldJoint"),L("./joint/CCWheelJoint"),L("./joint/CCRopeJoint"),L("./platform/CCPhysicsContactListner"),L("./platform/CCPhysicsAABBQueryCallback"),L("./platform/CCPhysicsRayCastCallback")},{"./CCPhysicsContact":170,"./CCPhysicsManager":171,"./CCRigidBody":174,"./box2d-adapter":175,"./collider/CCPhysicsBoxCollider":176,"./collider/CCPhysicsChainCollider":177,"./collider/CCPhysicsCircleCollider":178,"./collider/CCPhysicsCollider":179,"./collider/CCPhysicsPolygonCollider":180,"./joint/CCDistanceJoint":182,"./joint/CCJoint":183,"./joint/CCMotorJoint":184,"./joint/CCMouseJoint":185,"./joint/CCPrismaticJoint":186,"./joint/CCRevoluteJoint":187,"./joint/CCRopeJoint":188,"./joint/CCWeldJoint":189,"./joint/CCWheelJoint":190,"./platform/CCPhysicsAABBQueryCallback":191,"./platform/CCPhysicsContactListner":192,"./platform/CCPhysicsRayCastCallback":194}],182:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=cc.Class({name:"cc.DistanceJoint",extends:cc.Joint,editor:!1,properties:{_distance:1,_frequency:0,_dampingRatio:0,distance:{tooltip:!1,get:function(){return this._distance},set:function(w){this._distance=w,this._joint&&this._joint.SetLength(w)}},frequency:{tooltip:!1,get:function(){return this._frequency},set:function(w){this._frequency=w,this._joint&&this._joint.SetFrequency(w)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(w){this._dampingRatio=w,this._joint&&this._joint.SetDampingRatio(w)}}},_createJointDef:function(){var w=new b2.DistanceJointDef;return w.localAnchorA=new b2.Vec2(this.anchor.x/T,this.anchor.y/T),w.localAnchorB=new b2.Vec2(this.connectedAnchor.x/T,this.connectedAnchor.y/T),w.length=this.distance/T,w.dampingRatio=this.dampingRatio,w.frequencyHz=this.frequency,w}});cc.DistanceJoint=S.exports=_},{"../CCPhysicsTypes":172}],183:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=cc.Class({name:"cc.Joint",extends:cc.Component,editor:{requireComponent:cc.RigidBody},properties:{anchor:{default:cc.v2(0,0),tooltip:!1},connectedAnchor:{default:cc.v2(0,0),tooltip:!1},connectedBody:{default:null,type:cc.RigidBody,tooltip:!1},collideConnected:{default:!1,tooltip:!1}},onDisable:function(){this._destroy()},onEnable:function(){this._init()},start:function(){this._init()},apply:function(){this._destroy(),this._init()},getWorldAnchor:function(){if(this._joint){var w=this._joint.GetAnchorA();return cc.v2(w.x*T,w.y*T)}return cc.Vec2.ZERO},getWorldConnectedAnchor:function(){if(this._joint){var w=this._joint.GetAnchorB();return cc.v2(w.x*T,w.y*T)}return cc.Vec2.ZERO},getReactionForce:function(w){var B=cc.v2();return this._joint?this._joint.GetReactionForce(w,B):B},getReactionTorque:function(w){return this._joint?this._joint.GetReactionTorque(w):0},_init:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__init",[])},_destroy:function(){cc.director.getPhysicsManager().pushDelayEvent(this,"__destroy",[])},__init:function(){if(!this._inited&&(this.body=this.getComponent(cc.RigidBody),this._isValid())){var w=this._createJointDef();if(!w)return;w.bodyA=this.body._getBody(),w.bodyB=this.connectedBody._getBody(),w.collideConnected=this.collideConnected,cc.director.getPhysicsManager()._addJoint(this,w),this._inited=!0}},__destroy:function(){this._inited&&(cc.director.getPhysicsManager()._removeJoint(this),this._joint=null,this._inited=!1)},_createJointDef:function(){return null},_isValid:function(){return this.body&&this.body._getBody()&&this.connectedBody&&this.connectedBody._getBody()}});cc.Joint=S.exports=_},{"../CCPhysicsTypes":172}],184:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=L("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,w=cc.Class({name:"cc.MotorJoint",extends:cc.Joint,editor:!1,properties:{_linearOffset:cc.v2(0,0),_angularOffset:0,_maxForce:1,_maxTorque:1,_correctionFactor:.3,anchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},connectedAnchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},linearOffset:{tooltip:!1,get:function(){return this._linearOffset},set:function(B){this._linearOffset=B,this._joint&&this._joint.SetLinearOffset(new b2.Vec2(B.x/T,B.y/T))}},angularOffset:{tooltip:!1,get:function(){return this._angularOffset},set:function(B){this._angularOffset=B,this._joint&&this._joint.SetAngularOffset(B)}},maxForce:{tooltip:!1,get:function(){return this._maxForce},set:function(B){this._maxForce=B,this._joint&&this._joint.SetMaxForce(B)}},maxTorque:{tooltip:!1,get:function(){return this._maxTorque},set:function(B){this._maxTorque=B,this._joint&&this._joint.SetMaxTorque(B)}},correctionFactor:{tooltip:!1,get:function(){return this._correctionFactor},set:function(B){this._correctionFactor=B,this._joint&&this._joint.SetCorrectionFactor(B)}}},_createJointDef:function(){var B=new b2.MotorJointDef;return B.linearOffset=new b2.Vec2(this.linearOffset.x/T,this.linearOffset.y/T),B.angularOffset=this.angularOffset*_,B.maxForce=this.maxForce,B.maxTorque=this.maxTorque,B.correctionFactor=this.correctionFactor,B}});cc.MotorJoint=S.exports=w},{"../CCPhysicsTypes":172}],185:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=new b2.Vec2,w=cc.Class({name:"cc.MouseJoint",extends:cc.Joint,editor:!1,properties:{_target:1,_frequency:5,_dampingRatio:.7,_maxForce:0,connectedBody:{default:null,type:cc.RigidBody,visible:!1,override:!0},collideConnected:{default:!0,visible:!1,override:!0},anchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},connectedAnchor:{tooltip:!1,default:cc.v2(0,0),override:!0,visible:!1},mouseRegion:{tooltip:!1,default:null,type:cc.Node},target:{tooltip:!1,visible:!1,get:function(){return this._target},set:function(B){this._target=B,this._joint&&(_.x=B.x/T,_.y=B.y/T,this._joint.SetTarget(_))}},frequency:{tooltip:!1,get:function(){return this._frequency},set:function(B){this._frequency=B,this._joint&&this._joint.SetFrequency(B)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(B){this._dampingRatio=B,this._joint&&this._joint.SetDampingRatio(B)}},maxForce:{tooltip:!1,visible:!1,get:function(){return this._maxForce},set:function(B){this._maxForce=B,this._joint&&this._joint.SetMaxForce(B)}}},onLoad:function(){var B=this.mouseRegion||this.node;B.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),B.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),B.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),B.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},onEnable:function(){},start:function(){},onTouchBegan:function(B){var A=cc.director.getPhysicsManager(),O=this._pressPoint=B.touch.getLocation();cc.Camera&&cc.Camera.main&&(O=cc.Camera.main.getScreenToWorldPoint(O));var R=A.testPoint(O);R&&((this.connectedBody=R.body).awake=!0,this.maxForce=1e3*this.connectedBody.getMass(),this.target=O,this._init())},onTouchMove:function(B){this._pressPoint=B.touch.getLocation()},onTouchEnd:function(){this._destroy(),this._pressPoint=null},_createJointDef:function(){var B=new b2.MouseJointDef;return _.x=this.target.x/T,_.y=this.target.y/T,B.target=_,B.maxForce=this.maxForce,B.dampingRatio=this.dampingRatio,B.frequencyHz=this.frequency,B},update:function(){if(this._pressPoint&&this._isValid()){var B=cc.Camera.findCamera(this.node);this.target=B?B.getScreenToWorldPoint(this._pressPoint):this._pressPoint}}});cc.MouseJoint=S.exports=w},{"../CCPhysicsTypes":172}],186:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=L("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,w=cc.Class({name:"cc.PrismaticJoint",extends:cc.Joint,editor:!1,properties:{localAxisA:{default:cc.v2(1,0),tooltip:!1},referenceAngle:{default:0,tooltip:!1},enableLimit:{default:!1,tooltip:!1},enableMotor:{default:!1,tooltip:!1},lowerLimit:{default:0,tooltip:!1},upperLimit:{default:0,tooltip:!1},_maxMotorForce:0,_motorSpeed:0,maxMotorForce:{tooltip:!1,get:function(){return this._maxMotorForce},set:function(B){this._maxMotorForce=B,this._joint&&this._joint.SetMaxMotorForce(B)}},motorSpeed:{tooltip:!1,get:function(){return this._motorSpeed},set:function(B){this._motorSpeed=B,this._joint&&this._joint.SetMotorSpeed(B)}}},_createJointDef:function(){var B=new b2.PrismaticJointDef;return B.localAnchorA=new b2.Vec2(this.anchor.x/T,this.anchor.y/T),B.localAnchorB=new b2.Vec2(this.connectedAnchor.x/T,this.connectedAnchor.y/T),B.localAxisA=new b2.Vec2(this.localAxisA.x,this.localAxisA.y),B.referenceAngle=this.referenceAngle*_,B.enableLimit=this.enableLimit,B.lowerTranslation=this.lowerLimit/T,B.upperTranslation=this.upperLimit/T,B.enableMotor=this.enableMotor,B.maxMotorForce=this.maxMotorForce,B.motorSpeed=this.motorSpeed,B}});cc.PrismaticJoint=S.exports=w},{"../CCPhysicsTypes":172}],187:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=L("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,w=L("../CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE,B=cc.Class({name:"cc.RevoluteJoint",extends:cc.Joint,editor:!1,properties:{_maxMotorTorque:0,_motorSpeed:0,_enableLimit:!1,_enableMotor:!1,referenceAngle:{default:0,tooltip:!1},lowerAngle:{default:0,tooltip:!1},upperAngle:{default:0,tooltip:!1},maxMotorTorque:{tooltip:!1,get:function(){return this._maxMotorTorque},set:function(A){this._maxMotorTorque=A,this._joint&&this._joint.SetMaxMotorTorque(A)}},motorSpeed:{tooltip:!1,get:function(){return this._motorSpeed},set:function(A){this._motorSpeed=A,this._joint&&this._joint.SetMotorSpeed(A*_)}},enableLimit:{tooltip:!1,get:function(){return this._enableLimit},set:function(A){this._enableLimit=A,this._joint&&this._joint.EnableLimit(A)}},enableMotor:{tooltip:!1,get:function(){return this._enableMotor},set:function(A){this._enableMotor=A,this._joint&&this._joint.EnableMotor(A)}}},getJointAngle:function(){return this._joint?this._joint.GetJointAngle()*w:0},setLimits:function(A,O){if(this._joint)return this._joint.SetLimits(A*_,O*_)},_createJointDef:function(){var A=new b2.RevoluteJointDef;return A.localAnchorA=new b2.Vec2(this.anchor.x/T,this.anchor.y/T),A.localAnchorB=new b2.Vec2(this.connectedAnchor.x/T,this.connectedAnchor.y/T),A.lowerAngle=this.upperAngle*_,A.upperAngle=this.lowerAngle*_,A.maxMotorTorque=this.maxMotorTorque,A.motorSpeed=this.motorSpeed*_,A.enableLimit=this.enableLimit,A.enableMotor=this.enableMotor,A.referenceAngle=this.referenceAngle*_,A}});cc.RevoluteJoint=S.exports=B},{"../CCPhysicsTypes":172}],188:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=cc.Class({name:"cc.RopeJoint",extends:cc.Joint,editor:!1,properties:{_maxLength:1,maxLength:{tooltip:!1,get:function(){return this._maxLength},set:function(w){this._maxLength=w,this._joint&&this._joint.SetMaxLength(w)}}},_createJointDef:function(){var w=new b2.RopeJointDef;return w.localAnchorA=new b2.Vec2(this.anchor.x/T,this.anchor.y/T),w.localAnchorB=new b2.Vec2(this.connectedAnchor.x/T,this.connectedAnchor.y/T),w.maxLength=this.maxLength/T,w}});cc.RopeJoint=S.exports=_},{"../CCPhysicsTypes":172}],189:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=L("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,w=cc.Class({name:"cc.WeldJoint",extends:cc.Joint,editor:!1,properties:{referenceAngle:{default:0,tooltip:!1},_frequency:0,_dampingRatio:0,frequency:{tooltip:!1,get:function(){return this._frequency},set:function(B){this._frequency=B,this._joint&&this._joint.SetFrequency(B)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(B){this._dampingRatio=B,this._joint&&this._joint.SetDampingRatio(B)}}},_createJointDef:function(){var B=new b2.WeldJointDef;return B.localAnchorA=new b2.Vec2(this.anchor.x/T,this.anchor.y/T),B.localAnchorB=new b2.Vec2(this.connectedAnchor.x/T,this.connectedAnchor.y/T),B.referenceAngle=this.referenceAngle*_,B.frequencyHz=this.frequency,B.dampingRatio=this.dampingRatio,B}});cc.WeldJoint=S.exports=w},{"../CCPhysicsTypes":172}],190:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=L("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE,w=cc.Class({name:"cc.WheelJoint",extends:cc.Joint,editor:!1,properties:{_maxMotorTorque:0,_motorSpeed:0,_enableMotor:!1,_frequency:2,_dampingRatio:.7,localAxisA:{default:cc.v2(1,0),tooltip:!1},maxMotorTorque:{tooltip:!1,get:function(){return this._maxMotorTorque},set:function(B){this._maxMotorTorque=B,this._joint&&this._joint.SetMaxMotorTorque(B)}},motorSpeed:{tooltip:!1,get:function(){return this._motorSpeed},set:function(B){this._motorSpeed=B,this._joint&&this._joint.SetMotorSpeed(B*_)}},enableMotor:{tooltip:!1,get:function(){return this._enableMotor},set:function(B){this._enableMotor=B,this._joint&&this._joint.EnableMotor(B)}},frequency:{tooltip:!1,get:function(){return this._frequency},set:function(B){this._frequency=B,this._joint&&this._joint.SetSpringFrequencyHz(B)}},dampingRatio:{tooltip:!1,get:function(){return this._dampingRatio},set:function(B){this._dampingRatio=B,this._joint&&this._joint.SetDampingRatio(B)}}},_createJointDef:function(){var B=new b2.WheelJointDef;return B.localAnchorA=new b2.Vec2(this.anchor.x/T,this.anchor.y/T),B.localAnchorB=new b2.Vec2(this.connectedAnchor.x/T,this.connectedAnchor.y/T),B.localAxisA=new b2.Vec2(this.localAxisA.x,this.localAxisA.y),B.maxMotorTorque=this.maxMotorTorque,B.motorSpeed=this.motorSpeed*_,B.enableMotor=this.enableMotor,B.dampingRatio=this.dampingRatio,B.frequencyHz=this.frequency,B}});cc.WheelJoint=S.exports=w},{"../CCPhysicsTypes":172}],191:[function(L,S){var T=L("../CCPhysicsTypes").BodyType;function _(){this._point=new b2.Vec2,this._isPoint=!1,this._fixtures=[]}_.prototype.init=function(w){w?(this._isPoint=!0,this._point.x=w.x,this._point.y=w.y):this._isPoint=!1,this._fixtures.length=0},_.prototype.ReportFixture=function(w){if(w.GetBody().GetType()===T.Dynamic)if(this._isPoint){if(w.TestPoint(this._point))return this._fixtures.push(w),!1}else this._fixtures.push(w);return!0},_.prototype.getFixture=function(){return this._fixtures[0]},_.prototype.getFixtures=function(){return this._fixtures},cc.PhysicsAABBQueryCallback=S.exports=_},{"../CCPhysicsTypes":172}],192:[function(L,S){function T(){this._contactFixtures=[]}T.prototype.setBeginContact=function(_){this._BeginContact=_},T.prototype.setEndContact=function(_){this._EndContact=_},T.prototype.setPreSolve=function(_){this._PreSolve=_},T.prototype.setPostSolve=function(_){this._PostSolve=_},T.prototype.BeginContact=function(_){if(this._BeginContact){var w=_.GetFixtureA(),B=_.GetFixtureB(),A=this._contactFixtures;_._shouldReport=!1,A.indexOf(w)===-1&&A.indexOf(B)===-1||(_._shouldReport=!0,this._BeginContact(_))}},T.prototype.EndContact=function(_){this._EndContact&&_._shouldReport&&(_._shouldReport=!1,this._EndContact(_))},T.prototype.PreSolve=function(_,w){this._PreSolve&&_._shouldReport&&this._PreSolve(_,w)},T.prototype.PostSolve=function(_,w){this._PostSolve&&_._shouldReport&&this._PostSolve(_,w)},T.prototype.registerContactFixture=function(_){this._contactFixtures.push(_)},T.prototype.unregisterContactFixture=function(_){cc.js.array.remove(this._contactFixtures,_)},cc.PhysicsContactListener=S.exports=T},{}],193:[function(L,S){var T=L("../CCPhysicsTypes").PTM_RATIO,_=cc.v2(),w=cc.Color.GREEN,B=cc.Color.RED;function A(O){b2.Draw.call(this),this._drawer=O,this._xf=this._dxf=new b2.Transform}cc.js.extend(A,b2.Draw),cc.js.mixin(A.prototype,{_DrawPolygon:function(O,R){for(var P=this._drawer,E=0;E<R;E++){b2.Transform.MulXV(this._xf,O[E],_);var D=_.x*T,I=_.y*T;E===0?P.moveTo(D,I):P.lineTo(D,I)}P.close()},DrawPolygon:function(O,R,P){this._applyStrokeColor(P),this._DrawPolygon(O,R),this._drawer.stroke()},DrawSolidPolygon:function(O,R,P){this._applyFillColor(P),this._DrawPolygon(O,R),this._drawer.fill(),this._drawer.stroke()},_DrawCircle:function(O,R){var P=this._xf.p;this._drawer.circle((O.x+P.x)*T,(O.y+P.y)*T,R*T)},DrawCircle:function(O,R,P){this._applyStrokeColor(P),this._DrawCircle(O,R),this._drawer.stroke()},DrawSolidCircle:function(O,R,P,E){this._applyFillColor(E),this._DrawCircle(O,R),this._drawer.fill()},DrawSegment:function(O,R,P){var E=this._drawer;if(O.x===R.x&&O.y===R.y)return this._applyFillColor(P),this._DrawCircle(O,2/T),void E.fill();this._applyStrokeColor(P),b2.Transform.MulXV(this._xf,O,_),E.moveTo(_.x*T,_.y*T),b2.Transform.MulXV(this._xf,R,_),E.lineTo(_.x*T,_.y*T),E.stroke()},DrawTransform:function(O){var R=this._drawer;R.strokeColor=B,_.x=_.y=0,b2.Transform.MulXV(O,_,_),R.moveTo(_.x*T,_.y*T),_.x=1,_.y=0,b2.Transform.MulXV(O,_,_),R.lineTo(_.x*T,_.y*T),R.stroke(),R.strokeColor=w,_.x=_.y=0,b2.Transform.MulXV(O,_,_),R.moveTo(_.x*T,_.y*T),_.x=0,_.y=1,b2.Transform.MulXV(O,_,_),R.lineTo(_.x*T,_.y*T),R.stroke()},DrawPoint:function(){},_applyStrokeColor:function(O){var R=this._drawer.strokeColor;R.r=255*O.r,R.g=255*O.g,R.b=255*O.b,R.a=150,this._drawer.strokeColor=R},_applyFillColor:function(O){var R=this._drawer.fillColor;R.r=255*O.r,R.g=255*O.g,R.b=255*O.b,R.a=150,this._drawer.fillColor=R},PushTransform:function(O){this._xf=O},PopTransform:function(){this._xf=this._dxf}}),S.exports=A},{"../CCPhysicsTypes":172}],194:[function(L,S){function T(){this._type=0,this._fixtures=[],this._points=[],this._normals=[],this._fractions=[]}T.prototype.init=function(_){this._type=_,this._fixtures.length=0,this._points.length=0,this._normals.length=0,this._fractions.length=0},T.prototype.ReportFixture=function(_,w,B,A){return this._type===0?(this._fixtures[0]=_,this._points[0]=w,this._normals[0]=B,this._fractions[0]=A,A):(this._fixtures.push(_),this._points.push(cc.v2(w)),this._normals.push(cc.v2(B)),this._fractions.push(A),this._type===1?0:this._type>=2?1:A)},T.prototype.getFixtures=function(){return this._fixtures},T.prototype.getPoints=function(){return this._points},T.prototype.getNormals=function(){return this._normals},T.prototype.getFractions=function(){return this._fractions},cc.PhysicsRayCastCallback=S.exports=T},{}],195:[function(L,S){S.exports={getWorldRotation:function(T){for(var _=T.angle,w=T.parent;w.parent;)_+=w.angle,w=w.parent;return-_},getWorldScale:function(T){for(var _=T.scaleX,w=T.scaleY,B=T.parent;B.parent;)_*=B.scaleX,w*=B.scaleY,B=B.parent;return cc.v2(_,w)},convertToNodeRotation:function(T,_){_-=-T.angle;for(var w=T.parent;w.parent;)_-=-w.angle,w=w.parent;return _}}},{}],196:[function(L,S){var T=L("./js"),_=L("./CCEnum"),w=L("./utils"),B=(w.isPlainEmptyObj_DEV,w.cloneable_DEV,L("./attribute")),A=B.DELIMETER,O=L("./preprocess-class");L("./requiring-frame");var R=["name","extends","mixins","ctor","__ctor__","properties","statics","editor","__ES6__"];function P(ie,ne){ie.indexOf(ne)<0&&ie.push(ne)}var E={datas:null,push:function(ie){if(this.datas)this.datas.push(ie);else{this.datas=[ie];var ne=this;setTimeout(function(){ne.init()},0)}},init:function(){var ie=this.datas;if(ie){for(var ne=0;ne<ie.length;++ne){var he=ie[ne],pe=he.cls,K=he.props;typeof K=="function"&&(K=K());var ue=T.getClassName(pe);K?Q(pe,ue,K,pe.$super,he.mixins):cc.errorID(3633,ue)}this.datas=null}}};function D(ie,ne){P(ie.__props__,ne)}function I(ie,ne,he,pe){var K=pe.default;B.setClassAttr(ie,he,"default",K),D(ie,he),re(ie,pe,0,he)}function M(ie,ne,he,pe,K){var ue=pe.get,le=pe.set,ce=ie.prototype,_e=!Object.getOwnPropertyDescriptor(ce,he);ue&&(re(ie,pe,0,he),B.setClassAttr(ie,he,"serializable",!1),K||T.get(ce,he,ue,_e,_e)),le&&(K||T.set(ce,he,le,_e,_e))}function N(ie){return typeof ie=="function"?ie():ie}function k(ie,ne,he){for(var pe in ne)ie.hasOwnProperty(pe)||he&&!he(pe)||Object.defineProperty(ie,pe,T.getPropertyDescriptor(ne,pe))}function F(ie,ne,he,pe){var K,ue,le=pe.__ctor__,ce=pe.ctor,_e=pe.__ES6__;_e?(K=[ce],ue=ce):(K=le?[le]:z(ne,he,pe),ue=Y(K,ne,ie,pe),T.value(ue,"extend",function(ye){return ye.extends=this,ee(ye)},!0)),T.value(ue,"__ctors__",K.length>0?K:null,!0);var oe=ue.prototype;if(ne&&(_e||(T.extend(ue,ne),oe=ue.prototype),ue.$super=ne),he){for(var de=he.length-1;de>=0;de--){var me=he[de];k(oe,me.prototype),k(ue,me,function(ye){return me.hasOwnProperty(ye)&&!0}),ee._isCCClass(me)&&k(B.getClassAttrs(ue),B.getClassAttrs(me))}oe.constructor=ue}return _e||(oe.__initProps__=X),T.setClassName(ie,ue),ue}function G(ie,ne,he,pe){var K=cc.Component,ue=cc._RF.peek();if(ue&&T.isChildClassOf(ne,K)){if(T.isChildClassOf(ue.cls,K))return cc.errorID(3615),null;ie=ie||ue.script}var le=F(ie,ne,he,pe);if(ue)if(T.isChildClassOf(ne,K)){var ce=ue.uuid;ce&&T._setClassId(ce,le),ue.cls=le}else T.isChildClassOf(ue.cls,K)||(ue.cls=le);return le}function V(ie){for(var ne=T.getClassName(ie),he=ie.constructor,pe="new "+ne+"(",K=0;K<he.__props__.length;K++)pe+=ie[he.__props__[K]],K<he.__props__.length-1&&(pe+=",");return pe+")"}function j(ie){return JSON.stringify(ie).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function H(ie,ne){for(var he=[],pe="",K=0;K<ne.length;K++){var ue=ne[K],le=ue+A+"default";if(le in ie){var ce,_e;ce=U.test(ue)?"this."+ue+"=":"this["+j(ue)+"]=";var oe=ie[le];if(typeof oe=="object"&&oe)_e=oe instanceof cc.ValueType?V(oe):Array.isArray(oe)?"[]":"{}";else if(typeof oe=="function"){var de=he.length;he.push(oe),_e="F["+de+"]()"}else _e=typeof oe=="string"?j(oe):oe;pe+=ce=ce+_e+";\n"}}return he.length===0?Function(pe):Function("F","return (function(){\n"+pe+"})")(he)}var U=/^[A-Za-z_$][0-9A-Za-z_$]*$/;function X(ie){var ne=B.getClassAttrs(ie),he=ie.__props__;he===null&&(E.init(),he=ie.__props__);var pe=H(ne,he);ie.prototype.__initProps__=pe,pe.call(this)}var Y=function(ie,ne,he,pe){var K="return function CCClass(){\n";ne&&Z(ne,pe)&&(K+="this._super=null;\n"),K+="this.__initProps__(CCClass);\n";var ue=ie.length;if(ue>0){var le="].apply(this,arguments);\n";if(ue===1)K+="CCClass.__ctors__[0"+le;else{K+="var cs=CCClass.__ctors__;\n";for(var ce=0;ce<ue;ce++)K+="cs["+ce+le}}return K+="}",Function(K)()};function z(ie,ne,he){for(var pe,K=[],ue=[ie].concat(ne),le=0;le<ue.length;le++){var ce=ue[le];if(ce)for(var _e=(pe=ce,ee._isCCClass(pe)?pe.__ctors__||[]:[pe]),oe=0;oe<_e.length;oe++)P(K,_e[oe])}var de=he.ctor;return de&&K.push(de),K}var W=/xyz/.test(function(){xyz})?/\b\._super\b/:/.*/;function Z(ie,ne){var he=!1;for(var pe in ne)if(!(R.indexOf(pe)>=0)){var K=ne[pe];if(typeof K=="function"){var ue=T.getPropertyDescriptor(ie.prototype,pe);if(ue){var le=ue.value;if(typeof le=="function"){W.test(K)&&(he=!0,ne[pe]=function(ce,_e){return function(){var oe=this._super;this._super=ce;var de=_e.apply(this,arguments);return this._super=oe,de}}(le,K));continue}}}}return he}function Q(ie,ne,he,pe,K,ue){if(ie.__props__=[],pe&&pe.__props__&&(ie.__props__=pe.__props__.slice()),K)for(var le=0;le<K.length;++le){var ce=K[le];ce.__props__&&(ie.__props__=ie.__props__.concat(ce.__props__.filter(function(me){return ie.__props__.indexOf(me)<0})))}if(he)for(var _e in O.preprocessAttrs(he,ne,ie,ue),he){var oe=he[_e];"default"in oe?I(ie,0,_e,oe):M(ie,0,_e,oe,ue)}var de=B.getClassAttrs(ie);ie.__values__=ie.__props__.filter(function(me){return de[me+A+"serializable"]!==!1})}function ee(ie){var ne=(ie=ie||{}).name,he=ie.extends,pe=ie.mixins,K=G(ne,he,pe,ie);ne||(ne=cc.js.getClassName(K)),K._sealed=!0,he&&(he._sealed=!1);var ue=ie.properties;typeof ue=="function"||he&&he.__props__===null||pe&&pe.some(function(me){return me.__props__===null})?(E.push({cls:K,props:ue,mixins:pe}),K.__props__=K.__values__=null):Q(K,ne,ue,he,ie.mixins,ie.__ES6__);var le,ce=ie.statics;if(ce)for(le in ce)K[le]=ce[le];for(var _e in ie)if(!(R.indexOf(_e)>=0)){var oe=ie[_e];O.validateMethodWithProps(oe,_e,ne,K,he)&&T.value(K.prototype,_e,oe,!0,!0)}var de=ie.editor;return de&&cc.Component._registerEditorProps(K,de),K}ee._isCCClass=function(ie){return ie&&ie.hasOwnProperty("__ctors__")},ee._fastDefine=function(ie,ne,he){T.setClassName(ie,ne);for(var pe=ne.__props__=ne.__values__=Object.keys(he),K=B.getClassAttrs(ne),ue=0;ue<pe.length;ue++){var le=pe[ue];K[le+A+"visible"]=!1,K[le+A+"default"]=he[le]}},ee.Attr=B,ee.attr=B.attr,ee.getInheritanceChain=function(ie){for(var ne=[];ie=T.getSuper(ie);)ie!==Object&&ne.push(ie);return ne};var te={Integer:"Number",Float:"Number",Boolean:"Boolean",String:"String"};function re(ie,ne,he,pe){var K=null,ue="";function le(){return ue=pe+A,K=B.getClassAttrs(ie)}var ce=ne.type;ce&&(te[ce]?(K||le())[ue+"type"]=ce:ce==="Object"||(ce===B.ScriptUuid?((K||le())[ue+"type"]="Script",K[ue+"ctor"]=cc.ScriptAsset):typeof ce=="object"?_.isEnum(ce)&&((K||le())[ue+"type"]="Enum",K[ue+"enumList"]=_.getList(ce)):typeof ce=="function"&&((K||le())[ue+"type"]="Object",K[ue+"ctor"]=ce)));function _e(de,me){if(de in ne){var ye=ne[de];typeof ye===me&&((K||le())[ue+de]=ye)}}ne.editorOnly&&((K||le())[ue+"editorOnly"]=!0),ne.serializable===!1&&((K||le())[ue+"serializable"]=!1),_e("formerlySerializedAs","string");var oe=ne.range;oe&&Array.isArray(oe)&&oe.length>=2&&((K||le())[ue+"min"]=oe[0],K[ue+"max"]=oe[1],oe.length>2&&(K[ue+"step"]=oe[2])),_e("min","number"),_e("max","number"),_e("step","number"),_e("userData","object")}cc.Class=ee,S.exports={isArray:function(ie){return ie=N(ie),Array.isArray(ie)},fastDefine:ee._fastDefine,getNewValueTypeCode:V,IDENTIFIER_RE:U,escapeForJS:j,getDefault:N}},{"./CCEnum":198,"./attribute":208,"./js":217,"./preprocess-class":218,"./requiring-frame":219,"./utils":220}],197:[function(L,S){L("./CCClass");var T=L("./preprocess-class"),_=L("./js"),w="__ccclassCache__";function B(te){return te}function A(te,re){return te[re]||(te[re]={})}function O(te){return function(re){return typeof re=="function"?te(re):function(ie){return te(ie,re)}}}function R(te,re){return function(ie){return function(ne){return re(ne,ie)}}}var P=R.bind(null,!1);function E(){return R.bind(null,!1)}var D=E(),I=E();function M(te){return A(te,w)}function N(te){var re;try{re=te()}catch(ie){return te}return typeof re!="object"||re===null?re:te}function k(te){var re;try{re=new te}catch(ie){return{}}return re}function F(te,re,ie,ne,he,pe){var K,ue=he&&(he.get||he.set);ne&&(K=T.getFullFormOfProperty(ne,ue));var le=re[ie],ce=_.mixin(le||{},K||ne||{});if(ue)he.get&&(ce.get=he.get),he.set&&(ce.set=he.set);else{var _e=void 0;if(he)he.initializer&&(_e=N(he.initializer));else{var oe=pe.default||(pe.default=k(te));oe.hasOwnProperty(ie)&&(_e=oe[ie])}ce.default=_e}re[ie]=ce}var G=O(function(te,re){var ie=_.getSuper(te);ie===Object&&(ie=null);var ne={name:re,extends:ie,ctor:te,__ES6__:!0},he=te[w];if(he){var pe=he.proto;pe&&_.mixin(ne,pe),te[w]=void 0}return cc.Class(ne)});function V(te,re,ie){return te(function(ne,he){var pe=M(ne);if(pe){var K=he,ue=A(pe,"proto");A(ue,"editor")[re]=K}},re)}function j(te){return te(B)}var H=j(O),U=V(P,"requireComponent"),X=j(D),Y=V(I,"executionOrder"),z=j(O),W=j(O),Z=j(D),Q=j(D),ee=j(D);cc._decorator=S.exports={ccclass:G,property:function(te,re,ie){var ne=null;function he(pe,K,ue){var le=M(pe.constructor);if(le){var ce=A(le,"proto"),_e=A(ce,"properties");F(pe.constructor,_e,K,ne,ue,le)}}if(re===void 0)return ne=te,he;he(te,re,ie)},executeInEditMode:H,requireComponent:U,menu:X,executionOrder:Y,disallowMultiple:z,playOnFocus:W,inspector:Z,icon:Q,help:ee,mixins:function(){for(var te=[],re=0;re<arguments.length;re++)te[re]=arguments[re];return function(ie){var ne=M(ie);ne&&(A(ne,"proto").mixins=te)}}}},{"./CCClass":196,"./js":217,"./preprocess-class":218,"./utils":220}],198:[function(L,S){var T=L("./js");function _(w){if("__enums__"in w)return w;T.value(w,"__enums__",null,!0);for(var B=-1,A=Object.keys(w),O=0;O<A.length;O++){var R=A[O],P=w[R];if(P===-1)P=++B,w[R]=P;else if(typeof P=="number")B=P;else if(typeof P=="string"&&Number.isInteger(parseFloat(R)))continue;var E=""+P;R!==E&&T.value(w,E,R)}return w}_.isEnum=function(w){return w&&w.hasOwnProperty("__enums__")},_.getList=function(w){if(w.__enums__)return w.__enums__;var B=w.__enums__=[];for(var A in w){var O=w[A];Number.isInteger(O)&&B.push({name:A,value:O})}return B.sort(function(R,P){return R.value-P.value}),B},S.exports=cc.Enum=_},{"./js":217}],199:[function(L){var S,T=L("../event-manager"),_=L("./CCInputManager");cc.Acceleration=function(w,B,A,O){this.x=w||0,this.y=B||0,this.z=A||0,this.timestamp=O||0},_.setAccelerometerEnabled=function(w){var B=this;if(B._accelEnabled!==w){B._accelEnabled=w;var A=cc.director.getScheduler();A.enableForTarget(B),B._accelEnabled?(B._registerAccelerometerEvent(),B._accelCurTime=0,A.scheduleUpdate(B)):(B._unregisterAccelerometerEvent(),B._accelCurTime=0,A.unscheduleUpdate(B))}},_.setAccelerometerInterval=function(w){this._accelInterval!==w&&(this._accelInterval=w)},_._registerKeyboardEvent=function(){cc.game.canvas.addEventListener("keydown",function(w){T.dispatchEvent(new cc.Event.EventKeyboard(w.keyCode,!0)),w.stopPropagation(),w.preventDefault()},!1),cc.game.canvas.addEventListener("keyup",function(w){T.dispatchEvent(new cc.Event.EventKeyboard(w.keyCode,!1)),w.stopPropagation(),w.preventDefault()},!1)},_._registerAccelerometerEvent=function(){var w=window,B=this;B._acceleration=new cc.Acceleration,B._accelDeviceEvent=w.DeviceMotionEvent||w.DeviceOrientationEvent,cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(B._accelDeviceEvent=window.DeviceOrientationEvent);var A=B._accelDeviceEvent===w.DeviceMotionEvent?"devicemotion":"deviceorientation",O=navigator.userAgent;(/Android/.test(O)||/Adr/.test(O)&&cc.sys.browserType===cc.BROWSER_TYPE_UC)&&(B._minus=-1),S=B.didAccelerate.bind(B),w.addEventListener(A,S,!1)},_._unregisterAccelerometerEvent=function(){var w=window,B=this._accelDeviceEvent===w.DeviceMotionEvent?"devicemotion":"deviceorientation";S&&w.removeEventListener(B,S,!1)},_.didAccelerate=function(w){var B=this,A=window;if(B._accelEnabled){var O,R,P,E=B._acceleration;if(B._accelDeviceEvent===window.DeviceMotionEvent){var D=w.accelerationIncludingGravity;O=B._accelMinus*D.x*.1,R=B._accelMinus*D.y*.1,P=.1*D.z}else O=w.gamma/90*.981,R=-w.beta/90*.981,P=w.alpha/90*.981;if(cc.view._isRotated){var I=O;O=-R,R=I}E.x=O,E.y=R,E.z=P,E.timestamp=w.timeStamp||Date.now();var M=E.x;A.orientation===90?(E.x=-E.y,E.y=M):A.orientation===-90?(E.x=E.y,E.y=-M):A.orientation===180&&(E.x=-E.x,E.y=-E.y),cc.sys.os!==cc.sys.OS_ANDROID&&cc.sys.os!==cc.sys.OS_OPENHARMONY||cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ||(E.x=-E.x,E.y=-E.y)}}},{"../event-manager":141,"./CCInputManager":200}],200:[function(L,S){var T=L("./CCMacro"),_=L("./CCSys"),w=L("../event-manager"),B=cc.v2(),A={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.v2(0,0),_prevMousePoint:cc.v2(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_maxTouches:10,_touchesIntegerDict:{},_indexBitsUsed:0,_touchesCache:{},_touchCount:0,_accelEnabled:!1,_accelInterval:.2,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_canvasBoundingRect:{left:0,top:0,adjustedLeft:0,adjustedTop:0,width:0,height:0},_getUnUsedIndex:function(){for(var O=cc.sys.now(),R=T.TOUCH_TIMEOUT,P=this._indexBitsUsed,E=-1,D=this._touches,I=this._touchesIntegerDict,M=this._touchesCache,N=0;N<this._maxTouches;N++){if(1&P){var k=D[N];if(k&&O-k._lastModified>R){var F=k.getID();delete I[F],delete M[F],this._touchCount--,E===-1?(E=N,this._indexBitsUsed|=1<<N):this._indexBitsUsed&=~(1<<N)}}else E===-1&&(E=N,this._indexBitsUsed|=1<<N);P>>=1}return E},_glView:null,_updateCanvasBoundingRect:function(){var O=cc.game.canvas,R=this._canvasBoundingRect,P=document.documentElement,E=window.pageXOffset-P.clientLeft,D=window.pageYOffset-P.clientTop;if(O.getBoundingClientRect){var I=O.getBoundingClientRect();R.left=I.left+E,R.top=I.top+D,R.width=I.width,R.height=I.height}else O instanceof HTMLCanvasElement?(R.left=E,R.top=D,R.width=O.width,R.height=O.height):(R.left=E,R.top=D,R.width=parseInt(O.style.width),R.height=parseInt(O.style.height))},handleTouchesBegin:function(O){for(var R,P,E=_.now(),D=[],I=this._touches,M=this._touchesIntegerDict,N=this._touchesCache,k=0,F=O.length;k<F;k++)if(M[P=(R=O[k]).getID()]===void 0){var G=this._getUnUsedIndex();if(G===-1){cc.logID(2300,G);continue}var V=new cc.Touch(R._point.x,R._point.y,P);V._setPrevPoint(R._prevPoint),V._lastModified=E,I[G]=V,M[P]=G,N[P]=V,this._touchCount++,D.push(V)}if(D.length>0){this._glView._convertTouchesWithScale(D);var j=new cc.Event.EventTouch(D);j._eventCode=cc.Event.EventTouch.BEGAN,w.dispatchEvent(j)}},handleTouchesMove:function(O){for(var R,P,E=_.now(),D=[],I=this._touches,M=this._touchesIntegerDict,N=0,k=O.length;N<k;N++)if((P=M[(R=O[N]).getID()])!==void 0){var F=I[P];F&&(F._setPoint(R._point),F._setPrevPoint(R._prevPoint),F._lastModified=E,D.push(F))}if(D.length>0){this._glView._convertTouchesWithScale(D);var G=new cc.Event.EventTouch(D);G._eventCode=cc.Event.EventTouch.MOVED,w.dispatchEvent(G)}},handleTouchesEnd:function(O){var R=this.getSetOfTouchesEndOrCancel(O);if(R.length>0){this._glView._convertTouchesWithScale(R);var P=new cc.Event.EventTouch(R);P._eventCode=cc.Event.EventTouch.ENDED,w.dispatchEvent(P)}this._preTouchPool.length=0},handleTouchesCancel:function(O){var R=this.getSetOfTouchesEndOrCancel(O);if(R.length>0){this._glView._convertTouchesWithScale(R);var P=new cc.Event.EventTouch(R);P._eventCode=cc.Event.EventTouch.CANCELED,w.dispatchEvent(P)}this._preTouchPool.length=0},getSetOfTouchesEndOrCancel:function(O){for(var R,P,E,D=[],I=this._touches,M=this._touchesIntegerDict,N=this._touchesCache,k=0,F=O.length;k<F;k++)if((P=M[E=(R=O[k]).getID()])!==void 0){var G=I[P];G&&(G._setPoint(R._point),G._setPrevPoint(R._prevPoint),D.push(G),delete M[E],delete N[E],this._touchCount--,this._indexBitsUsed&=~(1<<P))}return D},getGlobalTouchCount:function(){return this._touchCount},getGlobalTouches:function(){return this._touchesCache},getPreTouch:function(O){for(var R=null,P=this._preTouchPool,E=O.getID(),D=P.length-1;D>=0;D--)if(P[D].getID()===E){R=P[D];break}return R||(R=O),R},setPreTouch:function(O){for(var R=!1,P=this._preTouchPool,E=O.getID(),D=P.length-1;D>=0;D--)if(P[D].getID()===E){P[D]=O,R=!0;break}R||(P.length<=50?P.push(O):(P[this._preTouchPoolPointer]=O,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(O,R,P){var E=this._preTouchPoint,D=this._glView.convertToLocationInView(O,R,P),I=new cc.Touch(D.x,D.y,0);return I._setPrevPoint(E.x,E.y),E.x=D.x,E.y=D.y,I},getMouseEvent:function(O,R,P){var E=this._prevMousePoint,D=new cc.Event.EventMouse(P);return D._setPrevCursor(E.x,E.y),E.x=O.x,E.y=O.y,this._glView._convertMouseToLocationInView(E,R),D.setLocation(E.x,E.y),D},getPointByEvent:function(O,R){return cc.sys.browserType!==cc.sys.BROWSER_TYPE_QQ&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_UC&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_SAFARI||this._updateCanvasBoundingRect(),O.pageX!=null?{x:O.pageX,y:O.pageY}:(R.left-=document.body.scrollLeft,R.top-=document.body.scrollTop,{x:O.clientX,y:O.clientY})},getTouchesByEvent:function(O,R){for(var P,E,D,I=[],M=this._glView,N=this._preTouchPoint,k=O.changedTouches.length,F=0;F<k;F++)if(P=O.changedTouches[F]){var G;G=_.BROWSER_TYPE_FIREFOX===_.browserType?M.convertToLocationInView(P.pageX,P.pageY,R,B):M.convertToLocationInView(P.clientX,P.clientY,R,B),P.identifier!=null?(E=new cc.Touch(G.x,G.y,P.identifier),D=this.getPreTouch(E).getLocation(),E._setPrevPoint(D.x,D.y),this.setPreTouch(E)):(E=new cc.Touch(G.x,G.y))._setPrevPoint(N.x,N.y),N.x=G.x,N.y=G.y,I.push(E)}return I},registerSystemEvent:function(O){if(!this._isRegisterEvent){this._glView=cc.view;var R=this,P=this._canvasBoundingRect;window.addEventListener("resize",this._updateCanvasBoundingRect.bind(this));var E=_.isMobile,D="mouse"in _.capabilities,I="touches"in _.capabilities;if(D&&function(){E||(window.addEventListener("mousedown",function(){R._mousePressed=!0},!1),window.addEventListener("mouseup",function(Y){if(R._mousePressed){R._mousePressed=!1;var z=R.getPointByEvent(Y,P);if(!cc.rect(P.left,P.top,P.width,P.height).contains(z)){R.handleTouchesEnd([R.getTouchByXY(z.x,z.y,P)]);var W=R.getMouseEvent(z,P,cc.Event.EventMouse.UP);W.setButton(Y.button),w.dispatchEvent(W)}}},!1));for(var j=cc.Event.EventMouse,H=[!E&&["mousedown",j.DOWN,function(Y,z,W,Z){R._mousePressed=!0,R.handleTouchesBegin([R.getTouchByXY(W.x,W.y,Z)]),O.focus()}],!E&&["mouseup",j.UP,function(Y,z,W,Z){R._mousePressed=!1,R.handleTouchesEnd([R.getTouchByXY(W.x,W.y,Z)])}],!E&&["mousemove",j.MOVE,function(Y,z,W,Z){R.handleTouchesMove([R.getTouchByXY(W.x,W.y,Z)]),R._mousePressed||z.setButton(null)}],["mousewheel",j.SCROLL,function(Y,z){z.setScrollData(0,Y.wheelDelta)}],["DOMMouseScroll",j.SCROLL,function(Y,z){z.setScrollData(0,-120*Y.detail)}]],U=0;U<H.length;++U){var X=H[U];X&&function(){var Y=X[0],z=X[1],W=X[2];O.addEventListener(Y,function(Z){var Q=R.getPointByEvent(Z,P),ee=R.getMouseEvent(Q,P,z),te=Z.button;z===j.MOVE&&(1&Z.buttons?te=j.BUTTON_LEFT:2&Z.buttons?te=j.BUTTON_RIGHT:4&Z.buttons&&(te=j.BUTTON_MIDDLE)),ee.setButton(te),W(Z,ee,Q,P),w.dispatchEvent(ee),Z.stopPropagation(),Z.preventDefault()},!1)}()}}(),window.navigator.msPointerEnabled){var M={MSPointerDown:R.handleTouchesBegin,MSPointerMove:R.handleTouchesMove,MSPointerUp:R.handleTouchesEnd,MSPointerCancel:R.handleTouchesCancel},N=function(j){var H=M[j];O.addEventListener(j,function(U){var X=document.documentElement;P.adjustedLeft=P.left-X.scrollLeft,P.adjustedTop=P.top-X.scrollTop,H.call(R,[R.getTouchByXY(U.clientX,U.clientY,P)]),U.stopPropagation()},!1)};for(var k in M)N(k)}if(I){var F={touchstart:function(j){R.handleTouchesBegin(j),O.focus()},touchmove:function(j){R.handleTouchesMove(j)},touchend:function(j){R.handleTouchesEnd(j)},touchcancel:function(j){R.handleTouchesCancel(j)}},G=function(j){var H=F[j];O.addEventListener(j,function(U){if(U.changedTouches){var X=document.body;P.adjustedLeft=P.left-(X.scrollLeft||window.scrollX||0),P.adjustedTop=P.top-(X.scrollTop||window.scrollY||0),H(R.getTouchesByEvent(U,P)),U.stopPropagation(),U.preventDefault()}},!1)};for(var V in F)G(V)}this._registerKeyboardEvent(),this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(O){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,w.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration))),this._accelCurTime+=O}};S.exports=cc.internal.inputManager=A},{"../event-manager":141,"./CCMacro":201,"./CCSys":205}],201:[function(L,S){cc.macro={RAD:Math.PI/180,DEG:180/Math.PI,REPEAT_FOREVER:Number.MAX_VALUE-1,FLT_EPSILON:1192092896e-16,MIN_ZINDEX:-Math.pow(2,15),MAX_ZINDEX:Math.pow(2,15)-1,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ORIENTATION_PORTRAIT:1,ORIENTATION_LANDSCAPE:2,ORIENTATION_AUTO:3,DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX:!0,DIRECTOR_STATS_POSITION:cc.v2(0,0),ENABLE_STACKABLE_ACTIONS:!0,TOUCH_TIMEOUT:5e3,BATCH_VERTEX_COUNT:2e4,ENABLE_TILEDMAP_CULLING:!0,ENABLE_TRANSPARENT_CANVAS:!1,ENABLE_WEBGL_ANTIALIAS:!1,ENABLE_CULLING:!1,CLEANUP_IMAGE_CACHE:!1,SHOW_MESH_WIREFRAME:!1,SHOW_MESH_NORMAL:!1,ENABLE_MULTI_TOUCH:!0,ALLOW_IMAGE_BITMAP:!cc.sys.isMobile,ENABLE_NATIVE_TTF_RENDERER:!0},Object.defineProperty(cc.macro,"ROTATE_ACTION_CCW",{set:function(T){cc.RotateTo&&cc.RotateBy&&(cc.RotateTo._reverse=cc.RotateBy._reverse=T)}}),cc.macro.SUPPORT_TEXTURE_FORMATS=[".astc",".pkm",".pvr",".webp",".jpg",".jpeg",".bmp",".png"],cc.macro.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.macro.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10}),cc.macro.BlendFactor=cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775}),cc.macro.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.macro.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),S.exports=cc.macro},{}],202:[function(L,S){var T=L("./js"),_=L("./CCClass"),w=1;function B(){this._name="",this._objFlags=0}_.fastDefine("cc.Object",B,{_name:"",_objFlags:0}),T.value(B,"Flags",{Destroyed:w,DontSave:8,EditorOnly:16,Dirty:32,DontDestroy:64,PersistentMask:-4192741,Destroying:128,Deactivating:256,LockedInEditor:512,HideInHierarchy:1024,IsPreloadStarted:8192,IsOnLoadStarted:32768,IsOnLoadCalled:16384,IsOnEnableCalled:2048,IsStartCalled:65536,IsEditorOnEnableCalled:4096,IsPositionLocked:1<<21,IsRotationLocked:1<<17,IsScaleLocked:1<<18,IsAnchorLocked:1<<19,IsSizeLocked:1<<20});var A=[];T.value(B,"_deferredDestroy",function(){for(var P=A.length,E=0;E<P;++E){var D=A[E];D._objFlags&w||D._destroyImmediate()}P===A.length?A.length=0:A.splice(0,P)});var O=B.prototype;function R(P,E){var D,I=P instanceof cc._BaseNode||P instanceof cc.Component,M=I?"_id":null,N={};for(D in P)if(P.hasOwnProperty(D)){if(D===M)continue;switch(typeof P[D]){case"string":N[D]="";break;case"object":case"function":N[D]=null}}if(cc.Class._isCCClass(E))for(var k=cc.Class.Attr.getClassAttrs(E),F=E.__props__,G=0;G<F.length;G++){var V=(D=F[G])+cc.Class.Attr.DELIMETER+"default";if(V in k){if(I&&D==="_id")continue;switch(typeof k[V]){case"string":N[D]="";break;case"object":case"function":N[D]=null;break;case"undefined":N[D]=void 0}}}var j="";for(D in N){var H;H=_.IDENTIFIER_RE.test(D)?"o."+D+"=":"o["+_.escapeForJS(D)+"]=";var U=N[D];U===""&&(U='""'),j+=H+U+";\n"}return Function("o",j)}T.getset(O,"name",function(){return this._name},function(P){this._name=P},!0),T.get(O,"isValid",function(){return!(this._objFlags&w)},!0),O.destroy=function(){return this._objFlags&w?(cc.warnID(5e3),!1):!(4&this._objFlags||(this._objFlags|=4,A.push(this),0))},O._destruct=function(){var P=this.constructor,E=P.__destruct__;E||(E=R(this,P),T.value(P,"__destruct__",E,!0)),E(this)},O._onPreDestroy=null,O._destroyImmediate=function(){this._objFlags&w?cc.errorID(5e3):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),this._objFlags|=w)},O._deserialize=null,cc.isValid=function(P,E){return typeof P=="object"?!(!P||P._objFlags&(E?4|w:w)):P!==void 0},cc.Object=S.exports=B},{"./CCClass":196,"./js":217}],203:[function(L,S){var T=L("../platform/js");cc.SAXParser=function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):(this._isSupportDOMParser=!1,this._parser=null)},cc.SAXParser.prototype={constructor:cc.SAXParser,parse:function(_){return this._parseXML(_)},_parseXML:function(_){var w;return this._isSupportDOMParser?w=this._parser.parseFromString(_,"text/xml"):((w=new ActiveXObject("Microsoft.XMLDOM")).async="false",w.loadXML(_)),w}},cc.PlistParser=function(){cc.SAXParser.call(this)},T.extend(cc.PlistParser,cc.SAXParser),T.mixin(cc.PlistParser.prototype,{parse:function(_){var w=this._parseXML(_),B=w.documentElement;if(B.tagName!=="plist")return cc.warnID(5100),{};for(var A=null,O=0,R=B.childNodes.length;O<R&&(A=B.childNodes[O]).nodeType!==1;O++);return w=null,this._parseNode(A)},_parseNode:function(_){var w=null,B=_.tagName;if(B==="dict")w=this._parseDict(_);else if(B==="array")w=this._parseArray(_);else if(B==="string")if(_.childNodes.length===1)w=_.firstChild.nodeValue;else{w="";for(var A=0;A<_.childNodes.length;A++)w+=_.childNodes[A].nodeValue}else B==="false"?w=!1:B==="true"?w=!0:B==="real"?w=parseFloat(_.firstChild.nodeValue):B==="integer"&&(w=parseInt(_.firstChild.nodeValue,10));return w},_parseArray:function(_){for(var w=[],B=0,A=_.childNodes.length;B<A;B++){var O=_.childNodes[B];O.nodeType===1&&w.push(this._parseNode(O))}return w},_parseDict:function(_){for(var w={},B=null,A=0,O=_.childNodes.length;A<O;A++){var R=_.childNodes[A];R.nodeType===1&&(R.tagName==="key"?B=R.firstChild.nodeValue:w[B]=this._parseNode(R))}return w}}),cc.saxParser=new cc.SAXParser,cc.plistParser=new cc.PlistParser,S.exports={saxParser:cc.saxParser,plistParser:cc.plistParser}},{"../platform/js":217}],204:[function(){cc.screen={_supportsFullScreen:!1,_onfullscreenchange:null,_onfullscreenerror:null,_preOnFullScreenChange:null,_preOnFullScreenError:null,_preOnTouch:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement","fullscreenerror"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement","fullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement","msfullscreenerror"]],init:function(){this._fn={};var L,S,T,_,w=this._fnMap;for(L=0,S=w.length;L<S;L++)if((T=w[L])&&document[T[1]]!==void 0){for(L=0,_=T.length;L<_;L++)this._fn[w[0][L]]=T[L];break}this._supportsFullScreen=this._fn.requestFullscreen!==void 0,this._touchEvent="ontouchend"in window?"touchend":"mousedown"},fullScreen:function(){return!!this._supportsFullScreen&&!!(document[this._fn.fullscreenElement]||document[this._fn.webkitFullscreenElement]||document[this._fn.mozFullScreenElement])},requestFullScreen:function(L,S,T){if(L&&L.tagName.toLowerCase()==="video"){if(cc.sys.os===cc.sys.OS_IOS&&cc.sys.isBrowser&&L.readyState>0)return void(L.webkitEnterFullscreen&&L.webkitEnterFullscreen());L.setAttribute("x5-video-player-fullscreen","true")}if(this._supportsFullScreen){if(L=L||document.documentElement,S){var _=this._fn.fullscreenchange;this._onfullscreenchange&&document.removeEventListener(_,this._onfullscreenchange),this._onfullscreenchange=S,document.addEventListener(_,S,!1)}if(T){var w=this._fn.fullscreenerror;this._onfullscreenerror&&document.removeEventListener(w,this._onfullscreenerror),this._onfullscreenerror=T,document.addEventListener(w,T,{once:!0})}var B=L[this._fn.requestFullscreen]();document[this._fn.fullscreenerror]===void 0&&window.Promise&&B instanceof Promise&&B.catch(function(){})}},exitFullScreen:function(L){if(L&&L.tagName.toLowerCase()==="video"){if(cc.sys.os===cc.sys.OS_IOS&&cc.sys.isBrowser)return void(L.webkitExitFullscreen&&L.webkitExitFullscreen());L.setAttribute("x5-video-player-fullscreen","false")}return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(L,S){L=L||document.body,this._ensureFullScreen(L,S),this.requestFullScreen(L,S)},disableAutoFullScreen:function(L){var S=cc.game.canvas||L,T=this._touchEvent;this._preOnTouch&&(S.removeEventListener(T,this._preOnTouch),this._preOnTouch=null)},_ensureFullScreen:function(L,S){var T=this,_=cc.game.canvas||L,w=this._fn.fullscreenerror,B=this._touchEvent;function A(){T._preOnFullScreenError=null,T._preOnTouch&&_.removeEventListener(B,T._preOnTouch),T._preOnTouch=function(){T._preOnTouch=null,T.requestFullScreen(L,S)},_.addEventListener(B,T._preOnTouch,{once:!0})}this._preOnFullScreenError&&L.removeEventListener(w,this._preOnFullScreenError),this._preOnFullScreenError=A,L.addEventListener(w,A,{once:!0})}},cc.screen.init()},{}],205:[function(L,S){window._CCSettings&&_CCSettings.platform;var T=typeof window>"u"?global:window,_=cc&&cc.sys?cc.sys:function(){cc.sys={};var w,B,A=cc.sys;if(A.LANGUAGE_ENGLISH="en",A.LANGUAGE_CHINESE="zh",A.LANGUAGE_FRENCH="fr",A.LANGUAGE_ITALIAN="it",A.LANGUAGE_GERMAN="de",A.LANGUAGE_SPANISH="es",A.LANGUAGE_DUTCH="du",A.LANGUAGE_RUSSIAN="ru",A.LANGUAGE_KOREAN="ko",A.LANGUAGE_JAPANESE="ja",A.LANGUAGE_HUNGARIAN="hu",A.LANGUAGE_PORTUGUESE="pt",A.LANGUAGE_ARABIC="ar",A.LANGUAGE_NORWEGIAN="no",A.LANGUAGE_POLISH="pl",A.LANGUAGE_TURKISH="tr",A.LANGUAGE_UKRAINIAN="uk",A.LANGUAGE_ROMANIAN="ro",A.LANGUAGE_BULGARIAN="bg",A.LANGUAGE_UNKNOWN="unknown",A.OS_OPENHARMONY="OpenHarmony",A.OS_IOS="iOS",A.OS_ANDROID="Android",A.OS_WINDOWS="Windows",A.OS_MARMALADE="Marmalade",A.OS_LINUX="Linux",A.OS_BADA="Bada",A.OS_BLACKBERRY="Blackberry",A.OS_OSX="OS X",A.OS_WP8="WP8",A.OS_WINRT="WINRT",A.OS_UNKNOWN="Unknown",A.UNKNOWN=-1,A.WIN32=0,A.LINUX=1,A.MACOS=2,A.ANDROID=3,A.IPHONE=4,A.IPAD=5,A.BLACKBERRY=6,A.NACL=7,A.EMSCRIPTEN=8,A.TIZEN=9,A.WINRT=10,A.WP8=11,A.OPENHARMONY=12,A.MOBILE_BROWSER=100,A.DESKTOP_BROWSER=101,A.EDITOR_PAGE=102,A.EDITOR_CORE=103,A.WECHAT_GAME=104,A.QQ_PLAY=105,A.FB_PLAYABLE_ADS=106,A.BAIDU_GAME=107,A.VIVO_GAME=108,A.OPPO_GAME=109,A.HUAWEI_GAME=110,A.XIAOMI_GAME=111,A.JKW_GAME=112,A.ALIPAY_GAME=113,A.WECHAT_GAME_SUB=114,A.BAIDU_GAME_SUB=115,A.QTT_GAME=116,A.BYTEDANCE_GAME=117,A.BYTEDANCE_GAME_SUB=118,A.LINKSURE=119,A.TAOBAO=120,A.TAOBAO_MINIGAME=121,A.BROWSER_TYPE_WECHAT="wechat",A.BROWSER_TYPE_ANDROID="androidbrowser",A.BROWSER_TYPE_IE="ie",A.BROWSER_TYPE_EDGE="edge",A.BROWSER_TYPE_QQ="qqbrowser",A.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",A.BROWSER_TYPE_UC="ucbrowser",A.BROWSER_TYPE_UCBS="ucbs",A.BROWSER_TYPE_360="360browser",A.BROWSER_TYPE_BAIDU_APP="baiduboxapp",A.BROWSER_TYPE_BAIDU="baidubrowser",A.BROWSER_TYPE_MAXTHON="maxthon",A.BROWSER_TYPE_OPERA="opera",A.BROWSER_TYPE_OUPENG="oupeng",A.BROWSER_TYPE_MIUI="miuibrowser",A.BROWSER_TYPE_FIREFOX="firefox",A.BROWSER_TYPE_SAFARI="safari",A.BROWSER_TYPE_CHROME="chrome",A.BROWSER_TYPE_LIEBAO="liebao",A.BROWSER_TYPE_QZONE="qzone",A.BROWSER_TYPE_SOUGOU="sogou",A.BROWSER_TYPE_HUAWEI="huawei",A.BROWSER_TYPE_UNKNOWN="unknown",A.isNative=!1,A.isBrowser=typeof window=="object"&&typeof document=="object"&&!0,A.glExtension=function(ie){return!!cc.renderer.device.ext(ie)},A.getMaxJointMatrixSize=function(){if(!A._maxJointMatrixSize){var ie=cc.game._renderContext,ne=Math.floor(ie.getParameter(ie.MAX_VERTEX_UNIFORM_VECTORS)/4)-10;A._maxJointMatrixSize=ne<50?0:50}return A._maxJointMatrixSize},A.getSafeAreaRect=function(){var ie=cc.view.getVisibleSize();return cc.rect(0,0,ie.width,ie.height)},T.__globalAdapter&&T.__globalAdapter.adaptSys)T.__globalAdapter.adaptSys(A);else{var O=window,R=O.navigator,P=document,E=P.documentElement,D=R.userAgent.toLowerCase();A.isMobile=/mobile|android|iphone|ipad/.test(D),typeof FbPlayableAd<"u"?A.platform=A.FB_PLAYABLE_ADS:A.platform=A.isMobile?A.MOBILE_BROWSER:A.DESKTOP_BROWSER;var I=R.language;I=I||R.browserLanguage,A.languageCode=I.toLowerCase(),I=I?I.split("-")[0]:A.LANGUAGE_ENGLISH,A.language=I;var M=!1,N=!1,k="",F=0,G=/android\s*(\d+(?:\.\d+)*)/i.exec(D)||/android\s*(\d+(?:\.\d+)*)/i.exec(R.platform);G&&(M=!0,k=G[1]||"",F=parseInt(k)||0),(G=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(D))?(N=!0,k=G[2]||"",F=parseInt(k)||0):(/(iPhone|iPad|iPod)/.exec(R.platform)||R.platform==="MacIntel"&&R.maxTouchPoints&&R.maxTouchPoints>1)&&(N=!0,k="",F=0);var V=A.OS_UNKNOWN;R.appVersion.indexOf("Win")!==-1?V=A.OS_WINDOWS:N?V=A.OS_IOS:R.appVersion.indexOf("Mac")!==-1?V=A.OS_OSX:R.appVersion.indexOf("X11")!==-1&&R.appVersion.indexOf("Linux")===-1?V=A.OS_UNIX:M?V=A.OS_ANDROID:R.appVersion.indexOf("Linux")===-1&&D.indexOf("ubuntu")===-1||(V=A.OS_LINUX),A.os=V,A.osVersion=k,A.osMainVersion=F,A.browserType=A.BROWSER_TYPE_UNKNOWN,function(){var ie=/mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|ucbs|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i.exec(D)||/qq|ucbrowser|ubrowser|edge|HuaweiBrowser/i.exec(D)||/chrome|safari|firefox|trident|opera|opr\/|oupeng/i.exec(D),ne=ie?ie[0].toLowerCase():A.BROWSER_TYPE_UNKNOWN;(ne==="safari"&&M||ne==="qq"&&D.match(/android.*applewebkit/i))&&(ne=A.BROWSER_TYPE_ANDROID);var he={micromessenger:A.BROWSER_TYPE_WECHAT,trident:A.BROWSER_TYPE_IE,edge:A.BROWSER_TYPE_EDGE,"360 aphone":A.BROWSER_TYPE_360,mxbrowser:A.BROWSER_TYPE_MAXTHON,"opr/":A.BROWSER_TYPE_OPERA,ubrowser:A.BROWSER_TYPE_UC,huaweibrowser:A.BROWSER_TYPE_HUAWEI};ne!=="qqbrowser"&&ne!=="mqqbrowser"||D.match(/wechat|micromessenger/i)&&(ne=A.BROWSER_TYPE_WECHAT),A.browserType=he[ne]||ne}(),A.browserVersion="",(B=D.match(/(mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|uc|ucbs|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui(?:.hybrid)?)(mobile)?(browser)?\/?([\d.]+)/i))||(B=D.match(/(qq|chrome|safari|firefox|trident|opera|opr\/|oupeng)(mobile)?(browser)?\/?([\d.]+)/i)),A.browserVersion=B?B[4]:"";var j=window.innerWidth||document.documentElement.clientWidth,H=window.innerHeight||document.documentElement.clientHeight,U=window.devicePixelRatio||1;A.windowPixelResolution={width:U*j,height:U*H},A._checkWebGLRenderMode=function(){if(cc.game.renderType!==cc.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")};var X=document.createElement("canvas");try{var Y=A.localStorage=O.localStorage;Y.setItem("storage",""),Y.removeItem("storage"),Y=null}catch(ie){var z=function(){cc.warnID(5200)};A.localStorage={getItem:z,setItem:z,removeItem:z,clear:z}}var W=X.toDataURL("image/webp").startsWith("data:image/webp"),Z=!!X.getContext("2d"),Q=!1;O.WebGLRenderingContext&&(Q=!0);var ee,te=A.capabilities={canvas:Z,opengl:Q,webp:W,imageBitmap:!1};typeof createImageBitmap<"u"&&typeof Blob<"u"&&(X.width=X.height=2,createImageBitmap(X,{}).then(function(ie){te.imageBitmap=!0,ie.close&&ie.close()}).catch(function(){})),(E.ontouchstart!==void 0||P.ontouchstart!==void 0||R.msPointerEnabled||typeof __wxjs_environment=="string"&&__wxjs_environment==="miniprogram")&&(te.touches=!0),E.onmouseup!==void 0&&(te.mouse=!0),E.onkeyup!==void 0&&(te.keyboard=!0),(O.DeviceMotionEvent||O.DeviceOrientationEvent)&&(te.accelerometer=!0),function(){A.browserVersion;var ie=!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);ee={ONLY_ONE:!1,WEB_AUDIO:ie,DELAY_CREATE_CTX:!1},A.os===A.OS_IOS&&(ee.USE_LOADER_EVENT="loadedmetadata"),A.browserType===A.BROWSER_TYPE_FIREFOX&&(ee.DELAY_CREATE_CTX=!0,ee.USE_LOADER_EVENT="canplay"),A.os===A.OS_ANDROID&&A.browserType===A.BROWSER_TYPE_UC&&(ee.ONE_SOURCE=!0)}();try{ee.WEB_AUDIO&&(ee.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),ee.DELAY_CREATE_CTX&&setTimeout(function(){ee.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)},0))}catch(ie){ee.WEB_AUDIO=!1,cc.logID(5201)}var re=[];(w=document.createElement("audio")).canPlayType&&(w.canPlayType('audio/ogg; codecs="vorbis"')&&re.push(".ogg"),w.canPlayType("audio/mpeg")&&re.push(".mp3"),w.canPlayType('audio/wav; codecs="1"')&&re.push(".wav"),w.canPlayType("audio/mp4")&&re.push(".mp4"),w.canPlayType("audio/x-m4a")&&re.push(".m4a")),ee.format=re,A.__audioSupport=ee}return A.NetworkType={NONE:0,LAN:1,WWAN:2},A.getNetworkType=function(){return A.NetworkType.LAN},A.getBatteryLevel=function(){return 1},A.garbageCollect=function(){},A.restartVM=function(){},A.isObjectValid=function(ie){return!!ie},A.dump=function(){var ie="";ie+="isMobile : "+this.isMobile+"\r\n",ie+="language : "+this.language+"\r\n",ie+="browserType : "+this.browserType+"\r\n",ie+="browserVersion : "+this.browserVersion+"\r\n",ie+="capabilities : "+JSON.stringify(this.capabilities)+"\r\n",ie+="os : "+this.os+"\r\n",ie+="osVersion : "+this.osVersion+"\r\n",ie+="platform : "+this.platform+"\r\n",ie+="Using "+(cc.game.renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(ie)},A.openURL=function(ie){window.open(ie)},A.now=function(){return Date.now?Date.now():+new Date},A}();S.exports=_},{}],206:[function(L,S){var T=L("../event/event-target"),_=L("../platform/js"),w=L("../renderer");L("../platform/CCClass");var B={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(R){return R&&R!==this.html?R.clientWidth:window.innerWidth},availHeight:function(R){return R&&R!==this.html?R.clientHeight:window.innerHeight},meta:{width:"device-width"},adaptationType:cc.sys.browserType};switch(cc.sys.os===cc.sys.OS_IOS&&(B.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),B.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:B.meta["minimal-ui"]="true",B.availWidth=function(R){return R.clientWidth},B.availHeight=function(R){return R.clientHeight}}var A=null,O=function(){T.call(this);var R=this,P=cc.ContainerStrategy,E=cc.ContentStrategy;B.init(this),R._frameSize=cc.size(0,0),R._designResolutionSize=cc.size(0,0),R._originalDesignResolutionSize=cc.size(0,0),R._scaleX=1,R._scaleY=1,R._viewportRect=cc.rect(0,0,0,0),R._visibleRect=cc.rect(0,0,0,0),R._autoFullScreen=!1,R._devicePixelRatio=1,R._maxPixelRatio=2,R._retinaEnabled=!1,R._resizeCallback=null,R._resizing=!1,R._resizeWithBrowserSize=!1,R._orientationChanging=!0,R._isRotated=!1,R._orientation=cc.macro.ORIENTATION_AUTO,R._isAdjustViewport=!0,R._antiAliasEnabled=!1,R._resolutionPolicy=null,R._rpExactFit=new cc.ResolutionPolicy(P.EQUAL_TO_FRAME,E.EXACT_FIT),R._rpShowAll=new cc.ResolutionPolicy(P.EQUAL_TO_FRAME,E.SHOW_ALL),R._rpNoBorder=new cc.ResolutionPolicy(P.EQUAL_TO_FRAME,E.NO_BORDER),R._rpFixedHeight=new cc.ResolutionPolicy(P.EQUAL_TO_FRAME,E.FIXED_HEIGHT),R._rpFixedWidth=new cc.ResolutionPolicy(P.EQUAL_TO_FRAME,E.FIXED_WIDTH),cc.game.once(cc.game.EVENT_ENGINE_INITED,this.init,this)};cc.js.extend(O,T),cc.js.mixin(O.prototype,{init:function(){this._initFrameSize();var R=cc.game.canvas.width,P=cc.game.canvas.height;this._designResolutionSize.width=R,this._designResolutionSize.height=P,this._originalDesignResolutionSize.width=R,this._originalDesignResolutionSize.height=P,this._viewportRect.width=R,this._viewportRect.height=P,this._visibleRect.width=R,this._visibleRect.height=P,cc.winSize.width=this._visibleRect.width,cc.winSize.height=this._visibleRect.height,cc.visibleRect&&cc.visibleRect.init(this._visibleRect)},_resizeEvent:function(R){var P;P=this.setDesignResolutionSize?this:cc.view;var E=cc.sys;if(E.browserType!==E.BROWSER_TYPE_UC||E.os!==E.OS_IOS){var D=P._frameSize.width,I=P._frameSize.height,M=P._isRotated;if(cc.sys.isMobile){var N=cc.game.container.style,k=N.margin;N.margin="0",N.display="none",P._initFrameSize(),N.margin=k,N.display="block"}else P._initFrameSize();if(R===!0||P._isRotated!==M||P._frameSize.width!==D||P._frameSize.height!==I){var F=P._originalDesignResolutionSize.width,G=P._originalDesignResolutionSize.height;P._resizing=!0,F>0&&P.setDesignResolutionSize(F,G,P._resolutionPolicy),P._resizing=!1,P.emit("canvas-resize"),P._resizeCallback&&P._resizeCallback.call()}}else setTimeout(function(){P._resizeEvent(R)},0)},_orientationChange:function(){cc.view._orientationChanging=!0,cc.view._resizeEvent(),cc.sys.browserType===cc.sys.BROWSER_TYPE_SAFARI&&cc.sys.isMobile&&setTimeout(function(){window.innerHeight>window.innerWidth&&window.scrollTo(0,1)},500)},_resize:function(){cc.view._resizeEvent(!1)},resizeWithBrowserSize:function(R){R?this._resizeWithBrowserSize||(this._resizeWithBrowserSize=!0,window.addEventListener("resize",this._resize),window.addEventListener("orientationchange",this._orientationChange)):this._resizeWithBrowserSize&&(this._resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resize),window.removeEventListener("orientationchange",this._orientationChange))},setResizeCallback:function(R){typeof R!="function"&&R!=null||(this._resizeCallback=R)},setOrientation:function(R){if((R&=cc.macro.ORIENTATION_AUTO)&&this._orientation!==R){this._orientation=R;var P=this._originalDesignResolutionSize.width,E=this._originalDesignResolutionSize.height;this.setDesignResolutionSize(P,E,this._resolutionPolicy)}},_initFrameSize:function(){var R=this._frameSize,P=B.availWidth(cc.game.frame),E=B.availHeight(cc.game.frame),D=P>=E;!cc.sys.isMobile||D&&this._orientation&cc.macro.ORIENTATION_LANDSCAPE||!D&&this._orientation&cc.macro.ORIENTATION_PORTRAIT?(R.width=P,R.height=E,cc.game.container.style["-webkit-transform"]="rotate(0deg)",cc.game.container.style.transform="rotate(0deg)",this._isRotated=!1):(R.width=E,R.height=P,cc.game.container.style["-webkit-transform"]="rotate(90deg)",cc.game.container.style.transform="rotate(90deg)",cc.game.container.style["-webkit-transform-origin"]="0px 0px 0px",cc.game.container.style.transformOrigin="0px 0px 0px",this._isRotated=!0),this._orientationChanging&&setTimeout(function(){cc.view._orientationChanging=!1},1e3)},_setViewportMeta:function(R,P){var E=document.getElementById("cocosMetaElement");E&&P&&document.head.removeChild(E);var D,I,M,N=document.getElementsByName("viewport"),k=N?N[0]:null;for(I in D=k?k.content:"",(E=E||document.createElement("meta")).id="cocosMetaElement",E.name="viewport",E.content="",R)D.indexOf(I)==-1?D+=","+I+"="+R[I]:P&&(M=new RegExp(I+"s*=s*[^,]+"),D=D.replace(M,I+"="+R[I]));/^,/.test(D)&&(D=D.substr(1)),E.content=D,k&&(k.content=D),document.head.appendChild(E)},_adjustViewportMeta:function(){this._isAdjustViewport&&(this._setViewportMeta(B.meta,!1),this._isAdjustViewport=!1)},adjustViewportMeta:function(R){this._isAdjustViewport=R},enableRetina:function(R){this._retinaEnabled=!!R},isRetinaEnabled:function(){return this._retinaEnabled},enableAntiAlias:function(R){if(cc.warnID(9200),this._antiAliasEnabled!==R){if(this._antiAliasEnabled=R,cc.game.renderType===cc.game.RENDER_TYPE_WEBGL)cc.assetManager.assets.forEach(function(E){if(E instanceof cc.Texture2D){var D=cc.Texture2D.Filter;R?E.setFilters(D.LINEAR,D.LINEAR):E.setFilters(D.NEAREST,D.NEAREST)}});else if(cc.game.renderType===cc.game.RENDER_TYPE_CANVAS){var P=cc.game.canvas.getContext("2d");P.imageSmoothingEnabled=R,P.mozImageSmoothingEnabled=R}}},isAntiAliasEnabled:function(){return this._antiAliasEnabled},enableAutoFullScreen:function(R){R&&R!==this._autoFullScreen&&cc.sys.isMobile?(this._autoFullScreen=!0,cc.screen.autoFullScreen(cc.game.frame)):(this._autoFullScreen=!1,cc.screen.disableAutoFullScreen(cc.game.frame))},isAutoFullScreenEnabled:function(){return this._autoFullScreen},setCanvasSize:function(R,P){var E=cc.game.canvas,D=cc.game.container;E.width=R*this._devicePixelRatio,E.height=P*this._devicePixelRatio,E.style.width=R+"px",E.style.height=P+"px",D.style.width=R+"px",D.style.height=P+"px",this._resizeEvent()},getCanvasSize:function(){return cc.size(cc.game.canvas.width,cc.game.canvas.height)},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(R,P){this._frameSize.width=R,this._frameSize.height=P,cc.game.frame.style.width=R+"px",cc.game.frame.style.height=P+"px",this._resizeEvent(!0)},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return cc.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return cc.v2(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return cc.v2(this._visibleRect.x*this._scaleX,this._visibleRect.y*this._scaleY)},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(R){var P=this;if(R instanceof cc.ResolutionPolicy)P._resolutionPolicy=R;else{var E=cc.ResolutionPolicy;R===E.EXACT_FIT&&(P._resolutionPolicy=P._rpExactFit),R===E.SHOW_ALL&&(P._resolutionPolicy=P._rpShowAll),R===E.NO_BORDER&&(P._resolutionPolicy=P._rpNoBorder),R===E.FIXED_HEIGHT&&(P._resolutionPolicy=P._rpFixedHeight),R===E.FIXED_WIDTH&&(P._resolutionPolicy=P._rpFixedWidth)}},setDesignResolutionSize:function(R,P,E){if(R>0&&P>0){this.setResolutionPolicy(E);var D=this._resolutionPolicy;if(D&&D.preApply(this),cc.sys.isMobile&&this._adjustViewportMeta(),this._orientationChanging=!0,this._resizing||this._initFrameSize(),D){this._originalDesignResolutionSize.width=this._designResolutionSize.width=R,this._originalDesignResolutionSize.height=this._designResolutionSize.height=P;var I=D.apply(this,this._designResolutionSize);if(I.scale&&I.scale.length===2&&(this._scaleX=I.scale[0],this._scaleY=I.scale[1]),I.viewport){var M=this._viewportRect,N=this._visibleRect,k=I.viewport;M.x=k.x,M.y=k.y,M.width=k.width,M.height=k.height,N.x=0,N.y=0,N.width=k.width/this._scaleX,N.height=k.height/this._scaleY}D.postApply(this),cc.winSize.width=this._visibleRect.width,cc.winSize.height=this._visibleRect.height,cc.visibleRect&&cc.visibleRect.init(this._visibleRect),w.updateCameraViewport(),cc.internal.inputManager._updateCanvasBoundingRect(),this.emit("design-resolution-changed")}else cc.logID(2201)}else cc.errorID(2200)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(R,P,E){this._setViewportMeta({width:R},!0),document.documentElement.style.width=R+"px",document.body.style.width=R+"px",document.body.style.left="0px",document.body.style.top="0px",this.setDesignResolutionSize(R,P,E)},setViewportInPoints:function(R,P,E,D){var I=this._scaleX,M=this._scaleY;cc.game._renderContext.viewport(R*I+this._viewportRect.x,P*M+this._viewportRect.y,E*I,D*M)},setScissorInPoints:function(R,P,E,D){var I=this._scaleX,M=this._scaleY,N=Math.ceil(R*I+this._viewportRect.x),k=Math.ceil(P*M+this._viewportRect.y),F=Math.ceil(E*I),G=Math.ceil(D*M),V=cc.game._renderContext;if(!A){var j=V.getParameter(V.SCISSOR_BOX);A=cc.rect(j[0],j[1],j[2],j[3])}A.x===N&&A.y===k&&A.width===F&&A.height===G||(A.x=N,A.y=k,A.width=F,A.height=G,V.scissor(N,k,F,G))},isScissorEnabled:function(){return cc.game._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){if(!A){var R=gl.getParameter(gl.SCISSOR_BOX);A=cc.rect(R[0],R[1],R[2],R[3])}var P=1/this._scaleX,E=1/this._scaleY;return cc.rect((A.x-this._viewportRect.x)*P,(A.y-this._viewportRect.y)*E,A.width*P,A.height*E)},getViewportRect:function(){return this._viewportRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(R,P,E,D){var I=D||cc.v2(),M=E.adjustedLeft?E.adjustedLeft:E.left,N=E.adjustedTop?E.adjustedTop:E.top,k=this._devicePixelRatio*(R-M),F=this._devicePixelRatio*(N+E.height-P);return this._isRotated?(I.x=cc.game.canvas.width-F,I.y=k):(I.x=k,I.y=F),I},_convertMouseToLocationInView:function(R,P){var E=this._viewportRect;R.x=(this._devicePixelRatio*(R.x-P.left)-E.x)/this._scaleX,R.y=(this._devicePixelRatio*(P.top+P.height-R.y)-E.y)/this._scaleY},_convertPointWithScale:function(R){var P=this._viewportRect;R.x=(R.x-P.x)/this._scaleX,R.y=(R.y-P.y)/this._scaleY},_convertTouchesWithScale:function(R){for(var P,E,D,I=this._viewportRect,M=this._scaleX,N=this._scaleY,k=0;k<R.length;k++)E=(P=R[k])._point,D=P._prevPoint,E.x=(E.x-I.x)/M,E.y=(E.y-I.y)/N,D.x=(D.x-I.x)/M,D.y=(D.y-I.y)/N}}),cc.ContainerStrategy=cc.Class({name:"ContainerStrategy",preApply:function(){},apply:function(){},postApply:function(){},_setupContainer:function(R,P,E){var D=cc.game.canvas;this._setupStyle(R,P,E);var I=R._devicePixelRatio=1;R.isRetinaEnabled()&&(I=R._devicePixelRatio=Math.min(R._maxPixelRatio,window.devicePixelRatio||1)),D.width=P*I,D.height=E*I},_setupStyle:function(R,P,E){var D=cc.game.canvas,I=cc.game.container;cc.sys.os===cc.sys.OS_ANDROID&&(document.body.style.width=(R._isRotated?E:P)+"px",document.body.style.height=(R._isRotated?P:E)+"px"),I.style.width=D.style.width=P+"px",I.style.height=D.style.height=E+"px"},_fixContainer:function(){document.body.insertBefore(cc.game.container,document.body.firstChild);var R=document.body.style;R.width=window.innerWidth+"px",R.height=window.innerHeight+"px",R.overflow="hidden";var P=cc.game.container.style;P.position="fixed",P.left=P.top="0px",document.body.scrollTop=0}}),cc.ContentStrategy=cc.Class({name:"ContentStrategy",ctor:function(){this._result={scale:[1,1],viewport:null}},_buildResult:function(R,P,E,D,I,M){Math.abs(R-E)<2&&(E=R),Math.abs(P-D)<2&&(D=P);var N=cc.rect((R-E)/2,(P-D)/2,E,D);return cc.game.renderType,cc.game.RENDER_TYPE_CANVAS,this._result.scale=[I,M],this._result.viewport=N,this._result},preApply:function(){},apply:function(){return{scale:[1,1]}},postApply:function(){}}),function(){var R=cc.Class({name:"EqualToFrame",extends:cc.ContainerStrategy,apply:function(G){var V=G._frameSize.height,j=cc.game.container.style;this._setupContainer(G,G._frameSize.width,G._frameSize.height),G._isRotated?j.margin="0 0 0 "+V+"px":j.margin="0px",j.padding="0px"}}),P=cc.Class({name:"ProportionalToFrame",extends:cc.ContainerStrategy,apply:function(G,V){var j,H,U=G._frameSize.width,X=G._frameSize.height,Y=cc.game.container.style,z=V.width,W=V.height,Z=U/z,Q=X/W;Z<Q?(j=U,H=W*Z):(j=z*Q,H=X);var ee=Math.round((U-j)/2),te=Math.round((X-H)/2);j=U-2*ee,H=X-2*te,this._setupContainer(G,j,H),G._isRotated?Y.margin="0 0 0 "+X+"px":Y.margin="0px",Y.paddingLeft=ee+"px",Y.paddingRight=ee+"px",Y.paddingTop=te+"px",Y.paddingBottom=te+"px"}}),E=(cc.Class({name:"EqualToWindow",extends:R,preApply:function(G){this._super(G),cc.game.frame=document.documentElement},apply:function(G){this._super(G),this._fixContainer()}}),cc.Class({name:"ProportionalToWindow",extends:P,preApply:function(G){this._super(G),cc.game.frame=document.documentElement},apply:function(G,V){this._super(G,V),this._fixContainer()}}),cc.Class({name:"OriginalContainer",extends:cc.ContainerStrategy,apply:function(G){this._setupContainer(G,cc.game.canvas.width,cc.game.canvas.height)}})),D=(typeof window>"u"?global:window).__globalAdapter;D&&(D.adaptContainerStrategy&&D.adaptContainerStrategy(cc.ContainerStrategy.prototype),D.adaptView&&D.adaptView(O.prototype)),cc.ContainerStrategy.EQUAL_TO_FRAME=new R,cc.ContainerStrategy.PROPORTION_TO_FRAME=new P,cc.ContainerStrategy.ORIGINAL_CONTAINER=new E;var I=cc.Class({name:"ExactFit",extends:cc.ContentStrategy,apply:function(G,V){var j=cc.game.canvas.width,H=cc.game.canvas.height,U=j/V.width,X=H/V.height;return this._buildResult(j,H,j,H,U,X)}}),M=cc.Class({name:"ShowAll",extends:cc.ContentStrategy,apply:function(G,V){var j,H,U=cc.game.canvas.width,X=cc.game.canvas.height,Y=V.width,z=V.height,W=U/Y,Z=X/z,Q=0;return W<Z?(j=U,H=z*(Q=W)):(j=Y*(Q=Z),H=X),this._buildResult(U,X,j,H,Q,Q)}}),N=cc.Class({name:"NoBorder",extends:cc.ContentStrategy,apply:function(G,V){var j,H,U,X=cc.game.canvas.width,Y=cc.game.canvas.height,z=V.width,W=V.height,Z=X/z,Q=Y/W;return Z<Q?(H=z*(j=Q),U=Y):(H=X,U=W*(j=Z)),this._buildResult(X,Y,H,U,j,j)}}),k=cc.Class({name:"FixedHeight",extends:cc.ContentStrategy,apply:function(G,V){var j=cc.game.canvas.width,H=cc.game.canvas.height,U=H/V.height,X=j,Y=H;return this._buildResult(j,H,X,Y,U,U)}}),F=cc.Class({name:"FixedWidth",extends:cc.ContentStrategy,apply:function(G,V){var j=cc.game.canvas.width,H=cc.game.canvas.height,U=j/V.width,X=j,Y=H;return this._buildResult(j,H,X,Y,U,U)}});cc.ContentStrategy.EXACT_FIT=new I,cc.ContentStrategy.SHOW_ALL=new M,cc.ContentStrategy.NO_BORDER=new N,cc.ContentStrategy.FIXED_HEIGHT=new k,cc.ContentStrategy.FIXED_WIDTH=new F}(),cc.ResolutionPolicy=cc.Class({name:"cc.ResolutionPolicy",ctor:function(R,P){this._containerStrategy=null,this._contentStrategy=null,this.setContainerStrategy(R),this.setContentStrategy(P)},preApply:function(R){this._containerStrategy.preApply(R),this._contentStrategy.preApply(R)},apply:function(R,P){return this._containerStrategy.apply(R,P),this._contentStrategy.apply(R,P)},postApply:function(R){this._containerStrategy.postApply(R),this._contentStrategy.postApply(R)},setContainerStrategy:function(R){R instanceof cc.ContainerStrategy&&(this._containerStrategy=R)},setContentStrategy:function(R){R instanceof cc.ContentStrategy&&(this._contentStrategy=R)}}),_.get(cc.ResolutionPolicy.prototype,"canvasSize",function(){return cc.v2(cc.game.canvas.width,cc.game.canvas.height)}),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,cc.view=new O,cc.winSize=cc.size(),S.exports=cc.view},{"../event/event-target":143,"../platform/CCClass":196,"../platform/js":217,"../renderer":227}],207:[function(){cc.visibleRect={topLeft:cc.v2(0,0),topRight:cc.v2(0,0),top:cc.v2(0,0),bottomLeft:cc.v2(0,0),bottomRight:cc.v2(0,0),bottom:cc.v2(0,0),center:cc.v2(0,0),left:cc.v2(0,0),right:cc.v2(0,0),width:0,height:0,init:function(L){var S=this.width=L.width,T=this.height=L.height,_=L.x,w=L.y,B=w+T,A=_+S;this.topLeft.x=_,this.topLeft.y=B,this.topRight.x=A,this.topRight.y=B,this.top.x=_+S/2,this.top.y=B,this.bottomLeft.x=_,this.bottomLeft.y=w,this.bottomRight.x=A,this.bottomRight.y=w,this.bottom.x=_+S/2,this.bottom.y=w,this.center.x=_+S/2,this.center.y=w+T/2,this.left.x=_,this.left.y=w+T/2,this.right.x=A,this.right.y=w+T/2}}},{}],208:[function(L,S){var T=L("./js"),_=(L("./utils").isPlainEmptyObj_DEV,"$_$");function w(R,P){var E=P?Object.create(P):{};return T.value(R,"__attrs__",E),E}function B(R){if(typeof R!="function")return w(R,A(R.constructor));for(var P,E=cc.Class.getInheritanceChain(R),D=E.length-1;D>=0;D--){var I=E[D];I.hasOwnProperty("__attrs__")&&I.__attrs__||w(I,(P=E[D+1])&&P.__attrs__)}return w(R,(P=E[0])&&P.__attrs__),R.__attrs__}function A(R){return R.hasOwnProperty("__attrs__")&&R.__attrs__||B(R)}function O(R,P){this.name=R,this.default=P}O.prototype.toString=function(){return this.name},cc.Integer=new O("Integer",0),cc.Float=new O("Float",0),cc.Boolean=new O("Boolean",!1),cc.String=new O("String",""),S.exports={PrimitiveType:O,attr:function(R,P){var E=A(R),D=P+_,I={};for(var M in E)M.startsWith(D)&&(I[M.slice(D.length)]=E[M]);return I},getClassAttrs:A,setClassAttr:function(R,P,E,D){A(R)[P+_+E]=D},DELIMETER:_,getTypeChecker_ET:!1,getObjTypeChecker_ET:!1,ScriptUuid:{}}},{"./CCClass":196,"./js":217,"./utils":220}],209:[function(L,S){var T=L("./js"),_=T.array.fastRemoveAt;function w(){}function B(){this.callback=w,this.target=void 0,this.once=!1}B.prototype.set=function(D,I,M){this.callback=D,this.target=I,this.once=!!M};var A=new T.Pool(function(D){return D.callback=w,D.target=void 0,D.once=!1,!0},32);function O(){this.callbackInfos=[],this.isInvoking=!1,this.containCanceled=!1}A.get=function(){return this._get()||new B};var R=O.prototype;R.removeByCallback=function(D){for(var I=0;I<this.callbackInfos.length;++I){var M=this.callbackInfos[I];M&&M.callback===D&&(A.put(M),_(this.callbackInfos,I),--I)}},R.removeByTarget=function(D){for(var I=0;I<this.callbackInfos.length;++I){var M=this.callbackInfos[I];M&&M.target===D&&(A.put(M),_(this.callbackInfos,I),--I)}},R.cancel=function(D){var I=this.callbackInfos[D];I&&(A.put(I),this.callbackInfos[D]=null),this.containCanceled=!0},R.cancelAll=function(){for(var D=0;D<this.callbackInfos.length;D++){var I=this.callbackInfos[D];I&&(A.put(I),this.callbackInfos[D]=null)}this.containCanceled=!0},R.purgeCanceled=function(){for(var D=this.callbackInfos.length-1;D>=0;--D)this.callbackInfos[D]||_(this.callbackInfos,D);this.containCanceled=!1},R.clear=function(){this.cancelAll(),this.callbackInfos.length=0,this.isInvoking=!1,this.containCanceled=!1};var P=new T.Pool(function(D){return D.callbackInfos=[],D.isInvoking=!1,D.containCanceled=!1,!0},16);function E(){this._callbackTable=T.createMap(!0)}P.get=function(){return this._get()||new O},(R=E.prototype).on=function(D,I,M,N){var k=this._callbackTable[D];k||(k=this._callbackTable[D]=P.get());var F=A.get();F.set(I,M,N),k.callbackInfos.push(F)},R.hasEventListener=function(D,I,M){var N=this._callbackTable[D];if(!N)return!1;var k=N.callbackInfos;if(!I){if(N.isInvoking){for(var F=0;F<k.length;++F)if(k[F])return!0;return!1}return k.length>0}for(var G=0;G<k.length;++G){var V=k[G];if(V&&V.callback===I&&V.target===M)return!0}return!1},R.removeAll=function(D){if(typeof D=="string"){var I=this._callbackTable[D];I&&(I.isInvoking?I.cancelAll():(I.clear(),P.put(I),delete this._callbackTable[D]))}else if(D)for(var M in this._callbackTable){var N=this._callbackTable[M];if(N.isInvoking)for(var k=N.callbackInfos,F=0;F<k.length;++F){var G=k[F];G&&G.target===D&&N.cancel(F)}else N.removeByTarget(D)}},R.off=function(D,I,M){var N=this._callbackTable[D];if(N)for(var k=N.callbackInfos,F=0;F<k.length;++F){var G=k[F];if(G&&G.callback===I&&G.target===M){N.isInvoking?N.cancel(F):(_(k,F),A.put(G));break}}},R.emit=function(D,I,M,N,k,F){var G=this._callbackTable[D];if(G){var V=!G.isInvoking;G.isInvoking=!0;for(var j=G.callbackInfos,H=0,U=j.length;H<U;++H){var X=j[H];if(X){var Y=X.target,z=X.callback;X.once&&this.off(D,z,Y),Y?z.call(Y,I,M,N,k,F):z(I,M,N,k,F)}}V&&(G.isInvoking=!1,G.containCanceled&&G.purgeCanceled())}},S.exports=E},{"./js":217}],210:[function(L,S){function T(_,w){for(var B=0;B<w.length;B++){var A=w[B];Array.isArray(A)?T(_,A):_.push(A)}}S.exports={flattenCodeArray:function(_){var w=[];return T(w,_),w.join("")}}},{}],211:[function(L,S,T){T.__esModule=!0,T.default=pe,T.getDependUuidList=function(ue){var le=ue[1];return ue[10].map(function(ce){return le[ce]})},T.hasNativeDep=function(ue){var le=ue[5],ce=le[le.length-1];return typeof ce=="number"&&ce<0},T.packCustomObjData=function(ue,le,ce){return[1,M,M,[ue],M,ce?[le,-1]:[le],[0],M,[],[],[]]},T.unpackJSONs=function(ue,le){if(ue[0]<1)throw new Error(cc.debug.getError(5304,ue[0]));ie(ue,!0,le),ne(ue);for(var ce=new K(ue[0]),_e=ue[1],oe=ue[2],de=ue[3],me=ue[4],ye=ue[V],ge=0;ge<ye.length;++ge)ye[ge].unshift(ce,_e,oe,de,me);return ye};var _=I(L("./js")),w=I(L("../value-types/vec2")),B=I(L("../value-types/vec3")),A=I(L("../value-types/vec4")),O=I(L("../value-types/color")),R=I(L("../value-types/size")),P=I(L("../value-types/rect")),E=I(L("../value-types/quat")),D=I(L("../value-types/mat4"));function I(ue){return ue&&ue.__esModule?ue:{default:ue}}var M=0,N=[w.default,B.default,A.default,E.default,O.default,R.default,P.default,D.default];function k(ue,le){ue.x=le[1],ue.y=le[2],ue.z=le[3],ue.w=le[4]}var F=[function(ue,le){ue.x=le[1],ue.y=le[2]},function(ue,le){ue.x=le[1],ue.y=le[2],ue.z=le[3]},k,k,function(ue,le){ue._val=le[1]},function(ue,le){ue.width=le[1],ue.height=le[2]},function(ue,le){ue.x=le[1],ue.y=le[2],ue.width=le[3],ue.height=le[4]},function(ue,le){D.default.fromArray(ue,le,1)}],G=0,V=5,j=function(){function ue(){this.uuidObjList=null,this.uuidPropList=null,this.uuidList=null}var le=ue.prototype;return le.init=function(ce){this.uuidObjList=ce[8],this.uuidPropList=ce[9],this.uuidList=ce[10]},le.reset=function(){this.uuidList=null,this.uuidObjList=null,this.uuidPropList=null},le.push=function(ce,_e,oe){this.uuidObjList.push(ce),this.uuidPropList.push(_e),this.uuidList.push(oe)},ue}();function H(ue,le,ce){for(var _e=ue.length-1,oe=0,de=3*ue[_e];oe<de;oe+=3){var me=ue[oe],ye=le[ue[oe+2]],ge=ue[oe+1];ge>=0?me[ce[ge]]=ye:me[~ge]=ye}for(;oe<_e;oe+=3){var we=le[ue[oe]],Te=le[ue[oe+2]],Ee=ue[oe+1];Ee>=0?we[ce[Ee]]=Te:we[~Ee]=Te}}function U(ue,le){for(var ce=ue[4][le[0]],_e=ce[0],oe=new _e[0],de=_e[1],me=_e[2],ye=ce[ce.length-1],ge=1;ge<ye;++ge)oe[de[ce[ge]]]=le[ge];for(;ge<le.length;++ge){var we=de[ce[ge]],Te=_e[ce[ge]+me];(0,Q[Te])(ue,oe,we,le[ge])}return oe}function X(ue,le,ce){var _e=new le;return _e._deserialize?_e._deserialize(ce,ue[0]):cc.errorID(5303,_.default.getClassName(le)),_e}function Y(ue,le,ce,_e){_e>=0?le[ce]=ue[5][_e]:ue[7][3*~_e]=le}function z(ue){return function(le,ce,_e,oe){ce[_e]=oe;for(var de=0;de<oe.length;++de)ue(le,oe,de,oe[de])}}function W(ue,le,ce,_e){le[ce]=null,ue[8][_e]=le}function Z(ue,le,ce,_e){le[ce]=U(ue,_e)}j.pool=new _.default.Pool(function(ue){ue.reset()},5),j.pool.get=function(){return this._get()||new j};var Q=new Array(13);function ee(ue){var le=ue[5],ce=ue[6],_e=ce===0?0:ce.length,oe=le[le.length-1],de=le.length-_e;typeof oe!="number"?oe=0:(oe<0&&(oe=~oe),--de);for(var me=0;me<de;++me)le[me]=U(ue,le[me]);for(var ye=ue[3],ge=0;ge<_e;++ge,++me){var we=ce[ge],Te=le[me];if(we>=0){var Ee=ye[we];le[me]=X(ue,Ee,Te)}else(0,Q[we=~we])(ue,le,me,Te)}return oe}function te(ue,le){return ue||pe.reportMissingClass(le),Object}function re(ue,le,ce,_e,oe,de){var me=ue(le);if(!me){if(oe)return void(ce[_e]=function(ye,ge,we){return function(){var Te=ue(we)||te(de,we);return ye[ge]=Te,new Te}}(ce,_e,le));me=te(de,le)}ce[_e]=me}function ie(ue,le,ce){for(var _e=ce||_.default._getClassById,oe=ue[3],de=0;de<oe.length;++de){var me=oe[de];typeof me!="string"?re(_e,me[0],me,G,le,ce):re(_e,me,oe,de,le,ce)}}function ne(ue){var le=ue[4];if(le)for(var ce=ue[3],_e=0;_e<le.length;++_e){var oe=le[_e];oe[0]=ce[oe[0]]}}function he(ue){for(var le=ue[5],ce=ue[2],_e=ue[1],oe=ue[8],de=ue[9],me=ue[10],ye=0;ye<oe.length;++ye){var ge=oe[ye];typeof ge=="number"&&(oe[ye]=le[ge]);var we=de[ye];typeof we=="number"&&(we=we>=0?ce[we]:~we,de[ye]=we);var Te=me[ye];typeof Te=="number"&&(me[ye]=_e[Te])}}function pe(ue,le,ce){typeof ue=="string"&&(ue=JSON.parse(ue));var _e=!le;(le=le||j.pool.get()).init(ue),ce=ce||{};var oe=ue[0],de=!1;if(typeof oe=="object"&&(de=oe.preprocessed,oe=oe.version),oe<1)throw new Error(cc.debug.getError(5304,oe));ce._version=oe,ce.result=le,ue[0]=ce,de||(ie(ue,!1,ce.classFinder),ne(ue)),cc.game._isCloning=!0;var me=ue[5],ye=ee(ue);return cc.game._isCloning=!1,ue[7]&&H(ue[7],me,ue[2]),he(ue),_e&&j.pool.put(le),me[ye]}Q[0]=function(ue,le,ce,_e){le[ce]=_e},Q[1]=Y,Q[2]=z(Y),Q[3]=z(W),Q[4]=Z,Q[5]=function(ue,le,ce,_e){F[_e[0]](le[ce],_e)},Q[6]=W,Q[7]=function(ue,le,ce,_e){le[ce].set(_e)},Q[8]=function(ue,le,ce,_e){var oe=new N[_e[0]];F[_e[0]](oe,_e),le[ce]=oe},Q[9]=z(Z),Q[10]=function(ue,le,ce,_e){var oe=ue[3][_e[0]];le[ce]=X(ue,oe,_e[1])},Q[11]=function(ue,le,ce,_e){var oe=_e[0];le[ce]=oe;for(var de=1;de<_e.length;de+=3){var me=_e[de],ye=_e[de+1],ge=_e[de+2];(0,Q[ye])(ue,oe,me,ge)}},Q[12]=function(ue,le,ce,_e){var oe=_e[0];le[ce]=oe;for(var de=0;de<oe.length;++de){var me=oe[de],ye=_e[de+1];ye!==0&&(0,Q[ye])(ue,oe,de,me)}},pe.Details=j;var K=function(ue){this.preprocessed=!0,this.version=ue}},{"../value-types/color":285,"../value-types/mat4":288,"../value-types/quat":289,"../value-types/rect":290,"../value-types/size":291,"../value-types/vec2":295,"../value-types/vec3":296,"../value-types/vec4":297,"./js":217}],212:[function(L){var S,T=(S=L("./deserialize-compiled"))&&S.__esModule?S:{default:S};T.default.reportMissingClass=function(_){cc.warnID(5302,_)},cc.deserialize=T.default},{"./deserialize-compiled":211,"./deserialize-editor":void 0}],213:[function(L,S){var T=".";function _(w){this.id=0|998*Math.random(),this.prefix=w?w+T:""}_.prototype.getNewId=function(){return this.prefix+ ++this.id},_.global=new _("global"),S.exports=_},{}],214:[function(L){L("./js"),L("./CCClass"),L("./CCClassDecorator"),L("./CCEnum"),L("./CCObject"),L("./callbacks-invoker"),L("./deserialize"),L("./instantiate"),L("./instantiate-jit"),L("./requiring-frame"),L("./CCSys"),L("./CCMacro"),L("./CCVisibleRect")},{"./CCClass":196,"./CCClassDecorator":197,"./CCEnum":198,"./CCMacro":201,"./CCObject":202,"./CCSys":205,"./CCVisibleRect":207,"./callbacks-invoker":209,"./deserialize":212,"./instantiate":216,"./instantiate-jit":215,"./js":217,"./requiring-frame":219}],215:[function(L,S){var T=L("./CCObject"),_=T.Flags.Destroyed,w=T.Flags.PersistentMask,B=L("./attribute"),A=L("./js"),O=L("./CCClass"),R=L("./compiler"),P=B.DELIMETER+"default",E=O.IDENTIFIER_RE,D=O.escapeForJS,I="var ",M="o",N="t",k={"cc.Node":"cc.Node","cc.Sprite":"cc.Sprite","cc.Label":"cc.Label","cc.Button":"cc.Button","cc.Widget":"cc.Widget","cc.Animation":"cc.Animation","cc.ClickEvent":!1,"cc.PrefabInfo":!1};try{!Float32Array.name&&(Float32Array.name="Float32Array"),!Float64Array.name&&(Float64Array.name="Float64Array"),!Int8Array.name&&(Int8Array.name="Int8Array"),!Int16Array.name&&(Int16Array.name="Int16Array"),!Int32Array.name&&(Int32Array.name="Int32Array"),!Uint8Array.name&&(Uint8Array.name="Uint8Array"),!Uint16Array.name&&(Uint16Array.name="Uint16Array"),!Uint32Array.name&&(Uint32Array.name="Uint32Array"),!Uint8ClampedArray.name&&(Uint8ClampedArray.name="Uint8ClampedArray")}catch(W){}function F(W){if(W===Float32Array)return"Float32Array";if(W===Float64Array)return"Float64Array";if(W===Int8Array)return"Int8Array";if(W===Int16Array)return"Int16Array";if(W===Int32Array)return"Int32Array";if(W===Uint8Array)return"Uint8Array";if(W===Uint16Array)return"Uint16Array";if(W===Uint32Array)return"Uint32Array";if(W===Uint8ClampedArray)return"Uint8ClampedArray";throw new Error("Unknown TypedArray to instantiate: "+W)}function G(W,Z){this.varName=W,this.expression=Z}function V(W,Z){return Z instanceof G?new G(Z.varName,W+Z.expression):W+Z}function j(W,Z,Q){Array.isArray(Q)?(Q[0]=V(Z,Q[0]),W.push(Q)):W.push(V(Z,Q)+";")}function H(W){this._exps=[],this._targetExp=W}function U(W,Z){if(typeof W=="function")try{W=W()}catch(Q){return!1}if(W===Z)return!0;if(W&&Z&&typeof W=="object"&&typeof Z=="object"&&W.constructor===Z.constructor)if(W instanceof cc.ValueType){if(W.equals(Z))return!0}else{if(Array.isArray(W))return W.length===0&&Z.length===0;if(W.constructor===Object)return A.isEmptyObject(W)&&A.isEmptyObject(Z)}return!1}function X(W){return E.test(W)?"."+W:"["+D(W)+"]"}function Y(W,Z){var Q;this.parent=Z,this.objsToClear_iN$t=[],this.codeArray=[],this.objs=[],this.funcs=[],this.funcModuleCache=A.createMap(),A.mixin(this.funcModuleCache,k),this.globalVariables=[],this.globalVariableId=0,this.localVariableId=0,this.codeArray.push(I+M+","+N+";","if(R){",M+"=R;","}else{",M+"=R=new "+this.getFuncModule(W.constructor,!0)+"();","}"),A.value(W,"_iN$t",{globalVar:"R"},!0),this.objsToClear_iN$t.push(W),this.enumerateObject(this.codeArray,W),this.globalVariables.length>0&&(Q=I+this.globalVariables.join(",")+";");var ee=R.flattenCodeArray(["return (function(R){",Q||[],this.codeArray,"return o;","})"]);this.result=Function("O","F",ee)(this.objs,this.funcs);for(var te=0,re=this.objsToClear_iN$t.length;te<re;++te)this.objsToClear_iN$t[te]._iN$t=null;this.objsToClear_iN$t.length=0}G.prototype.toString=function(){return I+this.varName+"="+this.expression+";"},H.prototype.append=function(W,Z){this._exps.push([W,Z])},H.prototype.writeCode=function(W){var Z;if(this._exps.length>1)W.push(N+"="+this._targetExp+";"),Z=N;else{if(this._exps.length!==1)return;Z=this._targetExp}for(var Q=0;Q<this._exps.length;Q++){var ee=this._exps[Q];j(W,Z+X(ee[0])+"=",ee[1])}},H.pool=new A.Pool(function(W){W._exps.length=0,W._targetExp=null},1),H.pool.get=function(W){var Z=this._get()||new H;return Z._targetExp=W,Z};var z=Y.prototype;z.getFuncModule=function(W,Z){var Q=A.getClassName(W);if(Q){var ee=this.funcModuleCache[Q];if(ee)return ee;if(ee===void 0){var te=Q.indexOf(".")!==-1;if(te)try{if(te=W===Function("return "+Q)())return this.funcModuleCache[Q]=Q,Q}catch(ne){}}}var re=this.funcs.indexOf(W);re<0&&(re=this.funcs.length,this.funcs.push(W));var ie="F["+re+"]";return Z&&(ie="("+ie+")"),this.funcModuleCache[Q]=ie,ie},z.getObjRef=function(W){var Z=this.objs.indexOf(W);return Z<0&&(Z=this.objs.length,this.objs.push(W)),"O["+Z+"]"},z.setValueType=function(W,Z,Q,ee){var te=H.pool.get(ee),re=Z.constructor.__props__;re||(re=Object.keys(Z));for(var ie=0;ie<re.length;ie++){var ne=re[ie],he=Q[ne];if(Z[ne]!==he){var pe=this.enumerateField(Q,ne,he);te.append(ne,pe)}}te.writeCode(W),H.pool.put(te)},z.enumerateCCClass=function(W,Z,Q){for(var ee=Q.__values__,te=B.getClassAttrs(Q),re=0;re<ee.length;re++){var ie=ee[re],ne=Z[ie],he=te[ie+P];if(!U(he,ne))if(typeof ne=="object"&&ne instanceof cc.ValueType&&(he=O.getDefault(he))&&he.constructor===ne.constructor){var pe=M+X(ie);this.setValueType(W,he,ne,pe)}else this.setObjProp(W,Z,ie,ne)}},z.instantiateArray=function(W){if(W.length===0)return"[]";var Z="a"+ ++this.localVariableId,Q=[new G(Z,"new Array("+W.length+")")];A.value(W,"_iN$t",{globalVar:"",source:Q},!0),this.objsToClear_iN$t.push(W);for(var ee=0;ee<W.length;++ee)j(Q,Z+"["+ee+"]=",this.enumerateField(W,ee,W[ee]));return Q},z.instantiateTypedArray=function(W){var Z=W.constructor.name||F(W.constructor);if(W.length===0)return"new "+Z;var Q="a"+ ++this.localVariableId,ee=[new G(Q,"new "+Z+"("+W.length+")")];W._iN$t={globalVar:"",source:ee},this.objsToClear_iN$t.push(W);for(var te=0;te<W.length;++te)W[te]!==0&&j(ee,Q+"["+te+"]=",W[te]);return ee},z.enumerateField=function(W,Z,Q){if(typeof Q=="object"&&Q){var ee=Q._iN$t;if(ee){var te=ee.globalVar;if(!te){te=ee.globalVar="v"+ ++this.globalVariableId,this.globalVariables.push(te);var re=ee.source[0];ee.source[0]=V(te+"=",re)}return te}return ArrayBuffer.isView(Q)?this.instantiateTypedArray(Q):Array.isArray(Q)?this.instantiateArray(Q):this.instantiateObj(Q)}return typeof Q=="function"?this.getFuncModule(Q):typeof Q=="string"?D(Q):(Z==="_objFlags"&&W instanceof T&&(Q&=w),Q)},z.setObjProp=function(W,Z,Q,ee){j(W,M+X(Q)+"=",this.enumerateField(Z,Q,ee))},z.enumerateObject=function(W,Z){var Q=Z.constructor;if(cc.Class._isCCClass(Q))this.enumerateCCClass(W,Z,Q);else for(var ee in Z)if(Z.hasOwnProperty(ee)&&(ee.charCodeAt(0)!==95||ee.charCodeAt(1)!==95||ee==="__type__")){var te=Z[ee];typeof te=="object"&&te&&te===Z._iN$t||this.setObjProp(W,Z,ee,te)}},z.instantiateObj=function(W){if(W instanceof cc.ValueType)return O.getNewValueTypeCode(W);if(W instanceof cc.Asset)return this.getObjRef(W);if(W._objFlags&_)return null;var Z,Q=W.constructor;if(cc.Class._isCCClass(Q)){if(this.parent){if(this.parent instanceof cc.Component){if(W instanceof cc._BaseNode||W instanceof cc.Component)return this.getObjRef(W)}else if(this.parent instanceof cc._BaseNode){if(W instanceof cc._BaseNode){if(!W.isChildOf(this.parent))return this.getObjRef(W)}else if(W instanceof cc.Component){var ee;if((ee=W.node)==null||!ee.isChildOf(this.parent))return this.getObjRef(W)}}}Z=new G(M,"new "+this.getFuncModule(Q,!0)+"()")}else if(Q===Object)Z=new G(M,"{}");else{if(Q)return this.getObjRef(W);Z=new G(M,"Object.create(null)")}var te=[Z];return A.value(W,"_iN$t",{globalVar:"",source:te},!0),this.objsToClear_iN$t.push(W),this.enumerateObject(te,W),["(function(){",te,"return o;})();"]},S.exports={compile:function(W){return new Y(W,W instanceof cc._BaseNode&&W).result},equalsToDefault:U}},{"./CCClass":196,"./CCObject":202,"./attribute":208,"./compiler":210,"./js":217}],216:[function(L,S){var T=L("./CCObject"),_=L("../value-types/value-type"),w=T.Flags.Destroyed,B=T.Flags.PersistentMask,A=L("./utils").isDomNode,O=L("./js");function R(N,k){if(!k&&(typeof N!="object"||Array.isArray(N)||!N||!cc.isValid(N)))return null;var F;if(N instanceof T){if(N._instantiate)return cc.game._isCloning=!0,F=N._instantiate(null,!0),cc.game._isCloning=!1,F;if(N instanceof cc.Asset)return null}return cc.game._isCloning=!0,F=E(N),cc.game._isCloning=!1,F}var P=[];function E(N,k){if(Array.isArray(N)||A&&A(N))return null;var F;I(N,F=N._iN$t?N._iN$t:N.constructor?new N.constructor:Object.create(null),k);for(var G=0,V=P.length;G<V;++G)P[G]._iN$t=null;return P.length=0,F}function D(N,k,F,G){for(var V=N.__values__,j=0;j<V.length;j++){var H=V[j],U=k[H];if(typeof U=="object"&&U){var X=F[H];X instanceof _&&X.constructor===U.constructor?X.set(U):F[H]=U._iN$t||M(U,G)}else F[H]=U}}function I(N,k,F){O.value(N,"_iN$t",k,!0),P.push(N);var G=N.constructor;if(cc.Class._isCCClass(G))D(G,N,k,F);else for(var V in N)if(N.hasOwnProperty(V)&&(V.charCodeAt(0)!==95||V.charCodeAt(1)!==95||V==="__type__")){var j=N[V];if(typeof j=="object"&&j){if(j===k)continue;k[V]=j._iN$t||M(j,F)}else k[V]=j}N instanceof T&&(k._objFlags&=B)}function M(N,k){if(N instanceof _)return N.clone();if(N instanceof cc.Asset)return N;var F;if(ArrayBuffer.isView(N)){var G=N.length;F=new N.constructor(G),N._iN$t=F,P.push(N);for(var V=0;V<G;++V)F[V]=N[V];return F}if(Array.isArray(N)){var j=N.length;F=new Array(j),O.value(N,"_iN$t",F,!0),P.push(N);for(var H=0;H<j;++H){var U=N[H];F[H]=typeof U=="object"&&U?U._iN$t||M(U,k):U}return F}if(N._objFlags&w)return null;var X=N.constructor;if(cc.Class._isCCClass(X)){if(k){if(k instanceof cc.Component){if(N instanceof cc._BaseNode||N instanceof cc.Component)return N}else if(k instanceof cc._BaseNode){if(N instanceof cc._BaseNode){if(!N.isChildOf(k))return N}else if(N instanceof cc.Component){var Y;if((Y=N.node)==null||!Y.isChildOf(k))return N}}}F=new X}else if(X===Object)F={};else{if(X)return N;F=Object.create(null)}return I(N,F,k),F}R._clone=E,cc.instantiate=R,S.exports=R},{"../value-types/value-type":294,"./CCObject":202,"./js":217,"./utils":220}],217:[function(L,S){var T=new(L("./id-generater"))("TmpCId.");function _(k,F){for(;k;){var G=Object.getOwnPropertyDescriptor(k,F);if(G)return G;k=Object.getPrototypeOf(k)}return null}function w(k,F,G){var V=_(F,k);Object.defineProperty(G,k,V)}var B={isNumber:function(k){return typeof k=="number"||k instanceof Number},isString:function(k){return typeof k=="string"||k instanceof String},addon:function(k){k=k||{};for(var F=1,G=arguments.length;F<G;F++){var V=arguments[F];if(V){if(typeof V!="object"){cc.errorID(5402,V);continue}for(var j in V)j in k||w(j,V,k)}}return k},mixin:function(k){k=k||{};for(var F=1,G=arguments.length;F<G;F++){var V=arguments[F];if(V){if(typeof V!="object"){cc.errorID(5403,V);continue}for(var j in V)w(j,V,k)}}return k},extend:function(k,F){for(var G in F)F.hasOwnProperty(G)&&(k[G]=F[G]);return k.prototype=Object.create(F.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),k},getSuper:function(k){var F=k.prototype,G=F&&Object.getPrototypeOf(F);return G&&G.constructor},isChildClassOf:function(k,F){if(k&&F){if(typeof k!="function"||typeof F!="function")return!1;if(k===F)return!0;for(;;){if(!(k=B.getSuper(k)))return!1;if(k===F)return!0}}return!1},clear:function(k){for(var F=Object.keys(k),G=0;G<F.length;G++)delete k[F[G]]},isEmptyObject:function(k){for(var F in k)return!1;return!0},getPropertyDescriptor:_},A={value:void 0,enumerable:!1,writable:!1,configurable:!0};B.value=function(k,F,G,V,j){A.value=G,A.writable=V,A.enumerable=j,Object.defineProperty(k,F,A),A.value=void 0};var O={get:null,set:null,enumerable:!1};B.getset=function(k,F,G,V,j,H){typeof V!="function"&&(j=V,V=void 0),O.get=G,O.set=V,O.enumerable=j,O.configurable=H,Object.defineProperty(k,F,O),O.get=null,O.set=null};var R={get:null,enumerable:!1,configurable:!1};B.get=function(k,F,G,V,j){R.get=G,R.enumerable=V,R.configurable=j,Object.defineProperty(k,F,R),R.get=null};var P={set:null,enumerable:!1,configurable:!1};B.set=function(k,F,G,V,j){P.set=G,P.enumerable=V,P.configurable=j,Object.defineProperty(k,F,P),P.set=null},B.getClassName=function(k){if(typeof k=="function"){var F=k.prototype;if(F&&F.hasOwnProperty("__classname__")&&F.__classname__)return F.__classname__;var G="";if(k.name&&(G=k.name),k.toString){var V,j=k.toString();(V=j.charAt(0)==="["?j.match(/\[\w+\s*(\w+)\]/):j.match(/function\s*(\w+)/))&&V.length===2&&(G=V[1])}return G!=="Object"?G:""}return k&&k.constructor?B.getClassName(k.constructor):""},function(){var k={},F={};function G(j,H,U){return B.getset(B,H,function(){return Object.assign({},U)},function(X){B.clear(U),Object.assign(U,X)}),function(X,Y){if(Y.prototype.hasOwnProperty(j)&&delete U[Y.prototype[j]],B.value(Y.prototype,j,X),X){var z=U[X];if(z&&z!==Y){var W="A Class already exists with the same "+j+' : "'+X+'".';cc.error(W)}else U[X]=Y}}}B._setClassId=G("__cid__","_registeredClassIds",k);var V=G("__classname__","_registeredClassNames",F);B.setClassName=function(j,H){if(V(j,H),!H.prototype.hasOwnProperty("__cid__")){var U=j||T.getNewId();U&&B._setClassId(U,H)}},B.unregisterClass=function(){for(var j=0;j<arguments.length;j++){var H=arguments[j].prototype,U=H.__cid__;U&&delete k[U];var X=H.__classname__;X&&delete F[X]}},B._getClassById=function(j){return k[j]},B.getClassByName=function(j){return F[j]},B._getClassId=function(j,H){if(typeof j=="function"&&j.prototype.hasOwnProperty("__cid__"))return j.prototype.__cid__;if(j&&j.constructor){var U=j.constructor.prototype;if(U&&U.hasOwnProperty("__cid__"))return j.__cid__}return""}}(),B.obsolete=function(k,F,G,V){var j=/([^.]+)$/,H=j.exec(F)[0],U=j.exec(G)[0];function X(){return this[U]}V?B.getset(k,H,X,function(Y){this[U]=Y}):B.get(k,H,X)},B.obsoletes=function(k,F,G,V){for(var j in G){var H=G[j];B.obsolete(k,F+"."+j,H,V)}};var E=/(%d)|(%s)/,D=/%s/;function I(k,F){k.splice(F,1)}function M(k,F){var G=k.indexOf(F);return G>=0&&(I(k,G),!0)}function N(k,F){F===void 0&&(F=k,k=null),this.get=null,this.count=0,this._pool=new Array(F),this._cleanup=k}B.formatStr=function(){var k=arguments.length;if(k===0)return"";var F=arguments[0];if(k===1)return""+F;var G=typeof F=="string"&&E.test(F);if(G)for(var V=1;V<k;++V){var j=arguments[V],H=typeof j=="number"?E:D;if(H.test(F)){var U=""+j;F=F.replace(H,U)}else F+=" "+j}else for(var X=1;X<k;++X)F+=" "+arguments[X];return F},B.shiftArguments=function(){for(var k=arguments.length-1,F=new Array(k),G=0;G<k;++G)F[G]=arguments[G+1];return F},B.createMap=function(k){var F=Object.create(null);return k&&(F["."]=!0,F["/"]=!0,delete F["."],delete F["/"]),F},B.array={remove:M,fastRemove:function(k,F){var G=k.indexOf(F);G>=0&&(k[G]=k[k.length-1],--k.length)},removeAt:I,fastRemoveAt:function(k,F){var G=k.length;F<0||F>=G||(k[F]=k[G-1],k.length=G-1)},contains:function(k,F){return k.indexOf(F)>=0},verifyType:function(k,F){if(k&&k.length>0){for(var G=0;G<k.length;G++)if(!(k[G]instanceof F))return cc.logID(1300),!1}return!0},removeArray:function(k,F){for(var G=0,V=F.length;G<V;G++)M(k,F[G])},appendObjectsAt:function(k,F,G){return k.splice.apply(k,[G,0].concat(F)),k},copy:function(k){var F,G=k.length,V=new Array(G);for(F=0;F<G;F+=1)V[F]=k[F];return V},MutableForwardIterator:L("../utils/mutable-forward-iterator")},N.prototype._get=function(){if(this.count>0){--this.count;var k=this._pool[this.count];return this._pool[this.count]=null,k}return null},N.prototype.put=function(k){var F=this._pool;if(this.count<F.length){if(this._cleanup&&this._cleanup(k)===!1)return;F[this.count]=k,++this.count}},N.prototype.resize=function(k){k>=0&&(this._pool.length=k,this.count>k&&(this.count=k))},B.Pool=N,cc.js=B,S.exports=B},{"../utils/mutable-forward-iterator":272,"./id-generater":213}],218:[function(L,S,T){var _=L("./js"),w=L("./attribute"),B={default:{},serializable:{},editorOnly:{},formerlySerializedAs:{}};function A(P,E,D,I){if(!P.get&&!P.set&&P.hasOwnProperty("default")){var M="_N$"+E;P.get=function(){return this[M]},P.set=function(G){var V=this[M];this[M]=G,D.call(this,V)};var N={};for(var k in I[M]=N,B){var F=B[k];P.hasOwnProperty(k)&&(N[k]=P[k],F.canUsedInGet||delete P[k])}}}function O(P,E,D,I){if(Array.isArray(E)){if(!(E.length>0))return cc.errorID(5508,D,I);P.type=E=E[0]}typeof E=="function"&&(E===String?P.type=cc.String:E===Boolean?P.type=cc.Boolean:E===Number&&(P.type=cc.Float))}function R(P,E,D){var I=P?{_short:!0}:{_short:!0,default:E};return D&&(I.type=D),I}T.getFullFormOfProperty=function(P,E){return P&&P.constructor===Object?null:Array.isArray(P)&&P.length>0?R(E,[],P):typeof P=="function"?R(E,_.isChildClassOf(P,cc.ValueType)?new P:null,P):P instanceof w.PrimitiveType?R(E,P.default):R(E,P)},T.preprocessAttrs=function(P,E){for(var D in P){var I=P[D],M=T.getFullFormOfProperty(I,!1);if(M&&(I=P[D]=M),I){var N=I.notify;N&&A(I,D,N,P),"type"in I&&O(I,I.type,E,D)}}},T.validateMethodWithProps=function(P){return typeof P=="function"||P===null}},{"./CCClass":196,"./attribute":208,"./js":217}],219:[function(){var L=[];cc._RF={push:function(S,T,_){_===void 0&&(_=T,T=""),L.push({uuid:T,script:_,module:S,exports:S.exports,beh:null})},pop:function(){var S=L.pop(),T=S.module,_=T.exports;if(_===S.exports){for(var w in _)return;T.exports=_=S.cls}},peek:function(){return L[L.length-1]}}},{}],220:[function(L,S){L("./js"),S.exports={contains:function(T,_){if(typeof T.contains=="function")return T.contains(_);if(typeof T.compareDocumentPosition=="function")return!!(16&T.compareDocumentPosition(_));var w=_.parentNode;if(w)do{if(w===T)return!0;w=w.parentNode}while(w!==null);return!1},isDomNode:typeof window=="object"&&(typeof Node=="function"?function(T){return T instanceof Node}:function(T){return T&&typeof T=="object"&&typeof T.nodeType=="number"&&typeof T.nodeName=="string"}),callInNextTick:function(T,_,w){T&&setTimeout(function(){T(_,w)},0)}}},{"./js":217}],221:[function(L){L("./platform/js"),L("./value-types"),L("./utils"),L("./platform/CCInputManager"),L("./platform/CCInputExtension"),L("./event"),L("./platform/CCSys"),L("./platform/CCMacro"),L("./asset-manager"),L("./CCDirector"),L("./renderer"),L("./platform/CCView"),L("./platform/CCScreen"),L("./CCScheduler"),L("./event-manager")},{"./CCDirector":27,"./CCScheduler":32,"./asset-manager":50,"./event":145,"./event-manager":141,"./platform/CCInputExtension":199,"./platform/CCInputManager":200,"./platform/CCMacro":201,"./platform/CCScreen":204,"./platform/CCSys":205,"./platform/CCView":206,"./platform/js":217,"./renderer":227,"./utils":270,"./value-types":286}],222:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=A(L("./assembler")),w=A(L("./utils/dynamic-atlas/manager")),B=A(L("./webgl/render-data"));function A(D){return D&&D.__esModule?D:{default:D}}function O(D,I){for(var M=0;M<I.length;M++){var N=I[M];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(D,N.key,N)}}function R(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D}function P(D,I){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,N){return M.__proto__=N,M})(D,I)}var E=function(D){var I,M;function N(){var V;return(V=D.call(this)||this)._renderData=new B.default,V._renderData.init(R(V)),V.initData(),V.initLocal(),V}M=D,(I=N).prototype=Object.create(M.prototype),I.prototype.constructor=I,P(I,M);var k,F,G=N.prototype;return G.initData=function(){this._renderData.createQuadData(0,this.verticesFloats,this.indicesCount)},G.initLocal=function(){this._local=[],this._local.length=4},G.updateColor=function(V,j){var H=this._renderData.uintVDatas[0];if(H){j=j!=null?j:V.node.color._val;for(var U=this.floatsPerVert,X=this.colorOffset,Y=H.length;X<Y;X+=U)H[X]=j}},G.getBuffer=function(){return cc.renderer._handle._meshBuffer},G.updateWorldVerts=function(V){var j=this._local,H=this._renderData.vDatas[0],U=V.node._worldMatrix.m,X=U[0],Y=U[1],z=U[4],W=U[5],Z=U[12],Q=U[13],ee=j[0],te=j[2],re=j[1],ie=j[3],ne=this.floatsPerVert,he=0;if(X===1&&Y===0&&z===0&&W===1)H[he]=ee+Z,H[he+1]=re+Q,H[he+=ne]=te+Z,H[he+1]=re+Q,H[he+=ne]=ee+Z,H[he+1]=ie+Q,H[he+=ne]=te+Z,H[he+1]=ie+Q;else{var pe=X*ee,K=X*te,ue=Y*ee,le=Y*te,ce=z*re,_e=z*ie,oe=W*re,de=W*ie;H[he]=pe+ce+Z,H[he+1]=ue+oe+Q,H[he+=ne]=K+ce+Z,H[he+1]=le+oe+Q,H[he+=ne]=pe+_e+Z,H[he+1]=ue+de+Q,H[he+=ne]=K+_e+Z,H[he+1]=le+de+Q}},G.fillBuffers=function(V,j){j.worldMatDirty&&this.updateWorldVerts(V);var H=this._renderData,U=H.vDatas[0],X=H.iDatas[0],Y=this.getBuffer(j),z=Y.request(this.verticesCount,this.indicesCount),W=z.byteOffset>>2,Z=Y._vData;U.length+W>Z.length?Z.set(U.subarray(0,Z.length-W),W):Z.set(U,W);for(var Q=Y._iData,ee=z.indiceOffset,te=z.vertexOffset,re=0,ie=X.length;re<ie;re++)Q[ee++]=te+X[re]},G.packToDynamicAtlas=function(V,j){if(!j._original&&w.default&&j._texture.packable&&j._texture.loaded){var H=w.default.insertSpriteFrame(j);H&&j._setDynamicAtlasFrame(H)}var U=V._materials[0];U&&U.getProperty("texture")!==j._texture._texture&&(V._vertsDirty=!0,V._updateMaterial())},k=N,(F=[{key:"verticesFloats",get:function(){return this.verticesCount*this.floatsPerVert}}])&&O(k.prototype,F),Object.defineProperty(k,"prototype",{writable:!1}),N}(_.default);T.default=E,cc.js.addon(E.prototype,{floatsPerVert:5,verticesCount:4,indicesCount:6,uvOffset:2,colorOffset:4}),cc.Assembler2D=E,S.exports=T.default},{"./assembler":224,"./utils/dynamic-atlas/manager":230,"./webgl/render-data":258}],223:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../utils/pool"))&&_.__esModule?_:{default:_};function B(E,D){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(I,M){return I.__proto__=M,I})(E,D)}var A=0;function O(E){return Object.getOwnPropertyDescriptor(E,"__assemblerId__")||(E.__assemblerId__=++A),E.__assemblerId__}var R=new(function(E){var D,I;function M(){for(var k,F=arguments.length,G=new Array(F),V=0;V<F;V++)G[V]=arguments[V];return(k=E.call.apply(E,[this].concat(G))||this)._pool={},k}I=E,(D=M).prototype=Object.create(I.prototype),D.prototype.constructor=D,B(D,I);var N=M.prototype;return N.put=function(k){if(k&&this.enabled){var F=O(k.constructor),G=this._pool;G[F]||(G[F]=[]),this.count>this.maxSize||(this._clean(k),G[F].push(k),this.count++)}},N.get=function(k){var F;if(this.enabled){var G=this._pool,V=O(k);F=G[V]&&G[V].pop()}return F?this.count--:F=new k,F},N.clear=function(){this._pool={},this.count=0},N._clean=function(k){k._renderComp=null},M}(w.default));w.default.register("assembler",R);var P=R;T.default=P,S.exports=T.default},{"../utils/pool":273}],224:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("./webgl/vertex-format"),B=(_=L("./assembler-pool"))&&_.__esModule?_:{default:_},A=function(){function O(){this._extendNative&&this._extendNative()}var R=O.prototype;return R.init=function(P){this._renderComp=P},R.updateRenderData=function(){},R.fillBuffers=function(){},R.getVfmt=function(){return w.vfmtPosUvColor},O}();T.default=A,A.register=function(O,R){O.__assembler__=R},A.init=function(O){for(var R=O.constructor,P=R.__assembler__;!P;){if(!(R=R.$super))return void cc.warn("Can not find assembler for render component : ["+cc.js.getClassName(O)+"]");P=R.__assembler__}if(P.getConstructor&&(P=P.getConstructor(O)),!O._assembler||O._assembler.constructor!==P){var E=B.default.get(P);E.init(O),O._assembler=E}},cc.Assembler=A,S.exports=T.default},{"./assembler-pool":223,"./webgl/vertex-format":260}],225:[function(L,S){var T=function(_){var w;try{w=_.getContext("2d")}catch(B){return void console.error(B)}this._canvas=_,this._ctx=w,this._caps={},this._stats={drawcalls:0},this._vx=this._vy=this._vw=this._vh=0,this._sx=this._sy=this._sw=this._sh=0};T.prototype._restoreTexture=function(){},T.prototype.setViewport=function(_,w,B,A){this._vx===_&&this._vy===w&&this._vw===B&&this._vh===A||(this._vx=_,this._vy=w,this._vw=B,this._vh=A)},T.prototype.setScissor=function(_,w,B,A){this._sx===_&&this._sy===w&&this._sw===B&&this._sh===A||(this._sx=_,this._sy=w,this._sw=B,this._sh=A)},T.prototype.clear=function(_){var w=this._ctx;w.clearRect(this._vx,this._vy,this._vw,this._vh),!_||_[0]===0&&_[1]===0&&_[2]===0||(w.fillStyle="rgb("+_[0]+","+_[1]+","+_[2]+")",w.globalAlpha=_[3],w.fillRect(this._vx,this._vy,this._vw,this._vh))},T.prototype.resetDrawCalls=function(){this._stats.drawcalls=0},T.prototype.getDrawCalls=function(){return this._stats.drawcalls},S.exports=T},{}],226:[function(L,S){var T=function(_,w){this._device=_,this._width=4,this._height=4,this._image=null,w&&(w.width!==void 0&&(this._width=w.width),w.height!==void 0&&(this._height=w.height),this.updateImage(w))};T.prototype.update=function(_){this.updateImage(_)},T.prototype.updateImage=function(_){if(_.images&&_.images[0]){var w=_.images[0];w&&w!==this._image&&(this._image=w)}},T.prototype.destroy=function(){this._image=null},S.exports=T},{}],227:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=A(L("../../renderer/gfx")),w=A(L("../../renderer/core/input-assembler")),B=A(L("../../renderer/core/pass"));function A(R){return R&&R.__esModule?R:{default:R}}var O=cc.renderer={Texture2D:null,InputAssembler:w.default,Pass:B.default,renderEngine:null,canvas:null,device:null,scene:null,drawCalls:0,_handle:null,_cameraNode:null,_camera:null,_forward:null,_flow:null,initWebGL:function(R,P){L("./webgl/assemblers");var E=L("./webgl/model-batcher");this.Texture2D=_.default.Texture2D,this.canvas=R,this._flow=cc.RenderFlow;var D=L("../../renderer/scene/scene"),I=L("../../renderer/renderers/forward-renderer");this.device=new _.default.Device(R,P),this.scene=new D;var M,N=(M=this.device,{defaultTexture:new _.default.Texture2D(M,{images:[],width:128,height:128,wrapS:_.default.WRAP_REPEAT,wrapT:_.default.WRAP_REPEAT,format:_.default.TEXTURE_FMT_RGB8,genMipmaps:!1}),programTemplates:[],programChunks:{}});this._forward=new I(this.device,N),this._handle=new E(this.device,this.scene),this._flow.init(this._handle,this._forward)},initCanvas:function(R){var P=L("./canvas"),E=L("./canvas/Texture2D"),D=L("./canvas/Device");this.Device=D,this.Texture2D=E,this.canvas=R,this.device=new D(R),this._camera={a:1,b:0,c:0,d:1,tx:0,ty:0},this._handle=new P.RenderComponentHandle(this.device,this._camera),this._forward=new P.ForwardRenderer,this._flow=cc.RenderFlow,this._flow.init(this._handle,this._forward)},updateCameraViewport:function(){if(cc.director){var R=cc.director.getScene();R&&R.setScale(1,1,1)}if(cc.game.renderType===cc.game.RENDER_TYPE_CANVAS){var P=cc.view.getViewportRect();this.device.setViewport(P.x,P.y,P.width,P.height),this._camera.a=cc.view.getScaleX(),this._camera.d=cc.view.getScaleY(),this._camera.tx=P.x,this._camera.ty=P.y+P.height}},render:function(R,P){this.device.resetDrawCalls(),R&&(this._flow.render(R,P),this.drawCalls=this.device.getDrawCalls())},clear:function(){this._handle.reset(),this._forward.clear()}};T.default=O,S.exports=T.default},{"../../renderer/core/input-assembler":309,"../../renderer/core/pass":310,"../../renderer/gfx":319,"../../renderer/renderers/forward-renderer":338,"../../renderer/scene/scene":341,"./canvas":void 0,"./canvas/Device":225,"./canvas/Texture2D":226,"./webgl/assemblers":239,"./webgl/model-batcher":256}],228:[function(L,S){var T,_,w=0,B=1<<w++,A=1<<w++,O=1<<w++,R=1<<w++,P=O|R,E=1<<w++,D=1<<w++,I=1<<w++,M=D|I,N=1<<w++,k=1<<w++,F=1<<w++,G=1<<w++,V=0;function j(){this._func=W,this._next=null}var H=j.prototype;H._doNothing=function(){},H._localTransform=function(Q){Q._updateLocalMatrix(),Q._renderFlag&=~O,this._next._func(Q)},H._worldTransform=function(Q){T.worldMatDirty++;var ee=Q._matrix,te=Q._trs,re=ee.m;re[12]=te[0],re[13]=te[1],re[14]=te[2],Q._mulMat(Q._worldMatrix,Q._parent._worldMatrix,ee),Q._renderFlag&=~R,this._next._func(Q),T.worldMatDirty--},H._updateRenderData=function(Q){var ee=Q._renderComponent;ee._assembler.updateRenderData(ee),Q._renderFlag&=~E,this._next._func(Q)},H._opacity=function(Q){T.parentOpacityDirty++,this._next._func(Q),Q._renderFlag&=~D,T.parentOpacityDirty--},H._color=function(Q){var ee=Q._renderComponent;ee&&ee._updateColor(),Q._renderFlag&=~I,this._next._func(Q)},H._render=function(Q){var ee=Q._renderComponent;ee._checkBacth(T,Q._cullingMask),ee._assembler.fillBuffers(ee,T),this._next._func(Q)},H._children=function(Q){for(var ee=V,te=T,re=te.parentOpacity,ie=te.parentOpacity*=Q._opacity/255,ne=(te.worldMatDirty?R:0)|(te.parentOpacityDirty?M:0),he=Q._children,pe=0,K=he.length;pe<K;pe++){var ue=he[pe];if(ue._renderFlag|=ne,ue._activeInHierarchy&&ue._opacity!==0){V=ue._cullingMask=ue.groupIndex===0?ee:1<<ue.groupIndex;var le=ue._color._val;ue._color._fastSetA(ue._opacity*ie),X[ue._renderFlag]._func(ue),ue._color._val=le}}te.parentOpacity=re,this._next._func(Q)},H._postRender=function(Q){var ee=Q._renderComponent;ee._checkBacth(T,Q._cullingMask),ee._assembler.postFillBuffers(ee,T),this._next._func(Q)};var U=new j;U._func=U._doNothing,U._next=U;var X={};function Y(Q,ee){if(Q===B||Q===A)return U;var te=new j;switch(te._next=ee||U,Q){case O:te._func=te._localTransform;break;case R:te._func=te._worldTransform;break;case E:te._func=te._updateRenderData;break;case D:te._func=te._opacity;break;case I:te._func=te._color;break;case N:te._func=te._render;break;case k:te._func=te._children;break;case F:te._func=te._postRender}return te}function z(Q){for(var ee=null,te=G;te>0;)te&Q&&(ee=Y(te,ee)),te>>=1;return ee}function W(Q){var ee=Q._renderFlag;(X[ee]=z(ee))._func(Q)}j.flows=X,j.createFlow=Y;var Z=[];j.registerValidate=function(Q){Q._inValidateList||(Z.push(Q),Q._inValidateList=!0)},j.validateRenderers=function(){for(var Q=0,ee=Z.length;Q<ee;Q++){var te=Z[Q];te.isValid&&(te.enabledInHierarchy?te._validateRender():te.disableRender(),te._inValidateList=!1)}Z.length=0},j.visitRootNode=function(Q){j.validateRenderers();var ee=V;V=Q._cullingMask,Q._renderFlag&R?(T.worldMatDirty++,Q._calculWorldMatrix(),Q._renderFlag&=~R,X[Q._renderFlag]._func(Q),T.worldMatDirty--):X[Q._renderFlag]._func(Q),V=ee},j.render=function(Q,ee){T.reset(),T.walking=!0,j.visitRootNode(Q),T.terminate(),T.walking=!1,_.render(T._renderScene,ee)},j.renderCamera=function(Q,ee){T.reset(),T.walking=!0,j.visitRootNode(ee),T.terminate(),T.walking=!1,_.renderCamera(Q,T._renderScene)},j.init=function(Q,ee){T=Q,_=ee,X[0]=U;for(var te=1;te<G;te++)X[te]=new j},j.getBachther=function(){return T},j.FLAG_DONOTHING=B,j.FLAG_BREAK_FLOW=A,j.FLAG_LOCAL_TRANSFORM=O,j.FLAG_WORLD_TRANSFORM=R,j.FLAG_TRANSFORM=P,j.FLAG_UPDATE_RENDER_DATA=E,j.FLAG_OPACITY=D,j.FLAG_COLOR=I,j.FLAG_OPACITY_COLOR=M,j.FLAG_RENDER=N,j.FLAG_CHILDREN=k,j.FLAG_POST_RENDER=F,j.FLAG_FINAL=G,S.exports=cc.RenderFlow=j},{}],229:[function(L,S){var T=L("../../../assets/CCRenderTexture"),_=2;function w(B,A){var O=new T;O.initWithSize(B,A),O.update(),this._texture=O,this._x=_,this._y=_,this._nexty=_,this._width=B,this._height=A,this._innerTextureInfos={},this._innerSpriteFrames=[],this._count=0}w.DEFAULT_HASH=new T()._getHash(),cc.js.mixin(w.prototype,{insertSpriteFrame:function(B){var A=B._rect,O=B._texture,R=this._innerTextureInfos[O._id],P=A.x,E=A.y;if(R)P+=R.x,E+=R.y;else{var D=O.width,I=O.height;if(this._x+D+_>this._width&&(this._x=_,this._y=this._nexty),this._y+I+_>this._nexty&&(this._nexty=this._y+I+_),this._nexty>this._height)return null;cc.dynamicAtlasManager.textureBleeding&&((D<=8||I<=8)&&(this._texture.drawTextureAt(O,this._x-1,this._y-1),this._texture.drawTextureAt(O,this._x-1,this._y+1),this._texture.drawTextureAt(O,this._x+1,this._y-1),this._texture.drawTextureAt(O,this._x+1,this._y+1)),this._texture.drawTextureAt(O,this._x-1,this._y),this._texture.drawTextureAt(O,this._x+1,this._y),this._texture.drawTextureAt(O,this._x,this._y-1),this._texture.drawTextureAt(O,this._x,this._y+1)),this._texture.drawTextureAt(O,this._x,this._y),this._innerTextureInfos[O._id]={x:this._x,y:this._y,texture:O},this._count++,P+=this._x,E+=this._y,this._x+=D+_,this._dirty=!0}var M={x:P,y:E,texture:this._texture};return this._innerSpriteFrames.push(B),M},update:function(){this._dirty&&(this._texture.update(),this._dirty=!1)},deleteInnerTexture:function(B){B&&this._innerTextureInfos[B._id]&&(delete this._innerTextureInfos[B._id],this._count--)},isEmpty:function(){return this._count<=0},reset:function(){this._x=_,this._y=_,this._nexty=_;for(var B=this._innerSpriteFrames,A=0,O=B.length;A<O;A++){var R=B[A];R.isValid&&R._resetDynamicAtlasFrame()}this._innerSpriteFrames.length=0,this._innerTextureInfos={}},destroy:function(){this.reset(),this._texture.destroy()}}),S.exports=w},{"../../../assets/CCRenderTexture":70}],230:[function(L,S){var T=L("./atlas"),_=[],w=-1,B=5,A=2048,O=512,R=!0,P=null;function E(){var N=_[++w];return N||(N=new T(A,A),_.push(N)),N}function D(){M.reset()}var I=!1,M={Atlas:T,get enabled(){return I},set enabled(N){I!==N&&(N?(this.reset(),cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,D)):cc.director.off(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,D),I=N)},get maxAtlasCount(){return B},set maxAtlasCount(N){B=N},get atlasCount(){return _.length},get textureBleeding(){return R},set textureBleeding(N){R=N},get textureSize(){return A},set textureSize(N){A=N},get maxFrameSize(){return O},set maxFrameSize(N){O=N},insertSpriteFrame:function(N){if(!I||w===B||!N||N._original||!N._texture.packable)return null;var k=_[w];k||(k=E());var F=k.insertSpriteFrame(N);return F||w===B?F:(k=E()).insertSpriteFrame(N)},reset:function(){for(var N=0,k=_.length;N<k;N++)_[N].destroy();_.length=0,w=-1},deleteAtlasSpriteFrame:function(N){if(N._original){var k=N._original._texture;this.deleteAtlasTexture(k)}},deleteAtlasTexture:function(N){if(N)for(var k=_.length-1;k>=0;k--)_[k].deleteInnerTexture(N),_[k].isEmpty()&&(_[k].destroy(),_.splice(k,1),w--)},showDebug:function(N){if(N){if(!P||!P.isValid){var k=cc.visibleRect.width,F=cc.visibleRect.height;(P=new cc.Node("DYNAMIC_ATLAS_DEBUG_NODE")).width=k,P.height=F,P.x=k/2,P.y=F/2,P.zIndex=cc.macro.MAX_ZINDEX,P.parent=cc.director.getScene(),P.groupIndex=cc.Node.BuiltinGroupIndex.DEBUG,cc.Camera._setupDebugCamera();var G=P.addComponent(cc.ScrollView),V=new cc.Node("CONTENT"),j=V.addComponent(cc.Layout);j.type=cc.Layout.Type.VERTICAL,j.resizeMode=cc.Layout.ResizeMode.CONTAINER,V.parent=P,V.width=A,V.anchorY=1,V.x=A,G.content=V;for(var H=0;H<=w;H++){var U=new cc.Node("ATLAS"),X=(_[H]._texture,new cc.SpriteFrame);X.setTexture(_[H]._texture),U.addComponent(cc.Sprite).spriteFrame=X,U.parent=V}}return P}P&&(P.parent=null,P=null)},update:function(){if(this.enabled)for(var N=0;N<=w;N++)_[N].update()}};S.exports=cc.dynamicAtlasManager=M},{"./atlas":229}],231:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../assembler-2d"))&&_.__esModule?_:{default:_};function B(_e,oe){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(de,me){return de.__proto__=me,de})(_e,oe)}var A=L("../../../utils/text-utils"),O=L("../../../platform/CCMacro"),R=L("../../../components/CCLabel").Overflow,P=L("../utils").shareLabelInfo,E=function(){this.char="",this.valid=!0,this.x=0,this.y=0,this.line=0,this.hash=""},D=cc.rect(),I=null,M=[],N=[],k=[],F=[],G=null,V=0,j=0,H=0,U=0,X=0,Y=1,z=null,W=cc.size(),Z="",Q=0,ee=0,te=0,re=0,ie=0,ne=0,he=0,pe=!1,K=0,ue=0,le=0,ce=function(_e){var oe,de;function me(){return _e.apply(this,arguments)||this}de=_e,(oe=me).prototype=Object.create(de.prototype),oe.prototype.constructor=oe,B(oe,de);var ye=me.prototype;return ye.updateRenderData=function(ge){ge._vertsDirty&&I!==ge&&(I=ge,this._reserveQuads(ge,ge.string.toString().length),this._updateFontFamily(ge),this._updateProperties(ge),this._updateLabelInfo(ge),this._updateContent(),this.updateWorldVerts(ge),I._actualFontSize=Q,I.node.setContentSize(W),I._vertsDirty=!1,I=null,this._resetProperties())},ye._updateFontScale=function(){Y=Q/ee},ye._updateFontFamily=function(ge){var we=ge.font;z=we.spriteFrame,G=we._fntConfig,P.fontAtlas=we._fontDefDictionary,this.packToDynamicAtlas(ge,z)},ye._updateLabelInfo=function(){P.hash="",P.margin=0},ye._updateProperties=function(ge){Z=ge.string.toString(),Q=ge.fontSize,ee=G?G.fontSize:ge.fontSize,te=ge.horizontalAlign,re=ge.verticalAlign,ie=ge.spacingX,he=ge.overflow,ne=ge._lineHeight,W.width=ge.node.width,W.height=ge.node.height,he===R.NONE?(pe=!1,W.width+=2*P.margin,W.height+=2*P.margin):he===R.RESIZE_HEIGHT?(pe=!0,W.height+=2*P.margin):pe=ge.enableWrapText,P.lineHeight=ne,P.fontSize=Q,this._setupBMFontOverflowMetrics()},ye._resetProperties=function(){G=null,z=null,P.hash="",P.margin=0},ye._updateContent=function(){this._updateFontScale(),this._computeHorizontalKerningForText(),this._alignText()},ye._computeHorizontalKerningForText=function(){var ge,we=Z,Te=we.length,Ee=M;if(G&&(ge=G.kerningDict),ge&&!cc.js.isEmptyObject(ge))for(var De=-1,fe=0;fe<Te;++fe){var Ce=we.charCodeAt(fe),Se=ge[De<<16|65535&Ce]||0;Ee[fe]=fe<Te-1?Se:0,De=Ce}else Ee.length=0},ye._multilineTextWrap=function(ge){for(var we=Z.length,Te=0,Ee=0,De=0,fe=0,Ce=0,Se=0,be=0,Re=null,Ve=cc.v2(0,0),Pe=0;Pe<we;){var ke=Z.charAt(Pe);if(ke!=="\n"){for(var Ne=ge(Z,Pe,we),Ae=Se,Oe=be,Fe=Ce,nt=Ee,Ze=!1,Xe=0;Xe<Ne;++Xe){var $e=Pe+Xe;if((ke=Z.charAt($e))!=="\r")if(Re=P.fontAtlas.getLetterDefinitionForChar(ke,P)){var ot=nt+Re.offsetX*Y-P.margin;if(pe&&le>0&&Ee>0&&ot+Re.w*Y>le&&!A.isUnicodeSpace(ke)){k.push(Ce),Ce=0,Te++,Ee=0,De-=ne*this._getFontScale()+0,Ze=!0;break}Ve.x=ot,Ve.y=De-Re.offsetY*Y+P.margin,this._recordLetterInfo(Ve,ke,$e,Te),$e+1<M.length&&$e<we-1&&(nt+=M[$e+1]),nt+=Re.xAdvance*Y+ie-2*P.margin,Fe=Ve.x+Re.w*Y-P.margin,Ae<Ve.y&&(Ae=Ve.y),Oe>Ve.y-Re.h*Y&&(Oe=Ve.y-Re.h*Y)}else{this._recordPlaceholderInfo($e,ke);var ut="";G&&(ut=G.atlasName),console.log("Can't find letter definition in texture atlas "+ut+" for letter:"+ke)}else this._recordPlaceholderInfo($e,ke)}Ze||(Ee=nt,Se<Ae&&(Se=Ae),be>Oe&&(be=Oe),fe<(Ce=Fe)&&(fe=Ce),Pe+=Ne)}else k.push(Ce),Ce=0,Te++,Ee=0,De-=ne*this._getFontScale()+0,this._recordPlaceholderInfo(Pe,ke),Pe++}return k.push(Ce),j=(V=Te+1)*ne*this._getFontScale(),V>1&&(j+=0*(V-1)),W.width=K,W.height=ue,K<=0&&(W.width=parseFloat(fe.toFixed(2))+2*P.margin),ue<=0&&(W.height=parseFloat(j.toFixed(2))+2*P.margin),U=W.height,X=0,he!==R.CLAMP&&(Se>0&&(U=W.height+Se),be<-j&&(X=j+be)),!0},ye._getFirstCharLen=function(){return 1},ye._getFontScale=function(){return he===R.SHRINK?Y:1},ye._getFirstWordLen=function(ge,we,Te){var Ee=ge.charAt(we);if(A.isUnicodeCJK(Ee)||Ee==="\n"||A.isUnicodeSpace(Ee))return 1;var De=1,fe=P.fontAtlas.getLetterDefinitionForChar(Ee,P);if(!fe)return De;for(var Ce=fe.xAdvance*Y+ie,Se=we+1;Se<Te&&(Ee=ge.charAt(Se),fe=P.fontAtlas.getLetterDefinitionForChar(Ee,P));++Se){if(Ce+fe.offsetX*Y+fe.w*Y>le&&!A.isUnicodeSpace(Ee)&&le>0)return De;if(Ce+=fe.xAdvance*Y+ie,Ee==="\n"||A.isUnicodeSpace(Ee)||A.isUnicodeCJK(Ee))break;De++}return De},ye._multilineTextWrapByWord=function(){return this._multilineTextWrap(this._getFirstWordLen)},ye._multilineTextWrapByChar=function(){return this._multilineTextWrap(this._getFirstCharLen)},ye._recordPlaceholderInfo=function(ge,we){if(ge>=N.length){var Te=new E;N.push(Te)}N[ge].char=we,N[ge].hash=we.charCodeAt(0)+P.hash,N[ge].valid=!1},ye._recordLetterInfo=function(ge,we,Te,Ee){if(Te>=N.length){var De=new E;N.push(De)}var fe=we.charCodeAt(0)+P.hash;N[Te].line=Ee,N[Te].char=we,N[Te].hash=fe,N[Te].valid=P.fontAtlas.getLetter(fe).valid,N[Te].x=ge.x,N[Te].y=ge.y},ye._alignText=function(){j=0,k.length=0,this._multilineTextWrapByWord(),this._computeAlignmentOffset(),he===R.SHRINK&&Q>0&&this._isVerticalClamp()&&this._shrinkLabelToContentSize(this._isVerticalClamp),this._updateQuads()||he===R.SHRINK&&this._shrinkLabelToContentSize(this._isHorizontalClamp)},ye._scaleFontSizeDown=function(ge){var we=!0;ge||(ge=.1,we=!1),Q=ge,we&&this._updateContent()},ye._shrinkLabelToContentSize=function(ge){for(var we=0,Te=0|Q,Ee=0;we<Te;){var De=Ee=we+Te+1>>1;if(De<=0)break;Y=De/ee,this._multilineTextWrapByWord(),this._computeAlignmentOffset(),ge()?Te=Ee-1:we=Ee}var fe=we;fe>=0&&this._scaleFontSizeDown(fe)},ye._isVerticalClamp=function(){return j>W.height},ye._isHorizontalClamp=function(){for(var ge=!1,we=0,Te=Z.length;we<Te;++we){var Ee=N[we];if(Ee.valid){var De=P.fontAtlas.getLetter(Ee.hash),fe=Ee.x+De.w*Y,Ce=Ee.line;if(K>0){if(pe){if(k[Ce]>W.width&&(fe>W.width||fe<0)){ge=!0;break}}else if(fe>W.width){ge=!0;break}}}}return ge},ye._isHorizontalClamped=function(ge,we){var Te=k[we],Ee=ge>W.width||ge<0;return pe?Te>W.width&&Ee:Ee},ye._updateQuads=function(){var ge=z?z._texture:P.fontAtlas.getTexture(),we=I.node;this.verticesCount=this.indicesCount=0,this._renderData&&(this._renderData.dataLength=0);for(var Te=W,Ee=we._anchorPoint.x*Te.width,De=we._anchorPoint.y*Te.height,fe=!0,Ce=0,Se=Z.length;Ce<Se;++Ce){var be=N[Ce];if(be.valid){var Re=P.fontAtlas.getLetter(be.hash);D.height=Re.h,D.width=Re.w,D.x=Re.u,D.y=Re.v;var Ve=be.y+H;if(ue>0){if(Ve>U){var Pe=Ve-U;D.y+=Pe,D.height-=Pe,Ve-=Pe}Ve-Re.h*Y<X&&he===R.CLAMP&&(D.height=Ve<X?0:(Ve-X)/Y)}var ke=be.line,Ne=be.x+Re.w/2*Y+F[ke];if(K>0&&this._isHorizontalClamped(Ne,ke)){if(he===R.CLAMP)D.width=0;else if(he===R.SHRINK){if(W.width>Re.w){fe=!1;break}D.width=0}}if(D.height>0&&D.width>0){var Ae=this._determineRect(D),Oe=be.x+F[be.line];this.appendQuad(I,ge,D,Ae,Oe-Ee,Ve-De,Y)}}}return this._quadsUpdated(I),fe},ye._determineRect=function(ge){var we=z.isRotated(),Te=z._originalSize,Ee=z._rect,De=z._offset,fe=De.x+(Te.width-Ee.width)/2,Ce=De.y-(Te.height-Ee.height)/2;if(we){var Se=ge.x;ge.x=Ee.x+Ee.height-ge.y-ge.height-Ce,ge.y=Se+Ee.y-fe,ge.y<0&&(ge.height=ge.height+Ce)}else ge.x+=Ee.x-fe,ge.y+=Ee.y+Ce;return we},ye._computeAlignmentOffset=function(){switch(F.length=0,te){case O.TextAlignment.LEFT:for(var ge=0;ge<V;++ge)F.push(0);break;case O.TextAlignment.CENTER:for(var we=0,Te=k.length;we<Te;we++)F.push((W.width-k[we])/2);break;case O.TextAlignment.RIGHT:for(var Ee=0,De=k.length;Ee<De;Ee++)F.push(W.width-k[Ee])}if(H=W.height,re!==O.VerticalTextAlignment.TOP){var fe=W.height-j+ne*this._getFontScale()-ee*Y;re===O.VerticalTextAlignment.BOTTOM?H-=fe:H-=fe/2}},ye._setupBMFontOverflowMetrics=function(){var ge=W.width,we=W.height;he===R.RESIZE_HEIGHT&&(we=0),he===R.NONE&&(ge=0,we=0),K=ge,ue=we,le=ge},ye.updateWorldVerts=function(){},ye.appendQuad=function(){},ye._quadsUpdated=function(){},ye._reserveQuads=function(){},me}(w.default);T.default=ce,S.exports=T.default},{"../../../components/CCLabel":108,"../../../platform/CCMacro":201,"../../../utils/text-utils":278,"../../assembler-2d":222,"../utils":235}],232:[function(L,S){function T(){this._rect=null,this.uv=[],this._texture=null,this._original=null}T.prototype={constructor:T,getRect:function(){return cc.rect(this._rect)},setRect:function(_){this._rect=_,this._texture&&this._calculateUV()},_setDynamicAtlasFrame:function(_){_&&(this._original={_texture:this._texture,_x:this._rect.x,_y:this._rect.y},this._texture=_.texture,this._rect.x=_.x,this._rect.y=_.y,this._calculateUV())},_resetDynamicAtlasFrame:function(){this._original&&(this._rect.x=this._original._x,this._rect.y=this._original._y,this._texture=this._original._texture,this._original=null,this._calculateUV())},_refreshTexture:function(_){this._texture=_,this._rect=cc.rect(0,0,_.width,_.height),this._calculateUV()},_calculateUV:function(){var _=this._rect,w=this._texture,B=this.uv,A=w.width,O=w.height,R=A===0?0:_.x/A,P=A===0?0:(_.x+_.width)/A,E=O===0?0:(_.y+_.height)/O,D=O===0?0:_.y/O;B[0]=R,B[1]=E,B[2]=P,B[3]=E,B[4]=R,B[5]=D,B[6]=P,B[7]=D}},S.exports=T},{}],233:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../webgl/assemblers/label/2d/bmfont"))&&_.__esModule?_:{default:_};function B(Y,z){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(W,Z){return W.__proto__=Z,W})(Y,z)}var A=L("../../../components/CCLabel"),O=L("../../../components/CCLabelOutline"),R=L("../../../utils/text-utils"),P=L("../../../components/CCComponent"),E=L("../../../assets/CCRenderTexture"),D=cc.js.isChildClassOf(O,P),I=L("../utils").getFontFamily,M=L("../utils").shareLabelInfo,N=cc.BitmapFont.FontLetterDefinition,k=cc.BitmapFont.FontAtlas,F=cc.Color.WHITE,G=0,V=(1/255).toFixed(3);function j(Y,z){this._texture=null,this._labelInfo=z,this._char=Y,this._hash=null,this._data=null,this._canvas=null,this._context=null,this._width=0,this._height=0,this._offsetY=0,this._hash=Y.charCodeAt(0)+z.hash}function H(Y,z){var W=new E;W.initWithSize(Y,z),W.update(),this._fontDefDictionary=new k(W),this._x=G,this._y=G,this._nexty=G,this._width=Y,this._height=z,cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,this.beforeSceneLoad,this)}j.prototype={constructor:j,updateRenderData:function(){this._updateProperties(),this._updateTexture()},_updateProperties:function(){this._texture=new cc.Texture2D,this._data=A._canvasPool.get(),this._canvas=this._data.canvas,this._context=this._data.context,this._context.font=this._labelInfo.fontDesc;var Y=R.safeMeasureText(this._context,this._char,this._labelInfo.fontDesc),z=2*this._labelInfo.margin+2;this._width=parseFloat(Y.toFixed(2))+z,this._height=(1+R.BASELINE_RATIO)*this._labelInfo.fontSize+z,this._offsetY=-this._labelInfo.fontSize*R.BASELINE_RATIO/2,this._canvas.width!==this._width&&(this._canvas.width=this._width),this._canvas.height!==this._height&&(this._canvas.height=this._height),this._texture.initWithElement(this._canvas)},_updateTexture:function(){var Y=this._context,z=this._labelInfo,W=this._canvas.width,Z=this._canvas.height,Q=this._labelInfo.fontSize,ee=W/2,te=Z/2+Q*R.MIDDLE_RATIO+Q*R.BASELINE_OFFSET,re=z.color;if(Y.lineJoin="round",Y.textAlign="center",Y.clearRect(0,0,W,Z),Y.fillStyle="rgba("+re.r+", "+re.g+", "+re.b+", "+V+")",Y.fillRect(0,0,W,Z),Y.font=z.fontDesc,Y.fillStyle="rgba("+re.r+", "+re.g+", "+re.b+", 1)",z.isOutlined&&z.margin>0){var ie=z.out||F;Y.strokeStyle="rgba("+ie.r+", "+ie.g+", "+ie.b+", "+ie.a/255+")",Y.lineWidth=2*z.margin,Y.strokeText(this._char,ee,te)}Y.fillText(this._char,ee,te),this._texture.handleLoadedTexture()},destroy:function(){this._texture.destroy(),this._texture=null,A._canvasPool.put(this._data)}},cc.js.mixin(H.prototype,{insertLetterTexture:function(Y){var z=Y._texture,W=z.width,Z=z.height;if(this._x+W+G>this._width&&(this._x=G,this._y=this._nexty),this._y+Z>this._nexty&&(this._nexty=this._y+Z+G),this._nexty>this._height)return null;this._fontDefDictionary._texture.drawTextureAt(z,this._x,this._y),this._dirty=!0;var Q=new N;return Q.u=this._x+1,Q.v=this._y+1,Q.texture=this._fontDefDictionary._texture,Q.valid=!0,Q.w=Y._width-2,Q.h=Y._height-2,Q.xAdvance=Q.w,Q.offsetY=Y._offsetY,this._x+=W+G,this._fontDefDictionary.addLetterDefinitions(Y._hash,Q),Q},update:function(){this._dirty&&(this._fontDefDictionary._texture.update(),this._dirty=!1)},reset:function(){this._x=G,this._y=G,this._nexty=G;for(var Y=this._fontDefDictionary._letterDefinitions,z=0,W=Y.length;z<W;z++){var Z=Y[z];Z.isValid&&Z.destroy()}this._fontDefDictionary.clear()},destroy:function(){this.reset(),this._fontDefDictionary._texture.destroy(),this._fontDefDictionary._texture=null},beforeSceneLoad:function(){this.clearAllCache()},clearAllCache:function(){this.destroy();var Y=new E;Y.initWithSize(this._width,this._height),Y.update(),this._fontDefDictionary._texture=Y},getLetter:function(Y){return this._fontDefDictionary._letterDefinitions[Y]},getTexture:function(){return this._fontDefDictionary.getTexture()},getLetterDefinitionForChar:function(Y,z){var W=Y.charCodeAt(0)+z.hash,Z=this._fontDefDictionary._letterDefinitions[W];if(!Z){var Q=new j(Y,z);Q.updateRenderData(),Z=this.insertLetterTexture(Q),Q.destroy()}return Z}});var U=null,X=function(Y){var z,W;function Z(){return Y.apply(this,arguments)||this}W=Y,(z=Z).prototype=Object.create(W.prototype),z.prototype.constructor=z,B(z,W);var Q=Z.prototype;return Q._getAssemblerData=function(){return U||(U=new H(2048,2048),cc.Label._shareAtlas=U),U.getTexture()},Q._updateFontFamily=function(ee){M.fontAtlas=U,M.fontFamily=I(ee);var te=D&&ee.getComponent(O);te&&te.enabled?(M.isOutlined=!0,M.margin=te.width,M.out=te.color.clone(),M.out.a=te.color.a*ee.node.color.a/255):(M.isOutlined=!1,M.margin=0)},Q._updateLabelInfo=function(ee){var te,re,ie;M.fontDesc=this._getFontDesc(),M.color=ee.node.color,M.hash=(re=(te=M).color.toHEX(),ie="",te.isOutlined&&te.margin>0&&(ie=ie+te.margin+te.out.toHEX()),""+te.fontSize+te.fontFamily+re+ie)},Q._getFontDesc=function(){return M.fontSize.toString()+"px "+M.fontFamily},Q._computeHorizontalKerningForText=function(){},Q._determineRect=function(){return!1},Z}(w.default);T.default=X,S.exports=T.default},{"../../../assets/CCRenderTexture":70,"../../../components/CCComponent":106,"../../../components/CCLabel":108,"../../../components/CCLabelOutline":109,"../../../utils/text-utils":278,"../../webgl/assemblers/label/2d/bmfont":240,"../utils":235}],234:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../assembler-2d"))&&_.__esModule?_:{default:_};function B(De,fe){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Ce,Se){return Ce.__proto__=Se,Ce})(De,fe)}var A,O=L("../../../utils/text-utils"),R=L("../../../platform/CCMacro"),P=L("../../../components/CCLabel"),E=L("../../../components/CCLabelOutline"),D=L("../../../components/CCLabelShadow"),I=P.Overflow,M=L("../utils").deleteFromDynamicAtlas,N=L("../utils").getFontFamily,k=(1/255).toFixed(3),F=null,G=null,V=null,j="",H="",U=0,X=0,Y=[],z=cc.Size.ZERO,W=0,Z=0,Q=0,ee=null,te="",re=I.NONE,ie=!1,ne=!1,he=null,pe=cc.Color.WHITE,K=null,ue=cc.Color.BLACK,le=cc.rect(),ce=cc.Size.ZERO,_e=cc.Size.ZERO,oe=!1,de=!1,me=!1,ye=0,ge=cc.Vec2.ZERO,we=0,Te=["left","center","right"],Ee=function(De){var fe,Ce;function Se(){return De.apply(this,arguments)||this}Ce=De,(fe=Se).prototype=Object.create(Ce.prototype),fe.prototype.constructor=fe,B(fe,Ce);var be=Se.prototype;return be._getAssemblerData=function(){return(A=P._canvasPool.get()).canvas.width=A.canvas.height=1,A},be._resetAssemblerData=function(Re){Re&&P._canvasPool.put(Re)},be.updateRenderData=function(Re){De.prototype.updateRenderData.call(this,Re),Re._vertsDirty&&(this._updateProperties(Re),this._calculateLabelFont(),this._updateLabelDimensions(),this._updateTexture(Re),this._calDynamicAtlas(Re),Re._actualFontSize=U,Re.node.setContentSize(_e),this.updateVerts(Re),Re._vertsDirty=!1,F=null,G=null,V=null)},be.updateVerts=function(){},be._updatePaddingRect=function(){var Re=0,Ve=0,Pe=0,ke=0,Ne=0;if(ce.width=ce.height=0,he&&(Re=Ve=Pe=ke=Ne=he.width,ce.width=ce.height=2*Ne),K){var Ae=K.blur+Ne;Pe=Math.max(Pe,-K._offset.x+Ae),ke=Math.max(ke,K._offset.x+Ae),Re=Math.max(Re,K._offset.y+Ae),Ve=Math.max(Ve,-K._offset.y+Ae)}if(de){var Oe=X*Math.tan(.20943951);ke+=Oe,ce.width+=Oe}le.x=Pe,le.y=Re,le.width=Pe+ke,le.height=Re+Ve},be._updateProperties=function(Re){var Ve=Re._assemblerData;F=Ve.context,G=Ve.canvas,V=Re._frame._original?Re._frame._original._texture:Re._frame._texture,H=Re.string.toString(),U=Re._fontSize,X=U,ye=Re.underlineHeight||X/8,re=Re.overflow,z.width=Re.node.width,z.height=Re.node.height,_e=Re.node.getContentSize(),W=Re._lineHeight,Z=Re.horizontalAlign,Q=Re.verticalAlign,ee=Re.node.color,oe=Re.enableBold,de=Re.enableItalic,me=Re.enableUnderline,te=N(Re),ne=Re.srcBlendFactor===cc.macro.BlendFactor.ONE,ie=re!==I.NONE&&(re===I.RESIZE_HEIGHT||Re.enableWrapText),(he=(he=E&&Re.getComponent(E))&&he.enabled&&he.width>0?he:null)&&pe.set(he.color),(K=(K=D&&Re.getComponent(D))&&K.enabled?K:null)&&(ue.set(K.color),ue.a=ue.a*Re.node.color.a/255),this._updatePaddingRect()},be._calculateFillTextStartPosition=function(){var Re=0;Z===R.TextAlignment.RIGHT?Re=z.width-le.width:Z===R.TextAlignment.CENTER&&(Re=(z.width-le.width)/2);var Ve=this._getLineHeight()*(Y.length-1),Pe=U*(1-O.BASELINE_RATIO/2);if(Q!==R.VerticalTextAlignment.TOP){var ke=Ve+le.height+U-z.height;Q===R.VerticalTextAlignment.BOTTOM?Pe-=ke+=O.BASELINE_RATIO/2*U:Pe-=ke/2}return Pe+=O.BASELINE_OFFSET*U,cc.v2(Re+le.x,Pe+le.y)},be._setupOutline=function(){F.strokeStyle="rgba("+pe.r+", "+pe.g+", "+pe.b+", "+pe.a/255+")",F.lineWidth=2*he.width},be._setupShadow=function(){F.shadowColor="rgba("+ue.r+", "+ue.g+", "+ue.b+", "+ue.a/255+")",F.shadowBlur=K.blur,F.shadowOffsetX=K.offset.x,F.shadowOffsetY=-K.offset.y},be._drawTextEffect=function(Re,Ve){if(K||he||me){var Pe=Y.length>1&&K,ke=this._measureText(F,j),Ne=0,Ae=0;K&&this._setupShadow(),he&&this._setupOutline();for(var Oe=0;Oe<Y.length;++Oe)Ne=Re.x,Ae=Re.y+Oe*Ve,Pe&&(he&&F.strokeText(Y[Oe],Ne,Ae),F.fillText(Y[Oe],Ne,Ae)),me&&(we=ke(Y[Oe]),Z===R.TextAlignment.RIGHT?ge.x=Re.x-we:Z===R.TextAlignment.CENTER?ge.x=Re.x-we/2:ge.x=Re.x,ge.y=Ae+X/8,F.fillRect(ge.x,ge.y,we,ye));Pe&&(F.shadowColor="transparent")}},be._updateTexture=function(){if(F.clearRect(0,0,G.width,G.height),F.lineJoin="round",ne)F.fillStyle="rgba("+ee.r+", "+ee.g+", "+ee.b+", "+ee.a/255+")";else{var Re=he?pe:ee;F.fillStyle="rgba("+Re.r+", "+Re.g+", "+Re.b+", "+k+")",F.fillRect(0,0,G.width,G.height),F.fillStyle="rgba("+ee.r+", "+ee.g+", "+ee.b+", 1)"}var Ve=this._calculateFillTextStartPosition(),Pe=this._getLineHeight(),ke=Ve.x,Ne=0;this._drawTextEffect(Ve,Pe);for(var Ae=0;Ae<Y.length;++Ae)Ne=Ve.y+Ae*Pe,he&&F.strokeText(Y[Ae],ke,Ne),F.fillText(Y[Ae],ke,Ne);K&&(F.shadowColor="transparent"),V.handleLoadedTexture()},be._calDynamicAtlas=function(Re){if(Re.cacheMode===P.CacheMode.BITMAP){var Ve=Re._frame;M(Re,Ve),Ve._original||Ve.setRect(cc.rect(0,0,G.width,G.height)),this.packToDynamicAtlas(Re,Ve)}},be._updateLabelDimensions=function(){var Re=cc.renderer.device.caps?cc.renderer.device.caps.maxTextureSize:2048;(z.width>Re||z.height>Re)&&cc.warn("The maximum texture size supported by the device is "+Re),z.width=Math.min(z.width,Re),z.height=Math.min(z.height,Re);var Ve=!1;G.width!==z.width&&(G.width=z.width,Ve=!0),G.height!==z.height&&(G.height=z.height,Ve=!0),Ve&&(F.font=j),F.textAlign=Te[Z]},be._getFontDesc=function(){var Re=U.toString()+"px ";return Re+=te,oe&&(Re="bold "+Re),de&&(Re="italic "+Re),Re},be._getLineHeight=function(){return 0|(W===0?U:W*U/X)},be._calculateParagraphLength=function(Re,Ve){for(var Pe=[],ke=0;ke<Re.length;++ke){var Ne=O.safeMeasureText(Ve,Re[ke],j);Pe.push(Ne)}return Pe},be._measureText=function(Re,Ve){return function(Pe){return O.safeMeasureText(Re,Pe,Ve)}},be._calculateShrinkFont=function(Re){var Ve=this._calculateParagraphLength(Re,F),Pe=0,ke=0,Ne=0;if(ie){var Ae=_e.width,Oe=_e.height;if(Ae<0||Oe<0)return;ke=Oe+1;for(var Fe=0,nt=0|U+1,Ze=0;Fe<nt;){if((Ze=Fe+nt+1>>1)<=0){cc.logID(4003);break}U=Ze,j=this._getFontDesc(),F.font=j;var Xe=this._getLineHeight();for(ke=0,Pe=0;Pe<Re.length;++Pe){var $e=O.safeMeasureText(F,Re[Pe],j);ke+=O.fragmentText(Re[Pe],$e,Ae,this._measureText(F,j)).length*Xe}ke>Oe?nt=Ze-1:Fe=Ze}Fe===0?cc.logID(4003):(U=Fe,j=this._getFontDesc(),F.font=j)}else{for(ke=Re.length*this._getLineHeight(),Pe=0;Pe<Re.length;++Pe)Ne<Ve[Pe]&&(Ne=Ve[Pe]);var ot=(z.width-le.width)/Ne,ut=z.height/ke;U=X*Math.min(1,ot,ut)|0,j=this._getFontDesc(),F.font=j}},be._calculateWrapText=function(Re){if(ie){Y=[];for(var Ve=_e.width,Pe=0;Pe<Re.length;++Pe){var ke=O.safeMeasureText(F,Re[Pe],j),Ne=O.fragmentText(Re[Pe],ke,Ve,this._measureText(F,j));Y=Y.concat(Ne)}}},be._calculateLabelFont=function(){var Re=H.split("\n");switch(Y=Re,j=this._getFontDesc(),F.font=j,re){case I.NONE:for(var Ve=0,Pe=0,ke=0;ke<Re.length;++ke){var Ne=O.safeMeasureText(F,Re[ke],j);Ve=Ve>Ne?Ve:Ne}Pe=(Y.length+O.BASELINE_RATIO)*this._getLineHeight();var Ae=parseFloat(Ve.toFixed(2)),Oe=parseFloat(Pe.toFixed(2));z.width=Ae+le.width,z.height=Oe+le.height,_e.width=Ae+ce.width,_e.height=Oe+ce.height;break;case I.SHRINK:this._calculateShrinkFont(Re),this._calculateWrapText(Re);break;case I.CLAMP:this._calculateWrapText(Re);break;case I.RESIZE_HEIGHT:this._calculateWrapText(Re);var Fe=(Y.length+O.BASELINE_RATIO)*this._getLineHeight();z.height=Fe+le.height,_e.height=Fe+ce.height}},Se}(w.default);T.default=Ee,S.exports=T.default},{"../../../components/CCLabel":108,"../../../components/CCLabelOutline":109,"../../../components/CCLabelShadow":110,"../../../platform/CCMacro":201,"../../../utils/text-utils":278,"../../assembler-2d":222,"../utils":235}],235:[function(L,S){var T=L("./dynamic-atlas/manager"),_=cc.Color.WHITE,w={fontAtlas:null,fontSize:0,lineHeight:0,hAlign:0,vAlign:0,hash:"",fontFamily:"",fontDesc:"Arial",color:_,isOutlined:!1,out:_,margin:0};S.exports={deleteFromDynamicAtlas:function(B,A){A&&A._original&&T&&(T.deleteAtlasSpriteFrame(A),A._resetDynamicAtlasFrame())},getFontFamily:function(B){return B.useSystemFont?B.fontFamily||"Arial":B.font?B.font._nativeAsset?B.font._nativeAsset:(cc.assetManager.postLoadNative(B.font,function(){B.isValid&&B.setVertsDirty()}),"Arial"):"Arial"},shareLabelInfo:w}},{"./dynamic-atlas/manager":230}],236:[function(L,S){function T(ie,ne,he){he=he||2;var pe,K,ue,le,ce,_e,oe,de=ne&&ne.length,me=de?ne[0]*he:ie.length,ye=_(ie,0,me,he,!0),ge=[];if(!ye)return ge;if(de&&(ye=E(ie,ne,ye,he)),ie.length>80*he){pe=ue=ie[0],K=le=ie[1];for(var we=he;we<me;we+=he)(ce=ie[we])<pe&&(pe=ce),(_e=ie[we+1])<K&&(K=_e),ce>ue&&(ue=ce),_e>le&&(le=_e);oe=Math.max(ue-pe,le-K)}return B(ye,ge,he,pe,K,oe),ge}function _(ie,ne,he,pe,K){var ue,le;if(K===re(ie,ne,he,pe)>0)for(ue=ne;ue<he;ue+=pe)le=Q(ue,ie[ue],ie[ue+1],le);else for(ue=he-pe;ue>=ne;ue-=pe)le=Q(ue,ie[ue],ie[ue+1],le);return le&&U(le,le.next)&&(ee(le),le=le.next),le}function w(ie,ne){if(!ie)return ie;ne||(ne=ie);var he,pe=ie;do if(he=!1,pe.steiner||!U(pe,pe.next)&&H(pe.prev,pe,pe.next)!==0)pe=pe.next;else{if(ee(pe),(pe=ne=pe.prev)===pe.next)return null;he=!0}while(he||pe!==ne);return ne}function B(ie,ne,he,pe,K,ue,le){if(ie){!le&&ue&&N(ie,pe,K,ue);for(var ce,_e,oe=ie;ie.prev!==ie.next;)if(ce=ie.prev,_e=ie.next,ue?O(ie,pe,K,ue):A(ie))ne.push(ce.i/he),ne.push(ie.i/he),ne.push(_e.i/he),ee(ie),ie=_e.next,oe=_e.next;else if((ie=_e)===oe){le?le===1?B(ie=R(ie,ne,he),ne,he,pe,K,ue,2):le===2&&P(ie,ne,he,pe,K,ue):B(w(ie),ne,he,pe,K,ue,1);break}}}function A(ie){var ne=ie.prev,he=ie,pe=ie.next;if(H(ne,he,pe)>=0)return!1;for(var K=ie.next.next;K!==ie.prev;){if(V(ne.x,ne.y,he.x,he.y,pe.x,pe.y,K.x,K.y)&&H(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function O(ie,ne,he,pe){var K=ie.prev,ue=ie,le=ie.next;if(H(K,ue,le)>=0)return!1;for(var ce=K.x<ue.x?K.x<le.x?K.x:le.x:ue.x<le.x?ue.x:le.x,_e=K.y<ue.y?K.y<le.y?K.y:le.y:ue.y<le.y?ue.y:le.y,oe=K.x>ue.x?K.x>le.x?K.x:le.x:ue.x>le.x?ue.x:le.x,de=K.y>ue.y?K.y>le.y?K.y:le.y:ue.y>le.y?ue.y:le.y,me=F(ce,_e,ne,he,pe),ye=F(oe,de,ne,he,pe),ge=ie.nextZ;ge&&ge.z<=ye;){if(ge!==ie.prev&&ge!==ie.next&&V(K.x,K.y,ue.x,ue.y,le.x,le.y,ge.x,ge.y)&&H(ge.prev,ge,ge.next)>=0)return!1;ge=ge.nextZ}for(ge=ie.prevZ;ge&&ge.z>=me;){if(ge!==ie.prev&&ge!==ie.next&&V(K.x,K.y,ue.x,ue.y,le.x,le.y,ge.x,ge.y)&&H(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}return!0}function R(ie,ne,he){var pe=ie;do{var K=pe.prev,ue=pe.next.next;!U(K,ue)&&X(K,pe,pe.next,ue)&&z(K,ue)&&z(ue,K)&&(ne.push(K.i/he),ne.push(pe.i/he),ne.push(ue.i/he),ee(pe),ee(pe.next),pe=ie=ue),pe=pe.next}while(pe!==ie);return pe}function P(ie,ne,he,pe,K,ue){var le=ie;do{for(var ce=le.next.next;ce!==le.prev;){if(le.i!==ce.i&&j(le,ce)){var _e=Z(le,ce);return le=w(le,le.next),_e=w(_e,_e.next),B(le,ne,he,pe,K,ue),void B(_e,ne,he,pe,K,ue)}ce=ce.next}le=le.next}while(le!==ie)}function E(ie,ne,he,pe){var K,ue,le,ce=[];for(K=0,ue=ne.length;K<ue;K++)(le=_(ie,ne[K]*pe,K<ue-1?ne[K+1]*pe:ie.length,pe,!1))===le.next&&(le.steiner=!0),ce.push(G(le));for(ce.sort(D),K=0;K<ce.length;K++)I(ce[K],he),he=w(he,he.next);return he}function D(ie,ne){return ie.x-ne.x}function I(ie,ne){if(ne=M(ie,ne)){var he=Z(ne,ie);w(he,he.next)}}function M(ie,ne){var he,pe=ne,K=ie.x,ue=ie.y,le=-1/0;do{if(ue<=pe.y&&ue>=pe.next.y){var ce=pe.x+(ue-pe.y)*(pe.next.x-pe.x)/(pe.next.y-pe.y);if(ce<=K&&ce>le){if(le=ce,ce===K){if(ue===pe.y)return pe;if(ue===pe.next.y)return pe.next}he=pe.x<pe.next.x?pe:pe.next}}pe=pe.next}while(pe!==ne);if(!he)return null;if(K===le)return he.prev;var _e,oe=he,de=he.x,me=he.y,ye=1/0;for(pe=he.next;pe!==oe;)K>=pe.x&&pe.x>=de&&V(ue<me?K:le,ue,de,me,ue<me?le:K,ue,pe.x,pe.y)&&((_e=Math.abs(ue-pe.y)/(K-pe.x))<ye||_e===ye&&pe.x>he.x)&&z(pe,ie)&&(he=pe,ye=_e),pe=pe.next;return he}function N(ie,ne,he,pe){var K=ie;do K.z===null&&(K.z=F(K.x,K.y,ne,he,pe)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next;while(K!==ie);K.prevZ.nextZ=null,K.prevZ=null,k(K)}function k(ie){var ne,he,pe,K,ue,le,ce,_e,oe=1;do{for(he=ie,ie=null,ue=null,le=0;he;){for(le++,pe=he,ce=0,ne=0;ne<oe&&(ce++,pe=pe.nextZ);ne++);for(_e=oe;ce>0||_e>0&&pe;)ce===0?(K=pe,pe=pe.nextZ,_e--):_e!==0&&pe?he.z<=pe.z?(K=he,he=he.nextZ,ce--):(K=pe,pe=pe.nextZ,_e--):(K=he,he=he.nextZ,ce--),ue?ue.nextZ=K:ie=K,K.prevZ=ue,ue=K;he=pe}ue.nextZ=null,oe*=2}while(le>1);return ie}function F(ie,ne,he,pe,K){return(ie=1431655765&((ie=858993459&((ie=252645135&((ie=16711935&((ie=32767*(ie-he)/K)|ie<<8))|ie<<4))|ie<<2))|ie<<1))|(ne=1431655765&((ne=858993459&((ne=252645135&((ne=16711935&((ne=32767*(ne-pe)/K)|ne<<8))|ne<<4))|ne<<2))|ne<<1))<<1}function G(ie){var ne=ie,he=ie;do ne.x<he.x&&(he=ne),ne=ne.next;while(ne!==ie);return he}function V(ie,ne,he,pe,K,ue,le,ce){return(K-le)*(ne-ce)-(ie-le)*(ue-ce)>=0&&(ie-le)*(pe-ce)-(he-le)*(ne-ce)>=0&&(he-le)*(ue-ce)-(K-le)*(pe-ce)>=0}function j(ie,ne){return ie.next.i!==ne.i&&ie.prev.i!==ne.i&&!Y(ie,ne)&&z(ie,ne)&&z(ne,ie)&&W(ie,ne)}function H(ie,ne,he){return(ne.y-ie.y)*(he.x-ne.x)-(ne.x-ie.x)*(he.y-ne.y)}function U(ie,ne){return ie.x===ne.x&&ie.y===ne.y}function X(ie,ne,he,pe){return!!(U(ie,ne)&&U(he,pe)||U(ie,pe)&&U(he,ne))||H(ie,ne,he)>0!=H(ie,ne,pe)>0&&H(he,pe,ie)>0!=H(he,pe,ne)>0}function Y(ie,ne){var he=ie;do{if(he.i!==ie.i&&he.next.i!==ie.i&&he.i!==ne.i&&he.next.i!==ne.i&&X(he,he.next,ie,ne))return!0;he=he.next}while(he!==ie);return!1}function z(ie,ne){return H(ie.prev,ie,ie.next)<0?H(ie,ne,ie.next)>=0&&H(ie,ie.prev,ne)>=0:H(ie,ne,ie.prev)<0||H(ie,ie.next,ne)<0}function W(ie,ne){var he=ie,pe=!1,K=(ie.x+ne.x)/2,ue=(ie.y+ne.y)/2;do he.y>ue!=he.next.y>ue&&K<(he.next.x-he.x)*(ue-he.y)/(he.next.y-he.y)+he.x&&(pe=!pe),he=he.next;while(he!==ie);return pe}function Z(ie,ne){var he=new te(ie.i,ie.x,ie.y),pe=new te(ne.i,ne.x,ne.y),K=ie.next,ue=ne.prev;return ie.next=ne,ne.prev=ie,he.next=K,K.prev=he,pe.next=he,he.prev=pe,ue.next=pe,pe.prev=ue,pe}function Q(ie,ne,he,pe){var K=new te(ie,ne,he);return pe?(K.next=pe.next,K.prev=pe,pe.next.prev=K,pe.next=K):(K.prev=K,K.next=K),K}function ee(ie){ie.next.prev=ie.prev,ie.prev.next=ie.next,ie.prevZ&&(ie.prevZ.nextZ=ie.nextZ),ie.nextZ&&(ie.nextZ.prevZ=ie.prevZ)}function te(ie,ne,he){this.i=ie,this.x=ne,this.y=he,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function re(ie,ne,he,pe){for(var K=0,ue=ne,le=he-pe;ue<he;ue+=pe)K+=(ie[le]-ie[ue])*(ie[ue+1]+ie[le+1]),le=ue;return K}cc.Graphics.earcut=S.exports=T,T.deviation=function(ie,ne,he,pe){var K=ne&&ne.length,ue=K?ne[0]*he:ie.length,le=Math.abs(re(ie,0,ue,he));if(K)for(var ce=0,_e=ne.length;ce<_e;ce++){var oe=ne[ce]*he,de=ce<_e-1?ne[ce+1]*he:ie.length;le-=Math.abs(re(ie,oe,de,he))}var me=0;for(ce=0;ce<pe.length;ce+=3){var ye=pe[ce]*he,ge=pe[ce+1]*he,we=pe[ce+2]*he;me+=Math.abs((ie[ye]-ie[we])*(ie[ge+1]-ie[ye+1])-(ie[ye]-ie[ge])*(ie[we+1]-ie[ye+1]))}return le===0&&me===0?0:Math.abs((me-le)/le)},T.flatten=function(ie){for(var ne=ie[0][0].length,he={vertices:[],holes:[],dimensions:ne},pe=0,K=0;K<ie.length;K++){for(var ue=0;ue<ie[K].length;ue++)for(var le=0;le<ne;le++)he.vertices.push(ie[K][ue][le]);K>0&&(pe+=ie[K-1].length,he.holes.push(pe))}return he}},{}],237:[function(L,S){var T=L("../../../../graphics/helper"),_=L("../../../../graphics/types").PointFlags,w=cc.Graphics.Point=cc.Class({name:"cc.GraphicsPoint",extends:cc.Vec2,ctor:function(){this.reset()},reset:function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0}});function B(){this.reset()}function A(){this._tessTol=.25,this._distTol=.01,this._updatePathOffset=!1,this._paths=null,this._pathLength=0,this._pathOffset=0,this._points=null,this._pointsOffset=0,this._commandx=0,this._commandy=0,this._paths=[],this._points=[]}cc.js.mixin(B.prototype,{reset:function(){this.closed=!1,this.nbevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]}}),cc.js.mixin(A.prototype,{moveTo:function(O,R){this._updatePathOffset&&(this._pathOffset=this._pathLength,this._updatePathOffset=!1),this._addPath(),this._addPoint(O,R,_.PT_CORNER),this._commandx=O,this._commandy=R},lineTo:function(O,R){this._addPoint(O,R,_.PT_CORNER),this._commandx=O,this._commandy=R},bezierCurveTo:function(O,R,P,E,D,I){var M=this._curPath,N=M.points[M.points.length-1];N.x!==O||N.y!==R||P!==D||E!==I?(T.tesselateBezier(this,N.x,N.y,O,R,P,E,D,I,0,_.PT_CORNER),this._commandx=D,this._commandy=I):this.lineTo(D,I)},quadraticCurveTo:function(O,R,P,E){var D=this._commandx,I=this._commandy;this.bezierCurveTo(D+2/3*(O-D),I+2/3*(R-I),P+2/3*(O-P),E+2/3*(R-E),P,E)},arc:function(O,R,P,E,D,I){T.arc(this,O,R,P,E,D,I)},ellipse:function(O,R,P,E){T.ellipse(this,O,R,P,E),this._curPath.complex=!1},circle:function(O,R,P){T.ellipse(this,O,R,P,P),this._curPath.complex=!1},rect:function(O,R,P,E){this.moveTo(O,R),this.lineTo(O,R+E),this.lineTo(O+P,R+E),this.lineTo(O+P,R),this.close(),this._curPath.complex=!1},roundRect:function(O,R,P,E,D){T.roundRect(this,O,R,P,E,D),this._curPath.complex=!1},clear:function(O){this._pathLength=0,this._pathOffset=0,this._pointsOffset=0,this._curPath=null,O&&(this._paths.length=0,this._points.length=0)},close:function(){this._curPath.closed=!0},_addPath:function(){var O=this._pathLength,R=this._paths[O];return R?R.reset():(R=new B,this._paths.push(R)),this._pathLength++,this._curPath=R,R},_addPoint:function(O,R,P){var E=this._curPath;if(E){var D,I=this._points,M=E.points;(D=I[this._pointsOffset++])?(D.x=O,D.y=R):(D=new w(O,R),I.push(D)),D.flags=P,M.push(D)}}}),cc.Graphics._Impl=A,S.exports=A},{"../../../../graphics/helper":160,"../../../../graphics/types":162}],238:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=B(L("../../../assembler")),w=B(L("../../../../../renderer/core/input-assembler"));function B(Z){return Z&&Z.__esModule?Z:{default:Z}}function A(Z,Q){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ee,te){return ee.__proto__=te,ee})(Z,Q)}var O=L("../../mesh-buffer"),R=L("../../../index"),P=L("../../../../graphics/graphics"),E=L("../../../../graphics/types").PointFlags,D=P.LineJoin,I=P.LineCap,M=L("./earcut");L("./impl");var N=Math.PI,k=Math.min,F=Math.max,G=Math.ceil,V=Math.acos,j=Math.cos,H=Math.sin,U=Math.atan2;function X(Z,Q,ee){return Z<Q?Q:Z>ee?ee:Z}var Y=cc.gfx,z=new Y.VertexFormat([{name:Y.ATTR_POSITION,type:Y.ATTR_TYPE_FLOAT32,num:2},{name:Y.ATTR_COLOR,type:Y.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:"a_dist",type:Y.ATTR_TYPE_FLOAT32,num:1}]);z.name="vfmtPosColorSdf";var W=function(Z){var Q,ee;function te(ie){var ne;return(ne=Z.call(this,ie)||this)._buffer=null,ne._buffers=[],ne._bufferOffset=0,ne}ee=Z,(Q=te).prototype=Object.create(ee.prototype),Q.prototype.constructor=Q,A(Q,ee);var re=te.prototype;return re.getVfmt=function(){return z},re.getVfmtFloatCount=function(){return 4},re.requestBuffer=function(){var ie={indiceStart:0,vertexStart:0},ne=new O(R._handle,this.getVfmt());ie.meshbuffer=ne;var he=new w.default(ne._vb,ne._ib);return ie.ia=he,this._buffers.push(ie),ie},re.getBuffers=function(){return this._buffers.length===0&&this.requestBuffer(),this._buffers},re.clear=function(ie){this._bufferOffset=0;var ne=this._buffers;if(ie){for(var he=0,pe=ne.length;he<pe;he++){var K=ne[he];K.meshbuffer.destroy(),K.meshbuffer=null}ne.length=0}else for(var ue=0,le=ne.length;ue<le;ue++){var ce=ne[ue];ce.indiceStart=0,ce.vertexStart=0,ce.meshbuffer.reset()}},re.fillBuffers=function(ie,ne){ne._flush(),ne.node=ie.node,ne.material=ie._materials[0];for(var he=this.getBuffers(),pe=0,K=he.length;pe<K;pe++){var ue=he[pe],le=ue.meshbuffer;ue.ia._count=ue.indiceStart,ne._flushIA(ue.ia),le.uploadData()}},re.genBuffer=function(ie,ne){var he=this.getBuffers(),pe=he[this._bufferOffset],K=pe.meshbuffer,ue=pe.vertexStart+ne;return(ue>65535||3*ue>131070)&&(++this._bufferOffset,ue=ne,this._bufferOffset<he.length?pe=he[this._bufferOffset]:(pe=this.requestBuffer(ie),he[this._bufferOffset]=pe),K=pe.meshbuffer),ue>K.vertexOffset&&K.requestStatic(ne,3*ne),this._buffer=pe,pe},re.stroke=function(ie){this._curColor=ie._strokeColor._val,this._flattenPaths(ie._impl),this._expandStroke(ie),ie._impl._updatePathOffset=!0},re.fill=function(ie){this._curColor=ie._fillColor._val,this._expandFill(ie),ie._impl._updatePathOffset=!0},re._expandStroke=function(ie){var ne,he,pe,K,ue=.5*ie.lineWidth,le=ie.lineCap,ce=ie.lineJoin,_e=ie.miterLimit,oe=ie._impl,de=(ne=ue,he=N,pe=oe._tessTol,K=2*V(ne/(ne+pe)),F(2,G(he/K)));this._calculateJoins(oe,ue,ce,_e);for(var me=oe._paths,ye=0,ge=oe._pathOffset,we=oe._pathLength;ge<we;ge++){var Te=me[ge],Ee=Te.points.length;ce===D.ROUND?ye+=2*(Ee+Te.nbevel*(de+2)+1):ye+=2*(Ee+5*Te.nbevel+1),Te.closed||(le===I.ROUND?ye+=2*(2*de+2):ye+=12)}for(var De=this.genBuffer(ie,ye),fe=De.meshbuffer,Ce=fe._vData,Se=fe._iData,be=oe._pathOffset,Re=oe._pathLength;be<Re;be++){var Ve,Pe=me[be],ke=Pe.points,Ne=ke.length,Ae=De.vertexStart,Oe=void 0,Fe=void 0,nt=void 0,Ze=void 0;if((Ve=Pe.closed)?(Oe=ke[Ne-1],Fe=ke[0],nt=0,Ze=Ne):(Oe=ke[0],Fe=ke[1],nt=1,Ze=Ne-1),Fe=Fe||Oe,!Ve){var Xe=Fe.sub(Oe);Xe.normalizeSelf();var $e=Xe.x,ot=Xe.y;le===I.BUTT?this._buttCapStart(Oe,$e,ot,ue,0):le===I.SQUARE?this._buttCapStart(Oe,$e,ot,ue,ue):le===I.ROUND&&this._roundCapStart(Oe,$e,ot,ue,de)}for(var ut=nt;ut<Ze;++ut)ce===D.ROUND?this._roundJoin(Oe,Fe,ue,ue,de):(Fe.flags&(E.PT_BEVEL|E.PT_INNERBEVEL))!=0?this._bevelJoin(Oe,Fe,ue,ue):(this._vset(Fe.x+Fe.dmx*ue,Fe.y+Fe.dmy*ue,1),this._vset(Fe.x-Fe.dmx*ue,Fe.y-Fe.dmy*ue,-1)),Oe=Fe,Fe=ke[ut+1];if(Ve){var gt=this.getVfmtFloatCount(),Ue=Ae*gt;this._vset(Ce[Ue],Ce[Ue+1],1),this._vset(Ce[Ue+gt],Ce[Ue+gt+1],-1)}else{var We=Fe.sub(Oe);We.normalizeSelf();var ht=We.x,Be=We.y;le===I.BUTT?this._buttCapEnd(Fe,ht,Be,ue,0):le===I.SQUARE?this._buttCapEnd(Fe,ht,Be,ue,ue):le===I.ROUND&&this._roundCapEnd(Fe,ht,Be,ue,de)}for(var je=De.indiceStart,Qe=Ae+2,st=De.vertexStart;Qe<st;Qe++)Se[je++]=Qe-2,Se[je++]=Qe-1,Se[je++]=Qe;De.indiceStart=je}},re._expandFill=function(ie){for(var ne=ie._impl,he=ne._paths,pe=0,K=ne._pathOffset,ue=ne._pathLength;K<ue;K++)pe+=he[K].points.length;for(var le=this.genBuffer(ie,pe),ce=le.meshbuffer,_e=ce._vData,oe=ce._iData,de=ne._pathOffset,me=ne._pathLength;de<me;de++){var ye=he[de],ge=ye.points,we=ge.length;if(we!==0){for(var Te=le.vertexStart,Ee=0;Ee<we;++Ee)this._vset(ge[Ee].x,ge[Ee].y);var De=le.indiceStart;if(ye.complex){for(var fe=[],Ce=this.getVfmtFloatCount(),Se=Te,be=le.vertexStart;Se<be;Se++){var Re=Se*Ce;fe.push(_e[Re]),fe.push(_e[Re+1])}var Ve=M(fe,null,2);if(!Ve||Ve.length===0)continue;for(var Pe=0,ke=Ve.length;Pe<ke;Pe++)oe[De++]=Ve[Pe]+Te}else for(var Ne=Te,Ae=Te+2,Oe=le.vertexStart;Ae<Oe;Ae++)oe[De++]=Ne,oe[De++]=Ae-1,oe[De++]=Ae;le.indiceStart=De}}},re._calculateJoins=function(ie,ne,he,pe){var K=0,ue=ne*ne;ne>0&&(K=1/ne);for(var le=ie._paths,ce=ie._pathOffset,_e=ie._pathLength;ce<_e;ce++){var oe=le[ce],de=oe.points,me=de.length,ye=de[me-1],ge=de[0];oe.nbevel=0;for(var we=0;we<me;we++){var Te,Ee,De=ye.dy,fe=-ye.dx,Ce=ge.dy,Se=-ge.dx;if(ge.dmx=.5*(De+Ce),ge.dmy=.5*(fe+Se),(Te=ge.dmx*ge.dmx+ge.dmy*ge.dmy)>1e-6){var be=1/Te;be>600&&(be=600),ge.dmx*=be,ge.dmy*=be}ge.dx*ye.dy-ye.dx*ge.dy>0&&(ge.flags|=E.PT_LEFT),Te*(Ee=F(11,k(ye.len,ge.len)*K))*Ee<1&&(ge.flags|=E.PT_INNERBEVEL);var Re=ge.dmx*ne,Ve=ge.dmy*ne,Pe=Re*Re+Ve*Ve;Pe>ge.len*ge.len+ue&&Pe>ye.len*ye.len+ue&&(ge.flags|=E.PT_INNERBEVEL),ge.flags&E.PT_CORNER&&(Te*pe*pe<1||he===D.BEVEL||he===D.ROUND)&&(ge.flags|=E.PT_BEVEL),(ge.flags&(E.PT_BEVEL|E.PT_INNERBEVEL))!=0&&oe.nbevel++,ye=ge,ge=de[we+1]}}},re._flattenPaths=function(ie){for(var ne=ie._paths,he=ie._pathOffset,pe=ie._pathLength;he<pe;he++){var K=ne[he],ue=K.points,le=ue[ue.length-1],ce=ue[0];ue.length>2&&le.equals(ce)&&(K.closed=!0,ue.pop(),le=ue[ue.length-1]);for(var _e=0,oe=ue.length;_e<oe;_e++){var de=ce.sub(le);le.len=de.mag(),(de.x||de.y)&&de.normalizeSelf(),le.dx=de.x,le.dy=de.y,le=ce,ce=ue[_e+1]}}},re._chooseBevel=function(ie,ne,he,pe){var K,ue,le,ce,_e=he.x,oe=he.y;return ie!==0?(K=_e+ne.dy*pe,ue=oe-ne.dx*pe,le=_e+he.dy*pe,ce=oe-he.dx*pe):(K=le=_e+he.dmx*pe,ue=ce=oe+he.dmy*pe),[K,ue,le,ce]},re._buttCapStart=function(ie,ne,he,pe,K){var ue=ie.x-ne*K,le=ie.y-he*K,ce=he,_e=-ne;this._vset(ue+ce*pe,le+_e*pe,1),this._vset(ue-ce*pe,le-_e*pe,-1)},re._buttCapEnd=function(ie,ne,he,pe,K){var ue=ie.x+ne*K,le=ie.y+he*K,ce=he,_e=-ne;this._vset(ue+ce*pe,le+_e*pe,1),this._vset(ue-ce*pe,le-_e*pe,-1)},re._roundCapStart=function(ie,ne,he,pe,K){for(var ue=ie.x,le=ie.y,ce=he,_e=-ne,oe=0;oe<K;oe++){var de=oe/(K-1)*N,me=j(de)*pe,ye=H(de)*pe;this._vset(ue-ce*me-ne*ye,le-_e*me-he*ye,1),this._vset(ue,le,0)}this._vset(ue+ce*pe,le+_e*pe,1),this._vset(ue-ce*pe,le-_e*pe,-1)},re._roundCapEnd=function(ie,ne,he,pe,K){var ue=ie.x,le=ie.y,ce=he,_e=-ne;this._vset(ue+ce*pe,le+_e*pe,1),this._vset(ue-ce*pe,le-_e*pe,-1);for(var oe=0;oe<K;oe++){var de=oe/(K-1)*N,me=j(de)*pe,ye=H(de)*pe;this._vset(ue,le,0),this._vset(ue-ce*me+ne*ye,le-_e*me+he*ye,1)}},re._roundJoin=function(ie,ne,he,pe,K){var ue=ie.dy,le=-ie.dx,ce=ne.dy,_e=-ne.dx,oe=ne.x,de=ne.y;if((ne.flags&E.PT_LEFT)!=0){var me=this._chooseBevel(ne.flags&E.PT_INNERBEVEL,ie,ne,he),ye=me[0],ge=me[1],we=me[2],Te=me[3],Ee=U(-le,-ue),De=U(-_e,-ce);De>Ee&&(De-=2*N),this._vset(ye,ge,1),this._vset(oe-ue*pe,ne.y-le*pe,-1);for(var fe=X(G((Ee-De)/N)*K,2,K),Ce=0;Ce<fe;Ce++){var Se=Ee+Ce/(fe-1)*(De-Ee),be=oe+j(Se)*pe,Re=de+H(Se)*pe;this._vset(oe,de,0),this._vset(be,Re,-1)}this._vset(we,Te,1),this._vset(oe-ce*pe,de-_e*pe,-1)}else{var Ve=this._chooseBevel(ne.flags&E.PT_INNERBEVEL,ie,ne,-pe),Pe=Ve[0],ke=Ve[1],Ne=Ve[2],Ae=Ve[3],Oe=U(le,ue),Fe=U(_e,ce);Fe<Oe&&(Fe+=2*N),this._vset(oe+ue*pe,de+le*pe,1),this._vset(Pe,ke,-1);for(var nt=X(G((Fe-Oe)/N)*K,2,K),Ze=0;Ze<nt;Ze++){var Xe=Oe+Ze/(nt-1)*(Fe-Oe),$e=oe+j(Xe)*he,ot=de+H(Xe)*he;this._vset($e,ot,1),this._vset(oe,de,0)}this._vset(oe+ce*pe,de+_e*pe,1),this._vset(Ne,Ae,-1)}},re._bevelJoin=function(ie,ne,he,pe){var K,ue,le,ce,_e,oe,de,me,ye=ie.dy,ge=-ie.dx,we=ne.dy,Te=-ne.dx;if(ne.flags&E.PT_LEFT){var Ee=this._chooseBevel(ne.flags&E.PT_INNERBEVEL,ie,ne,he);_e=Ee[0],oe=Ee[1],de=Ee[2],me=Ee[3],this._vset(_e,oe,1),this._vset(ne.x-ye*pe,ne.y-ge*pe,-1),this._vset(de,me,1),this._vset(ne.x-we*pe,ne.y-Te*pe,-1)}else{var De=this._chooseBevel(ne.flags&E.PT_INNERBEVEL,ie,ne,-pe);K=De[0],ue=De[1],le=De[2],ce=De[3],this._vset(ne.x+ye*he,ne.y+ge*he,1),this._vset(K,ue,-1),this._vset(ne.x+we*he,ne.y+Te*he,1),this._vset(le,ce,-1)}},re._vset=function(ie,ne,he){he===void 0&&(he=0);var pe=this._buffer,K=pe.meshbuffer,ue=pe.vertexStart*this.getVfmtFloatCount(),le=K._vData,ce=K._uintVData;le[ue]=ie,le[ue+1]=ne,ce[ue+2]=this._curColor,le[ue+3]=he,pe.vertexStart++,K._dirty=!0},te}(_.default);T.default=W,_.default.register(cc.Graphics,W),S.exports=T.default},{"../../../../../renderer/core/input-assembler":309,"../../../../graphics/graphics":159,"../../../../graphics/types":162,"../../../assembler":224,"../../../index":227,"../../mesh-buffer":255,"./earcut":236,"./impl":237}],239:[function(L){cc.assemblers={},L("./sprite"),L("./mask-assembler"),L("./graphics"),L("./label"),L("./motion-streak")},{"./graphics":238,"./label":244,"./mask-assembler":245,"./motion-streak":246,"./sprite":253}],240:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../../../utils/label/bmfont"))&&_.__esModule?_:{default:_};function B(R,P){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(E,D){return E.__proto__=D,E})(R,P)}var A=0,O=function(R){var P,E;function D(){return R.apply(this,arguments)||this}E=R,(P=D).prototype=Object.create(E.prototype),P.prototype.constructor=P,B(P,E);var I=D.prototype;return I.initData=function(){this._renderData.createFlexData(0,4,6,this.getVfmt())},I._reserveQuads=function(M,N){var k=4*N,F=6*N,G=this._renderData._flexBuffer;G.reserve(k,F),G.used(k,F);for(var V=this._renderData.iDatas[0],j=0,H=0,U=F;j<U;j+=6,H+=4)V[j]=H,V[j+1]=H+1,V[j+2]=H+2,V[j+3]=H+1,V[j+4]=H+3,V[j+5]=H+2;A=0},I._quadsUpdated=function(){A=0,this._renderData._flexBuffer.used(this.verticesCount,this.indicesCount)},I._getColor=function(M){return M.node._color._val},I.appendQuad=function(M,N,k,F,G,V,j){var H=this._renderData,U=H.vDatas[0],X=H.uintVDatas[0];this.verticesCount+=4,this.indicesCount=this.verticesCount/2*3;var Y,z,W,Z,Q=N.width,ee=N.height,te=k.width,re=k.height,ie=this._getColor(M),ne=this.floatsPerVert,he=A+this.uvOffset;F?(Y=k.x/Q,W=(k.x+re)/Q,z=(k.y+te)/ee,Z=k.y/ee,U[he]=Y,U[he+1]=Z,U[he+=ne]=Y,U[he+1]=z,U[he+=ne]=W,U[he+1]=Z,U[he+=ne]=W,U[he+1]=z):(Y=k.x/Q,W=(k.x+te)/Q,z=(k.y+re)/ee,Z=k.y/ee,U[he]=Y,U[he+1]=z,U[he+=ne]=W,U[he+1]=z,U[he+=ne]=Y,U[he+1]=Z,U[he+=ne]=W,U[he+1]=Z),Y=G,W=G+te*j,z=V-re*j,Z=V,this.appendVerts(M,A,Y,W,z,Z);for(var pe=A+this.colorOffset,K=0;K<4;K++)X[pe]=ie,pe+=ne;A+=4*this.floatsPerVert},I.appendVerts=function(M,N,k,F,G,V){var j=this._local,H=this.floatsPerVert;j[N]=k,j[N+1]=G,j[N+=H]=F,j[N+1]=G,j[N+=H]=k,j[N+1]=V,j[N+=H]=F,j[N+1]=V},I.updateWorldVerts=function(M){for(var N=M.node._worldMatrix.m,k=N[0],F=N[1],G=N[4],V=N[5],j=N[12],H=N[13],U=this._local,X=this._renderData.vDatas[0],Y=this.floatsPerVert,z=0;z<U.length;z+=Y){var W=U[z],Z=U[z+1];X[z]=W*k+Z*G+j,X[z+1]=W*F+Z*V+H}},D}(w.default);T.default=O,S.exports=T.default},{"../../../../utils/label/bmfont":231}],241:[function(L,S,T){function _(O,R){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(P,E){return P.__proto__=E,P})(O,R)}T.__esModule=!0,T.default=void 0,L("../../../../../platform/js"),L("./bmfont");var w=L("../../../../utils/label/letter-font"),B=cc.color(255,255,255,255),A=function(O){var R,P;function E(){return O.apply(this,arguments)||this}P=O,(R=E).prototype=Object.create(P.prototype),R.prototype.constructor=R,_(R,P);var D=E.prototype;return D.createData=function(I){return I.requestRenderData()},D._getColor=function(I){return B._fastSetA(I.node._color.a),B._val},D.updateColor=function(I){var M=this._getColor(I);O.prototype.updateColor.call(this,I,M)},E}(w);T.default=A,S.exports=T.default},{"../../../../../platform/js":217,"../../../../utils/label/letter-font":233,"./bmfont":240}],242:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../../../../assets/material/material-variant"))&&_.__esModule?_:{default:_};L("../../../../../components/CCLabel"),L("../../../../../components/CCLabelShadow"),L("../../../../../components/CCLabelOutline"),L("../../../../../assets/material/CCMaterial");var B=function(){function A(){}var O=A.prototype;return O.init=function(R){this.labelMaterial=null,this._label=this._renderComp=R,renderer.CustomAssembler.prototype.ctor.call(this),R.node._proxy.setAssembler(this),this._layout=new jsb.LabelRenderer,this._layout.init(R),this._cfg=new DataView(this._layout._cfg),this._layoutInfo=new DataView(this._layout._layout),this._cfgFields=typeof jsb.LabelRenderer._cfgFields=="string"?JSON.parse(jsb.LabelRenderer._cfgFields):jsb.LabelRenderer._cfgFields,this._layoutFields=typeof jsb.LabelRenderer._layoutFields=="string"?JSON.parse(jsb.LabelRenderer._layoutFields):jsb.LabelRenderer._layoutFields,this._layout.bindNodeProxy(R.node._proxy),this._bindMaterial(R)},O._setBufferFlag=function(R,P,E,D,I){if(D=="int8"&&E==1){var M=R.getInt8(P);R.setInt8(P,I|M)}else if(D=="int32"&&E==4){var N=R.getInt32(P,jsb.__isLittleEndian__);R.setInt32(P,I|N,jsb.__isLittleEndian__)}else cc.warn("flag storage type should be int8/int32 only, type/size -> "+D+"/"+E+".")},O._updateCfgFlag=function(R){var P=this._cfgFields.updateFlags;this._setBufferFlag(this._cfg,P.offset,P.size,P.type,R)},O._setBufferValue=function(R,P,E,D,I){D=="float"&&E==4?R.setFloat32(P,I,jsb.__isLittleEndian__):D=="int32"&&E==4?R.setInt32(P,I,jsb.__isLittleEndian__):D=="bool"&&E==1?R.setInt8(P,I?1:0,jsb.__isLittleEndian__):D=="Color4B"&&E==4?(R.setUint8(P,I.r),R.setUint8(P+1,I.g),R.setUint8(P+2,I.b),R.setUint8(P+3,I.a)):D=="int8"&&E==1?R.setUint8(P,I):cc.warn("dont know how to set value to buffer, type/size -> "+D+"/"+E+".")},O._setFieldValue=function(R,P,E,D){var I=P[E];this._setBufferValue(R,I.offset,I.size,I.type,D)},O._getBufferValue=function(R,P,E,D){return D=="float"&&E==4?R.getFloat32(P,jsb.__isLittleEndian__):D=="int32"&&E==4?R.getInt32(P,jsb.__isLittleEndian__):D=="bool"&&E==1?R.getInt8(P,jsb.__isLittleEndian__)!=0:D=="Color4B"&&E==4?{r:R.getUint8(P),g:R.getUint8(P+1),b:R.getUint8(P+2),a:R.getUint8(P+3)}:D=="int8"&&E==1?R.getUint8(P):void cc.warn("dont know how to get value from buffer, type/size -> "+D+"/"+E+".")},O._getFieldValue=function(R,P,E){var D=P[E];return this._getBufferValue(R,D.offset,D.size,D.type)},O._getLayoutValue=function(R){return this._getFieldValue(this._layoutInfo,this._layoutFields,R)},O._setLayoutValue=function(R,P){return this._setFieldValue(this._layoutInfo,this._layoutFields,R,P)},O._updateCfgFlag_Content=function(){this._updateCfgFlag(1)},O._updateCfgFlag_Font=function(){this._updateCfgFlag(2)},O._colorEqual=function(R,P){return R.r==P.r&&R.g==P.g&&R.b==P.b&&R.a==P.a},O._colorToObj=function(R,P,E,D){return{r:R,g:P,b:E,a:D}},O.setString=function(R){R!=this._layout.string&&(this._layout.string=R,this._updateCfgFlag_Content())},O.setFontPath=function(R){R!=this._layout.fontPath&&(this._layout.fontPath=R,this._updateCfgFlag_Font())},O.setFontSize=function(R,P){this._getFieldValue(this._cfg,this._cfgFields,"fontSize")!=R&&(this._setFieldValue(this._cfg,this._cfgFields,"fontSize",R),this._setFieldValue(this._cfg,this._cfgFields,"fontSizeRetina",P),this._updateCfgFlag_Font())},O.setOutline=function(R){var P=this._getLayoutValue("outlineSize");P>0!=R>0&&this._updateCfgFlag_Font(),P!=R&&(this._updateCfgFlag_Content(),this._setLayoutValue("outlineSize",R))},O.setOutlineColor=function(R){var P=this._getLayoutValue("outlineColor");this._colorEqual(P,R)||(this._setLayoutValue("outlineColor",R),this._updateCfgFlag_Content())},O.setLineHeight=function(R){this._getLayoutValue("lineHeight")!=R&&(this._setLayoutValue("lineHeight",R),this._updateCfgFlag_Content())},O.setOverFlow=function(R){this._getLayoutValue("overflow")!=R&&(this._setLayoutValue("overflow",R),this._updateCfgFlag_Content())},O.setEnableWrap=function(R){this._getLayoutValue("wrap")!=R&&(this._setLayoutValue("wrap",R),this._updateCfgFlag_Content())},O.setVerticalAlign=function(R){this._getLayoutValue("valign")!=R&&(this._setLayoutValue("valign",R),this._updateCfgFlag_Content())},O.setHorizontalAlign=function(R){this._getLayoutValue("halign")!=R&&(this._setLayoutValue("halign",R),this._updateCfgFlag_Content())},O.setContentSize=function(R,P){var E=this._getLayoutValue("width"),D=this._getLayoutValue("height");E==R&&D==P||(this._setLayoutValue("height",P),this._setLayoutValue("width",R),this._updateCfgFlag_Content())},O.setAnchorPoint=function(R,P){var E=this._getLayoutValue("anchorX"),D=this._getLayoutValue("anchorY");E==R&&D==P||(this._setLayoutValue("anchorX",R),this._setLayoutValue("anchorY",P),this._updateCfgFlag_Content())},O.setColor=function(R){var P=this._getLayoutValue("color");this._colorEqual(P,R)||(this._setLayoutValue("color",R),this._updateCfgFlag_Content())},O.setShadow=function(R,P,E){var D=this._getLayoutValue("shadowBlur"),I=this._getLayoutValue("shadowX"),M=this._getLayoutValue("shadowY");D>0!=E>0&&this._updateCfgFlag_Font();var N=!1;D!=E&&(this._setLayoutValue("shadowBlur",E),N=!0),I!=R&&(this._setLayoutValue("shadowX",R),N=!0),M!=P&&(this._setLayoutValue("shadowY",P),N=!0),N&&this._updateCfgFlag_Content()},O.setShadowColor=function(R){var P=this._getLayoutValue("shadowColor");this._colorEqual(P,R)||(this._setLayoutValue("shadowColor",R),this._updateCfgFlag_Content())},O.setItalic=function(R){this._getLayoutValue("italic")!=R&&(this._setLayoutValue("italic",R),this._updateCfgFlag_Content())},O.setBold=function(R){this._getLayoutValue("bold")!=R&&(this._setLayoutValue("bold",R),this._updateCfgFlag_Content(),this._updateCfgFlag_Font())},O.setUnderline=function(R){this._getLayoutValue("underline")!=R&&(this._setLayoutValue("underline",R),this._updateCfgFlag_Content())},O.setSpacingX=function(R){this._getLayoutValue("spaceX")==R||typeof R!="number"||isNaN(R)||(this._setLayoutValue("spaceX",R),this._updateCfgFlag_Content())},O.updateRenderData=function(R){if(R._vertsDirty){R.font&&R.font.nativeUrl&&this.setFontPath(cc.assetManager.cacheManager.getCache(R.font.nativeUrl)||R.font.nativeUrl);var P=this._layout,E=R.node.color,D=R.node,I=R.fontSize;this.setString(R.string),this.setFontSize(R.fontSize,I/72*R.fontSize),this.setLineHeight(R.lineHeight),this.setEnableWrap(R.enableWrapText),this.setItalic(R.enableItalic),this.setUnderline(R.enableUnderline),this.setBold(R.enableBold),this.setOverFlow(R.overflow),this.setVerticalAlign(R.verticalAlign),this.setHorizontalAlign(R.horizontalAlign),this.setSpacingX(R.spacingX),this.setContentSize(D.getContentSize().width,D.getContentSize().height),this.setAnchorPoint(D.anchorX,D.anchorY),this.setColor(this._colorToObj(E.getR(),E.getG(),E.getB(),Math.ceil(E.getA()*D.opacity/255)));var M=D.getComponent(cc.LabelShadow);if(M&&M.enabled){var N=M.color;this.setShadow(M.offset.x,M.offset.y,M.blur),this.setShadowColor(this._colorToObj(N.getR(),N.getG(),N.getB(),Math.ceil(N.getA()*D.opacity/255)))}else this.setShadow(0,0,-1);this._updateTTFMaterial(R),P.render()}},O._bindMaterial=function(R){var P=this.labelMaterial;return P||(P=w.default.createWithBuiltin("2d-label",R),this.labelMaterial=P),P},O._updateTTFMaterial=function(R){var P=this._bindMaterial(R),E=this._label.node,D=this._layout,I=E.getComponent(cc.LabelOutline),M=0;if(I&&I.enabled&&I.width>0){M=Math.max(Math.min(I.width/10,.4),.1);var N=I.color;this.setOutlineColor(this._colorToObj(N.getR(),N.getG(),N.getB(),Math.ceil(N.getA()*E.opacity/255)))}this.setOutline(M),P.define("CC_USE_MODEL",!0),P.define("USE_TEXTURE_ALPHAONLY",!0),P.define("USE_SDF",M>0||R.enableBold),P.define("USE_SDF_EXTEND",R.enableBold?1:0),P.getDefine("CC_SUPPORT_standard_derivatives")!==void 0&&cc.sys.glExtension("OES_standard_derivatives")&&P.define("CC_SUPPORT_standard_derivatives",!0),D.setEffect(P.effect._nativeObj)},O.fillBuffers=function(){this._layout.render()},O.getVfmt=function(){},A}();T.default=B,S.exports=T.default},{"../../../../../assets/material/CCMaterial":81,"../../../../../assets/material/material-variant":88,"../../../../../components/CCLabel":108,"../../../../../components/CCLabelOutline":109,"../../../../../components/CCLabelShadow":110}],243:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../../../utils/label/ttf"))&&_.__esModule?_:{default:_};function B(P,E){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,I){return D.__proto__=I,D})(P,E)}var A=L("../../../../../components/CCLabelShadow"),O=cc.color(255,255,255,255),R=function(P){var E,D;function I(){return P.apply(this,arguments)||this}D=P,(E=I).prototype=Object.create(D.prototype),E.prototype.constructor=E,B(E,D);var M=I.prototype;return M.updateUVs=function(N){for(var k=this._renderData.vDatas[0],F=N._frame.uv,G=this.uvOffset,V=this.floatsPerVert,j=0;j<4;j++){var H=2*j,U=V*j+G;k[U]=F[H],k[U+1]=F[H+1]}},M.updateColor=function(N){O._fastSetA(N.node._color.a);var k=O._val;P.prototype.updateColor.call(this,N,k)},M.updateVerts=function(N){var k=N.node,F=N._ttfTexture.width,G=N._ttfTexture.height,V=k.anchorX*k.width,j=k.anchorY*k.height,H=A&&N.getComponent(A);if(H&&H._enabled){var U=(F-k.width)/2,X=(G-k.height)/2,Y=H.offset;-Y.x>U?V+=F-k.width:U>Y.x&&(V+=U-Y.x),-Y.y>X?j+=G-k.height:X>Y.y&&(j+=X-Y.y)}var z=this._local;z[0]=-V,z[1]=-j,z[2]=F-V,z[3]=G-j,this.updateUVs(N),this.updateWorldVerts(N)},I}(w.default);T.default=R,S.exports=T.default},{"../../../../../components/CCLabelShadow":110,"../../../../utils/label/ttf":234}],244:[function(L){var S=P(L("../../../assembler")),T=P(L("../../../../components/CCLabel")),_=P(L("./2d/ttf")),w=P(L("./2d/bmfont")),B=P(L("./2d/letter")),A=P(L("./3d/ttf")),O=P(L("./3d/bmfont")),R=P(L("./3d/letter"));function P(E){return E&&E.__esModule?E:{default:E}}T.default._canvasPool={pool:[],get:function(){var E=this.pool.pop();if(!E){var D=document.createElement("canvas"),I=D.getContext("2d");E={canvas:D,context:I},I.textBaseline="alphabetic"}return E},put:function(E){this.pool.length>=32||this.pool.push(E)}},S.default.register(cc.Label,{getConstructor:function(E){var D=E.node.is3DNode,I=D?A.default:_.default;return E.font instanceof cc.BitmapFont?I=D?O.default:w.default:E.cacheMode===T.default.CacheMode.CHAR&&(cc.sys.platform===cc.sys.WECHAT_GAME_SUB?cc.warn("sorry, subdomain does not support CHAR mode currently!"):I=D?R.default:B.default),I},TTF:_.default,Bmfont:w.default,Letter:B.default,TTF3D:A.default,Bmfont3D:O.default,Letter3D:R.default,NativeTTF:void 0})},{"../../../../components/CCLabel":108,"../../../assembler":224,"./2d/bmfont":240,"./2d/letter":241,"./2d/nativeTTF":242,"./2d/ttf":243,"./3d/bmfont":void 0,"./3d/letter":void 0,"./3d/ttf":void 0}],245:[function(L,S,T){T.__esModule=!0,T.MaskAssembler=void 0;var _,w=(_=L("../../assembler"))&&_.__esModule?_:{default:_};function B(Y,z){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(W,Z){return W.__proto__=Z,W})(Y,z)}var A=L("../../../components/CCMask"),O=L("../../render-flow"),R=L("./sprite/2d/simple"),P=L("./graphics"),E=L("../../../../renderer/gfx"),D=L("../vertex-format").vfmtPos,I=8,M=[];function N(){return 1<<M.length-1}function k(){for(var Y=0,z=0;z<M.length;++z)Y+=1<<z;return Y}function F(Y,z,W,Z,Q,ee){var te=Y.effect,re=E.STENCIL_OP_KEEP,ie=E.STENCIL_OP_KEEP;te.setStencil(E.STENCIL_ENABLE,z,Z,Q,W,re,ie,ee)}function G(Y){M.length+1>I&&cc.errorID(9e3,I),M.push(Y)}function V(Y,z){M.length===0&&cc.errorID(9001),M.pop(),M.length===0?z._flushMaterial(Y._exitMaterial):U(z)}function j(Y,z){var W=E.DS_FUNC_NEVER,Z=N(),Q=Z,ee=Z,te=Y.inverted?E.STENCIL_OP_REPLACE:E.STENCIL_OP_ZERO;F(Y._clearMaterial,W,te,Z,Q,ee);var re=z.getBuffer("mesh",D),ie=re.request(4,6),ne=ie.indiceOffset,he=ie.byteOffset>>2,pe=ie.vertexOffset,K=re._vData,ue=re._iData;K[he++]=-1,K[he++]=-1,K[he++]=-1,K[he++]=1,K[he++]=1,K[he++]=1,K[he++]=1,K[he++]=-1,ue[ne++]=pe,ue[ne++]=pe+3,ue[ne++]=pe+1,ue[ne++]=pe+1,ue[ne++]=pe+3,ue[ne++]=pe+2,z.node=z._dummyNode,z.material=Y._clearMaterial,z._flush()}function H(Y,z){var W=E.DS_FUNC_NEVER,Z=N(),Q=Z,ee=Z,te=Y.inverted?E.STENCIL_OP_ZERO:E.STENCIL_OP_REPLACE;F(Y._materials[0],W,te,Z,Q,ee),z.material=Y._materials[0],Y._type===A.Type.IMAGE_STENCIL?(z.node=z._dummyNode,R.prototype.fillBuffers.call(Y._assembler,Y,z),z._flush()):(z.node=Y.node,P.prototype.fillBuffers.call(Y._graphics._assembler,Y._graphics,z))}function U(Y){var z=E.DS_FUNC_EQUAL,W=E.STENCIL_OP_KEEP,Z=k(),Q=Z,ee=N(),te=M[M.length-1];F(te._enableMaterial,z,W,Z,Q,ee),Y._flushMaterial(te._enableMaterial)}var X=function(Y){var z,W;function Z(){return Y.apply(this,arguments)||this}W=Y,(z=Z).prototype=Object.create(W.prototype),z.prototype.constructor=z,B(z,W);var Q=Z.prototype;return Q.updateRenderData=function(ee){ee._type===A.Type.IMAGE_STENCIL?ee.spriteFrame?R.prototype.updateRenderData.call(this,ee):ee.setMaterial(0,null):(ee._graphics.setMaterial(0,ee._materials[0]),P.prototype.updateRenderData.call(ee._graphics._assembler,ee._graphics,ee._graphics))},Q.fillBuffers=function(ee,te){(ee._type!==A.Type.IMAGE_STENCIL||ee.spriteFrame)&&(G(ee),j(ee,te),H(ee,te),U(te)),ee.node._renderFlag|=O.FLAG_UPDATE_RENDER_DATA},Q.postFillBuffers=function(ee,te){(ee._type!==A.Type.IMAGE_STENCIL||ee.spriteFrame)&&V(ee,te),ee.node._renderFlag|=O.FLAG_UPDATE_RENDER_DATA},Z}(R);T.MaskAssembler=X,w.default.register(A,X)},{"../../../../renderer/gfx":319,"../../../components/CCMask":112,"../../assembler":224,"../../render-flow":228,"../vertex-format":260,"./graphics":238,"./sprite/2d/simple":250}],246:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=B(L("../../assembler-2d")),w=B(L("../../../value-types/mat4"));function B(k){return k&&k.__esModule?k:{default:k}}function A(k,F){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(G,V){return G.__proto__=V,G})(k,F)}var O=L("../../../components/CCMotionStreak"),R=L("../../render-flow");function P(k,F){this.point=k||cc.v2(),this.dir=F||cc.v2(),this.distance=0,this.time=0}P.prototype.setPoint=function(k,F){this.point.x=k,this.point.y=F},P.prototype.setDir=function(k,F){this.dir.x=k,this.dir.y=F},cc.v2(),cc.v2();var E=cc.v2(),D=cc.v2(),I=new w.default;function M(k,F){return k.x=-F.y,k.y=F.x,k}var N=function(k){var F,G;function V(){var H;return(H=k.call(this)||this)._tailShortenTime=0,H}G=k,(F=V).prototype=Object.create(G.prototype),F.prototype.constructor=F,A(F,G);var j=V.prototype;return j.initData=function(){this._renderData.createFlexData(0,16,42)},j.update=function(H,U){var X=H._stroke/2;H.node.getWorldMatrix(I);var Y=I.m[12],z=I.m[13],W=H._points,Z=H._lastWPos,Q=H._fadeTime;if(H._lastWPosUpdated&&(Z.x!==Y||Z.y!==z)){var ee,te=!1;if(W.length===0){var re=new P;re.setPoint(Z.x,Z.y),this._tailShortenTime=re.time=Q,W.push(re),ee=new P,W.unshift(ee)}else{ee=W[0];var ie=W[1],ne=ie.point.x-Y,he=ie.point.y-z;te=ne*ne+he*he>=H.minSeg*H.minSeg}ee.setPoint(Y,z),ee.time=Q+U;var pe=W[1];if(ee.distance=ee.point.sub(pe.point,D).mag(),D.normalizeSelf(),ee.setDir(D.x,D.y),W.length===2&&pe.setDir(D.x,D.y),te){var K=new P(ee.point.clone(),ee.dir.clone());K.distance=ee.distance,K.time=ee.time,W.unshift(K)}}if(Z.x=Y,Z.y=z,H._lastWPosUpdated=!0,!(W.length<2)){var ue,le=H._color,ce=le.a,_e=le.b<<16|le.g<<8|le.r,oe=0,de=this._renderData._flexBuffer;de.reserve(2*W.length,6*(W.length-1));for(var me=de.vData,ye=de.uintVData,ge=W.length-1;ge>=0;ge--){var we=W[ge],Te=we.point,Ee=we.dir;we.time-=U;var De=ge===W.length-1;if(we.time<=0)De&&ge-1>=0&&(this._tailShortenTime=W[ge-1].time-U),W.splice(ge,1);else{var fe=we.time/Q;if(De){var Ce=W[ge-1];if(!Ce){W.splice(ge,1);continue}if(W.length>=3){var Se=we.time/this._tailShortenTime;Se<=1&&(Te.x=Ce.point.x-Ce.distance*Ce.dir.x*Se,Te.y=Ce.point.y-Ce.distance*Ce.dir.y*Se)}else this._tailShortenTime=we.time}M(E,Ee);var be=fe*ce<<24>>>0|_e,Re=5*oe;me[Re]=Te.x+E.x*X,me[Re+1]=Te.y+E.y*X,me[Re+2]=1,me[Re+3]=fe,ye[Re+4]=be,me[Re+=5]=Te.x-E.x*X,me[Re+1]=Te.y-E.y*X,me[Re+2]=0,me[Re+3]=fe,ye[Re+4]=be,oe+=2}}ue=oe<=2?0:3*(oe-2),de.used(oe,ue)}},j.fillBuffers=function(H,U){var X=this._renderData._flexBuffer,Y=X.vData,z=X.usedVertices,W=X.usedIndices,Z=X.usedVerticesFloats,Q=U._meshBuffer,ee=Q.request(z,W),te=ee.byteOffset>>2,re=Q._vData;Y.length+te>re.length?re.set(Y.subarray(0,Z),te):re.set(Y,te);for(var ie=Q._iData,ne=ee.indiceOffset,he=ee.vertexOffset,pe=0,K=z;pe<K;pe+=2){var ue=he+pe;ie[ne++]=ue,ie[ne++]=ue+2,ie[ne++]=ue+1,ie[ne++]=ue+1,ie[ne++]=ue+2,ie[ne++]=ue+3}H.node._renderFlag|=R.FLAG_UPDATE_RENDER_DATA},V}(_.default);T.default=N,N.register(O,N),S.exports=T.default},{"../../../components/CCMotionStreak":113,"../../../value-types/mat4":288,"../../assembler-2d":222,"../../render-flow":228}],247:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../../../assembler-2d"))&&_.__esModule?_:{default:_};function B(R,P){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(E,D){return E.__proto__=D,E})(R,P)}var A=L("../../../../../components/CCSprite").FillType,O=function(R){var P,E;function D(){return R.apply(this,arguments)||this}E=R,(P=D).prototype=Object.create(E.prototype),P.prototype.constructor=P,B(P,E);var I=D.prototype;return I.updateRenderData=function(M){var N=M._spriteFrame;if(this.packToDynamicAtlas(M,N),M._vertsDirty){var k=M._fillStart,F=M._fillRange;F<0&&(k+=F,F=-F),F=(F=(F=k+F)>1?1:F)<0?0:F;var G=(k=(k=k>1?1:k)<0?0:k)+(F=(F-=k)<0?0:F);G=G>1?1:G,this.updateUVs(M,k,G),this.updateVerts(M,k,G),M._vertsDirty=!1}},I.updateUVs=function(M,N,k){var F,G,V,j,H,U,X,Y,z,W,Z=M._spriteFrame,Q=Z._texture.width,ee=Z._texture.height,te=Z._rect;Z._rotated?(F=te.x/Q,G=(te.y+te.width)/ee,V=H=F,X=z=(te.x+te.height)/Q,U=W=G,j=Y=te.y/ee):(F=te.x/Q,G=(te.y+te.height)/ee,V=X=F,H=z=(te.x+te.width)/Q,j=U=G,Y=W=te.y/ee);var re=this._renderData.vDatas[0],ie=this.uvOffset,ne=this.floatsPerVert;switch(M._fillType){case A.HORIZONTAL:re[ie]=V+(H-V)*N,re[ie+1]=j+(U-j)*N,re[ie+ne]=V+(H-V)*k,re[ie+ne+1]=j+(U-j)*k,re[ie+2*ne]=X+(z-X)*N,re[ie+2*ne+1]=Y+(W-Y)*N,re[ie+3*ne]=X+(z-X)*k,re[ie+3*ne+1]=Y+(W-Y)*k;break;case A.VERTICAL:re[ie]=V+(X-V)*N,re[ie+1]=j+(Y-j)*N,re[ie+ne]=H+(z-H)*N,re[ie+ne+1]=U+(W-U)*N,re[ie+2*ne]=V+(X-V)*k,re[ie+2*ne+1]=j+(Y-j)*k,re[ie+3*ne]=H+(z-H)*k,re[ie+3*ne+1]=U+(W-U)*k;break;default:cc.errorID(2626)}},I.updateVerts=function(M,N,k){var F,G=M.node,V=G.width,j=G.height,H=G.anchorX*V,U=G.anchorY*j,X=-H,Y=-U,z=V-H,W=j-U;switch(M._fillType){case A.HORIZONTAL:F=X+(z-X)*k,X+=(z-X)*N,z=F;break;case A.VERTICAL:F=Y+(W-Y)*k,Y+=(W-Y)*N,W=F;break;default:cc.errorID(2626)}var Z=this._local;Z[0]=X,Z[1]=Y,Z[2]=z,Z[3]=W,this.updateWorldVerts(M)},D}(w.default);T.default=O,S.exports=T.default},{"../../../../../components/CCSprite":123,"../../../../assembler-2d":222}],248:[function(L,S,T){var _;function w(A,O){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,P){return R.__proto__=P,R})(A,O)}T.__esModule=!0,T.default=void 0;var B=function(A){var O,R;function P(){return A.apply(this,arguments)||this}R=A,(O=P).prototype=Object.create(R.prototype),O.prototype.constructor=O,w(O,R);var E=P.prototype;return E.initData=function(){this._renderData.createFlexData(0,4,6,this.getVfmt())},E.updateRenderData=function(D){this.packToDynamicAtlas(D,D._spriteFrame);var I=D.spriteFrame;if(I){var M=I.vertices;if(M){this.verticesCount=M.x.length,this.indicesCount=M.triangles.length;var N=this._renderData._flexBuffer;N.reserve(this.verticesCount,this.indicesCount)&&(this.updateColor(D),D._vertsDirty=!0),N.used(this.verticesCount,this.indicesCount),this.updateIndices(M.triangles),D._vertsDirty&&(this.updateUVs(D),this.updateVerts(D),this.updateWorldVerts(D),D._vertsDirty=!1)}}},E.updateIndices=function(D){this._renderData.iDatas[0].set(D)},E.updateUVs=function(D){for(var I=D.spriteFrame.vertices,M=I.nu,N=I.nv,k=this.uvOffset,F=this.floatsPerVert,G=this._renderData.vDatas[0],V=0;V<M.length;V++){var j=F*V+k;G[j]=M[V],G[j+1]=N[V]}},E.updateVerts=function(D){var I=D.node,M=Math.abs(I.width),N=Math.abs(I.height),k=I.anchorX*M,F=I.anchorY*N,G=D.spriteFrame,V=G.vertices,j=V.x,H=V.y,U=G._originalSize.width,X=G._originalSize.height,Y=G._rect.width,z=G._rect.height,W=G._offset.x+(U-Y)/2,Z=G._offset.y+(X-z)/2,Q=M/(D.trim?Y:U),ee=N/(D.trim?z:X),te=this._local;if(D.trim)for(var re=0,ie=j.length;re<ie;re++){var ne=2*re;te[ne]=(j[re]-W)*Q-k,te[ne+1]=(X-H[re]-Z)*ee-F}else for(var he=0,pe=j.length;he<pe;he++){var K=2*he;te[K]=j[he]*Q-k,te[K+1]=(X-H[he])*ee-F}if(G._flipX)for(var ue=0,le=this.verticesCount;ue<le;ue++)te[2*ue]=M-te[2*ue]-2*k;if(G._flipY)for(var ce=0,_e=this.verticesCount;ce<_e;ce++)te[2*ce+1]=N-te[2*ce+1]-2*F},E.updateWorldVerts=function(D){for(var I=D.node._worldMatrix.m,M=I[0],N=I[1],k=I[4],F=I[5],G=I[12],V=I[13],j=this._local,H=this._renderData.vDatas[0],U=this.floatsPerVert,X=0,Y=this.verticesCount;X<Y;X++){var z=j[2*X],W=j[2*X+1];H[U*X]=z*M+W*k+G,H[U*X+1]=z*N+W*F+V}},P}(((_=L("../../../../assembler-2d"))&&_.__esModule?_:{default:_}).default);T.default=B,S.exports=T.default},{"../../../../assembler-2d":222}],249:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../../../assembler-2d"))&&_.__esModule?_:{default:_};function B(V,j){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(H,U){return H.__proto__=U,H})(V,j)}var A=2*Math.PI,O=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],R=[0,0,0,0],P=[0,0,0,0,0,0,0,0],E=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],D=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],I=cc.v2(0,0),M=[];function N(V,j,H,U,X,Y,z){var W,Z,Q=Math.sin(Y),ee=Math.cos(Y);if(Math.cos(Y)!==0){if(W=Q/ee,(V-X.x)*ee>0){var te=X.y+W*(V-X.x);z[0].x=V,z[0].y=te}if((j-X.x)*ee>0){var re=X.y+W*(j-X.x);z[2].x=j,z[2].y=re}}if(Math.sin(Y)!==0){if(Z=ee/Q,(U-X.y)*Q>0){var ie=X.x+Z*(U-X.y);z[3].x=ie,z[3].y=U}if((H-X.y)*Q>0){var ne=X.x+Z*(H-X.y);z[1].x=ne,z[1].y=H}}}function k(V){var j=V.node,H=j.width,U=j.height,X=j.anchorX*H,Y=j.anchorY*U,z=-X,W=-Y,Z=H-X,Q=U-Y,ee=R;ee[0]=z,ee[1]=W,ee[2]=Z,ee[3]=Q;var te=V._fillCenter,re=I.x=Math.min(Math.max(0,te.x),1)*(Z-z)+z,ie=I.y=Math.min(Math.max(0,te.y),1)*(Q-W)+W;O[0].x=O[3].x=z,O[1].x=O[2].x=Z,O[0].y=O[1].y=W,O[2].y=O[3].y=Q,M.length=0,re!==ee[0]&&(M[0]=[3,0]),re!==ee[2]&&(M[2]=[1,2]),ie!==ee[1]&&(M[1]=[0,1]),ie!==ee[3]&&(M[3]=[2,3])}function F(V,j){var H,U;if(H=j.x-V.x,U=j.y-V.y,H!==0||U!==0){if(H===0)return U>0?.5*Math.PI:1.5*Math.PI;var X=Math.atan(U/H);return H<0&&(X+=Math.PI),X}}var G=function(V){var j,H;function U(){return V.apply(this,arguments)||this}H=V,(j=U).prototype=Object.create(H.prototype),j.prototype.constructor=j,B(j,H);var X=U.prototype;return X.initData=function(){this._renderData.createFlexData(0,4,6,this.getVfmt()),this.updateIndices()},X.updateRenderData=function(Y){V.prototype.updateRenderData.call(this,Y);var z,W,Z,Q,ee,te,re,ie,ne,he=Y.spriteFrame;if(this.packToDynamicAtlas(Y,he),Y._vertsDirty){var pe=Y._fillStart,K=Y._fillRange;for(K<0&&(pe+=K,K=-K);pe>=1;)pe-=1;for(;pe<0;)pe+=1;pe*=A,K*=A,k(Y),te=(z=he)._texture.width,re=z._texture.height,ie=z._rect,ne=P,z._rotated?(W=ie.x/te,Z=(ie.x+ie.height)/te,Q=ie.y/re,ee=(ie.y+ie.width)/re,ne[0]=ne[2]=W,ne[4]=ne[6]=Z,ne[3]=ne[7]=ee,ne[1]=ne[5]=Q):(W=ie.x/te,Z=(ie.x+ie.width)/te,Q=ie.y/re,ee=(ie.y+ie.height)/re,ne[0]=ne[4]=W,ne[2]=ne[6]=Z,ne[1]=ne[3]=ee,ne[5]=ne[7]=Q),N(R[0],R[2],R[1],R[3],I,pe,E),N(R[0],R[2],R[1],R[3],I,pe+K,D),this.updateVerts(Y,pe,K),Y._vertsDirty=!1}},X.updateVerts=function(Y,z,W){var Z=z+W,Q=this._local;Q.length=0;for(var ee=0,te=3*this.floatsPerVert,re=0;re<4;++re){var ie=M[re];if(ie)if(W>=A)Q.length=ee+te,this._generateTriangle(Q,ee,I,O[ie[0]],O[ie[1]]),ee+=te;else{var ne=F(I,O[ie[0]]),he=F(I,O[ie[1]]);he<ne&&(he+=A),ne-=A,he-=A;for(var pe=0;pe<3;++pe)ne>=Z||(ne>=z?(Q.length=ee+te,he>=Z?this._generateTriangle(Q,ee,I,O[ie[0]],D[re]):this._generateTriangle(Q,ee,I,O[ie[0]],O[ie[1]]),ee+=te):he<=z||(he<=Z?(Q.length=ee+te,this._generateTriangle(Q,ee,I,E[re],O[ie[1]]),ee+=te):(Q.length=ee+te,this._generateTriangle(Q,ee,I,E[re],D[re]),ee+=te))),ne+=A,he+=A}}this.allocWorldVerts(Y),this.updateWorldVerts(Y)},X.allocWorldVerts=function(Y){var z=Y.node._color._val,W=this._renderData,Z=this.floatsPerVert,Q=this._local,ee=Q.length/Z;this.verticesCount=this.indicesCount=ee;var te=W._flexBuffer;te.reserve(ee,ee)&&this.updateIndices(),te.used(this.verticesCount,this.indicesCount);for(var re=W.vDatas[0],ie=W.uintVDatas[0],ne=this.uvOffset,he=0;he<Q.length;he+=Z){var pe=he+ne;re[pe]=Q[pe],re[pe+1]=Q[pe+1],ie[pe+2]=z}},X.updateIndices=function(){for(var Y=this._renderData.iDatas[0],z=0;z<Y.length;z++)Y[z]=z},X.updateWorldVerts=function(Y){for(var z=Y.node._worldMatrix.m,W=z[0],Z=z[1],Q=z[4],ee=z[5],te=z[12],re=z[13],ie=this._local,ne=this._renderData.vDatas[0],he=this.floatsPerVert,pe=0;pe<ie.length;pe+=he){var K=ie[pe],ue=ie[pe+1];ne[pe]=K*W+ue*Q+te,ne[pe+1]=K*Z+ue*ee+re}},X._generateTriangle=function(Y,z,W,Z,Q){var ee=R,te=ee[0],re=ee[1],ie=ee[2],ne=ee[3],he=this.floatsPerVert;Y[z]=W.x,Y[z+1]=W.y,Y[z+he]=Z.x,Y[z+he+1]=Z.y,Y[z+2*he]=Q.x,Y[z+2*he+1]=Q.y;var pe,K,ue=this.uvOffset;pe=(W.x-te)/(ie-te),K=(W.y-re)/(ne-re),this._generateUV(pe,K,Y,z+ue),pe=(Z.x-te)/(ie-te),K=(Z.y-re)/(ne-re),this._generateUV(pe,K,Y,z+he+ue),pe=(Q.x-te)/(ie-te),K=(Q.y-re)/(ne-re),this._generateUV(pe,K,Y,z+2*he+ue)},X._generateUV=function(Y,z,W,Z){var Q=P[0]+(P[2]-P[0])*Y,ee=P[4]+(P[6]-P[4])*Y,te=P[1]+(P[3]-P[1])*Y,re=P[5]+(P[7]-P[5])*Y;W[Z]=Q+(ee-Q)*z,W[Z+1]=te+(re-te)*z},U}(w.default);T.default=G,S.exports=T.default},{"../../../../assembler-2d":222}],250:[function(L,S,T){var _;function w(A,O){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,P){return R.__proto__=P,R})(A,O)}T.__esModule=!0,T.default=void 0;var B=function(A){var O,R;function P(){return A.apply(this,arguments)||this}R=A,(O=P).prototype=Object.create(R.prototype),O.prototype.constructor=O,w(O,R);var E=P.prototype;return E.updateRenderData=function(D){this.packToDynamicAtlas(D,D._spriteFrame),D._vertsDirty&&(this.updateUVs(D),this.updateVerts(D),D._vertsDirty=!1)},E.updateUVs=function(D){for(var I=D._spriteFrame.uv,M=this.uvOffset,N=this.floatsPerVert,k=this._renderData.vDatas[0],F=0;F<4;F++){var G=2*F,V=N*F+M;k[V]=I[G],k[V+1]=I[G+1]}},E.updateVerts=function(D){var I,M,N,k,F=D.node,G=F.width,V=F.height,j=F.anchorX*G,H=F.anchorY*V;if(D.trim)I=-j,M=-H,N=G-j,k=V-H;else{var U=D.spriteFrame,X=U._originalSize.width,Y=U._originalSize.height,z=U._rect.width,W=U._rect.height,Z=U._offset,Q=G/X,ee=V/Y,te=Z.x+(X-z)/2,re=Z.x-(X-z)/2;I=te*Q-j,M=(Z.y+(Y-W)/2)*ee-H,N=G+re*Q-j,k=V+(Z.y-(Y-W)/2)*ee-H}var ie=this._local;ie[0]=I,ie[1]=M,ie[2]=N,ie[3]=k,this.updateWorldVerts(D)},P}(((_=L("../../../../assembler-2d"))&&_.__esModule?_:{default:_}).default);T.default=B,S.exports=T.default},{"../../../../assembler-2d":222}],251:[function(L,S,T){var _;function w(A,O){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,P){return R.__proto__=P,R})(A,O)}T.__esModule=!0,T.default=void 0;var B=function(A){var O,R;function P(){return A.apply(this,arguments)||this}R=A,(O=P).prototype=Object.create(R.prototype),O.prototype.constructor=O,w(O,R);var E=P.prototype;return E.initData=function(){if(!(this._renderData.meshCount>0)){this._renderData.createData(0,this.verticesFloats,this.indicesCount);for(var D=this._renderData.iDatas[0],I=0,M=0;M<3;++M)for(var N=0;N<3;++N){var k=4*M+N;D[I++]=k,D[I++]=k+1,D[I++]=k+4,D[I++]=k+1,D[I++]=k+5,D[I++]=k+4}}},E.initLocal=function(){this._local=[],this._local.length=8},E.updateRenderData=function(D){var I=D._spriteFrame;this.packToDynamicAtlas(D,I),D._vertsDirty&&(this.updateUVs(D),this.updateVerts(D),D._vertsDirty=!1)},E.updateVerts=function(D){var I=D.node,M=I.width,N=I.height,k=I.anchorX*M,F=I.anchorY*N,G=D.spriteFrame,V=G.insetLeft,j=G.insetRight,H=G.insetTop,U=G.insetBottom,X=M-V-j,Y=N-H-U,z=M/(V+j),W=N/(H+U);z=isNaN(z)||z>1?1:z,W=isNaN(W)||W>1?1:W,X=X<0?0:X,Y=Y<0?0:Y;var Z=this._local;Z[0]=-k,Z[1]=-F,Z[2]=V*z-k,Z[3]=U*W-F,Z[4]=Z[2]+X,Z[5]=Z[3]+Y,Z[6]=M-k,Z[7]=N-F,this.updateWorldVerts(D)},E.updateUVs=function(D){for(var I=this._renderData.vDatas[0],M=D.spriteFrame.uvSliced,N=this.uvOffset,k=this.floatsPerVert,F=0;F<4;++F)for(var G=0;G<4;++G){var V=4*F+G,j=M[V],H=V*k;I[H+N]=j.u,I[H+N+1]=j.v}},E.updateWorldVerts=function(D){for(var I=D.node._worldMatrix.m,M=I[0],N=I[1],k=I[4],F=I[5],G=I[12],V=I[13],j=this._local,H=this._renderData.vDatas[0],U=this.floatsPerVert,X=0;X<4;++X)for(var Y=j[2*X+1],z=0;z<4;++z){var W=j[2*z],Z=(4*X+z)*U;H[Z]=W*M+Y*k+G,H[Z+1]=W*N+Y*F+V}},P}(((_=L("../../../../assembler-2d"))&&_.__esModule?_:{default:_}).default);T.default=B,Object.assign(B.prototype,{verticesCount:16,indicesCount:54}),S.exports=T.default},{"../../../../assembler-2d":222}],252:[function(L,S,T){var _;function w(A,O){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,P){return R.__proto__=P,R})(A,O)}T.__esModule=!0,T.default=void 0;var B=function(A){var O,R;function P(){return A.apply(this,arguments)||this}R=A,(O=P).prototype=Object.create(R.prototype),O.prototype.constructor=O,w(O,R);var E=P.prototype;return E.initData=function(){this.verticesCount=0,this.contentWidth=0,this.contentHeight=0,this.rectWidth=0,this.rectHeight=0,this.hRepeat=0,this.vRepeat=0,this.row=0,this.col=0,this._renderData.createFlexData(0,4,6,this.getVfmt()),this._updateIndices()},E.initLocal=function(){this._local={x:[],y:[]}},E._updateIndices=function(){for(var D=this._renderData.iDatas[0],I=0,M=0,N=D.length;I<N;I+=6,M+=4)D[I]=M,D[I+1]=M+1,D[I+2]=M+2,D[I+3]=M+1,D[I+4]=M+3,D[I+5]=M+2},E.updateRenderData=function(D){var I=D._spriteFrame;this.packToDynamicAtlas(D,I);var M=D.node,N=this.contentWidth=Math.abs(M.width),k=this.contentHeight=Math.abs(M.height),F=I._rect,G=I.insetLeft,V=I.insetRight,j=F.width-G-V,H=I.insetTop,U=I.insetBottom,X=F.height-H-U;this.sizableWidth=N-G-V,this.sizableHeight=k-H-U,this.sizableWidth=this.sizableWidth>0?this.sizableWidth:0,this.sizableHeight=this.sizableHeight>0?this.sizableHeight:0;var Y=this.hRepeat=j===0?this.sizableWidth:this.sizableWidth/j,z=this.vRepeat=X===0?this.sizableHeight:this.sizableHeight/X,W=(this.row=Math.ceil(z+2))*(this.col=Math.ceil(Y+2));this.verticesCount=4*W,this.indicesCount=6*W;var Z=this._renderData._flexBuffer;Z.reserve(this.verticesCount,this.indicesCount)&&(this._updateIndices(),this.updateColor(D)),Z.used(this.verticesCount,this.indicesCount),D._vertsDirty&&(this.updateUVs(D),this.updateVerts(D),D._vertsDirty=!1)},E.updateVerts=function(D){var I=D._spriteFrame,M=I._rect,N=D.node,k=N.anchorX*N.width,F=N.anchorY*N.height,G=this.row,V=this.col,j=this.contentWidth,H=this.contentHeight,U=this._local,X=U.x,Y=U.y;X.length=Y.length=0;var z,W,Z=I.insetLeft,Q=I.insetRight,ee=M.width-Z-Q,te=I.insetTop,re=I.insetBottom,ie=M.height-te-re,ne=N.width/(Z+Q)>1?1:N.width/(Z+Q),he=N.height/(te+re)>1?1:N.height/(te+re);z=ee>0?Math.floor(1e3*this.sizableWidth)/1e3%ee==0?ee:this.sizableWidth%ee:this.sizableWidth,W=ie>0?Math.floor(1e3*this.sizableHeight)/1e3%ie==0?ie:this.sizableHeight%ie:this.sizableHeight;for(var pe=0;pe<=V;pe++)pe===0?X[pe]=-k:pe>0&&pe<V?X[pe]=pe===1?Z*ne+Math.min(ee,this.sizableWidth)-k:ee>0?pe===V-1?Z+z+ee*(pe-2)-k:Z+Math.min(ee,this.sizableWidth)+ee*(pe-2)-k:Z+this.sizableWidth-k:pe===V&&(X[pe]=Math.min(Z+this.sizableWidth+Q,j)-k);for(var K=0;K<=G;K++)K===0?Y[K]=-F:K>0&&K<G?Y[K]=K===1?re*he+Math.min(ie,this.sizableHeight)-F:ie>0?K===G-1?re+W+(K-2)*ie-F:re+Math.min(ie,this.sizableHeight)+(K-2)*ie-F:re+this.sizableHeight-F:K===G&&(Y[K]=Math.min(re+this.sizableHeight+te,H)-F);this.updateWorldVerts(D)},E.updateWorldVerts=function(D){for(var I,M,N,k,F=this._renderData,G=this._local,V=G.x,j=G.y,H=F.vDatas[0],U=this.row,X=this.col,Y=D.node._worldMatrix.m,z=Y[0],W=Y[1],Z=Y[4],Q=Y[5],ee=Y[12],te=Y[13],re=this.floatsPerVert,ie=0,ne=0,he=U;ne<he;++ne){N=j[ne],k=j[ne+1];for(var pe=0,K=X;pe<K;++pe)I=V[pe],M=V[pe+1],H[ie]=I*z+N*Z+ee,H[ie+1]=I*W+N*Q+te,H[ie+=re]=M*z+N*Z+ee,H[ie+1]=M*W+N*Q+te,H[ie+=re]=I*z+k*Z+ee,H[ie+1]=I*W+k*Q+te,H[ie+=re]=M*z+k*Z+ee,H[ie+1]=M*W+k*Q+te,ie+=re}},E.updateUVs=function(D){var I=this._renderData.vDatas[0];if(I)for(var M=D._spriteFrame,N=M._rect,k=M.insetLeft,F=M.insetRight,G=N.width-k-F,V=M.insetTop,j=M.insetBottom,H=N.height-V-j,U=this.row,X=this.col,Y=this.hRepeat,z=this.vRepeat,W=0,Z=0,Q=D.spriteFrame.uv,ee=D.spriteFrame.uvSliced,te=D.spriteFrame._rotated,re=this.floatsPerVert,ie=this.uvOffset,ne=[],he=[],pe=0,K=U;pe<K;++pe){Z=this.sizableHeight>H?this.sizableHeight>=pe*H?1:z%1:z;for(var ue=0,le=X;ue<le;++ue)W=this.sizableWidth>G?this.sizableWidth>=ue*G?1:Y%1:Y,te?(pe===0?(ne[0]=ee[0].u,ne[1]=ee[0].u,ne[2]=ee[4].u+(ee[8].u-ee[4].u)*Z):pe<U-1?(ne[0]=ee[4].u,ne[1]=ee[4].u,ne[2]=ee[4].u+(ee[8].u-ee[4].u)*Z):pe===U-1&&(ne[0]=ee[8].u,ne[1]=ee[8].u,ne[2]=ee[12].u),ue===0?(he[0]=ee[0].v,he[1]=ee[1].v+(ee[2].v-ee[1].v)*W,he[2]=ee[0].v):ue<X-1?(he[0]=ee[1].v,he[1]=ee[1].v+(ee[2].v-ee[1].v)*W,he[2]=ee[1].v):ue===X-1&&(he[0]=ee[2].v,he[1]=ee[3].v,he[2]=ee[2].v),ne[3]=ne[2],he[3]=he[1]):(ue===0?(ne[0]=ee[0].u,ne[1]=ee[1].u+(ee[2].u-ee[1].u)*W,ne[2]=Q[0]):ue<X-1?(ne[0]=ee[1].u,ne[1]=ee[1].u+(ee[2].u-ee[1].u)*W,ne[2]=ee[1].u):ue===X-1&&(ne[0]=ee[2].u,ne[1]=ee[3].u,ne[2]=ee[2].u),pe===0?(he[0]=ee[0].v,he[1]=ee[0].v,he[2]=ee[4].v+(ee[8].v-ee[4].v)*Z):pe<U-1?(he[0]=ee[4].v,he[1]=ee[4].v,he[2]=ee[4].v+(ee[8].v-ee[4].v)*Z):pe===U-1&&(he[0]=ee[8].v,he[1]=ee[8].v,he[2]=ee[12].v),ne[3]=ne[1],he[3]=he[2]),I[ie]=ne[0],I[ie+1]=he[0],I[ie+=re]=ne[1],I[ie+1]=he[1],I[ie+=re]=ne[2],I[ie+1]=he[2],I[ie+=re]=ne[3],I[ie+1]=he[3],ie+=re}},P}(((_=L("../../../../assembler-2d"))&&_.__esModule?_:{default:_}).default);T.default=B,S.exports=T.default},{"../../../../assembler-2d":222}],253:[function(L){var S=k(L("../../../assembler")),T=L("../../../../components/CCSprite"),_=k(L("./2d/simple")),w=k(L("./2d/sliced")),B=k(L("./2d/tiled")),A=k(L("./2d/radial-filled")),O=k(L("./2d/bar-filled")),R=k(L("./2d/mesh")),P=k(L("./3d/simple")),E=k(L("./3d/sliced")),D=k(L("./3d/tiled")),I=k(L("./3d/radial-filled")),M=k(L("./3d/bar-filled")),N=k(L("./3d/mesh"));function k(G){return G&&G.__esModule?G:{default:G}}var F={getConstructor:function(G){var V=G.node.is3DNode,j=V?P.default:_.default;switch(G.type){case T.Type.SLICED:j=V?E.default:w.default;break;case T.Type.TILED:j=V?D.default:B.default;break;case T.Type.FILLED:j=G._fillType===T.FillType.RADIAL?V?I.default:A.default:V?M.default:O.default;break;case T.Type.MESH:j=V?N.default:R.default}return j},Simple:_.default,Sliced:w.default,Tiled:B.default,RadialFilled:A.default,BarFilled:O.default,Mesh:R.default,Simple3D:P.default,Sliced3D:E.default,Tiled3D:D.default,RadialFilled3D:I.default,BarFilled3D:M.default,Mesh3D:N.default};S.default.register(cc.Sprite,F)},{"../../../../components/CCSprite":123,"../../../assembler":224,"./2d/bar-filled":247,"./2d/mesh":248,"./2d/radial-filled":249,"./2d/simple":250,"./2d/sliced":251,"./2d/tiled":252,"./3d/bar-filled":void 0,"./3d/mesh":void 0,"./3d/radial-filled":void 0,"./3d/simple":void 0,"./3d/sliced":void 0,"./3d/tiled":void 0}],254:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=function(){function w(A,O,R,P,E){this._handler=A,this._index=O,this._vfmt=E,this._verticesBytes=E._bytes,this._initVerticesCount=R,this._initIndicesCount=P,this.reset()}var B=w.prototype;return B._reallocVData=function(A,O){this.vData=new Float32Array(A),this.uintVData=new Uint32Array(this.vData.buffer),O&&this.vData.set(O),this._handler.updateMesh(this._index,this.vData,this.iData)},B._reallocIData=function(A,O){this.iData=new Uint16Array(A),O&&this.iData.set(O),this._handler.updateMesh(this._index,this.vData,this.iData)},B.reserve=function(A,O){var R=A*this._verticesBytes>>2,P=this.vData.length,E=!1;if(R>P){for(;P<R;)P*=2;this._reallocVData(P,this.vData),E=!0}var D=this.iData.length;if(O>D){for(;D<O;)D*=2;this._reallocIData(O,this.iData),E=!0}return E},B.used=function(A,O){this.usedVertices=A,this.usedIndices=O,this.usedVerticesFloats=A*this._verticesBytes>>2,this._handler.updateMeshRange(A,O)},B.reset=function(){var A=this._initVerticesCount*this._verticesBytes>>2;this._reallocVData(A),this._reallocIData(this._initIndicesCount),this.usedVertices=0,this.usedVerticesFloats=0,this.usedIndices=0},w}();T.default=_,cc.FlexBuffer=_,S.exports=T.default},{}],255:[function(L,S){var T,_,w,B=(T=L("../../../renderer/gfx"))&&T.__esModule?T:{default:T};_=cc.sys.platform===cc.sys.WECHAT_GAME?(cc.sys.os===cc.sys.OS_IOS||cc.sys.os===cc.sys.OS_OSX)&&((w=GameGlobal)==null?void 0:w.isIOSHighPerformanceMode)&&/(OS 1[4-9])|(Version\/1[4-9])/.test(window.navigator.userAgent):(cc.sys.os===cc.sys.OS_IOS||cc.sys.os===cc.sys.OS_OSX)&&cc.sys.isBrowser&&/(OS 1[4-9])|(Version\/1[4-9])/.test(window.navigator.userAgent);var A=cc.Class({name:"cc.MeshBuffer",ctor:function(O,R){this.init(O,R)},init:function(O,R){this.byteOffset=0,this.indiceOffset=0,this.vertexOffset=0,this.indiceStart=0,this._dirty=!1,this._vertexFormat=R,this._vertexBytes=this._vertexFormat._bytes,this._arrOffset=0,this._vbArr=[],this._vb=new B.default.VertexBuffer(O._device,R,B.default.USAGE_DYNAMIC,new ArrayBuffer,0),this._vbArr[0]=this._vb,this._ibArr=[],this._ib=new B.default.IndexBuffer(O._device,B.default.INDEX_FMT_UINT16,B.default.USAGE_STATIC,new ArrayBuffer,0),this._ibArr[0]=this._ib,this._vData=null,this._uintVData=null,this._iData=null,this._batcher=O,this._initVDataCount=256*R._bytes,this._initIDataCount=1536,this._offsetInfo={byteOffset:0,vertexOffset:0,indiceOffset:0},this._reallocBuffer()},uploadData:function(){if(this.byteOffset!==0&&this._dirty){var O=new Float32Array(this._vData.buffer,0,this.byteOffset>>2),R=new Uint16Array(this._iData.buffer,0,this.indiceOffset);this._vb.update(0,O),this._ib.update(0,R),this._dirty=!1}},switchBuffer:function(){var O=++this._arrOffset;this.byteOffset=0,this.vertexOffset=0,this.indiceOffset=0,this.indiceStart=0,O<this._vbArr.length?(this._vb=this._vbArr[O],this._ib=this._ibArr[O]):(this._vb=new B.default.VertexBuffer(this._batcher._device,this._vertexFormat,B.default.USAGE_DYNAMIC,new ArrayBuffer,0),this._vbArr[O]=this._vb,this._ib=new B.default.IndexBuffer(this._batcher._device,B.default.INDEX_FMT_UINT16,B.default.USAGE_STATIC,new ArrayBuffer,0),this._ibArr[O]=this._ib)},checkAndSwitchBuffer:function(O){this.vertexOffset+O>65535&&(this.uploadData(),this._batcher._flush(),this.switchBuffer())},requestStatic:function(O,R){this.checkAndSwitchBuffer(O);var P=this.byteOffset+O*this._vertexBytes,E=this.indiceOffset+R,D=this._vData.byteLength,I=this._iData.length;if(P>D||E>I){for(;D<P||I<E;)this._initVDataCount*=2,this._initIDataCount*=2,D=4*this._initVDataCount,I=this._initIDataCount;this._reallocBuffer()}this._updateOffset(O,R,P)},_updateOffset:function(O,R,P){var E=this._offsetInfo;E.vertexOffset=this.vertexOffset,this.vertexOffset+=O,E.indiceOffset=this.indiceOffset,this.indiceOffset+=R,E.byteOffset=this.byteOffset,this.byteOffset=P,this._dirty=!0},request:function(O,R){return this._batcher._buffer!==this&&(this._batcher._flush(),this._batcher._buffer=this),this.requestStatic(O,R),this._offsetInfo},_reallocBuffer:function(){this._reallocVData(!0),this._reallocIData(!0)},_reallocVData:function(O){var R;this._vData&&(R=new Uint8Array(this._vData.buffer)),this._vData=new Float32Array(this._initVDataCount),this._uintVData=new Uint32Array(this._vData.buffer);var P=new Uint8Array(this._uintVData.buffer);if(R&&O)for(var E=0,D=R.length;E<D;E++)P[E]=R[E]},_reallocIData:function(O){var R=this._iData;if(this._iData=new Uint16Array(this._initIDataCount),R&&O)for(var P=this._iData,E=0,D=R.length;E<D;E++)P[E]=R[E]},reset:function(){this._arrOffset=0,this._vb=this._vbArr[0],this._ib=this._ibArr[0],this.byteOffset=0,this.indiceOffset=0,this.vertexOffset=0,this.indiceStart=0,this._dirty=!1},destroy:function(){this.reset();for(var O=0;O<this._vbArr.length;O++)this._vbArr[O].destroy();this._vbArr=null;for(var R=0;R<this._ibArr.length;R++)this._ibArr[R].destroy();this._ibArr=null,this._ib=null,this._vb=null},forwardIndiceStartToOffset:function(){this.indiceStart=this.indiceOffset}});_&&(A.prototype.checkAndSwitchBuffer=function(O){this.vertexOffset+O>65535&&(this.uploadData(),this._batcher._flush())},A.prototype.forwardIndiceStartToOffset=function(){this.uploadData(),this.switchBuffer()}),cc.MeshBuffer=S.exports=A},{"../../../renderer/gfx":319}],256:[function(L,S){var T=B(L("../../../renderer/core/input-assembler")),_=B(L("../../../renderer/memop/recycle-pool")),w=B(L("../../../renderer/scene/model"));function B(G){return G&&G.__esModule?G:{default:G}}var A=L("./vertex-format"),O=A.vfmtPosUvColor,R=A.vfmt3D,P=L("./quad-buffer"),E=L("./mesh-buffer"),D=L("./spine-buffer"),I=L("../../assets/material/CCMaterial"),M=(new(L("../../platform/id-generater"))("VertextFormat"),{}),N=new I,k=new T.default;k._count=0;var F=function(G,V){this._renderScene=V,this._device=G,this.walking=!1,this.material=N,this.cullingMask=1,this._iaPool=new _.default(function(){return new T.default},16),this._modelPool=new _.default(function(){return new w.default},16),this._quadBuffer=this.getBuffer("quad",O),this._meshBuffer=this.getBuffer("mesh",O),this._quadBuffer3D=this.getBuffer("quad",R),this._meshBuffer3D=this.getBuffer("mesh",R),this._buffer=this._meshBuffer,this._batchedModels=[],this._dummyNode=new cc.Node,this._sortKey=0,this.node=this._dummyNode,this.parentOpacity=1,this.parentOpacityDirty=0,this.worldMatDirty=0};F.prototype={constructor:F,reset:function(){this._iaPool.reset();for(var G=this._renderScene,V=this._batchedModels,j=0;j<V.length;++j)V[j].setInputAssembler(null),V[j].setEffect(null),G.removeModel(V[j]);for(var H in this._modelPool.reset(),V.length=0,this._sortKey=0,M)M[H].reset();this._buffer=this._meshBuffer,this.node=this._dummyNode,this.material=N,this.cullingMask=1,this.parentOpacity=1,this.parentOpacityDirty=0,this.worldMatDirty=0},_flushMaterial:function(G){if(G){this.material=G;var V=G.effect;if(V){var j=this._modelPool.add();this._batchedModels.push(j),j.sortKey=this._sortKey++,j._cullingMask=this.cullingMask,j.setNode(this.node),j.setEffect(V,null),j.setInputAssembler(k),this._renderScene.addModel(j)}}},_flush:function(){var G=this.material,V=this._buffer,j=V.indiceOffset-V.indiceStart;if(this.walking&&G&&!(j<=0)){var H=G.effect;if(H){var U=this._iaPool.add();U._vertexBuffer=V._vb,U._indexBuffer=V._ib,U._start=V.indiceStart,U._count=j;var X=this._modelPool.add();this._batchedModels.push(X),X.sortKey=this._sortKey++,X._cullingMask=this.cullingMask,X.setNode(this.node),X.setEffect(H),X.setInputAssembler(U),this._renderScene.addModel(X),V.forwardIndiceStartToOffset()}}},_flushIA:function(G){if(G){var V=this.material.effect;if(V){var j=this._modelPool.add();this._batchedModels.push(j),j.sortKey=this._sortKey++,j._cullingMask=this.cullingMask,j.setNode(this.node),j.setEffect(V),j.setInputAssembler(G),this._renderScene.addModel(j)}}},terminate:function(){for(var G in cc.dynamicAtlasManager&&cc.dynamicAtlasManager.enabled&&cc.dynamicAtlasManager.update(),this._flush(),M)M[G].uploadData();this.walking=!1},getBuffer:function(G,V){var j=G+V.getHash(),H=M[j];if(!H){if(G==="mesh")H=new E(this,V);else if(G==="quad")H=new P(this,V);else{if(G!=="spine")return cc.error("Not support buffer type ["+G+"]"),null;H=new D(this,V)}M[j]=H}return H}},S.exports=F},{"../../../renderer/core/input-assembler":309,"../../../renderer/memop/recycle-pool":334,"../../../renderer/scene/model":340,"../../assets/material/CCMaterial":81,"../../platform/id-generater":213,"./mesh-buffer":255,"./quad-buffer":257,"./spine-buffer":259,"./vertex-format":260}],257:[function(L,S){var T=L("./mesh-buffer"),_=cc.Class({name:"cc.QuadBuffer",extends:T,_fillQuadBuffer:function(){for(var w=this._initIDataCount/6,B=this._iData,A=0,O=0;A<w;A++){var R=4*A;B[O++]=R,B[O++]=R+1,B[O++]=R+2,B[O++]=R+1,B[O++]=R+3,B[O++]=R+2}var P=new Uint16Array(this._iData.buffer,0,6*w);this._ib.update(0,P)},uploadData:function(){if(this.byteOffset!==0&&this._dirty){var w=new Float32Array(this._vData.buffer,0,this.byteOffset>>2);this._vb.update(0,w),this._dirty=!1}},switchBuffer:function(){this._super();var w=new Uint16Array(this._iData.buffer,0,this._initIDataCount);this._ib.update(0,w)},_reallocBuffer:function(){this._reallocVData(!0),this._reallocIData(),this._fillQuadBuffer()}});cc.QuadBuffer=S.exports=_},{"./mesh-buffer":255}],258:[function(L,S,T){T.__esModule=!0,T.default=A;var _,w=(_=L("./flex-buffer"))&&_.__esModule?_:{default:_},B=L("./vertex-format");function A(){this.vDatas=[],this.uintVDatas=[],this.iDatas=[],this.meshCount=0,this._infos=null,this._flexBuffer=null}cc.js.mixin(A.prototype,{init:function(){},clear:function(){this.vDatas.length=0,this.iDatas.length=0,this.uintVDatas.length=0,this.meshCount=0,this._infos=null,this._flexBuffer&&this._flexBuffer.reset()},updateMesh:function(O,R,P){this.vDatas[O]=R,this.uintVDatas[O]=new Uint32Array(R.buffer,0,R.length),this.iDatas[O]=P,this.meshCount=this.vDatas.length},updateMeshRange:function(){},createData:function(O,R,P){var E=new Float32Array(R),D=new Uint16Array(P);this.updateMesh(O,E,D)},createQuadData:function(O,R,P){this.createData(O,R,P),this.initQuadIndices(this.iDatas[O])},createFlexData:function(O,R,P,E){E=E||B.vfmtPosUvColor,this._flexBuffer=new w.default(this,O,R,P,E)},initQuadIndices:function(O){for(var R=O.length/6,P=0,E=0;P<R;P++){var D=4*P;O[E++]=D,O[E++]=D+1,O[E++]=D+2,O[E++]=D+1,O[E++]=D+3,O[E++]=D+2}}}),cc.RenderData=A,S.exports=T.default},{"./flex-buffer":254,"./vertex-format":260}],259:[function(L,S){var T=cc.Class({name:"cc.SpineBuffer",extends:L("./mesh-buffer"),requestStatic:function(_,w){this.checkAndSwitchBuffer(_);var B=this.byteOffset+_*this._vertexBytes,A=this.indiceOffset+w,O=this._vData.byteLength,R=this._iData.length;if(B>O||A>R){for(;O<B||R<A;)this._initVDataCount*=2,this._initIDataCount*=2,O=4*this._initVDataCount,R=this._initIDataCount;this._reallocBuffer()}var P=this._offsetInfo;P.vertexOffset=this.vertexOffset,P.indiceOffset=this.indiceOffset,P.byteOffset=this.byteOffset},adjust:function(_,w){this.vertexOffset+=_,this.indiceOffset+=w,this.byteOffset=this.byteOffset+_*this._vertexBytes,this._dirty=!0}});cc.SpineBuffer=S.exports=T},{"./mesh-buffer":255}],260:[function(L,S){var T,_=(T=L("../../../renderer/gfx"))&&T.__esModule?T:{default:T},w=new _.default.VertexFormat([{name:_.default.ATTR_POSITION,type:_.default.ATTR_TYPE_FLOAT32,num:3},{name:_.default.ATTR_UV0,type:_.default.ATTR_TYPE_FLOAT32,num:2},{name:_.default.ATTR_COLOR,type:_.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);w.name="vfmt3D",_.default.VertexFormat.XYZ_UV_Color=w;var B=new _.default.VertexFormat([{name:_.default.ATTR_POSITION,type:_.default.ATTR_TYPE_FLOAT32,num:2},{name:_.default.ATTR_UV0,type:_.default.ATTR_TYPE_FLOAT32,num:2},{name:_.default.ATTR_COLOR,type:_.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);B.name="vfmtPosUvColor",_.default.VertexFormat.XY_UV_Color=B;var A=new _.default.VertexFormat([{name:_.default.ATTR_POSITION,type:_.default.ATTR_TYPE_FLOAT32,num:2},{name:_.default.ATTR_UV0,type:_.default.ATTR_TYPE_FLOAT32,num:2},{name:_.default.ATTR_COLOR,type:_.default.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:_.default.ATTR_COLOR0,type:_.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);A.name="vfmtPosUvTwoColor",_.default.VertexFormat.XY_UV_Two_Color=A;var O=new _.default.VertexFormat([{name:_.default.ATTR_POSITION,type:_.default.ATTR_TYPE_FLOAT32,num:2},{name:_.default.ATTR_UV0,type:_.default.ATTR_TYPE_FLOAT32,num:2}]);O.name="vfmtPosUv",_.default.VertexFormat.XY_UV=O;var R=new _.default.VertexFormat([{name:_.default.ATTR_POSITION,type:_.default.ATTR_TYPE_FLOAT32,num:2},{name:_.default.ATTR_COLOR,type:_.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);R.name="vfmtPosColor",_.default.VertexFormat.XY_Color=R;var P=new _.default.VertexFormat([{name:_.default.ATTR_POSITION,type:_.default.ATTR_TYPE_FLOAT32,num:2}]);P.name="vfmtPos",_.default.VertexFormat.XY=P,S.exports={vfmt3D:w,vfmtPosUvColor:B,vfmtPosUvTwoColor:A,vfmtPosUv:O,vfmtPosColor:R,vfmtPos:P}},{"../../../renderer/gfx":319}],261:[function(L,S){L("../platform/CCSys");var T=/(\.[^\.\/\?\\]*)(\?.*)?$/,_=/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,w=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var B=arguments.length,A="",O=0;O<B;O++)A=(A+(A===""?"":"/")+arguments[O]).replace(/(\/|\\\\)$/,"");return A},extname:function(B){var A=T.exec(B);return A?A[1]:""},mainFileName:function(B){if(B){var A=B.lastIndexOf(".");if(A!==-1)return B.substring(0,A)}return B},basename:function(B,A){var O=B.indexOf("?");O>0&&(B=B.substring(0,O));var R=/(\/|\\)([^\/\\]+)$/g.exec(B.replace(/(\/|\\)$/,""));if(!R)return B;var P=R[2];return A&&B.substring(B.length-A.length).toLowerCase()===A.toLowerCase()?P.substring(0,P.length-A.length):P},dirname:function(B){var A=_.exec(B);return A?A[2]:""},changeExtname:function(B,A){A=A||"";var O=B.indexOf("?"),R="";return O>0&&(R=B.substring(O),B=B.substring(0,O)),(O=B.lastIndexOf("."))<0?B+A+R:B.substring(0,O)+A+R},changeBasename:function(B,A,O){if(A.indexOf(".")===0)return this.changeExtname(B,A);var R=B.indexOf("?"),P="",E=O?this.extname(B):"";return R>0&&(P=B.substring(R),B=B.substring(0,R)),R=(R=B.lastIndexOf("/"))<=0?0:R+1,B.substring(0,R)+A+E+P},_normalize:function(B){var A=B=String(B);do A=B,B=B.replace(w,"");while(A.length!==B.length);return B},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",stripSep:function(B){return B.replace(/[\/\\]$/,"")}},S.exports=cc.path},{"../platform/CCSys":205}],262:[function(L,S){var T=function(_,w,B,A,O,R){this.a=_,this.b=w,this.c=B,this.d=A,this.tx=O,this.ty=R};T.create=function(_,w,B,A,O,R){return{a:_,b:w,c:B,d:A,tx:O,ty:R}},T.identity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},T.clone=function(_){return{a:_.a,b:_.b,c:_.c,d:_.d,tx:_.tx,ty:_.ty}},T.concat=function(_,w,B){var A=w.a,O=w.b,R=w.c,P=w.d,E=w.tx,D=w.ty;return _.a=A*B.a+O*B.c,_.b=A*B.b+O*B.d,_.c=R*B.a+P*B.c,_.d=R*B.b+P*B.d,_.tx=E*B.a+D*B.c+B.tx,_.ty=E*B.b+D*B.d+B.ty,_},T.invert=function(_,w){var B=w.a,A=w.b,O=w.c,R=w.d,P=1/(B*R-A*O),E=w.tx,D=w.ty;return _.a=P*R,_.b=-P*A,_.c=-P*O,_.d=P*B,_.tx=P*(O*D-R*E),_.ty=P*(A*E-B*D),_},T.fromMat4=function(_,w){var B=w.m;return _.a=B[0],_.b=B[1],_.c=B[4],_.d=B[5],_.tx=B[12],_.ty=B[13],_},T.transformVec2=function(_,w,B,A){var O,R;return A===void 0?(A=B,O=w.x,R=w.y):(O=w,R=B),_.x=A.a*O+A.c*R+A.tx,_.y=A.b*O+A.d*R+A.ty,_},T.transformSize=function(_,w,B){return _.width=B.a*w.width+B.c*w.height,_.height=B.b*w.width+B.d*w.height,_},T.transformRect=function(_,w,B){var A=w.x,O=w.y,R=A+w.width,P=O+w.height,E=B.a*A+B.c*O+B.tx,D=B.b*A+B.d*O+B.ty,I=B.a*R+B.c*O+B.tx,M=B.b*R+B.d*O+B.ty,N=B.a*A+B.c*P+B.tx,k=B.b*A+B.d*P+B.ty,F=B.a*R+B.c*P+B.tx,G=B.b*R+B.d*P+B.ty,V=Math.min(E,I,N,F),j=Math.max(E,I,N,F),H=Math.min(D,M,k,G),U=Math.max(D,M,k,G);return _.x=V,_.y=H,_.width=j-V,_.height=U-H,_},T.transformObb=function(_,w,B,A,O,R){var P=O.x,E=O.y,D=O.width,I=O.height,M=R.a*P+R.c*E+R.tx,N=R.b*P+R.d*E+R.ty,k=R.a*D,F=R.b*D,G=R.c*I,V=R.d*I;w.x=M,w.y=N,B.x=k+M,B.y=F+N,_.x=G+M,_.y=V+N,A.x=k+G+M,A.y=F+V+N},cc.AffineTransform=S.exports=T},{}],263:[function(L,S){var T=L("../platform/CCObject").Flags,_=L("./misc"),w=L("../platform/js"),B=L("../platform/id-generater"),A=L("../event-manager"),O=L("../renderer/render-flow"),R=T.Destroying,P=T.DontDestroy,E=T.Deactivating,D=new B("Node");function I(V){return V?typeof V=="string"?w.getClassByName(V):V:(cc.errorID(3804),null)}function M(V,j){if(j._sealed)for(var H=0;H<V._components.length;++H){var U=V._components[H];if(U.constructor===j)return U}else for(var X=0;X<V._components.length;++X){var Y=V._components[X];if(Y instanceof j)return Y}return null}function N(V,j,H){if(j._sealed)for(var U=0;U<V._components.length;++U){var X=V._components[U];X.constructor===j&&H.push(X)}else for(var Y=0;Y<V._components.length;++Y){var z=V._components[Y];z instanceof j&&H.push(z)}}function k(V,j){for(var H=0;H<V.length;++H){var U=V[H],X=M(U,j);if(X||U._children.length>0&&(X=k(U._children,j)))return X}return null}function F(V,j,H){for(var U=0;U<V.length;++U){var X=V[U];N(X,j,H),X._children.length>0&&F(X._children,j,H)}}var G=cc.Class({name:"cc._BaseNode",extends:cc.Object,properties:{_parent:null,_children:[],_active:!0,_components:[],_prefab:null,_persistNode:{get:function(){return(this._objFlags&P)>0},set:function(V){V?this._objFlags|=P:this._objFlags&=~P}},name:{get:function(){return this._name},set:function(V){this._name=V}},uuid:{get:function(){return this._id}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},active:{get:function(){return this._active},set:function(V){if(V=!!V,this._active!==V){this._active=V;var j=this._parent;j&&j._activeInHierarchy&&cc.director._nodeActivator.activateNode(this,V)}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}}},ctor:function(V){this._name=V!==void 0?V:"New Node",this._activeInHierarchy=!1,this._id=D.getNewId(),cc.director._scheduler&&cc.director._scheduler.enableForTarget(this),this.__eventTargets=[]},getParent:function(){return this._parent},setParent:function(V){if(this._parent!==V){var j=this._parent;if(this._parent=V||null,this._onSetParent(V),V&&(A._setDirtyForNode(this),V._children.push(this),V.emit&&V.emit("child-added",this),V._renderFlag|=O.FLAG_CHILDREN),j){if(!(j._objFlags&R)){var H=j._children.indexOf(this);j._children.splice(H,1),j.emit&&j.emit("child-removed",this),this._onHierarchyChanged(j),j._children.length===0&&(j._renderFlag&=~O.FLAG_CHILDREN)}}else V&&this._onHierarchyChanged(null)}},attr:function(V){w.mixin(this,V)},getChildByUuid:function(V){if(!V)return cc.log("Invalid uuid"),null;for(var j=this._children,H=0,U=j.length;H<U;H++)if(j[H]._id===V)return j[H];return null},getChildByName:function(V){if(!V)return cc.log("Invalid name"),null;for(var j=this._children,H=0,U=j.length;H<U;H++)if(j[H]._name===V)return j[H];return null},addChild:function(V){cc.assertID(V,1606),cc.assertID(V._parent===null,1605),V.setParent(this)},insertChild:function(V,j){V.parent=this,V.setSiblingIndex(j)},getSiblingIndex:function(){return this._parent?this._parent._children.indexOf(this):0},setSiblingIndex:function(V){if(this._parent)if(this._parent._objFlags&E)cc.errorID(3821);else{var j=this._parent._children;V=V!==-1?V:j.length-1;var H=j.indexOf(this);V!==H&&(j.splice(H,1),V<j.length?j.splice(V,0,this):j.push(this),this._onSiblingIndexChanged&&this._onSiblingIndexChanged(V))}},walk:function(V,j){var H,U,X,Y,z=cc._BaseNode,W=1,Z=z._stacks[z._stackId];Z||(Z=[],z._stacks.push(Z)),z._stackId++,Z.length=0,Z[0]=this;var Q=null;for(Y=!1;W;)if(U=Z[--W])if(!Y&&V?V(U):Y&&j&&j(U),Z[W]=null,Y){if(Q===this._parent)break;if(Y=!1,H){if(H[++X])Z[W]=H[X],W++;else if(Q&&(Z[W]=Q,W++,Y=!0,Q._parent?(X=(H=Q._parent._children).indexOf(Q),Q=Q._parent):(Q=null,H=null),X<0))break}}else U._children.length>0?(Q=U,H=U._children,X=0,Z[W]=H[X],W++):(Z[W]=U,W++,Y=!0);Z.length=0,z._stackId--},cleanup:function(){},removeFromParent:function(V){this._parent&&(V===void 0&&(V=!0),this._parent.removeChild(this,V))},removeChild:function(V,j){this._children.indexOf(V)>-1&&((j||j===void 0)&&V.cleanup(),V.parent=null)},removeAllChildren:function(V){var j=this._children;V===void 0&&(V=!0);for(var H=j.length-1;H>=0;H--){var U=j[H];U&&(V&&U.cleanup(),U.parent=null)}this._children.length=0},isChildOf:function(V){var j=this;do{if(j===V)return!0;j=j._parent}while(j);return!1},getComponent:function(V){var j=I(V);return j?M(this,j):null},getComponents:function(V){var j=I(V),H=[];return j&&N(this,j,H),H},getComponentInChildren:function(V){var j=I(V);return j?k(this._children,j):null},getComponentsInChildren:function(V){var j=I(V),H=[];return j&&(N(this,j,H),F(this._children,j,H)),H},_checkMultipleComp:!1,addComponent:function(V){var j;if(typeof V=="string"){if(!(j=w.getClassByName(V)))return cc.errorID(3807,V),cc._RFpeek()&&cc.errorID(3808,V),null}else{if(!V)return cc.errorID(3804),null;j=V}if(typeof j!="function")return cc.errorID(3809),null;if(!w.isChildClassOf(j,cc.Component))return cc.errorID(3810),null;var H=j._requireComponent;if(H&&!this.getComponent(H)&&!this.addComponent(H))return null;var U=new j;return U.node=this,this._components.push(U),this._activeInHierarchy&&cc.director._nodeActivator.activateComp(U),U},_addComponentAt:!1,removeComponent:function(V){V?(V instanceof cc.Component||(V=this.getComponent(V)),V&&V.destroy()):cc.errorID(3813)},_getDependComponent:!1,_removeComponent:function(V){if(V){if(!(this._objFlags&R)){var j=this._components.indexOf(V);j!==-1?this._components.splice(j,1):V.node!==this&&cc.errorID(3815)}}else cc.errorID(3814)},destroy:function(){cc.Object.prototype.destroy.call(this)&&(this.active=!1)},destroyAllChildren:function(){for(var V=this._children,j=0;j<V.length;++j)V[j].destroy()},_onSetParent:function(){},_onPostActivated:function(){},_onBatchCreated:function(){},_onHierarchyChanged:function(){var V=this._parent;!this._persistNode||V instanceof cc.Scene||cc.game.removePersistRootNode(this);var j=this._active&&!(!V||!V._activeInHierarchy);this._activeInHierarchy!==j&&cc.director._nodeActivator.activateNode(this,j)},_instantiate:function(V,j){return V||(V=cc.instantiate._clone(this,this)),V._prefab,V._parent=null,V._onBatchCreated(j),V},_registerIfAttached:!1,_onPreDestroy:function(){var V,j;this._objFlags|=R;var H=this._parent,U=H&&H._objFlags&R,X=this._children;for(V=0,j=X.length;V<j;++V)X[V]._destroyImmediate();for(V=0,j=this._components.length;V<j;++V)this._components[V]._destroyImmediate();var Y=this.__eventTargets;for(V=0,j=Y.length;V<j;++V){var z=Y[V];z&&z.targetOff(this)}if(Y.length=0,this._persistNode&&cc.game.removePersistRootNode(this),!U&&H){var W=H._children.indexOf(this);H._children.splice(W,1),H.emit&&H.emit("child-removed",this)}return U},onRestore:!1});G.idGenerater=D,G._stacks=[[]],G._stackId=0,G.prototype._onPreDestroyBase=G.prototype._onPreDestroy,G.prototype._onHierarchyChangedBase=G.prototype._onHierarchyChanged,_.propertyDefine(G,["parent","name","children","childrenCount"],{}),cc._BaseNode=S.exports=G},{"../event-manager":141,"../platform/CCObject":202,"../platform/id-generater":213,"../platform/js":217,"../renderer/render-flow":228,"./misc":271}],264:[function(L,S){S.exports={binarySearchEpsilon:function(T,_){for(var w=0,B=T.length-1,A=B>>>1;w<=B;A=w+B>>>1){var O=T[A];if(O>_+1e-6)B=A-1;else{if(!(O<_-1e-6))return A;w=A+1}}return~w}}},{}],265:[function(L,S){var T=L("../components/CCRenderComponent"),_=L("../platform/CCMacro").BlendFactor,w=L("../../renderer/gfx"),B=cc.Class({properties:{_srcBlendFactor:_.SRC_ALPHA,_dstBlendFactor:_.ONE_MINUS_SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(A){this._srcBlendFactor!==A&&(this._srcBlendFactor=A,this._updateBlendFunc(!0),this._onBlendChanged&&this._onBlendChanged())},animatable:!1,type:_,tooltip:!1,visible:!0},dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(A){this._dstBlendFactor!==A&&(this._dstBlendFactor=A,this._updateBlendFunc(!0))},animatable:!1,type:_,tooltip:!1,visible:!0}},setMaterial:function(A,O){var R=T.prototype.setMaterial.call(this,A,O);return this._srcBlendFactor===_.SRC_ALPHA&&this._dstBlendFactor===_.ONE_MINUS_SRC_ALPHA||this._updateMaterialBlendFunc(R),R},_updateMaterial:function(){this._updateBlendFunc()},_updateBlendFunc:function(A){if(A||this._srcBlendFactor!==_.SRC_ALPHA||this._dstBlendFactor!==_.ONE_MINUS_SRC_ALPHA)for(var O=this.getMaterials(),R=0;R<O.length;R++){var P=O[R];this._updateMaterialBlendFunc(P)}},_updateMaterialBlendFunc:function(A){A.setBlend(!0,w.BLEND_FUNC_ADD,this._srcBlendFactor,this._dstBlendFactor,w.BLEND_FUNC_ADD,this._srcBlendFactor,this._dstBlendFactor)}});S.exports=cc.BlendFunc=B},{"../../renderer/gfx":319,"../components/CCRenderComponent":117,"../platform/CCMacro":201}],266:[function(L,S){var T=L("./misc").BASE64_VALUES,_="0123456789abcdef".split(""),w=["","","",""],B=w.concat(w,"-",w,"-",w,"-",w,"-",w,w,w),A=B.map(function(O,R){return O==="-"?NaN:R}).filter(isFinite);S.exports=function(O){if(O.length!==22)return O;B[0]=O[0],B[1]=O[1];for(var R=2,P=2;R<22;R+=2){var E=T[O.charCodeAt(R)],D=T[O.charCodeAt(R+1)];B[A[P++]]=_[E>>2],B[A[P++]]=_[(3&E)<<2|D>>4],B[A[P++]]=_[15&D]}return B.join("")}},{"./misc":271}],267:[function(L,S){cc.find=S.exports=function(T,_){if(T==null)return cc.errorID(3814),null;if(!_){var w=cc.director.getScene();if(!w)return null;_=w}for(var B=_,A=T[0]!=="/"?0:1,O=T.split("/"),R=A;R<O.length;R++){var P=O[R],E=B._children;B=null;for(var D=0,I=E.length;D<I;++D){var M=E[D];if(M.name===P){B=M;break}}if(!B)return null}return B}},{}],268:[function(L,S){var T,_=(T=L("../assets/material/material-variant"))&&T.__esModule?T:{default:T},w=L("../assets/material/CCMaterial"),B=cc.Class({properties:{_normalMaterial:null,normalMaterial:{get:function(){return this._normalMaterial},set:function(A){this._normalMaterial=A,this._updateDisabledState&&this._updateDisabledState()},type:w,tooltip:!1,animatable:!1},_grayMaterial:null,grayMaterial:{get:function(){return this._grayMaterial},set:function(A){this._grayMaterial=A,this._updateDisabledState&&this._updateDisabledState()},type:w,tooltip:!1,animatable:!1}},_switchGrayMaterial:function(A,O){var R;A?((R=this._grayMaterial)||(R=w.getBuiltinMaterial("2d-gray-sprite")),R=this._grayMaterial=_.default.create(R,O)):((R=this._normalMaterial)||(R=w.getBuiltinMaterial("2d-sprite",O)),R=this._normalMaterial=_.default.create(R,O)),O.setMaterial(0,R)}});S.exports=B},{"../assets/material/CCMaterial":81,"../assets/material/material-variant":88}],269:[function(L,S){var T=/^(click)(\s)*=|(param)(\s)*=/,_=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*align(\s)*=|(\s)*offset(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/,w=function(){this._parsedObject={},this._specialSymbolArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"]),this._specialSymbolArray.push([/&nbsp;/g," "])};w.prototype={constructor:w,parse:function(B){if(this._resultObjectArray=[],!B)return this._resultObjectArray;this._stack=[];for(var A=0,O=B.length;A<O;){var R=B.indexOf(">",A),P=-1;if(R>=0&&(P=B.lastIndexOf("<",R))<A-1&&(P=B.indexOf("<",R+1),R=B.indexOf(">",P+1)),P<0)this._stack.pop(),this._processResult(B.substring(A)),A=O;else{var E=B.substring(A,P),D=B.substring(P+1,R);D===""&&(E=B.substring(A,R+1)),this._processResult(E),R===-1?R=P:B.charAt(P+1)==="/"?this._stack.pop():this._addToStack(D),A=R+1}}return this._resultObjectArray},_attributeToObject:function(B){var A,O,R,P,E={},D=(B=B.trim()).match(/^(color|size)(\s)*=/);if(D){if(A=D[0],(B=B.substring(A.length).trim())==="")return E;switch(O=B.indexOf(" "),A[0]){case"c":E.color=O>-1?B.substring(0,O).trim():B;break;case"s":E.size=parseInt(B)}return O>-1&&(P=B.substring(O+1).trim(),R=this._processEventHandler(P),E.event=R),E}if((D=B.match(/^(br(\s)*\/)/))&&D[0].length>0&&(A=D[0].trim()).startsWith("br")&&A[A.length-1]==="/")return E.isNewLine=!0,this._resultObjectArray.push({text:"",style:{newline:!0}}),E;if((D=B.match(/^(img(\s)*src(\s)*=[^>]+\/)/))&&D[0].length>0&&(A=D[0].trim()).startsWith("img")&&A[A.length-1]==="/"){var I;D=B.match(_);for(var M=!1;D;){if(A=(B=B.substring(B.indexOf(D[0]))).substr(0,D[0].length),k=(O=(I=B.substring(A.length).trim()).indexOf(" "))>-1?I.substr(0,O):I,A=(A=A.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),B=I.substring(O).trim(),k.endsWith("/")&&(k=k.slice(0,-1)),A==="src"){switch(k.charCodeAt(0)){case 34:case 39:M=!0,k=k.slice(1,-1)}E.isImage=!0,E.src=k}else if(A==="height")E.imageHeight=parseInt(k);else if(A==="width")E.imageWidth=parseInt(k);else if(A==="align"){switch(k.charCodeAt(0)){case 34:case 39:k=k.slice(1,-1)}E.imageAlign=k.toLocaleLowerCase()}else A==="offset"?E.imageOffset=k:A==="click"&&(E.event=this._processEventHandler(A+"="+k));E.event&&A==="param"&&(E.event.param=k.replace(/^\"|\"$/g,"")),D=B.match(_)}return M&&E.isImage&&this._resultObjectArray.push({text:"",style:E}),{}}if(D=B.match(/^(outline(\s)*[^>]*)/)){var N={color:"#ffffff",width:1};if(B=D[0].substring(7).trim()){var k,F=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(D=B.match(F);D;)A=(B=B.substring(B.indexOf(D[0]))).substr(0,D[0].length),k=(O=(I=B.substring(A.length).trim()).indexOf(" "))>-1?I.substr(0,O):I,A=(A=A.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),B=I.substring(O).trim(),A==="click"?E.event=this._processEventHandler(A+"="+k):A==="color"?N.color=k:A==="width"&&(N.width=parseInt(k)),E.event&&A==="param"&&(E.event.param=k.replace(/^\"|\"$/g,"")),D=B.match(F)}E.outline=N}if((D=B.match(/^(on|u|b|i)(\s)*/))&&D[0].length>0){switch(A=D[0],B=B.substring(A.length).trim(),A[0]){case"u":E.underline=!0;break;case"i":E.italic=!0;break;case"b":E.bold=!0}if(B==="")return E;R=this._processEventHandler(B),E.event=R}return E},_processEventHandler:function(B){for(var A=0,O={},R=B.match(T),P=!1;R;){var E=R[0],D="";if(P=!1,(B=B.substring(E.length).trim()).charAt(0)==='"')(A=B.indexOf('"',1))>-1&&(D=B.substring(1,A).trim(),P=!0),A++;else if(B.charAt(0)==="'")(A=B.indexOf("'",1))>-1&&(D=B.substring(1,A).trim(),P=!0),A++;else{var I=B.match(/(\S)+/);A=(D=I?I[0]:"").length}P&&(O[E=E.substring(0,E.length-1).trim()]=D),R=(B=B.substring(A).trim()).match(T)}return O},_addToStack:function(B){var A=this._attributeToObject(B);if(this._stack.length===0)this._stack.push(A);else{if(A.isNewLine||A.isImage)return;var O=this._stack[this._stack.length-1];for(var R in O)A[R]||(A[R]=O[R]);this._stack.push(A)}},_processResult:function(B){B!==""&&(B=this._escapeSpecialSymbol(B),this._stack.length>0?this._resultObjectArray.push({text:B,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:B}))},_escapeSpecialSymbol:function(B){for(var A=0;A<this._specialSymbolArray.length;++A){var O=this._specialSymbolArray[A][0],R=this._specialSymbolArray[A][1];B=B.replace(O,R)}return B}},S.exports=w},{}],270:[function(L){L("./CCPath"),L("./profiler/CCProfiler"),L("./find"),L("./mutable-forward-iterator")},{"./CCPath":261,"./find":267,"./mutable-forward-iterator":272,"./profiler/CCProfiler":275}],271:[function(L,S){for(var T=L("../platform/js"),_={propertyDefine:function(O,R,P){function E(F,G,V,j){var H=Object.getOwnPropertyDescriptor(F,G);if(H)H.get&&(F[V]=H.get),H.set&&j&&(F[j]=H.set);else{var U=F[V];T.getset(F,G,U,F[j])}}for(var D,I=O.prototype,M=0;M<R.length;M++){var N=(D=R[M])[0].toUpperCase()+D.slice(1);E(I,D,"get"+N,"set"+N)}for(D in P){var k=P[D];E(I,D,k[0],k[1])}},NextPOT:function(O){return O-=1,O|=O>>1,O|=O>>2,O|=O>>4,O|=O>>8,1+(O|=O>>16)},BUILTIN_CLASSID_RE:/^(?:cc|dragonBones|sp|ccsg)\..+/},w=new Array(123),B=0;B<123;++B)w[B]=64;for(var A=0;A<64;++A)w["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(A)]=A;_.BASE64_VALUES=w,_.pushToMap=function(O,R,P,E){var D=O[R];D?Array.isArray(D)?E?(D.push(D[0]),D[0]=P):D.push(P):O[R]=E?[P,D]:[D,P]:O[R]=P},_.clampf=function(O,R,P){if(R>P){var E=R;R=P,P=E}return O<R?R:O<P?O:P},_.clamp01=function(O){return O<0?0:O<1?O:1},_.lerp=function(O,R,P){return O+(R-O)*P},_.degreesToRadians=function(O){return O*cc.macro.RAD},_.radiansToDegrees=function(O){return O*cc.macro.DEG},cc.misc=S.exports=_},{"../platform/js":217}],272:[function(L,S){function T(w){this.i=0,this.array=w}var _=T.prototype;_.remove=function(w){var B=this.array.indexOf(w);B>=0&&this.removeAt(B)},_.removeAt=function(w){this.array.splice(w,1),w<=this.i&&--this.i},_.fastRemove=function(w){var B=this.array.indexOf(w);B>=0&&this.fastRemoveAt(B)},_.fastRemoveAt=function(w){var B=this.array;B[w]=B[B.length-1],--B.length,w<=this.i&&--this.i},_.push=function(w){this.array.push(w)},S.exports=T},{}],273:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=function(){function w(){this.enabled=!1,this.count=0,this.maxSize=1024}var B=w.prototype;return B.get=function(){},B.put=function(){},B.clear=function(){},w}();T.default=_,cc.pool={},_.register=function(w,B){cc.pool[w]=B},S.exports=T.default},{}],274:[function(L,S){cc._PrefabInfo=cc.Class({name:"cc.PrefabInfo",properties:{root:null,asset:null,fileId:"",sync:!1}}),S.exports={syncWithPrefab:function(T){var _=T._prefab;if(!_.asset)return cc.errorID(3701,T.name),void(T._prefab=null);var w=T._objFlags,B=T._parent,A=T._id,O=T._name,R=T._active,P=T._eulerAngles.x,E=T._eulerAngles.y,D=T._eulerAngles.z,I=T._localZOrder,M=T._trs,N=M[0],k=M[1],F=M[2];cc.game._isCloning=!0,_.asset._doInstantiate(T),cc.game._isCloning=!1,T._objFlags=w,T._parent=B,T._id=A,T._prefab=_,T._name=O,T._active=R,T._localZOrder=I,(M=T._trs)[0]=N,M[1]=k,M[2]=F,T._eulerAngles.x=P,T._eulerAngles.y=E,T._eulerAngles.z=D}}},{}],275:[function(L,S){var T=L("../../platform/CCMacro"),_=L("./perf-counter"),w=!1,B=15,A=null,O=null,R=null;function P(){if(!A){A={fps:{desc:"Framerate (FPS)",below:30,average:500},draws:{desc:"Draw Call"},frame:{desc:"Frame time (ms)",min:0,max:50,average:500},logic:{desc:"Game Logic (ms)",min:0,max:50,average:500,color:"#080"},render:{desc:"Renderer (ms)",min:0,max:50,average:500,color:"#f90"},mode:{desc:cc.game.renderType===cc.game.RENDER_TYPE_WEBGL?"WebGL":"Canvas",min:1}};var N=performance.now();for(var k in A)A[k]._counter=new _(k,A[k],N)}}function E(){if(!O||!O.isValid){(O=new cc.Node("PROFILER-NODE")).x=O.y=10,O.groupIndex=cc.Node.BuiltinGroupIndex.DEBUG,cc.Camera._setupDebugCamera(),O.zIndex=T.MAX_ZINDEX,cc.game.addPersistRootNode(O);var N=new cc.Node("LEFT-PANEL");N.anchorX=N.anchorY=0;var k=N.addComponent(cc.Label);k.fontSize=B,k.lineHeight=B,N.parent=O;var F=new cc.Node("RIGHT-PANEL");F.anchorX=1,F.anchorY=0,F.x=200;var G=F.addComponent(cc.Label);G.horizontalAlign=cc.Label.HorizontalAlign.RIGHT,G.fontSize=B,G.lineHeight=B,F.parent=O,cc.sys.platform!==cc.sys.BAIDU_GAME_SUB&&cc.sys.platform!==cc.sys.WECHAT_GAME_SUB&&(k.cacheMode=cc.Label.CacheMode.CHAR,G.cacheMode=cc.Label.CacheMode.CHAR),R={left:k,right:G}}}function D(){E();var N=cc.director._lastUpdate;A.frame._counter.start(N),A.logic._counter.start(N)}function I(){var N=performance.now();cc.director.isPaused()?A.frame._counter.start(N):A.logic._counter.end(N),A.render._counter.start(N)}function M(){var N=performance.now();A.render._counter.end(N),A.draws._counter.value=cc.renderer.drawCalls,A.frame._counter.end(N),A.fps._counter.frame(N);var k="",F="";for(var G in A){var V=A[G];V._counter.sample(N),k+=V.desc+"\n",F+=V._counter.human()+"\n"}R&&(R.left.string=k,R.right.string=F)}cc.profiler=S.exports={isShowingStats:function(){return w},hideStats:function(){w&&(O&&(O.active=!1),cc.director.off(cc.Director.EVENT_BEFORE_UPDATE,D),cc.director.off(cc.Director.EVENT_AFTER_UPDATE,I),cc.director.off(cc.Director.EVENT_AFTER_DRAW,M),w=!1)},showStats:function(){w||(P(),O&&(O.active=!0),cc.director.on(cc.Director.EVENT_BEFORE_UPDATE,D),cc.director.on(cc.Director.EVENT_AFTER_UPDATE,I),cc.director.on(cc.Director.EVENT_AFTER_DRAW,M),w=!0)}}},{"../../platform/CCMacro":201,"./perf-counter":277}],276:[function(L,S){var T=cc.Class({name:"cc.Counter",ctor:function(_,w,B){this._id=_,this._opts=w||{},this._value=0,this._total=0,this._averageValue=0,this._accumValue=0,this._accumSamples=0,this._accumStart=B},properties:{value:{get:function(){return this._value},set:function(_){this._value=_}}},_average:function(_,w){if(this._opts.average){this._accumValue+=_,++this._accumSamples;var B=w;B-this._accumStart>=this._opts.average&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=B,this._accumSamples=0)}},sample:function(_){this._average(this._value,_)},human:function(){var _=this._opts.average?this._averageValue:this._value;return Math.round(100*_)/100},alarm:function(){return this._opts.below&&this._value<this._opts.below||this._opts.over&&this._value>this._opts.over}});S.exports=T},{}],277:[function(L,S){var T=L("./counter"),_=cc.Class({name:"cc.PerfCounter",extends:T,ctor:function(w,B,A){this._time=A},start:function(w){this._time=w},end:function(w){this._value=w-this._time,this._average(this._value)},tick:function(){this.end(),this.start()},frame:function(w){var B=w,A=B-this._time;this._total++,A>(this._opts.average||1e3)&&(this._value=1e3*this._total/A,this._total=0,this._time=B,this._average(this._value))}});S.exports=_},{"./counter":276}],278:[function(L,S){var T,_=new((T=L("../platform/js"))&&T.__esModule?T:{default:T}).default.Pool(2);function w(O){this.count=0,this.limit=O,this.datas={},this.head=null,this.tail=null}_.get=function(){return this._get()||{key:null,value:null,prev:null,next:null}},w.prototype.moveToHead=function(O){O.next=this.head,O.prev=null,this.head!==null&&(this.head.prev=O),this.head=O,this.tail===null&&(this.tail=O),this.count++,this.datas[O.key]=O},w.prototype.put=function(O,R){var P=_.get();if(P.key=O,P.value=R,this.count>=this.limit){var E=this.tail;delete this.datas[E.key],this.count--,this.tail=E.prev,this.tail.next=null,E.prev=null,E.next=null,_.put(E)}this.moveToHead(P)},w.prototype.remove=function(O){O.prev!==null?O.prev.next=O.next:this.head=O.next,O.next!==null?O.next.prev=O.prev:this.tail=O.prev,delete this.datas[O.key],this.count--},w.prototype.get=function(O){var R=this.datas[O];return R?(this.remove(R),this.moveToHead(R),R.value):null},w.prototype.clear=function(){this.count=0,this.datas={},this.head=null,this.tail=null},w.prototype.has=function(O){return!!this.datas[O]},w.prototype.delete=function(O){var R=this.datas[O];this.remove(R)};var B=new w(100),A={BASELINE_RATIO:.26,MIDDLE_RATIO:.37,BASELINE_OFFSET:0,label_wordRex:/([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430-\u044f\u0410-\u042f\u0401\u0451]+|\S)/,label_symbolRex:/^[!,.:;'}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/,label_lastWordRex:/([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+|\S)$/,label_lastEnglish:/[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+$/,label_firstEnglish:/^[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]/,highSurrogateRex:/[\uD800-\uDBFF]/,lowSurrogateRex:/[\uDC00-\uDFFF]/,label_wrapinspection:!0,__CHINESE_REG:/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/,__JAPANESE_REG:/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,__KOREAN_REG:/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/,isUnicodeCJK:function(O){return this.__CHINESE_REG.test(O)||this.__JAPANESE_REG.test(O)||this.__KOREAN_REG.test(O)},isUnicodeSpace:function(O){return(O=O.charCodeAt(0))>=9&&O<=13||O===32||O===133||O===160||O===5760||O>=8192&&O<=8202||O===8232||O===8233||O===8239||O===8287||O===12288},safeMeasureText:function(O,R,P){var E=(P||O.font)+"🎮"+R,D=B.get(E);if(D!==null)return D;var I=O.measureText(R),M=I&&I.width||0;return B.put(E,M),M},_safeSubstring:function(O,R,P){var E=R,D=P,I=O[R];if(this.lowSurrogateRex.test(I)&&E--,P!==void 0)if(P-1!==R){var M=O[P-1];this.highSurrogateRex.test(M)&&D--}else this.highSurrogateRex.test(I)&&D++;return O.substring(E,D)},fragmentText:function(O,R,P,E){var D=[];if(O.length===0||P<0)return D.push(""),D;for(var I=O;R>P&&I.length>1;){for(var M=I.length*(P/R)|0,N=this._safeSubstring(I,M),k=R-E(N),F=N,G=0,V=0;k>P&&V++<10;)M*=P/k,M|=0,k=R-E(N=this._safeSubstring(I,M));for(V=0;k<=P&&V++<10;){if(N){var j=this.label_wordRex.exec(N);G=j?j[0].length:1,F=N}M+=G,k=R-E(N=this._safeSubstring(I,M))}(M-=G)==0?(M=1,F=this._safeSubstring(I,1)):M===1&&this.highSurrogateRex.test(I[0])&&(M=2,F=this._safeSubstring(I,2));var H,U=this._safeSubstring(I,0,M);this.label_wrapinspection&&this.label_symbolRex.test(F||N)&&((M-=(H=this.label_lastWordRex.exec(U))?H[0].length:0)==0&&(M=1),F=this._safeSubstring(I,M),U=this._safeSubstring(I,0,M)),this.label_firstEnglish.test(F)&&(H=this.label_lastEnglish.exec(U))&&U!==H[0]&&(M-=H[0].length,F=this._safeSubstring(I,M),U=this._safeSubstring(I,0,M)),(D.length===0||(U=U.trimLeft()).length>0)&&D.push(U),R=E(I=F||N)}return(D.length===0||(I=I.trimLeft()).length>0)&&D.push(I),D}};cc.textUtils=S.exports=A},{"../platform/js":217}],279:[function(L,S){var T=L("../assets/CCTexture2D"),_={loadImage:function(w,B,A){cc.assertID(w,3103);var O=cc.assetManager.assets.get(w);if(O)return O.loaded?(B&&B.call(A,null,O),O):(O.once("load",function(){B&&B.call(A,null,O)},A),O);cc.assetManager.loadRemote(w,function(R,P){B&&B.call(A,R,P)})},cacheImage:function(w,B){if(w&&B){var A=new T;return A.initWithElement(B),cc.assetManager.assets.add(w,A),A}},postLoadTexture:function(w,B){w.loaded?B&&B():w.nativeUrl?cc.assetManager.postLoadNative(w,B):B&&B()}};S.exports=_},{"../assets/CCTexture2D":77}],280:[function(L,S){var T=L("./node-unit"),_=L("./node-mem-pool");S.exports={NodeMemPool:new _(T)}},{"./node-mem-pool":282,"./node-unit":283}],281:[function(L,S){var T=function(w){this._unitClass=w,this._pool=[],this._findOrder=[]},_=T.prototype;_._initNative=function(){this._nativeMemPool=new renderer.MemPool},_._buildUnit=function(w){return new this._unitClass(w,this)},_._destroyUnit=function(w){this._pool[w]=null;for(var B=0,A=this._findOrder.length;B<A;B++){var O=this._findOrder[B];if(O&&O.unitID==w){this._findOrder.splice(B,1);break}}},_._findUnitID=function(){for(var w=0,B=this._pool;B[w];)w++;return w},_.pop=function(){for(var w=null,B=0,A=this._findOrder,O=this._pool,R=A.length;B<R;B++){var P=A[B];if(P&&P.hasSpace()){w=P;break}}if(!w){var E=this._findUnitID();w=this._buildUnit(E),O[E]=w,A.push(w),B=A.length-1}var D=A[0];return D!==w&&(A[0]=w,A[B]=D),w.pop()},_.push=function(w){var B=this._pool[w.unitID];return B.push(w.index),this._findOrder.length>1&&B.isAllFree()&&this._destroyUnit(w.unitID),B},S.exports=T},{}],282:[function(L,S){var T,_=L("./mem-pool"),w=function(A){_.call(this,A)};(T=function(){}).prototype=_.prototype;var B=w.prototype=new T;B._initNative=function(){this._nativeMemPool=new renderer.NodeMemPool},B._destroyUnit=function(A){_.prototype._destroyUnit.call(this,A)},S.exports=w},{"./mem-pool":281}],283:[function(L,S){var T,_=L("../../value-types/utils"),w=10*_.FLOAT_BYTES,B=16*_.FLOAT_BYTES,A=16*_.FLOAT_BYTES,O=(_.FLOAT_BYTES,L("./unit-base")),R=function(P,E){O.call(this,P,E);var D=this._contentNum;this.trsList=new _.FLOAT_ARRAY_TYPE(10*D),this.localMatList=new _.FLOAT_ARRAY_TYPE(16*D),this.worldMatList=new _.FLOAT_ARRAY_TYPE(16*D);for(var I=0;I<D;I++){var M=this._spacesData[I];M.trs=new _.FLOAT_ARRAY_TYPE(this.trsList.buffer,I*w,10),M.localMat=new _.FLOAT_ARRAY_TYPE(this.localMatList.buffer,I*B,16),M.worldMat=new _.FLOAT_ARRAY_TYPE(this.worldMatList.buffer,I*A,16)}};(T=function(){}).prototype=O.prototype,R.prototype=new T,S.exports=R},{"../../value-types/utils":293,"./unit-base":284}],284:[function(L,S){var T=function(w,B,A){A=A||128,this.unitID=w,this._memPool=B,this._data=new Uint16Array(2),this._data[0]=0,this._data[1]=0,this._contentNum=A,this._signData=new Uint16Array(2*this._contentNum),this._spacesData=[];for(var O=0;O<A;O++){var R=2*O;this._signData[R+0]=O+1,this._signData[R+1]=0,this._spacesData[O]={index:O,unitID:w}}this._signData[2*(A-1)]=65535},_=T.prototype;_.hasSpace=function(){return this._data[0]!==65535},_.isAllFree=function(){return this._data[1]==0},_.pop=function(){var w=this._data[0];if(w===65535)return null;var B=w,A=2*B,O=this._spacesData[B];return this._signData[A+1]=1,this._data[0]=this._signData[A+0],this._data[1]++,O},_.push=function(w){var B=2*w;this._signData[B+1]=0,this._signData[B+0]=this._data[0],this._data[0]=w,this._data[1]--},_.dump=function(){for(var w=0,B=this._data[0],A="";B!=65535;)w++,A+=B+"->",B=this._signData[2*B+0];for(var O=0,R="",P=this._contentNum,E=0;E<P;E++)this._signData[2*E+1]==1&&(O++,R+=E+"->");var D=w+O;console.log("unitID:",this.unitID,"spaceNum:",w,"calc using num:",O,"store using num:",this._data[1],"calc total num:",D,"actually total num:",this._contentNum),console.log("free info:",A),console.log("using info:",R),O!=this._data[1]&&cc.error("using num error","calc using num:",O,"store using num:",this._data[1]),w+O!=this._contentNum&&cc.error("total num error","calc total num:",D,"actually total num:",this._contentNum)},S.exports=T},{}],285:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=A(L("./value-type")),w=A(L("../platform/CCClass")),B=A(L("../utils/misc"));function A(E){return E&&E.__esModule?E:{default:E}}function O(E,D){for(var I=0;I<D.length;I++){var M=D[I];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(E,M.key,M)}}function R(E,D){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(I,M){return I.__proto__=M,I})(E,D)}var P=function(E){var D,I;function M(V,j,H,U){var X;return V===void 0&&(V=0),j===void 0&&(j=0),H===void 0&&(H=0),U===void 0&&(U=255),(X=E.call(this)||this)._val=0,typeof V=="object"&&(j=V.g,H=V.b,U=V.a,V=V.r),X._val=(U<<24>>>0)+(H<<16)+(j<<8)+(0|V),X}I=E,(D=M).prototype=Object.create(I.prototype),D.prototype.constructor=D,R(D,I),M.copy=function(V,j){return V.r=j.r,V.g=j.g,V.b=j.b,V.a=j.a,V},M.clone=function(V){return new M(V.r,V.g,V.b,V.a)},M.set=function(V,j,H,U,X){return j===void 0&&(j=255),H===void 0&&(H=255),U===void 0&&(U=255),X===void 0&&(X=255),V.r=j,V.g=H,V.b=U,V.a=X,V},M.fromHex=function(V,j){var H=j>>24&255,U=j>>16&255,X=j>>8&255,Y=255&j;return V.r=H,V.g=U,V.b=X,V.a=Y,V},M.fromHEX=function(V,j){return j=j.indexOf("#")===0?j.substring(1):j,V.r=parseInt(j.substr(0,2),16)||0,V.g=parseInt(j.substr(2,2),16)||0,V.b=parseInt(j.substr(4,2),16)||0,V.a=parseInt(j.substr(6,2),16)||255,V._val=(V.a<<24>>>0)+(V.b<<16)+(V.g<<8)+V.r,V},M.add=function(V,j,H){return V.r=j.r+H.r,V.g=j.g+H.g,V.b=j.b+H.b,V.a=j.a+H.a,V},M.subtract=function(V,j,H){return V.r=j.r-H.r,V.g=j.g-H.g,V.b=j.b-H.b,V.a=j.a-H.a,V},M.multiply=function(V,j,H){return V.r=j.r*H.r,V.g=j.g*H.g,V.b=j.b*H.b,V.a=j.a*H.a,V},M.divide=function(V,j,H){return V.r=j.r/H.r,V.g=j.g/H.g,V.b=j.b/H.b,V.a=j.a/H.a,V},M.scale=function(V,j,H){return V.r=j.r*H,V.g=j.g*H,V.b=j.b*H,V.a=j.a*H,V},M.lerp=function(V,j,H,U){var X=j.r,Y=j.g,z=j.b,W=j.a;return V.r=X+U*(H.r-X),V.g=Y+U*(H.g-Y),V.b=z+U*(H.b-z),V.a=W+U*(H.a-W),V},M.toArray=function(V,j,H){H===void 0&&(H=0);var U=j instanceof M||j.a>1?1/255:1;return V[H+0]=j.r*U,V[H+1]=j.g*U,V[H+2]=j.b*U,V[H+3]=j.a*U,V},M.fromArray=function(V,j,H){return H===void 0&&(H=0),j.r=255*V[H+0],j.g=255*V[H+1],j.b=255*V[H+2],j.a=255*V[H+3],j},M.premultiplyAlpha=function(V,j){var H=j.a/255;return V.r=j.r*H,V.g=j.g*H,V.b=j.b*H,V._fastSetA(j.a),V};var N,k,F,G=M.prototype;return G.clone=function(){var V=new M;return V._val=this._val,V},G.equals=function(V){return V&&this._val===V._val},G.lerp=function(V,j,H){H=H||new M;var U=this.r,X=this.g,Y=this.b,z=this.a;return H.r=U+(V.r-U)*j,H.g=X+(V.g-X)*j,H.b=Y+(V.b-Y)*j,H.a=z+(V.a-z)*j,H},G.toString=function(){return"rgba("+this.r.toFixed()+", "+this.g.toFixed()+", "+this.b.toFixed()+", "+this.a.toFixed()+")"},G.getR=function(){return 255&this._val},G.setR=function(V){return V=~~B.default.clampf(V,0,255),this._val=(4294967040&this._val|V)>>>0,this},G.getG=function(){return(65280&this._val)>>8},G.setG=function(V){return V=~~B.default.clampf(V,0,255),this._val=(4294902015&this._val|V<<8)>>>0,this},G.getB=function(){return(16711680&this._val)>>16},G.setB=function(V){return V=~~B.default.clampf(V,0,255),this._val=(4278255615&this._val|V<<16)>>>0,this},G.getA=function(){return(4278190080&this._val)>>>24},G.setA=function(V){return V=~~B.default.clampf(V,0,255),this._val=(16777215&this._val|V<<24)>>>0,this},G.toCSS=function(V){return V&&V!=="rgba"?V==="rgb"?"rgb("+this.r+","+this.g+","+this.b+")":"#"+this.toHEX(V):"rgba("+this.r+","+this.g+","+this.b+","+(this.a/255).toFixed(2)+")"},G.fromHEX=function(V){V=V.indexOf("#")===0?V.substring(1):V;var j=parseInt(V.substr(0,2),16)||0,H=parseInt(V.substr(2,2),16)||0,U=parseInt(V.substr(4,2),16)||0,X=parseInt(V.substr(6,2),16)||255;return this._val=(X<<24>>>0)+(U<<16)+(H<<8)+j,this},G.toHEX=function(V){var j=[(this.r<16?"0":"")+this.r.toString(16),(this.g<16?"0":"")+this.g.toString(16),(this.b<16?"0":"")+this.b.toString(16)];return V==="#rgb"?(j[0]=j[0][0],j[1]=j[1][0],j[2]=j[2][0]):V==="#rrggbbaa"&&j.push((this.a<16?"0":"")+this.a.toString(16)),j.join("")},G.toRGBValue=function(){return 16777215&this._val},G.fromHSV=function(V,j,H){var U,X,Y;if(j===0)U=X=Y=H;else if(H===0)U=X=Y=0;else{V===1&&(V=0),V*=6;var z=Math.floor(V),W=V-z,Z=H*(1-j),Q=H*(1-j*W),ee=H*(1-j*(1-W));switch(z){case 0:U=H,X=ee,Y=Z;break;case 1:U=Q,X=H,Y=Z;break;case 2:U=Z,X=H,Y=ee;break;case 3:U=Z,X=Q,Y=H;break;case 4:U=ee,X=Z,Y=H;break;case 5:U=H,X=Z,Y=Q}}return U*=255,X*=255,Y*=255,this._val=(this.a<<24>>>0)+(Y<<16)+(X<<8)+(0|U),this},G.toHSV=function(){var V=this.r/255,j=this.g/255,H=this.b/255,U={h:0,s:0,v:0},X=Math.max(V,j,H),Y=Math.min(V,j,H),z=0;return U.v=X,U.s=X?(X-Y)/X:0,U.s?(z=X-Y,U.h=V===X?(j-H)/z:j===X?2+(H-V)/z:4+(V-j)/z,U.h/=6,U.h<0&&(U.h+=1)):U.h=0,U},G.set=function(V){return V._val?this._val=V._val:(this.r=V.r,this.g=V.g,this.b=V.b,this.a=V.a),this},G._fastSetA=function(V){this._val=(16777215&this._val|V<<24)>>>0},G.multiply=function(V){var j=(255&this._val)*V.r>>8,H=(65280&this._val)*V.g>>8,U=(16711680&this._val)*V.b>>8,X=((4278190080&this._val)>>>8)*V.a;return this._val=4278190080&X|16711680&U|65280&H|255&j,this},N=M,F=[{key:"WHITE",get:function(){return new M(255,255,255,255)}},{key:"BLACK",get:function(){return new M(0,0,0,255)}},{key:"TRANSPARENT",get:function(){return new M(0,0,0,0)}},{key:"GRAY",get:function(){return new M(127.5,127.5,127.5)}},{key:"RED",get:function(){return new M(255,0,0)}},{key:"GREEN",get:function(){return new M(0,255,0)}},{key:"BLUE",get:function(){return new M(0,0,255)}},{key:"YELLOW",get:function(){return new M(255,235,4)}},{key:"ORANGE",get:function(){return new M(255,127,0)}},{key:"CYAN",get:function(){return new M(0,255,255)}},{key:"MAGENTA",get:function(){return new M(255,0,255)}}],(k=[{key:"r",get:function(){return this.getR()},set:function(V){this.setR(V)}},{key:"g",get:function(){return this.getG()},set:function(V){this.setG(V)}},{key:"b",get:function(){return this.getB()},set:function(V){this.setB(V)}},{key:"a",get:function(){return this.getA()},set:function(V){this.setA(V)}}])&&O(N.prototype,k),F&&O(N,F),Object.defineProperty(N,"prototype",{writable:!1}),M}(_.default);T.default=P,P.div=P.divide,P.sub=P.subtract,P.mul=P.multiply,P.WHITE_R=P.WHITE,P.BLACK_R=P.BLACK,P.TRANSPARENT_R=P.TRANSPARENT,P.GRAY_R=P.GRAY,P.RED_R=P.RED,P.GREEN_R=P.GREEN,P.BLUE_R=P.BLUE,P.YELLOW_R=P.YELLOW,P.ORANGE_R=P.ORANGE,P.CYAN_R=P.CYAN,P.MAGENTA_R=P.MAGENTA,w.default.fastDefine("cc.Color",P,{r:0,g:0,b:0,a:255}),cc.Color=P,cc.color=function(E,D,I,M){return typeof E=="string"?new P().fromHEX(E):typeof E=="object"?new P(E.r,E.g,E.b,E.a):new P(E,D,I,M)},S.exports=T.default},{"../platform/CCClass":196,"../utils/misc":271,"./value-type":294}],286:[function(L,S,T){T.__esModule=!0;var _={Vec2:!0,Vec3:!0,Vec4:!0,Mat4:!0,Mat3:!0,Rect:!0,Size:!0,Color:!0,Quat:!0,Trs:!0};T.Vec4=T.Vec3=T.Vec2=T.Trs=T.Size=T.Rect=T.Quat=T.Mat4=T.Mat3=T.Color=void 0;var w=k(L("./vec2"));T.Vec2=w.default;var B=k(L("./vec3"));T.Vec3=B.default;var A=k(L("./vec4"));T.Vec4=A.default;var O=k(L("./mat4"));T.Mat4=O.default;var R=k(L("./mat3"));T.Mat3=R.default;var P=k(L("./rect"));T.Rect=P.default;var E=k(L("./size"));T.Size=E.default;var D=k(L("./color"));T.Color=D.default;var I=k(L("./quat"));T.Quat=I.default;var M=k(L("./trs"));T.Trs=M.default;var N=L("./utils");function k(F){return F&&F.__esModule?F:{default:F}}Object.keys(N).forEach(function(F){F!=="default"&&F!=="__esModule"&&(Object.prototype.hasOwnProperty.call(_,F)||F in T&&T[F]===N[F]||(T[F]=N[F]))}),cc.math=S.exports},{"./color":285,"./mat3":287,"./mat4":288,"./quat":289,"./rect":290,"./size":291,"./trs":292,"./utils":293,"./vec2":295,"./vec3":296,"./vec4":297}],287:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../value-types/utils"),B=(_=L("./vec3"))&&_.__esModule?_:{default:_},A=function(){function O(R,P,E,D,I,M,N,k,F){if(R===void 0&&(R=1),P===void 0&&(P=0),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=1),M===void 0&&(M=0),N===void 0&&(N=0),k===void 0&&(k=0),F===void 0&&(F=1),this.m=void 0,R instanceof w.FLOAT_ARRAY_TYPE)this.m=R;else{this.m=new w.FLOAT_ARRAY_TYPE(9);var G=this.m;G[0]=R,G[1]=P,G[2]=E,G[3]=D,G[4]=I,G[5]=M,G[6]=N,G[7]=k,G[8]=F}}return O.create=function(R,P,E,D,I,M,N,k,F){return R===void 0&&(R=1),P===void 0&&(P=0),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=1),M===void 0&&(M=0),N===void 0&&(N=0),k===void 0&&(k=0),F===void 0&&(F=1),new O(R,P,E,D,I,M,N,k,F)},O.clone=function(R){var P=R.m;return new O(P[0],P[1],P[2],P[3],P[4],P[5],P[6],P[7],P[8])},O.copy=function(R,P){return R.m.set(P.m),R},O.set=function(R,P,E,D,I,M,N,k,F,G){var V=R.m;return V[0]=P,V[1]=E,V[2]=D,V[3]=I,V[4]=M,V[5]=N,V[6]=k,V[7]=F,V[8]=G,R},O.identity=function(R){var P=R.m;return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=1,P[5]=0,P[6]=0,P[7]=0,P[8]=1,R},O.transpose=function(R,P){var E=P.m,D=R.m;if(R===P){var I=E[1],M=E[2],N=E[5];D[1]=E[3],D[2]=E[6],D[3]=I,D[5]=E[7],D[6]=M,D[7]=N}else D[0]=E[0],D[1]=E[3],D[2]=E[6],D[3]=E[1],D[4]=E[4],D[5]=E[7],D[6]=E[2],D[7]=E[5],D[8]=E[8];return R},O.invert=function(R,P){var E=P.m,D=R.m,I=E[0],M=E[1],N=E[2],k=E[3],F=E[4],G=E[5],V=E[6],j=E[7],H=E[8],U=H*F-G*j,X=-H*k+G*V,Y=j*k-F*V,z=I*U+M*X+N*Y;return z&&(z=1/z,D[0]=U*z,D[1]=(-H*M+N*j)*z,D[2]=(G*M-N*F)*z,D[3]=X*z,D[4]=(H*I-N*V)*z,D[5]=(-G*I+N*k)*z,D[6]=Y*z,D[7]=(-j*I+M*V)*z,D[8]=(F*I-M*k)*z),R},O.adjoint=function(R,P){var E=P.m,D=R.m,I=E[0],M=E[1],N=E[2],k=E[3],F=E[4],G=E[5],V=E[6],j=E[7],H=E[8];return D[0]=F*H-G*j,D[1]=N*j-M*H,D[2]=M*G-N*F,D[3]=G*V-k*H,D[4]=I*H-N*V,D[5]=N*k-I*G,D[6]=k*j-F*V,D[7]=M*V-I*j,D[8]=I*F-M*k,R},O.determinant=function(R){var P=R.m,E=P[0],D=P[1],I=P[2],M=P[3],N=P[4],k=P[5],F=P[6],G=P[7],V=P[8];return E*(V*N-k*G)+D*(-V*M+k*F)+I*(G*M-N*F)},O.multiply=function(R,P,E){var D=P.m,I=E.m,M=R.m,N=D[0],k=D[1],F=D[2],G=D[3],V=D[4],j=D[5],H=D[6],U=D[7],X=D[8],Y=I[0],z=I[1],W=I[2],Z=I[3],Q=I[4],ee=I[5],te=I[6],re=I[7],ie=I[8];return M[0]=Y*N+z*G+W*H,M[1]=Y*k+z*V+W*U,M[2]=Y*F+z*j+W*X,M[3]=Z*N+Q*G+ee*H,M[4]=Z*k+Q*V+ee*U,M[5]=Z*F+Q*j+ee*X,M[6]=te*N+re*G+ie*H,M[7]=te*k+re*V+ie*U,M[8]=te*F+re*j+ie*X,R},O.multiplyMat4=function(R,P,E){var D=P.m,I=E.m,M=R.m,N=D[0],k=D[1],F=D[2],G=D[3],V=D[4],j=D[5],H=D[6],U=D[7],X=D[8],Y=I[0],z=I[1],W=I[2],Z=I[4],Q=I[5],ee=I[6],te=I[8],re=I[9],ie=I[10];return M[0]=Y*N+z*G+W*H,M[1]=Y*k+z*V+W*U,M[2]=Y*F+z*j+W*X,M[3]=Z*N+Q*G+ee*H,M[4]=Z*k+Q*V+ee*U,M[5]=Z*F+Q*j+ee*X,M[6]=te*N+re*G+ie*H,M[7]=te*k+re*V+ie*U,M[8]=te*F+re*j+ie*X,R},O.translate=function(R,P,E){var D=P.m,I=R.m,M=D[0],N=D[1],k=D[2],F=D[3],G=D[4],V=D[5],j=D[6],H=D[7],U=D[8],X=E.x,Y=E.y;return I[0]=M,I[1]=N,I[2]=k,I[3]=F,I[4]=G,I[5]=V,I[6]=X*M+Y*F+j,I[7]=X*N+Y*G+H,I[8]=X*k+Y*V+U,R},O.rotate=function(R,P,E){var D=P.m,I=R.m,M=D[0],N=D[1],k=D[2],F=D[3],G=D[4],V=D[5],j=D[6],H=D[7],U=D[8],X=Math.sin(E),Y=Math.cos(E);return I[0]=Y*M+X*F,I[1]=Y*N+X*G,I[2]=Y*k+X*V,I[3]=Y*F-X*M,I[4]=Y*G-X*N,I[5]=Y*V-X*k,I[6]=j,I[7]=H,I[8]=U,R},O.scale=function(R,P,E){var D=E.x,I=E.y,M=P.m,N=R.m;return N[0]=D*M[0],N[1]=D*M[1],N[2]=D*M[2],N[3]=I*M[3],N[4]=I*M[4],N[5]=I*M[5],N[6]=M[6],N[7]=M[7],N[8]=M[8],R},O.fromMat4=function(R,P){var E=P.m,D=R.m;return D[0]=E[0],D[1]=E[1],D[2]=E[2],D[3]=E[4],D[4]=E[5],D[5]=E[6],D[6]=E[8],D[7]=E[9],D[8]=E[10],R},O.fromTranslation=function(R,P){var E=R.m;return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=1,E[5]=0,E[6]=P.x,E[7]=P.y,E[8]=1,R},O.fromRotation=function(R,P){var E=Math.sin(P),D=Math.cos(P),I=R.m;return I[0]=D,I[1]=E,I[2]=0,I[3]=-E,I[4]=D,I[5]=0,I[6]=0,I[7]=0,I[8]=1,R},O.fromScaling=function(R,P){var E=R.m;return E[0]=P.x,E[1]=0,E[2]=0,E[3]=0,E[4]=P.y,E[5]=0,E[6]=0,E[7]=0,E[8]=1,R},O.fromQuat=function(R,P){var E=R.m,D=P.x,I=P.y,M=P.z,N=P.w,k=D+D,F=I+I,G=M+M,V=D*k,j=I*k,H=I*F,U=M*k,X=M*F,Y=M*G,z=N*k,W=N*F,Z=N*G;return E[0]=1-H-Y,E[3]=j-Z,E[6]=U+W,E[1]=j+Z,E[4]=1-V-Y,E[7]=X-z,E[2]=U-W,E[5]=X+z,E[8]=1-V-H,R},O.fromViewUp=function(R,P,E){var D,I,M;return(D=new B.default(0,1,0),I=new B.default,M=new B.default,function(N,k,F){return B.default.lengthSqr(k)<w.EPSILON*w.EPSILON?(O.identity(N),N):(F=F||D,B.default.normalize(I,B.default.cross(I,F,k)),B.default.lengthSqr(I)<w.EPSILON*w.EPSILON?(O.identity(N),N):(B.default.cross(M,k,I),O.set(N,I.x,I.y,I.z,M.x,M.y,M.z,k.x,k.y,k.z),N))})(R,P,E)},O.normalFromMat4=function(R,P){var E=P.m,D=R.m,I=E[0],M=E[1],N=E[2],k=E[3],F=E[4],G=E[5],V=E[6],j=E[7],H=E[8],U=E[9],X=E[10],Y=E[11],z=E[12],W=E[13],Z=E[14],Q=E[15],ee=I*G-M*F,te=I*V-N*F,re=I*j-k*F,ie=M*V-N*G,ne=M*j-k*G,he=N*j-k*V,pe=H*W-U*z,K=H*Z-X*z,ue=H*Q-Y*z,le=U*Z-X*W,ce=U*Q-Y*W,_e=X*Q-Y*Z,oe=ee*_e-te*ce+re*le+ie*ue-ne*K+he*pe;return oe&&(oe=1/oe,D[0]=(G*_e-V*ce+j*le)*oe,D[1]=(V*ue-F*_e-j*K)*oe,D[2]=(F*ce-G*ue+j*pe)*oe,D[3]=(N*ce-M*_e-k*le)*oe,D[4]=(I*_e-N*ue+k*K)*oe,D[5]=(M*ue-I*ce-k*pe)*oe,D[6]=(W*he-Z*ne+Q*ie)*oe,D[7]=(Z*re-z*he-Q*te)*oe,D[8]=(z*ne-W*re+Q*ee)*oe),R},O.frob=function(R){var P=R.m;return Math.sqrt(Math.pow(P[0],2)+Math.pow(P[1],2)+Math.pow(P[2],2)+Math.pow(P[3],2)+Math.pow(P[4],2)+Math.pow(P[5],2)+Math.pow(P[6],2)+Math.pow(P[7],2)+Math.pow(P[8],2))},O.add=function(R,P,E){var D=P.m,I=E.m,M=R.m;return M[0]=D[0]+I[0],M[1]=D[1]+I[1],M[2]=D[2]+I[2],M[3]=D[3]+I[3],M[4]=D[4]+I[4],M[5]=D[5]+I[5],M[6]=D[6]+I[6],M[7]=D[7]+I[7],M[8]=D[8]+I[8],R},O.subtract=function(R,P,E){var D=P.m,I=E.m,M=R.m;return M[0]=D[0]-I[0],M[1]=D[1]-I[1],M[2]=D[2]-I[2],M[3]=D[3]-I[3],M[4]=D[4]-I[4],M[5]=D[5]-I[5],M[6]=D[6]-I[6],M[7]=D[7]-I[7],M[8]=D[8]-I[8],R},O.multiplyScalar=function(R,P,E){var D=P.m,I=R.m;return I[0]=D[0]*E,I[1]=D[1]*E,I[2]=D[2]*E,I[3]=D[3]*E,I[4]=D[4]*E,I[5]=D[5]*E,I[6]=D[6]*E,I[7]=D[7]*E,I[8]=D[8]*E,R},O.multiplyScalarAndAdd=function(R,P,E,D){var I=P.m,M=E.m,N=R.m;return N[0]=I[0]+M[0]*D,N[1]=I[1]+M[1]*D,N[2]=I[2]+M[2]*D,N[3]=I[3]+M[3]*D,N[4]=I[4]+M[4]*D,N[5]=I[5]+M[5]*D,N[6]=I[6]+M[6]*D,N[7]=I[7]+M[7]*D,N[8]=I[8]+M[8]*D,R},O.exactEquals=function(R,P){var E=R.m,D=P.m;return E[0]===D[0]&&E[1]===D[1]&&E[2]===D[2]&&E[3]===D[3]&&E[4]===D[4]&&E[5]===D[5]&&E[6]===D[6]&&E[7]===D[7]&&E[8]===D[8]},O.equals=function(R,P){var E=R.m,D=P.m,I=E[0],M=E[1],N=E[2],k=E[3],F=E[4],G=E[5],V=E[6],j=E[7],H=E[8],U=D[0],X=D[1],Y=D[2],z=D[3],W=D[4],Z=D[5],Q=D[6],ee=D[7],te=D[8];return Math.abs(I-U)<=w.EPSILON*Math.max(1,Math.abs(I),Math.abs(U))&&Math.abs(M-X)<=w.EPSILON*Math.max(1,Math.abs(M),Math.abs(X))&&Math.abs(N-Y)<=w.EPSILON*Math.max(1,Math.abs(N),Math.abs(Y))&&Math.abs(k-z)<=w.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(F-W)<=w.EPSILON*Math.max(1,Math.abs(F),Math.abs(W))&&Math.abs(G-Z)<=w.EPSILON*Math.max(1,Math.abs(G),Math.abs(Z))&&Math.abs(V-Q)<=w.EPSILON*Math.max(1,Math.abs(V),Math.abs(Q))&&Math.abs(j-ee)<=w.EPSILON*Math.max(1,Math.abs(j),Math.abs(ee))&&Math.abs(H-te)<=w.EPSILON*Math.max(1,Math.abs(H),Math.abs(te))},O.toArray=function(R,P,E){E===void 0&&(E=0);for(var D=P.m,I=0;I<9;I++)R[E+I]=D[I];return R},O.fromArray=function(R,P,E){E===void 0&&(E=0);for(var D=R.m,I=0;I<9;I++)D[I]=P[E+I];return R},O.prototype.toString=function(){var R=this.m;return"mat3("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+", "+R[4]+", "+R[5]+", "+R[6]+", "+R[7]+", "+R[8]+")"},O}();T.default=A,A.sub=A.subtract,A.mul=A.multiply,A.IDENTITY=Object.freeze(new A),cc.Mat3=A,S.exports=T.default},{"../value-types/utils":293,"./vec3":296}],288:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=P(L("./value-type")),w=P(L("../platform/CCClass")),B=P(L("./vec3")),A=P(L("./quat")),O=L("./utils"),R=P(L("./mat3"));function P(ne){return ne&&ne.__esModule?ne:{default:ne}}function E(ne,he){return(E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(pe,K){return pe.__proto__=K,pe})(ne,he)}var D=0,I=0,M=0,N=0,k=0,F=0,G=0,V=0,j=0,H=0,U=0,X=0,Y=0,z=0,W=0,Z=0,Q=function(ne){var he,pe;pe=ne,(he=ue).prototype=Object.create(pe.prototype),he.prototype.constructor=he,E(he,pe);var K=ue.prototype;function ue(le,ce,_e,oe,de,me,ye,ge,we,Te,Ee,De,fe,Ce,Se,be){var Re;if(le===void 0&&(le=1),ce===void 0&&(ce=0),_e===void 0&&(_e=0),oe===void 0&&(oe=0),de===void 0&&(de=0),me===void 0&&(me=1),ye===void 0&&(ye=0),ge===void 0&&(ge=0),we===void 0&&(we=0),Te===void 0&&(Te=0),Ee===void 0&&(Ee=1),De===void 0&&(De=0),fe===void 0&&(fe=0),Ce===void 0&&(Ce=0),Se===void 0&&(Se=0),be===void 0&&(be=1),(Re=ne.call(this)||this).m=void 0,le instanceof O.FLOAT_ARRAY_TYPE)Re.m=le;else{Re.m=new O.FLOAT_ARRAY_TYPE(16);var Ve=Re.m;Ve[0]=le,Ve[1]=ce,Ve[2]=_e,Ve[3]=oe,Ve[4]=de,Ve[5]=me,Ve[6]=ye,Ve[7]=ge,Ve[8]=we,Ve[9]=Te,Ve[10]=Ee,Ve[11]=De,Ve[12]=fe,Ve[13]=Ce,Ve[14]=Se,Ve[15]=be}return Re}return K.mul=function(le,ce){return ue.multiply(ce||new ue,this,le)},K.mulScalar=function(le,ce){ue.multiplyScalar(ce||new ue,this,le)},K.sub=function(le,ce){ue.subtract(ce||new ue,this,le)},ue.clone=function(le){var ce=le.m;return new ue(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5],ce[6],ce[7],ce[8],ce[9],ce[10],ce[11],ce[12],ce[13],ce[14],ce[15])},ue.copy=function(le,ce){var _e=le.m,oe=ce.m;return _e[0]=oe[0],_e[1]=oe[1],_e[2]=oe[2],_e[3]=oe[3],_e[4]=oe[4],_e[5]=oe[5],_e[6]=oe[6],_e[7]=oe[7],_e[8]=oe[8],_e[9]=oe[9],_e[10]=oe[10],_e[11]=oe[11],_e[12]=oe[12],_e[13]=oe[13],_e[14]=oe[14],_e[15]=oe[15],le},ue.set=function(le,ce,_e,oe,de,me,ye,ge,we,Te,Ee,De,fe,Ce,Se,be,Re){var Ve=le.m;return Ve[0]=ce,Ve[1]=_e,Ve[2]=oe,Ve[3]=de,Ve[4]=me,Ve[5]=ye,Ve[6]=ge,Ve[7]=we,Ve[8]=Te,Ve[9]=Ee,Ve[10]=De,Ve[11]=fe,Ve[12]=Ce,Ve[13]=Se,Ve[14]=be,Ve[15]=Re,le},ue.identity=function(le){var ce=le.m;return ce[0]=1,ce[1]=0,ce[2]=0,ce[3]=0,ce[4]=0,ce[5]=1,ce[6]=0,ce[7]=0,ce[8]=0,ce[9]=0,ce[10]=1,ce[11]=0,ce[12]=0,ce[13]=0,ce[14]=0,ce[15]=1,le},ue.transpose=function(le,ce){var _e=le.m,oe=ce.m;if(le===ce){var de=oe[1],me=oe[2],ye=oe[3],ge=oe[6],we=oe[7],Te=oe[11];_e[1]=oe[4],_e[2]=oe[8],_e[3]=oe[12],_e[4]=de,_e[6]=oe[9],_e[7]=oe[13],_e[8]=me,_e[9]=ge,_e[11]=oe[14],_e[12]=ye,_e[13]=we,_e[14]=Te}else _e[0]=oe[0],_e[1]=oe[4],_e[2]=oe[8],_e[3]=oe[12],_e[4]=oe[1],_e[5]=oe[5],_e[6]=oe[9],_e[7]=oe[13],_e[8]=oe[2],_e[9]=oe[6],_e[10]=oe[10],_e[11]=oe[14],_e[12]=oe[3],_e[13]=oe[7],_e[14]=oe[11],_e[15]=oe[15];return le},ue.invert=function(le,ce){var _e=ce.m;D=_e[0],I=_e[1],M=_e[2],N=_e[3],k=_e[4],F=_e[5],G=_e[6],V=_e[7],j=_e[8],H=_e[9],U=_e[10],X=_e[11],Y=_e[12],z=_e[13],W=_e[14],Z=_e[15];var oe=D*F-I*k,de=D*G-M*k,me=D*V-N*k,ye=I*G-M*F,ge=I*V-N*F,we=M*V-N*G,Te=j*z-H*Y,Ee=j*W-U*Y,De=j*Z-X*Y,fe=H*W-U*z,Ce=H*Z-X*z,Se=U*Z-X*W,be=oe*Se-de*Ce+me*fe+ye*De-ge*Ee+we*Te;if(be===0)return null;be=1/be;var Re=le.m;return Re[0]=(F*Se-G*Ce+V*fe)*be,Re[1]=(M*Ce-I*Se-N*fe)*be,Re[2]=(z*we-W*ge+Z*ye)*be,Re[3]=(U*ge-H*we-X*ye)*be,Re[4]=(G*De-k*Se-V*Ee)*be,Re[5]=(D*Se-M*De+N*Ee)*be,Re[6]=(W*me-Y*we-Z*de)*be,Re[7]=(j*we-U*me+X*de)*be,Re[8]=(k*Ce-F*De+V*Te)*be,Re[9]=(I*De-D*Ce-N*Te)*be,Re[10]=(Y*ge-z*me+Z*oe)*be,Re[11]=(H*me-j*ge-X*oe)*be,Re[12]=(F*Ee-k*fe-G*Te)*be,Re[13]=(D*fe-I*Ee+M*Te)*be,Re[14]=(z*de-Y*ye-W*oe)*be,Re[15]=(j*ye-H*de+U*oe)*be,le},ue.determinant=function(le){var ce=le.m;return D=ce[0],I=ce[1],M=ce[2],N=ce[3],k=ce[4],F=ce[5],G=ce[6],V=ce[7],j=ce[8],H=ce[9],U=ce[10],X=ce[11],Y=ce[12],z=ce[13],W=ce[14],Z=ce[15],(D*F-I*k)*(U*Z-X*W)-(D*G-M*k)*(H*Z-X*z)+(D*V-N*k)*(H*W-U*z)+(I*G-M*F)*(j*Z-X*Y)-(I*V-N*F)*(j*W-U*Y)+(M*V-N*G)*(j*z-H*Y)},ue.multiply=function(le,ce,_e){var oe=le.m,de=ce.m,me=_e.m;D=de[0],I=de[1],M=de[2],N=de[3],k=de[4],F=de[5],G=de[6],V=de[7],j=de[8],H=de[9],U=de[10],X=de[11],Y=de[12],z=de[13],W=de[14],Z=de[15];var ye=me[0],ge=me[1],we=me[2],Te=me[3];return oe[0]=ye*D+ge*k+we*j+Te*Y,oe[1]=ye*I+ge*F+we*H+Te*z,oe[2]=ye*M+ge*G+we*U+Te*W,oe[3]=ye*N+ge*V+we*X+Te*Z,ye=me[4],ge=me[5],we=me[6],Te=me[7],oe[4]=ye*D+ge*k+we*j+Te*Y,oe[5]=ye*I+ge*F+we*H+Te*z,oe[6]=ye*M+ge*G+we*U+Te*W,oe[7]=ye*N+ge*V+we*X+Te*Z,ye=me[8],ge=me[9],we=me[10],Te=me[11],oe[8]=ye*D+ge*k+we*j+Te*Y,oe[9]=ye*I+ge*F+we*H+Te*z,oe[10]=ye*M+ge*G+we*U+Te*W,oe[11]=ye*N+ge*V+we*X+Te*Z,ye=me[12],ge=me[13],we=me[14],Te=me[15],oe[12]=ye*D+ge*k+we*j+Te*Y,oe[13]=ye*I+ge*F+we*H+Te*z,oe[14]=ye*M+ge*G+we*U+Te*W,oe[15]=ye*N+ge*V+we*X+Te*Z,le},ue.transform=function(le,ce,_e){var oe=_e.x,de=_e.y,me=_e.z,ye=le.m,ge=ce.m;return ce===le?(ye[12]=ge[0]*oe+ge[4]*de+ge[8]*me+ge[12],ye[13]=ge[1]*oe+ge[5]*de+ge[9]*me+ge[13],ye[14]=ge[2]*oe+ge[6]*de+ge[10]*me+ge[14],ye[15]=ge[3]*oe+ge[7]*de+ge[11]*me+ge[15]):(D=ge[0],I=ge[1],M=ge[2],N=ge[3],k=ge[4],F=ge[5],G=ge[6],V=ge[7],j=ge[8],H=ge[9],U=ge[10],X=ge[11],Y=ge[12],z=ge[13],W=ge[14],Z=ge[15],ye[0]=D,ye[1]=I,ye[2]=M,ye[3]=N,ye[4]=k,ye[5]=F,ye[6]=G,ye[7]=V,ye[8]=j,ye[9]=H,ye[10]=U,ye[11]=X,ye[12]=D*oe+k*de+j*me+ge[12],ye[13]=I*oe+F*de+H*me+ge[13],ye[14]=M*oe+G*de+U*me+ge[14],ye[15]=N*oe+V*de+X*me+ge[15]),le},ue.translate=function(le,ce,_e){var oe=le.m,de=ce.m;return ce===le?(oe[12]+=_e.x,oe[13]+=_e.y,oe[14]+=_e.z):(oe[0]=de[0],oe[1]=de[1],oe[2]=de[2],oe[3]=de[3],oe[4]=de[4],oe[5]=de[5],oe[6]=de[6],oe[7]=de[7],oe[8]=de[8],oe[9]=de[9],oe[10]=de[10],oe[11]=de[11],oe[12]+=_e.x,oe[13]+=_e.y,oe[14]+=_e.z,oe[15]=de[15]),le},ue.scale=function(le,ce,_e){var oe=_e.x,de=_e.y,me=_e.z,ye=le.m,ge=ce.m;return ye[0]=ge[0]*oe,ye[1]=ge[1]*oe,ye[2]=ge[2]*oe,ye[3]=ge[3]*oe,ye[4]=ge[4]*de,ye[5]=ge[5]*de,ye[6]=ge[6]*de,ye[7]=ge[7]*de,ye[8]=ge[8]*me,ye[9]=ge[9]*me,ye[10]=ge[10]*me,ye[11]=ge[11]*me,ye[12]=ge[12],ye[13]=ge[13],ye[14]=ge[14],ye[15]=ge[15],le},ue.rotate=function(le,ce,_e,oe){var de=oe.x,me=oe.y,ye=oe.z,ge=Math.sqrt(de*de+me*me+ye*ye);if(Math.abs(ge)<O.EPSILON)return null;de*=ge=1/ge,me*=ge,ye*=ge;var we=Math.sin(_e),Te=Math.cos(_e),Ee=1-Te,De=ce.m;D=De[0],I=De[1],M=De[2],N=De[3],k=De[4],F=De[5],G=De[6],V=De[7],j=De[8],H=De[9],U=De[10],X=De[11];var fe=de*de*Ee+Te,Ce=me*de*Ee+ye*we,Se=ye*de*Ee-me*we,be=de*me*Ee-ye*we,Re=me*me*Ee+Te,Ve=ye*me*Ee+de*we,Pe=de*ye*Ee+me*we,ke=me*ye*Ee-de*we,Ne=ye*ye*Ee+Te,Ae=le.m;return Ae[0]=D*fe+k*Ce+j*Se,Ae[1]=I*fe+F*Ce+H*Se,Ae[2]=M*fe+G*Ce+U*Se,Ae[3]=N*fe+V*Ce+X*Se,Ae[4]=D*be+k*Re+j*Ve,Ae[5]=I*be+F*Re+H*Ve,Ae[6]=M*be+G*Re+U*Ve,Ae[7]=N*be+V*Re+X*Ve,Ae[8]=D*Pe+k*ke+j*Ne,Ae[9]=I*Pe+F*ke+H*Ne,Ae[10]=M*Pe+G*ke+U*Ne,Ae[11]=N*Pe+V*ke+X*Ne,ce!==le&&(Ae[12]=De[12],Ae[13]=De[13],Ae[14]=De[14],Ae[15]=De[15]),le},ue.rotateX=function(le,ce,_e){var oe=le.m,de=ce.m,me=Math.sin(_e),ye=Math.cos(_e),ge=de[4],we=de[5],Te=de[6],Ee=de[7],De=de[8],fe=de[9],Ce=de[10],Se=de[11];return ce!==le&&(oe[0]=de[0],oe[1]=de[1],oe[2]=de[2],oe[3]=de[3],oe[12]=de[12],oe[13]=de[13],oe[14]=de[14],oe[15]=de[15]),oe[4]=ge*ye+De*me,oe[5]=we*ye+fe*me,oe[6]=Te*ye+Ce*me,oe[7]=Ee*ye+Se*me,oe[8]=De*ye-ge*me,oe[9]=fe*ye-we*me,oe[10]=Ce*ye-Te*me,oe[11]=Se*ye-Ee*me,le},ue.rotateY=function(le,ce,_e){var oe=le.m,de=ce.m,me=Math.sin(_e),ye=Math.cos(_e),ge=de[0],we=de[1],Te=de[2],Ee=de[3],De=de[8],fe=de[9],Ce=de[10],Se=de[11];return ce!==le&&(oe[4]=de[4],oe[5]=de[5],oe[6]=de[6],oe[7]=de[7],oe[12]=de[12],oe[13]=de[13],oe[14]=de[14],oe[15]=de[15]),oe[0]=ge*ye-De*me,oe[1]=we*ye-fe*me,oe[2]=Te*ye-Ce*me,oe[3]=Ee*ye-Se*me,oe[8]=ge*me+De*ye,oe[9]=we*me+fe*ye,oe[10]=Te*me+Ce*ye,oe[11]=Ee*me+Se*ye,le},ue.rotateZ=function(le,ce,_e){var oe=ce.m,de=le.m,me=Math.sin(_e),ye=Math.cos(_e),ge=ce.m[0],we=ce.m[1],Te=ce.m[2],Ee=ce.m[3],De=ce.m[4],fe=ce.m[5],Ce=ce.m[6],Se=ce.m[7];return ce!==le&&(de[8]=oe[8],de[9]=oe[9],de[10]=oe[10],de[11]=oe[11],de[12]=oe[12],de[13]=oe[13],de[14]=oe[14],de[15]=oe[15]),de[0]=ge*ye+De*me,de[1]=we*ye+fe*me,de[2]=Te*ye+Ce*me,de[3]=Ee*ye+Se*me,de[4]=De*ye-ge*me,de[5]=fe*ye-we*me,de[6]=Ce*ye-Te*me,de[7]=Se*ye-Ee*me,le},ue.fromTranslation=function(le,ce){var _e=le.m;return _e[0]=1,_e[1]=0,_e[2]=0,_e[3]=0,_e[4]=0,_e[5]=1,_e[6]=0,_e[7]=0,_e[8]=0,_e[9]=0,_e[10]=1,_e[11]=0,_e[12]=ce.x,_e[13]=ce.y,_e[14]=ce.z,_e[15]=1,le},ue.fromScaling=function(le,ce){var _e=le.m;return _e[0]=ce.x,_e[1]=0,_e[2]=0,_e[3]=0,_e[4]=0,_e[5]=ce.y,_e[6]=0,_e[7]=0,_e[8]=0,_e[9]=0,_e[10]=ce.z,_e[11]=0,_e[12]=0,_e[13]=0,_e[14]=0,_e[15]=1,le},ue.fromRotation=function(le,ce,_e){var oe=_e.x,de=_e.y,me=_e.z,ye=Math.sqrt(oe*oe+de*de+me*me);if(Math.abs(ye)<O.EPSILON)return null;oe*=ye=1/ye,de*=ye,me*=ye;var ge=Math.sin(ce),we=Math.cos(ce),Te=1-we,Ee=le.m;return Ee[0]=oe*oe*Te+we,Ee[1]=de*oe*Te+me*ge,Ee[2]=me*oe*Te-de*ge,Ee[3]=0,Ee[4]=oe*de*Te-me*ge,Ee[5]=de*de*Te+we,Ee[6]=me*de*Te+oe*ge,Ee[7]=0,Ee[8]=oe*me*Te+de*ge,Ee[9]=de*me*Te-oe*ge,Ee[10]=me*me*Te+we,Ee[11]=0,Ee[12]=0,Ee[13]=0,Ee[14]=0,Ee[15]=1,le},ue.fromXRotation=function(le,ce){var _e=Math.sin(ce),oe=Math.cos(ce),de=le.m;return de[0]=1,de[1]=0,de[2]=0,de[3]=0,de[4]=0,de[5]=oe,de[6]=_e,de[7]=0,de[8]=0,de[9]=-_e,de[10]=oe,de[11]=0,de[12]=0,de[13]=0,de[14]=0,de[15]=1,le},ue.fromYRotation=function(le,ce){var _e=Math.sin(ce),oe=Math.cos(ce),de=le.m;return de[0]=oe,de[1]=0,de[2]=-_e,de[3]=0,de[4]=0,de[5]=1,de[6]=0,de[7]=0,de[8]=_e,de[9]=0,de[10]=oe,de[11]=0,de[12]=0,de[13]=0,de[14]=0,de[15]=1,le},ue.fromZRotation=function(le,ce){var _e=Math.sin(ce),oe=Math.cos(ce),de=le.m;return de[0]=oe,de[1]=_e,de[2]=0,de[3]=0,de[4]=-_e,de[5]=oe,de[6]=0,de[7]=0,de[8]=0,de[9]=0,de[10]=1,de[11]=0,de[12]=0,de[13]=0,de[14]=0,de[15]=1,le},ue.fromRT=function(le,ce,_e){var oe=ce.x,de=ce.y,me=ce.z,ye=ce.w,ge=oe+oe,we=de+de,Te=me+me,Ee=oe*ge,De=oe*we,fe=oe*Te,Ce=de*we,Se=de*Te,be=me*Te,Re=ye*ge,Ve=ye*we,Pe=ye*Te,ke=le.m;return ke[0]=1-(Ce+be),ke[1]=De+Pe,ke[2]=fe-Ve,ke[3]=0,ke[4]=De-Pe,ke[5]=1-(Ee+be),ke[6]=Se+Re,ke[7]=0,ke[8]=fe+Ve,ke[9]=Se-Re,ke[10]=1-(Ee+Ce),ke[11]=0,ke[12]=_e.x,ke[13]=_e.y,ke[14]=_e.z,ke[15]=1,le},ue.getTranslation=function(le,ce){var _e=ce.m;return le.x=_e[12],le.y=_e[13],le.z=_e[14],le},ue.getScaling=function(le,ce){var _e=ce.m,oe=te.m,de=oe[0]=_e[0],me=oe[1]=_e[1],ye=oe[2]=_e[2],ge=oe[3]=_e[4],we=oe[4]=_e[5],Te=oe[5]=_e[6],Ee=oe[6]=_e[8],De=oe[7]=_e[9],fe=oe[8]=_e[10];return le.x=Math.sqrt(de*de+me*me+ye*ye),le.y=Math.sqrt(ge*ge+we*we+Te*Te),le.z=Math.sqrt(Ee*Ee+De*De+fe*fe),R.default.determinant(te)<0&&(le.x*=-1),le},ue.getRotation=function(le,ce){var _e=ce.m,oe=_e[0]+_e[5]+_e[10],de=0;return oe>0?(de=2*Math.sqrt(oe+1),le.w=.25*de,le.x=(_e[6]-_e[9])/de,le.y=(_e[8]-_e[2])/de,le.z=(_e[1]-_e[4])/de):_e[0]>_e[5]&&_e[0]>_e[10]?(de=2*Math.sqrt(1+_e[0]-_e[5]-_e[10]),le.w=(_e[6]-_e[9])/de,le.x=.25*de,le.y=(_e[1]+_e[4])/de,le.z=(_e[8]+_e[2])/de):_e[5]>_e[10]?(de=2*Math.sqrt(1+_e[5]-_e[0]-_e[10]),le.w=(_e[8]-_e[2])/de,le.x=(_e[1]+_e[4])/de,le.y=.25*de,le.z=(_e[6]+_e[9])/de):(de=2*Math.sqrt(1+_e[10]-_e[0]-_e[5]),le.w=(_e[1]-_e[4])/de,le.x=(_e[8]+_e[2])/de,le.y=(_e[6]+_e[9])/de,le.z=.25*de),le},ue.toRTS=function(le,ce,_e,oe){var de=le.m,me=te.m;oe.x=B.default.set(ee,de[0],de[1],de[2]).mag(),me[0]=de[0]/oe.x,me[1]=de[1]/oe.x,me[2]=de[2]/oe.x,oe.y=B.default.set(ee,de[4],de[5],de[6]).mag(),me[3]=de[4]/oe.y,me[4]=de[5]/oe.y,me[5]=de[6]/oe.y,oe.z=B.default.set(ee,de[8],de[9],de[10]).mag(),me[6]=de[8]/oe.z,me[7]=de[9]/oe.z,me[8]=de[10]/oe.z,R.default.determinant(te)<0&&(oe.x*=-1,me[0]*=-1,me[1]*=-1,me[2]*=-1),A.default.fromMat3(ce,te),B.default.set(_e,de[12],de[13],de[14])},ue.fromRTS=function(le,ce,_e,oe){var de=ce.x,me=ce.y,ye=ce.z,ge=ce.w,we=de+de,Te=me+me,Ee=ye+ye,De=de*we,fe=de*Te,Ce=de*Ee,Se=me*Te,be=me*Ee,Re=ye*Ee,Ve=ge*we,Pe=ge*Te,ke=ge*Ee,Ne=oe.x,Ae=oe.y,Oe=oe.z,Fe=le.m;return Fe[0]=(1-(Se+Re))*Ne,Fe[1]=(fe+ke)*Ne,Fe[2]=(Ce-Pe)*Ne,Fe[3]=0,Fe[4]=(fe-ke)*Ae,Fe[5]=(1-(De+Re))*Ae,Fe[6]=(be+Ve)*Ae,Fe[7]=0,Fe[8]=(Ce+Pe)*Oe,Fe[9]=(be-Ve)*Oe,Fe[10]=(1-(De+Se))*Oe,Fe[11]=0,Fe[12]=_e.x,Fe[13]=_e.y,Fe[14]=_e.z,Fe[15]=1,le},ue.fromRTSOrigin=function(le,ce,_e,oe,de){var me=ce.x,ye=ce.y,ge=ce.z,we=ce.w,Te=me+me,Ee=ye+ye,De=ge+ge,fe=me*Te,Ce=me*Ee,Se=me*De,be=ye*Ee,Re=ye*De,Ve=ge*De,Pe=we*Te,ke=we*Ee,Ne=we*De,Ae=oe.x,Oe=oe.y,Fe=oe.z,nt=de.x,Ze=de.y,Xe=de.z,$e=le.m;return $e[0]=(1-(be+Ve))*Ae,$e[1]=(Ce+Ne)*Ae,$e[2]=(Se-ke)*Ae,$e[3]=0,$e[4]=(Ce-Ne)*Oe,$e[5]=(1-(fe+Ve))*Oe,$e[6]=(Re+Pe)*Oe,$e[7]=0,$e[8]=(Se+ke)*Fe,$e[9]=(Re-Pe)*Fe,$e[10]=(1-(fe+be))*Fe,$e[11]=0,$e[12]=_e.x+nt-($e[0]*nt+$e[4]*Ze+$e[8]*Xe),$e[13]=_e.y+Ze-($e[1]*nt+$e[5]*Ze+$e[9]*Xe),$e[14]=_e.z+Xe-($e[2]*nt+$e[6]*Ze+$e[10]*Xe),$e[15]=1,le},ue.fromQuat=function(le,ce){var _e=ce.x,oe=ce.y,de=ce.z,me=ce.w,ye=_e+_e,ge=oe+oe,we=de+de,Te=_e*ye,Ee=oe*ye,De=oe*ge,fe=de*ye,Ce=de*ge,Se=de*we,be=me*ye,Re=me*ge,Ve=me*we,Pe=le.m;return Pe[0]=1-De-Se,Pe[1]=Ee+Ve,Pe[2]=fe-Re,Pe[3]=0,Pe[4]=Ee-Ve,Pe[5]=1-Te-Se,Pe[6]=Ce+be,Pe[7]=0,Pe[8]=fe+Re,Pe[9]=Ce-be,Pe[10]=1-Te-De,Pe[11]=0,Pe[12]=0,Pe[13]=0,Pe[14]=0,Pe[15]=1,le},ue.frustum=function(le,ce,_e,oe,de,me,ye){var ge=1/(_e-ce),we=1/(de-oe),Te=1/(me-ye),Ee=le.m;return Ee[0]=2*me*ge,Ee[1]=0,Ee[2]=0,Ee[3]=0,Ee[4]=0,Ee[5]=2*me*we,Ee[6]=0,Ee[7]=0,Ee[8]=(_e+ce)*ge,Ee[9]=(de+oe)*we,Ee[10]=(ye+me)*Te,Ee[11]=-1,Ee[12]=0,Ee[13]=0,Ee[14]=ye*me*2*Te,Ee[15]=0,le},ue.perspective=function(le,ce,_e,oe,de){var me=1/Math.tan(ce/2),ye=1/(oe-de),ge=le.m;return ge[0]=me/_e,ge[1]=0,ge[2]=0,ge[3]=0,ge[4]=0,ge[5]=me,ge[6]=0,ge[7]=0,ge[8]=0,ge[9]=0,ge[10]=(de+oe)*ye,ge[11]=-1,ge[12]=0,ge[13]=0,ge[14]=2*de*oe*ye,ge[15]=0,le},ue.ortho=function(le,ce,_e,oe,de,me,ye){var ge=1/(ce-_e),we=1/(oe-de),Te=1/(me-ye),Ee=le.m;return Ee[0]=-2*ge,Ee[1]=0,Ee[2]=0,Ee[3]=0,Ee[4]=0,Ee[5]=-2*we,Ee[6]=0,Ee[7]=0,Ee[8]=0,Ee[9]=0,Ee[10]=2*Te,Ee[11]=0,Ee[12]=(ce+_e)*ge,Ee[13]=(de+oe)*we,Ee[14]=(ye+me)*Te,Ee[15]=1,le},ue.lookAt=function(le,ce,_e,oe){var de=ce.x,me=ce.y,ye=ce.z,ge=oe.x,we=oe.y,Te=oe.z,Ee=de-_e.x,De=me-_e.y,fe=ye-_e.z,Ce=1/Math.sqrt(Ee*Ee+De*De+fe*fe),Se=we*(fe*=Ce)-Te*(De*=Ce),be=Te*(Ee*=Ce)-ge*fe,Re=ge*De-we*Ee,Ve=De*(Re*=Ce=1/Math.sqrt(Se*Se+be*be+Re*Re))-fe*(be*=Ce),Pe=fe*(Se*=Ce)-Ee*Re,ke=Ee*be-De*Se,Ne=le.m;return Ne[0]=Se,Ne[1]=Ve,Ne[2]=Ee,Ne[3]=0,Ne[4]=be,Ne[5]=Pe,Ne[6]=De,Ne[7]=0,Ne[8]=Re,Ne[9]=ke,Ne[10]=fe,Ne[11]=0,Ne[12]=-(Se*de+be*me+Re*ye),Ne[13]=-(Ve*de+Pe*me+ke*ye),Ne[14]=-(Ee*de+De*me+fe*ye),Ne[15]=1,le},ue.inverseTranspose=function(le,ce){var _e=ce.m;D=_e[0],I=_e[1],M=_e[2],N=_e[3],k=_e[4],F=_e[5],G=_e[6],V=_e[7],j=_e[8],H=_e[9],U=_e[10],X=_e[11],Y=_e[12],z=_e[13],W=_e[14],Z=_e[15];var oe=D*F-I*k,de=D*G-M*k,me=D*V-N*k,ye=I*G-M*F,ge=I*V-N*F,we=M*V-N*G,Te=j*z-H*Y,Ee=j*W-U*Y,De=j*Z-X*Y,fe=H*W-U*z,Ce=H*Z-X*z,Se=U*Z-X*W,be=oe*Se-de*Ce+me*fe+ye*De-ge*Ee+we*Te;return be?(be=1/be,(_e=le.m)[0]=(F*Se-G*Ce+V*fe)*be,_e[1]=(G*De-k*Se-V*Ee)*be,_e[2]=(k*Ce-F*De+V*Te)*be,_e[3]=0,_e[4]=(M*Ce-I*Se-N*fe)*be,_e[5]=(D*Se-M*De+N*Ee)*be,_e[6]=(I*De-D*Ce-N*Te)*be,_e[7]=0,_e[8]=(z*we-W*ge+Z*ye)*be,_e[9]=(W*me-Y*we-Z*de)*be,_e[10]=(Y*ge-z*me+Z*oe)*be,_e[11]=0,_e[12]=0,_e[13]=0,_e[14]=0,_e[15]=1,le):null},ue.add=function(le,ce,_e){var oe=le.m,de=ce.m,me=_e.m;return oe[0]=de[0]+me[0],oe[1]=de[1]+me[1],oe[2]=de[2]+me[2],oe[3]=de[3]+me[3],oe[4]=de[4]+me[4],oe[5]=de[5]+me[5],oe[6]=de[6]+me[6],oe[7]=de[7]+me[7],oe[8]=de[8]+me[8],oe[9]=de[9]+me[9],oe[10]=de[10]+me[10],oe[11]=de[11]+me[11],oe[12]=de[12]+me[12],oe[13]=de[13]+me[13],oe[14]=de[14]+me[14],oe[15]=de[15]+me[15],le},ue.subtract=function(le,ce,_e){var oe=le.m,de=ce.m,me=_e.m;return oe[0]=de[0]-me[0],oe[1]=de[1]-me[1],oe[2]=de[2]-me[2],oe[3]=de[3]-me[3],oe[4]=de[4]-me[4],oe[5]=de[5]-me[5],oe[6]=de[6]-me[6],oe[7]=de[7]-me[7],oe[8]=de[8]-me[8],oe[9]=de[9]-me[9],oe[10]=de[10]-me[10],oe[11]=de[11]-me[11],oe[12]=de[12]-me[12],oe[13]=de[13]-me[13],oe[14]=de[14]-me[14],oe[15]=de[15]-me[15],le},ue.multiplyScalar=function(le,ce,_e){var oe=le.m,de=ce.m;return oe[0]=de[0]*_e,oe[1]=de[1]*_e,oe[2]=de[2]*_e,oe[3]=de[3]*_e,oe[4]=de[4]*_e,oe[5]=de[5]*_e,oe[6]=de[6]*_e,oe[7]=de[7]*_e,oe[8]=de[8]*_e,oe[9]=de[9]*_e,oe[10]=de[10]*_e,oe[11]=de[11]*_e,oe[12]=de[12]*_e,oe[13]=de[13]*_e,oe[14]=de[14]*_e,oe[15]=de[15]*_e,le},ue.multiplyScalarAndAdd=function(le,ce,_e,oe){var de=le.m,me=ce.m,ye=_e.m;return de[0]=me[0]+ye[0]*oe,de[1]=me[1]+ye[1]*oe,de[2]=me[2]+ye[2]*oe,de[3]=me[3]+ye[3]*oe,de[4]=me[4]+ye[4]*oe,de[5]=me[5]+ye[5]*oe,de[6]=me[6]+ye[6]*oe,de[7]=me[7]+ye[7]*oe,de[8]=me[8]+ye[8]*oe,de[9]=me[9]+ye[9]*oe,de[10]=me[10]+ye[10]*oe,de[11]=me[11]+ye[11]*oe,de[12]=me[12]+ye[12]*oe,de[13]=me[13]+ye[13]*oe,de[14]=me[14]+ye[14]*oe,de[15]=me[15]+ye[15]*oe,le},ue.strictEquals=function(le,ce){var _e=le.m,oe=ce.m;return _e[0]===oe[0]&&_e[1]===oe[1]&&_e[2]===oe[2]&&_e[3]===oe[3]&&_e[4]===oe[4]&&_e[5]===oe[5]&&_e[6]===oe[6]&&_e[7]===oe[7]&&_e[8]===oe[8]&&_e[9]===oe[9]&&_e[10]===oe[10]&&_e[11]===oe[11]&&_e[12]===oe[12]&&_e[13]===oe[13]&&_e[14]===oe[14]&&_e[15]===oe[15]},ue.equals=function(le,ce,_e){_e===void 0&&(_e=O.EPSILON);var oe=le.m,de=ce.m;return Math.abs(oe[0]-de[0])<=_e*Math.max(1,Math.abs(oe[0]),Math.abs(de[0]))&&Math.abs(oe[1]-de[1])<=_e*Math.max(1,Math.abs(oe[1]),Math.abs(de[1]))&&Math.abs(oe[2]-de[2])<=_e*Math.max(1,Math.abs(oe[2]),Math.abs(de[2]))&&Math.abs(oe[3]-de[3])<=_e*Math.max(1,Math.abs(oe[3]),Math.abs(de[3]))&&Math.abs(oe[4]-de[4])<=_e*Math.max(1,Math.abs(oe[4]),Math.abs(de[4]))&&Math.abs(oe[5]-de[5])<=_e*Math.max(1,Math.abs(oe[5]),Math.abs(de[5]))&&Math.abs(oe[6]-de[6])<=_e*Math.max(1,Math.abs(oe[6]),Math.abs(de[6]))&&Math.abs(oe[7]-de[7])<=_e*Math.max(1,Math.abs(oe[7]),Math.abs(de[7]))&&Math.abs(oe[8]-de[8])<=_e*Math.max(1,Math.abs(oe[8]),Math.abs(de[8]))&&Math.abs(oe[9]-de[9])<=_e*Math.max(1,Math.abs(oe[9]),Math.abs(de[9]))&&Math.abs(oe[10]-de[10])<=_e*Math.max(1,Math.abs(oe[10]),Math.abs(de[10]))&&Math.abs(oe[11]-de[11])<=_e*Math.max(1,Math.abs(oe[11]),Math.abs(de[11]))&&Math.abs(oe[12]-de[12])<=_e*Math.max(1,Math.abs(oe[12]),Math.abs(de[12]))&&Math.abs(oe[13]-de[13])<=_e*Math.max(1,Math.abs(oe[13]),Math.abs(de[13]))&&Math.abs(oe[14]-de[14])<=_e*Math.max(1,Math.abs(oe[14]),Math.abs(de[14]))&&Math.abs(oe[15]-de[15])<=_e*Math.max(1,Math.abs(oe[15]),Math.abs(de[15]))},ue.adjoint=function(le,ce){var _e=ce.m,oe=le.m,de=_e[0],me=_e[1],ye=_e[2],ge=_e[3],we=_e[4],Te=_e[5],Ee=_e[6],De=_e[7],fe=_e[8],Ce=_e[9],Se=_e[10],be=_e[11],Re=_e[12],Ve=_e[13],Pe=_e[14],ke=_e[15];return oe[0]=Te*(Se*ke-be*Pe)-Ce*(Ee*ke-De*Pe)+Ve*(Ee*be-De*Se),oe[1]=-(me*(Se*ke-be*Pe)-Ce*(ye*ke-ge*Pe)+Ve*(ye*be-ge*Se)),oe[2]=me*(Ee*ke-De*Pe)-Te*(ye*ke-ge*Pe)+Ve*(ye*De-ge*Ee),oe[3]=-(me*(Ee*be-De*Se)-Te*(ye*be-ge*Se)+Ce*(ye*De-ge*Ee)),oe[4]=-(we*(Se*ke-be*Pe)-fe*(Ee*ke-De*Pe)+Re*(Ee*be-De*Se)),oe[5]=de*(Se*ke-be*Pe)-fe*(ye*ke-ge*Pe)+Re*(ye*be-ge*Se),oe[6]=-(de*(Ee*ke-De*Pe)-we*(ye*ke-ge*Pe)+Re*(ye*De-ge*Ee)),oe[7]=de*(Ee*be-De*Se)-we*(ye*be-ge*Se)+fe*(ye*De-ge*Ee),oe[8]=we*(Ce*ke-be*Ve)-fe*(Te*ke-De*Ve)+Re*(Te*be-De*Ce),oe[9]=-(de*(Ce*ke-be*Ve)-fe*(me*ke-ge*Ve)+Re*(me*be-ge*Ce)),oe[10]=de*(Te*ke-De*Ve)-we*(me*ke-ge*Ve)+Re*(me*De-ge*Te),oe[11]=-(de*(Te*be-De*Ce)-we*(me*be-ge*Ce)+fe*(me*De-ge*Te)),oe[12]=-(we*(Ce*Pe-Se*Ve)-fe*(Te*Pe-Ee*Ve)+Re*(Te*Se-Ee*Ce)),oe[13]=de*(Ce*Pe-Se*Ve)-fe*(me*Pe-ye*Ve)+Re*(me*Se-ye*Ce),oe[14]=-(de*(Te*Pe-Ee*Ve)-we*(me*Pe-ye*Ve)+Re*(me*Ee-ye*Te)),oe[15]=de*(Te*Se-Ee*Ce)-we*(me*Se-ye*Ce)+fe*(me*Ee-ye*Te),le},ue.toArray=function(le,ce,_e){_e===void 0&&(_e=0);for(var oe=ce.m,de=0;de<16;de++)le[_e+de]=oe[de];return le},ue.fromArray=function(le,ce,_e){_e===void 0&&(_e=0);for(var oe=le.m,de=0;de<16;de++)oe[de]=ce[_e+de];return le},K.clone=function(){var le=this.m;return new ue(le[0],le[1],le[2],le[3],le[4],le[5],le[6],le[7],le[8],le[9],le[10],le[11],le[12],le[13],le[14],le[15])},K.set=function(le){var ce=this.m,_e=le.m;return ce[0]=_e[0],ce[1]=_e[1],ce[2]=_e[2],ce[3]=_e[3],ce[4]=_e[4],ce[5]=_e[5],ce[6]=_e[6],ce[7]=_e[7],ce[8]=_e[8],ce[9]=_e[9],ce[10]=_e[10],ce[11]=_e[11],ce[12]=_e[12],ce[13]=_e[13],ce[14]=_e[14],ce[15]=_e[15],this},K.equals=function(le){return ue.strictEquals(this,le)},K.fuzzyEquals=function(le){return ue.equals(this,le)},K.toString=function(){var le=this.m;return le?"[\n"+le[0]+", "+le[1]+", "+le[2]+", "+le[3]+",\n"+le[4]+", "+le[5]+", "+le[6]+", "+le[7]+",\n"+le[8]+", "+le[9]+", "+le[10]+", "+le[11]+",\n"+le[12]+", "+le[13]+", "+le[14]+", "+le[15]+"\n]":"[\n1, 0, 0, 0\n0, 1, 0, 0\n0, 0, 1, 0\n0, 0, 0, 1\n]"},K.identity=function(){return ue.identity(this)},K.transpose=function(le){return le=le||new ue,ue.transpose(le,this)},K.invert=function(le){return le=le||new ue,ue.invert(le,this)},K.adjoint=function(le){return le=le||new ue,ue.adjoint(le,this)},K.determinant=function(){return ue.determinant(this)},K.add=function(le,ce){return ce=ce||new ue,ue.add(ce,this,le)},K.subtract=function(le){return ue.subtract(this,this,le)},K.multiply=function(le){return ue.multiply(this,this,le)},K.multiplyScalar=function(le){return ue.multiplyScalar(this,this,le)},K.translate=function(le,ce){return ce=ce||new ue,ue.translate(ce,this,le)},K.scale=function(le,ce){return ce=ce||new ue,ue.scale(ce,this,le)},K.rotate=function(le,ce,_e){return _e=_e||new ue,ue.rotate(_e,this,le,ce)},K.getTranslation=function(le){return le=le||new B.default,ue.getTranslation(le,this)},K.getScale=function(le){return le=le||new B.default,ue.getScaling(le,this)},K.getRotation=function(le){return le=le||new A.default,ue.getRotation(le,this)},K.fromRTS=function(le,ce,_e){return ue.fromRTS(this,le,ce,_e)},K.fromQuat=function(le){return ue.fromQuat(this,le)},ue}(_.default);T.default=Q,Q.mul=Q.multiply,Q.sub=Q.subtract,Q.IDENTITY=Object.freeze(new Q);var ee=new B.default,te=new R.default;w.default.fastDefine("cc.Mat4",Q,{m00:1,m01:0,m02:0,m03:0,m04:0,m05:1,m06:0,m07:0,m08:0,m09:0,m10:1,m11:0,m12:0,m13:0,m14:0,m15:1});for(var re=function(ne){Object.defineProperty(Q.prototype,"m"+ne,{get:function(){return this.m[ne]},set:function(he){this.m[ne]=he}})},ie=0;ie<16;ie++)re(ie);cc.mat4=function(ne,he,pe,K,ue,le,ce,_e,oe,de,me,ye,ge,we,Te,Ee){var De=new Q(ne,he,pe,K,ue,le,ce,_e,oe,de,me,ye,ge,we,Te,Ee);return ne===void 0&&Q.identity(De),De},cc.Mat4=Q,S.exports=T.default},{"../platform/CCClass":196,"./mat3":287,"./quat":289,"./utils":293,"./value-type":294,"./vec3":296}],289:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=R(L("./value-type")),w=R(L("../platform/CCClass")),B=R(L("./vec3")),A=R(L("./mat3")),O=L("./utils");function R(H){return H&&H.__esModule?H:{default:H}}function P(H,U){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,Y){return X.__proto__=Y,X})(H,U)}var E=0,D=0,I=0,M=0,N=function(H){var U,X;X=H,(U=z).prototype=Object.create(X.prototype),U.prototype.constructor=U,P(U,X);var Y=z.prototype;function z(W,Z,Q,ee){var te;return W===void 0&&(W=0),Z===void 0&&(Z=0),Q===void 0&&(Q=0),ee===void 0&&(ee=1),(te=H.call(this)||this).x=void 0,te.y=void 0,te.z=void 0,te.w=void 0,W&&typeof W=="object"?(te.x=W.x,te.y=W.y,te.z=W.z,te.w=W.w):(te.x=W,te.y=Z,te.z=Q,te.w=ee),te}return Y.mul=function(W,Z){return z.multiply(Z||new z,this,W)},z.clone=function(W){return new z(W.x,W.y,W.z,W.w)},z.copy=function(W,Z){return W.x=Z.x,W.y=Z.y,W.z=Z.z,W.w=Z.w,W},z.set=function(W,Z,Q,ee,te){return W.x=Z,W.y=Q,W.z=ee,W.w=te,W},z.identity=function(W){return W.x=0,W.y=0,W.z=0,W.w=1,W},z.rotationTo=function(W,Z,Q){var ee=B.default.dot(Z,Q);return ee<-.999999?(B.default.cross(G,B.default.RIGHT,Z),G.mag()<1e-6&&B.default.cross(G,B.default.UP,Z),B.default.normalize(G,G),z.fromAxisAngle(W,G,Math.PI),W):ee>.999999?(W.x=0,W.y=0,W.z=0,W.w=1,W):(B.default.cross(G,Z,Q),W.x=G.x,W.y=G.y,W.z=G.z,W.w=1+ee,z.normalize(W,W))},z.getAxisAngle=function(W,Z){var Q=2*Math.acos(Z.w),ee=Math.sin(Q/2);return ee!==0?(W.x=Z.x/ee,W.y=Z.y/ee,W.z=Z.z/ee):(W.x=1,W.y=0,W.z=0),Q},z.multiply=function(W,Z,Q){return E=Z.x*Q.w+Z.w*Q.x+Z.y*Q.z-Z.z*Q.y,D=Z.y*Q.w+Z.w*Q.y+Z.z*Q.x-Z.x*Q.z,I=Z.z*Q.w+Z.w*Q.z+Z.x*Q.y-Z.y*Q.x,M=Z.w*Q.w-Z.x*Q.x-Z.y*Q.y-Z.z*Q.z,W.x=E,W.y=D,W.z=I,W.w=M,W},z.multiplyScalar=function(W,Z,Q){return W.x=Z.x*Q,W.y=Z.y*Q,W.z=Z.z*Q,W.w=Z.w*Q,W},z.scaleAndAdd=function(W,Z,Q,ee){return W.x=Z.x+Q.x*ee,W.y=Z.y+Q.y*ee,W.z=Z.z+Q.z*ee,W.w=Z.w+Q.w*ee,W},z.rotateX=function(W,Z,Q){Q*=.5;var ee=Math.sin(Q),te=Math.cos(Q);return E=Z.x*te+Z.w*ee,D=Z.y*te+Z.z*ee,I=Z.z*te-Z.y*ee,M=Z.w*te-Z.x*ee,W.x=E,W.y=D,W.z=I,W.w=M,W},z.rotateY=function(W,Z,Q){Q*=.5;var ee=Math.sin(Q),te=Math.cos(Q);return E=Z.x*te-Z.z*ee,D=Z.y*te+Z.w*ee,I=Z.z*te+Z.x*ee,M=Z.w*te-Z.y*ee,W.x=E,W.y=D,W.z=I,W.w=M,W},z.rotateZ=function(W,Z,Q){Q*=.5;var ee=Math.sin(Q),te=Math.cos(Q);return E=Z.x*te+Z.y*ee,D=Z.y*te-Z.x*ee,I=Z.z*te+Z.w*ee,M=Z.w*te-Z.z*ee,W.x=E,W.y=D,W.z=I,W.w=M,W},z.rotateAround=function(W,Z,Q,ee){return z.invert(k,Z),B.default.transformQuat(G,Q,k),z.fromAxisAngle(k,G,ee),z.multiply(W,Z,k),W},z.rotateAroundLocal=function(W,Z,Q,ee){return z.fromAxisAngle(k,Q,ee),z.multiply(W,Z,k),W},z.calculateW=function(W,Z){return W.x=Z.x,W.y=Z.y,W.z=Z.z,W.w=Math.sqrt(Math.abs(1-Z.x*Z.x-Z.y*Z.y-Z.z*Z.z)),W},z.dot=function(W,Z){return W.x*Z.x+W.y*Z.y+W.z*Z.z+W.w*Z.w},z.lerp=function(W,Z,Q,ee){return W.x=Z.x+ee*(Q.x-Z.x),W.y=Z.y+ee*(Q.y-Z.y),W.z=Z.z+ee*(Q.z-Z.z),W.w=Z.w+ee*(Q.w-Z.w),W},z.slerp=function(W,Z,Q,ee){var te=0,re=0,ie=Z.x*Q.x+Z.y*Q.y+Z.z*Q.z+Z.w*Q.w;if(ie<0&&(ie=-ie,Q.x=-Q.x,Q.y=-Q.y,Q.z=-Q.z,Q.w=-Q.w),1-ie>1e-6){var ne=Math.acos(ie),he=Math.sin(ne);te=Math.sin((1-ee)*ne)/he,re=Math.sin(ee*ne)/he}else te=1-ee,re=ee;return W.x=te*Z.x+re*Q.x,W.y=te*Z.y+re*Q.y,W.z=te*Z.z+re*Q.z,W.w=te*Z.w+re*Q.w,W},z.sqlerp=function(W,Z,Q,ee,te,re){return z.slerp(k,Z,te,re),z.slerp(F,Q,ee,re),z.slerp(W,k,F,2*re*(1-re)),W},z.invert=function(W,Z){var Q=Z.x*Z.x+Z.y*Z.y+Z.z*Z.z+Z.w*Z.w,ee=Q?1/Q:0;return W.x=-Z.x*ee,W.y=-Z.y*ee,W.z=-Z.z*ee,W.w=Z.w*ee,W},z.conjugate=function(W,Z){return W.x=-Z.x,W.y=-Z.y,W.z=-Z.z,W.w=Z.w,W},z.len=function(W){return Math.sqrt(W.x*W.x+W.y*W.y+W.z*W.z+W.w*W.w)},z.lengthSqr=function(W){return W.x*W.x+W.y*W.y+W.z*W.z+W.w*W.w},z.normalize=function(W,Z){var Q=Z.x*Z.x+Z.y*Z.y+Z.z*Z.z+Z.w*Z.w;return Q>0&&(Q=1/Math.sqrt(Q),W.x=Z.x*Q,W.y=Z.y*Q,W.z=Z.z*Q,W.w=Z.w*Q),W},z.fromAxes=function(W,Z,Q,ee){return A.default.set(V,Z.x,Z.y,Z.z,Q.x,Q.y,Q.z,ee.x,ee.y,ee.z),z.normalize(W,z.fromMat3(W,V))},z.fromViewUp=function(W,Z,Q){return A.default.fromViewUp(V,Z,Q),z.normalize(W,z.fromMat3(W,V))},z.fromAxisAngle=function(W,Z,Q){Q*=.5;var ee=Math.sin(Q);return W.x=ee*Z.x,W.y=ee*Z.y,W.z=ee*Z.z,W.w=Math.cos(Q),W},z.fromAngleZ=function(W,Z){return Z*=j,W.x=W.y=0,W.z=Math.sin(Z),W.w=Math.cos(Z),W},z.fromMat3=function(W,Z){var Q=Z.m,ee=Q[0],te=Q[1],re=Q[2],ie=Q[3],ne=Q[4],he=Q[5],pe=Q[6],K=Q[7],ue=Q[8],le=ee+ne+ue;if(le>0){var ce=.5/Math.sqrt(le+1);W.w=.25/ce,W.x=(he-K)*ce,W.y=(pe-re)*ce,W.z=(te-ie)*ce}else if(ee>ne&&ee>ue){var _e=2*Math.sqrt(1+ee-ne-ue);W.w=(he-K)/_e,W.x=.25*_e,W.y=(ie+te)/_e,W.z=(pe+re)/_e}else if(ne>ue){var oe=2*Math.sqrt(1+ne-ee-ue);W.w=(pe-re)/oe,W.x=(ie+te)/oe,W.y=.25*oe,W.z=(K+he)/oe}else{var de=2*Math.sqrt(1+ue-ee-ne);W.w=(te-ie)/de,W.x=(pe+re)/de,W.y=(K+he)/de,W.z=.25*de}return W},z.fromEuler=function(W,Z,Q,ee){Z*=j,Q*=j,ee*=j;var te=Math.sin(Z),re=Math.cos(Z),ie=Math.sin(Q),ne=Math.cos(Q),he=Math.sin(ee),pe=Math.cos(ee);return W.x=te*ne*pe+re*ie*he,W.y=re*ie*pe+te*ne*he,W.z=re*ne*he-te*ie*pe,W.w=re*ne*pe-te*ie*he,W},z.toAxisX=function(W,Z){var Q=2*Z.y,ee=2*Z.z;return W.x=1-Q*Z.y-ee*Z.z,W.y=Q*Z.x+ee*Z.w,W.z=ee*Z.x+Q*Z.w,W},z.toAxisY=function(W,Z){var Q=2*Z.x,ee=2*Z.y,te=2*Z.z;return W.x=ee*Z.x-te*Z.w,W.y=1-Q*Z.x-te*Z.z,W.z=te*Z.y+Q*Z.w,W},z.toAxisZ=function(W,Z){var Q=2*Z.x,ee=2*Z.y,te=2*Z.z;return W.x=te*Z.x-ee*Z.w,W.y=te*Z.y-Q*Z.w,W.z=1-Q*Z.x-ee*Z.y,W},z.toEuler=function(W,Z,Q){var ee=Z.x,te=Z.y,re=Z.z,ie=Z.w,ne=0,he=0,pe=0,K=ee*te+re*ie;if(K>.499999)ne=0,he=(0,O.toDegree)(2*Math.atan2(ee,ie)),pe=90;else if(K<-.499999)ne=0,he=-(0,O.toDegree)(2*Math.atan2(ee,ie)),pe=-90;else{var ue=ee*ee,le=te*te,ce=re*re;ne=(0,O.toDegree)(Math.atan2(2*ee*ie-2*te*re,1-2*ue-2*ce)),he=(0,O.toDegree)(Math.atan2(2*te*ie-2*ee*re,1-2*le-2*ce)),pe=(0,O.toDegree)(Math.asin(2*K)),Q&&(ne=-180*Math.sign(ne+1e-6)+ne,he=-180*Math.sign(he+1e-6)+he,pe=180*Math.sign(pe+1e-6)-pe)}return W.x=ne,W.y=he,W.z=pe,W},z.strictEquals=function(W,Z){return W.x===Z.x&&W.y===Z.y&&W.z===Z.z&&W.w===Z.w},z.equals=function(W,Z,Q){return Q===void 0&&(Q=O.EPSILON),Math.abs(W.x-Z.x)<=Q*Math.max(1,Math.abs(W.x),Math.abs(Z.x))&&Math.abs(W.y-Z.y)<=Q*Math.max(1,Math.abs(W.y),Math.abs(Z.y))&&Math.abs(W.z-Z.z)<=Q*Math.max(1,Math.abs(W.z),Math.abs(Z.z))&&Math.abs(W.w-Z.w)<=Q*Math.max(1,Math.abs(W.w),Math.abs(Z.w))},z.toArray=function(W,Z,Q){return Q===void 0&&(Q=0),W[Q+0]=Z.x,W[Q+1]=Z.y,W[Q+2]=Z.z,W[Q+3]=Z.w,W},z.fromArray=function(W,Z,Q){return Q===void 0&&(Q=0),W.x=Z[Q+0],W.y=Z[Q+1],W.z=Z[Q+2],W.w=Z[Q+3],W},Y.clone=function(){return new z(this.x,this.y,this.z,this.w)},Y.set=function(W){return this.x=W.x,this.y=W.y,this.z=W.z,this.w=W.w,this},Y.equals=function(W){return W&&this.x===W.x&&this.y===W.y&&this.z===W.z&&this.w===W.w},Y.toEuler=function(W){return z.toEuler(W,this)},Y.fromEuler=function(W){return z.fromEuler(this,W.x,W.y,W.z)},Y.lerp=function(W,Z,Q){return Q=Q||new z,z.slerp(Q,this,W,Z),Q},Y.multiply=function(W){return z.multiply(this,this,W)},Y.rotateAround=function(W,Z,Q,ee){return ee=ee||new z,z.rotateAround(ee,W,Z,Q)},z}(_.default);T.default=N,N.mul=N.multiply,N.scale=N.multiplyScalar,N.mag=N.len,N.IDENTITY=Object.freeze(new N);var k=new N,F=new N,G=new B.default,V=new A.default,j=.5*Math.PI/180;w.default.fastDefine("cc.Quat",N,{x:0,y:0,z:0,w:1}),cc.quat=function(H,U,X,Y){return new N(H,U,X,Y)},cc.Quat=N,S.exports=T.default},{"../platform/CCClass":196,"./mat3":287,"./utils":293,"./value-type":294,"./vec3":296}],290:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=O(L("./value-type")),w=O(L("../platform/CCClass")),B=O(L("./vec2")),A=O(L("./size"));function O(D){return D&&D.__esModule?D:{default:D}}function R(D,I){for(var M=0;M<I.length;M++){var N=I[M];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(D,N.key,N)}}function P(D,I){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,N){return M.__proto__=N,M})(D,I)}var E=function(D){var I,M;function N(V,j,H,U){var X;return V===void 0&&(V=0),j===void 0&&(j=0),H===void 0&&(H=0),U===void 0&&(U=0),(X=D.call(this)||this).x=void 0,X.y=void 0,X.width=void 0,X.height=void 0,V&&typeof V=="object"&&(j=V.y,H=V.width,U=V.height,V=V.x),X.x=V||0,X.y=j||0,X.width=H||0,X.height=U||0,X}M=D,(I=N).prototype=Object.create(M.prototype),I.prototype.constructor=I,P(I,M),N.fromMinMax=function(V,j){var H=Math.min(V.x,j.x),U=Math.min(V.y,j.y);return new N(H,U,Math.max(V.x,j.x)-H,Math.max(V.y,j.y)-U)};var k,F,G=N.prototype;return G.clone=function(){return new N(this.x,this.y,this.width,this.height)},G.equals=function(V){return V&&this.x===V.x&&this.y===V.y&&this.width===V.width&&this.height===V.height},G.lerp=function(V,j,H){H=H||new N;var U=this.x,X=this.y,Y=this.width,z=this.height;return H.x=U+(V.x-U)*j,H.y=X+(V.y-X)*j,H.width=Y+(V.width-Y)*j,H.height=z+(V.height-z)*j,H},G.set=function(V){return this.x=V.x,this.y=V.y,this.width=V.width,this.height=V.height,this},G.intersects=function(V){var j=this.x+this.width,H=this.y+this.height,U=V.x+V.width,X=V.y+V.height;return!(j<V.x||U<this.x||H<V.y||X<this.y)},G.intersection=function(V,j){var H=this.x,U=this.y,X=this.x+this.width,Y=this.y+this.height,z=j.x,W=j.y,Z=j.x+j.width,Q=j.y+j.height;return V.x=Math.max(H,z),V.y=Math.max(U,W),V.width=Math.min(X,Z)-V.x,V.height=Math.min(Y,Q)-V.y,V},G.contains=function(V){return this.x<=V.x&&this.x+this.width>=V.x&&this.y<=V.y&&this.y+this.height>=V.y},G.containsRect=function(V){return this.x<=V.x&&this.x+this.width>=V.x+V.width&&this.y<=V.y&&this.y+this.height>=V.y+V.height},G.union=function(V,j){var H=this.x,U=this.y,X=this.width,Y=this.height,z=j.x,W=j.y,Z=j.width,Q=j.height;return V.x=Math.min(H,z),V.y=Math.min(U,W),V.width=Math.max(H+X,z+Z)-V.x,V.height=Math.max(U+Y,W+Q)-V.y,V},G.transformMat4=function(V,j){var H=this.x,U=this.y,X=H+this.width,Y=U+this.height,z=j.m,W=z[0]*H+z[4]*U+z[12],Z=z[1]*H+z[5]*U+z[13],Q=z[0]*X+z[4]*U+z[12],ee=z[1]*X+z[5]*U+z[13],te=z[0]*H+z[4]*Y+z[12],re=z[1]*H+z[5]*Y+z[13],ie=z[0]*X+z[4]*Y+z[12],ne=z[1]*X+z[5]*Y+z[13],he=Math.min(W,Q,te,ie),pe=Math.max(W,Q,te,ie),K=Math.min(Z,ee,re,ne),ue=Math.max(Z,ee,re,ne);return V.x=he,V.y=K,V.width=pe-he,V.height=ue-K,V},G.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},k=N,(F=[{key:"xMin",get:function(){return this.x},set:function(V){this.width+=this.x-V,this.x=V}},{key:"yMin",get:function(){return this.y},set:function(V){this.height+=this.y-V,this.y=V}},{key:"xMax",get:function(){return this.x+this.width},set:function(V){this.width=V-this.x}},{key:"yMax",get:function(){return this.y+this.height},set:function(V){this.height=V-this.y}},{key:"center",get:function(){return new B.default(this.x+.5*this.width,this.y+.5*this.height)},set:function(V){this.x=V.x-.5*this.width,this.y=V.y-.5*this.height}},{key:"origin",get:function(){return new B.default(this.x,this.y)},set:function(V){this.x=V.x,this.y=V.y}},{key:"size",get:function(){return new A.default(this.width,this.height)},set:function(V){this.width=V.width,this.height=V.height}}])&&R(k.prototype,F),Object.defineProperty(k,"prototype",{writable:!1}),N}(_.default);T.default=E,w.default.fastDefine("cc.Rect",E,{x:0,y:0,width:0,height:0}),cc.Rect=E,cc.rect=function(D,I,M,N){return new E(D,I,M,N)},S.exports=T.default},{"../platform/CCClass":196,"./size":291,"./value-type":294,"./vec2":295}],291:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=B(L("./value-type")),w=B(L("../platform/CCClass"));function B(P){return P&&P.__esModule?P:{default:P}}function A(P,E){for(var D=0;D<E.length;D++){var I=E[D];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(P,I.key,I)}}function O(P,E){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,I){return D.__proto__=I,D})(P,E)}var R=function(P){var E,D;function I(F,G){var V;return F===void 0&&(F=0),G===void 0&&(G=0),(V=P.call(this)||this).width=void 0,V.height=void 0,F&&typeof F=="object"?(V.width=F.width,V.height=F.height):(V.width=F||0,V.height=G||0),V}D=P,(E=I).prototype=Object.create(D.prototype),E.prototype.constructor=E,O(E,D);var M,N,k=I.prototype;return k.clone=function(){return new I(this.width,this.height)},k.equals=function(F){return F&&this.width===F.width&&this.height===F.height},k.lerp=function(F,G,V){V=V||new I;var j=this.width,H=this.height;return V.width=j+(F.width-j)*G,V.height=H+(F.height-H)*G,V},k.set=function(F){return this.width=F.width,this.height=F.height,this},k.toString=function(){return"("+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},M=I,N=[{key:"ZERO",get:function(){return new I}}],N&&A(M,N),Object.defineProperty(M,"prototype",{writable:!1}),I}(_.default);T.default=R,R.ZERO_R=R.ZERO,w.default.fastDefine("cc.Size",R,{width:0,height:0}),cc.size=function(P,E){return new R(P,E)},cc.Size=R,S.exports=T.default},{"../platform/CCClass":196,"./value-type":294}],292:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("./quat"))&&_.__esModule?_:{default:_},B=new w.default,A=function(){function O(){}return O.toRotation=function(R,P){return R.x=P[3],R.y=P[4],R.z=P[5],R.w=P[6],R},O.fromRotation=function(R,P){return R[3]=P.x,R[4]=P.y,R[5]=P.z,R[6]=P.w,R},O.toEuler=function(R,P){return O.toRotation(B,P),w.default.toEuler(R,B),R},O.fromEuler=function(R,P){return w.default.fromEuler(B,P.x,P.y,P.z),O.fromRotation(R,B),R},O.fromEulerNumber=function(R,P,E,D){return w.default.fromEuler(B,P,E,D),O.fromRotation(R,B),R},O.toScale=function(R,P){return R.x=P[7],R.y=P[8],R.z=P[9],R},O.fromScale=function(R,P){return R[7]=P.x,R[8]=P.y,R[9]=P.z,R},O.toPosition=function(R,P){return R.x=P[0],R.y=P[1],R.z=P[2],R},O.fromPosition=function(R,P){return R[0]=P.x,R[1]=P.y,R[2]=P.z,R},O.fromAngleZ=function(R,P){return w.default.fromAngleZ(B,P),O.fromRotation(R,B),R},O.toMat4=function(R,P){var E=P[3],D=P[4],I=P[5],M=P[6],N=E+E,k=D+D,F=I+I,G=E*N,V=E*k,j=E*F,H=D*k,U=D*F,X=I*F,Y=M*N,z=M*k,W=M*F,Z=P[7],Q=P[8],ee=P[9],te=R.m;return te[0]=(1-(H+X))*Z,te[1]=(V+W)*Z,te[2]=(j-z)*Z,te[3]=0,te[4]=(V-W)*Q,te[5]=(1-(G+X))*Q,te[6]=(U+Y)*Q,te[7]=0,te[8]=(j+z)*ee,te[9]=(U-Y)*ee,te[10]=(1-(G+H))*ee,te[11]=0,te[12]=P[0],te[13]=P[1],te[14]=P[2],te[15]=1,R},O}();T.default=A,cc.Trs=A,S.exports=T.default},{"./quat":289}],293:[function(L,S,T){T.__esModule=!0,T.INT_MIN=T.INT_MAX=T.INT_BITS=T.FLOAT_BYTES=T.FLOAT_ARRAY_TYPE=T.EPSILON=void 0,T.approx=function(I,M,N){return N=N||B,Math.abs(I-M)<=N},T.clamp=function(I,M,N){return I<M?M:I>N?N:I},T.clamp01=function(I){return I<0?0:I>1?1:I},T.equals=function(I,M){return Math.abs(I-M)<=B*Math.max(1,Math.abs(I),Math.abs(M))},T.inverseLerp=function(I,M,N){return(N-I)/(M-I)},T.lerp=function(I,M,N){return I+(M-I)*N},T.nextPow2=function(I){return--I,I|=I>>1,I|=I>>2,I|=I>>4,I|=I>>8,I|=I>>16,++I},T.pingPong=function(I,M){return I=D(I,2*M),M-Math.abs(I-M)},T.pseudoRandom=P,T.pseudoRandomRange=E,T.pseudoRandomRangeInt=function(I,M,N){return Math.floor(E(I,M,N))},T.random=void 0,T.randomRange=R,T.randomRangeInt=function(I,M){return Math.floor(R(I,M))},T.repeat=D,T.sign=function(I){return(I>0)-(I<0)},T.toDegree=function(I){return I*w},T.toRadian=function(I){return I*_};var _=Math.PI/180,w=180/Math.PI,B=1e-6;T.EPSILON=B,T.INT_BITS=32,T.INT_MAX=2147483647,T.INT_MIN=-1<<31;var A=Float64Array;T.FLOAT_ARRAY_TYPE=A,T.FLOAT_BYTES=8;var O=Math.random;function R(I,M){return Math.random()*(M-I)+I}function P(I){return(I=(9301*I+49297)%233280)/233280}function E(I,M,N){return P(I)*(N-M)+M}function D(I,M){return I-Math.floor(I/M)*M}T.random=O},{}],294:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../platform/js"))&&_.__esModule?_:{default:_},B=function(){function A(){}var O=A.prototype;return O.clone=function(){return cc.errorID("0100",w.default.getClassName(this)+".clone"),null},O.equals=function(){return cc.errorID("0100",w.default.getClassName(this)+".equals"),!1},O.lerp=function(){return cc.errorID("0100",w.default.getClassName(this)+".lerp"),this.clone()},O.set=function(){cc.errorID("0100",w.default.getClassName(this)+".set")},O.toString=function(){return"[object Object]"},A}();T.default=B,w.default.setClassName("cc.ValueType",B),cc.ValueType=B,S.exports=T.default},{"../platform/js":217}],295:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=O(L("./value-type")),w=O(L("../platform/CCClass")),B=O(L("../utils/misc")),A=L("./utils");function O(k){return k&&k.__esModule?k:{default:k}}function R(k,F){for(var G=0;G<F.length;G++){var V=F[G];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(k,V.key,V)}}function P(k,F){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(G,V){return G.__proto__=V,G})(k,F)}var E=0,D=0,I=function(k){var F,G;G=k,(F=U).prototype=Object.create(G.prototype),F.prototype.constructor=F,P(F,G);var V,j,H=U.prototype;function U(X,Y){var z;return X===void 0&&(X=0),Y===void 0&&(Y=0),(z=k.call(this)||this).mag=U.prototype.len,z.magSqr=U.prototype.lengthSqr,z.subSelf=U.prototype.subtract,z.mulSelf=U.prototype.multiplyScalar,z.divSelf=U.prototype.divide,z.scaleSelf=U.prototype.multiply,z.negSelf=U.prototype.negate,z.x=void 0,z.y=void 0,z.z=0,X&&typeof X=="object"?(z.x=X.x||0,z.y=X.y||0):(z.x=X||0,z.y=Y||0),z}return H.sub=function(X,Y){return U.subtract(Y||new U,this,X)},H.mul=function(X,Y){return U.multiplyScalar(Y||new U,this,X)},H.div=function(X,Y){return U.multiplyScalar(Y||new U,this,1/X)},H.scale=function(X,Y){return U.multiply(Y||new U,this,X)},H.neg=function(X){return U.negate(X||new U,this)},U.clone=function(X){return new U(X.x,X.y)},U.copy=function(X,Y){return X.x=Y.x,X.y=Y.y,X},U.set=function(X,Y,z){return X.x=Y,X.y=z,X},U.add=function(X,Y,z){return X.x=Y.x+z.x,X.y=Y.y+z.y,X},U.subtract=function(X,Y,z){return X.x=Y.x-z.x,X.y=Y.y-z.y,X},U.multiply=function(X,Y,z){return X.x=Y.x*z.x,X.y=Y.y*z.y,X},U.divide=function(X,Y,z){return X.x=Y.x/z.x,X.y=Y.y/z.y,X},U.ceil=function(X,Y){return X.x=Math.ceil(Y.x),X.y=Math.ceil(Y.y),X},U.floor=function(X,Y){return X.x=Math.floor(Y.x),X.y=Math.floor(Y.y),X},U.min=function(X,Y,z){return X.x=Math.min(Y.x,z.x),X.y=Math.min(Y.y,z.y),X},U.max=function(X,Y,z){return X.x=Math.max(Y.x,z.x),X.y=Math.max(Y.y,z.y),X},U.round=function(X,Y){return X.x=Math.round(Y.x),X.y=Math.round(Y.y),X},U.multiplyScalar=function(X,Y,z){return X.x=Y.x*z,X.y=Y.y*z,X},U.scaleAndAdd=function(X,Y,z,W){return X.x=Y.x+z.x*W,X.y=Y.y+z.y*W,X},U.distance=function(X,Y){return E=Y.x-X.x,D=Y.y-X.y,Math.sqrt(E*E+D*D)},U.squaredDistance=function(X,Y){return E=Y.x-X.x,D=Y.y-X.y,E*E+D*D},U.len=function(X){return E=X.x,D=X.y,Math.sqrt(E*E+D*D)},U.lengthSqr=function(X){return E=X.x,D=X.y,E*E+D*D},U.negate=function(X,Y){return X.x=-Y.x,X.y=-Y.y,X},U.inverse=function(X,Y){return X.x=1/Y.x,X.y=1/Y.y,X},U.inverseSafe=function(X,Y){return E=Y.x,D=Y.y,Math.abs(E)<A.EPSILON?X.x=0:X.x=1/E,Math.abs(D)<A.EPSILON?X.y=0:X.y=1/D,X},U.normalize=function(X,Y){E=Y.x,D=Y.y;var z=E*E+D*D;return z>0&&(z=1/Math.sqrt(z),X.x=E*z,X.y=D*z),X},U.dot=function(X,Y){return X.x*Y.x+X.y*Y.y},U.cross=function(X,Y,z){return X.x=X.y=0,X.z=Y.x*z.y-Y.y*z.x,X},U.lerp=function(X,Y,z,W){return E=Y.x,D=Y.y,X.x=E+W*(z.x-E),X.y=D+W*(z.y-D),X},U.random=function(X,Y){Y=Y||1;var z=2*(0,A.random)()*Math.PI;return X.x=Math.cos(z)*Y,X.y=Math.sin(z)*Y,X},U.transformMat3=function(X,Y,z){E=Y.x,D=Y.y;var W=z.m;return X.x=W[0]*E+W[3]*D+W[6],X.y=W[1]*E+W[4]*D+W[7],X},U.transformMat4=function(X,Y,z){E=Y.x,D=Y.y;var W=z.m;return X.x=W[0]*E+W[4]*D+W[12],X.y=W[1]*E+W[5]*D+W[13],X},U.strictEquals=function(X,Y){return X.x===Y.x&&X.y===Y.y},U.equals=function(X,Y,z){return z===void 0&&(z=A.EPSILON),Math.abs(X.x-Y.x)<=z*Math.max(1,Math.abs(X.x),Math.abs(Y.x))&&Math.abs(X.y-Y.y)<=z*Math.max(1,Math.abs(X.y),Math.abs(Y.y))},U.angle=function(X,Y){U.normalize(M,X),U.normalize(N,Y);var z=U.dot(M,N);return z>1?0:z<-1?Math.PI:Math.acos(z)},U.toArray=function(X,Y,z){return z===void 0&&(z=0),X[z+0]=Y.x,X[z+1]=Y.y,X},U.fromArray=function(X,Y,z){return z===void 0&&(z=0),X.x=Y[z+0],X.y=Y[z+1],X},H.clone=function(){return new U(this.x,this.y)},H.set=function(X){return this.x=X.x,this.y=X.y,this},H.equals=function(X){return X&&this.x===X.x&&this.y===X.y},H.fuzzyEquals=function(X,Y){return this.x-Y<=X.x&&X.x<=this.x+Y&&this.y-Y<=X.y&&X.y<=this.y+Y},H.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},H.lerp=function(X,Y,z){z=z||new U;var W=this.x,Z=this.y;return z.x=W+(X.x-W)*Y,z.y=Z+(X.y-Z)*Y,z},H.clampf=function(X,Y){return this.x=B.default.clampf(this.x,X.x,Y.x),this.y=B.default.clampf(this.y,X.y,Y.y),this},H.add=function(X,Y){return(Y=Y||new U).x=this.x+X.x,Y.y=this.y+X.y,Y},H.addSelf=function(X){return this.x+=X.x,this.y+=X.y,this},H.subtract=function(X){return this.x-=X.x,this.y-=X.y,this},H.multiplyScalar=function(X){return this.x*=X,this.y*=X,this},H.multiply=function(X){return this.x*=X.x,this.y*=X.y,this},H.divide=function(X){return this.x/=X,this.y/=X,this},H.negate=function(){return this.x=-this.x,this.y=-this.y,this},H.dot=function(X){return this.x*X.x+this.y*X.y},H.cross=function(X){return this.x*X.y-this.y*X.x},H.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},H.lengthSqr=function(){return this.x*this.x+this.y*this.y},H.normalizeSelf=function(){var X=this.x*this.x+this.y*this.y;if(X===1)return this;if(X===0)return this;var Y=1/Math.sqrt(X);return this.x*=Y,this.y*=Y,this},H.normalize=function(X){return(X=X||new U).x=this.x,X.y=this.y,X.normalizeSelf(),X},H.angle=function(X){var Y=this.magSqr(),z=X.magSqr();if(Y===0||z===0)return console.warn("Can't get angle between zero vector"),0;var W=this.dot(X)/Math.sqrt(Y*z);return W=B.default.clampf(W,-1,1),Math.acos(W)},H.signAngle=function(X){var Y=this.angle(X);return this.cross(X)<0?-Y:Y},H.rotate=function(X,Y){return(Y=Y||new U).x=this.x,Y.y=this.y,Y.rotateSelf(X)},H.rotateSelf=function(X){var Y=Math.sin(X),z=Math.cos(X),W=this.x;return this.x=z*W-Y*this.y,this.y=Y*W+z*this.y,this},H.project=function(X){return X.multiplyScalar(this.dot(X)/X.dot(X))},H.transformMat4=function(X,Y){return Y=Y||new U,U.transformMat4(Y,this,X),Y},H.maxAxis=function(){return Math.max(this.x,this.y)},V=U,j=[{key:"ONE",get:function(){return new U(1,1)}},{key:"ZERO",get:function(){return new U(0,0)}},{key:"UP",get:function(){return new U(0,1)}},{key:"RIGHT",get:function(){return new U(1,0)}}],j&&R(V,j),Object.defineProperty(V,"prototype",{writable:!1}),U}(_.default);T.default=I,I.sub=I.subtract,I.mul=I.multiply,I.scale=I.multiplyScalar,I.mag=I.len,I.squaredMagnitude=I.lengthSqr,I.div=I.divide,I.ONE_R=I.ONE,I.ZERO_R=I.ZERO,I.UP_R=I.UP,I.RIGHT_R=I.RIGHT;var M=new I,N=new I;w.default.fastDefine("cc.Vec2",I,{x:0,y:0}),cc.v2=function(k,F){return new I(k,F)},cc.Vec2=I,S.exports=T.default},{"../platform/CCClass":196,"../utils/misc":271,"./utils":293,"./value-type":294}],296:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=R(L("./value-type")),w=R(L("../platform/CCClass")),B=R(L("../utils/misc")),A=R(L("./vec2")),O=L("./utils");function R(G){return G&&G.__esModule?G:{default:G}}function P(G,V){for(var j=0;j<V.length;j++){var H=V[j];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(G,H.key,H)}}function E(G,V){return(E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,H){return j.__proto__=H,j})(G,V)}var D=0,I=0,M=0,N=function(G){var V,j;j=G,(V=Y).prototype=Object.create(j.prototype),V.prototype.constructor=V,E(V,j);var H,U,X=Y.prototype;function Y(z,W,Z){var Q;return z===void 0&&(z=0),W===void 0&&(W=0),Z===void 0&&(Z=0),(Q=G.call(this)||this).mag=Y.prototype.len,Q.magSqr=Y.prototype.lengthSqr,Q.subSelf=Y.prototype.subtract,Q.mulSelf=Y.prototype.multiplyScalar,Q.divSelf=Y.prototype.divide,Q.scaleSelf=Y.prototype.multiply,Q.negSelf=Y.prototype.negate,Q.x=void 0,Q.y=void 0,Q.z=void 0,Q.angle=A.default.prototype.angle,Q.project=A.default.prototype.project,z&&typeof z=="object"?(Q.x=z.x,Q.y=z.y,Q.z=z.z):(Q.x=z,Q.y=W,Q.z=Z),Q}return X.sub=function(z,W){return Y.subtract(W||new Y,this,z)},X.mul=function(z,W){return Y.multiplyScalar(W||new Y,this,z)},X.div=function(z,W){return Y.multiplyScalar(W||new Y,this,1/z)},X.scale=function(z,W){return Y.multiply(W||new Y,this,z)},X.neg=function(z){return Y.negate(z||new Y,this)},Y.zero=function(z){return z.x=0,z.y=0,z.z=0,z},Y.clone=function(z){return new Y(z.x,z.y,z.z)},Y.copy=function(z,W){return z.x=W.x,z.y=W.y,z.z=W.z,z},Y.set=function(z,W,Z,Q){return z.x=W,z.y=Z,z.z=Q,z},Y.add=function(z,W,Z){return z.x=W.x+Z.x,z.y=W.y+Z.y,z.z=W.z+Z.z,z},Y.subtract=function(z,W,Z){return z.x=W.x-Z.x,z.y=W.y-Z.y,z.z=W.z-Z.z,z},Y.multiply=function(z,W,Z){return z.x=W.x*Z.x,z.y=W.y*Z.y,z.z=W.z*Z.z,z},Y.divide=function(z,W,Z){return z.x=W.x/Z.x,z.y=W.y/Z.y,z.z=W.z/Z.z,z},Y.ceil=function(z,W){return z.x=Math.ceil(W.x),z.y=Math.ceil(W.y),z.z=Math.ceil(W.z),z},Y.floor=function(z,W){return z.x=Math.floor(W.x),z.y=Math.floor(W.y),z.z=Math.floor(W.z),z},Y.min=function(z,W,Z){return z.x=Math.min(W.x,Z.x),z.y=Math.min(W.y,Z.y),z.z=Math.min(W.z,Z.z),z},Y.max=function(z,W,Z){return z.x=Math.max(W.x,Z.x),z.y=Math.max(W.y,Z.y),z.z=Math.max(W.z,Z.z),z},Y.round=function(z,W){return z.x=Math.round(W.x),z.y=Math.round(W.y),z.z=Math.round(W.z),z},Y.multiplyScalar=function(z,W,Z){return z.x=W.x*Z,z.y=W.y*Z,z.z=W.z*Z,z},Y.scaleAndAdd=function(z,W,Z,Q){return z.x=W.x+Z.x*Q,z.y=W.y+Z.y*Q,z.z=W.z+Z.z*Q,z},Y.distance=function(z,W){return D=W.x-z.x,I=W.y-z.y,M=W.z-z.z,Math.sqrt(D*D+I*I+M*M)},Y.squaredDistance=function(z,W){return D=W.x-z.x,I=W.y-z.y,M=W.z-z.z,D*D+I*I+M*M},Y.len=function(z){return D=z.x,I=z.y,M=z.z,Math.sqrt(D*D+I*I+M*M)},Y.lengthSqr=function(z){return D=z.x,I=z.y,M=z.z,D*D+I*I+M*M},Y.negate=function(z,W){return z.x=-W.x,z.y=-W.y,z.z=-W.z,z},Y.inverse=function(z,W){return z.x=1/W.x,z.y=1/W.y,z.z=1/W.z,z},Y.inverseSafe=function(z,W){return D=W.x,I=W.y,M=W.z,Math.abs(D)<O.EPSILON?z.x=0:z.x=1/D,Math.abs(I)<O.EPSILON?z.y=0:z.y=1/I,Math.abs(M)<O.EPSILON?z.z=0:z.z=1/M,z},Y.normalize=function(z,W){D=W.x,I=W.y,M=W.z;var Z=D*D+I*I+M*M;return Z>0&&(Z=1/Math.sqrt(Z),z.x=D*Z,z.y=I*Z,z.z=M*Z),z},Y.dot=function(z,W){return z.x*W.x+z.y*W.y+z.z*W.z},Y.cross=function(z,W,Z){var Q=W.x,ee=W.y,te=W.z,re=Z.x,ie=Z.y,ne=Z.z;return z.x=ee*ne-te*ie,z.y=te*re-Q*ne,z.z=Q*ie-ee*re,z},Y.lerp=function(z,W,Z,Q){return z.x=W.x+Q*(Z.x-W.x),z.y=W.y+Q*(Z.y-W.y),z.z=W.z+Q*(Z.z-W.z),z},Y.random=function(z,W){W=W||1;var Z=2*(0,O.random)()*Math.PI,Q=2*(0,O.random)()-1,ee=Math.sqrt(1-Q*Q);return z.x=ee*Math.cos(Z)*W,z.y=ee*Math.sin(Z)*W,z.z=Q*W,z},Y.transformMat4=function(z,W,Z){D=W.x,I=W.y,M=W.z;var Q=Z.m,ee=Q[3]*D+Q[7]*I+Q[11]*M+Q[15];return ee=ee?1/ee:1,z.x=(Q[0]*D+Q[4]*I+Q[8]*M+Q[12])*ee,z.y=(Q[1]*D+Q[5]*I+Q[9]*M+Q[13])*ee,z.z=(Q[2]*D+Q[6]*I+Q[10]*M+Q[14])*ee,z},Y.transformMat4Normal=function(z,W,Z){D=W.x,I=W.y,M=W.z;var Q=Z.m,ee=Q[3]*D+Q[7]*I+Q[11]*M;return ee=ee?1/ee:1,z.x=(Q[0]*D+Q[4]*I+Q[8]*M)*ee,z.y=(Q[1]*D+Q[5]*I+Q[9]*M)*ee,z.z=(Q[2]*D+Q[6]*I+Q[10]*M)*ee,z},Y.transformMat3=function(z,W,Z){D=W.x,I=W.y,M=W.z;var Q=Z.m;return z.x=D*Q[0]+I*Q[3]+M*Q[6],z.y=D*Q[1]+I*Q[4]+M*Q[7],z.z=D*Q[2]+I*Q[5]+M*Q[8],z},Y.transformAffine=function(z,W,Z){D=W.x,I=W.y,M=W.z;var Q=Z.m;return z.x=Q[0]*D+Q[1]*I+Q[2]*M+Q[3],z.y=Q[4]*D+Q[5]*I+Q[6]*M+Q[7],z.x=Q[8]*D+Q[9]*I+Q[10]*M+Q[11],z},Y.transformQuat=function(z,W,Z){var Q=Z.w*W.x+Z.y*W.z-Z.z*W.y,ee=Z.w*W.y+Z.z*W.x-Z.x*W.z,te=Z.w*W.z+Z.x*W.y-Z.y*W.x,re=-Z.x*W.x-Z.y*W.y-Z.z*W.z;return z.x=Q*Z.w+re*-Z.x+ee*-Z.z-te*-Z.y,z.y=ee*Z.w+re*-Z.y+te*-Z.x-Q*-Z.z,z.z=te*Z.w+re*-Z.z+Q*-Z.y-ee*-Z.x,z},Y.transformRTS=function(z,W,Z,Q,ee){var te=W.x*ee.x,re=W.y*ee.y,ie=W.z*ee.z,ne=Z.w*te+Z.y*ie-Z.z*re,he=Z.w*re+Z.z*te-Z.x*ie,pe=Z.w*ie+Z.x*re-Z.y*te,K=-Z.x*te-Z.y*re-Z.z*ie;return z.x=ne*Z.w+K*-Z.x+he*-Z.z-pe*-Z.y+Q.x,z.y=he*Z.w+K*-Z.y+pe*-Z.x-ne*-Z.z+Q.y,z.z=pe*Z.w+K*-Z.z+ne*-Z.y-he*-Z.x+Q.z,z},Y.transformInverseRTS=function(z,W,Z,Q,ee){var te=W.x-Q.x,re=W.y-Q.y,ie=W.z-Q.z,ne=Z.w*te-Z.y*ie+Z.z*re,he=Z.w*re-Z.z*te+Z.x*ie,pe=Z.w*ie-Z.x*re+Z.y*te,K=Z.x*te+Z.y*re+Z.z*ie;return z.x=(ne*Z.w+K*Z.x+he*Z.z-pe*Z.y)/ee.x,z.y=(he*Z.w+K*Z.y+pe*Z.x-ne*Z.z)/ee.y,z.z=(pe*Z.w+K*Z.z+ne*Z.y-he*Z.x)/ee.z,z},Y.rotateX=function(z,W,Z,Q){D=W.x-Z.x,I=W.y-Z.y,M=W.z-Z.z;var ee=Math.cos(Q),te=Math.sin(Q),re=D,ie=I*ee-M*te,ne=I*te+M*ee;return z.x=re+Z.x,z.y=ie+Z.y,z.z=ne+Z.z,z},Y.rotateY=function(z,W,Z,Q){D=W.x-Z.x,I=W.y-Z.y,M=W.z-Z.z;var ee=Math.cos(Q),te=Math.sin(Q),re=M*te+D*ee,ie=I,ne=M*ee-D*te;return z.x=re+Z.x,z.y=ie+Z.y,z.z=ne+Z.z,z},Y.rotateZ=function(z,W,Z,Q){D=W.x-Z.x,I=W.y-Z.y,M=W.z-Z.z;var ee=Math.cos(Q),te=Math.sin(Q),re=D*ee-I*te,ie=D*te+I*ee,ne=M;return z.x=re+Z.x,z.y=ie+Z.y,z.z=ne+Z.z,z},Y.strictEquals=function(z,W){return z.x===W.x&&z.y===W.y&&z.z===W.z},Y.equals=function(z,W,Z){Z===void 0&&(Z=O.EPSILON);var Q=z.x,ee=z.y,te=z.z,re=W.x,ie=W.y,ne=W.z;return Math.abs(Q-re)<=Z*Math.max(1,Math.abs(Q),Math.abs(re))&&Math.abs(ee-ie)<=Z*Math.max(1,Math.abs(ee),Math.abs(ie))&&Math.abs(te-ne)<=Z*Math.max(1,Math.abs(te),Math.abs(ne))},Y.angle=function(z,W){Y.normalize(k,z),Y.normalize(F,W);var Z=Y.dot(k,F);return Z>1?0:Z<-1?Math.PI:Math.acos(Z)},Y.projectOnPlane=function(z,W,Z){return Y.subtract(z,W,Y.project(z,W,Z))},Y.project=function(z,W,Z){var Q=Y.lengthSqr(Z);return Q<1e-6?Y.set(z,0,0,0):Y.multiplyScalar(z,Z,Y.dot(W,Z)/Q)},Y.toArray=function(z,W,Z){return Z===void 0&&(Z=0),z[Z+0]=W.x,z[Z+1]=W.y,z[Z+2]=W.z,z},Y.fromArray=function(z,W,Z){return Z===void 0&&(Z=0),z.x=W[Z+0],z.y=W[Z+1],z.z=W[Z+2],z},X.clone=function(){return new Y(this.x,this.y,this.z)},X.set=function(z){return this.x=z.x,this.y=z.y,this.z=z.z,this},X.equals=function(z){return z&&this.x===z.x&&this.y===z.y&&this.z===z.z},X.fuzzyEquals=function(z,W){return this.x-W<=z.x&&z.x<=this.x+W&&this.y-W<=z.y&&z.y<=this.y+W&&this.z-W<=z.z&&z.z<=this.z+W},X.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(2)+")"},X.lerp=function(z,W,Z){return Z=Z||new Y,Y.lerp(Z,this,z,W),Z},X.clampf=function(z,W){return this.x=B.default.clampf(this.x,z.x,W.x),this.y=B.default.clampf(this.y,z.y,W.y),this.z=B.default.clampf(this.z,z.z,W.z),this},X.addSelf=function(z){return this.x+=z.x,this.y+=z.y,this.z+=z.z,this},X.add=function(z,W){return(W=W||new Y).x=this.x+z.x,W.y=this.y+z.y,W.z=this.z+z.z,W},X.subtract=function(z){return this.x-=z.x,this.y-=z.y,this.z-=z.z,this},X.multiplyScalar=function(z){return this.x*=z,this.y*=z,this.z*=z,this},X.multiply=function(z){return this.x*=z.x,this.y*=z.y,this.z*=z.z,this},X.divide=function(z){return this.x/=z,this.y/=z,this.z/=z,this},X.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},X.dot=function(z){return this.x*z.x+this.y*z.y+this.z*z.z},X.cross=function(z,W){return W=W||new Y,Y.cross(W,this,z),W},X.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},X.lengthSqr=function(){return this.x*this.x+this.y*this.y+this.z*this.z},X.normalizeSelf=function(){return Y.normalize(this,this),this},X.normalize=function(z){return z=z||new Y,Y.normalize(z,this),z},X.transformMat4=function(z,W){return W=W||new Y,Y.transformMat4(W,this,z),W},X.maxAxis=function(){return Math.max(this.x,this.y,this.z)},X.signAngle=function(z){cc.warnID(1408,"vec3.signAngle","v2.1","cc.v2(selfVector).signAngle(vector)");var W=new A.default(this.x,this.y),Z=new A.default(z.x,z.y);return W.signAngle(Z)},X.rotate=function(z,W){return cc.warnID(1408,"vec3.rotate","v2.1","cc.v2(selfVector).rotate(radians, out)"),A.default.prototype.rotate.call(this,z,W)},X.rotateSelf=function(z){return cc.warnID(1408,"vec3.rotateSelf","v2.1","cc.v2(selfVector).rotateSelf(radians)"),A.default.prototype.rotateSelf.call(this,z)},H=Y,U=[{key:"ONE",get:function(){return new Y(1,1,1)}},{key:"ZERO",get:function(){return new Y}},{key:"UP",get:function(){return new Y(0,1,0)}},{key:"RIGHT",get:function(){return new Y(1,0,0)}},{key:"FORWARD",get:function(){return new Y(0,0,1)}}],U&&P(H,U),Object.defineProperty(H,"prototype",{writable:!1}),Y}(_.default);T.default=N,N.sub=N.subtract,N.mul=N.multiply,N.scale=N.multiplyScalar,N.mag=N.len,N.squaredMagnitude=N.lengthSqr,N.div=N.divide,N.ONE_R=N.ONE,N.ZERO_R=N.ZERO,N.UP_R=N.UP,N.RIGHT_R=N.RIGHT,N.FRONT_R=N.FORWARD;var k=new N,F=new N;w.default.fastDefine("cc.Vec3",N,{x:0,y:0,z:0}),cc.v3=function(G,V,j){return new N(G,V,j)},cc.Vec3=N,S.exports=T.default},{"../platform/CCClass":196,"../utils/misc":271,"./utils":293,"./value-type":294,"./vec2":295}],297:[function(L,S,T){T.__esModule=!0,T.default=void 0,T.v4=N;var _=A(L("../platform/CCClass")),w=A(L("./value-type")),B=L("./utils");function A(k){return k&&k.__esModule?k:{default:k}}function O(k,F){for(var G=0;G<F.length;G++){var V=F[G];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(k,V.key,V)}}function R(k,F){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(G,V){return G.__proto__=V,G})(k,F)}var P=0,E=0,D=0,I=0,M=function(k){var F,G;G=k,(F=U).prototype=Object.create(G.prototype),F.prototype.constructor=F,R(F,G);var V,j,H=U.prototype;function U(X,Y,z,W){var Z;return X===void 0&&(X=0),Y===void 0&&(Y=0),z===void 0&&(z=0),W===void 0&&(W=0),(Z=k.call(this)||this).mag=U.prototype.len,Z.magSqr=U.prototype.lengthSqr,Z.subSelf=U.prototype.subtract,Z.mulSelf=U.prototype.multiplyScalar,Z.divSelf=U.prototype.divide,Z.scaleSelf=U.prototype.multiply,Z.negSelf=U.prototype.negate,Z.x=void 0,Z.y=void 0,Z.z=void 0,Z.w=void 0,X&&typeof X=="object"?(Z.x=X.x,Z.y=X.y,Z.z=X.z,Z.w=X.w):(Z.x=X,Z.y=Y,Z.z=z,Z.w=W),Z}return H.sub=function(X,Y){return U.subtract(Y||new U,this,X)},H.mul=function(X,Y){return U.multiplyScalar(Y||new U,this,X)},H.div=function(X,Y){return U.multiplyScalar(Y||new U,this,1/X)},H.scale=function(X,Y){return U.multiply(Y||new U,this,X)},H.neg=function(X){return U.negate(X||new U,this)},U.clone=function(X){return new U(X.x,X.y,X.z,X.w)},U.copy=function(X,Y){return X.x=Y.x,X.y=Y.y,X.z=Y.z,X.w=Y.w,X},U.set=function(X,Y,z,W,Z){return X.x=Y,X.y=z,X.z=W,X.w=Z,X},U.add=function(X,Y,z){return X.x=Y.x+z.x,X.y=Y.y+z.y,X.z=Y.z+z.z,X.w=Y.w+z.w,X},U.subtract=function(X,Y,z){return X.x=Y.x-z.x,X.y=Y.y-z.y,X.z=Y.z-z.z,X.w=Y.w-z.w,X},U.multiply=function(X,Y,z){return X.x=Y.x*z.x,X.y=Y.y*z.y,X.z=Y.z*z.z,X.w=Y.w*z.w,X},U.divide=function(X,Y,z){return X.x=Y.x/z.x,X.y=Y.y/z.y,X.z=Y.z/z.z,X.w=Y.w/z.w,X},U.ceil=function(X,Y){return X.x=Math.ceil(Y.x),X.y=Math.ceil(Y.y),X.z=Math.ceil(Y.z),X.w=Math.ceil(Y.w),X},U.floor=function(X,Y){return X.x=Math.floor(Y.x),X.y=Math.floor(Y.y),X.z=Math.floor(Y.z),X.w=Math.floor(Y.w),X},U.min=function(X,Y,z){return X.x=Math.min(Y.x,z.x),X.y=Math.min(Y.y,z.y),X.z=Math.min(Y.z,z.z),X.w=Math.min(Y.w,z.w),X},U.max=function(X,Y,z){return X.x=Math.max(Y.x,z.x),X.y=Math.max(Y.y,z.y),X.z=Math.max(Y.z,z.z),X.w=Math.max(Y.w,z.w),X},U.round=function(X,Y){return X.x=Math.round(Y.x),X.y=Math.round(Y.y),X.z=Math.round(Y.z),X.w=Math.round(Y.w),X},U.multiplyScalar=function(X,Y,z){return X.x=Y.x*z,X.y=Y.y*z,X.z=Y.z*z,X.w=Y.w*z,X},U.scaleAndAdd=function(X,Y,z,W){return X.x=Y.x+z.x*W,X.y=Y.y+z.y*W,X.z=Y.z+z.z*W,X.w=Y.w+z.w*W,X},U.distance=function(X,Y){var z=Y.x-X.x,W=Y.y-X.y,Z=Y.z-X.z,Q=Y.w-X.w;return Math.sqrt(z*z+W*W+Z*Z+Q*Q)},U.squaredDistance=function(X,Y){var z=Y.x-X.x,W=Y.y-X.y,Z=Y.z-X.z,Q=Y.w-X.w;return z*z+W*W+Z*Z+Q*Q},U.len=function(X){return P=X.x,E=X.y,D=X.z,I=X.w,Math.sqrt(P*P+E*E+D*D+I*I)},U.lengthSqr=function(X){return P=X.x,E=X.y,D=X.z,I=X.w,P*P+E*E+D*D+I*I},U.negate=function(X,Y){return X.x=-Y.x,X.y=-Y.y,X.z=-Y.z,X.w=-Y.w,X},U.inverse=function(X,Y){return X.x=1/Y.x,X.y=1/Y.y,X.z=1/Y.z,X.w=1/Y.w,X},U.inverseSafe=function(X,Y){return P=Y.x,E=Y.y,D=Y.z,I=Y.w,Math.abs(P)<B.EPSILON?X.x=0:X.x=1/P,Math.abs(E)<B.EPSILON?X.y=0:X.y=1/E,Math.abs(D)<B.EPSILON?X.z=0:X.z=1/D,Math.abs(I)<B.EPSILON?X.w=0:X.w=1/I,X},U.normalize=function(X,Y){P=Y.x,E=Y.y,D=Y.z,I=Y.w;var z=P*P+E*E+D*D+I*I;return z>0&&(z=1/Math.sqrt(z),X.x=P*z,X.y=E*z,X.z=D*z,X.w=I*z),X},U.dot=function(X,Y){return X.x*Y.x+X.y*Y.y+X.z*Y.z+X.w*Y.w},U.lerp=function(X,Y,z,W){return X.x=Y.x+W*(z.x-Y.x),X.y=Y.y+W*(z.y-Y.y),X.z=Y.z+W*(z.z-Y.z),X.w=Y.w+W*(z.w-Y.w),X},U.random=function(X,Y){Y=Y||1;var z=2*(0,B.random)()*Math.PI,W=2*(0,B.random)()-1,Z=Math.sqrt(1-W*W);return X.x=Z*Math.cos(z)*Y,X.y=Z*Math.sin(z)*Y,X.z=W*Y,X.w=0,X},U.transformMat4=function(X,Y,z){P=Y.x,E=Y.y,D=Y.z,I=Y.w;var W=z.m;return X.x=W[0]*P+W[4]*E+W[8]*D+W[12]*I,X.y=W[1]*P+W[5]*E+W[9]*D+W[13]*I,X.z=W[2]*P+W[6]*E+W[10]*D+W[14]*I,X.w=W[3]*P+W[7]*E+W[11]*D+W[15]*I,X},U.transformAffine=function(X,Y,z){P=Y.x,E=Y.y,D=Y.z,I=Y.w;var W=z.m;return X.x=W[0]*P+W[1]*E+W[2]*D+W[3]*I,X.y=W[4]*P+W[5]*E+W[6]*D+W[7]*I,X.x=W[8]*P+W[9]*E+W[10]*D+W[11]*I,X.w=Y.w,X},U.transformQuat=function(X,Y,z){var W=Y.x,Z=Y.y,Q=Y.z;P=z.x,E=z.y,D=z.z;var ee=(I=z.w)*W+E*Q-D*Z,te=I*Z+D*W-P*Q,re=I*Q+P*Z-E*W,ie=-P*W-E*Z-D*Q;return X.x=ee*I+ie*-P+te*-D-re*-E,X.y=te*I+ie*-E+re*-P-ee*-D,X.z=re*I+ie*-D+ee*-E-te*-P,X.w=Y.w,X},U.strictEquals=function(X,Y){return X.x===Y.x&&X.y===Y.y&&X.z===Y.z&&X.w===Y.w},U.equals=function(X,Y,z){return z===void 0&&(z=B.EPSILON),Math.abs(X.x-Y.x)<=z*Math.max(1,Math.abs(X.x),Math.abs(Y.x))&&Math.abs(X.y-Y.y)<=z*Math.max(1,Math.abs(X.y),Math.abs(Y.y))&&Math.abs(X.z-Y.z)<=z*Math.max(1,Math.abs(X.z),Math.abs(Y.z))&&Math.abs(X.w-Y.w)<=z*Math.max(1,Math.abs(X.w),Math.abs(Y.w))},U.toArray=function(X,Y,z){return z===void 0&&(z=0),X[z+0]=Y.x,X[z+1]=Y.y,X[z+2]=Y.z,X[z+3]=Y.w,X},U.fromArray=function(X,Y,z){return z===void 0&&(z=0),X.x=Y[z+0],X.y=Y[z+1],X.z=Y[z+2],X.w=Y[z+3],X},H.clone=function(){return new U(this.x,this.y,this.z,this.w)},H.set=function(X,Y,z,W){return X&&typeof X=="object"?(this.x=X.x,this.y=X.y,this.z=X.z,this.w=X.w):(this.x=X||0,this.y=Y||0,this.z=z||0,this.w=W||0),this},H.equals=function(X,Y){return Y===void 0&&(Y=B.EPSILON),Math.abs(this.x-X.x)<=Y*Math.max(1,Math.abs(this.x),Math.abs(X.x))&&Math.abs(this.y-X.y)<=Y*Math.max(1,Math.abs(this.y),Math.abs(X.y))&&Math.abs(this.z-X.z)<=Y*Math.max(1,Math.abs(this.z),Math.abs(X.z))&&Math.abs(this.w-X.w)<=Y*Math.max(1,Math.abs(this.w),Math.abs(X.w))},H.equals4f=function(X,Y,z,W,Z){return Z===void 0&&(Z=B.EPSILON),Math.abs(this.x-X)<=Z*Math.max(1,Math.abs(this.x),Math.abs(X))&&Math.abs(this.y-Y)<=Z*Math.max(1,Math.abs(this.y),Math.abs(Y))&&Math.abs(this.z-z)<=Z*Math.max(1,Math.abs(this.z),Math.abs(z))&&Math.abs(this.w-W)<=Z*Math.max(1,Math.abs(this.w),Math.abs(W))},H.strictEquals=function(X){return this.x===X.x&&this.y===X.y&&this.z===X.z&&this.w===X.w},H.strictEquals4f=function(X,Y,z,W){return this.x===X&&this.y===Y&&this.z===z&&this.w===W},H.lerp=function(X,Y){return P=this.x,E=this.y,D=this.z,I=this.w,this.x=P+Y*(X.x-P),this.y=E+Y*(X.y-E),this.z=D+Y*(X.z-D),this.w=I+Y*(X.w-I),this},H.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(2)+", "+this.w.toFixed(2)+")"},H.clampf=function(X,Y){return this.x=(0,B.clamp)(this.x,X.x,Y.x),this.y=(0,B.clamp)(this.y,X.y,Y.y),this.z=(0,B.clamp)(this.z,X.z,Y.z),this.w=(0,B.clamp)(this.w,X.w,Y.w),this},H.addSelf=function(X){return this.x+=X.x,this.y+=X.y,this.z+=X.z,this.w+=X.w,this},H.add=function(X,Y){return(Y=Y||new U).x=this.x+X.x,Y.y=this.y+X.y,Y.z=this.z+X.z,Y.w=this.w+X.w,Y},H.subtract=function(X,Y){return(Y=Y||new U).x=this.x-X.x,Y.y=this.y-X.y,Y.z=this.z-X.z,Y.w=this.w-X.w,Y},H.multiplyScalar=function(X){return this.x*=X,this.y*=X,this.z*=X,this.w*=X,this},H.multiply=function(X){return this.x*=X.x,this.y*=X.y,this.z*=X.z,this.w*=X.w,this},H.divide=function(X){return this.x/=X,this.y/=X,this.z/=X,this.w/=X,this},H.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},H.dot=function(X){return this.x*X.x+this.y*X.y+this.z*X.z+this.w*X.w},H.cross=function(X,Y){Y=Y||new U;var z=this.x,W=this.y,Z=this.z,Q=X.x,ee=X.y,te=X.z;return Y.x=W*te-Z*ee,Y.y=Z*Q-z*te,Y.z=z*ee-W*Q,Y},H.len=function(){var X=this.x,Y=this.y,z=this.z,W=this.w;return Math.sqrt(X*X+Y*Y+z*z+W*W)},H.lengthSqr=function(){var X=this.x,Y=this.y,z=this.z,W=this.w;return X*X+Y*Y+z*z+W*W},H.normalizeSelf=function(){return this.normalize(this),this},H.normalize=function(X){X=X||new U,P=this.x,E=this.y,D=this.z,I=this.w;var Y=P*P+E*E+D*D+I*I;return Y>0&&(Y=1/Math.sqrt(Y),X.x=P*Y,X.y=E*Y,X.z=D*Y,X.w=I*Y),X},H.transformMat4=function(X,Y){Y=Y||new U,P=this.x,E=this.y,D=this.z,I=this.w;var z=X.m;return Y.x=z[0]*P+z[4]*E+z[8]*D+z[12]*I,Y.y=z[1]*P+z[5]*E+z[9]*D+z[13]*I,Y.z=z[2]*P+z[6]*E+z[10]*D+z[14]*I,Y.w=z[3]*P+z[7]*E+z[11]*D+z[15]*I,Y},H.maxAxis=function(){return Math.max(this.x,this.y,this.z,this.w)},V=U,j=[{key:"ZERO",get:function(){return new U(0,0,0,0)}},{key:"ONE",get:function(){return new U(1,1,1,1)}},{key:"NEG_ONE",get:function(){return new U(-1,-1,-1,-1)}}],j&&O(V,j),Object.defineProperty(V,"prototype",{writable:!1}),U}(w.default);function N(k,F,G,V){return new M(k,F,G,V)}T.default=M,M.sub=M.subtract,M.mul=M.multiply,M.div=M.divide,M.scale=M.multiplyScalar,M.mag=M.len,M.squaredMagnitude=M.lengthSqr,M.ZERO_R=M.ZERO,M.ONE_R=M.ONE,M.NEG_ONE_R=M.NEG_ONE,_.default.fastDefine("cc.Vec4",M,{x:0,y:0,z:0,w:0}),cc.v4=N,cc.Vec4=M},{"../platform/CCClass":196,"./utils":293,"./value-type":294}],298:[function(){cc.js},{}],299:[function(L){L("./core/CCGame"),L("./actions")},{"./actions":7,"./core/CCGame":28}],300:[function(L,S){var T=L("../compression/zlib.min"),_=L("../core/CCDebug"),w=function(B){var A,O,R,P,E,D,I,M,N,k,F,G,V;for(this.data=B,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},E=null;;){switch(A=this.readUInt32(),M=(function(){var j,H;for(H=[],j=0;j<4;++j)H.push(String.fromCharCode(this.data[this.pos++]));return H}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(A);break;case"fcTL":E&&this.animation.frames.push(E),this.pos+=4,E={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},P=this.readUInt16(),R=this.readUInt16()||100,E.delay=1e3*P/R,E.disposeOp=this.data[this.pos++],E.blendOp=this.data[this.pos++],E.data=[];break;case"IDAT":case"fdAT":for(M==="fdAT"&&(this.pos+=4,A-=4),B=(E!=null?E.data:void 0)||this.imgData,F=0;0<=A?F<A:F>A;0<=A?++F:--F)B.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(A),(N=255-this.transparency.indexed.length)>0)for(G=0;0<=N?G<N:G>N;0<=N?++G:--G)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(A)[0];break;case 2:this.transparency.rgb=this.read(A)}break;case"tEXt":D=(k=this.read(A)).indexOf(0),I=String.fromCharCode.apply(String,k.slice(0,D)),this.text[I]=String.fromCharCode.apply(String,k.slice(D+1));break;case"IEND":return E&&this.animation.frames.push(E),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(V=this.colorType)===4||V===6,O=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*O,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=A}if(this.pos+=4,this.pos>this.data.length)throw new Error(_.getError(6017))}};w.prototype={constructor:w,read:function(B){var A,O;for(O=[],A=0;0<=B?A<B:A>B;0<=B?++A:--A)O.push(this.data[this.pos++]);return O},readUInt32:function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},readUInt16:function(){return this.data[this.pos++]<<8|this.data[this.pos++]},decodePixels:function(B){var A,O,R,P,E,D,I,M,N,k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee;if(B==null&&(B=this.imgData),B.length===0)return new Uint8Array(0);for(B=new T.Inflate(B,{index:0,verify:!1}).decompress(),U=(G=this.pixelBitlength/8)*this.width,V=new Uint8Array(U*this.height),D=B.length,H=0,j=0,O=0;j<D;){switch(B[j++]){case 0:for(P=z=0;z<U;P=z+=1)V[O++]=B[j++];break;case 1:for(P=W=0;W<U;P=W+=1)A=B[j++],E=P<G?0:V[O-G],V[O++]=(A+E)%256;break;case 2:for(P=Z=0;Z<U;P=Z+=1)A=B[j++],R=(P-P%G)/G,X=H&&V[(H-1)*U+R*G+P%G],V[O++]=(X+A)%256;break;case 3:for(P=Q=0;Q<U;P=Q+=1)A=B[j++],R=(P-P%G)/G,E=P<G?0:V[O-G],X=H&&V[(H-1)*U+R*G+P%G],V[O++]=(A+Math.floor((E+X)/2))%256;break;case 4:for(P=ee=0;ee<U;P=ee+=1)A=B[j++],R=(P-P%G)/G,E=P<G?0:V[O-G],H===0?X=Y=0:(X=V[(H-1)*U+R*G+P%G],Y=R&&V[(H-1)*U+(R-1)*G+P%G]),I=E+X-Y,M=Math.abs(I-E),k=Math.abs(I-X),F=Math.abs(I-Y),N=M<=k&&M<=F?E:k<=F?X:Y,V[O++]=(A+N)%256;break;default:throw new Error(_.getError(6018,B[j-1]))}H++}return V},copyToImageData:function(B,A){var O,R,P,E,D,I,M,N,k,F,G;if(R=this.colors,k=null,O=this.hasAlphaChannel,this.palette.length&&(k=(G=this._decodedPalette)!=null?G:this._decodedPalette=this.decodePalette(),R=4,O=!0),N=(P=B.data||B).length,D=k||A,E=I=0,R===1)for(;E<N;)M=k?4*A[E/4]:I,F=D[M++],P[E++]=F,P[E++]=F,P[E++]=F,P[E++]=O?D[M++]:255,I=M;else for(;E<N;)M=k?4*A[E/4]:I,P[E++]=D[M++],P[E++]=D[M++],P[E++]=D[M++],P[E++]=O?D[M++]:255,I=M},decodePalette:function(){var B,A,O,R,P,E,D,I,M;for(O=this.palette,E=this.transparency.indexed||[],P=new Uint8Array((E.length||0)+O.length),R=0,B=0,A=D=0,I=O.length;D<I;A=D+=3)P[R++]=O[A],P[R++]=O[A+1],P[R++]=O[A+2],P[R++]=(M=E[B++])!=null?M:255;return P},render:function(B){var A,O;return B.width=this.width,B.height=this.height,O=(A=B.getContext("2d")).createImageData(this.width,this.height),this.copyToImageData(O,this.decodePixels()),A.putImageData(O,0,0)}},S.exports=w},{"../compression/zlib.min":25,"../core/CCDebug":26}],301:[function(L,S){var T=L("../core/assets/CCAsset"),_=L("../core/assets/CCSpriteFrame"),w=cc.Class({name:"cc.ParticleAsset",extends:T,properties:{spriteFrame:{default:null,type:_}}});cc.ParticleAsset=S.exports=w},{"../core/assets/CCAsset":62,"../core/assets/CCSpriteFrame":74}],302:[function(L,S){var T=L("../core/platform/CCMacro"),_=L("./CCParticleAsset"),w=L("../core/components/CCRenderComponent"),B=L("../compression/ZipUtils"),A=L("./CCPNGReader"),O=L("./CCTIFFReader"),R=L("../core/utils/texture-util"),P=(L("../core/renderer/render-flow"),L("./particle-simulator")),E=(L("../core/assets/material/CCMaterial"),L("../core/utils/blend-func")),D=cc.Enum({GRAVITY:0,RADIUS:1}),I=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),M={preview:{default:!0,editorOnly:!0,notify:!1,animatable:!1,tooltip:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(k){this._custom!==k&&(this._custom=k,this._applyFile())},animatable:!1,tooltip:!1},_file:{default:null,type:_},file:{get:function(){return this._file},set:function(k){this._file!==k&&(this._file=k,k?this._applyFile():this.custom=!0)},animatable:!1,type:_,tooltip:!1},_spriteFrame:{default:null,type:cc.SpriteFrame},spriteFrame:{get:function(){return this._spriteFrame},set:function(k){var F=this._renderSpriteFrame;F!==k&&(this._renderSpriteFrame=k,k&&!k._uuid||(this._spriteFrame=k),this._applySpriteFrame(F))},type:cc.SpriteFrame,tooltip:!1},_texture:{default:null,type:cc.Texture2D,editorOnly:!0},texture:{get:function(){return this._getTexture()},set:function(k){k&&cc.warnID(6017)},type:cc.Texture2D,tooltip:!1,readonly:!0,visible:!1,animatable:!1},particleCount:{visible:!1,get:function(){return this._simulator.particles.length},readonly:!0},_stopped:!0,stopped:{get:function(){return this._stopped},animatable:!1,visible:!1},playOnLoad:!0,autoRemoveOnFinish:{default:!1,animatable:!1,tooltip:!1},active:{get:function(){return this._simulator.active},visible:!1},totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,_startColor:null,startColor:{type:cc.Color,get:function(){return this._startColor},set:function(k){this._startColor.r=k.r,this._startColor.g=k.g,this._startColor.b=k.b,this._startColor.a=k.a}},_startColorVar:null,startColorVar:{type:cc.Color,get:function(){return this._startColorVar},set:function(k){this._startColorVar.r=k.r,this._startColorVar.g=k.g,this._startColorVar.b=k.b,this._startColorVar.a=k.a}},_endColor:null,endColor:{type:cc.Color,get:function(){return this._endColor},set:function(k){this._endColor.r=k.r,this._endColor.g=k.g,this._endColor.b=k.b,this._endColor.a=k.a}},_endColorVar:null,endColorVar:{type:cc.Color,get:function(){return this._endColorVar},set:function(k){this._endColorVar.r=k.r,this._endColorVar.g=k.g,this._endColorVar.b=k.b,this._endColorVar.a=k.a}},angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.Vec2.ZERO,posVar:cc.Vec2.ZERO,_positionType:{default:I.FREE,formerlySerializedAs:"positionType"},positionType:{type:I,get:function(){return this._positionType},set:function(k){this._positionType=k,this._updateMaterial()}},emitterMode:{default:D.GRAVITY,type:D},gravity:cc.Vec2.ZERO,speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},N=cc.Class({name:"cc.ParticleSystem",extends:w,mixins:[E],editor:!1,ctor:function(){this.initProperties()},initProperties:function(){this._previewTimer=null,this._focused=!1,this._aspectRatio=1,this._simulator=new P(this),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(0,0,0,0),this._endColor=cc.color(255,255,255,0),this._endColorVar=cc.color(0,0,0,0),this._renderSpriteFrame=null},properties:M,statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:D,PositionType:I,_PNGReader:A,_TIFFReader:O},onFocusInEditor:!1,onLostFocusInEditor:!1,onRestore:!1,_startPreview:!1,_stopPreview:!1,_convertTextureToSpriteFrame:!1,__preload:function(){this._super(),this._custom&&this.spriteFrame&&!this._renderSpriteFrame?this._applySpriteFrame(this.spriteFrame):this._file&&(this._custom?!this._getTexture()&&this._applyFile():this._applyFile()),this.playOnLoad&&this.resetSystem()},onDestroy:function(){this.autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._buffer&&(this._buffer.destroy(),this._buffer=null),this._simulator._uvFilled=0,this._super()},lateUpdate:function(k){this._simulator.finished||this._simulator.step(k)},addParticle:function(){},stopSystem:function(){this._stopped=!0,this._simulator.stop()},resetSystem:function(){this._stopped=!1,this._simulator.reset(),this.markForRender(!0)},isFull:function(){return this.particleCount>=this.totalParticles},setTextureWithRect:function(k,F){k instanceof cc.Texture2D&&(this.spriteFrame=new cc.SpriteFrame(k,F))},_applyFile:function(){var k=this._file;if(k){var F=this;cc.assetManager.postLoadNative(k,function(G){!G&&k._nativeAsset?F.isValid&&(F._plistFile=k.nativeUrl,F._custom||(F._spriteFrame!==k.spriteFrame&&(F.spriteFrame=k.spriteFrame),F._initWithDictionary(k._nativeAsset)),F._spriteFrame?!F._renderSpriteFrame&&F._spriteFrame&&F._applySpriteFrame(F.spriteFrame):k.spriteFrame?F.spriteFrame=k.spriteFrame:F._custom&&F._initTextureWithDictionary(k._nativeAsset)):cc.errorID(6029)})}},_initTextureWithDictionary:function(k){var F,G=cc.path.changeBasename(this._plistFile,k.textureFileName||"");if(k.textureFileName)R.loadImage(G,function(Y,z){Y?(k.textureFileName=void 0,this._initTextureWithDictionary(k)):(cc.assetManager.assets.add(G,z),this.spriteFrame=new cc.SpriteFrame(z))},this);else if(k.textureImageData){var V=k.textureImageData;if(!(V&&V.length>0))return!1;var j=cc.assetManager.assets.get(G);if(!j){var H=B.unzipBase64AsArray(V,1);if(!H)return cc.warnID(6030,this._file.name),!1;var U=(F=H).length>8&&F[0]===137&&F[1]===80&&F[2]===78&&F[3]===71&&F[4]===13&&F[5]===10&&F[6]===26&&F[7]===10?T.ImageFormat.PNG:F.length>2&&(F[0]===73&&F[1]===73||F[0]===77&&F[1]===77||F[0]===255&&F[1]===216)?T.ImageFormat.TIFF:T.ImageFormat.UNKNOWN;if(U!==T.ImageFormat.TIFF&&U!==T.ImageFormat.PNG)return cc.warnID(6031,this._file.name),!1;var X=document.createElement("canvas");U===T.ImageFormat.PNG?new A(H).render(X):O.parseTIFF(H,X),j=R.cacheImage(G,X)}j||cc.warnID(6032,this._file.name),this.spriteFrame=new cc.SpriteFrame(j)}return!0},_initWithDictionary:function(k){this.totalParticles=parseInt(k.maxParticles||0),this.life=parseFloat(k.particleLifespan||0),this.lifeVar=parseFloat(k.particleLifespanVariance||0);var F=k.emissionRate;this.emissionRate=F||Math.min(this.totalParticles/this.life,Number.MAX_VALUE),this.duration=parseFloat(k.duration||0),this.srcBlendFactor=parseInt(k.blendFuncSource||T.SRC_ALPHA),this.dstBlendFactor=parseInt(k.blendFuncDestination||T.ONE_MINUS_SRC_ALPHA);var G=this._startColor;G.r=255*parseFloat(k.startColorRed||0),G.g=255*parseFloat(k.startColorGreen||0),G.b=255*parseFloat(k.startColorBlue||0),G.a=255*parseFloat(k.startColorAlpha||0);var V=this._startColorVar;V.r=255*parseFloat(k.startColorVarianceRed||0),V.g=255*parseFloat(k.startColorVarianceGreen||0),V.b=255*parseFloat(k.startColorVarianceBlue||0),V.a=255*parseFloat(k.startColorVarianceAlpha||0);var j=this._endColor;j.r=255*parseFloat(k.finishColorRed||0),j.g=255*parseFloat(k.finishColorGreen||0),j.b=255*parseFloat(k.finishColorBlue||0),j.a=255*parseFloat(k.finishColorAlpha||0);var H=this._endColorVar;if(H.r=255*parseFloat(k.finishColorVarianceRed||0),H.g=255*parseFloat(k.finishColorVarianceGreen||0),H.b=255*parseFloat(k.finishColorVarianceBlue||0),H.a=255*parseFloat(k.finishColorVarianceAlpha||0),this.startSize=parseFloat(k.startParticleSize||0),this.startSizeVar=parseFloat(k.startParticleSizeVariance||0),this.endSize=parseFloat(k.finishParticleSize||0),this.endSizeVar=parseFloat(k.finishParticleSizeVariance||0),this.positionType=parseFloat(k.positionType!==void 0?k.positionType:I.RELATIVE),this.sourcePos.x=0,this.sourcePos.y=0,this.posVar.x=parseFloat(k.sourcePositionVariancex||0),this.posVar.y=parseFloat(k.sourcePositionVariancey||0),this.angle=parseFloat(k.angle||0),this.angleVar=parseFloat(k.angleVariance||0),this.startSpin=parseFloat(k.rotationStart||0),this.startSpinVar=parseFloat(k.rotationStartVariance||0),this.endSpin=parseFloat(k.rotationEnd||0),this.endSpinVar=parseFloat(k.rotationEndVariance||0),this.emitterMode=parseInt(k.emitterType||D.GRAVITY),this.emitterMode===D.GRAVITY){this.gravity.x=parseFloat(k.gravityx||0),this.gravity.y=parseFloat(k.gravityy||0),this.speed=parseFloat(k.speed||0),this.speedVar=parseFloat(k.speedVariance||0),this.radialAccel=parseFloat(k.radialAcceleration||0),this.radialAccelVar=parseFloat(k.radialAccelVariance||0),this.tangentialAccel=parseFloat(k.tangentialAcceleration||0),this.tangentialAccelVar=parseFloat(k.tangentialAccelVariance||0);var U=k.rotationIsDir||"";U!==null?(U=U.toString().toLowerCase(),this.rotationIsDir=U==="true"||U==="1"):this.rotationIsDir=!1}else{if(this.emitterMode!==D.RADIUS)return cc.warnID(6009),!1;this.startRadius=parseFloat(k.maxRadius||0),this.startRadiusVar=parseFloat(k.maxRadiusVariance||0),this.endRadius=parseFloat(k.minRadius||0),this.endRadiusVar=parseFloat(k.minRadiusVariance||0),this.rotatePerS=parseFloat(k.rotatePerSecond||0),this.rotatePerSVar=parseFloat(k.rotatePerSecondVariance||0)}return this._initTextureWithDictionary(k),!0},_validateRender:function(){var k=this._getTexture();k&&k.loaded?this._super():this.disableRender()},_onTextureLoaded:function(){this._simulator.updateUVs(!0),this._syncAspect(),this._updateMaterial(),this.markForRender(!0)},_syncAspect:function(){var k=this._renderSpriteFrame._rect;this._aspectRatio=k.width/k.height},_applySpriteFrame:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame&&(this._renderSpriteFrame.textureLoaded()?this._onTextureLoaded():this._renderSpriteFrame.onTextureLoaded(this._onTextureLoaded,this))},_getTexture:function(){return this._renderSpriteFrame&&this._renderSpriteFrame.getTexture()||this._texture},_updateMaterial:function(){var k=this.getMaterial(0);k&&(k.define("CC_USE_MODEL",this._positionType!==I.FREE),k.setProperty("texture",this._getTexture()),E.prototype._updateMaterial.call(this))},_finishedSimulation:function(){this.resetSystem(),this.stopSystem(),this.disableRender(),this.autoRemoveOnFinish&&this._stopped&&this.node.destroy()}});cc.ParticleSystem=S.exports=N},{"../compression/ZipUtils":22,"../core/assets/material/CCMaterial":81,"../core/components/CCRenderComponent":117,"../core/platform/CCMacro":201,"../core/renderer/render-flow":228,"../core/utils/blend-func":265,"../core/utils/texture-util":279,"./CCPNGReader":300,"./CCParticleAsset":301,"./CCTIFFReader":303,"./particle-simulator":305,"fire-url":void 0}],303:[function(L,S){var T=L("../core/CCDebug"),_={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(w){return this._tiffData[w]},getUint16:function(w){return this._littleEndian?this._tiffData[w+1]<<8|this._tiffData[w]:this._tiffData[w]<<8|this._tiffData[w+1]},getUint32:function(w){var B=this._tiffData;return this._littleEndian?B[w+3]<<24|B[w+2]<<16|B[w+1]<<8|B[w]:B[w]<<24|B[w+1]<<16|B[w+2]<<8|B[w+3]},checkLittleEndian:function(){var w=this.getUint16(0);if(w===18761)this.littleEndian=!0;else{if(w!==19789)throw console.log(w),TypeError(T.getError(6019));this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(this.getUint16(2)!==42)throw RangeError(T.getError(6020));return!0},getFieldTypeName:function(w){var B=this.fieldTypeNames;return w in B?B[w]:null},getFieldTagName:function(w){var B=this.fieldTagNames;return w in B?B[w]:(cc.logID(6021,w),"Tag"+w)},getFieldTypeLength:function(w){return["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(w)!==-1?1:["SHORT","SSHORT"].indexOf(w)!==-1?2:["LONG","SLONG","FLOAT"].indexOf(w)!==-1?4:["RATIONAL","SRATIONAL","DOUBLE"].indexOf(w)!==-1?8:null},getFieldValues:function(w,B,A,O){var R=[],P=this.getFieldTypeLength(B);if(P*A<=4)this.littleEndian===!1?R.push(O>>>8*(4-P)):R.push(O);else for(var E=0;E<A;E++){var D=P*E;P>=8?["RATIONAL","SRATIONAL"].indexOf(B)!==-1?(R.push(this.getUint32(O+D)),R.push(this.getUint32(O+D+4))):cc.logID(8e3):R.push(this.getBytes(P,O+D))}return B==="ASCII"&&R.forEach(function(I,M,N){N[M]=String.fromCharCode(I)}),R},getBytes:function(w,B){if(w<=0)cc.logID(8001);else{if(w<=1)return this.getUint8(B);if(w<=2)return this.getUint16(B);if(w<=3)return this.getUint32(B)>>>8;if(w<=4)return this.getUint32(B);cc.logID(8002)}},getBits:function(w,B,A){A=A||0;var O,R,P=B+Math.floor(A/8),E=A+w,D=32-w;return E<=0?cc.logID(6023):E<=8?(O=24+A,R=this.getUint8(P)):E<=16?(O=16+A,R=this.getUint16(P)):E<=32?(O=A,R=this.getUint32(P)):cc.logID(6022),{bits:R<<O>>>D,byteOffset:P+Math.floor(E/8),bitOffset:E%8}},parseFileDirectory:function(w){for(var B=this.getUint16(w),A=[],O=w+2,R=0;R<B;O+=12,R++){var P=this.getUint16(O),E=this.getUint16(O+2),D=this.getUint32(O+4),I=this.getUint32(O+8),M=this.getFieldTagName(P),N=this.getFieldTypeName(E),k=this.getFieldValues(M,N,D,I);A[M]={type:N,values:k}}this._fileDirectories.push(A);var F=this.getUint32(O);F!==0&&this.parseFileDirectory(F)},clampColorSample:function(w,B){var A=Math.pow(2,8-B);return Math.floor(w*A+(A-1))},parseTIFF:function(w,B){if(B=B||document.createElement("canvas"),this._tiffData=w,this.canvas=B,this.checkLittleEndian(),this.hasTowel()){var A=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(A);var O=this._fileDirectories[0],R=O.ImageWidth.values[0],P=O.ImageLength.values[0];this.canvas.width=R,this.canvas.height=P;var E=[],D=O.Compression?O.Compression.values[0]:1,I=O.SamplesPerPixel.values[0],M=[],N=0,k=!1;if(O.BitsPerSample.values.forEach(function(Xe,$e){M[$e]={bitsPerSample:Xe,hasBytesPerSample:!1,bytesPerSample:void 0},Xe%8==0&&(M[$e].hasBytesPerSample=!0,M[$e].bytesPerSample=Xe/8),N+=Xe},this),N%8==0){k=!0;var F=N/8}var G=O.StripOffsets.values,V=G.length;if(O.StripByteCounts)var j=O.StripByteCounts.values;else{if(cc.logID(8003),V!==1)throw Error(T.getError(6024));j=[Math.ceil(R*P*N/8)]}for(var H=0;H<V;H++){var U=G[H];E[H]=[];for(var X=j[H],Y=0,z=0,W=1,Z=!0,Q=[],ee=0,te=0,re=0;Y<X;Y+=W)switch(D){case 1:var ie=0;for(Q=[];ie<I;ie++){if(!M[ie].hasBytesPerSample){var ne=this.getBits(M[ie].bitsPerSample,U+Y,z);throw Q.push(ne.bits),Y=ne.byteOffset-U,z=ne.bitOffset,RangeError(T.getError(6025))}var he=M[ie].bytesPerSample*ie;Q.push(this.getBytes(M[ie].bytesPerSample,U+Y+he))}if(E[H].push(Q),!k)throw W=0,RangeError(T.getError(6026));W=F;break;case 2:case 3:case 4:case 5:case 6:case 7:break;case 32773:if(Z){Z=!1;var pe=1,K=1,ue=this.getInt8(U+Y);ue>=0&&ue<=127?pe=ue+1:ue>=-127&&ue<=-1?K=1-ue:Z=!0}else{var le=this.getUint8(U+Y);for(ie=0;ie<K;ie++){if(!M[te].hasBytesPerSample)throw RangeError(T.getError(6025));re=re<<8*ee|le,++ee===M[te].bytesPerSample&&(Q.push(re),re=ee=0,te++),te===I&&(E[H].push(Q),Q=[],te=0)}--pe==0&&(Z=!0)}W=1}}if(B.getContext){var ce=this.canvas.getContext("2d");ce.fillStyle="rgba(255, 255, 255, 0)";var _e=O.RowsPerStrip?O.RowsPerStrip.values[0]:P,oe=E.length,de=P%_e,me=de===0?_e:de,ye=_e,ge=0,we=O.PhotometricInterpretation.values[0],Te=[],Ee=0;if(O.ExtraSamples&&(Ee=(Te=O.ExtraSamples.values).length),O.ColorMap)var De=O.ColorMap.values,fe=Math.pow(2,M[0].bitsPerSample);for(H=0;H<oe;H++){H+1===oe&&(ye=me);for(var Ce=E[H].length,Se=ge*H,be=0,Re=0;Re<Ce;be++)for(var Ve=0;Ve<R;Ve++,Re++){var Pe=E[H][Re],ke=0,Ne=0,Ae=0,Oe=1;if(Ee>0){for(var Fe=0;Fe<Ee;Fe++)if(Te[Fe]===1||Te[Fe]===2){Oe=Pe[3+Fe]/256;break}}switch(we){case 0:if(M[0].hasBytesPerSample)var nt=Math.pow(16,2*M[0].bytesPerSample);Pe.forEach(function(Xe,$e,ot){ot[$e]=nt-Xe});case 1:ke=Ne=Ae=this.clampColorSample(Pe[0],M[0].bitsPerSample);break;case 2:ke=this.clampColorSample(Pe[0],M[0].bitsPerSample),Ne=this.clampColorSample(Pe[1],M[1].bitsPerSample),Ae=this.clampColorSample(Pe[2],M[2].bitsPerSample);break;case 3:if(De===void 0)throw Error(T.getError(6027));var Ze=Pe[0];ke=this.clampColorSample(De[Ze],16),Ne=this.clampColorSample(De[fe+Ze],16),Ae=this.clampColorSample(De[2*fe+Ze],16);break;default:throw RangeError(T.getError(6028,we))}ce.fillStyle="rgba("+ke+", "+Ne+", "+Ae+", "+Oe+")",ce.fillRect(Ve,Se+be,1,1)}ge=ye}}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}};S.exports=_},{"../core/CCDebug":26}],304:[function(L){L("./CCParticleAsset"),L("./CCParticleSystem"),L("./particle-simulator"),L("./particle-system-assembler")},{"./CCParticleAsset":301,"./CCParticleSystem":302,"./particle-simulator":305,"./particle-system-assembler":306}],305:[function(L,S){var T=L("../core/platform/js"),_=L("../core/utils/misc"),w=cc.v2(0,0),B=cc.v2(),A=cc.v2(),O=cc.v2(),R=cc.v2(),P=function(){this.pos=cc.v2(0,0),this.startPos=cc.v2(0,0),this.color=cc.color(0,0,0,255),this.deltaColor={r:0,g:0,b:0,a:255},this.preciseColor={r:0,g:0,b:0,a:255},this.size=0,this.deltaSize=0,this.rotation=0,this.deltaRotation=0,this.timeToLive=0,this.drawPos=cc.v2(0,0),this.aspectRatio=1,this.dir=cc.v2(0,0),this.radialAccel=0,this.tangentialAccel=0,this.angle=0,this.degreesPerSecond=0,this.radius=0,this.deltaRadius=0},E=new T.Pool(function(M){M.pos.set(w),M.startPos.set(w),M.color._val=4278190080,M.deltaColor.r=M.deltaColor.g=M.deltaColor.b=0,M.deltaColor.a=255,M.size=0,M.deltaSize=0,M.rotation=0,M.deltaRotation=0,M.timeToLive=0,M.drawPos.set(w),M.aspectRatio=1,M.dir.set(w),M.radialAccel=0,M.tangentialAccel=0,M.angle=0,M.degreesPerSecond=0,M.radius=0,M.deltaRadius=0},1024);E.get=function(){return this._get()||new P};var D=function(M){this.sys=M,this.particles=[],this.active=!1,this.readyToPlay=!0,this.finished=!1,this.elapsed=0,this.emitCounter=0,this._uvFilled=0,this._worldRotation=0};function I(M){for(var N=0,k=M;k;)N+=k.angle,k=k.parent;return N}D.prototype.stop=function(){this.active=!1,this.readyToPlay=!1,this.elapsed=this.sys.duration,this.emitCounter=0},D.prototype.reset=function(){this.active=!0,this.readyToPlay=!0,this.elapsed=0,this.emitCounter=0,this.finished=!1;for(var M=this.particles,N=0;N<M.length;++N)E.put(M[N]);M.length=0;var k=this.sys._assembler;k&&k._ia&&(k._ia._count=0)},D.prototype.emitParticle=function(M){var N=this.sys,k=_.clampf,F=E.get();this.particles.push(F),F.timeToLive=N.life+N.lifeVar*(Math.random()-.5)*2;var G,V,j,H,U=F.timeToLive=Math.max(0,F.timeToLive);F.pos.x=N.sourcePos.x+N.posVar.x*(Math.random()-.5)*2,F.pos.y=N.sourcePos.y+N.posVar.y*(Math.random()-.5)*2;var X=N._startColor,Y=N._startColorVar,z=N._endColor,W=N._endColorVar;F.color.r=G=k(X.r+Y.r*(Math.random()-.5)*2,0,255),F.color.g=V=k(X.g+Y.g*(Math.random()-.5)*2,0,255),F.color.b=j=k(X.b+Y.b*(Math.random()-.5)*2,0,255),F.color.a=H=k(X.a+Y.a*(Math.random()-.5)*2,0,255);var Z=F.color,Q=F.preciseColor;Q.r=Z.r,Q.g=Z.g,Q.b=Z.b,Q.a=Z.a,F.deltaColor.r=(k(z.r+W.r*(Math.random()-.5)*2,0,255)-G)/U,F.deltaColor.g=(k(z.g+W.g*(Math.random()-.5)*2,0,255)-V)/U,F.deltaColor.b=(k(z.b+W.b*(Math.random()-.5)*2,0,255)-j)/U,F.deltaColor.a=(k(z.a+W.a*(Math.random()-.5)*2,0,255)-H)/U;var ee=N.startSize+N.startSizeVar*(Math.random()-.5)*2;if(ee=Math.max(0,ee),F.size=ee,N.endSize===cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE)F.deltaSize=0;else{var te=N.endSize+N.endSizeVar*(Math.random()-.5)*2;te=Math.max(0,te),F.deltaSize=(te-ee)/U}var re=N.startSpin+N.startSpinVar*(Math.random()-.5)*2,ie=N.endSpin+N.endSpinVar*(Math.random()-.5)*2;F.rotation=re,F.deltaRotation=(ie-re)/U,F.startPos.x=M.x,F.startPos.y=M.y,F.aspectRatio=N._aspectRatio||1;var ne=_.degreesToRadians(N.angle+this._worldRotation+N.angleVar*(Math.random()-.5)*2);if(N.emitterMode===cc.ParticleSystem.EmitterMode.GRAVITY){var he=N.speed+N.speedVar*(Math.random()-.5)*2;F.dir.x=Math.cos(ne),F.dir.y=Math.sin(ne),F.dir.mulSelf(he),F.radialAccel=N.radialAccel+N.radialAccelVar*(Math.random()-.5)*2,F.tangentialAccel=N.tangentialAccel+N.tangentialAccelVar*(Math.random()-.5)*2,N.rotationIsDir&&(F.rotation=-_.radiansToDegrees(Math.atan2(F.dir.y,F.dir.x)))}else{var pe=N.startRadius+N.startRadiusVar*(Math.random()-.5)*2,K=N.endRadius+N.endRadiusVar*(Math.random()-.5)*2;F.radius=pe,F.deltaRadius=N.endRadius===cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(K-pe)/U,F.angle=ne,F.degreesPerSecond=_.degreesToRadians(N.rotatePerS+N.rotatePerSVar*(Math.random()-.5)*2)}},D.prototype.updateUVs=function(M){var N=this.sys._assembler;if(N){var k=N.getBuffer();if(k&&this.sys._renderSpriteFrame){for(var F=4*N._vfmt._bytes/4,G=k._vData,V=this.sys._renderSpriteFrame.uv,j=M?0:this._uvFilled,H=this.particles.length,U=j;U<H;U++){var X=U*F;G[X+2]=V[0],G[X+3]=V[1],G[X+7]=V[2],G[X+8]=V[3],G[X+12]=V[4],G[X+13]=V[5],G[X+17]=V[6],G[X+18]=V[7]}this._uvFilled=H}}},D.prototype.updateParticleBuffer=function(M,N,k,F){var G=k._vData,V=k._uintVData,j=N.x,H=N.y,U=M.size,X=U,Y=M.aspectRatio;Y>1?X=U/Y:U=X*Y;var z=U/2,W=X/2;if(M.rotation){var Z=-z,Q=-W,ee=z,te=W,re=-_.degreesToRadians(M.rotation),ie=Math.cos(re),ne=Math.sin(re);G[F]=Z*ie-Q*ne+j,G[F+1]=Z*ne+Q*ie+H,G[F+5]=ee*ie-Q*ne+j,G[F+6]=ee*ne+Q*ie+H,G[F+10]=Z*ie-te*ne+j,G[F+11]=Z*ne+te*ie+H,G[F+15]=ee*ie-te*ne+j,G[F+16]=ee*ne+te*ie+H}else G[F]=j-z,G[F+1]=H-W,G[F+5]=j+z,G[F+6]=H-W,G[F+10]=j-z,G[F+11]=H+W,G[F+15]=j+z,G[F+16]=H+W;V[F+4]=M.color._val,V[F+9]=M.color._val,V[F+14]=M.color._val,V[F+19]=M.color._val},D.prototype.step=function(M){M=M>cc.director._maxParticleDeltaTime?cc.director._maxParticleDeltaTime:M;var N=this.sys,k=N.node,F=this.particles,G=4*this.sys._assembler._vfmt._bytes/4,V=cc.ParticleSystem.PositionType;if(k._updateWorldMatrix(),N.positionType===V.FREE){this._worldRotation=I(k);var j=k._worldMatrix.m;B.x=j[12],B.y=j[13]}else N.positionType===V.RELATIVE?(this._worldRotation=k.angle,B.x=k.x,B.y=k.y):this._worldRotation=0;if(this.active&&N.emissionRate){var H=1/N.emissionRate;for(F.length<N.totalParticles&&(this.emitCounter+=M);F.length<N.totalParticles&&this.emitCounter>H;)this.emitParticle(B),this.emitCounter-=H;this.elapsed+=M,N.duration!==-1&&N.duration<this.elapsed&&N.stopSystem()}var U=N._assembler.getBuffer(),X=F.length;U.reset(),U.request(4*X,6*X),X>this._uvFilled&&this.updateUVs();for(var Y=0;Y<F.length;){A.x=A.y=O.x=O.y=R.x=R.y=0;var z=F[Y];if(z.timeToLive-=M,z.timeToLive>0){if(N.emitterMode===cc.ParticleSystem.EmitterMode.GRAVITY){var W=R,Z=A,Q=O;(z.pos.x||z.pos.y)&&(Z.set(z.pos),Z.normalizeSelf()),Q.set(Z),Z.mulSelf(z.radialAccel);var ee=Q.x;Q.x=-Q.y,Q.y=ee,Q.mulSelf(z.tangentialAccel),W.set(Z),W.addSelf(Q),W.addSelf(N.gravity),W.mulSelf(M),z.dir.addSelf(W),W.set(z.dir),W.mulSelf(M),z.pos.addSelf(W)}else z.angle+=z.degreesPerSecond*M,z.radius+=z.deltaRadius*M,z.pos.x=-Math.cos(z.angle)*z.radius,z.pos.y=-Math.sin(z.angle)*z.radius;var te=z.preciseColor,re=z.deltaColor;te.r+=re.r*M,te.g+=re.g*M,te.b+=re.b*M,te.a+=re.a*M;var ie=z.color;ie.r=te.r,ie.g=te.g,ie.b=te.b,ie.a=te.a,z.size+=z.deltaSize*M,z.size<0&&(z.size=0),z.rotation+=z.deltaRotation*M;var ne=A;ne.set(z.pos),N.positionType!==V.GROUPED&&ne.addSelf(z.startPos);var he=G*Y;this.updateParticleBuffer(z,ne,U,he),++Y}else{var pe=F[Y];Y!==F.length-1&&(F[Y]=F[F.length-1]),E.put(pe),F.length--}}N._assembler._ia._count=6*F.length,F.length>0?U.uploadData():this.active||this.readyToPlay||(this.finished=!0,N._finishedSimulation())},S.exports=D},{"../core/platform/js":217,"../core/utils/misc":271}],306:[function(L,S){var T=w(L("../core/renderer/assembler")),_=w(L("../renderer/core/input-assembler"));function w(D){return D&&D.__esModule?D:{default:D}}function B(D,I){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,N){return M.__proto__=N,M})(D,I)}var A=L("./CCParticleSystem"),O=L("../core/renderer/"),R=L("../core/renderer/webgl/quad-buffer"),P=L("../core/renderer/webgl/vertex-format").vfmtPosUvColor,E=function(D){var I,M;function N(F){var G;return(G=D.call(this,F)||this)._buffer=null,G._ia=null,G._vfmt=P,G}M=D,(I=N).prototype=Object.create(M.prototype),I.prototype.constructor=I,B(I,M);var k=N.prototype;return k.getBuffer=function(){return this._buffer||(this._buffer=new R(O._handle,P),this._ia=new _.default,this._ia._vertexBuffer=this._buffer._vb,this._ia._indexBuffer=this._buffer._ib,this._ia._start=0,this._ia._count=0),this._buffer},k.fillBuffers=function(F,G){if(this._ia){var V=cc.ParticleSystem.PositionType;F.positionType===V.RELATIVE?G.node=F.node.parent:G.node=F.node,G.material=F._materials[0],G._flushIA(this._ia)}},N}(T.default);T.default.register(A,E),S.exports=E},{"../core/renderer/":227,"../core/renderer/assembler":224,"../core/renderer/webgl/quad-buffer":257,"../core/renderer/webgl/vertex-format":260,"../renderer/core/input-assembler":309,"./CCParticleSystem":302}],307:[function(L,S){var T,_,w,B,A,O,R,P,E,D,I,M,N,k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee,te,re,ie,ne,he,pe,K,ue,le,ce,_e,oe,de,me,ye;(function(fe){fe[fe.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",fe[fe.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",fe[fe.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",fe[fe.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",fe[fe.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",fe[fe.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",fe[fe.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",fe[fe.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",fe[fe.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",fe[fe.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",fe[fe.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",fe[fe.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",fe[fe.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL"})(T||(T={})),function(fe){fe[fe.UNKNOWN=0]="UNKNOWN",fe[fe.BUFFER=1]="BUFFER",fe[fe.TEXTURE=2]="TEXTURE",fe[fe.TEXTURE_VIEW=3]="TEXTURE_VIEW",fe[fe.RENDER_PASS=4]="RENDER_PASS",fe[fe.FRAMEBUFFER=5]="FRAMEBUFFER",fe[fe.SAMPLER=6]="SAMPLER",fe[fe.SHADER=7]="SHADER",fe[fe.PIPELINE_LAYOUT=8]="PIPELINE_LAYOUT",fe[fe.PIPELINE_STATE=9]="PIPELINE_STATE",fe[fe.BINDING_LAYOUT=10]="BINDING_LAYOUT",fe[fe.INPUT_ASSEMBLER=11]="INPUT_ASSEMBLER",fe[fe.COMMAND_ALLOCATOR=12]="COMMAND_ALLOCATOR",fe[fe.COMMAND_BUFFER=13]="COMMAND_BUFFER",fe[fe.QUEUE=14]="QUEUE",fe[fe.WINDOW=15]="WINDOW"}(_||(_={})),function(fe){fe[fe.UNREADY=0]="UNREADY",fe[fe.FAILED=1]="FAILED",fe[fe.SUCCESS=2]="SUCCESS"}(w||(w={})),function(fe){fe.ATTR_POSITION="a_position",fe.ATTR_NORMAL="a_normal",fe.ATTR_TANGENT="a_tangent",fe.ATTR_BITANGENT="a_bitangent",fe.ATTR_WEIGHTS="a_weights",fe.ATTR_JOINTS="a_joints",fe.ATTR_COLOR="a_color",fe.ATTR_COLOR1="a_color1",fe.ATTR_COLOR2="a_color2",fe.ATTR_TEX_COORD="a_texCoord",fe.ATTR_TEX_COORD1="a_texCoord1",fe.ATTR_TEX_COORD2="a_texCoord2",fe.ATTR_TEX_COORD3="a_texCoord3",fe.ATTR_TEX_COORD4="a_texCoord4",fe.ATTR_TEX_COORD5="a_texCoord5",fe.ATTR_TEX_COORD6="a_texCoord6",fe.ATTR_TEX_COORD7="a_texCoord7",fe.ATTR_TEX_COORD8="a_texCoord8"}(B||(B={})),function(fe){fe[fe.UNKNOWN=0]="UNKNOWN",fe[fe.BOOL=1]="BOOL",fe[fe.BOOL2=2]="BOOL2",fe[fe.BOOL3=3]="BOOL3",fe[fe.BOOL4=4]="BOOL4",fe[fe.INT=5]="INT",fe[fe.INT2=6]="INT2",fe[fe.INT3=7]="INT3",fe[fe.INT4=8]="INT4",fe[fe.UINT=9]="UINT",fe[fe.UINT2=10]="UINT2",fe[fe.UINT3=11]="UINT3",fe[fe.UINT4=12]="UINT4",fe[fe.FLOAT=13]="FLOAT",fe[fe.FLOAT2=14]="FLOAT2",fe[fe.FLOAT3=15]="FLOAT3",fe[fe.FLOAT4=16]="FLOAT4",fe[fe.COLOR4=17]="COLOR4",fe[fe.MAT2=18]="MAT2",fe[fe.MAT2X3=19]="MAT2X3",fe[fe.MAT2X4=20]="MAT2X4",fe[fe.MAT3X2=21]="MAT3X2",fe[fe.MAT3=22]="MAT3",fe[fe.MAT3X4=23]="MAT3X4",fe[fe.MAT4X2=24]="MAT4X2",fe[fe.MAT4X3=25]="MAT4X3",fe[fe.MAT4=26]="MAT4",fe[fe.SAMPLER1D=27]="SAMPLER1D",fe[fe.SAMPLER1D_ARRAY=28]="SAMPLER1D_ARRAY",fe[fe.SAMPLER2D=29]="SAMPLER2D",fe[fe.SAMPLER2D_ARRAY=30]="SAMPLER2D_ARRAY",fe[fe.SAMPLER3D=31]="SAMPLER3D",fe[fe.SAMPLER_CUBE=32]="SAMPLER_CUBE",fe[fe.COUNT=33]="COUNT"}(A||(A={})),function(fe){fe[fe.UNKNOWN=0]="UNKNOWN",fe[fe.A8=1]="A8",fe[fe.L8=2]="L8",fe[fe.LA8=3]="LA8",fe[fe.R8=4]="R8",fe[fe.R8SN=5]="R8SN",fe[fe.R8UI=6]="R8UI",fe[fe.R8I=7]="R8I",fe[fe.R16F=8]="R16F",fe[fe.R16UI=9]="R16UI",fe[fe.R16I=10]="R16I",fe[fe.R32F=11]="R32F",fe[fe.R32UI=12]="R32UI",fe[fe.R32I=13]="R32I",fe[fe.RG8=14]="RG8",fe[fe.RG8SN=15]="RG8SN",fe[fe.RG8UI=16]="RG8UI",fe[fe.RG8I=17]="RG8I",fe[fe.RG16F=18]="RG16F",fe[fe.RG16UI=19]="RG16UI",fe[fe.RG16I=20]="RG16I",fe[fe.RG32F=21]="RG32F",fe[fe.RG32UI=22]="RG32UI",fe[fe.RG32I=23]="RG32I",fe[fe.RGB8=24]="RGB8",fe[fe.SRGB8=25]="SRGB8",fe[fe.RGB8SN=26]="RGB8SN",fe[fe.RGB8UI=27]="RGB8UI",fe[fe.RGB8I=28]="RGB8I",fe[fe.RGB16F=29]="RGB16F",fe[fe.RGB16UI=30]="RGB16UI",fe[fe.RGB16I=31]="RGB16I",fe[fe.RGB32F=32]="RGB32F",fe[fe.RGB32UI=33]="RGB32UI",fe[fe.RGB32I=34]="RGB32I",fe[fe.RGBA8=35]="RGBA8",fe[fe.SRGB8_A8=36]="SRGB8_A8",fe[fe.RGBA8SN=37]="RGBA8SN",fe[fe.RGBA8UI=38]="RGBA8UI",fe[fe.RGBA8I=39]="RGBA8I",fe[fe.RGBA16F=40]="RGBA16F",fe[fe.RGBA16UI=41]="RGBA16UI",fe[fe.RGBA16I=42]="RGBA16I",fe[fe.RGBA32F=43]="RGBA32F",fe[fe.RGBA32UI=44]="RGBA32UI",fe[fe.RGBA32I=45]="RGBA32I",fe[fe.R5G6B5=46]="R5G6B5",fe[fe.R11G11B10F=47]="R11G11B10F",fe[fe.RGB5A1=48]="RGB5A1",fe[fe.RGBA4=49]="RGBA4",fe[fe.RGB10A2=50]="RGB10A2",fe[fe.RGB10A2UI=51]="RGB10A2UI",fe[fe.RGB9E5=52]="RGB9E5",fe[fe.D16=53]="D16",fe[fe.D16S8=54]="D16S8",fe[fe.D24=55]="D24",fe[fe.D24S8=56]="D24S8",fe[fe.D32F=57]="D32F",fe[fe.D32F_S8=58]="D32F_S8",fe[fe.BC1=59]="BC1",fe[fe.BC1_ALPHA=60]="BC1_ALPHA",fe[fe.BC1_SRGB=61]="BC1_SRGB",fe[fe.BC1_SRGB_ALPHA=62]="BC1_SRGB_ALPHA",fe[fe.BC2=63]="BC2",fe[fe.BC2_SRGB=64]="BC2_SRGB",fe[fe.BC3=65]="BC3",fe[fe.BC3_SRGB=66]="BC3_SRGB",fe[fe.BC4=67]="BC4",fe[fe.BC4_SNORM=68]="BC4_SNORM",fe[fe.BC5=69]="BC5",fe[fe.BC5_SNORM=70]="BC5_SNORM",fe[fe.BC6H_UF16=71]="BC6H_UF16",fe[fe.BC6H_SF16=72]="BC6H_SF16",fe[fe.BC7=73]="BC7",fe[fe.BC7_SRGB=74]="BC7_SRGB",fe[fe.ETC_RGB8=75]="ETC_RGB8",fe[fe.ETC2_RGB8=76]="ETC2_RGB8",fe[fe.ETC2_SRGB8=77]="ETC2_SRGB8",fe[fe.ETC2_RGB8_A1=78]="ETC2_RGB8_A1",fe[fe.ETC2_SRGB8_A1=79]="ETC2_SRGB8_A1",fe[fe.ETC2_RGBA8=80]="ETC2_RGBA8",fe[fe.ETC2_SRGB8_A8=81]="ETC2_SRGB8_A8",fe[fe.EAC_R11=82]="EAC_R11",fe[fe.EAC_R11SN=83]="EAC_R11SN",fe[fe.EAC_RG11=84]="EAC_RG11",fe[fe.EAC_RG11SN=85]="EAC_RG11SN",fe[fe.PVRTC_RGB2=86]="PVRTC_RGB2",fe[fe.PVRTC_RGBA2=87]="PVRTC_RGBA2",fe[fe.PVRTC_RGB4=88]="PVRTC_RGB4",fe[fe.PVRTC_RGBA4=89]="PVRTC_RGBA4",fe[fe.PVRTC2_2BPP=90]="PVRTC2_2BPP",fe[fe.PVRTC2_4BPP=91]="PVRTC2_4BPP",fe[fe.ASTC_RGBA_4x4=92]="ASTC_RGBA_4x4",fe[fe.ASTC_RGBA_5x4=92]="ASTC_RGBA_5x4",fe[fe.ASTC_RGBA_5x5=92]="ASTC_RGBA_5x5",fe[fe.ASTC_RGBA_6x5=92]="ASTC_RGBA_6x5",fe[fe.ASTC_RGBA_6x6=92]="ASTC_RGBA_6x6",fe[fe.ASTC_RGBA_8x5=92]="ASTC_RGBA_8x5",fe[fe.ASTC_RGBA_8x6=92]="ASTC_RGBA_8x6",fe[fe.ASTC_RGBA_8x8=92]="ASTC_RGBA_8x8",fe[fe.ASTC_RGBA_10x5=92]="ASTC_RGBA_10x5",fe[fe.ASTC_RGBA_10x6=92]="ASTC_RGBA_10x6",fe[fe.ASTC_RGBA_10x8=92]="ASTC_RGBA_10x8",fe[fe.ASTC_RGBA_10x10=92]="ASTC_RGBA_10x10",fe[fe.ASTC_RGBA_12x10=92]="ASTC_RGBA_12x10",fe[fe.ASTC_RGBA_12x12=92]="ASTC_RGBA_12x12",fe[fe.ASTC_SRGBA_4x4=92]="ASTC_SRGBA_4x4",fe[fe.ASTC_SRGBA_5x4=92]="ASTC_SRGBA_5x4",fe[fe.ASTC_SRGBA_5x5=92]="ASTC_SRGBA_5x5",fe[fe.ASTC_SRGBA_6x5=92]="ASTC_SRGBA_6x5",fe[fe.ASTC_SRGBA_6x6=92]="ASTC_SRGBA_6x6",fe[fe.ASTC_SRGBA_8x5=92]="ASTC_SRGBA_8x5",fe[fe.ASTC_SRGBA_8x6=92]="ASTC_SRGBA_8x6",fe[fe.ASTC_SRGBA_8x8=92]="ASTC_SRGBA_8x8",fe[fe.ASTC_SRGBA_10x5=92]="ASTC_SRGBA_10x5",fe[fe.ASTC_SRGBA_10x6=92]="ASTC_SRGBA_10x6",fe[fe.ASTC_SRGBA_10x8=92]="ASTC_SRGBA_10x8",fe[fe.ASTC_SRGBA_10x10=92]="ASTC_SRGBA_10x10",fe[fe.ASTC_SRGBA_12x10=92]="ASTC_SRGBA_12x10",fe[fe.ASTC_SRGBA_12x12=92]="ASTC_SRGBA_12x12"}(O||(O={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.TRANSFER_SRC=1]="TRANSFER_SRC",fe[fe.TRANSFER_DST=2]="TRANSFER_DST",fe[fe.INDEX=4]="INDEX",fe[fe.VERTEX=8]="VERTEX",fe[fe.UNIFORM=16]="UNIFORM",fe[fe.STORAGE=32]="STORAGE",fe[fe.INDIRECT=64]="INDIRECT"}(R||(R={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.DEVICE=1]="DEVICE",fe[fe.HOST=2]="HOST"}(P||(P={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.READ=1]="READ",fe[fe.WRITE=2]="WRITE"}(E||(E={})),function(fe){fe[fe.POINT_LIST=0]="POINT_LIST",fe[fe.LINE_LIST=1]="LINE_LIST",fe[fe.LINE_STRIP=2]="LINE_STRIP",fe[fe.LINE_LOOP=3]="LINE_LOOP",fe[fe.LINE_LIST_ADJACENCY=4]="LINE_LIST_ADJACENCY",fe[fe.LINE_STRIP_ADJACENCY=5]="LINE_STRIP_ADJACENCY",fe[fe.ISO_LINE_LIST=6]="ISO_LINE_LIST",fe[fe.TRIANGLE_LIST=7]="TRIANGLE_LIST",fe[fe.TRIANGLE_STRIP=8]="TRIANGLE_STRIP",fe[fe.TRIANGLE_FAN=9]="TRIANGLE_FAN",fe[fe.TRIANGLE_LIST_ADJACENCY=10]="TRIANGLE_LIST_ADJACENCY",fe[fe.TRIANGLE_STRIP_ADJACENCY=11]="TRIANGLE_STRIP_ADJACENCY",fe[fe.TRIANGLE_PATCH_ADJACENCY=12]="TRIANGLE_PATCH_ADJACENCY",fe[fe.QUAD_PATCH_LIST=13]="QUAD_PATCH_LIST"}(D||(D={})),function(fe){fe[fe.FILL=0]="FILL",fe[fe.POINT=1]="POINT",fe[fe.LINE=2]="LINE"}(I||(I={})),function(fe){fe[fe.GOURAND=0]="GOURAND",fe[fe.FLAT=1]="FLAT"}(M||(M={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.FRONT=1]="FRONT",fe[fe.BACK=2]="BACK"}(N||(N={})),function(fe){fe[fe.NEVER=0]="NEVER",fe[fe.LESS=1]="LESS",fe[fe.EQUAL=2]="EQUAL",fe[fe.LESS_EQUAL=3]="LESS_EQUAL",fe[fe.GREATER=4]="GREATER",fe[fe.NOT_EQUAL=5]="NOT_EQUAL",fe[fe.GREATER_EQUAL=6]="GREATER_EQUAL",fe[fe.ALWAYS=7]="ALWAYS"}(k||(k={})),function(fe){fe[fe.ZERO=0]="ZERO",fe[fe.KEEP=1]="KEEP",fe[fe.REPLACE=2]="REPLACE",fe[fe.INCR=3]="INCR",fe[fe.DECR=4]="DECR",fe[fe.INVERT=5]="INVERT",fe[fe.INCR_WRAP=6]="INCR_WRAP",fe[fe.DECR_WRAP=7]="DECR_WRAP"}(F||(F={})),function(fe){fe[fe.ADD=0]="ADD",fe[fe.SUB=1]="SUB",fe[fe.REV_SUB=2]="REV_SUB",fe[fe.MIN=3]="MIN",fe[fe.MAX=4]="MAX"}(G||(G={})),function(fe){fe[fe.ZERO=0]="ZERO",fe[fe.ONE=1]="ONE",fe[fe.SRC_ALPHA=2]="SRC_ALPHA",fe[fe.DST_ALPHA=3]="DST_ALPHA",fe[fe.ONE_MINUS_SRC_ALPHA=4]="ONE_MINUS_SRC_ALPHA",fe[fe.ONE_MINUS_DST_ALPHA=5]="ONE_MINUS_DST_ALPHA",fe[fe.SRC_COLOR=6]="SRC_COLOR",fe[fe.DST_COLOR=7]="DST_COLOR",fe[fe.ONE_MINUS_SRC_COLOR=8]="ONE_MINUS_SRC_COLOR",fe[fe.ONE_MINUS_DST_COLOR=9]="ONE_MINUS_DST_COLOR",fe[fe.SRC_ALPHA_SATURATE=10]="SRC_ALPHA_SATURATE",fe[fe.CONSTANT_COLOR=11]="CONSTANT_COLOR",fe[fe.ONE_MINUS_CONSTANT_COLOR=12]="ONE_MINUS_CONSTANT_COLOR",fe[fe.CONSTANT_ALPHA=13]="CONSTANT_ALPHA",fe[fe.ONE_MINUS_CONSTANT_ALPHA=14]="ONE_MINUS_CONSTANT_ALPHA"}(V||(V={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.R=1]="R",fe[fe.G=2]="G",fe[fe.B=4]="B",fe[fe.A=8]="A",fe[fe.ALL=15]="ALL"}(j||(j={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.POINT=1]="POINT",fe[fe.LINEAR=2]="LINEAR",fe[fe.ANISOTROPIC=3]="ANISOTROPIC"}(H||(H={})),function(fe){fe[fe.WRAP=0]="WRAP",fe[fe.MIRROR=1]="MIRROR",fe[fe.CLAMP=2]="CLAMP",fe[fe.BORDER=3]="BORDER"}(U||(U={})),function(fe){fe[fe.TEX1D=0]="TEX1D",fe[fe.TEX2D=1]="TEX2D",fe[fe.TEX3D=2]="TEX3D"}(X||(X={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.TRANSFER_SRC=1]="TRANSFER_SRC",fe[fe.TRANSFER_DST=2]="TRANSFER_DST",fe[fe.SAMPLED=4]="SAMPLED",fe[fe.STORAGE=8]="STORAGE",fe[fe.COLOR_ATTACHMENT=16]="COLOR_ATTACHMENT",fe[fe.DEPTH_STENCIL_ATTACHMENT=32]="DEPTH_STENCIL_ATTACHMENT",fe[fe.TRANSIENT_ATTACHMENT=64]="TRANSIENT_ATTACHMENT",fe[fe.INPUT_ATTACHMENT=128]="INPUT_ATTACHMENT"}(Y||(Y={})),function(fe){fe[fe.X1=0]="X1",fe[fe.X2=1]="X2",fe[fe.X4=2]="X4",fe[fe.X8=3]="X8",fe[fe.X16=4]="X16",fe[fe.X32=5]="X32",fe[fe.X64=6]="X64"}(z||(z={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.GEN_MIPMAP=1]="GEN_MIPMAP",fe[fe.CUBEMAP=2]="CUBEMAP",fe[fe.BAKUP_BUFFER=4]="BAKUP_BUFFER"}(W||(W={})),function(fe){fe[fe.TV1D=0]="TV1D",fe[fe.TV2D=1]="TV2D",fe[fe.TV3D=2]="TV3D",fe[fe.CUBE=3]="CUBE",fe[fe.TV1D_ARRAY=4]="TV1D_ARRAY",fe[fe.TV2D_ARRAY=5]="TV2D_ARRAY"}(Z||(Z={})),function(fe){fe[fe.VERTEX=0]="VERTEX",fe[fe.HULL=1]="HULL",fe[fe.DOMAIN=2]="DOMAIN",fe[fe.GEOMETRY=3]="GEOMETRY",fe[fe.FRAGMENT=4]="FRAGMENT",fe[fe.COMPUTE=5]="COMPUTE",fe[fe.COUNT=6]="COUNT"}(Q||(Q={})),function(fe){fe[fe.UNKNOWN=0]="UNKNOWN",fe[fe.UNIFORM_BUFFER=1]="UNIFORM_BUFFER",fe[fe.SAMPLER=2]="SAMPLER",fe[fe.STORAGE_BUFFER=3]="STORAGE_BUFFER"}(ee||(ee={})),function(fe){fe[fe.PRIMARY=0]="PRIMARY",fe[fe.SECONDARY=1]="SECONDARY"}(te||(te={})),function(fe){fe[fe.LOAD=0]="LOAD",fe[fe.CLEAR=1]="CLEAR",fe[fe.DISCARD=2]="DISCARD"}(re||(re={})),function(fe){fe[fe.STORE=0]="STORE",fe[fe.DISCARD=1]="DISCARD"}(ie||(ie={})),function(fe){fe[fe.UNDEFINED=0]="UNDEFINED",fe[fe.GENERAL=1]="GENERAL",fe[fe.COLOR_ATTACHMENT_OPTIMAL=2]="COLOR_ATTACHMENT_OPTIMAL",fe[fe.DEPTH_STENCIL_ATTACHMENT_OPTIMAL=3]="DEPTH_STENCIL_ATTACHMENT_OPTIMAL",fe[fe.DEPTH_STENCIL_READONLY_OPTIMAL=4]="DEPTH_STENCIL_READONLY_OPTIMAL",fe[fe.SHADER_READONLY_OPTIMAL=5]="SHADER_READONLY_OPTIMAL",fe[fe.TRANSFER_SRC_OPTIMAL=6]="TRANSFER_SRC_OPTIMAL",fe[fe.TRANSFER_DST_OPTIMAL=7]="TRANSFER_DST_OPTIMAL",fe[fe.PREINITIALIZED=8]="PREINITIALIZED",fe[fe.PRESENT_SRC=9]="PRESENT_SRC"}(ne||(ne={})),function(fe){fe[fe.GRAPHICS=0]="GRAPHICS",fe[fe.COMPUTE=1]="COMPUTE",fe[fe.RAY_TRACING=2]="RAY_TRACING"}(he||(he={})),function(fe){fe[fe.VIEWPORT=0]="VIEWPORT",fe[fe.SCISSOR=1]="SCISSOR",fe[fe.LINE_WIDTH=2]="LINE_WIDTH",fe[fe.DEPTH_BIAS=3]="DEPTH_BIAS",fe[fe.BLEND_CONSTANTS=4]="BLEND_CONSTANTS",fe[fe.DEPTH_BOUNDS=5]="DEPTH_BOUNDS",fe[fe.STENCIL_WRITE_MASK=6]="STENCIL_WRITE_MASK",fe[fe.STENCIL_COMPARE_MASK=7]="STENCIL_COMPARE_MASK"}(pe||(pe={})),function(fe){fe[fe.FRONT=0]="FRONT",fe[fe.BACK=1]="BACK",fe[fe.ALL=2]="ALL"}(K||(K={})),function(fe){fe[fe.GRAPHICS=0]="GRAPHICS",fe[fe.COMPUTE=1]="COMPUTE",fe[fe.TRANSFER=2]="TRANSFER"}(ue||(ue={})),function(fe){fe[fe.NONE=0]="NONE",fe[fe.COLOR=1]="COLOR",fe[fe.DEPTH=2]="DEPTH",fe[fe.STENCIL=4]="STENCIL",fe[fe.DEPTH_STENCIL=6]="DEPTH_STENCIL",fe[fe.ALL=7]="ALL"}(le||(le={})),function(fe){fe[fe.DEFAULT=100]="DEFAULT"}(ce||(ce={})),function(fe){fe[fe.MIN=0]="MIN",fe[fe.MAX=255]="MAX",fe[fe.DEFAULT=128]="DEFAULT"}(_e||(_e={})),function(fe){fe[fe.UBO_GLOBAL=23]="UBO_GLOBAL",fe[fe.UBO_SHADOW=22]="UBO_SHADOW",fe[fe.UBO_LOCAL=21]="UBO_LOCAL",fe[fe.UBO_FORWARD_LIGHTS=20]="UBO_FORWARD_LIGHTS",fe[fe.UBO_SKINNING=19]="UBO_SKINNING",fe[fe.UBO_SKINNING_TEXTURE=18]="UBO_SKINNING_TEXTURE",fe[fe.UBO_UI=17]="UBO_UI",fe[fe.SAMPLER_JOINTS=25]="SAMPLER_JOINTS",fe[fe.SAMPLER_ENVIRONMENT=26]="SAMPLER_ENVIRONMENT",fe[fe.CUSTUM_UBO_BINDING_END_POINT=17]="CUSTUM_UBO_BINDING_END_POINT",fe[fe.CUSTOM_SAMPLER_BINDING_START_POINT=30]="CUSTOM_SAMPLER_BINDING_START_POINT"}(oe||(oe={})),function(fe){fe[fe.minFilter=0]="minFilter",fe[fe.magFilter=1]="magFilter",fe[fe.mipFilter=2]="mipFilter",fe[fe.addressU=3]="addressU",fe[fe.addressV=4]="addressV",fe[fe.addressW=5]="addressW",fe[fe.maxAnisotropy=6]="maxAnisotropy",fe[fe.cmpFunc=7]="cmpFunc",fe[fe.minLOD=8]="minLOD",fe[fe.maxLOD=9]="maxLOD",fe[fe.mipLODBias=10]="mipLODBias",fe[fe.borderColor=11]="borderColor",fe[fe.total=15]="total"}(ye||(ye={}));var ge={};ge[ge.bool=A.BOOL]="bool",ge[ge.int=A.INT]="int",ge[ge.ivec2=A.INT2]="ivec2invTypeParams",ge[ge.ivec3=A.INT3]="ivec3",ge[ge.ivec4=A.INT4]="ivec4",ge[ge.float=A.FLOAT]="float",ge[ge.vec2=A.FLOAT2]="vec2",ge[ge.vec3=A.FLOAT3]="vec3",ge[ge.vec4=A.FLOAT4]="vec4",ge[ge.mat2=A.MAT2]="mat2",ge[ge.mat3=A.MAT3]="mat3",ge[ge.mat4=A.MAT4]="mat4",ge[ge.sampler2D=A.SAMPLER2D]="sampler2D",ge[ge.samplerCube=A.SAMPLER_CUBE]="samplerCube";var we=((de={})[A.BOOL]=4,de[A.INT]=4,de[A.INT2]=8,de[A.INT3]=12,de[A.INT4]=16,de[A.FLOAT]=4,de[A.FLOAT2]=8,de[A.FLOAT3]=12,de[A.FLOAT4]=16,de[A.MAT2]=16,de[A.MAT3]=36,de[A.MAT4]=64,de[A.SAMPLER2D]=4,de[A.SAMPLER_CUBE]=4,de),Te=((me={})[A.BOOL]=O.R32I,me[A.INT]=O.R32I,me[A.INT2]=O.RG32I,me[A.INT3]=O.RGB32I,me[A.INT4]=O.RGBA32I,me[A.FLOAT]=O.R32F,me[A.FLOAT2]=O.RG32F,me[A.FLOAT3]=O.RGB32F,me[A.FLOAT4]=O.RGBA32F,me),Ee={BACK:1029,FRONT:1028,NONE:0,ADD:32774,SUB:32778,REV_SUB:32779,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,SRC_ALPHA_SATURATE:776,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,INCR_WRAP:34055,DECR:7683,DECR_WRAP:34056,INVERT:5386};Object.assign(Ee,ce);var De={murmurhash2_32_gc:function(fe,Ce){for(var Se,be=fe.length,Re=Ce^be,Ve=0;be>=4;)Se=1540483477*(65535&(Se=255&fe.charCodeAt(Ve)|(255&fe.charCodeAt(++Ve))<<8|(255&fe.charCodeAt(++Ve))<<16|(255&fe.charCodeAt(++Ve))<<24))+((1540483477*(Se>>>16)&65535)<<16),Re=1540483477*(65535&Re)+((1540483477*(Re>>>16)&65535)<<16)^(Se=1540483477*(65535&(Se^=Se>>>24))+((1540483477*(Se>>>16)&65535)<<16)),be-=4,++Ve;switch(be){case 3:Re^=(255&fe.charCodeAt(Ve+2))<<16;case 2:Re^=(255&fe.charCodeAt(Ve+1))<<8;case 1:Re=1540483477*(65535&(Re^=255&fe.charCodeAt(Ve)))+((1540483477*(Re>>>16)&65535)<<16)}return Re=1540483477*(65535&(Re^=Re>>>13))+((1540483477*(Re>>>16)&65535)<<16),(Re^=Re>>>15)>>>0},SamplerInfoIndex:ye,effectStructure:{$techniques:[{$passes:[{depthStencilState:{},rasterizerState:{},blendState:{targets:[{}]},properties:{any:{sampler:{},inspector:{}}}}]}]},typeMap:ge,sizeMap:we,formatMap:Te,passParams:Ee,RenderQueue:{OPAQUE:0,TRANSPARENT:1,OVERLAY:2},RenderPriority:_e,GFXGetTypeSize:function(fe){switch(fe){case A.BOOL:case A.INT:case A.UINT:case A.FLOAT:return 4;case A.BOOL2:case A.INT2:case A.UINT2:case A.FLOAT2:return 8;case A.BOOL3:case A.INT3:case A.UINT3:case A.FLOAT3:return 12;case A.BOOL4:case A.INT4:case A.UINT4:case A.FLOAT4:case A.MAT2:return 16;case A.MAT2X3:return 24;case A.MAT2X4:return 32;case A.MAT3X2:return 24;case A.MAT3:return 36;case A.MAT3X4:return 48;case A.MAT4X2:case A.MAT4X2:return 32;case A.MAT4:return 64;case A.SAMPLER1D:case A.SAMPLER1D_ARRAY:case A.SAMPLER2D:case A.SAMPLER2D_ARRAY:case A.SAMPLER3D:case A.SAMPLER_CUBE:return 4;default:return 0}},UniformBinding:oe};S.exports=De},{}],308:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("../memop"),w=P(L("../enums")),B=L("../../core/value-types"),A=P(L("./program-lib")),O=P(L("./view")),R=P(L("../gfx"));function P(Y){return Y&&Y.__esModule?Y:{default:Y}}var E=new B.Mat4,D=new _.RecyclePool(function(){return{stage:null,items:null}},8),I=new _.RecyclePool(function(){return new Float32Array(2)},8),M=new _.RecyclePool(function(){return new Float32Array(3)},8),N=new _.RecyclePool(function(){return new Float32Array(4)},8),k=new _.RecyclePool(function(){return new Float32Array(9)},8),F=new _.RecyclePool(function(){return new Float32Array(16)},8),G=new _.RecyclePool(function(){return new Float32Array(64)},8),V=new _.RecyclePool(function(){return new Int32Array(2)},8),j=new _.RecyclePool(function(){return new Int32Array(3)},8),H=new _.RecyclePool(function(){return new Int32Array(4)},8),U=new _.RecyclePool(function(){return new Int32Array(64)},8),X=function(){function Y(W,Z){var Q;this._device=W,this._programLib=new A.default(W),this._opts=Z,this._type2defaultValue=((Q={})[w.default.PARAM_INT]=0,Q[w.default.PARAM_INT2]=new B.Vec2(0,0),Q[w.default.PARAM_INT3]=new B.Vec3(0,0,0),Q[w.default.PARAM_INT4]=new B.Vec4(0,0,0,0),Q[w.default.PARAM_FLOAT]=0,Q[w.default.PARAM_FLOAT2]=new B.Vec2(0,0),Q[w.default.PARAM_FLOAT3]=new B.Vec3(0,0,0),Q[w.default.PARAM_FLOAT4]=new B.Vec4(0,0,0,0),Q[w.default.PARAM_COLOR4]=new B.Color(0,0,0,1),Q[w.default.PARAM_MAT3]=new B.Mat3,Q[w.default.PARAM_MAT4]=new B.Mat4,Q[w.default.PARAM_TEXTURE_2D]=Z.defaultTexture,Q[w.default.PARAM_TEXTURE_CUBE]=Z.defaultTextureCube,Q),this._stage2fn={},this._usedTextureUnits=0,this._viewPools=new _.RecyclePool(function(){return new O.default},8),this._drawItemsPools=new _.RecyclePool(function(){return{model:null,node:null,ia:null,effect:null,defines:null,uniforms:null}},100),this._stageItemsPools=new _.RecyclePool(function(){return new _.RecyclePool(function(){return{model:null,node:null,ia:null,effect:null,defines:null,passes:[],sortKey:-1,uniforms:null}},100)},16),this._definesChanged=!1}var z=Y.prototype;return z._resetTextuerUnit=function(){this._usedTextureUnits=0},z._allocTextureUnit=function(){var W=this._device,Z=this._usedTextureUnits;return Z>=W._caps.maxTextureUnits&&console.warn("Trying to use "+Z+" texture units while this GPU supports only "+W._caps.maxTextureUnits),this._usedTextureUnits+=1,Z},z._registerStage=function(W,Z){this._stage2fn[W]=Z},z.clear=function(){this._programLib.clear(),this.reset()},z.reset=function(){this._viewPools.reset(),this._stageItemsPools.reset(),this._definesChanged=!1},z._requestView=function(){return this._viewPools.add()},z._render=function(W,Z){var Q=this._device;Q.setFrameBuffer(W._framebuffer),Q.setViewport(W._rect.x,W._rect.y,W._rect.w,W._rect.h);var ee={};W._clearFlags&w.default.CLEAR_COLOR&&(ee.color=B.Vec4.toArray([],W._color)),W._clearFlags&w.default.CLEAR_DEPTH&&(ee.depth=W._depth),W._clearFlags&w.default.CLEAR_STENCIL&&(ee.stencil=W._stencil),Q.clear(ee),this._drawItemsPools.reset();for(var te=0;te<Z._models.length;++te){var re=Z._models.data[te];if((re._cullingMask&W._cullingMask)!=0){var ie=this._drawItemsPools.add();re.extractDrawItem(ie)}}D.reset();for(var ne=0;ne<W._stages.length;++ne){var he=W._stages[ne],pe=this._stageItemsPools.add();pe.reset();for(var K=0;K<this._drawItemsPools.length;++K){var ue=this._drawItemsPools.data[K],le=ue.effect.stagePasses[he];if(le&&le.length!==0){var ce=pe.add();ce.passes=le,ce.model=ue.model,ce.node=ue.node,ce.ia=ue.ia,ce.effect=ue.effect,ce.defines=ue.defines,ce.sortKey=-1,ce.uniforms=ue.uniforms}}var _e=D.add();_e.stage=he,_e.items=pe}for(var oe=0;oe<D.length;++oe){var de=D.data[oe];(0,this._stage2fn[de.stage])(W,de.items)}},z._setProperty=function(W){var Z=this._device,Q=W.value;if(Q===void 0&&(Q=W.val),Q===void 0&&(Q=this._type2defaultValue[W.type]),Q!==void 0)if(W.type===w.default.PARAM_TEXTURE_2D||W.type===w.default.PARAM_TEXTURE_CUBE)if(Array.isArray(Q)){if(Q.length>W.count)return void console.error("Failed to set property ["+W.name+"] : The length of texture array ["+Q.length+"] is bigger than ["+W.count+"].");for(var ee=U.add(),te=0;te<Q.length;++te)ee[te]=this._allocTextureUnit();Z.setTextureArray(W.name,Q,ee)}else Z.setTexture(W.name,Q,this._allocTextureUnit());else W.directly?Z.setUniformDirectly(W.name,Q):Z.setUniform(W.name,Q);else console.warn("Failed to set technique property "+W.name+", value not found.")},z._draw=function(W){var Z=this._device,Q=this._programLib,ee=W.node,te=W.ia,re=W.passes,ie=W.effect;I.reset(),M.reset(),N.reset(),k.reset(),F.reset(),G.reset(),V.reset(),j.reset(),H.reset(),U.reset(),ee.getWorldMatrix(E),Z.setUniform("cc_matWorld",B.Mat4.toArray(F.add(),E)),B.Mat4.invert(E,E),B.Mat4.transpose(E,E),Z.setUniform("cc_matWorldIT",B.Mat4.toArray(F.add(),E));for(var ne=this._defines,he=0;he<re.length;++he){var pe=re[he];this._definesChanged&&(pe._programKey=null);var K=te.count;te._vertexBuffer&&Z.setVertexBuffer(0,te._vertexBuffer),te._indexBuffer&&Z.setIndexBuffer(te._indexBuffer),Z.setPrimitiveType(te._primitiveType),Object.setPrototypeOf(ne,pe._defines);var ue=Q.getProgram(pe,ne,ie.name);Z.setProgram(ue);for(var le=ue._uniforms,ce=pe._properties,_e=0;_e<le.length;_e++){var oe=ce[le[_e].name];oe!==void 0&&this._setProperty(oe)}Z.setCullMode(pe._cullMode),pe._blend&&(Z.enableBlend(),Z.setBlendFuncSep(pe._blendSrc,pe._blendDst,pe._blendSrcAlpha,pe._blendDstAlpha),Z.setBlendEqSep(pe._blendEq,pe._blendAlphaEq),Z.setBlendColor32(pe._blendColor)),pe._depthTest&&(Z.enableDepthTest(),Z.setDepthFunc(pe._depthFunc)),pe._depthWrite&&Z.enableDepthWrite(),Z.setStencilTest(pe._stencilTest),pe._stencilTest===R.default.STENCIL_ENABLE&&(Z.setStencilFuncFront(pe._stencilFuncFront,pe._stencilRefFront,pe._stencilMaskFront),Z.setStencilOpFront(pe._stencilFailOpFront,pe._stencilZFailOpFront,pe._stencilZPassOpFront,pe._stencilWriteMaskFront),Z.setStencilFuncBack(pe._stencilFuncBack,pe._stencilRefBack,pe._stencilMaskBack),Z.setStencilOpBack(pe._stencilFailOpBack,pe._stencilZFailOpBack,pe._stencilZPassOpBack,pe._stencilWriteMaskBack)),Z.draw(te._start,K),this._resetTextuerUnit()}},Y}();T.default=X,S.exports=T.default},{"../../core/value-types":286,"../enums":314,"../gfx":319,"../memop":331,"./program-lib":311,"./view":313}],309:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../gfx"))&&_.__esModule?_:{default:_};function B(O,R){for(var P=0;P<R.length;P++){var E=R[P];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(O,E.key,E)}}var A=function(){function O(E,D,I){I===void 0&&(I=w.default.PT_TRIANGLES),this._vertexBuffer=E,this._indexBuffer=D,this._primitiveType=I,this._start=0,this._count=-1}var R,P;return R=O,(P=[{key:"count",get:function(){return this._count!==-1?this._count:this._indexBuffer?this._indexBuffer.count:this._vertexBuffer?this._vertexBuffer.count:0}}])&&B(R.prototype,P),Object.defineProperty(R,"prototype",{writable:!1}),O}();T.default=A,S.exports=T.default},{"../gfx":319}],310:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=A(L("../gfx")),w=A(L("../enums")),B=A(L("../../core/value-types/value-type"));function A(R){return R&&R.__esModule?R:{default:R}}var O=function(){function R(E,D,I,M,N,k){N===void 0&&(N={}),k===void 0&&(k={}),this._name=E,this._detailName=D,this._programName=I,this._programKey=null,this._stage=M,this._properties=N,this._defines=k,this._propertyNames=Object.keys(N),this._defineNames=Object.keys(k),this._cullMode=_.default.CULL_BACK,this._blend=!1,this._blendEq=_.default.BLEND_FUNC_ADD,this._blendAlphaEq=_.default.BLEND_FUNC_ADD,this._blendSrc=_.default.BLEND_SRC_ALPHA,this._blendDst=_.default.BLEND_ONE_MINUS_SRC_ALPHA,this._blendSrcAlpha=_.default.BLEND_SRC_ALPHA,this._blendDstAlpha=_.default.BLEND_ONE_MINUS_SRC_ALPHA,this._blendColor=4294967295,this._depthTest=!1,this._depthWrite=!1,this._depthFunc=_.default.DS_FUNC_LESS,this._stencilTest=_.default.STENCIL_INHERIT,this._stencilFuncFront=_.default.DS_FUNC_ALWAYS,this._stencilRefFront=0,this._stencilMaskFront=255,this._stencilFailOpFront=_.default.STENCIL_OP_KEEP,this._stencilZFailOpFront=_.default.STENCIL_OP_KEEP,this._stencilZPassOpFront=_.default.STENCIL_OP_KEEP,this._stencilWriteMaskFront=255,this._stencilFuncBack=_.default.DS_FUNC_ALWAYS,this._stencilRefBack=0,this._stencilMaskBack=255,this._stencilFailOpBack=_.default.STENCIL_OP_KEEP,this._stencilZFailOpBack=_.default.STENCIL_OP_KEEP,this._stencilZPassOpBack=_.default.STENCIL_OP_KEEP,this._stencilWriteMaskBack=255}var P=R.prototype;return P.setCullMode=function(E){E===void 0&&(E=_.default.CULL_BACK),this._cullMode=E},P.setBlend=function(E,D,I,M,N,k,F,G){E===void 0&&(E=!1),D===void 0&&(D=_.default.BLEND_FUNC_ADD),I===void 0&&(I=_.default.BLEND_SRC_ALPHA),M===void 0&&(M=_.default.BLEND_ONE_MINUS_SRC_ALPHA),N===void 0&&(N=_.default.BLEND_FUNC_ADD),k===void 0&&(k=_.default.BLEND_SRC_ALPHA),F===void 0&&(F=_.default.BLEND_ONE_MINUS_SRC_ALPHA),G===void 0&&(G=4294967295),this._blend=E,this._blendEq=D,this._blendSrc=I,this._blendDst=M,this._blendAlphaEq=N,this._blendSrcAlpha=k,this._blendDstAlpha=F,this._blendColor=G},P.setDepth=function(E,D,I){E===void 0&&(E=!1),D===void 0&&(D=!1),I===void 0&&(I=_.default.DS_FUNC_LESS),this._depthTest=E,this._depthWrite=D,this._depthFunc=I},P.setStencilFront=function(E,D,I,M,N,k,F,G){E===void 0&&(E=_.default.STENCIL_INHERIT),D===void 0&&(D=_.default.DS_FUNC_ALWAYS),I===void 0&&(I=0),M===void 0&&(M=255),N===void 0&&(N=_.default.STENCIL_OP_KEEP),k===void 0&&(k=_.default.STENCIL_OP_KEEP),F===void 0&&(F=_.default.STENCIL_OP_KEEP),G===void 0&&(G=255),this._stencilTest=E,this._stencilFuncFront=D,this._stencilRefFront=I,this._stencilMaskFront=M,this._stencilFailOpFront=N,this._stencilZFailOpFront=k,this._stencilZPassOpFront=F,this._stencilWriteMaskFront=G},P.setStencilEnabled=function(E){E===void 0&&(E=_.default.STENCIL_INHERIT),this._stencilTest=E},P.setStencilBack=function(E,D,I,M,N,k,F,G){E===void 0&&(E=_.default.STENCIL_INHERIT),D===void 0&&(D=_.default.DS_FUNC_ALWAYS),I===void 0&&(I=0),M===void 0&&(M=255),N===void 0&&(N=_.default.STENCIL_OP_KEEP),k===void 0&&(k=_.default.STENCIL_OP_KEEP),F===void 0&&(F=_.default.STENCIL_OP_KEEP),G===void 0&&(G=255),this._stencilTest=E,this._stencilFuncBack=D,this._stencilRefBack=I,this._stencilMaskBack=M,this._stencilFailOpBack=N,this._stencilZFailOpBack=k,this._stencilZPassOpBack=F,this._stencilWriteMaskBack=G},P.setStage=function(E){this._stage=E},P.setProperties=function(E){this._properties=E},P.getProperty=function(E){if(this._properties[E])return this._properties[E].value},P.setProperty=function(E,D,I){var M=this._properties[E];if(!M)return!1;if(M.directly=I,Array.isArray(D)){var N=M.value;if(N.length!==D.length)return void cc.warnID(9105,this._name,E);for(var k=0;k<D.length;k++)N[k]=D[k]}else D&&!ArrayBuffer.isView(D)?M.type===w.default.PARAM_TEXTURE_2D?M.value=D.getImpl():D instanceof B.default?D.constructor.toArray(M.value,D):(typeof D=="object"&&cc.warnID(9106,this._name,E),M.value=D):M.value=D;return!0},P.getDefine=function(E){return this._defines[E]},P.define=function(E,D,I){var M=this._defines[E];return!(!I&&M===void 0||(M!==D&&(this._defines[E]=D,this._programKey=null),0))},P.clone=function(){var E=new R(this._programName);Object.assign(E,this);var D={},I=this._properties;for(var M in I){var N=I[M],k=D[M]={},F=N.value;for(var G in Array.isArray(F)?k.value=F.concat():ArrayBuffer.isView(F)?k.value=new F.__proto__.constructor(F):k.value=F,N)G!=="value"&&(k[G]=N[G])}return E._properties=D,E._defines=Object.assign({},this._defines),E._propertyNames=this._propertyNames,E._defineNames=this._defineNames,E},R}();T.default=O,S.exports=T.default},{"../../core/value-types/value-type":294,"../enums":314,"../gfx":319}],311:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../gfx"))&&_.__esModule?_:{default:_},B=0;function A(D,I){for(var M=[],N=0;N<D.length;N++){var k=D[N].name,F=I[k];typeof F!="number"&&(F=F?1:0),M.push("#define "+k+" "+F)}return M.join("\n")+"\n"}function O(D,I,M){for(var N=D,k=0;k<I.length;k++){var F=I[k].name,G=M[F];if(Number.isInteger(G)){var V=new RegExp(F,"g");N=N.replace(V,G)}}return N}function R(D){return D.replace(/#pragma for (\w+) in range\(\s*(\d+)\s*,\s*(\d+)\s*\)([\s\S]+?)#pragma endFor/g,function(I,M,N,k,F){var G="",V=parseInt(N),j=parseInt(k);(V.isNaN||j.isNaN)&&console.error("Unroll For Loops Error: begin and end of range must be an int num.");for(var H=V;H<j;++H)G+=F.replace(new RegExp("{"+M+"}","g"),H);return G})}function P(D){return D.replace(/\bhighp\b/g,"mediump")}var E=function(){function D(M){this._device=M,this._templates={},this._cache={},this._checkPrecision()}var I=D.prototype;return I.clear=function(){this._templates={},this._cache={}},I.define=function(M){var N=M.name,k=M.defines,F=M.glsl1||M,G=F.vert,V=F.frag;if(!this._templates[N]){for(var j=++B,H=0,U=0;U<k.length;++U){var X=k[U],Y=1;if(X.type==="number"){var z=X.range||[];X.min=z[0]||0,X.max=z[1]||4,Y=Math.ceil(Math.log2(X.max-X.min)),X._map=(function(ie){return ie-this.min<<this._offset}).bind(X)}else X._map=(function(ie){return ie?1<<this._offset:0}).bind(X);X._offset=H,H+=Y}var W=M.uniforms||[];if(M.samplers)for(var Z=0;Z<M.samplers.length;Z++)W.push(M.samplers[Z]);if(M.blocks)for(var Q=0;Q<M.blocks.length;Q++)for(var ee=M.blocks[Q].defines,te=M.blocks[Q].members,re=0;re<te.length;re++)W.push({defines:ee,name:te[re].name,type:te[re].type});this._templates[N]={id:j,name:N,vert:G,frag:V,defines:k,attributes:M.attributes,uniforms:W,extensions:M.extensions}}},I.getTemplate=function(M){return this._templates[M]},I.hasProgram=function(M){return this._templates[M]!==void 0},I.getKey=function(M,N){for(var k=this._templates[M],F=0,G=0;G<k.defines.length;++G){var V=k.defines[G],j=N[V.name];j!==void 0&&(F|=V._map(j))}return k.id+":"+F},I.getProgram=function(M,N,k){var F=M._programKey=M._programKey||this.getKey(M._programName,N),G=this._cache[F];if(G)return G;var V=this._templates[M._programName],j=A(V.defines,N),H=O(V.vert,V.defines,N);H=j+R(H),this._highpSupported||(H=P(H));var U=O(V.frag,V.defines,N);U=j+R(U),this._highpSupported||(U=P(U));var X=(G=new w.default.Program(this._device,{vert:H,frag:U})).link();if(X){var Y=H.split("\n"),z=U.split("\n"),W=V.defines.length;X.forEach(function(Z){var Q=Z.line-1,ee=Z.line-W,te=(Z.type==="vs"?Y:z)[Q],re=Z.info||"Failed to compile "+Z.type+" "+Z.fileID+" (ln "+ee+"): \n "+Z.message+": \n  "+te;cc.error(k+" : "+re)})}return this._cache[F]=G,G},I._checkPrecision=function(){var M=this._device._gl,N=!1;if(M.getShaderPrecisionFormat){var k=M.getShaderPrecisionFormat(M.VERTEX_SHADER,M.HIGH_FLOAT),F=M.getShaderPrecisionFormat(M.FRAGMENT_SHADER,M.HIGH_FLOAT);N=k&&k.precision>0&&F&&F.precision>0}N||cc.warnID(9102),this._highpSupported=N},D}();T.default=E,S.exports=T.default},{"../gfx":319}],312:[function(L,S,T){function _(B,A){for(var O=0;O<A.length;O++){var R=A[O];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(B,R.key,R)}}T.__esModule=!0,T.default=void 0;var w=function(){function B(R,P){this._name=R,this._passes=P}var A,O;return B.prototype.clone=function(){for(var R=[],P=0;P<this._passes.length;P++)R.push(this._passes[P].clone());return new B(this._name,R)},A=B,(O=[{key:"name",get:function(){return this._name}},{key:"passes",get:function(){return this._passes}}])&&_(A.prototype,O),Object.defineProperty(A,"prototype",{writable:!1}),B}();T.default=w,S.exports=T.default},{}],313:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../../core/value-types"),B=(_=L("../enums"))&&_.__esModule?_:{default:_},A=new w.Mat4,O=0,R=function(){function P(){this._id=O++,this._priority=0,this._rect={x:0,y:0,w:1,h:1},this._color=new w.Vec4(.3,.3,.3,1),this._depth=1,this._stencil=0,this._clearFlags=B.default.CLEAR_COLOR|B.default.CLEAR_DEPTH,this._clearModel=null,this._matView=cc.mat4(),this._matViewInv=cc.mat4(),this._matProj=cc.mat4(),this._matViewProj=cc.mat4(),this._matInvViewProj=cc.mat4(),this._stages=[],this._cullingByID=!1,this._framebuffer=null,this._shadowLight=null,this._cullingMask=4294967295}var E=P.prototype;return E.getForward=function(D){var I=this._matView.m;return w.Vec3.set(D,-I[2],-I[6],-I[10])},E.getPosition=function(D){return w.Mat4.invert(A,this._matView),w.Mat4.getTranslation(D,A)},P}();T.default=R,S.exports=T.default},{"../../core/value-types":286,"../enums":314}],314:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("./build/mappings"),w={PROJ_PERSPECTIVE:0,PROJ_ORTHO:1,LIGHT_DIRECTIONAL:0,LIGHT_POINT:1,LIGHT_SPOT:2,LIGHT_AMBIENT:3,SHADOW_NONE:0,SHADOW_HARD:1,SHADOW_SOFT:2,PARAM_INT:_.typeMap.int,PARAM_INT2:_.typeMap.ivec2,PARAM_INT3:_.typeMap.ivec3,PARAM_INT4:_.typeMap.ivec4,PARAM_FLOAT:_.typeMap.float,PARAM_FLOAT2:_.typeMap.vec2,PARAM_FLOAT3:_.typeMap.vec3,PARAM_FLOAT4:_.typeMap.vec4,PARAM_MAT2:_.typeMap.mat2,PARAM_MAT3:_.typeMap.mat3,PARAM_MAT4:_.typeMap.mat4,PARAM_TEXTURE_2D:_.typeMap.sampler2D,PARAM_TEXTURE_CUBE:_.typeMap.samplerCube,CLEAR_COLOR:1,CLEAR_DEPTH:2,CLEAR_STENCIL:4,CLEAR_SKYBOX:8,BUFFER_VIEW_INT8:0,BUFFER_VIEW_UINT8:1,BUFFER_VIEW_INT16:2,BUFFER_VIEW_UINT16:3,BUFFER_VIEW_INT32:4,BUFFER_VIEW_UINT32:5,BUFFER_VIEW_FLOAT32:6};T.default=w,S.exports=T.default},{"./build/mappings":307}],315:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w,B=P(L("./state")),A=L("./enums"),O=P(L("./texture-2d")),R=P(L("./texture-cube"));function P(U){return U&&U.__esModule?U:{default:U}}function E(U,X){for(var Y=0;Y<X.length;Y++){var z=X[Y];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(U,z.key,z)}}var D=((_={})[5124]=function(U,X,Y){U.uniform1i(X,Y)},_[5126]=function(U,X,Y){U.uniform1f(X,Y)},_[35664]=function(U,X,Y){U.uniform2fv(X,Y)},_[35665]=function(U,X,Y){U.uniform3fv(X,Y)},_[35666]=function(U,X,Y){U.uniform4fv(X,Y)},_[35667]=function(U,X,Y){U.uniform2iv(X,Y)},_[35668]=function(U,X,Y){U.uniform3iv(X,Y)},_[35669]=function(U,X,Y){U.uniform4iv(X,Y)},_[35670]=function(U,X,Y){U.uniform1i(X,Y)},_[35671]=function(U,X,Y){U.uniform2iv(X,Y)},_[35672]=function(U,X,Y){U.uniform3iv(X,Y)},_[35673]=function(U,X,Y){U.uniform4iv(X,Y)},_[35674]=function(U,X,Y){U.uniformMatrix2fv(X,!1,Y)},_[35675]=function(U,X,Y){U.uniformMatrix3fv(X,!1,Y)},_[35676]=function(U,X,Y){U.uniformMatrix4fv(X,!1,Y)},_[35678]=function(U,X,Y){U.uniform1i(X,Y)},_[35680]=function(U,X,Y){U.uniform1i(X,Y)},_),I=((w={})[5124]=function(U,X,Y){U.uniform1iv(X,Y)},w[5126]=function(U,X,Y){U.uniform1fv(X,Y)},w[35664]=function(U,X,Y){U.uniform2fv(X,Y)},w[35665]=function(U,X,Y){U.uniform3fv(X,Y)},w[35666]=function(U,X,Y){U.uniform4fv(X,Y)},w[35667]=function(U,X,Y){U.uniform2iv(X,Y)},w[35668]=function(U,X,Y){U.uniform3iv(X,Y)},w[35669]=function(U,X,Y){U.uniform4iv(X,Y)},w[35670]=function(U,X,Y){U.uniform1iv(X,Y)},w[35671]=function(U,X,Y){U.uniform2iv(X,Y)},w[35672]=function(U,X,Y){U.uniform3iv(X,Y)},w[35673]=function(U,X,Y){U.uniform4iv(X,Y)},w[35674]=function(U,X,Y){U.uniformMatrix2fv(X,!1,Y)},w[35675]=function(U,X,Y){U.uniformMatrix3fv(X,!1,Y)},w[35676]=function(U,X,Y){U.uniformMatrix4fv(X,!1,Y)},w[35678]=function(U,X,Y){U.uniform1iv(X,Y)},w[35680]=function(U,X,Y){U.uniform1iv(X,Y)},w);function M(U,X,Y){if(X.blend!==Y.blend)return Y.blend?(U.enable(U.BLEND),Y.blendSrc!==A.enums.BLEND_CONSTANT_COLOR&&Y.blendSrc!==A.enums.BLEND_ONE_MINUS_CONSTANT_COLOR&&Y.blendDst!==A.enums.BLEND_CONSTANT_COLOR&&Y.blendDst!==A.enums.BLEND_ONE_MINUS_CONSTANT_COLOR||U.blendColor((Y.blendColor>>24)/255,(Y.blendColor>>16&255)/255,(Y.blendColor>>8&255)/255,(255&Y.blendColor)/255),void(Y.blendSep?(U.blendFuncSeparate(Y.blendSrc,Y.blendDst,Y.blendSrcAlpha,Y.blendDstAlpha),U.blendEquationSeparate(Y.blendEq,Y.blendAlphaEq)):(U.blendFunc(Y.blendSrc,Y.blendDst),U.blendEquation(Y.blendEq)))):void U.disable(U.BLEND);Y.blend!==!1&&(X.blendColor!==Y.blendColor&&U.blendColor((Y.blendColor>>24)/255,(Y.blendColor>>16&255)/255,(Y.blendColor>>8&255)/255,(255&Y.blendColor)/255),X.blendSep===Y.blendSep?Y.blendSep?(X.blendSrc===Y.blendSrc&&X.blendDst===Y.blendDst&&X.blendSrcAlpha===Y.blendSrcAlpha&&X.blendDstAlpha===Y.blendDstAlpha||U.blendFuncSeparate(Y.blendSrc,Y.blendDst,Y.blendSrcAlpha,Y.blendDstAlpha),X.blendEq===Y.blendEq&&X.blendAlphaEq===Y.blendAlphaEq||U.blendEquationSeparate(Y.blendEq,Y.blendAlphaEq)):(X.blendSrc===Y.blendSrc&&X.blendDst===Y.blendDst||U.blendFunc(Y.blendSrc,Y.blendDst),X.blendEq!==Y.blendEq&&U.blendEquation(Y.blendEq)):Y.blendSep?(U.blendFuncSeparate(Y.blendSrc,Y.blendDst,Y.blendSrcAlpha,Y.blendDstAlpha),U.blendEquationSeparate(Y.blendEq,Y.blendAlphaEq)):(U.blendFunc(Y.blendSrc,Y.blendDst),U.blendEquation(Y.blendEq)))}function N(U,X,Y){if(X.depthTest!==Y.depthTest)return Y.depthTest?(U.enable(U.DEPTH_TEST),U.depthFunc(Y.depthFunc),void U.depthMask(Y.depthWrite)):void U.disable(U.DEPTH_TEST);X.depthWrite!==Y.depthWrite&&U.depthMask(Y.depthWrite),Y.depthTest!==!1?X.depthFunc!==Y.depthFunc&&U.depthFunc(Y.depthFunc):Y.depthWrite&&(Y.depthTest=!0,Y.depthFunc=A.enums.DS_FUNC_ALWAYS,U.enable(U.DEPTH_TEST),U.depthFunc(Y.depthFunc))}function k(U,X,Y){if(Y.stencilTest!==A.enums.STENCIL_INHERIT)return Y.stencilTest!==X.stencilTest?Y.stencilTest===A.enums.STENCIL_DISABLE?void U.disable(U.STENCIL_TEST):(U.enable(U.STENCIL_TEST),void(Y.stencilSep?(U.stencilFuncSeparate(U.FRONT,Y.stencilFuncFront,Y.stencilRefFront,Y.stencilMaskFront),U.stencilMaskSeparate(U.FRONT,Y.stencilWriteMaskFront),U.stencilOpSeparate(U.FRONT,Y.stencilFailOpFront,Y.stencilZFailOpFront,Y.stencilZPassOpFront),U.stencilFuncSeparate(U.BACK,Y.stencilFuncBack,Y.stencilRefBack,Y.stencilMaskBack),U.stencilMaskSeparate(U.BACK,Y.stencilWriteMaskBack),U.stencilOpSeparate(U.BACK,Y.stencilFailOpBack,Y.stencilZFailOpBack,Y.stencilZPassOpBack)):(U.stencilFunc(Y.stencilFuncFront,Y.stencilRefFront,Y.stencilMaskFront),U.stencilMask(Y.stencilWriteMaskFront),U.stencilOp(Y.stencilFailOpFront,Y.stencilZFailOpFront,Y.stencilZPassOpFront)))):void(Y.stencilTest!==A.enums.STENCIL_DISABLE&&(X.stencilSep===Y.stencilSep?Y.stencilSep?(X.stencilFuncFront===Y.stencilFuncFront&&X.stencilRefFront===Y.stencilRefFront&&X.stencilMaskFront===Y.stencilMaskFront||U.stencilFuncSeparate(U.FRONT,Y.stencilFuncFront,Y.stencilRefFront,Y.stencilMaskFront),X.stencilWriteMaskFront!==Y.stencilWriteMaskFront&&U.stencilMaskSeparate(U.FRONT,Y.stencilWriteMaskFront),X.stencilFailOpFront===Y.stencilFailOpFront&&X.stencilZFailOpFront===Y.stencilZFailOpFront&&X.stencilZPassOpFront===Y.stencilZPassOpFront||U.stencilOpSeparate(U.FRONT,Y.stencilFailOpFront,Y.stencilZFailOpFront,Y.stencilZPassOpFront),X.stencilFuncBack===Y.stencilFuncBack&&X.stencilRefBack===Y.stencilRefBack&&X.stencilMaskBack===Y.stencilMaskBack||U.stencilFuncSeparate(U.BACK,Y.stencilFuncBack,Y.stencilRefBack,Y.stencilMaskBack),X.stencilWriteMaskBack!==Y.stencilWriteMaskBack&&U.stencilMaskSeparate(U.BACK,Y.stencilWriteMaskBack),X.stencilFailOpBack===Y.stencilFailOpBack&&X.stencilZFailOpBack===Y.stencilZFailOpBack&&X.stencilZPassOpBack===Y.stencilZPassOpBack||U.stencilOpSeparate(U.BACK,Y.stencilFailOpBack,Y.stencilZFailOpBack,Y.stencilZPassOpBack)):(X.stencilFuncFront===Y.stencilFuncFront&&X.stencilRefFront===Y.stencilRefFront&&X.stencilMaskFront===Y.stencilMaskFront||U.stencilFunc(Y.stencilFuncFront,Y.stencilRefFront,Y.stencilMaskFront),X.stencilWriteMaskFront!==Y.stencilWriteMaskFront&&U.stencilMask(Y.stencilWriteMaskFront),X.stencilFailOpFront===Y.stencilFailOpFront&&X.stencilZFailOpFront===Y.stencilZFailOpFront&&X.stencilZPassOpFront===Y.stencilZPassOpFront||U.stencilOp(Y.stencilFailOpFront,Y.stencilZFailOpFront,Y.stencilZPassOpFront)):Y.stencilSep?(U.stencilFuncSeparate(U.FRONT,Y.stencilFuncFront,Y.stencilRefFront,Y.stencilMaskFront),U.stencilMaskSeparate(U.FRONT,Y.stencilWriteMaskFront),U.stencilOpSeparate(U.FRONT,Y.stencilFailOpFront,Y.stencilZFailOpFront,Y.stencilZPassOpFront),U.stencilFuncSeparate(U.BACK,Y.stencilFuncBack,Y.stencilRefBack,Y.stencilMaskBack),U.stencilMaskSeparate(U.BACK,Y.stencilWriteMaskBack),U.stencilOpSeparate(U.BACK,Y.stencilFailOpBack,Y.stencilZFailOpBack,Y.stencilZPassOpBack)):(U.stencilFunc(Y.stencilFuncFront,Y.stencilRefFront,Y.stencilMaskFront),U.stencilMask(Y.stencilWriteMaskFront),U.stencilOp(Y.stencilFailOpFront,Y.stencilZFailOpFront,Y.stencilZPassOpFront))))}function F(U,X,Y){X.cullMode!==Y.cullMode&&(Y.cullMode!==A.enums.CULL_NONE?(U.enable(U.CULL_FACE),U.cullFace(Y.cullMode)):U.disable(U.CULL_FACE))}function G(U,X,Y,z){var W=!1;if(z.maxStream!==-1){if(Y.maxStream!==z.maxStream)W=!0;else if(Y.program!==z.program)W=!0;else for(var Z=0;Z<z.maxStream+1;++Z)if(Y.vertexBuffers[Z]!==z.vertexBuffers[Z]||Y.vertexBufferOffsets[Z]!==z.vertexBufferOffsets[Z]){W=!0;break}if(W){for(var Q=0;Q<U._caps.maxVertexAttribs;++Q)U._newAttributes[Q]=0;for(var ee=0;ee<z.maxStream+1;++ee){var te=z.vertexBuffers[ee],re=z.vertexBufferOffsets[ee];if(te&&te._glID!==-1){X.bindBuffer(X.ARRAY_BUFFER,te._glID);for(var ie=0;ie<z.program._attributes.length;++ie){var ne=z.program._attributes[ie],he=te._format.element(ne.name);he?(U._enabledAttributes[ne.location]===0&&(X.enableVertexAttribArray(ne.location),U._enabledAttributes[ne.location]=1),U._newAttributes[ne.location]=1,X.vertexAttribPointer(ne.location,he.num,he.type,he.normalize,he.stride,he.offset+re*he.stride)):console.warn("Can not find vertex attribute: "+ne.name)}}}for(var pe=0;pe<U._caps.maxVertexAttribs;++pe)U._enabledAttributes[pe]!==U._newAttributes[pe]&&(X.disableVertexAttribArray(pe),U._enabledAttributes[pe]=0)}}}function V(U,X,Y){for(var z=0;z<Y.maxTextureSlot+1;++z)if(X.textureUnits[z]!==Y.textureUnits[z]){var W=Y.textureUnits[z];W&&W._glID!==-1&&(U.activeTexture(U.TEXTURE0+z),U.bindTexture(W._target,W._glID))}}function j(U,X,Y,z){z===void 0&&(z=0),Y instanceof O.default?U.framebufferTexture2D(U.FRAMEBUFFER,X,U.TEXTURE_2D,Y._glID,0):Y instanceof R.default?U.framebufferTexture2D(U.FRAMEBUFFER,X,U.TEXTURE_CUBE_MAP_POSITIVE_X+z,Y._glID,0):U.framebufferRenderbuffer(U.FRAMEBUFFER,X,U.RENDERBUFFER,Y._glID)}var H=function(){function U(W,Z){var Q;(Z=Z||{}).alpha===void 0&&(Z.alpha=!1),Z.stencil===void 0&&(Z.stencil=!0),Z.depth===void 0&&(Z.depth=!0),Z.antialias===void 0&&(Z.antialias=!1),Z.preserveDrawingBuffer===void 0&&(Z.preserveDrawingBuffer=!1);try{Q=W.getContext("webgl",Z)||W.getContext("experimental-webgl",Z)||W.getContext("webkit-3d",Z)||W.getContext("moz-webgl",Z)}catch(te){return void console.error(te)}Q||console.error("This device does not support webgl"),this._gl=Q,this._extensions={},this._caps={},this._stats={texture:0,vb:0,ib:0,drawcalls:0},this._initExtensions(["EXT_texture_filter_anisotropic","EXT_shader_texture_lod","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","WEBGL_draw_buffers"]),this._initCaps(),this._initStates(),B.default.initDefault(this),this._current=new B.default(this),this._next=new B.default(this),this._uniforms={},this._vx=this._vy=this._vw=this._vh=0,this._sx=this._sy=this._sw=this._sh=0,this._framebuffer=null,this._enabledAttributes=new Array(this._caps.maxVertexAttribs),this._newAttributes=new Array(this._caps.maxVertexAttribs);for(var ee=0;ee<this._caps.maxVertexAttribs;++ee)this._enabledAttributes[ee]=0,this._newAttributes[ee]=0}var X,Y,z=U.prototype;return z._initExtensions=function(W){for(var Z=this._gl,Q=0;Q<W.length;++Q)for(var ee=W[Q],te=["","WEBKIT_","MOZ_"],re=0;re<te.length;re++)try{var ie=Z.getExtension(te[re]+ee);if(ie){this._extensions[ee]=ie;break}}catch(ne){console.error(ne)}},z._initCaps=function(){var W=this._gl,Z=this.ext("WEBGL_draw_buffers");this._caps.maxVertexStreams=4,this._caps.maxVertexTextures=W.getParameter(W.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this._caps.maxFragUniforms=W.getParameter(W.MAX_FRAGMENT_UNIFORM_VECTORS),this._caps.maxTextureUnits=W.getParameter(W.MAX_TEXTURE_IMAGE_UNITS),this._caps.maxVertexAttribs=W.getParameter(W.MAX_VERTEX_ATTRIBS),this._caps.maxTextureSize=W.getParameter(W.MAX_TEXTURE_SIZE),this._caps.maxDrawBuffers=Z?W.getParameter(Z.MAX_DRAW_BUFFERS_WEBGL):1,this._caps.maxColorAttachments=Z?W.getParameter(Z.MAX_COLOR_ATTACHMENTS_WEBGL):1},z._initStates=function(){var W=this._gl;W.disable(W.BLEND),W.blendFunc(W.ONE,W.ZERO),W.blendEquation(W.FUNC_ADD),W.blendColor(1,1,1,1),W.colorMask(!0,!0,!0,!0),W.enable(W.CULL_FACE),W.cullFace(W.BACK),W.disable(W.DEPTH_TEST),W.depthFunc(W.LESS),W.depthMask(!1),W.disable(W.POLYGON_OFFSET_FILL),W.depthRange(0,1),W.disable(W.STENCIL_TEST),W.stencilFunc(W.ALWAYS,0,255),W.stencilMask(255),W.stencilOp(W.KEEP,W.KEEP,W.KEEP),W.clearDepth(1),W.clearColor(0,0,0,0),W.clearStencil(0),W.disable(W.SCISSOR_TEST)},z._restoreTexture=function(W){var Z=this._gl,Q=this._current.textureUnits[W];Q&&Q._glID!==-1?Z.bindTexture(Q._target,Q._glID):Z.bindTexture(Z.TEXTURE_2D,null)},z._restoreIndexBuffer=function(){var W=this._gl,Z=this._current.indexBuffer;Z&&Z._glID!==-1?W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,Z._glID):W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,null)},z.ext=function(W){return this._extensions[W]},z.allowFloatTexture=function(){return this.ext("OES_texture_float")!=null},z.setFrameBuffer=function(W){if(this._framebuffer!==W){this._framebuffer=W;var Z=this._gl;if(W){Z.bindFramebuffer(Z.FRAMEBUFFER,W._glID);for(var Q=W._colors.length,ee=0;ee<Q;++ee){var te=W._colors[ee];j(Z,Z.COLOR_ATTACHMENT0+ee,te)}for(var re=Q;re<this._caps.maxColorAttachments;++re)Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0+re,Z.TEXTURE_2D,null,0);W._depth&&j(Z,Z.DEPTH_ATTACHMENT,W._depth),W._stencil&&j(Z,Z.STENCIL_ATTACHMENT,W._stencil),W._depthStencil&&j(Z,Z.DEPTH_STENCIL_ATTACHMENT,W._depthStencil)}else Z.bindFramebuffer(Z.FRAMEBUFFER,null)}},z.setViewport=function(W,Z,Q,ee){this._vx===W&&this._vy===Z&&this._vw===Q&&this._vh===ee||(this._gl.viewport(W,Z,Q,ee),this._vx=W,this._vy=Z,this._vw=Q,this._vh=ee)},z.setScissor=function(W,Z,Q,ee){this._sx===W&&this._sy===Z&&this._sw===Q&&this._sh===ee||(this._gl.scissor(W,Z,Q,ee),this._sx=W,this._sy=Z,this._sw=Q,this._sh=ee)},z.clear=function(W){if(W.color!==void 0||W.depth!==void 0||W.stencil!==void 0){var Z=this._gl,Q=0;W.color!==void 0&&(Q|=Z.COLOR_BUFFER_BIT,Z.clearColor(W.color[0],W.color[1],W.color[2],W.color[3])),W.depth!==void 0&&(Q|=Z.DEPTH_BUFFER_BIT,Z.clearDepth(W.depth),Z.enable(Z.DEPTH_TEST),Z.depthMask(!0),Z.depthFunc(Z.ALWAYS)),W.stencil!==void 0&&(Q|=Z.STENCIL_BUFFER_BIT,Z.clearStencil(W.stencil)),Z.clear(Q),W.depth!==void 0&&(this._current.depthTest===!1?Z.disable(Z.DEPTH_TEST):(this._current.depthWrite===!1&&Z.depthMask(!1),this._current.depthFunc!==A.enums.DS_FUNC_ALWAYS&&Z.depthFunc(this._current.depthFunc)))}},z.enableBlend=function(){this._next.blend=!0},z.enableDepthTest=function(){this._next.depthTest=!0},z.enableDepthWrite=function(){this._next.depthWrite=!0},z.setStencilTest=function(W){this._next.stencilTest=W},z.setStencilFunc=function(W,Z,Q){this._next.stencilSep=!1,this._next.stencilFuncFront=this._next.stencilFuncBack=W,this._next.stencilRefFront=this._next.stencilRefBack=Z,this._next.stencilMaskFront=this._next.stencilMaskBack=Q},z.setStencilFuncFront=function(W,Z,Q){this._next.stencilSep=!0,this._next.stencilFuncFront=W,this._next.stencilRefFront=Z,this._next.stencilMaskFront=Q},z.setStencilFuncBack=function(W,Z,Q){this._next.stencilSep=!0,this._next.stencilFuncBack=W,this._next.stencilRefBack=Z,this._next.stencilMaskBack=Q},z.setStencilOp=function(W,Z,Q,ee){this._next.stencilFailOpFront=this._next.stencilFailOpBack=W,this._next.stencilZFailOpFront=this._next.stencilZFailOpBack=Z,this._next.stencilZPassOpFront=this._next.stencilZPassOpBack=Q,this._next.stencilWriteMaskFront=this._next.stencilWriteMaskBack=ee},z.setStencilOpFront=function(W,Z,Q,ee){this._next.stencilSep=!0,this._next.stencilFailOpFront=W,this._next.stencilZFailOpFront=Z,this._next.stencilZPassOpFront=Q,this._next.stencilWriteMaskFront=ee},z.setStencilOpBack=function(W,Z,Q,ee){this._next.stencilSep=!0,this._next.stencilFailOpBack=W,this._next.stencilZFailOpBack=Z,this._next.stencilZPassOpBack=Q,this._next.stencilWriteMaskBack=ee},z.setDepthFunc=function(W){this._next.depthFunc=W},z.setBlendColor32=function(W){this._next.blendColor=W},z.setBlendColor=function(W,Z,Q,ee){this._next.blendColor=(255*W<<24|255*Z<<16|255*Q<<8|255*ee)>>>0},z.setBlendFunc=function(W,Z){this._next.blendSep=!1,this._next.blendSrc=W,this._next.blendDst=Z},z.setBlendFuncSep=function(W,Z,Q,ee){this._next.blendSep=!0,this._next.blendSrc=W,this._next.blendDst=Z,this._next.blendSrcAlpha=Q,this._next.blendDstAlpha=ee},z.setBlendEq=function(W){this._next.blendSep=!1,this._next.blendEq=W},z.setBlendEqSep=function(W,Z){this._next.blendSep=!0,this._next.blendEq=W,this._next.blendAlphaEq=Z},z.setCullMode=function(W){this._next.cullMode=W},z.setVertexBuffer=function(W,Z,Q){Q===void 0&&(Q=0),this._next.vertexBuffers[W]=Z,this._next.vertexBufferOffsets[W]=Q,this._next.maxStream<W&&(this._next.maxStream=W)},z.setIndexBuffer=function(W){this._next.indexBuffer=W},z.setProgram=function(W){this._next.program=W},z.setTexture=function(W,Z,Q){Q>=this._caps.maxTextureUnits?console.warn("Can not set texture "+W+" at stage "+Q+", max texture exceed: "+this._caps.maxTextureUnits):(this._next.textureUnits[Q]=Z,this.setUniform(W,Q),this._next.maxTextureSlot<Q&&(this._next.maxTextureSlot=Q))},z.setTextureArray=function(W,Z,Q){var ee=Z.length;if(ee>=this._caps.maxTextureUnits)console.warn("Can not set "+ee+" textures for "+W+", max texture exceed: "+this._caps.maxTextureUnits);else{for(var te=0;te<ee;++te){var re=Q[te];this._next.textureUnits[re]=Z[te],this._next.maxTextureSlot<re&&(this._next.maxTextureSlot=re)}this.setUniform(W,Q)}},z.setUniform=function(W,Z){var Q=this._uniforms[W],ee=!1,te=!1,re=!1,ie=!1;do{if(!Q||(re=Array.isArray(Z)||Z instanceof Float32Array,ie=Z instanceof Int32Array,te=re||ie,Q.isArray!==te)||Q.isArray&&Q.value.length!==Z.length)break;ee=!0}while(!1);if(ee){var ne=Q.value,he=!1;if(Q.isArray)for(var pe=0,K=ne.length;pe<K;pe++)ne[pe]!==Z[pe]&&(he=!0,ne[pe]=Z[pe]);else ne!==Z&&(he=!0,Q.value=Z);he&&(Q.dirty=!0)}else{var ue=Z;re?ue=new Float32Array(Z):ie&&(ue=new Int32Array(Z)),Q={dirty:!0,value:ue,isArray:te}}this._uniforms[W]=Q},z.setUniformDirectly=function(W,Z){var Q=this._uniforms[W];Q||(this._uniforms[W]=Q={}),Q.dirty=!0,Q.value=Z},z.setPrimitiveType=function(W){this._next.primitiveType=W},z.resetDrawCalls=function(){this._stats.drawcalls=0},z.getDrawCalls=function(){return this._stats.drawcalls},z.draw=function(W,Z){var Q=this._gl,ee=this._current,te=this._next;M(Q,ee,te),N(Q,ee,te),k(Q,ee,te),F(Q,ee,te),G(this,Q,ee,te),ee.indexBuffer!==te.indexBuffer&&Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,te.indexBuffer&&te.indexBuffer._glID!==-1?te.indexBuffer._glID:null);var re=!1;ee.program!==te.program&&(te.program._linked?Q.useProgram(te.program._glID):console.warn("Failed to use program: has not linked yet."),re=!0),V(Q,ee,te);for(var ie=0;ie<te.program._uniforms.length;++ie){var ne=te.program._uniforms[ie],he=this._uniforms[ne.name];if(he&&(re||he.dirty)){he.dirty=!1;var pe=ne.size===void 0?D[ne.type]:I[ne.type];pe?pe(Q,ne.location,he.value):console.warn("Can not find commit function for uniform "+ne.name)}}Z&&(te.indexBuffer?Q.drawElements(this._next.primitiveType,Z,te.indexBuffer._format,W*te.indexBuffer._bytesPerIndex):Q.drawArrays(this._next.primitiveType,W,Z),this._stats.drawcalls++),ee.set(te),te.reset()},X=U,(Y=[{key:"caps",get:function(){return this._caps}}])&&E(X.prototype,Y),Object.defineProperty(X,"prototype",{writable:!1}),U}();T.default=H,S.exports=T.default},{"./enums":316,"./state":323,"./texture-2d":324,"./texture-cube":325}],316:[function(L,S,T){T.__esModule=!0,T.attrTypeBytes=function(A){return A===B.ATTR_TYPE_INT8||A===B.ATTR_TYPE_UINT8?1:A===B.ATTR_TYPE_INT16||A===B.ATTR_TYPE_UINT16?2:A===B.ATTR_TYPE_INT32||A===B.ATTR_TYPE_UINT32||A===B.ATTR_TYPE_FLOAT32?4:(console.warn("Unknown ATTR_TYPE: "+A),0)},T.enums=void 0,T.glFilter=function(A,O,R){R===void 0&&(R=-1);var P=_[O][R+1];return P===void 0?(console.warn("Unknown FILTER: "+O),R===-1?A.LINEAR:A.LINEAR_MIPMAP_LINEAR):P},T.glTextureFmt=function(A){var O=w[A];return O===void 0?(console.warn("Unknown TEXTURE_FMT: "+A),w[B.TEXTURE_FMT_RGBA8]):O};var _=[[9728,9984,9986],[9729,9985,9987]],w=[{format:6407,internalFormat:33776,pixelType:null},{format:6408,internalFormat:33777,pixelType:null},{format:6408,internalFormat:33778,pixelType:null},{format:6408,internalFormat:33779,pixelType:null},{format:6407,internalFormat:36196,pixelType:null},{format:6407,internalFormat:35841,pixelType:null},{format:6408,internalFormat:35843,pixelType:null},{format:6407,internalFormat:35840,pixelType:null},{format:6408,internalFormat:35842,pixelType:null},{format:6406,internalFormat:6406,pixelType:5121},{format:6409,internalFormat:6409,pixelType:5121},{format:6410,internalFormat:6410,pixelType:5121},{format:6407,internalFormat:6407,pixelType:33635},{format:6408,internalFormat:6408,pixelType:32820},{format:6408,internalFormat:6408,pixelType:32819},{format:6407,internalFormat:6407,pixelType:5121},{format:6408,internalFormat:6408,pixelType:5121},{format:6407,internalFormat:6407,pixelType:36193},{format:6408,internalFormat:6408,pixelType:36193},{format:6407,internalFormat:6407,pixelType:5126},{format:6408,internalFormat:6408,pixelType:5126},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:6402,internalFormat:6402,pixelType:5123},{format:6402,internalFormat:6402,pixelType:5125},{format:6402,internalFormat:6402,pixelType:5125},{format:6407,internalFormat:37492,pixelType:null},{format:6408,internalFormat:37496,pixelType:null},{format:6408,internalFormat:37808,pixelType:null},{format:6408,internalFormat:37809,pixelType:null},{format:6408,internalFormat:37810,pixelType:null},{format:6408,internalFormat:37811,pixelType:null},{format:6408,internalFormat:37812,pixelType:null},{format:6408,internalFormat:37813,pixelType:null},{format:6408,internalFormat:37814,pixelType:null},{format:6408,internalFormat:37815,pixelType:null},{format:6408,internalFormat:37816,pixelType:null},{format:6408,internalFormat:37817,pixelType:null},{format:6408,internalFormat:37818,pixelType:null},{format:6408,internalFormat:37819,pixelType:null},{format:6408,internalFormat:37820,pixelType:null},{format:6408,internalFormat:37821,pixelType:null},{format:6408,internalFormat:37840,pixelType:null},{format:6408,internalFormat:37841,pixelType:null},{format:6408,internalFormat:37842,pixelType:null},{format:6408,internalFormat:37843,pixelType:null},{format:6408,internalFormat:37844,pixelType:null},{format:6408,internalFormat:37845,pixelType:null},{format:6408,internalFormat:37846,pixelType:null},{format:6408,internalFormat:37847,pixelType:null},{format:6408,internalFormat:37848,pixelType:null},{format:6408,internalFormat:37849,pixelType:null},{format:6408,internalFormat:37850,pixelType:null},{format:6408,internalFormat:37851,pixelType:null},{format:6408,internalFormat:37852,pixelType:null},{format:6408,internalFormat:37853,pixelType:null}],B={USAGE_STATIC:35044,USAGE_DYNAMIC:35048,USAGE_STREAM:35040,INDEX_FMT_UINT8:5121,INDEX_FMT_UINT16:5123,INDEX_FMT_UINT32:5125,ATTR_POSITION:"a_position",ATTR_NORMAL:"a_normal",ATTR_TANGENT:"a_tangent",ATTR_BITANGENT:"a_bitangent",ATTR_WEIGHTS:"a_weights",ATTR_JOINTS:"a_joints",ATTR_COLOR:"a_color",ATTR_COLOR0:"a_color0",ATTR_COLOR1:"a_color1",ATTR_UV:"a_uv",ATTR_UV0:"a_uv0",ATTR_UV1:"a_uv1",ATTR_UV2:"a_uv2",ATTR_UV3:"a_uv3",ATTR_UV4:"a_uv4",ATTR_UV5:"a_uv5",ATTR_UV6:"a_uv6",ATTR_UV7:"a_uv7",ATTR_TEX_COORD:"a_texCoord",ATTR_TEX_COORD1:"a_texCoord1",ATTR_TEX_COORD2:"a_texCoord2",ATTR_TEX_COORD3:"a_texCoord3",ATTR_TEX_COORD4:"a_texCoord4",ATTR_TEX_COORD5:"a_texCoord5",ATTR_TEX_COORD6:"a_texCoord6",ATTR_TEX_COORD7:"a_texCoord7",ATTR_TEX_COORD8:"a_texCoord8",ATTR_TYPE_INT8:5120,ATTR_TYPE_UINT8:5121,ATTR_TYPE_INT16:5122,ATTR_TYPE_UINT16:5123,ATTR_TYPE_INT32:5124,ATTR_TYPE_UINT32:5125,ATTR_TYPE_FLOAT32:5126,FILTER_NEAREST:0,FILTER_LINEAR:1,WRAP_REPEAT:10497,WRAP_CLAMP:33071,WRAP_MIRROR:33648,TEXTURE_FMT_RGB_DXT1:0,TEXTURE_FMT_RGBA_DXT1:1,TEXTURE_FMT_RGBA_DXT3:2,TEXTURE_FMT_RGBA_DXT5:3,TEXTURE_FMT_RGB_ETC1:4,TEXTURE_FMT_RGB_PVRTC_2BPPV1:5,TEXTURE_FMT_RGBA_PVRTC_2BPPV1:6,TEXTURE_FMT_RGB_PVRTC_4BPPV1:7,TEXTURE_FMT_RGBA_PVRTC_4BPPV1:8,TEXTURE_FMT_A8:9,TEXTURE_FMT_L8:10,TEXTURE_FMT_L8_A8:11,TEXTURE_FMT_R5_G6_B5:12,TEXTURE_FMT_R5_G5_B5_A1:13,TEXTURE_FMT_R4_G4_B4_A4:14,TEXTURE_FMT_RGB8:15,TEXTURE_FMT_RGBA8:16,TEXTURE_FMT_RGB16F:17,TEXTURE_FMT_RGBA16F:18,TEXTURE_FMT_RGB32F:19,TEXTURE_FMT_RGBA32F:20,TEXTURE_FMT_R32F:21,TEXTURE_FMT_111110F:22,TEXTURE_FMT_SRGB:23,TEXTURE_FMT_SRGBA:24,TEXTURE_FMT_D16:25,TEXTURE_FMT_D32:26,TEXTURE_FMT_D24S8:27,TEXTURE_FMT_RGB_ETC2:28,TEXTURE_FMT_RGBA_ETC2:29,TEXTURE_FMT_RGBA_ASTC_4X4:30,TEXTURE_FMT_RGBA_ASTC_5X4:31,TEXTURE_FMT_RGBA_ASTC_5X5:32,TEXTURE_FMT_RGBA_ASTC_6X5:33,TEXTURE_FMT_RGBA_ASTC_6X6:34,TEXTURE_FMT_RGBA_ASTC_8X5:35,TEXTURE_FMT_RGBA_ASTC_8X6:36,TEXTURE_FMT_RGBA_ASTC_8X8:37,TEXTURE_FMT_RGBA_ASTC_10X5:38,TEXTURE_FMT_RGBA_ASTC_10X6:39,TEXTURE_FMT_RGBA_ASTC_10X8:40,TEXTURE_FMT_RGBA_ASTC_10X10:41,TEXTURE_FMT_RGBA_ASTC_12X10:42,TEXTURE_FMT_RGBA_ASTC_12X12:43,TEXTURE_FMT_SRGBA_ASTC_4X4:44,TEXTURE_FMT_SRGBA_ASTC_5X4:45,TEXTURE_FMT_SRGBA_ASTC_5X5:46,TEXTURE_FMT_SRGBA_ASTC_6X5:47,TEXTURE_FMT_SRGBA_ASTC_6X6:48,TEXTURE_FMT_SRGBA_ASTC_8X5:49,TEXTURE_FMT_SRGBA_ASTC_8X6:50,TEXTURE_FMT_SRGBA_ASTC_8X8:51,TEXTURE_FMT_SRGBA_ASTC_10X5:52,TEXTURE_FMT_SRGBA_ASTC_10X6:53,TEXTURE_FMT_SRGBA_ASTC_10X8:54,TEXTURE_FMT_SRGBA_ASTC_10X10:55,TEXTURE_FMT_SRGBA_ASTC_12X10:56,TEXTURE_FMT_SRGBA_ASTC_12X12:57,DS_FUNC_NEVER:512,DS_FUNC_LESS:513,DS_FUNC_EQUAL:514,DS_FUNC_LEQUAL:515,DS_FUNC_GREATER:516,DS_FUNC_NOTEQUAL:517,DS_FUNC_GEQUAL:518,DS_FUNC_ALWAYS:519,RB_FMT_RGBA4:32854,RB_FMT_RGB5_A1:32855,RB_FMT_RGB565:36194,RB_FMT_D16:33189,RB_FMT_S8:36168,RB_FMT_D24S8:34041,BLEND_FUNC_ADD:32774,BLEND_FUNC_SUBTRACT:32778,BLEND_FUNC_REVERSE_SUBTRACT:32779,BLEND_ZERO:0,BLEND_ONE:1,BLEND_SRC_COLOR:768,BLEND_ONE_MINUS_SRC_COLOR:769,BLEND_DST_COLOR:774,BLEND_ONE_MINUS_DST_COLOR:775,BLEND_SRC_ALPHA:770,BLEND_ONE_MINUS_SRC_ALPHA:771,BLEND_DST_ALPHA:772,BLEND_ONE_MINUS_DST_ALPHA:773,BLEND_CONSTANT_COLOR:32769,BLEND_ONE_MINUS_CONSTANT_COLOR:32770,BLEND_CONSTANT_ALPHA:32771,BLEND_ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_SRC_ALPHA_SATURATE:776,STENCIL_DISABLE:0,STENCIL_ENABLE:1,STENCIL_INHERIT:2,STENCIL_OP_KEEP:7680,STENCIL_OP_ZERO:0,STENCIL_OP_REPLACE:7681,STENCIL_OP_INCR:7682,STENCIL_OP_INCR_WRAP:34055,STENCIL_OP_DECR:7683,STENCIL_OP_DECR_WRAP:34056,STENCIL_OP_INVERT:5386,CULL_NONE:0,CULL_FRONT:1028,CULL_BACK:1029,CULL_FRONT_AND_BACK:1032,PT_POINTS:0,PT_LINES:1,PT_LINE_LOOP:2,PT_LINE_STRIP:3,PT_TRIANGLES:4,PT_TRIANGLE_STRIP:5,PT_TRIANGLE_FAN:6};T.enums=B},{}],317:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=function(){function w(A,O,R,P){this._device=A,this._width=O,this._height=R,this._colors=P.colors||[],this._depth=P.depth||null,this._stencil=P.stencil||null,this._depthStencil=P.depthStencil||null,this._glID=A._gl.createFramebuffer()}var B=w.prototype;return B.destroy=function(){this._glID!==null?(this._device._gl.deleteFramebuffer(this._glID),this._glID=null):console.error("The frame-buffer already destroyed")},B.getHandle=function(){return this._glID},w}();T.default=_,S.exports=T.default},{}],318:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("./enums");function B(P,E){for(var D=0;D<E.length;D++){var I=E[D];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(P,I.key,I)}}var A=((_={})[w.enums.INDEX_FMT_UINT8]=1,_[w.enums.INDEX_FMT_UINT16]=2,_[w.enums.INDEX_FMT_UINT32]=4,_),O=function(){function P(M,N,k,F){this._device=M,this._format=N,this._usage=k,this._bytesPerIndex=A[N],this._bytes=F.byteLength,this._numIndices=this._bytes/this._bytesPerIndex,this._needExpandDataStore=!0,this._glID=M._gl.createBuffer(),this.update(0,F),M._stats.ib+=this._bytes}var E,D,I=P.prototype;return I.destroy=function(){this._glID!==-1?(this._device._gl.deleteBuffer(this._glID),this._device._stats.ib-=this.bytes,this._glID=-1):console.error("The buffer already destroyed")},I.update=function(M,N){if(this._glID!==-1){if(N.byteLength!==0){if(M+N.byteLength>this._bytes){if(M)return void console.error("Failed to update data, bytes exceed.");this._needExpandDataStore=!0,this._bytes=M+N.byteLength,this._numIndices=this._bytes/this._bytesPerIndex}var k=this._device._gl,F=this._usage;k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,this._glID),this._needExpandDataStore?(k.bufferData(k.ELEMENT_ARRAY_BUFFER,N,F),this._needExpandDataStore=!1):k.bufferSubData(k.ELEMENT_ARRAY_BUFFER,M,N),this._device._restoreIndexBuffer()}}else console.error("The buffer is destroyed")},I.setUsage=function(M){this._usage=M},E=P,(D=[{key:"count",get:function(){return this._numIndices}}])&&B(E.prototype,D),Object.defineProperty(E,"prototype",{writable:!1}),P}();O.BYTES_PER_INDEX=A;var R=O;T.default=R,S.exports=T.default},{"./enums":316}],319:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("./enums");_={VertexFormat:L("./vertex-format"),IndexBuffer:L("./index-buffer"),VertexBuffer:L("./vertex-buffer"),Program:L("./program"),Texture:L("./texture"),Texture2D:L("./texture-2d"),TextureCube:L("./texture-cube"),RenderBuffer:L("./render-buffer"),FrameBuffer:L("./frame-buffer"),Device:L("./device"),attrTypeBytes:w.attrTypeBytes,glFilter:w.glFilter,glTextureFmt:w.glTextureFmt},Object.assign(_,w.enums);var B=_;T.default=B,cc.gfx=_,S.exports=T.default},{"./device":315,"./enums":316,"./frame-buffer":317,"./index-buffer":318,"./program":321,"./render-buffer":322,"./texture":326,"./texture-2d":324,"./texture-cube":325,"./vertex-buffer":327,"./vertex-format":328}],320:[function(L,S,T){T.__esModule=!0,T.isPow2=function(_){return!(_&_-1||!_)}},{}],321:[function(L,S,T){function _(R,P){for(var E=0;E<P.length;E++){var D=P[E];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(R,D.key,D)}}T.__esModule=!0,T.default=void 0;var w=0;function B(R,P,E){E&&E.split("\n").forEach(function(D){if(!(D.length<5)){var I=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(D);I?R.push({type:P,fileID:0|I[1],line:0|I[2],message:I[3].trim()}):D.length>0&&R.push({type:P,fileID:-1,line:0,message:D})}})}var A=function(){function R(I,M){this._device=I,this._attributes=[],this._uniforms=[],this._samplers=[],this._errors=[],this._linked=!1,this._vertSource=M.vert,this._fragSource=M.frag,this._glID=null,this._id=w++}var P,E,D=R.prototype;return D.link=function(){if(!this._linked){var I=this._device._gl,M=O(I,I.VERTEX_SHADER,this._vertSource),N=O(I,I.FRAGMENT_SHADER,this._fragSource),k=I.createProgram();I.attachShader(k,M),I.attachShader(k,N),I.linkProgram(k);var F=!1,G=this._errors;if(I.getShaderParameter(M,I.COMPILE_STATUS)||(B(G,"vs",I.getShaderInfoLog(M)),F=!0),I.getShaderParameter(N,I.COMPILE_STATUS)||(B(G,"fs",I.getShaderInfoLog(N)),F=!0),I.deleteShader(M),I.deleteShader(N),F)return G;if(!I.getProgramParameter(k,I.LINK_STATUS))return G.push({info:"Failed to link shader program: "+I.getProgramInfoLog(k)}),G;this._glID=k;for(var V=I.getProgramParameter(k,I.ACTIVE_ATTRIBUTES),j=0;j<V;++j){var H=I.getActiveAttrib(k,j),U=I.getAttribLocation(k,H.name);this._attributes.push({name:H.name,location:U,type:H.type})}for(var X=I.getProgramParameter(k,I.ACTIVE_UNIFORMS),Y=0;Y<X;++Y){var z=I.getActiveUniform(k,Y),W=z.name,Z=I.getUniformLocation(k,W),Q=W.substr(W.length-3)==="[0]";Q&&(W=W.substr(0,W.length-3));var ee={name:W,location:Z,type:z.type,size:Q?z.size:void 0};this._uniforms.push(ee)}this._linked=!0}},D.destroy=function(){this._device._gl.deleteProgram(this._glID),this._linked=!1,this._glID=null,this._attributes=[],this._uniforms=[],this._samplers=[]},P=R,(E=[{key:"id",get:function(){return this._id}}])&&_(P.prototype,E),Object.defineProperty(P,"prototype",{writable:!1}),R}();function O(R,P,E){var D=R.createShader(P);return R.shaderSource(D,E),R.compileShader(D),D}T.default=A,S.exports=T.default},{}],322:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=function(){function w(A,O,R,P){this._device=A,this._format=O,this._glID=A._gl.createRenderbuffer(),this.update(R,P)}var B=w.prototype;return B.update=function(A,O){this._width=A,this._height=O;var R=this._device._gl;R.bindRenderbuffer(R.RENDERBUFFER,this._glID),R.renderbufferStorage(R.RENDERBUFFER,this._format,A,O),R.bindRenderbuffer(R.RENDERBUFFER,null)},B.destroy=function(){if(this._glID!==null){var A=this._device._gl;A.bindRenderbuffer(A.RENDERBUFFER,null),A.deleteRenderbuffer(this._glID),this._glID=null}else console.error("The render-buffer already destroyed")},w}();T.default=_,S.exports=T.default},{}],323:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("./enums"),w={blend:!1,blendSep:!1,blendColor:4294967295,blendEq:_.enums.BLEND_FUNC_ADD,blendAlphaEq:_.enums.BLEND_FUNC_ADD,blendSrc:_.enums.BLEND_ONE,blendDst:_.enums.BLEND_ZERO,blendSrcAlpha:_.enums.BLEND_ONE,blendDstAlpha:_.enums.BLEND_ZERO,depthTest:!1,depthWrite:!1,depthFunc:_.enums.DS_FUNC_LESS,stencilTest:!1,stencilSep:!1,stencilFuncFront:_.enums.DS_FUNC_ALWAYS,stencilRefFront:0,stencilMaskFront:255,stencilFailOpFront:_.enums.STENCIL_OP_KEEP,stencilZFailOpFront:_.enums.STENCIL_OP_KEEP,stencilZPassOpFront:_.enums.STENCIL_OP_KEEP,stencilWriteMaskFront:255,stencilFuncBack:_.enums.DS_FUNC_ALWAYS,stencilRefBack:0,stencilMaskBack:255,stencilFailOpBack:_.enums.STENCIL_OP_KEEP,stencilZFailOpBack:_.enums.STENCIL_OP_KEEP,stencilZPassOpBack:_.enums.STENCIL_OP_KEEP,stencilWriteMaskBack:255,cullMode:_.enums.CULL_BACK,primitiveType:_.enums.PT_TRIANGLES,maxStream:-1,vertexBuffers:[],vertexBufferOffsets:[],indexBuffer:null,maxTextureSlot:-1,textureUnits:[],program:null},B=function(){function A(R){this.vertexBuffers=new Array(R._caps.maxVertexStreams),this.vertexBufferOffsets=new Array(R._caps.maxVertexStreams),this.textureUnits=new Array(R._caps.maxTextureUnits),this.set(w)}A.initDefault=function(R){w.vertexBuffers=new Array(R._caps.maxVertexStreams),w.vertexBufferOffsets=new Array(R._caps.maxVertexStreams),w.textureUnits=new Array(R._caps.maxTextureUnits)};var O=A.prototype;return O.reset=function(){this.set(w)},O.set=function(R){this.blend=R.blend,this.blendSep=R.blendSep,this.blendColor=R.blendColor,this.blendEq=R.blendEq,this.blendAlphaEq=R.blendAlphaEq,this.blendSrc=R.blendSrc,this.blendDst=R.blendDst,this.blendSrcAlpha=R.blendSrcAlpha,this.blendDstAlpha=R.blendDstAlpha,this.depthTest=R.depthTest,this.depthWrite=R.depthWrite,this.depthFunc=R.depthFunc,this.stencilTest=R.stencilTest,this.stencilSep=R.stencilSep,this.stencilFuncFront=R.stencilFuncFront,this.stencilRefFront=R.stencilRefFront,this.stencilMaskFront=R.stencilMaskFront,this.stencilFailOpFront=R.stencilFailOpFront,this.stencilZFailOpFront=R.stencilZFailOpFront,this.stencilZPassOpFront=R.stencilZPassOpFront,this.stencilWriteMaskFront=R.stencilWriteMaskFront,this.stencilFuncBack=R.stencilFuncBack,this.stencilRefBack=R.stencilRefBack,this.stencilMaskBack=R.stencilMaskBack,this.stencilFailOpBack=R.stencilFailOpBack,this.stencilZFailOpBack=R.stencilZFailOpBack,this.stencilZPassOpBack=R.stencilZPassOpBack,this.stencilWriteMaskBack=R.stencilWriteMaskBack,this.cullMode=R.cullMode,this.primitiveType=R.primitiveType,this.maxStream=R.maxStream;for(var P=0;P<R.vertexBuffers.length;++P)this.vertexBuffers[P]=R.vertexBuffers[P];for(var E=0;E<R.vertexBufferOffsets.length;++E)this.vertexBufferOffsets[E]=R.vertexBufferOffsets[E];this.indexBuffer=R.indexBuffer,this.maxTextureSlot=R.maxTextureSlot;for(var D=0;D<R.textureUnits.length;++D)this.textureUnits[D]=R.textureUnits[D];this.program=R.program},A}();T.default=B,S.exports=T.default},{"./enums":316}],324:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("./texture"))&&_.__esModule?_:{default:_},B=L("./enums"),A=L("./misc");function O(P,E){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,I){return D.__proto__=I,D})(P,E)}var R=function(P){var E,D;function I(N,k){var F,G=(F=P.call(this,N)||this)._device._gl;return F._target=G.TEXTURE_2D,F._glID=G.createTexture(),k.images=k.images||[null],F.update(k),F}D=P,(E=I).prototype=Object.create(D.prototype),E.prototype.constructor=E,O(E,D);var M=I.prototype;return M.update=function(N){var k=this._device._gl,F=this._genMipmap;if(N){N.width!==void 0&&(this._width=N.width),N.height!==void 0&&(this._height=N.height),N.anisotropy!==void 0&&(this._anisotropy=N.anisotropy),N.minFilter!==void 0&&(this._minFilter=N.minFilter),N.magFilter!==void 0&&(this._magFilter=N.magFilter),N.mipFilter!==void 0&&(this._mipFilter=N.mipFilter),N.wrapS!==void 0&&(this._wrapS=N.wrapS),N.wrapT!==void 0&&(this._wrapT=N.wrapT),N.format!==void 0&&(this._format=N.format,this._compressed=this._format>=B.enums.TEXTURE_FMT_RGB_DXT1&&this._format<=B.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1||this._format>=B.enums.TEXTURE_FMT_RGB_ETC2&&this._format<=B.enums.TEXTURE_FMT_RGBA_ETC2||this._format>=B.enums.TEXTURE_FMT_RGBA_ASTC_4X4&&this._format<=B.enums.TEXTURE_FMT_SRGBA_ASTC_12X12),N.genMipmaps!==void 0&&(this._genMipmap=N.genMipmaps,F=N.genMipmaps);var G=this._device.caps.maxTextureSize||Number.MAX_VALUE,V=Math.max(N.width||0,N.height||0);G<V&&console.warn("The current texture size "+V+" exceeds the maximum size ["+G+"] supported on the device."),N.images!==void 0&&N.images.length>1&&(F=!1,(N.width>N.height?N.width:N.height)>>N.images.length-1!=1&&console.error("texture-2d mipmap is invalid, should have a 1x1 mipmap."))}(0,A.isPow2)(this._width)&&(0,A.isPow2)(this._height)||(F=!1),k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,this._glID),N.images!==void 0&&N.images.length>0&&(this._setMipmap(N.images,N.flipY,N.premultiplyAlpha),N.images.length>1&&(this._genMipmap=!0)),F&&(k.hint(k.GENERATE_MIPMAP_HINT,k.NICEST),k.generateMipmap(k.TEXTURE_2D),this._genMipmap=!0),this._setTexInfo(),this._device._restoreTexture(0)},M.updateSubImage=function(N){var k=this._device._gl,F=(0,B.glTextureFmt)(this._format);k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,this._glID),this._setSubImage(F,N),this._device._restoreTexture(0)},M.updateImage=function(N){var k=this._device._gl,F=(0,B.glTextureFmt)(this._format);k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,this._glID),this._setImage(F,N),this._device._restoreTexture(0)},M._setSubImage=function(N,k){var F=this._device._gl,G=k.flipY,V=k.premultiplyAlpha,j=k.image;!j||ArrayBuffer.isView(j)||j instanceof ArrayBuffer?(G===void 0?F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,!1):F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,G),V===void 0?F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V),this._compressed?F.compressedTexSubImage2D(F.TEXTURE_2D,k.level,k.x,k.y,k.width,k.height,N.format,j):F.texSubImage2D(F.TEXTURE_2D,k.level,k.x,k.y,k.width,k.height,N.format,N.pixelType,j)):(G===void 0?F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,!0):F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,G),V===void 0?F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V),F.texSubImage2D(F.TEXTURE_2D,k.level,k.x,k.y,N.format,N.pixelType,j))},M._setImage=function(N,k){var F=this._device._gl,G=k.flipY,V=k.premultiplyAlpha,j=k.image;!j||ArrayBuffer.isView(j)||j instanceof ArrayBuffer?(G===void 0?F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,!1):F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,G),V===void 0?F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V),this._compressed?F.compressedTexImage2D(F.TEXTURE_2D,k.level,N.internalFormat,k.width,k.height,0,j):F.texImage2D(F.TEXTURE_2D,k.level,N.internalFormat,k.width,k.height,0,N.format,N.pixelType,j)):(G===void 0?F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,!0):F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,G),V===void 0?F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V),F.texImage2D(F.TEXTURE_2D,k.level,N.internalFormat,N.format,N.pixelType,j))},M._setMipmap=function(N,k,F){for(var G=(0,B.glTextureFmt)(this._format),V={width:this._width,height:this._height,flipY:k,premultiplyAlpha:F,level:0,image:null},j=0;j<N.length;++j)V.level=j,V.width=this._width>>j,V.height=this._height>>j,V.image=N[j],this._setImage(G,V)},M._setTexInfo=function(){var N=this._device._gl,k=(0,A.isPow2)(this._width)&&(0,A.isPow2)(this._height);k||this._wrapS===B.enums.WRAP_CLAMP&&this._wrapT===B.enums.WRAP_CLAMP||(console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"),this._wrapS=B.enums.WRAP_CLAMP,this._wrapT=B.enums.WRAP_CLAMP);var F=this._genMipmap?this._mipFilter:-1;k||F===-1||(console.warn("NPOT textures do not support mipmap filter"),F=-1),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,(0,B.glFilter)(N,this._minFilter,F)),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,(0,B.glFilter)(N,this._magFilter,-1)),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,this._wrapS),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,this._wrapT);var G=this._device.ext("EXT_texture_filter_anisotropic");G&&N.texParameteri(N.TEXTURE_2D,G.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy)},I}(w.default);T.default=R,S.exports=T.default},{"./enums":316,"./misc":320,"./texture":326}],325:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("./texture"))&&_.__esModule?_:{default:_},B=L("./enums"),A=L("./misc");function O(P,E){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,I){return D.__proto__=I,D})(P,E)}var R=function(P){var E,D;function I(N,k){var F,G=(F=P.call(this,N)||this)._device._gl;return F._target=G.TEXTURE_CUBE_MAP,F._glID=G.createTexture(),F.update(k),F}D=P,(E=I).prototype=Object.create(D.prototype),E.prototype.constructor=E,O(E,D);var M=I.prototype;return M.update=function(N){var k=this._device._gl,F=this._genMipmaps;N&&(N.width!==void 0&&(this._width=N.width),N.height!==void 0&&(this._height=N.height),N.anisotropy!==void 0&&(this._anisotropy=N.anisotropy),N.minFilter!==void 0&&(this._minFilter=N.minFilter),N.magFilter!==void 0&&(this._magFilter=N.magFilter),N.mipFilter!==void 0&&(this._mipFilter=N.mipFilter),N.wrapS!==void 0&&(this._wrapS=N.wrapS),N.wrapT!==void 0&&(this._wrapT=N.wrapT),N.format!==void 0&&(this._format=N.format,this._compressed=this._format>=B.enums.TEXTURE_FMT_RGB_DXT1&&this._format<=B.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1||this._format>=B.enums.TEXTURE_FMT_RGB_ETC2&&this._format<=B.enums.TEXTURE_FMT_RGBA_ETC2||this._format>=B.enums.TEXTURE_FMT_RGBA_ASTC_4X4&&this._format<=B.enums.TEXTURE_FMT_SRGBA_ASTC_12X12),N.genMipmaps!==void 0&&(this._genMipmaps=N.genMipmaps,F=N.genMipmaps),N.images!==void 0&&N.images.length>1&&(F=!1,N.width!==N.height&&console.warn("texture-cube width and height should be identical."),N.width>>N.images.length-1!=1&&console.error("texture-cube mipmap is invalid. please set mipmap as 1x1, 2x2, 4x4 ... nxn"))),(0,A.isPow2)(this._width)&&(0,A.isPow2)(this._height)||(F=!1),k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,this._glID),N.images!==void 0&&N.images.length>0&&(this._setMipmap(N.images,N.flipY,N.premultiplyAlpha),N.images.length>1&&(this._genMipmaps=!0)),F&&(k.hint(k.GENERATE_MIPMAP_HINT,k.NICEST),k.generateMipmap(k.TEXTURE_CUBE_MAP),this._genMipmaps=!0),this._setTexInfo(),this._device._restoreTexture(0)},M.updateSubImage=function(N){var k=this._device._gl,F=(0,B.glTextureFmt)(this._format);k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,this._glID),this._setSubImage(F,N),this._device._restoreTexture(0)},M.updateImage=function(N){var k=this._device._gl,F=(0,B.glTextureFmt)(this._format);k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,this._glID),this._setImage(F,N),this._device._restoreTexture(0)},M._setSubImage=function(N,k){var F=this._device._gl,G=k.flipY,V=k.premultiplyAlpha,j=k.faceIndex,H=k.image;G===void 0?F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,!1):F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,G),V===void 0?F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V),!H||ArrayBuffer.isView(H)||H instanceof ArrayBuffer?this._compressed?F.compressedTexSubImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+j,k.level,k.x,k.y,k.width,k.height,N.format,H):F.texSubImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+j,k.level,k.x,k.y,k.width,k.height,N.format,N.pixelType,H):F.texSubImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+j,k.level,k.x,k.y,N.format,N.pixelType,H)},M._setImage=function(N,k){var F=this._device._gl,G=k.flipY,V=k.premultiplyAlpha,j=k.faceIndex,H=k.image;G===void 0?F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,!1):F.pixelStorei(F.UNPACK_FLIP_Y_WEBGL,G),V===void 0?F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V),!H||ArrayBuffer.isView(H)||H instanceof ArrayBuffer?this._compressed?F.compressedTexImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+j,k.level,N.internalFormat,k.width,k.height,0,H):F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+j,k.level,N.internalFormat,k.width,k.height,0,N.format,N.pixelType,H):F.texImage2D(F.TEXTURE_CUBE_MAP_POSITIVE_X+j,k.level,N.internalFormat,N.format,N.pixelType,H)},M._setMipmap=function(N,k,F){for(var G=(0,B.glTextureFmt)(this._format),V={width:this._width,height:this._height,faceIndex:0,flipY:k,premultiplyAlpha:F,level:0,image:null},j=0;j<N.length;++j){var H=N[j];V.level=j,V.width=this._width>>j,V.height=this._height>>j;for(var U=0;U<6;++U)V.faceIndex=U,V.image=H[U],this._setImage(G,V)}},M._setTexInfo=function(){var N=this._device._gl,k=(0,A.isPow2)(this._width)&&(0,A.isPow2)(this._height);k||this._wrapS===B.enums.WRAP_CLAMP&&this._wrapT===B.enums.WRAP_CLAMP||(console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"),this._wrapS=B.enums.WRAP_CLAMP,this._wrapT=B.enums.WRAP_CLAMP);var F=this._genMipmaps?this._mipFilter:-1;k||F===-1||(console.warn("NPOT textures do not support mipmap filter"),F=-1),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_MIN_FILTER,(0,B.glFilter)(N,this._minFilter,F)),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_MAG_FILTER,(0,B.glFilter)(N,this._magFilter,-1)),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_WRAP_S,this._wrapS),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_WRAP_T,this._wrapT);var G=this._device.ext("EXT_texture_filter_anisotropic");G&&N.texParameteri(N.TEXTURE_CUBE_MAP,G.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy)},I}(w.default);T.default=R,S.exports=T.default},{"./enums":316,"./misc":320,"./texture":326}],326:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("./enums"),w=0,B=function(){function A(O){this._device=O,this._width=4,this._height=4,this._genMipmaps=!1,this._compressed=!1,this._anisotropy=1,this._minFilter=_.enums.FILTER_LINEAR,this._magFilter=_.enums.FILTER_LINEAR,this._mipFilter=_.enums.FILTER_LINEAR,this._wrapS=_.enums.WRAP_REPEAT,this._wrapT=_.enums.WRAP_REPEAT,this._format=_.enums.TEXTURE_FMT_RGBA8,this._target=-1,this._id=w++}return A.prototype.destroy=function(){this._glID!==null?(this._device._gl.deleteTexture(this._glID),this._device._stats.tex-=this.bytes,this._glID=null):console.error("The texture already destroyed")},A}();T.default=B,S.exports=T.default},{"./enums":316}],327:[function(L,S,T){function _(B,A){for(var O=0;O<A.length;O++){var R=A[O];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(B,R.key,R)}}T.__esModule=!0,T.default=void 0,L("./enums");var w=function(){function B(P,E,D,I){this._device=P,this._format=E,this._usage=D,this._bytesPerVertex=this._format._bytes,this._bytes=I.byteLength,this._numVertices=this._bytes/this._bytesPerVertex,this._needExpandDataStore=!0,this._glID=P._gl.createBuffer(),this.update(0,I),P._stats.vb+=this._bytes}var A,O,R=B.prototype;return R.destroy=function(){this._glID!==-1?(this._device._gl.deleteBuffer(this._glID),this._device._stats.vb-=this.bytes,this._glID=-1):console.error("The buffer already destroyed")},R.update=function(P,E){if(this._glID!==-1){if(E.byteLength!==0){if(P+E.byteLength>this._bytes){if(P)return void console.error("Failed to update data, bytes exceed.");this._needExpandDataStore=!0,this._bytes=P+E.byteLength,this._numVertices=this._bytes/this._bytesPerVertex}var D=this._device._gl,I=this._usage;D.bindBuffer(D.ARRAY_BUFFER,this._glID),this._needExpandDataStore?(D.bufferData(D.ARRAY_BUFFER,E,I),this._needExpandDataStore=!1):D.bufferSubData(D.ARRAY_BUFFER,P,E),D.bindBuffer(D.ARRAY_BUFFER,null)}}else console.error("The buffer is destroyed")},R.getFormat=function(P){return this._format.element(P)},R.setUsage=function(P){this._usage=P},A=B,(O=[{key:"count",get:function(){return this._numVertices}}])&&_(A.prototype,O),Object.defineProperty(A,"prototype",{writable:!1}),B}();T.default=w,S.exports=T.default},{"./enums":316}],328:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("./enums"),B=(_=L("../murmurhash2_gc"))&&_.__esModule?_:{default:_},A=function(){function O(P){this._attr2el={},this._elements=[],this._bytes=0;for(var E="",D=0,I=P.length;D<I;++D){var M=P[D],N={name:M.name,offset:this._bytes,stride:0,stream:-1,type:M.type,num:M.num,normalize:M.normalize!==void 0&&M.normalize,bytes:M.num*(0,w.attrTypeBytes)(M.type)};this._attr2el[N.name]=N,this._elements.push(N),this._bytes+=N.bytes,E+=N.name+":"+N.num+":"+N.type+":"+N.normalize}for(var k=0,F=this._elements.length;k<F;++k)this._elements[k].stride=this._bytes;this._hash=(0,B.default)(E,666)}var R=O.prototype;return R.element=function(P){return this._attr2el[P]},R.getHash=function(){return this._hash},O}();T.default=A,S.exports=T.default},{"../murmurhash2_gc":337,"./enums":316}],329:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=function(){function w(B,A){this._cursor=0,this._data=new Array(A);for(var O=0;O<A;++O)this._data[O]=B()}return w.prototype.request=function(){var B=this._data[this._cursor];return this._cursor=(this._cursor+1)%this._data.length,B},w}();T.default=_,S.exports=T.default},{}],330:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("./timsort"))&&_.__esModule?_:{default:_};function B(O,R){for(var P=0;P<R.length;P++){var E=R[P];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(O,E.key,E)}}var A=function(){function O(D){this._count=0,this._data=new Array(D)}var R,P,E=O.prototype;return E._resize=function(D){if(D>this._data.length)for(var I=this._data.length;I<D;++I)this._data[I]=void 0},E.reset=function(){for(var D=0;D<this._count;++D)this._data[D]=void 0;this._count=0},E.push=function(D){this._count>=this._data.length&&this._resize(2*this._data.length),this._data[this._count]=D,++this._count},E.pop=function(){--this._count,this._count<0&&(this._count=0);var D=this._data[this._count];return this._data[this._count]=void 0,D},E.fastRemove=function(D){if(!(D>=this._count||D<0)){var I=this._count-1;this._data[D]=this._data[I],this._data[I]=void 0,this._count-=1}},E.indexOf=function(D){return this._data.indexOf(D)},E.sort=function(D){return(0,w.default)(this._data,0,this._count,D)},R=O,(P=[{key:"length",get:function(){return this._count}},{key:"data",get:function(){return this._data}}])&&B(R.prototype,P),Object.defineProperty(R,"prototype",{writable:!1}),O}();T.default=A,S.exports=T.default},{"./timsort":335}],331:[function(L,S,T){T.__esModule=!0,T.TypedArrayPool=T.RecyclePool=T.Pool=T.LinkedArray=T.FixedArray=T.CircularPool=void 0;var _=P(L("./circular-pool"));T.CircularPool=_.default;var w=P(L("./fixed-array"));T.FixedArray=w.default;var B=P(L("./linked-array"));T.LinkedArray=B.default;var A=P(L("./pool"));T.Pool=A.default;var O=P(L("./recycle-pool"));T.RecyclePool=O.default;var R=P(L("./typed-array-pool"));function P(E){return E&&E.__esModule?E:{default:E}}T.TypedArrayPool=R.default},{"./circular-pool":329,"./fixed-array":330,"./linked-array":332,"./pool":333,"./recycle-pool":334,"./typed-array-pool":336}],332:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("./pool"))&&_.__esModule?_:{default:_};function B(O,R){for(var P=0;P<R.length;P++){var E=R[P];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(O,E.key,E)}}var A=function(){function O(D,I){this._fn=D,this._count=0,this._head=null,this._tail=null,this._pool=new w.default(D,I)}var R,P,E=O.prototype;return E.add=function(){var D=this._pool.alloc();return this._tail?(this._tail._next=D,D._prev=this._tail):this._head=D,this._tail=D,this._count+=1,D},E.remove=function(D){D._prev?D._prev._next=D._next:this._head=D._next,D._next?D._next._prev=D._prev:this._tail=D._prev,D._next=null,D._prev=null,this._pool.free(D),this._count-=1},E.forEach=function(D,I){var M=this._head;if(M){I&&(D=D.bind(I));for(var N=0,k=M;M;)k=M._next,D(M,N,this),M=k,++N}},R=O,(P=[{key:"head",get:function(){return this._head}},{key:"tail",get:function(){return this._tail}},{key:"length",get:function(){return this._count}}])&&B(R.prototype,P),Object.defineProperty(R,"prototype",{writable:!1}),O}();T.default=A,S.exports=T.default},{"./pool":333}],333:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=function(){function w(A,O){this._fn=A,this._idx=O-1,this._frees=new Array(O);for(var R=0;R<O;++R)this._frees[R]=A()}var B=w.prototype;return B._expand=function(A){var O=this._frees;this._frees=new Array(A);for(var R=A-O.length,P=0;P<R;++P)this._frees[P]=this._fn();for(var E=R,D=0;E<A;++E,++D)this._frees[E]=O[D];this._idx+=R},B.alloc=function(){this._idx<0&&this._expand(Math.round(1.2*this._frees.length)+1);var A=this._frees[this._idx];return this._frees[this._idx]=null,--this._idx,A},B.free=function(A){++this._idx,this._frees[this._idx]=A},B.clear=function(A){for(var O=0;O<=this._idx;O++)A&&A(this._frees[O]);this._frees.length=0,this._idx=-1},w}();T.default=_,S.exports=T.default},{}],334:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("./timsort"))&&_.__esModule?_:{default:_};function B(O,R){for(var P=0;P<R.length;P++){var E=R[P];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(O,E.key,E)}}var A=function(){function O(D,I){this._fn=D,this._count=0,this._data=new Array(I);for(var M=0;M<I;++M)this._data[M]=D()}var R,P,E=O.prototype;return E.reset=function(){this._count=0},E.resize=function(D){if(D>this._data.length)for(var I=this._data.length;I<D;++I)this._data[I]=this._fn()},E.add=function(){return this._count>=this._data.length&&this.resize(2*this._data.length),this._data[this._count++]},E.remove=function(D){if(!(D>=this._count)){var I=this._count-1,M=this._data[D];this._data[D]=this._data[I],this._data[I]=M,this._count-=1}},E.sort=function(D){return(0,w.default)(this._data,0,this._count,D)},R=O,(P=[{key:"length",get:function(){return this._count}},{key:"data",get:function(){return this._data}}])&&B(R.prototype,P),Object.defineProperty(R,"prototype",{writable:!1}),O}();T.default=A,cc.RecyclePool=A,S.exports=T.default},{"./timsort":335}],335:[function(L,S,T){T.__esModule=!0,T.default=function(F,G,V,j){if(!Array.isArray(F))throw new TypeError("Can only sort arrays");G===void 0&&(G=0),V===void 0&&(V=F.length),j===void 0&&(j=R);var H=V-G;if(!(H<2)){var U=0;if(H<_)return void I(F,G,V,G+(U=E(F,G,V,j)),j);var X=new k(F,j),Y=P(H);do{if((U=E(F,G,V,j))<Y){var z=H;z>Y&&(z=Y),I(F,G,G+z,G+U,j),U=z}X.pushRun(G,U),X.mergeRuns(),H-=U,G+=U}while(H!==0);X.forceMergeRuns()}};var _=32,w=7,B=256,A=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function O(F){return F<1e5?F<100?F<10?0:1:F<1e4?F<1e3?2:3:4:F<1e7?F<1e6?5:6:F<1e9?F<1e8?7:8:9}function R(F,G){if(F===G)return 0;if(~~F===F&&~~G===G){if(F===0||G===0)return F<G?-1:1;if(F<0||G<0){if(G>=0)return-1;if(F>=0)return 1;F=-F,G=-G}var V=O(F),j=O(G),H=0;return V<j?(F*=A[j-V-1],G/=10,H=-1):V>j&&(G*=A[V-j-1],F/=10,H=1),F===G?H:F<G?-1:1}var U=String(F),X=String(G);return U===X?0:U<X?-1:1}function P(F){for(var G=0;F>=_;)G|=1&F,F>>=1;return F+G}function E(F,G,V,j){var H=G+1;if(H===V)return 1;if(j(F[H++],F[G])<0){for(;H<V&&j(F[H],F[H-1])<0;)H++;D(F,G,H)}else for(;H<V&&j(F[H],F[H-1])>=0;)H++;return H-G}function D(F,G,V){for(V--;G<V;){var j=F[G];F[G++]=F[V],F[V--]=j}}function I(F,G,V,j,H){for(j===G&&j++;j<V;j++){for(var U=F[j],X=G,Y=j;X<Y;){var z=X+Y>>>1;H(U,F[z])<0?Y=z:X=z+1}var W=j-X;switch(W){case 3:F[X+3]=F[X+2];case 2:F[X+2]=F[X+1];case 1:F[X+1]=F[X];break;default:for(;W>0;)F[X+W]=F[X+W-1],W--}F[X]=U}}function M(F,G,V,j,H,U){var X=0,Y=0,z=1;if(U(F,G[V+H])>0){for(Y=j-H;z<Y&&U(F,G[V+H+z])>0;)X=z,(z=1+(z<<1))<=0&&(z=Y);z>Y&&(z=Y),X+=H,z+=H}else{for(Y=H+1;z<Y&&U(F,G[V+H-z])<=0;)X=z,(z=1+(z<<1))<=0&&(z=Y);z>Y&&(z=Y);var W=X;X=H-z,z=H-W}for(X++;X<z;){var Z=X+(z-X>>>1);U(F,G[V+Z])>0?X=Z+1:z=Z}return z}function N(F,G,V,j,H,U){var X=0,Y=0,z=1;if(U(F,G[V+H])<0){for(Y=H+1;z<Y&&U(F,G[V+H-z])<0;)X=z,(z=1+(z<<1))<=0&&(z=Y);z>Y&&(z=Y);var W=X;X=H-z,z=H-W}else{for(Y=j-H;z<Y&&U(F,G[V+H+z])>=0;)X=z,(z=1+(z<<1))<=0&&(z=Y);z>Y&&(z=Y),X+=H,z+=H}for(X++;X<z;){var Z=X+(z-X>>>1);U(F,G[V+Z])<0?z=Z:X=Z+1}return z}var k=function(){function F(V,j){this.array=V,this.compare=j,this.minGallop=w,this.length=V.length,this.tmpStorageLength=B,this.length<2*B&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength),this.stackSize=0}var G=F.prototype;return G.pushRun=function(V,j){this.runStart[this.stackSize]=V,this.runLength[this.stackSize]=j,this.stackSize+=1},G.mergeRuns=function(){for(;this.stackSize>1;){var V=this.stackSize-2;if(V>=1&&this.runLength[V-1]<=this.runLength[V]+this.runLength[V+1]||V>=2&&this.runLength[V-2]<=this.runLength[V]+this.runLength[V-1])this.runLength[V-1]<this.runLength[V+1]&&V--;else if(this.runLength[V]>this.runLength[V+1])break;this.mergeAt(V)}},G.forceMergeRuns=function(){for(;this.stackSize>1;){var V=this.stackSize-2;V>0&&this.runLength[V-1]<this.runLength[V+1]&&V--,this.mergeAt(V)}},G.mergeAt=function(V){var j=this.compare,H=this.array,U=this.runStart[V],X=this.runLength[V],Y=this.runStart[V+1],z=this.runLength[V+1];this.runLength[V]=X+z,V===this.stackSize-3&&(this.runStart[V+1]=this.runStart[V+2],this.runLength[V+1]=this.runLength[V+2]),this.stackSize--;var W=N(H[Y],H,U,X,0,j);U+=W,(X-=W)!=0&&(z=M(H[U+X-1],H,Y,z,z-1,j))!==0&&(X<=z?this.mergeLow(U,X,Y,z):this.mergeHigh(U,X,Y,z))},G.mergeLow=function(V,j,H,U){var X=this.compare,Y=this.array,z=this.tmp,W=0;for(W=0;W<j;W++)z[W]=Y[V+W];var Z=0,Q=H,ee=V;if(Y[ee++]=Y[Q++],--U!=0)if(j!==1){for(var te=this.minGallop;;){var re=0,ie=0,ne=!1;do if(X(Y[Q],z[Z])<0){if(Y[ee++]=Y[Q++],ie++,re=0,--U==0){ne=!0;break}}else if(Y[ee++]=z[Z++],re++,ie=0,--j==1){ne=!0;break}while((re|ie)<te);if(ne)break;do{if((re=N(Y[Q],z,Z,j,0,X))!==0){for(W=0;W<re;W++)Y[ee+W]=z[Z+W];if(ee+=re,Z+=re,(j-=re)<=1){ne=!0;break}}if(Y[ee++]=Y[Q++],--U==0){ne=!0;break}if((ie=M(z[Z],Y,Q,U,0,X))!==0){for(W=0;W<ie;W++)Y[ee+W]=Y[Q+W];if(ee+=ie,Q+=ie,(U-=ie)==0){ne=!0;break}}if(Y[ee++]=z[Z++],--j==1){ne=!0;break}te--}while(re>=w||ie>=w);if(ne)break;te<0&&(te=0),te+=2}if(this.minGallop=te,te<1&&(this.minGallop=1),j===1){for(W=0;W<U;W++)Y[ee+W]=Y[Q+W];Y[ee+U]=z[Z]}else{if(j===0)throw new Error("mergeLow preconditions were not respected");for(W=0;W<j;W++)Y[ee+W]=z[Z+W]}}else{for(W=0;W<U;W++)Y[ee+W]=Y[Q+W];Y[ee+U]=z[Z]}else for(W=0;W<j;W++)Y[ee+W]=z[Z+W]},G.mergeHigh=function(V,j,H,U){var X=this.compare,Y=this.array,z=this.tmp,W=0;for(W=0;W<U;W++)z[W]=Y[H+W];var Z=V+j-1,Q=U-1,ee=H+U-1,te=0,re=0;if(Y[ee--]=Y[Z--],--j!=0)if(U!==1){for(var ie=this.minGallop;;){var ne=0,he=0,pe=!1;do if(X(z[Q],Y[Z])<0){if(Y[ee--]=Y[Z--],ne++,he=0,--j==0){pe=!0;break}}else if(Y[ee--]=z[Q--],he++,ne=0,--U==1){pe=!0;break}while((ne|he)<ie);if(pe)break;do{if((ne=j-N(z[Q],Y,V,j,j-1,X))!=0){for(j-=ne,re=1+(ee-=ne),te=1+(Z-=ne),W=ne-1;W>=0;W--)Y[re+W]=Y[te+W];if(j===0){pe=!0;break}}if(Y[ee--]=z[Q--],--U==1){pe=!0;break}if((he=U-M(Y[Z],z,0,U,U-1,X))!=0){for(U-=he,re=1+(ee-=he),te=1+(Q-=he),W=0;W<he;W++)Y[re+W]=z[te+W];if(U<=1){pe=!0;break}}if(Y[ee--]=Y[Z--],--j==0){pe=!0;break}ie--}while(ne>=w||he>=w);if(pe)break;ie<0&&(ie=0),ie+=2}if(this.minGallop=ie,ie<1&&(this.minGallop=1),U===1){for(re=1+(ee-=j),te=1+(Z-=j),W=j-1;W>=0;W--)Y[re+W]=Y[te+W];Y[ee]=z[Q]}else{if(U===0)throw new Error("mergeHigh preconditions were not respected");for(te=ee-(U-1),W=0;W<U;W++)Y[te+W]=z[W]}}else{for(re=1+(ee-=j),te=1+(Z-=j),W=j-1;W>=0;W--)Y[re+W]=Y[te+W];Y[ee]=z[Q]}else for(te=ee-(U-1),W=0;W<U;W++)Y[te+W]=z[W]},F}();S.exports=T.default},{}],336:[function(L,S,T){T.__esModule=!0,T.default=void 0;for(var _=Array(8),w=0;w<8;++w)_[w]=[];function B(P){for(var E=16;E<=1<<28;E*=16)if(P<=E)return E;return 0}function A(P){var E,D;return E=(P>65535)<<4,E|=D=((P>>>=E)>255)<<3,E|=D=((P>>>=D)>15)<<2,(E|=D=((P>>>=D)>3)<<1)|(P>>>=D)>>1}function O(P){var E=B(P),D=_[A(E)>>2];return D.length>0?D.pop():new ArrayBuffer(E)}var R={alloc_int8:function(P){var E=new Int8Array(O(P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_uint8:function(P){var E=new Uint8Array(O(P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_int16:function(P){var E=new Int16Array(O(2*P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_uint16:function(P){var E=new Uint16Array(O(2*P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_int32:function(P){var E=new Int32Array(O(4*P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_uint32:function(P){var E=new Uint32Array(O(4*P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_float32:function(P){var E=new Float32Array(O(4*P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_float64:function(P){var E=new Float64Array(O(8*P),0,P);return E.length!==P?E.subarray(0,P):E},alloc_dataview:function(P){var E=new DataView(O(P),0,P);return E.length!==P?E.subarray(0,P):E},free:function(P){var E;E=P.buffer,_[A(E.byteLength)>>2].push(E)},reset:function(){for(var P=Array(8),E=0;E<8;++E)P[E]=[]}};T.default=R,S.exports=T.default},{}],337:[function(L,S,T){T.__esModule=!0,T.default=function(_,w){for(var B,A=_.length,O=w^A,R=0;A>=4;)B=1540483477*(65535&(B=255&_.charCodeAt(R)|(255&_.charCodeAt(++R))<<8|(255&_.charCodeAt(++R))<<16|(255&_.charCodeAt(++R))<<24))+((1540483477*(B>>>16)&65535)<<16),O=1540483477*(65535&O)+((1540483477*(O>>>16)&65535)<<16)^(B=1540483477*(65535&(B^=B>>>24))+((1540483477*(B>>>16)&65535)<<16)),A-=4,++R;switch(A){case 3:O^=(255&_.charCodeAt(R+2))<<16;case 2:O^=(255&_.charCodeAt(R+1))<<8;case 1:O=1540483477*(65535&(O^=255&_.charCodeAt(R)))+((1540483477*(O>>>16)&65535)<<16)}return O=1540483477*(65535&(O^=O>>>13))+((1540483477*(O>>>16)&65535)<<16),(O^=O>>>15)>>>0},S.exports=T.default},{}],338:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("../../core/value-types"),w=O(L("../core/base-renderer")),B=O(L("../enums")),A=L("../memop");function O(z){return z&&z.__esModule?z:{default:z}}function R(z){if(z===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z}function P(z,W){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,Q){return Z.__proto__=Q,Z})(z,W)}var E=new Float32Array(16),D=new Float32Array(16),I=new Float32Array(16),M=new Float32Array(16),N=new Float32Array(4),k=new Float32Array(64),F=[],G=new Float32Array(4),V=new _.Vec4(0,0,0,0),j=new _.Vec3(0,0,0),H=new _.Vec3(0,0,0),U=new A.RecyclePool(function(){return new Float32Array(16)},8);function X(z,W){return z._priority-W._priority}var Y=function(z){var W,Z;function Q(te,re){var ie;return(ie=z.call(this,te,re)||this)._time=new Float32Array(4),ie._lights=[],ie._shadowLights=[],ie._numLights=0,ie._defines={},ie._registerStage("shadowcast",ie._shadowStage.bind(R(ie))),ie._registerStage("opaque",ie._opaqueStage.bind(R(ie))),ie._registerStage("transparent",ie._transparentStage.bind(R(ie))),ie}Z=z,(W=Q).prototype=Object.create(Z.prototype),W.prototype.constructor=W,P(W,Z);var ee=Q.prototype;return ee.reset=function(){U.reset(),z.prototype.reset.call(this)},ee.render=function(te,re){this.reset(),re&&(this._time[0]+=re,this._time[1]=re,this._time[2]++),this._device.setUniform("cc_time",this._time),this._updateLights(te);for(var ie=this._device._gl.canvas,ne=0;ne<te._cameras.length;++ne){var he=this._requestView(),pe=ie.width,K=ie.height;te._cameras.data[ne].extractView(he,pe,K)}this._viewPools.sort(X);for(var ue=0;ue<this._viewPools.length;++ue){var le=this._viewPools.data[ue];this._render(le,te)}},ee.renderCamera=function(te,re){this.reset(),this._updateLights(re);var ie=this._device._gl.canvas,ne=ie.width,he=ie.height,pe=this._requestView();te.extractView(pe,ne,he),this._viewPools.sort(X);for(var K=0;K<this._viewPools.length;++K){var ue=this._viewPools.data[K];this._render(ue,re)}},ee._updateLights=function(te){this._lights.length=0,this._shadowLights.length=0;for(var re=te._lights,ie=0;ie<re.length;++ie){var ne=re.data[ie];if(ne.update(this._device),ne.shadowType!==B.default.SHADOW_NONE){this._shadowLights.length<2&&this._shadowLights.unshift(ne);var he=this._requestView();ne.extractView(he,["shadowcast"]),this._lights.splice(0,0,ne)}else this._lights.push(ne)}this._updateLightDefines(),this._numLights=re._count},ee._updateLightDefines=function(){for(var te=this._defines,re=0;re<this._lights.length;++re){var ie=this._lights[re],ne="CC_LIGHT_"+re+"_TYPE",he="CC_SHADOW_"+re+"_TYPE";te[ne]!==ie._type&&(te[ne]=ie._type,this._definesChanged=!0),te[he]!==ie._shadowType&&(te[he]=ie._shadowType,this._definesChanged=!0)}var pe=Math.min(4,this._lights.length);te.CC_NUM_LIGHTS!==pe&&(te.CC_NUM_LIGHTS=pe,this._definesChanged=!0),pe=Math.min(4,this._shadowLights.length),te.CC_NUM_SHADOW_LIGHTS!==pe&&(te.CC_NUM_SHADOW_LIGHTS=pe,this._definesChanged=!0)},ee._submitLightsUniforms=function(){var te=this._device;if(this._lights.length>0){for(var re=U.add(),ie=U.add(),ne=U.add(),he=Math.min(4,this._lights.length),pe=0;pe<he;++pe){var K=this._lights[pe],ue=4*pe;ne.set(K._colorUniform,ue),ie.set(K._directionUniform,ue),re.set(K._positionUniform,ue),re[ue+3]=K._range,K._type===B.default.LIGHT_SPOT?(ie[ue+3]=K._spotUniform[0],ne[ue+3]=K._spotUniform[1]):(ie[ue+3]=0,ne[ue+3]=0)}te.setUniform("cc_lightDirection",ie),te.setUniform("cc_lightColor",ne),te.setUniform("cc_lightPositionAndRange",re)}},ee._submitShadowStageUniforms=function(te){var re=te._shadowLight,ie=G;ie[0]=re.shadowMinDepth,ie[1]=re.shadowMaxDepth,ie[2]=re.shadowDepthScale,ie[3]=re.shadowDarkness,this._device.setUniform("cc_shadow_map_lightViewProjMatrix",_.Mat4.toArray(M,te._matViewProj)),this._device.setUniform("cc_shadow_map_info",ie),this._device.setUniform("cc_shadow_map_bias",re.shadowBias),this._defines.CC_SHADOW_TYPE=re._shadowType},ee._submitOtherStagesUniforms=function(){for(var te=U.add(),re=0;re<this._shadowLights.length;++re){var ie=this._shadowLights[re],ne=F[re];ne||(ne=F[re]=new Float32Array(k.buffer,64*re,16)),_.Mat4.toArray(ne,ie.viewProjMatrix);var he=4*re;te[he]=ie.shadowMinDepth,te[he+1]=ie.shadowMaxDepth,te[he+2]=ie._shadowResolution,te[he+3]=ie.shadowDarkness}this._device.setUniform("cc_shadow_lightViewProjMatrix",k),this._device.setUniform("cc_shadow_info",te)},ee._sortItems=function(te){te.sort(function(re,ie){return re.passes.length!==ie.passes.length?re.passes.length-ie.passes.length:re.sortKey-ie.sortKey})},ee._shadowStage=function(te,re){this._submitShadowStageUniforms(te);for(var ie=0;ie<re.length;++ie){var ne=re.data[ie];ne.effect.getDefine("CC_CASTING_SHADOW")&&this._draw(ne)}},ee._drawItems=function(te,re){var ie=this._shadowLights;if(ie.length===0&&this._numLights===0)for(var ne=0;ne<re.length;++ne){var he=re.data[ne];this._draw(he)}else for(var pe=0;pe<re.length;++pe){for(var K=re.data[pe],ue=0;ue<ie.length;++ue)this._device.setTexture("cc_shadow_map_"+ue,ie[ue].shadowMap,this._allocTextureUnit());this._draw(K)}},ee._opaqueStage=function(te,re){te.getPosition(V),this._device.setUniform("cc_matView",_.Mat4.toArray(E,te._matView)),this._device.setUniform("cc_matViewInv",_.Mat4.toArray(D,te._matViewInv)),this._device.setUniform("cc_matProj",_.Mat4.toArray(I,te._matProj)),this._device.setUniform("cc_matViewProj",_.Mat4.toArray(M,te._matViewProj)),this._device.setUniform("cc_cameraPos",_.Vec4.toArray(N,V)),this._submitLightsUniforms(),this._submitOtherStagesUniforms(),this._drawItems(te,re)},ee._transparentStage=function(te,re){te.getPosition(V),te.getForward(j),this._device.setUniform("cc_matView",_.Mat4.toArray(E,te._matView)),this._device.setUniform("cc_matViewInv",_.Mat4.toArray(D,te._matViewInv)),this._device.setUniform("cc_matProj",_.Mat4.toArray(I,te._matProj)),this._device.setUniform("cc_matViewProj",_.Mat4.toArray(M,te._matViewProj)),this._device.setUniform("cc_cameraPos",_.Vec4.toArray(N,V)),this._submitLightsUniforms(),this._submitOtherStagesUniforms();for(var ie=0;ie<re.length;++ie){var ne=re.data[ie];ne.node.getWorldPosition(H),_.Vec3.sub(H,H,V),ne.sortKey=-_.Vec3.dot(H,j)}this._sortItems(re),this._drawItems(te,re)},Q}(w.default);T.default=Y,S.exports=T.default},{"../../core/value-types":286,"../core/base-renderer":308,"../enums":314,"../memop":331}],339:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=L("../../core/value-types"),B=L("../../core/geom-utils"),A=(_=L("../enums"))&&_.__esModule?_:{default:_};function O(G,V){for(var j=0;j<V.length;j++){var H=V[j];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(G,H.key,H)}}var R=new w.Mat4,P=new w.Mat4,E=new w.Mat4,D=new w.Mat4,I=new w.Mat4,M=new w.Mat4,N=new w.Vec3,k=new w.Vec3,F=function(){function G(){this._poolID=-1,this._node=null,this._projection=A.default.PROJ_PERSPECTIVE,this._priority=0,this._color=new w.Vec4(.2,.3,.47,1),this._depth=1,this._stencil=0,this._clearFlags=A.default.CLEAR_COLOR|A.default.CLEAR_DEPTH,this._clearModel=null,this._stages=[],this._framebuffer=null,this._near=.01,this._far=1e3,this._fov=Math.PI/4,this._rect={x:0,y:0,w:1,h:1},this._orthoHeight=10,this._cullingMask=4294967295}var V,j,H=G.prototype;return H.setCullingMask=function(U){this._cullingMask=U},H.getNode=function(){return this._node},H.setNode=function(U){this._node=U},H.getType=function(){return this._projection},H.setType=function(U){this._projection=U},H.getPriority=function(){return this._priority},H.setPriority=function(U){this._priority=U},H.getOrthoHeight=function(){return this._orthoHeight},H.setOrthoHeight=function(U){this._orthoHeight=U},H.getFov=function(){return this._fov},H.setFov=function(U){this._fov=U},H.getNear=function(){return this._near},H.setNear=function(U){this._near=U},H.getFar=function(){return this._far},H.setFar=function(U){this._far=U},H.getColor=function(U){return w.Vec4.copy(U,this._color)},H.setColor=function(U,X,Y,z){w.Vec4.set(this._color,U,X,Y,z)},H.getDepth=function(){return this._depth},H.setDepth=function(U){this._depth=U},H.getStencil=function(){return this._stencil},H.setStencil=function(U){this._stencil=U},H.getClearFlags=function(){return this._clearFlags},H.setClearFlags=function(U){this._clearFlags=U},H.getRect=function(U){return U.x=this._rect.x,U.y=this._rect.y,U.w=this._rect.w,U.h=this._rect.h,U},H.setRect=function(U,X,Y,z){this._rect.x=U,this._rect.y=X,this._rect.w=Y,this._rect.h=z},H.getStages=function(){return this._stages},H.setStages=function(U){this._stages=U},H.getFramebuffer=function(){return this._framebuffer},H.setFrameBuffer=function(U){this._framebuffer=U},H._calcMatrices=function(U,X){this._node.getWorldRT(E),w.Mat4.invert(P,E);var Y=U/X;if(this._projection===A.default.PROJ_PERSPECTIVE)w.Mat4.perspective(D,this._fov,Y,this._near,this._far);else{var z=this._orthoHeight*Y,W=this._orthoHeight;w.Mat4.ortho(D,-z,z,-W,W,this._near,this._far)}w.Mat4.mul(I,D,P),w.Mat4.invert(M,I)},H.extractView=function(U,X,Y){this._framebuffer&&(X=this._framebuffer._width,Y=this._framebuffer._height),U._priority=this._priority,U._rect.x=this._rect.x*X,U._rect.y=this._rect.y*Y,U._rect.w=this._rect.w*X,U._rect.h=this._rect.h*Y,this.getColor(U._color),U._depth=this._depth,U._stencil=this._stencil,U._clearFlags=this._clearFlags,U._clearModel=this._clearModel,U._stages=this._stages,U._framebuffer=this._framebuffer,this._calcMatrices(X,Y),w.Mat4.copy(U._matView,P),w.Mat4.copy(U._matViewInv,E),w.Mat4.copy(U._matProj,D),w.Mat4.copy(U._matViewProj,I),w.Mat4.copy(U._matInvViewProj,M),U._cullingMask=this._cullingMask},H.screenPointToRay=function(U,X,Y,z,W){if(!cc.geomUtils)return W;W=W||new B.Ray,this._calcMatrices(Y,z);var Z=this._rect.x*Y,Q=this._rect.y*z,ee=this._rect.w*Y,te=this._rect.h*z;return w.Vec3.set(k,(U-Z)/ee*2-1,(X-Q)/te*2-1,1),w.Vec3.transformMat4(k,k,M),this._projection===A.default.PROJ_PERSPECTIVE?this._node.getWorldPosition(N):(w.Vec3.set(N,(U-Z)/ee*2-1,(X-Q)/te*2-1,-1),w.Vec3.transformMat4(N,N,M)),B.Ray.fromPoints(W,N,k)},H.screenToWorld=function(U,X,Y,z){this._calcMatrices(Y,z);var W=this._rect.x*Y,Z=this._rect.y*z,Q=this._rect.w*Y,ee=this._rect.h*z;return this._projection===A.default.PROJ_PERSPECTIVE?(w.Vec3.set(U,(X.x-W)/Q*2-1,(X.y-Z)/ee*2-1,.9999),w.Vec3.transformMat4(U,U,M),this._node.getWorldPosition(N),w.Vec3.lerp(U,N,U,(0,w.lerp)(this._near/this._far,1,X.z))):(w.Vec3.set(U,(X.x-W)/Q*2-1,(X.y-Z)/ee*2-1,2*X.z-1),w.Vec3.transformMat4(U,U,M)),U},H.worldToScreen=function(U,X,Y,z){this._calcMatrices(Y,z);var W=this._rect.x*Y,Z=this._rect.y*z,Q=this._rect.w*Y,ee=this._rect.h*z;return w.Vec3.transformMat4(U,X,I),U.x=W+.5*(U.x+1)*Q,U.y=Z+.5*(U.y+1)*ee,U.z=.5*U.z+.5,U},H.worldMatrixToScreen=function(U,X,Y,z){this._calcMatrices(Y,z),w.Mat4.mul(U,I,X);var W=Y/2,Z=z/2;return w.Mat4.identity(R),w.Mat4.transform(R,R,w.Vec3.set(N,W,Z,0)),w.Mat4.scale(R,R,w.Vec3.set(N,W,Z,1)),w.Mat4.mul(U,R,U),U},V=G,(j=[{key:"cullingMask",get:function(){return this._cullingMask},set:function(U){this._cullingMask=U}}])&&O(V.prototype,j),Object.defineProperty(V,"prototype",{writable:!1}),G}();T.default=F,S.exports=T.default},{"../../core/geom-utils":151,"../../core/value-types":286,"../enums":314}],340:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=function(){function w(){this._type="default",this._poolID=-1,this._node=null,this._inputAssembler=null,this._effect=null,this._viewID=-1,this._cameraID=-1,this._userKey=-1,this._castShadow=!1,this._boundingShape=null}var B=w.prototype;return B.setNode=function(A){this._node=A},B.setInputAssembler=function(A){this._inputAssembler=A},B.setEffect=function(A){this._effect=A},B.setUserKey=function(A){this._userKey=A},B.extractDrawItem=function(A){A.model=this,A.node=this._node,A.ia=this._inputAssembler,A.effect=this._effect},w}();T.default=_,S.exports=T.default},{}],341:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=L("../memop"),w=function(){function B(O){this._lights=new _.FixedArray(16),this._models=new _.FixedArray(16),this._cameras=new _.FixedArray(16),this._debugCamera=null,this._app=O,this._views=[]}var A=B.prototype;return A._add=function(O,R){R._poolID===-1&&(O.push(R),R._poolID=O.length-1)},A._remove=function(O,R){R._poolID!==-1&&(O.data[O.length-1]._poolID=R._poolID,O.fastRemove(R._poolID),R._poolID=-1)},A.reset=function(){for(var O=0;O<this._models.length;++O)this._models.data[O]._viewID=-1},A.setDebugCamera=function(O){this._debugCamera=O},A.getCameraCount=function(){return this._cameras.length},A.getCamera=function(O){return this._cameras.data[O]},A.addCamera=function(O){this._add(this._cameras,O)},A.removeCamera=function(O){this._remove(this._cameras,O)},A.getModelCount=function(){return this._models.length},A.getModel=function(O){return this._models.data[O]},A.addModel=function(O){this._add(this._models,O)},A.removeModel=function(O){this._remove(this._models,O)},A.getLightCount=function(){return this._lights.length},A.getLight=function(O){return this._lights.data[O]},A.addLight=function(O){this._add(this._lights,O)},A.removeLight=function(O){this._remove(this._lights,O)},A.addView=function(O){this._views.indexOf(O)===-1&&this._views.push(O)},A.removeView=function(O){var R=this._views.indexOf(O);R!==-1&&this._views.splice(R,1)},B}();T.default=w,S.exports=T.default},{"../memop":331}],342:[function(L,S,T){T.__esModule=!0,T.getClassName=T.enums2default=T.ctor2enums=void 0,T.getInspectorProps=function(U){var X={type:U.type};Object.assign(X,U.editor||U.inspector),X.defines=U.defines,X.value=V(X.type)(U.value),U.range&&(X.range=U.range);var Y=j(X.type);return X.typeName=H[Y]||Y,X.valueCtor=N[X.type],X.typeName=="cc.Texture2D"&&(X.typeName="cc.Asset",X.assetType="cc.Texture2D"),X},T.getInstanceType=T.getInstanceCtor=void 0;var _,w,B,A,O=E(L("./enums")),R=L("../core/value-types"),P=E(L("../core/assets/CCTexture2D"));function E(U){return U&&U.__esModule?U:{default:U}}var D;D=L("./gfx/texture-2d");var I=cc.Object,M=((_={})[Boolean]=function(U){return U||!1},_[Number]=function(U){return U?ArrayBuffer.isView(U)?U[0]:U:0},_[R.Vec2]=function(U){return U?cc.v2(U[0],U[1]):cc.v2()},_[R.Vec3]=function(U){return U?cc.v3(U[0],U[1],U[2]):cc.v3()},_[R.Vec4]=function(U){return U?cc.v4(U[0],U[1],U[2],U[3]):cc.v4()},_[R.Color]=function(U){return U?cc.color(255*U[0],255*U[1],255*U[2],255*(U[3]||1)):cc.color()},_[R.Mat4]=function(U){return U?cc.mat4(U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15]):cc.mat4()},_[P.default]=function(){return null},_[I]=function(){return null},_),N=((w={})[O.default.PARAM_INT]=Number,w[O.default.PARAM_INT2]=R.Vec2,w[O.default.PARAM_INT3]=R.Vec3,w[O.default.PARAM_INT4]=R.Vec4,w[O.default.PARAM_FLOAT]=Number,w[O.default.PARAM_FLOAT2]=R.Vec2,w[O.default.PARAM_FLOAT3]=R.Vec3,w[O.default.PARAM_FLOAT4]=R.Vec4,w[O.default.PARAM_MAT4]=R.Mat4,w[O.default.PARAM_TEXTURE_2D]=P.default,w.color=R.Color,w.number=Number,w.boolean=Boolean,w.default=I,w),k=((B={})[Number]=O.default.PARAM_FLOAT,B[R.Vec2]=O.default.PARAM_FLOAT2,B[R.Vec3]=O.default.PARAM_FLOAT3,B[R.Vec4]=O.default.PARAM_FLOAT4,B[R.Color]=O.default.PARAM_COLOR3,B[R.Color]=O.default.PARAM_COLOR4,B[R.Mat4]=O.default.PARAM_MAT4,B[P.default]=O.default.PARAM_TEXTURE_2D,B[D]=O.default.PARAM_TEXTURE_2D,B);T.ctor2enums=k;var F=((A={})[O.default.PARAM_INT]=new Uint32Array([0]),A[O.default.PARAM_INT2]=new Uint32Array([0,0]),A[O.default.PARAM_INT3]=new Uint32Array([0,0,0]),A[O.default.PARAM_INT4]=new Uint32Array([0,0,0,0]),A[O.default.PARAM_FLOAT]=new Float32Array([0]),A[O.default.PARAM_FLOAT2]=new Float32Array([0,0]),A[O.default.PARAM_FLOAT3]=new Float32Array([0,0,0]),A[O.default.PARAM_FLOAT4]=new Float32Array([0,0,0,0]),A[O.default.PARAM_MAT4]=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),A[O.default.PARAM_TEXTURE_2D]=null,A.number=0,A.boolean=!1,A);T.enums2default=F;var G=function(U){return N[U]||N.default};T.getInstanceType=G;var V=function(U){return M[G(U)]};T.getInstanceCtor=V;var j=function(U){return cc.js.getClassName(G(U))};T.getClassName=j;var H={Number:"number",Boolean:"boolean"}},{"../core/assets/CCTexture2D":77,"../core/value-types":286,"./enums":314,"./gfx/texture-2d":324}],343:[function(L){var S=L("../compression/ZipUtils"),T=L("../compression/zlib.min"),_=L("../core/platform/js");function w(E){if(E.length%4!=0)return null;for(var D=E.length/4,I=window.Uint32Array?new Uint32Array(D):[],M=0;M<D;M++){var N=4*M;I[M]=E[N]+256*E[N+1]+65536*E[N+2]+E[N+3]*(1<<24)}return I}function B(E){var D=cc.Label.HorizontalAlign;switch(E){case"center":return D.CENTER;case"right":return D.RIGHT;default:return D.LEFT}}function A(E){var D=cc.Label.VerticalAlign;switch(E){case"center":return D.CENTER;case"bottom":return D.BOTTOM;default:return D.TOP}}function O(E){if(!E)return cc.color(0,0,0,255);if((E=E.indexOf("#")!==-1?E.substring(1):E).length===8){var D=parseInt(E.substr(0,2),16)||255,I=parseInt(E.substr(2,2),16)||0,M=parseInt(E.substr(4,2),16)||0,N=parseInt(E.substr(6,2),16)||0;return cc.color(I,M,N,D)}var k=parseInt(E.substr(0,2),16)||0,F=parseInt(E.substr(2,2),16)||0,G=parseInt(E.substr(4,2),16)||0;return cc.color(k,F,G,255)}function R(E,D){for(var I=[],M=E.getElementsByTagName("properties"),N=0;N<M.length;++N)for(var k=M[N].getElementsByTagName("property"),F=0;F<k.length;++F)I.push(k[F]);D=D||{};for(var G=0;G<I.length;G++){var V=I[G],j=V.getAttribute("name"),H=V.getAttribute("type")||"string",U=V.getAttribute("value");H==="int"?U=parseInt(U):H==="float"?U=parseFloat(U):H==="bool"?U=U==="true":H==="color"&&(U=O(U)),D[j]=U}return D}L("../core/platform/CCSAXParser"),cc.TMXLayerInfo=function(){this.properties={},this.name="",this._layerSize=null,this._tiles=[],this.visible=!0,this._opacity=0,this.ownTiles=!0,this._minGID=1e5,this._maxGID=0,this.offset=cc.v2(0,0)},cc.TMXLayerInfo.prototype={constructor:cc.TMXLayerInfo,getProperties:function(){return this.properties},setProperties:function(E){this.properties=E}},cc.TMXImageLayerInfo=function(){this.name="",this.visible=!0,this.width=0,this.height=0,this.offset=cc.v2(0,0),this._opacity=0,this._trans=new cc.Color(255,255,255,255),this.sourceImage=null},cc.TMXObjectGroupInfo=function(){this.properties={},this.name="",this._objects=[],this.visible=!0,this._opacity=0,this._color=new cc.Color(255,255,255,255),this.offset=cc.v2(0,0),this._draworder="topdown"},cc.TMXObjectGroupInfo.prototype={constructor:cc.TMXObjectGroupInfo,getProperties:function(){return this.properties},setProperties:function(E){this.properties=E}},cc.TMXTilesetInfo=function(){this.name="",this.firstGid=0,this.spacing=0,this.margin=0,this.sourceImage=null,this.imageSize=cc.size(0,0),this.tileOffset=cc.v2(0,0),this._tileSize=cc.size(0,0)},cc.TMXTilesetInfo.prototype={constructor:cc.TMXTilesetInfo,rectForGID:function(E,D){var I=D||cc.rect(0,0,0,0);I.width=this._tileSize.width,I.height=this._tileSize.height,E&=cc.TiledMap.TileFlag.FLIPPED_MASK,E-=parseInt(this.firstGid,10);var M=parseInt((this.imageSize.width-2*this.margin+this.spacing)/(this._tileSize.width+this.spacing),10);return I.x=parseInt(E%M*(this._tileSize.width+this.spacing)+this.margin,10),I.y=parseInt(parseInt(E/M,10)*(this._tileSize.height+this.spacing)+this.margin,10),I}},cc.TMXMapInfo=function(E,D,I,M,N){this.properties=[],this.orientation=null,this.parentElement=null,this.parentGID=null,this.layerAttrs=0,this.storingCharacters=!1,this.currentString=null,this.renderOrder=cc.TiledMap.RenderOrder.RightDown,this._supportVersion=[1,2,0],this._parser=new cc.SAXParser,this._objectGroups=[],this._allChildren=[],this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),this._layers=[],this._tilesets=[],this._imageLayers=[],this._tileProperties={},this._tileAnimations={},this._tsxMap=null,this._textures=null,this._staggerAxis=null,this._staggerIndex=null,this._hexSideLength=0,this._imageLayerTextures=null,this.initWithXML(E,D,I,M,N)},cc.TMXMapInfo.prototype={constructor:cc.TMXMapInfo,getOrientation:function(){return this.orientation},setOrientation:function(E){this.orientation=E},getStaggerAxis:function(){return this._staggerAxis},setStaggerAxis:function(E){this._staggerAxis=E},getStaggerIndex:function(){return this._staggerIndex},setStaggerIndex:function(E){this._staggerIndex=E},getHexSideLength:function(){return this._hexSideLength},setHexSideLength:function(E){this._hexSideLength=E},getMapSize:function(){return cc.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(E){this._mapSize.width=E.width,this._mapSize.height=E.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(E){this._mapSize.width=E},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(E){this._mapSize.height=E},getTileSize:function(){return cc.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(E){this._tileSize.width=E.width,this._tileSize.height=E.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(E){this._tileSize.width=E},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(E){this._tileSize.height=E},getLayers:function(){return this._layers},setLayers:function(E){this._allChildren.push(E),this._layers.push(E)},getImageLayers:function(){return this._imageLayers},setImageLayers:function(E){this._allChildren.push(E),this._imageLayers.push(E)},getTilesets:function(){return this._tilesets},setTilesets:function(E){this._tilesets.push(E)},getObjectGroups:function(){return this._objectGroups},setObjectGroups:function(E){this._allChildren.push(E),this._objectGroups.push(E)},getAllChildren:function(){return this._allChildren},getParentElement:function(){return this.parentElement},setParentElement:function(E){this.parentElement=E},getParentGID:function(){return this.parentGID},setParentGID:function(E){this.parentGID=E},getLayerAttribs:function(){return this.layerAttrs},setLayerAttribs:function(E){this.layerAttrs=E},getStoringCharacters:function(){return this.storingCharacters},setStoringCharacters:function(E){this.storingCharacters=E},getProperties:function(){return this.properties},setProperties:function(E){this.properties=E},initWithXML:function(E,D,I,M,N){return this._tilesets.length=0,this._layers.length=0,this._imageLayers.length=0,this._tsxMap=D,this._textures=I,this._imageLayerTextures=N,this._textureSizes=M,this._objectGroups.length=0,this._allChildren.length=0,this.properties.length=0,this._tileProperties={},this._tileAnimations={},this.currentString="",this.storingCharacters=!1,this.layerAttrs=cc.TMXLayerInfo.ATTRIB_NONE,this.parentElement=cc.TiledMap.NONE,this.parseXMLString(E)},parseXMLString:function(E,D){var I,M=this._parser._parseXML(E).documentElement,N=M.getAttribute("orientation"),k=M.getAttribute("staggeraxis"),F=M.getAttribute("staggerindex"),G=M.getAttribute("hexsidelength"),V=M.getAttribute("renderorder"),j=M.getAttribute("version")||"1.0.0";if(M.nodeName==="map"){for(var H=j.split("."),U=this._supportVersion,X=0;X<U.length;X++){var Y=parseInt(H[X])||0;if(U[X]<Y){cc.logID(7216,j);break}}N==="orthogonal"?this.orientation=cc.TiledMap.Orientation.ORTHO:N==="isometric"?this.orientation=cc.TiledMap.Orientation.ISO:N==="hexagonal"?this.orientation=cc.TiledMap.Orientation.HEX:N!==null&&cc.logID(7217,N),this.renderOrder=V==="right-up"?cc.TiledMap.RenderOrder.RightUp:V==="left-up"?cc.TiledMap.RenderOrder.LeftUp:V==="left-down"?cc.TiledMap.RenderOrder.LeftDown:cc.TiledMap.RenderOrder.RightDown,k==="x"?this.setStaggerAxis(cc.TiledMap.StaggerAxis.STAGGERAXIS_X):k==="y"&&this.setStaggerAxis(cc.TiledMap.StaggerAxis.STAGGERAXIS_Y),F==="odd"?this.setStaggerIndex(cc.TiledMap.StaggerIndex.STAGGERINDEX_ODD):F==="even"&&this.setStaggerIndex(cc.TiledMap.StaggerIndex.STAGGERINDEX_EVEN),G&&this.setHexSideLength(parseFloat(G));var z=cc.size(0,0);z.width=parseFloat(M.getAttribute("width")),z.height=parseFloat(M.getAttribute("height")),this.setMapSize(z),(z=cc.size(0,0)).width=parseFloat(M.getAttribute("tilewidth")),z.height=parseFloat(M.getAttribute("tileheight")),this.setTileSize(z),this.properties=R(M)}var W=M.getElementsByTagName("tileset");for(M.nodeName!=="map"&&(W=[]).push(M),I=0;I<W.length;I++){var Z=W[I],Q=Z.getAttribute("source");if(Q){var ee=parseInt(Z.getAttribute("firstgid")),te=this._tsxMap[Q];te&&this.parseXMLString(te,ee)}else{var re=Z.getElementsByTagName("image"),ie=re.length>1,ne=re[0],he=ne.getAttribute("source");he=he.replace(/\\/g,"/");var pe=Z.getElementsByTagName("tile"),K=pe&&pe.length||1,ue=null,le=Z.getAttribute("name")||"",ce=parseInt(Z.getAttribute("spacing"))||0,_e=parseInt(Z.getAttribute("margin"))||0,oe=parseInt(D);oe||(oe=parseInt(Z.getAttribute("firstgid"))||0);var de=cc.size(0,0);de.width=parseFloat(Z.getAttribute("tilewidth")),de.height=parseFloat(Z.getAttribute("tileheight"));var me=Z.getElementsByTagName("tileoffset")[0],ye=cc.v2(0,0);me&&(ye.x=parseFloat(me.getAttribute("x")),ye.y=parseFloat(me.getAttribute("y")));for(var ge=null,we=0;we<K;we++)if(ge&&!ie||((ge=new cc.TMXTilesetInfo).name=le,ge.firstGid=oe,ge.spacing=ce,ge.margin=_e,ge._tileSize=de,ge.tileOffset=ye,ge.sourceImage=this._textures[he],ge.imageSize=this._textureSizes[he]||ge.imageSize,ge.sourceImage||cc.errorID(7221,he),this.setTilesets(ge)),ue=pe&&pe[we]){this.parentGID=parseInt(oe)+parseInt(ue.getAttribute("id")||0);var Te=ue.getElementsByTagName("image");if(Te&&Te.length>0){var Ee=(ne=Te[0]).getAttribute("source");Ee=Ee.replace(/\\/g,"/"),ge.sourceImage=this._textures[Ee],ge.sourceImage||cc.errorID(7221,Ee);var De=cc.size(0,0);De.width=parseFloat(ne.getAttribute("width")),De.height=parseFloat(ne.getAttribute("height")),ge._tileSize=De,ge.firstGid=this.parentGID}this._tileProperties[this.parentGID]=R(ue);var fe=ue.getElementsByTagName("animation");if(fe&&fe.length>0){var Ce=fe[0].getElementsByTagName("frame"),Se={frames:[],dt:0,frameIdx:0};this._tileAnimations[this.parentGID]=Se;for(var be=Se.frames,Re=0;Re<Ce.length;Re++){var Ve=Ce[Re],Pe=parseInt(oe)+parseInt(Ve.getAttribute("tileid")),ke=parseFloat(Ve.getAttribute("duration"));be.push({tileid:Pe,duration:ke/1e3,grid:null})}}}}}var Ne=M.childNodes;for(I=0;I<Ne.length;I++){var Ae=Ne[I];if(!this._shouldIgnoreNode(Ae)){if(Ae.nodeName==="imagelayer"){var Oe=this._parseImageLayer(Ae);Oe&&this.setImageLayers(Oe)}if(Ae.nodeName==="layer"){var Fe=this._parseLayer(Ae);this.setLayers(Fe)}if(Ae.nodeName==="objectgroup"){var nt=this._parseObjectGroup(Ae);this.setObjectGroups(nt)}}}return M},_shouldIgnoreNode:function(E){return E.nodeType===3||E.nodeType===8||E.nodeType===4},_parseImageLayer:function(E){var D=E.getElementsByTagName("image");if(!D||D.length==0)return null;var I=new cc.TMXImageLayerInfo;I.name=E.getAttribute("name"),I.offset.x=parseFloat(E.getAttribute("offsetx"))||0,I.offset.y=parseFloat(E.getAttribute("offsety"))||0;var M=E.getAttribute("visible");I.visible=M!=="0";var N=E.getAttribute("opacity")||1;I.opacity=parseInt(255*parseFloat(N))||255;var k=D[0],F=k.getAttribute("source");return I.sourceImage=this._imageLayerTextures[F],I.width=parseInt(k.getAttribute("width"))||0,I.height=parseInt(k.getAttribute("height"))||0,I.trans=O(k.getAttribute("trans")),I.sourceImage?I:(cc.errorID(7221,F),null)},_parseLayer:function(E){var D=E.getElementsByTagName("data")[0],I=new cc.TMXLayerInfo;I.name=E.getAttribute("name");var M=cc.size(0,0);M.width=parseFloat(E.getAttribute("width")),M.height=parseFloat(E.getAttribute("height")),I._layerSize=M;var N=E.getAttribute("visible");I.visible=N!=="0";var k=E.getAttribute("opacity")||1;I._opacity=parseInt(255*parseFloat(k)),I.offset=cc.v2(parseFloat(E.getAttribute("offsetx"))||0,parseFloat(E.getAttribute("offsety"))||0);for(var F="",G=0;G<D.childNodes.length;G++)F+=D.childNodes[G].nodeValue;F=F.trim();var V,j=D.getAttribute("compression"),H=D.getAttribute("encoding");if(j&&j!=="gzip"&&j!=="zlib")return cc.logID(7218),null;switch(j){case"gzip":V=S.unzipBase64AsArray(F,4);break;case"zlib":V=w(new T.Inflate(S.Base64.decodeAsArray(F,1)).decompress());break;case null:case"":if(H==="base64")V=S.Base64.decodeAsArray(F,4);else if(H==="csv"){V=[];for(var U=F.split(","),X=0;X<U.length;X++)V.push(parseInt(U[X]))}else{var Y=D.getElementsByTagName("tile");V=[];for(var z=0;z<Y.length;z++)V.push(parseInt(Y[z].getAttribute("gid")))}break;default:this.layerAttrs===cc.TMXLayerInfo.ATTRIB_NONE&&cc.logID(7219)}return V&&(I._tiles=new Uint32Array(V)),I.properties=R(E),I},_parseObjectGroup:function(E){var D=new cc.TMXObjectGroupInfo;D.name=E.getAttribute("name")||"",D.offset=cc.v2(parseFloat(E.getAttribute("offsetx")),parseFloat(E.getAttribute("offsety")));var I=E.getAttribute("opacity")||1;D._opacity=parseInt(255*parseFloat(I));var M=E.getAttribute("visible");M&&parseInt(M)===0&&(D.visible=!1);var N=E.getAttribute("color");N&&D._color.fromHEX(N);var k=E.getAttribute("draworder");k&&(D._draworder=k),D.setProperties(R(E));var F=E.getElementsByTagName("object");if(F){for(var G=0;G<F.length;G++){var V=F[G],j={};j.id=V.getAttribute("id")||G,j.name=V.getAttribute("name")||"",j.width=parseFloat(V.getAttribute("width"))||0,j.height=parseFloat(V.getAttribute("height"))||0,j.x=parseFloat(V.getAttribute("x"))||0,j.y=parseFloat(V.getAttribute("y"))||0,j.rotation=parseFloat(V.getAttribute("rotation"))||0,R(V,j);var H=V.getAttribute("visible");j.visible=!(H&&parseInt(H)===0);var U=V.getElementsByTagName("text");if(U&&U.length>0){var X=U[0];j.type=cc.TiledMap.TMXObjectType.TEXT,j.wrap=X.getAttribute("wrap")=="1",j.color=O(X.getAttribute("color")),j.halign=B(X.getAttribute("halign")),j.valign=A(X.getAttribute("valign")),j.pixelsize=parseInt(X.getAttribute("pixelsize"))||16,j.text=X.childNodes[0].nodeValue}var Y=V.getAttribute("gid");Y&&(j.gid=parseInt(Y),j.type=cc.TiledMap.TMXObjectType.IMAGE);var z=V.getElementsByTagName("ellipse");z&&z.length>0&&(j.type=cc.TiledMap.TMXObjectType.ELLIPSE);var W=V.getElementsByTagName("polygon");if(W&&W.length>0){j.type=cc.TiledMap.TMXObjectType.POLYGON;var Z=W[0].getAttribute("points");Z&&(j.points=this._parsePointsString(Z))}var Q=V.getElementsByTagName("polyline");if(Q&&Q.length>0){j.type=cc.TiledMap.TMXObjectType.POLYLINE;var ee=Q[0].getAttribute("points");ee&&(j.polylinePoints=this._parsePointsString(ee))}j.type||(j.type=cc.TiledMap.TMXObjectType.RECT),D._objects.push(j)}k!=="index"&&D._objects.sort(function(te,re){return te.y-re.y})}return D},_parsePointsString:function(E){if(!E)return null;for(var D=[],I=E.split(" "),M=0;M<I.length;M++){var N=I[M].split(",");D.push({x:parseFloat(N[0]),y:parseFloat(N[1])})}return D},setTileAnimations:function(E){this._tileAnimations=E},getTileAnimations:function(){return this._tileAnimations},getTileProperties:function(){return this._tileProperties},setTileProperties:function(E){this._tileProperties=E},getCurrentString:function(){return this.currentString},setCurrentString:function(E){this.currentString=E}};var P=cc.TMXMapInfo.prototype;_.getset(P,"mapWidth",P._getMapWidth,P._setMapWidth),_.getset(P,"mapHeight",P._getMapHeight,P._setMapHeight),_.getset(P,"tileWidth",P._getTileWidth,P._setTileWidth),_.getset(P,"tileHeight",P._getTileHeight,P._setTileHeight),cc.TMXLayerInfo.ATTRIB_NONE=1,cc.TMXLayerInfo.ATTRIB_BASE64=2,cc.TMXLayerInfo.ATTRIB_GZIP=4,cc.TMXLayerInfo.ATTRIB_ZLIB=8},{"../compression/ZipUtils":22,"../compression/zlib.min":25,"../core/platform/CCSAXParser":203,"../core/platform/js":217}],344:[function(L,S){var T,_=L("../core/value-types"),w=(T=L("../core/assets/material/material-variant"))&&T.__esModule?T:{default:T},B=L("../core/components/CCRenderComponent"),A=L("../core/assets/material/CCMaterial"),O=L("../core/renderer/render-flow"),R=cc.mat4(),P=cc.v2(),E=cc.v2(),D=cc.v2(),I={row:0,col:0},M=cc.Class({name:"cc.TiledUserNodeData",extends:cc.Component,ctor:function(){this._index=-1,this._row=-1,this._col=-1,this._tiledLayer=null}}),N=cc.Class({name:"cc.TiledLayer",extends:B,editor:{inspector:"packages://inspector/inspectors/comps/tiled-layer.js"},ctor:function(){this._userNodeGrid={},this._userNodeMap={},this._userNodeDirty=!1,this._tiledTiles=[],this._tilesetIndexArr=[],this._tilesetIndexToArrIndex={},this._texIdToMatIndex={},this._viewPort={x:-1,y:-1,width:-1,height:-1},this._cullingRect={leftDown:{row:-1,col:-1},rightTop:{row:-1,col:-1}},this._cullingDirty=!0,this._rightTop={row:-1,col:-1},this._layerInfo=null,this._mapInfo=null,this._topOffset=0,this._downOffset=0,this._leftOffset=0,this._rightOffset=0,this._tiles=[],this._vertices=[],this._verticesDirty=!0,this._layerName="",this._layerOrientation=null,this._texGrids=null,this._textures=null,this._tilesets=null,this._leftDownToCenterX=0,this._leftDownToCenterY=0,this._hasTiledNodeGrid=!1,this._hasAniGrid=!1,this._animations=null,this._enableCulling=cc.macro.ENABLE_TILEDMAP_CULLING},_hasTiledNode:function(){return this._hasTiledNodeGrid},_hasAnimation:function(){return this._hasAniGrid},enableCulling:function(k){this._enableCulling!=k&&(this._enableCulling=k,this._cullingDirty=!0)},addUserNode:function(k){var F=k.getComponent(M);return F?(cc.warn("CCTiledLayer:addUserNode node has been added"),!1):(F=k.addComponent(M),k.parent=this.node,k._renderFlag|=O.FLAG_BREAK_FLOW,this._userNodeMap[k._id]=F,F._row=-1,F._col=-1,F._tiledLayer=this,this._nodeLocalPosToLayerPos(k,P),this._positionToRowCol(P.x,P.y,I),this._addUserNodeToGrid(F,I),this._updateCullingOffsetByUserNode(k),k.on(cc.Node.EventType.POSITION_CHANGED,this._userNodePosChange,F),k.on(cc.Node.EventType.SIZE_CHANGED,this._userNodeSizeChange,F),!0)},removeUserNode:function(k){var F=k.getComponent(M);return F?(k.off(cc.Node.EventType.POSITION_CHANGED,this._userNodePosChange,F),k.off(cc.Node.EventType.SIZE_CHANGED,this._userNodeSizeChange,F),this._removeUserNodeFromGrid(F),delete this._userNodeMap[k._id],k._removeComponent(F),F.destroy(),k.removeFromParent(!0),k._renderFlag&=~O.FLAG_BREAK_FLOW,!0):(cc.warn("CCTiledLayer:removeUserNode node is not exist"),!1)},destroyUserNode:function(k){this.removeUserNode(k),k.destroy()},_nodeLocalPosToLayerPos:function(k,F){F.x=k.x+this._leftDownToCenterX,F.y=k.y+this._leftDownToCenterY},_getNodesByRowCol:function(k,F){var G=this._userNodeGrid[k];return G?G[F]:null},_getNodesCountByRow:function(k){var F=this._userNodeGrid[k];return F?F.count:0},_updateAllUserNode:function(){for(var k in this._userNodeGrid={},this._userNodeMap){var F=this._userNodeMap[k];this._nodeLocalPosToLayerPos(F.node,P),this._positionToRowCol(P.x,P.y,I),this._addUserNodeToGrid(F,I),this._updateCullingOffsetByUserNode(F.node)}},_updateCullingOffsetByUserNode:function(k){this._topOffset<k.height&&(this._topOffset=k.height),this._downOffset<k.height&&(this._downOffset=k.height),this._leftOffset<k.width&&(this._leftOffset=k.width),this._rightOffset<k.width&&(this._rightOffset=k.width)},_userNodeSizeChange:function(){var k=this.node;this._tiledLayer._updateCullingOffsetByUserNode(k)},_userNodePosChange:function(){var k=this.node,F=this._tiledLayer;F._nodeLocalPosToLayerPos(k,P),F._positionToRowCol(P.x,P.y,I),F._limitInLayer(I),I.row===this._row&&I.col===this._col||(F._removeUserNodeFromGrid(this),F._addUserNodeToGrid(this,I))},_removeUserNodeFromGrid:function(k){var F=k._row,G=k._col,V=k._index,j=this._userNodeGrid[F],H=j&&j[G];H&&(j.count--,H.count--,H.list[V]=null,H.count<=0&&(H.list.length=0,H.count=0)),k._row=-1,k._col=-1,k._index=-1,this._userNodeDirty=!0},_limitInLayer:function(k){var F=k.row,G=k.col;F<0&&(k.row=0),F>this._rightTop.row&&(k.row=this._rightTop.row),G<0&&(k.col=0),G>this._rightTop.col&&(k.col=this._rightTop.col)},_addUserNodeToGrid:function(k,F){var G=F.row,V=F.col,j=this._userNodeGrid[G]=this._userNodeGrid[G]||{count:0},H=j[V]=j[V]||{count:0,list:[]};k._row=G,k._col=V,k._index=H.list.length,j.count++,H.count++,H.list.push(k),this._userNodeDirty=!0},_isUserNodeDirty:function(){return this._userNodeDirty},_setUserNodeDirty:function(k){this._userNodeDirty=k},onEnable:function(){this._super(),this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this._syncAnchorPoint,this),this._activateMaterial()},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this._syncAnchorPoint,this)},_syncAnchorPoint:function(){var k=this.node;this._leftDownToCenterX=k.width*k.anchorX*k.scaleX,this._leftDownToCenterY=k.height*k.anchorY*k.scaleY,this._cullingDirty=!0},onDestroy:function(){this._super(),this._buffer&&(this._buffer.destroy(),this._buffer=null),this._renderDataList=null},getLayerName:function(){return this._layerName},setLayerName:function(k){this._layerName=k},getProperty:function(k){return this._properties[k]},getPositionAt:function(k,F){var G,V;switch(F!==void 0?(G=Math.floor(k),F=Math.floor(F)):(G=Math.floor(k.x),F=Math.floor(k.y)),this._layerOrientation){case cc.TiledMap.Orientation.ORTHO:V=this._positionForOrthoAt(G,F);break;case cc.TiledMap.Orientation.ISO:V=this._positionForIsoAt(G,F);break;case cc.TiledMap.Orientation.HEX:V=this._positionForHexAt(G,F)}return V},_isInvalidPosition:function(k,F){if(k&&typeof k=="object"){var G=k;F=G.y,k=G.x}return k>=this._layerSize.width||F>=this._layerSize.height||k<0||F<0},_positionForIsoAt:function(k,F){var G=0,V=0,j=Math.floor(k)+Math.floor(F)*this._layerSize.width,H=this._tiles[j];if(H){var U=(H&cc.TiledMap.TileFlag.FLIPPED_MASK)>>>0,X=this._texGrids[U].tileset.tileOffset;G=X.x,V=X.y}return cc.v2(.5*this._mapTileSize.width*(this._layerSize.height+k-F-1)+G,.5*this._mapTileSize.height*(this._layerSize.width-k+this._layerSize.height-F-2)-V)},_positionForOrthoAt:function(k,F){var G=0,V=0,j=Math.floor(k)+Math.floor(F)*this._layerSize.width,H=this._tiles[j];if(H){var U=(H&cc.TiledMap.TileFlag.FLIPPED_MASK)>>>0,X=this._texGrids[U].tileset.tileOffset;G=X.x,V=X.y}return cc.v2(k*this._mapTileSize.width+G,(this._layerSize.height-F-1)*this._mapTileSize.height-V)},_positionForHexAt:function(k,F){var G,V=this._mapTileSize.width,j=this._mapTileSize.height,H=this._layerSize.height,U=Math.floor(k)+Math.floor(F)*this._layerSize.width,X=this._tiles[U];G=this._texGrids[X]?this._texGrids[X].tileset.tileOffset:{x:0,y:0};var Y=this._staggerIndex===cc.TiledMap.StaggerIndex.STAGGERINDEX_ODD?1:-1,z=0,W=0,Z=0,Q=0;switch(this._staggerAxis){case cc.TiledMap.StaggerAxis.STAGGERAXIS_Y:Z=0,F%2==1&&(Z=V/2*Y),z=k*V+Z+G.x,W=(H-F-1)*(j-(j-this._hexSideLength)/2)-G.y;break;case cc.TiledMap.StaggerAxis.STAGGERAXIS_X:Q=0,k%2==1&&(Q=j/2*-Y),z=k*(V-(V-this._hexSideLength)/2)+G.x,W=(H-F-1)*j+Q-G.y}return cc.v2(z,W)},setTilesGIDAt:function(k,F,G,V){if(k&&k.length!==0&&!(V<=0)){G<0&&(G=0),F<0&&(F=0);for(var j=0,H=F+V,U=G;;U++)for(var X=F;X<H;X++){if(j>=k.length)return;this._updateTileForGID(k[j],X,U),j++}}},setTileGIDAt:function(k,F,G,V){if(F===void 0)throw new Error("cc.TiledLayer.setTileGIDAt(): pos should be non-null");var j;V===void 0&&F instanceof cc.Vec2?(j=F,V=G):(D.x=F,D.y=G,j=D);var H=k&cc.TiledMap.TileFlag.FLIPPED_MASK;if(j.x=Math.floor(j.x),j.y=Math.floor(j.y),this._isInvalidPosition(j))throw new Error("cc.TiledLayer.setTileGIDAt(): invalid position");this._tiles&&this._tilesets&&this._tilesets.length!=0?H!==0&&H<this._tilesets[0].firstGid?cc.logID(7239,k):(V=V||0,this._updateTileForGID((k|V)>>>0,j.x,j.y)):cc.logID(7238)},_updateTileForGID:function(k,F,G){var V=0|F+G*this._layerSize.width;if(!(V>=this._tiles.length)&&k!==this._tiles[V]){var j=(k&cc.TiledMap.TileFlag.FLIPPED_MASK)>>>0,H=this._texGrids[j],U=H&&H.texId;H?(this._tiles[V]=k,this._updateVertex(F,G),this._buildMaterial(U)):this._tiles[V]=0,this._cullingDirty=!0}},getTiles:function(){return this._tiles},getTileGIDAt:function(k,F){if(k===void 0)throw new Error("cc.TiledLayer.getTileGIDAt(): pos should be non-null");var G=k;if(F===void 0&&(G=k.x,F=k.y),this._isInvalidPosition(G,F))throw new Error("cc.TiledLayer.getTileGIDAt(): invalid position");if(!this._tiles)return cc.logID(7237),null;var V=Math.floor(G)+Math.floor(F)*this._layerSize.width;return(this._tiles[V]&cc.TiledMap.TileFlag.FLIPPED_MASK)>>>0},getTileFlagsAt:function(k,F){if(!k)throw new Error("TiledLayer.getTileFlagsAt: pos should be non-null");if(F!==void 0&&(k=cc.v2(k,F)),this._isInvalidPosition(k))throw new Error("TiledLayer.getTileFlagsAt: invalid position");if(!this._tiles)return cc.logID(7240),null;var G=Math.floor(k.x)+Math.floor(k.y)*this._layerSize.width;return(this._tiles[G]&cc.TiledMap.TileFlag.FLIPPED_ALL)>>>0},_setCullingDirty:function(k){this._cullingDirty=k},_isCullingDirty:function(){return this._cullingDirty},_updateViewPort:function(k,F,G,V){if(this._viewPort.width!==G||this._viewPort.height!==V||this._viewPort.x!==k||this._viewPort.y!==F){this._viewPort.x=k,this._viewPort.y=F,this._viewPort.width=G,this._viewPort.height=V;var j=1;this._layerOrientation===cc.TiledMap.Orientation.ISO&&(j=2);var H=this._viewPort.x-this._offset.x+this._leftDownToCenterX,U=this._viewPort.y-this._offset.y+this._leftDownToCenterY,X=H-this._leftOffset,Y=U-this._downOffset,z=H+G+this._rightOffset,W=U+V+this._topOffset,Z=this._cullingRect.leftDown,Q=this._cullingRect.rightTop;X<0&&(X=0),Y<0&&(Y=0),this._positionToRowCol(X,Y,I),I.row-=j,I.col-=j,I.row=I.row>0?I.row:0,I.col=I.col>0?I.col:0,I.row===Z.row&&I.col===Z.col||(Z.row=I.row,Z.col=I.col,this._cullingDirty=!0),z<0||W<0?(I.row=-1,I.col=-1):(this._positionToRowCol(z,W,I),I.row++,I.col++),I.row>this._rightTop.row&&(I.row=this._rightTop.row),I.col>this._rightTop.col&&(I.col=this._rightTop.col),I.row===Q.row&&I.col===Q.col||(Q.row=I.row,Q.col=I.col,this._cullingDirty=!0)}},_positionToRowCol:function(k,F,G){var V=cc.TiledMap,j=V.Orientation,H=V.StaggerAxis,U=this._mapTileSize.width,X=this._mapTileSize.height,Y=.5*U,z=.5*X,W=0,Z=0,Q=0,ee=0,te=this._staggerAxis;switch(this._layerSize.width,this._layerOrientation){case j.ORTHO:Z=Math.floor(k/U),W=Math.floor(F/X);break;case j.ISO:Z=Math.floor(k/Y),W=Math.floor(F/z);break;case j.HEX:te===H.STAGGERAXIS_Y?(Q=(W=Math.floor(F/(X-this._diffY1)))%2==1?Y*this._odd_even:0,Z=Math.floor((k-Q)/U)):(ee=(Z=Math.floor(k/(U-this._diffX1)))%2==1?z*-this._odd_even:0,W=Math.floor((F-ee)/X))}return G.row=W,G.col=Z,G},_updateCulling:function(){if(this._enableCulling){this.node._updateWorldMatrix(),_.Mat4.invert(R,this.node._worldMatrix);var k=cc.visibleRect,F=cc.Camera.findCamera(this.node);F&&(P.x=0,P.y=0,E.x=P.x+k.width,E.y=P.y+k.height,F.getScreenToWorldPoint(P,P),F.getScreenToWorldPoint(E,E),_.Vec2.transformMat4(P,P,R),_.Vec2.transformMat4(E,E,R),this._updateViewPort(P.x,P.y,E.x-P.x,E.y-P.y))}},getLayerOrientation:function(){return this._layerOrientation},getProperties:function(){return this._properties},_updateVertex:function(k,F){var G=cc.TiledMap,V=G.TileFlag.FLIPPED_MASK,j=G.StaggerAxis,H=G.Orientation,U=this._vertices,X=this._layerOrientation,Y=this._tiles;if(Y){var z,W,Z,Q,ee,te,re,ie=this._rightTop,ne=this._mapTileSize.width,he=this._mapTileSize.height,pe=.5*ne,K=.5*he,ue=this._layerSize.height,le=this._layerSize.width,ce=this._texGrids;X===H.HEX&&(Q=this._staggerAxis,ee=this._diffX1,te=this._diffY1,re=this._odd_even);var _e,oe,de,me,ye=0,ge=0,we=0,Te=0,Ee=F*le+k;if(z=ce[oe=(Y[Ee]&V)>>>0]){switch(this._animations[oe]&&(this._hasAniGrid=this._hasAniGrid||!0),X){case H.ORTHO:W=(ye=k)*ne,Z=(ge=ue-F-1)*he;break;case H.ISO:W=pe*(ye=ue+k-F-1),Z=K*(ge=ue+le-k-F-2);break;case H.HEX:W=k*(ne-ee)+(Q===j.STAGGERAXIS_Y&&F%2==1?pe*re:0),Z=(ue-F-1)*(he-te)+(Q===j.STAGGERAXIS_X&&k%2==1?K*-re:0),ye=k,ge=ue-F-1}var De=U[ge]=U[ge]||{minCol:0,maxCol:0},fe=De[ye]=De[ye]||{};De.minCol>ye&&(De.minCol=ye),De.maxCol<ye&&(De.maxCol=ye),ie.row<ge&&(ie.row=ge),ie.col<ye&&(ie.col=ye),_e=z.tileset.tileOffset,W+=this._offset.x+_e.x,Z+=this._offset.y-_e.y,we=(we=-_e.y+z.tileset._tileSize.height-he)<0?0:we,de=_e.y<0?0:_e.y,me=-_e.x<0?0:-_e.x,Te=(Te=_e.x+z.tileset._tileSize.width-ne)<0?0:Te,this._rightOffset<me&&(this._rightOffset=me),this._leftOffset<Te&&(this._leftOffset=Te),this._topOffset<de&&(this._topOffset=de),this._downOffset<we&&(this._downOffset=we),fe.left=W,fe.bottom=Z,fe.index=Ee,this._cullingDirty=!0}}},_updateVertices:function(){if(this._vertices.length=0,this._tiles){var k=this._rightTop;k.row=-1,k.col=-1;var F=this._layerSize.height,G=this._layerSize.width;this._topOffset=0,this._downOffset=0,this._leftOffset=0,this._rightOffset=0,this._hasAniGrid=!1;for(var V=0;V<F;++V)for(var j=0;j<G;++j)this._updateVertex(j,V);this._verticesDirty=!1}},getTiledTileAt:function(k,F,G){if(this._isInvalidPosition(k,F))throw new Error("TiledLayer.getTiledTileAt: invalid position");if(!this._tiles)return cc.logID(7236),null;var V=Math.floor(k)+Math.floor(F)*this._layerSize.width,j=this._tiledTiles[V];if(!j&&G){var H=new cc.Node;return(j=H.addComponent(cc.TiledTile))._x=k,j._y=F,j._layer=this,j._updateInfo(),H.parent=this.node,j}return j},setTiledTileAt:function(k,F,G){if(this._isInvalidPosition(k,F))throw new Error("TiledLayer.setTiledTileAt: invalid position");if(!this._tiles)return cc.logID(7236),null;var V=Math.floor(k)+Math.floor(F)*this._layerSize.width;return this._tiledTiles[V]=G,this._cullingDirty=!0,this._hasTiledNodeGrid=!!G||this._tiledTiles.some(function(j){return!!j}),G},getTexture:function(k){return k=k||0,this._textures&&k>=0&&this._textures.length>k?this._textures[k]:null},getTextures:function(){return this._textures},setTexture:function(k){this.setTextures([k])},setTextures:function(k){this._textures=k,this._activateMaterial()},getLayerSize:function(){return this._layerSize},getMapTileSize:function(){return this._mapTileSize},getTileSet:function(k){return k=k||0,this._tilesets&&k>=0&&this._tilesets.length>k?this._tilesets[k]:null},getTileSets:function(){return this._tilesets},setTileSet:function(k){this.setTileSets([k])},setTileSets:function(k){this._tilesets=k;for(var F=this._textures=[],G=this._texGrids=[],V=0;V<k.length;V++){var j=k[V];j&&(F[V]=j.sourceImage)}cc.TiledMap.loadAllTextures(F,(function(){for(var H=0,U=k.length;H<U;++H){var X=k[H];X&&cc.TiledMap.fillTextureGrids(X,G,H)}this._prepareToRender()}).bind(this))},_traverseAllGrid:function(){var k=this._tiles,F=this._texGrids,G=this._tilesetIndexArr,V=this._tilesetIndexToArrIndex={},j=cc.TiledMap.TileFlag.FLIPPED_MASK;G.length=0;for(var H=0;H<k.length;H++){var U=k[H];if(U!==0){var X=F[U=(U&j)>>>0];if(X){var Y=X.texId;V[Y]===void 0&&(V[Y]=G.length,G.push(Y))}else cc.error("CCTiledLayer:_traverseAllGrid grid is null, gid is:",U)}}},_init:function(k,F,G,V,j){this._cullingDirty=!0,this._layerInfo=k,this._mapInfo=F;var H=k._layerSize;this._layerName=k.name,this._tiles=k._tiles,this._properties=k.properties,this._layerSize=H,this._minGID=k._minGID,this._maxGID=k._maxGID,this._opacity=k._opacity,this._renderOrder=F.renderOrder,this._staggerAxis=F.getStaggerAxis(),this._staggerIndex=F.getStaggerIndex(),this._hexSideLength=F.getHexSideLength(),this._animations=F.getTileAnimations(),this._tilesets=G,this._textures=V,this._texGrids=j,this._layerOrientation=F.orientation,this._mapTileSize=F.getTileSize();var U=this._mapTileSize.width,X=this._mapTileSize.height,Y=this._layerSize.width,z=this._layerSize.height;if(this._layerOrientation===cc.TiledMap.Orientation.HEX){var W=cc.TiledMap,Z=W.StaggerAxis,Q=W.StaggerIndex,ee=0,te=0;this._odd_even=this._staggerIndex===Q.STAGGERINDEX_ODD?1:-1,this._staggerAxis===Z.STAGGERAXIS_X?(this._diffX1=(U-this._hexSideLength)/2,this._diffY1=0,te=X*(z+.5),ee=(U+this._hexSideLength)*Math.floor(Y/2)+U*(Y%2)):(this._diffX1=0,this._diffY1=(X-this._hexSideLength)/2,ee=U*(Y+.5),te=(X+this._hexSideLength)*Math.floor(z/2)+X*(z%2)),this.node.setContentSize(ee,te)}else if(this._layerOrientation===cc.TiledMap.Orientation.ISO){var re=Y+z;this.node.setContentSize(.5*U*re,.5*X*re)}else this.node.setContentSize(Y*U,z*X);this._offset=cc.v2(k.offset.x,-k.offset.y),this._useAutomaticVertexZ=!1,this._vertexZvalue=0,this._syncAnchorPoint(),this._prepareToRender()},_prepareToRender:function(){this._updateVertices(),this._traverseAllGrid(),this._updateAllUserNode(),this._activateMaterial()},_buildMaterial:function(k){var F=this._texIdToMatIndex;if(F[k]!==void 0)return null;var G=this._tilesetIndexArr,V=this._tilesetIndexToArrIndex,j=V[k];j===void 0&&(V[k]=j=G.length,G.push(k));var H=this._textures[k],U=this._materials[j];return U||(U=A.getBuiltinMaterial("2d-sprite")),(U=w.default.create(U,this)).define("CC_USE_MODEL",!0),U.setProperty("texture",H),this._materials[j]=U,F[k]=j,U},_activateMaterial:function(){var k=this._tilesetIndexArr;if(k.length!==0){for(var F=k.length,G=0;G<F;G++)this._buildMaterial(k[G]);this._materials.length=F,this.markForRender(!0)}else this.disableRender()}});cc.TiledLayer=S.exports=N},{"../core/assets/material/CCMaterial":81,"../core/assets/material/material-variant":88,"../core/components/CCRenderComponent":117,"../core/renderer/render-flow":228,"../core/value-types":286}],345:[function(L,S){L("./CCTMXXMLParser"),L("./CCTiledMapAsset"),L("./CCTiledLayer"),L("./CCTiledTile"),L("./CCTiledObjectGroup");var T=cc.Enum({ORTHO:0,HEX:1,ISO:2}),_=cc.Enum({NONE:0,MAP:1,LAYER:2,OBJECTGROUP:3,OBJECT:4,TILE:5}),w=cc.Enum({HORIZONTAL:2147483648,VERTICAL:1073741824,DIAGONAL:536870912,FLIPPED_ALL:4026531840,FLIPPED_MASK:268435455}),B=cc.Enum({STAGGERAXIS_X:0,STAGGERAXIS_Y:1}),A=cc.Enum({STAGGERINDEX_ODD:0,STAGGERINDEX_EVEN:1}),O=cc.Enum({RightDown:0,RightUp:1,LeftDown:2,LeftUp:3}),R=cc.Enum({RECT:0,ELLIPSE:1,POLYGON:2,POLYLINE:3,IMAGE:4,TEXT:5}),P=cc.Class({name:"cc.TiledMap",extends:cc.Component,editor:!1,ctor:function(){this._texGrids=[],this._textures=[],this._tilesets=[],this._animations=[],this._imageLayers=[],this._layers=[],this._groups=[],this._images=[],this._properties=[],this._tileProperties=[],this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0)},statics:{Orientation:T,Property:_,TileFlag:w,StaggerAxis:B,StaggerIndex:A,TMXObjectType:R,RenderOrder:O},properties:{_tmxFile:{default:null,type:cc.TiledMapAsset},tmxAsset:{get:function(){return this._tmxFile},set:function(E){this._tmxFile!==E&&(this._tmxFile=E,this._applyFile())},type:cc.TiledMapAsset}},getMapSize:function(){return this._mapSize},getTileSize:function(){return this._tileSize},getMapOrientation:function(){return this._mapOrientation},getObjectGroups:function(){return this._groups},getObjectGroup:function(E){for(var D=this._groups,I=0,M=D.length;I<M;I++){var N=D[I];if(N&&N.getGroupName()===E)return N}return null},enableCulling:function(E){for(var D=this._layers,I=0;I<D.length;++I)D[I].enableCulling(E)},getProperties:function(){return this._properties},getLayers:function(){return this._layers},getLayer:function(E){for(var D=this._layers,I=0,M=D.length;I<M;I++){var N=D[I];if(N&&N.getLayerName()===E)return N}return null},_changeLayer:function(E,D){for(var I=this._layers,M=0,N=I.length;M<N;M++){var k=I[M];if(k&&k.getLayerName()===E)return void(I[M]=D)}},getProperty:function(E){return this._properties[E.toString()]},getPropertiesForGID:function(E){return this._tileProperties[E]},__preload:function(){this._tmxFile&&this._applyFile()},onEnable:function(){this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this._syncAnchorPoint,this)},onDisable:function(){this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this._syncAnchorPoint,this)},_applyFile:function(){var E=this._tmxFile;if(E){for(var D=E.textures,I=E.textureNames,M=E.textureSizes,N={},k={},F=0;F<D.length;++F){var G=I[F];N[G]=D[F],k[G]=M[F]}var V={};D=E.imageLayerTextures,I=E.imageLayerTextureNames;for(var j=0;j<D.length;++j)V[I[j]]=D[j];for(var H=E.tsxFileNames,U=E.tsxFiles,X={},Y=0;Y<H.length;++Y)H[Y].length>0&&(X[H[Y]]=U[Y].text);var z=new cc.TMXMapInfo(E.tmxXmlStr,X,N,k,V),W=z.getTilesets();W&&W.length!==0||cc.logID(7241),this._buildWithMapInfo(z)}else this._releaseMapInfo()},_releaseMapInfo:function(){for(var E=this._layers,D=0,I=E.length;D<I;D++)E[D].node.removeFromParent(!0),E[D].node.destroy();E.length=0;for(var M=this._groups,N=0,k=M.length;N<k;N++)M[N].node.removeFromParent(!0),M[N].node.destroy();M.length=0;for(var F=this._images,G=0,V=F.length;G<V;G++)F[G].removeFromParent(!0),F[G].destroy();F.length=0},_syncAnchorPoint:function(){var E,D,I=this.node.getAnchorPoint(),M=this.node.width*I.x,N=this.node.height*(1-I.y);for(E=0,D=this._layers.length;E<D;E++)this._layers[E].node.setAnchorPoint(I);for(E=0,D=this._groups.length;E<D;E++){var k=this._groups[E],F=k.node;F.anchorX=.5,F.anchorY=.5,F.x=k._offset.x-M+F.width*F.anchorX,F.y=k._offset.y+N-F.height*F.anchorY}for(E=0,D=this._images.length;E<D;E++){var G=this._images[E];G.anchorX=.5,G.anchorY=.5,G.x=G._offset.x-M+G.width*G.anchorX,G.y=G._offset.y+N-G.height*G.anchorY}},_fillAniGrids:function(E,D){for(var I in D){var M=D[I];if(M)for(var N=M.frames,k=0;k<N.length;k++){var F=N[k];F.grid=E[F.tileid]}}},_buildLayerAndGroup:function(){var E=this._tilesets,D=this._texGrids,I=this._animations;D.length=0;for(var M=0,N=E.length;M<N;++M){var k=E[M];k&&cc.TiledMap.fillTextureGrids(k,D,M)}this._fillAniGrids(D,I);for(var F=this._layers,G=this._groups,V=this._images,j={},H=0,U=F.length;H<U;H++)j[F[H].node._name]=!0;for(var X=0,Y=G.length;X<Y;X++)j[G[X].node._name]=!0;for(var z=0,W=V.length;z<W;z++)j[V[z]._name]=!0;F=this._layers=[],G=this._groups=[],V=this._images=[];var Z=this._mapInfo,Q=this.node,ee=Z.getAllChildren(),te=this._textures,re=0,ie=0;if(ee&&ee.length>0)for(var ne=0,he=ee.length;ne<he;ne++){var pe=ee[ne],K=pe.name,ue=this.node.getChildByName(K);if(j[K]=!1,ue||((ue=new cc.Node).name=K,Q.addChild(ue)),ue.setSiblingIndex(ne),ue.active=pe.visible,pe instanceof cc.TMXLayerInfo){var le=ue.getComponent(cc.TiledLayer);le||(le=ue.addComponent(cc.TiledLayer)),le._init(pe,Z,E,te,D),pe.ownTiles=!1,F.push(le)}else if(pe instanceof cc.TMXObjectGroupInfo){var ce=ue.getComponent(cc.TiledObjectGroup);ce||(ce=ue.addComponent(cc.TiledObjectGroup)),ce._init(pe,Z,D),G.push(ce)}else if(pe instanceof cc.TMXImageLayerInfo){var _e=pe.sourceImage;ue.opacity=pe.opacity,ue.layerInfo=pe,ue._offset=cc.v2(pe.offset.x,-pe.offset.y);var oe=ue.getComponent(cc.Sprite);oe||(oe=ue.addComponent(cc.Sprite));var de=oe.spriteFrame||new cc.SpriteFrame;de.setTexture(_e),oe.spriteFrame=de,ue.width=_e.width,ue.height=_e.height,V.push(ue)}re=Math.max(re,ue.width),ie=Math.max(ie,ue.height)}for(var me=Q.children,ye=0,ge=me.length;ye<ge;ye++){var we=me[ye];j[we._name]&&we.destroy()}this.node.width=re,this.node.height=ie,this._syncAnchorPoint()},_buildWithMapInfo:function(E){this._mapInfo=E,this._mapSize=E.getMapSize(),this._tileSize=E.getTileSize(),this._mapOrientation=E.orientation,this._properties=E.properties,this._tileProperties=E.getTileProperties(),this._imageLayers=E.getImageLayers(),this._animations=E.getTileAnimations(),this._tilesets=E.getTilesets();var D=this._tilesets;this._textures.length=0;for(var I=[],M=0,N=D.length;M<N;++M){var k=D[M];k&&k.sourceImage&&(this._textures[M]=k.sourceImage,I.push(k.sourceImage))}for(var F=0;F<this._imageLayers.length;F++){var G=this._imageLayers[F];G&&G.sourceImage&&I.push(G.sourceImage)}cc.TiledMap.loadAllTextures(I,(function(){this._buildLayerAndGroup()}).bind(this))},update:function(E){var D=this._animations,I=this._texGrids;for(var M in D){var N=D[M],k=N.frames,F=k[N.frameIdx];N.dt+=E,F.duration<N.dt&&(N.dt=0,N.frameIdx++,N.frameIdx>=k.length&&(N.frameIdx=0),F=k[N.frameIdx]),I[M]=F.grid}}});cc.TiledMap=S.exports=P,cc.TiledMap.loadAllTextures=function(E,D){var I=E.length;if(I!==0)for(var M=0,N=function(){++M>=I&&D()},k=0;k<I;k++){var F=E[k];F.loaded?N():F.once("load",function(){N()})}else D()},cc.TiledMap.fillTextureGrids=function(E,D,I){var M=E.sourceImage;E.imageSize.width&&E.imageSize.height||(E.imageSize.width=M.width,E.imageSize.height=M.height);var N=E._tileSize.width,k=E._tileSize.height,F=M.width,G=M.height,V=E.spacing,j=E.margin,H=Math.floor((F-2*j+V)/(N+V)),U=Math.floor((G-2*j+V)/(k+V))*H,X=E.firstGid,Y=null,z=!!D[X],W=cc.macro.FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX?.5:0;U<=0&&(U=1);for(var Z=E.firstGid+U;X<Z&&(z&&!D[X]&&(z=!1),z||!D[X]);++X)Y={texId:I,tileset:E,x:0,y:0,width:N,height:k,t:0,l:0,r:0,b:0,gid:X},E.rectForGID(X,Y),Y.x+=W,Y.y+=W,Y.width-=2*W,Y.height-=2*W,Y.t=Y.y/G,Y.l=Y.x/F,Y.r=(Y.x+Y.width)/F,Y.b=(Y.y+Y.height)/G,D[X]=Y},cc.js.obsolete(cc.TiledMap.prototype,"cc.TiledMap.tmxFile","tmxAsset",!0),cc.js.get(cc.TiledMap.prototype,"mapLoaded",function(){return cc.errorID(7203),[]},!1)},{"./CCTMXXMLParser":343,"./CCTiledLayer":344,"./CCTiledMapAsset":346,"./CCTiledObjectGroup":348,"./CCTiledTile":349}],346:[function(L,S){var T=cc.Class({name:"cc.TiledMapAsset",extends:cc.Asset,properties:{tmxXmlStr:"",textures:{default:[],type:[cc.Texture2D]},textureNames:[cc.String],textureSizes:{default:[],type:[cc.Size]},imageLayerTextures:{default:[],type:[cc.Texture2D]},imageLayerTextureNames:[cc.String],tsxFiles:[cc.TextAsset],tsxFileNames:[cc.String]},statics:{preventDeferredLoadDependents:!0},createNode:!1});cc.TiledMapAsset=T,S.exports=T},{}],347:[function(L,S){var T,_=(T=L("../renderer/core/input-assembler"))&&T.__esModule?T:{default:T},w=cc.Class({name:"cc.TiledMapRenderDataList",ctor:function(){this._dataList=[],this._offset=0},_pushRenderData:function(){var B={};B.ia=new _.default,B.nodesRenderList=[],this._dataList.push(B)},popRenderData:function(B){this._offset>=this._dataList.length&&this._pushRenderData();var A=this._dataList[this._offset];A.nodesRenderList.length=0;var O=A.ia;return O._vertexBuffer=B._vb,O._indexBuffer=B._ib,O._start=B.indiceOffset,O._count=0,this._offset++,A},pushNodesList:function(B,A){B.nodesRenderList.push(A)},reset:function(){this._offset=0}});cc.TiledMapRenderDataList=S.exports=w},{"../renderer/core/input-assembler":309}],348:[function(L,S){var T=cc.Class({name:"cc.TiledObjectGroup",extends:cc.Component,getPositionOffset:function(){return this._positionOffset},getProperties:function(){return this._properties},getGroupName:function(){return this._groupName},getProperty:function(_){return this._properties[_.toString()]},getObject:function(_){for(var w=0,B=this._objects.length;w<B;w++){var A=this._objects[w];if(A&&A.name===_)return A}return null},getObjects:function(){return this._objects},_init:function(_,w,B){var A=cc.TiledMap,O=A.TMXObjectType,R=A.Orientation,P=A.StaggerAxis,E=A.TileFlag,D=E.FLIPPED_MASK,I=E.HORIZONTAL,M=E.VERTICAL;this._groupName=_.name,this._positionOffset=_.offset,this._mapInfo=w,this._properties=_.getProperties(),this._offset=cc.v2(_.offset.x,-_.offset.y),this._opacity=_._opacity;var N=w._mapSize,k=w._tileSize,F=0,G=0;if(w.orientation===R.HEX)w.getStaggerAxis()===P.STAGGERAXIS_X?(G=k.height*(N.height+.5),F=(k.width+w.getHexSideLength())*Math.floor(N.width/2)+k.width*(N.width%2)):(F=k.width*(N.width+.5),G=(k.height+w.getHexSideLength())*Math.floor(N.height/2)+k.height*(N.height%2));else if(w.orientation===R.ISO){var V=N.width+N.height;F=.5*k.width*V,G=.5*k.height*V}else F=N.width*k.width,G=N.height*k.height;this.node.setContentSize(F,G);for(var j=F*this.node.anchorX,H=G*(1-this.node.anchorY),U=_._objects,X={},Y=0,z=U.length;Y<z;Y++){var W=U[Y],Z=W.type;W.offset=cc.v2(W.x,W.y);var Q=W.points||W.polylinePoints;if(Q)for(var ee=0;ee<Q.length;ee++)Q[ee].y*=-1;if(R.ISO!==w.orientation)W.y=G-W.y;else{var te=W.x/k.height,re=W.y/k.height;W.x=.5*k.width*(N.height+te-re),W.y=.5*k.height*(N.width+N.height-te-re)}if(Z===O.TEXT){var ie="text"+W.id;X[ie]=!0;var ne=this.node.getChildByName(ie);ne||(ne=new cc.Node),ne.active=W.visible,ne.anchorX=0,ne.anchorY=1,ne.angle=-W.rotation,ne.x=W.x-j,ne.y=W.y-H,ne.name=ie,ne.parent=this.node,ne.color=W.color,ne.opacity=this._opacity,ne.setSiblingIndex(Y);var he=ne.getComponent(cc.Label);he||(he=ne.addComponent(cc.Label)),he.overflow=cc.Label.Overflow.SHRINK,he.lineHeight=W.height,he.string=W.text,he.horizontalAlign=W.halign,he.verticalAlign=W.valign,he.fontSize=W.pixelsize,ne.width=W.width,ne.height=W.height}if(Z===O.IMAGE){var pe=W.gid,K=B[(pe&D)>>>0];if(!K)continue;var ue=K.tileset,le="img"+W.id;X[le]=!0;var ce=this.node.getChildByName(le),_e=W.width||K.width,oe=W.height||K.height,de=ue.tileOffset.x,me=ue.tileOffset.y;ce instanceof cc.PrivateNode&&(ce.removeFromParent(),ce.destroy(),ce=null),ce||(ce=new cc.Node),R.ISO==w.orientation?(ce.anchorX=.5+de/_e,ce.anchorY=me/oe):(ce.anchorX=de/_e,ce.anchorY=me/oe),ce.active=W.visible,ce.angle=-W.rotation,ce.x=W.x-j,ce.y=W.y-H,ce.name=le,ce.parent=this.node,ce.opacity=this._opacity,ce.setSiblingIndex(Y);var ye=ce.getComponent(cc.Sprite);ye||(ye=ce.addComponent(cc.Sprite));var ge=ye.spriteFrame;ge||(ge=new cc.SpriteFrame),(pe&I)>>>0?ge.setFlipX(!0):ge.setFlipX(!1),(pe&M)>>>0?ge.setFlipY(!0):ge.setFlipY(!1),ge.setTexture(K.tileset.sourceImage,cc.rect(K)),ye.spriteFrame=ge,ye.setVertsDirty(),ce.width=_e,ce.height=oe}}this._objects=U;for(var we=this.node.children,Te=/^(?:img|text)\d+$/,Ee=0,De=we.length;Ee<De;Ee++){var fe=we[Ee],Ce=fe._name;Te.test(Ce)&&!X[Ce]&&fe.destroy()}}});cc.TiledObjectGroup=S.exports=T},{}],349:[function(L,S){var T=cc.Class({name:"cc.TiledTile",extends:cc.Component,editor:!1,ctor:function(){this._layer=null},properties:{_x:0,_y:0,x:{get:function(){return this._x},set:function(_){_!==this._x&&(this._layer&&this._layer._isInvalidPosition(_,this._y)?cc.warn("Invalid x, the valid value is between [%s] ~ [%s]",0,this._layer._layerSize.width):(this._resetTile(),this._x=_,this._updateInfo()))},type:cc.Integer},y:{get:function(){return this._y},set:function(_){_!==this._y&&(this._layer&&this._layer._isInvalidPosition(this._x,_)?cc.warn("Invalid y, the valid value is between [%s] ~ [%s]",0,this._layer._layerSize.height):(this._resetTile(),this._y=_,this._updateInfo()))},type:cc.Integer},gid:{get:function(){return this._layer?this._layer.getTileGIDAt(this._x,this._y):0},set:function(_){this._layer&&this._layer.setTileGIDAt(_,this._x,this._y)},type:cc.Integer}},onEnable:function(){var _=this.node.parent;this._layer=_.getComponent(cc.TiledLayer),this._resetTile(),this._updateInfo()},onDisable:function(){this._resetTile()},_resetTile:function(){this._layer&&this._layer.getTiledTileAt(this._x,this._y)===this&&this._layer.setTiledTileAt(this._x,this._y,null)},_updateInfo:function(){if(this._layer){var _=this._x,w=this._y;this._layer.getTiledTileAt(_,w)?cc.warn("There is already a TiledTile at [%s, %s]",_,w):(this.node.setPosition(this._layer.getPositionAt(_,w)),this._layer.setTiledTileAt(_,w,this))}}});cc.TiledTile=S.exports=T},{}],350:[function(L){L("./CCTiledMap"),L("./CCTiledMapRenderDataList"),L("./tiledmap-buffer"),L("./tmx-layer-assembler")},{"./CCTiledMap":345,"./CCTiledMapRenderDataList":347,"./tiledmap-buffer":351,"./tmx-layer-assembler":352}],351:[function(L,S){var T=cc.Class({name:"cc.TiledMapBuffer",extends:L("../core/renderer/webgl/quad-buffer"),_updateOffset:function(){var _=this._offsetInfo;_.vertexOffset=this.vertexOffset,_.indiceOffset=this.indiceOffset,_.byteOffset=this.byteOffset},adjust:function(_,w){this.vertexOffset+=_,this.indiceOffset+=w,this.indiceStart=this.indiceOffset,this.byteOffset=this.byteOffset+_*this._vertexBytes,this._dirty=!0}});cc.TiledMapBuffer=S.exports=T},{"../core/renderer/webgl/quad-buffer":257}],352:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../core/renderer/assembler"))&&_.__esModule?_:{default:_},B=L("../core/value-types");function A(me,ye){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ge,we){return ge.__proto__=we,ge})(me,ye)}var O=L("./CCTiledLayer"),R=L("./CCTiledMap"),P=R.TileFlag,E=P.FLIPPED_MASK,D=L("../core/renderer/"),I=L("../core/renderer/webgl/vertex-format").vfmtPosUvColor,M=parseInt(10922.5),N=R.RenderOrder,k=L("../core/renderer/render-flow"),F=cc.mat4(),G=cc.v3(),V={row:0,col:0},j={x:0,y:0},H={x:0,y:0},U={x:0,y:0},X={x:0,y:0},Y=null,z=null,W=0,Z=0,Q=0,ee=0,te=null,re=null,ie=null,ne=null,he=null,pe=null,K=null,ue=null;function le(me){me._updateLocalMatrix(),B.Mat4.mul(me._worldMatrix,te,me._matrix),me._renderFlag&=~(k.FLAG_TRANSFORM|k.FLAG_BREAK_FLOW),k.visitRootNode(me),me._renderFlag|=k.FLAG_BREAK_FLOW}function ce(){z._count!==0&&(re.material=Y.material,re.node=pe.node,re._flushIA(Y.ia),W>=M?(ne.uploadData(),ne.switchBuffer(),K=ne._vData,ue=ne._uintVData,Y=ie.popRenderData(ne),z=Y.ia,Z=0,W=0):(Y=ie.popRenderData(ne),z=Y.ia),Y.material=he)}function _e(me,ye){var ge=pe._getNodesByRowCol(me,ye);if(ge&&ge.count!=0){var we=ge.list,Te=0,Ee=0;for(ce(),re.worldMatDirty++;Te<ge.count;){var De=we[Ee];Ee++,De&&(le(De.node),Te!==Ee&&(we[Te]=De,De._index=Te),Te++)}we.length=Te,re.worldMatDirty--,ie.pushNodesList(Y,we),re._flush(),re.node=pe.node}}function oe(me,ye){j.x=me.l,j.y=me.t,H.x=me.r,H.y=me.t,U.x=me.l,U.y=me.b,X.x=me.r,X.y=me.b;var ge=null;(ye&P.DIAGONAL)>>>0&&(ge=H,H=U,U=ge),(ye&P.HORIZONTAL)>>>0&&(ge=j,j=H,H=ge,ge=U,U=X,X=ge),(ye&P.VERTICAL)>>>0&&(ge=j,j=U,U=ge,ge=H,H=X,X=ge)}var de=function(me){var ye,ge;function we(){return me.apply(this,arguments)||this}ge=me,(ye=we).prototype=Object.create(ge.prototype),ye.prototype.constructor=ye,A(ye,ge);var Te=we.prototype;return Te.updateRenderData=function(Ee){Ee._renderDataList||(Ee._buffer=new cc.TiledMapBuffer(D._handle,I),Ee._renderDataList=new cc.TiledMapRenderDataList)},Te.fillBuffers=function(Ee,De){if(Ee._vertices.length!==0){Ee._updateCulling();var fe=Ee.node;if(Q=Ee._leftDownToCenterX,ee=Ee._leftDownToCenterY,te=fe._worldMatrix,re=De,pe=Ee,ie=Ee._renderDataList,ne=Ee._buffer,Ee._isCullingDirty()||Ee._isUserNodeDirty()||Ee._hasAnimation()||Ee._hasTiledNode()){var Ce,Se;if(ne.reset(),Ee._enableCulling){var be=Ee._cullingRect;Ce=be.leftDown,Se=be.rightTop}else Ce=V,Se=Ee._rightTop;var Re=(Se.row-Ce.row+1)*(Se.col-Ce.col+1);switch(Re>M&&(Re=M),ne.request(4*Re,6*Re),Ee._renderOrder){case N.RightDown:this.traverseGrids(Ce,Se,-1,1);break;case N.LeftDown:this.traverseGrids(Ce,Se,-1,-1);break;case N.RightUp:this.traverseGrids(Ce,Se,1,1);break;case N.LeftUp:this.traverseGrids(Ce,Se,1,-1)}Ee._setCullingDirty(!1),Ee._setUserNodeDirty(!1)}else for(var Ve=null,Pe=null,ke=null,Ne=0;Ne<ie._offset;Ne++){if((Pe=(Ve=ie._dataList[Ne]).nodesRenderList).length>0){De.worldMatDirty++;for(var Ae=0;Ae<Pe.length;Ae++)if(ke=Pe[Ae])for(var Oe=0;Oe<ke.length;Oe++){var Fe=ke[Oe];Fe&&le(Fe.node)}De.worldMatDirty--,De._flush()}Ve.ia._count>0&&(De.material=Ve.material,De.node=fe,De._flushIA(Ve.ia))}Y=null,z=null,te=null,re=null,ie=null,ne=null,he=null,pe=null,K=null,ue=null}},Te.traverseGrids=function(Ee,De,fe,Ce){if(ie.reset(),!(De.row<0||De.col<0)){Y=ie.popRenderData(ne),z=Y.ia,K=ne._vData,ue=ne._uintVData,W=0,Z=0,he=null;var Se=pe.node,be=(Se.parent?Se.parent._opacity/255:1)*Se._opacity;Se._color._fastSetA(be);var Re,Ve,Pe,ke,Ne,Ae,Oe,Fe,nt=Se._color._val,Ze=pe._tiledTiles,Xe=pe._texGrids,$e=pe._tiles,ot=pe._texIdToMatIndex,ut=pe._materials,gt=pe._vertices,Ue=null,We=0,ht=0,Be=0,je=0,Qe=0,st=null,pt=-1,qe=0,rt=!0;for(fe==-1?(ke=De.row,Ne=Ee.row):(ke=Ee.row,Ne=De.row);(Ne-ke)*fe>=0;ke+=fe)for(Re=gt[ke],rt=(qe=pe._getNodesCountByRow(ke))==0&&Re!=null,Ce==1?(Ve=rt&&Ee.col<Re.minCol?Re.minCol:Ee.col,Pe=rt&&De.col>Re.maxCol?Re.maxCol:De.col):(Ve=rt&&De.col>Re.maxCol?Re.maxCol:De.col,Pe=rt&&Ee.col<Re.minCol?Re.minCol:Ee.col);(Pe-Ve)*Ce>=0;Ve+=Ce)(Ae=Re&&Re[Ve])?(Ue=Xe[((We=$e[Ae.index])&E)>>>0])&&(pt!==Ue.texId&&(pt!==-1&&ce(),Fe=ot[pt=Ue.texId],he=ut[Fe],Y.material=he),he&&(ht=Ae.left-Q,Be=Ae.bottom-ee,je=ht+(Oe=Ue.tileset._tileSize).width,Qe=Be+Oe.height,(st=Ze[Ae.index])?st.node.active&&(st.node._color._fastSetA(st.node._opacity*be/255),this.fillByTiledNode(st.node,K,ue,ht,je,Qe,Be)):(K[Z]=ht,K[Z+1]=Qe,ue[Z+4]=nt,K[Z+5]=ht,K[Z+6]=Be,ue[Z+9]=nt,K[Z+10]=je,K[Z+11]=Qe,ue[Z+14]=nt,K[Z+15]=je,K[Z+16]=Be,ue[Z+19]=nt),oe(Ue,We),K[Z+2]=j.x,K[Z+3]=j.y,K[Z+7]=U.x,K[Z+8]=U.y,K[Z+12]=H.x,K[Z+13]=H.y,K[Z+17]=X.x,K[Z+18]=X.y,Z+=20,ne.adjust(4,6),z._count+=6,W++,qe>0&&_e(ke,Ve),W>=M&&ce())):qe>0&&_e(ke,Ve);ne.uploadData(),z._count>0&&(re.material=Y.material,re.node=pe.node,re._flushIA(Y.ia))}},Te.fillByTiledNode=function(Ee,De,fe,Ce,Se,be,Re){Ee._updateLocalMatrix(),B.Mat4.copy(F,Ee._matrix),B.Vec3.set(G,-(Ce+Q),-(Re+ee),0),B.Mat4.transform(F,F,G);var Ve=F.m,Pe=Ve[0],ke=Ve[1],Ne=Ve[4],Ae=Ve[5],Oe=Ve[12],Fe=Ve[13],nt=Ee._color._val;De[Z]=Ce*Pe+be*Ne+Oe,De[Z+1]=Ce*ke+be*Ae+Fe,fe[Z+4]=nt,De[Z+5]=Ce*Pe+Re*Ne+Oe,De[Z+6]=Ce*ke+Re*Ae+Fe,fe[Z+9]=nt,De[Z+10]=Se*Pe+be*Ne+Oe,De[Z+11]=Se*ke+be*Ae+Fe,fe[Z+14]=nt,De[Z+15]=Se*Pe+Re*Ne+Oe,De[Z+16]=Se*ke+Re*Ae+Fe,fe[Z+19]=nt},we}(w.default);T.default=de,w.default.register(O,de),S.exports=T.default},{"../core/renderer/":227,"../core/renderer/assembler":224,"../core/renderer/render-flow":228,"../core/renderer/webgl/vertex-format":260,"../core/value-types":286,"./CCTiledLayer":344,"./CCTiledMap":345}],353:[function(L,S){var T=L("./video-player-impl"),_=T.EventType,w=cc.Enum({REMOTE:0,LOCAL:1}),B=cc.Class({name:"cc.VideoPlayer",extends:cc.Component,editor:!1,properties:{_resourceType:w.REMOTE,resourceType:{tooltip:!1,type:w,set:function(A){this._resourceType=A,this._updateVideoSource()},get:function(){return this._resourceType}},_remoteURL:"",remoteURL:{tooltip:!1,type:cc.String,set:function(A){this._remoteURL=A,this._updateVideoSource()},get:function(){return this._remoteURL}},_clip:{default:null,type:cc.VideoClip},clip:{tooltip:!1,get:function(){return this._clip},set:function(A){this._clip=A,this._updateVideoSource()},type:cc.VideoClip},currentTime:{tooltip:!1,type:cc.Float,set:function(A){this._impl&&this._impl.seekTo(A)},get:function(){return this._impl?this._currentStatus===_.NONE||this._currentStatus===_.STOPPED||this._currentStatus===_.META_LOADED||this._currentStatus===_.READY_TO_PLAY?0:this._currentStatus===_.COMPLETED?this._impl.duration():this._impl.currentTime():-1}},_volume:1,volume:{get:function(){return this._volume},set:function(A){this._volume=A,this.isPlaying()&&!this._mute&&this._syncVolume()},range:[0,1],type:cc.Float,tooltip:!1},_mute:!1,mute:{get:function(){return this._mute},set:function(A){this._mute=A,this._syncVolume()},tooltip:!1},keepAspectRatio:{tooltip:!1,default:!0,type:cc.Boolean,notify:function(){this._impl&&this._impl.setKeepAspectRatioEnabled(this.keepAspectRatio)}},_isFullscreen:{default:!1,formerlySerializedAs:"_N$isFullscreen"},isFullscreen:{get:function(){return this._isFullscreen=this._impl&&this._impl.isFullScreenEnabled(),this._isFullscreen},set:function(A){this._isFullscreen=A,this._impl&&this._impl.setFullScreenEnabled(A)},animatable:!1,tooltip:!1},_stayOnBottom:!1,stayOnBottom:{get:function(){return this._stayOnBottom},set:function(A){this._stayOnBottom=A,this._impl&&this._impl.setStayOnBottom(A)},animatable:!1,tooltip:!1},videoPlayerEvent:{default:[],type:cc.Component.EventHandler}},statics:{EventType:_,ResourceType:w,Impl:T},ctor:function(){this._impl=new T,this._currentStatus=_.NONE},_syncVolume:function(){var A=this._impl;if(A){var O=this._mute?0:this._volume;A.setVolume(O)}},_updateVideoSource:function(){var A="";this.resourceType===w.REMOTE?A=this.remoteURL:this._clip&&(A=this._clip.nativeUrl),this._impl.setURL(A,this._mute||this._volume===0),this._impl.setKeepAspectRatioEnabled(this.keepAspectRatio)},onLoad:function(){var A=this._impl;A&&(A.createDomElementIfNeeded(this._mute||this._volume===0),A.setStayOnBottom(this._stayOnBottom),this._updateVideoSource(),A.seekTo(this.currentTime),A.setFullScreenEnabled(this._isFullscreen),this.pause(),A.setEventListener(_.PLAYING,this.onPlaying.bind(this)),A.setEventListener(_.PAUSED,this.onPasued.bind(this)),A.setEventListener(_.STOPPED,this.onStopped.bind(this)),A.setEventListener(_.COMPLETED,this.onCompleted.bind(this)),A.setEventListener(_.META_LOADED,this.onMetaLoaded.bind(this)),A.setEventListener(_.CLICKED,this.onClicked.bind(this)),A.setEventListener(_.READY_TO_PLAY,this.onReadyToPlay.bind(this)))},onRestore:function(){this._impl||(this._impl=new T)},onEnable:function(){this._impl&&this._impl.enable()},onDisable:function(){this._impl&&this._impl.disable()},onDestroy:function(){this._impl&&(this._impl.destroy(),this._impl=null)},update:function(){this._impl&&this._impl.updateMatrix(this.node)},onReadyToPlay:function(){this._currentStatus=_.READY_TO_PLAY,cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,_.READY_TO_PLAY),this.node.emit("ready-to-play",this)},onMetaLoaded:function(){this._currentStatus=_.META_LOADED,cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,_.META_LOADED),this.node.emit("meta-loaded",this)},onClicked:function(){this._currentStatus=_.CLICKED,cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,_.CLICKED),this.node.emit("clicked",this)},onPlaying:function(){this._currentStatus=_.PLAYING,cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,_.PLAYING),this.node.emit("playing",this)},onPasued:function(){this._currentStatus=_.PAUSED,cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,_.PAUSED),this.node.emit("paused",this)},onStopped:function(){this._currentStatus=_.STOPPED,cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,_.STOPPED),this.node.emit("stopped",this)},onCompleted:function(){this._currentStatus=_.COMPLETED,cc.Component.EventHandler.emitEvents(this.videoPlayerEvent,this,_.COMPLETED),this.node.emit("completed",this)},play:function(){this._impl&&(this._syncVolume(),this._impl.play())},resume:function(){this._impl&&(this._syncVolume(),this._impl.resume())},pause:function(){this._impl&&this._impl.pause()},stop:function(){this._impl&&this._impl.stop()},getDuration:function(){return this._impl?this._impl.duration():-1},isPlaying:function(){return!!this._impl&&this._impl.isPlaying()}});cc.VideoPlayer=S.exports=B},{"./video-player-impl":354}],354:[function(L,S){var T=L("../core/platform/utils"),_=L("../core/platform/CCSys"),w=L("../core/platform/CCMacro"),B=1,A=4,O=cc.mat4(),R=cc.Class({name:"VideoPlayerImpl",ctor:function(){this._EventList={},this._video=null,this._url="",this._waitingFullscreen=!1,this._fullScreenEnabled=!1,this._stayOnBottom=!1,this._loadedmeta=!1,this._loaded=!1,this._visible=!1,this._playing=!1,this._ignorePause=!1,this._forceUpdate=!1,this._m00=0,this._m01=0,this._m04=0,this._m05=0,this._m12=0,this._m13=0,this._w=0,this._h=0,this.__eventListeners={}},_bindEvent:function(){var D=this._video,I=this,M=this.__eventListeners;M.loadedmetadata=function(){I._loadedmeta=!0,I._forceUpdate=!0,I._waitingFullscreen&&(I._waitingFullscreen=!1,I._toggleFullscreen(!0)),I._dispatchEvent(R.EventType.META_LOADED)},M.ended=function(){I._video===D&&(I._playing=!1,I._dispatchEvent(R.EventType.COMPLETED))},M.play=function(){I._video===D&&(I._playing=!0,I._updateVisibility(),I._dispatchEvent(R.EventType.PLAYING))},M.pause=function(){I._video===D&&(I._playing=!1,I._ignorePause||I._dispatchEvent(R.EventType.PAUSED))},M.click=function(){I._dispatchEvent(R.EventType.CLICKED)},D.addEventListener("loadedmetadata",M.loadedmetadata),D.addEventListener("ended",M.ended),D.addEventListener("play",M.play),D.addEventListener("pause",M.pause),D.addEventListener("click",M.click),M.onCanPlay=function(){var N=I._video;!I._loaded&&N&&(N.readyState!==A&&N.readyState!==B||(N.currentTime=0,I._loaded=!0,I._forceUpdate=!0,I._dispatchEvent(R.EventType.READY_TO_PLAY),I._updateVisibility()))},D.addEventListener("canplay",M.onCanPlay),D.addEventListener("canplaythrough",M.onCanPlay),D.addEventListener("suspend",M.onCanPlay)},_updateVisibility:function(){var D=this._video;D&&(this._visible?D.style.visibility="visible":(D.style.visibility="hidden",D.pause(),this._playing=!1))},_updateSize:function(D,I){var M=this._video;M&&(M.style.width=D+"px",M.style.height=I+"px")},_createDom:function(D){var I=document.createElement("video");I.style.position="absolute",I.style.bottom="0px",I.style.left="0px",I.style["z-index"]=this._stayOnBottom?w.MIN_ZINDEX:0,I.className="cocosVideo",I.setAttribute("preload","auto"),I.setAttribute("webkit-playsinline",""),I.setAttribute("x5-playsinline",""),I.setAttribute("playsinline",""),D&&I.setAttribute("muted",""),this._video=I,cc.game.container.appendChild(I)},createDomElementIfNeeded:function(D){this._video||this._createDom(D)},removeDom:function(){var D=this._video;if(D){T.contains(cc.game.container,D)&&cc.game.container.removeChild(D);var I=this.__eventListeners;D.removeEventListener("loadedmetadata",I.loadedmetadata),D.removeEventListener("ended",I.ended),D.removeEventListener("play",I.play),D.removeEventListener("pause",I.pause),D.removeEventListener("click",I.click),D.removeEventListener("canplay",I.onCanPlay),D.removeEventListener("canplaythrough",I.onCanPlay),D.removeEventListener("suspend",I.onCanPlay),I.loadedmetadata=null,I.ended=null,I.play=null,I.pause=null,I.click=null,I.onCanPlay=null}this._video=null,this._url=""},setURL:function(D,I){var M,N;if(this._url!==D){this.removeDom(),this._url=D,this.createDomElementIfNeeded(I),this._bindEvent();var k=this._video;k.style.visibility="hidden",this._loaded=!1,this._playing=!1,this._loadedmeta=!1,(M=document.createElement("source")).src=D,k.appendChild(M),N=cc.path.extname(D);for(var F=R._polyfill,G=0;G<F.canPlayType.length;G++)N!==F.canPlayType[G]&&((M=document.createElement("source")).src=D.replace(N,F.canPlayType[G]),k.appendChild(M))}},getURL:function(){return this._url},play:function(){var D=this._video;D&&this._visible&&!this._playing&&D.play()},pause:function(){var D=this._video;this._playing&&D&&D.pause()},resume:function(){this.play()},stop:function(){var D=this._video;D&&this._visible&&(this._ignorePause=!0,D.currentTime=0,D.pause(),setTimeout((function(){this._dispatchEvent(R.EventType.STOPPED),this._ignorePause=!1}).bind(this),0))},setVolume:function(D){var I=this._video;I&&(I.volume=D)},seekTo:function(D){var I=this._video;I&&(this._loaded?I.currentTime=D:I.addEventListener(R._polyfill.event,function M(){I.currentTime=D,I.removeEventListener(R._polyfill.event,M)}))},isPlaying:function(){return this._playing},duration:function(){var D=this._video,I=-1;return D&&(I=D.duration)<=0&&cc.logID(7702),I},currentTime:function(){var D=this._video;return D?D.currentTime:-1},setKeepAspectRatioEnabled:function(){cc.logID(7700)},isKeepAspectRatioEnabled:function(){return!0},_toggleFullscreen:function(D){var I=this,M=this._video;M&&(D?(_.browserType===_.BROWSER_TYPE_IE&&(M.style.transform=""),cc.screen.requestFullScreen(M,function(){var N=_.browserType===_.BROWSER_TYPE_IE?document.msFullscreenElement:document.fullscreenElement;I._fullScreenEnabled=N===M},function(){I._fullScreenEnabled=!1})):cc.screen.fullScreen()&&cc.screen.exitFullScreen(M))},setStayOnBottom:function(D){this._stayOnBottom=D,this._video&&(this._video.style["z-index"]=D?w.MIN_ZINDEX:0)},setFullScreenEnabled:function(D){!this._loadedmeta&&D?this._waitingFullscreen=!0:this._toggleFullscreen(D)},isFullScreenEnabled:function(){return this._fullScreenEnabled},setEventListener:function(D,I){this._EventList[D]=I},removeEventListener:function(D){this._EventList[D]=null},_dispatchEvent:function(D){var I=this._EventList[D];I&&I.call(this,this,this._video.src)},onPlayEvent:function(){this._EventList[R.EventType.PLAYING].call(this,this,this._video.src)},enable:function(){var D=R.elements;D.indexOf(this)===-1&&D.push(this),this.setVisible(!0)},disable:function(){var D=R.elements,I=D.indexOf(this);I!==-1&&D.splice(I,1),this.setVisible(!1)},destroy:function(){this.disable(),this.removeDom()},setVisible:function(D){this._visible!==D&&(this._visible=!!D,this._updateVisibility())},updateMatrix:function(D){if(this._video&&this._visible&&!this._fullScreenEnabled){D.getWorldMatrix(O);var I=cc.Camera._findRendererCamera(D);I&&I.worldMatrixToScreen(O,O,cc.game.canvas.width,cc.game.canvas.height);var M=O.m;if(this._forceUpdate||this._m00!==M[0]||this._m01!==M[1]||this._m04!==M[4]||this._m05!==M[5]||this._m12!==M[12]||this._m13!==M[13]||this._w!==D._contentSize.width||this._h!==D._contentSize.height){this._m00=M[0],this._m01=M[1],this._m04=M[4],this._m05=M[5],this._m12=M[12],this._m13=M[13],this._w=D._contentSize.width,this._h=D._contentSize.height;var N,k,F=cc.view._devicePixelRatio,G=1/F,V=1/F,j=cc.game.container,H=M[0]*G,U=M[1],X=M[4],Y=M[5]*V,z=j&&j.style.paddingLeft?parseInt(j.style.paddingLeft):0,W=j&&j.style.paddingBottom?parseInt(j.style.paddingBottom):0;R._polyfill.zoomInvalid?(this._updateSize(this._w*H,this._h*Y),H=1,Y=1,N=this._w*G,k=this._h*V):(N=this._w*G,k=this._h*V,this._updateSize(this._w,this._h));var Z=N*M[0]*D._anchorPoint.x,Q=k*M[5]*D._anchorPoint.y,ee="matrix("+H+","+-U+","+-X+","+Y+","+(M[12]*G-Z+z)+","+-(M[13]*V-Q+W)+")";this._video.style.transform=ee,this._video.style["-webkit-transform"]=ee,this._video.style["transform-origin"]="0px 100% 0px",this._video.style["-webkit-transform-origin"]="0px 100% 0px",_.browserType!==_.BROWSER_TYPE_IE&&(this._forceUpdate=!1)}}}});R.EventType={NONE:-1,PLAYING:0,PAUSED:1,STOPPED:2,COMPLETED:3,META_LOADED:4,CLICKED:5,READY_TO_PLAY:6},R.elements=[],R.pauseElements=[],cc.game.on(cc.game.EVENT_HIDE,function(){for(var D,I=R.elements,M=0;M<I.length;M++)(D=I[M]).isPlaying()&&(D.pause(),R.pauseElements.push(D))}),cc.game.on(cc.game.EVENT_SHOW,function(){for(var D=R.pauseElements,I=D.pop();I;)I.play(),I=D.pop()}),R._polyfill={devicePixelRatio:!1,event:"canplay",canPlayType:[]};var P=document.createElement("video");P.canPlayType&&(P.canPlayType("video/ogg")&&(R._polyfill.canPlayType.push(".ogg"),R._polyfill.canPlayType.push(".ogv")),P.canPlayType("video/mp4")&&R._polyfill.canPlayType.push(".mp4"),P.canPlayType("video/webm")&&R._polyfill.canPlayType.push(".webm")),_.OS_ANDROID!==_.os||_.browserType!==_.BROWSER_TYPE_SOUGOU&&_.browserType!==_.BROWSER_TYPE_360||(R._polyfill.zoomInvalid=!0);var E=document.createElement("style");E.innerHTML=".cocosVideo:-moz-full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:-webkit-full-screen{transform:matrix(1,0,0,1,0,0) !important;}",document.head.appendChild(E),S.exports=R},{"../core/platform/CCMacro":201,"../core/platform/CCSys":205,"../core/platform/utils":220}],355:[function(L,S){var T=L("./webview-impl"),_=T.EventType;function w(){}var B=cc.Class({name:"cc.WebView",extends:cc.Component,editor:!1,properties:{_url:"",url:{type:cc.String,tooltip:!1,get:function(){return this._url},set:function(A){this._url=A;var O=this._impl;O&&O.loadURL(A)}},webviewEvents:{default:[],type:cc.Component.EventHandler}},statics:{EventType:_,Impl:T},ctor:function(){this._impl=new B.Impl},onRestore:function(){this._impl||(this._impl=new B.Impl)},onEnable:function(){var A=this._impl;A.createDomElementIfNeeded(this.node.width,this.node.height),A.setEventListener(_.LOADED,this._onWebViewLoaded.bind(this)),A.setEventListener(_.LOADING,this._onWebViewLoading.bind(this)),A.setEventListener(_.ERROR,this._onWebViewLoadError.bind(this)),A.loadURL(this._url),A.setVisible(!0)},onDisable:function(){var A=this._impl;A.setVisible(!1),A.setEventListener(_.LOADED,w),A.setEventListener(_.LOADING,w),A.setEventListener(_.ERROR,w)},onDestroy:function(){this._impl&&(this._impl.destroy(),this._impl=null)},update:function(){this._impl&&this._impl.updateMatrix(this.node)},_onWebViewLoaded:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,_.LOADED),this.node.emit("loaded",this)},_onWebViewLoading:function(){return cc.Component.EventHandler.emitEvents(this.webviewEvents,this,_.LOADING),this.node.emit("loading",this),!0},_onWebViewLoadError:function(){cc.Component.EventHandler.emitEvents(this.webviewEvents,this,_.ERROR),this.node.emit("error",this)},setJavascriptInterfaceScheme:function(A){this._impl&&this._impl.setJavascriptInterfaceScheme(A)},setOnJSCallback:function(A){this._impl&&this._impl.setOnJSCallback(A)},evaluateJS:function(A){this._impl&&this._impl.evaluateJS(A)}});cc.WebView=S.exports=B},{"./webview-impl":356}],356:[function(L,S){var T=L("../core/platform/utils"),_=L("../core/platform/CCSys"),w=cc.mat4(),B=cc.Class({name:"WebViewImpl",ctor:function(){this._EventList={},this._visible=!1,this._parent=null,this._div=null,this._iframe=null,this._listener=null,this._forceUpdate=!1,this._m00=0,this._m01=0,this._m04=0,this._m05=0,this._m12=0,this._m13=0,this._w=0,this._h=0,this.__eventListeners={}},_updateVisibility:function(){if(this._div){var O=this._div;this._visible?O.style.visibility="visible":O.style.visibility="hidden"}},_updateSize:function(O,R){var P=this._div;P&&(P.style.width=O+"px",P.style.height=R+"px")},_initEvent:function(){var O=this._iframe;if(O){var R=this.__eventListeners,P=this;R.load=function(){P._forceUpdate=!0,P._dispatchEvent(B.EventType.LOADED)},R.error=function(){P._dispatchEvent(B.EventType.ERROR)},O.addEventListener("load",R.load),O.addEventListener("error",R.error)}},_initStyle:function(){if(this._div){var O=this._div;O.style.position="absolute",O.style.bottom="0px",O.style.left="0px"}},_setOpacity:function(O){var R=this._iframe;R&&R.style&&(R.style.opacity=O/255)},_createDom:function(O,R){B._polyfill.enableDiv?(this._div=document.createElement("div"),this._div.style["-webkit-overflow"]="auto",this._div.style["-webkit-overflow-scrolling"]="touch",this._iframe=document.createElement("iframe"),this._div.appendChild(this._iframe),this._iframe.style.width="100%",this._iframe.style.height="100%"):this._div=this._iframe=document.createElement("iframe"),B._polyfill.enableBG&&(this._div.style.background="#FFF"),this._div.style.height=R+"px",this._div.style.width=O+"px",this._div.style.overflow="scroll",this._iframe.style.border="none",cc.game.container.appendChild(this._div),this._updateVisibility()},_createNativeControl:function(O,R){this._createDom(O,R),this._initStyle(),this._initEvent()},createDomElementIfNeeded:function(O,R){this._div?this._updateSize(O,R):this._createNativeControl(O,R)},removeDom:function(){var O=this._div;O&&(T.contains(cc.game.container,O)&&cc.game.container.removeChild(O),this._div=null);var R=this._iframe;if(R){var P=this.__eventListeners;R.removeEventListener("load",P.load),R.removeEventListener("error",P.error),P.load=null,P.error=null,this._iframe=null}},setOnJSCallback:function(){},setJavascriptInterfaceScheme:function(){},loadData:function(){},loadHTMLString:function(){},loadURL:function(O){var R=this._iframe;if(R){R.src=O;var P=this;R.addEventListener("load",function E(){P._loaded=!0,P._updateVisibility(),R.removeEventListener("load",E)}),this._dispatchEvent(B.EventType.LOADING)}},stopLoading:function(){cc.logID(7800)},reload:function(){var O=this._iframe;if(O){var R=O.contentWindow;R&&R.location&&R.location.reload()}},canGoBack:function(){return cc.logID(7801),!0},canGoForward:function(){return cc.logID(7802),!0},goBack:function(){try{if(B._polyfill.closeHistory)return cc.logID(7803);var O=this._iframe;if(O){var R=O.contentWindow;R&&R.location&&R.history.back.call(R)}}catch(P){cc.log(P)}},goForward:function(){try{if(B._polyfill.closeHistory)return cc.logID(7804);var O=this._iframe;if(O){var R=O.contentWindow;R&&R.location&&R.history.forward.call(R)}}catch(P){cc.log(P)}},evaluateJS:function(O){var R=this._iframe;if(R){var P=R.contentWindow;try{P.eval(O),this._dispatchEvent(B.EventType.JS_EVALUATED)}catch(E){console.error(E)}}},setScalesPageToFit:function(){cc.logID(7805)},setEventListener:function(O,R){this._EventList[O]=R},removeEventListener:function(O){this._EventList[O]=null},_dispatchEvent:function(O){var R=this._EventList[O];R&&R.call(this,this,this._iframe.src)},_createRenderCmd:function(){return new B.RenderCmd(this)},destroy:function(){this.removeDom()},setVisible:function(O){this._visible!==O&&(this._visible=!!O,this._updateVisibility())},updateMatrix:function(O){if(this._div&&this._visible){O.getWorldMatrix(w);var R=cc.Camera._findRendererCamera(O);R&&R.worldMatrixToScreen(w,w,cc.game.canvas.width,cc.game.canvas.height);var P=w.m;if(this._forceUpdate||this._m00!==P[0]||this._m01!==P[1]||this._m04!==P[4]||this._m05!==P[5]||this._m12!==P[12]||this._m13!==P[13]||this._w!==O._contentSize.width||this._h!==O._contentSize.height){this._m00=P[0],this._m01=P[1],this._m04=P[4],this._m05=P[5],this._m12=P[12],this._m13=P[13],this._w=O._contentSize.width,this._h=O._contentSize.height;var E=cc.view._devicePixelRatio,D=1/E,I=1/E,M=cc.game.container,N=P[0]*D,k=P[1],F=P[4],G=P[5]*I,V=M&&M.style.paddingLeft?parseInt(M.style.paddingLeft):0,j=M&&M.style.paddingBottom?parseInt(M.style.paddingBottom):0;this._updateSize(this._w,this._h);var H=this._w*D,U=this._h*I,X=H*P[0]*O._anchorPoint.x,Y=U*P[5]*O._anchorPoint.y,z="matrix("+N+","+-k+","+-F+","+G+","+(P[12]*D-X+V)+","+-(P[13]*I-Y+j)+")";this._div.style.transform=z,this._div.style["-webkit-transform"]=z,this._div.style["transform-origin"]="0px 100% 0px",this._div.style["-webkit-transform-origin"]="0px 100% 0px",this._setOpacity(O.opacity),this._forceUpdate=!1}}}});B.EventType={LOADING:0,LOADED:1,ERROR:2,JS_EVALUATED:3};var A=B._polyfill={devicePixelRatio:!1,enableDiv:!1};_.os===_.OS_IOS&&(A.enableDiv=!0),_.isMobile?_.browserType===_.BROWSER_TYPE_FIREFOX&&(A.enableBG=!0):_.browserType===_.BROWSER_TYPE_IE&&(A.closeHistory=!0),S.exports=B},{"../core/platform/CCSys":205,"../core/platform/utils":220}],357:[function(L){L("./cocos2d/core"),L("./cocos2d/animation"),L("./cocos2d/particle"),L("./cocos2d/tilemap"),L("./cocos2d/videoplayer/CCVideoPlayer"),L("./cocos2d/webview/CCWebView"),L("./cocos2d/core/components/CCStudioComponent"),L("./extensions/ccpool/CCNodePool"),L("./cocos2d/actions"),L("./extensions/spine"),L("./extensions/dragonbones"),L("./cocos2d/deprecated")},{"./cocos2d/actions":7,"./cocos2d/animation":16,"./cocos2d/core":163,"./cocos2d/core/components/CCStudioComponent":124,"./cocos2d/deprecated":298,"./cocos2d/particle":304,"./cocos2d/particle/CCParticleAsset":301,"./cocos2d/tilemap":350,"./cocos2d/tilemap/CCTiledMapAsset":346,"./cocos2d/videoplayer/CCVideoPlayer":353,"./cocos2d/webview/CCWebView":355,"./extensions/ccpool/CCNodePool":358,"./extensions/dragonbones":368,"./extensions/spine":373}],358:[function(L,S){cc.NodePool=function(T){this.poolHandlerComp=T,this._pool=[]},cc.NodePool.prototype={constructor:cc.NodePool,size:function(){return this._pool.length},clear:function(){for(var T=this._pool.length,_=0;_<T;++_)this._pool[_].destroy();this._pool.length=0},put:function(T){if(T&&this._pool.indexOf(T)===-1){T.removeFromParent(!1);var _=this.poolHandlerComp?T.getComponent(this.poolHandlerComp):null;_&&_.unuse&&_.unuse(),this._pool.push(T)}},get:function(){var T=this._pool.length-1;if(T<0)return null;var _=this._pool[T];this._pool.length=T;var w=this.poolHandlerComp?_.getComponent(this.poolHandlerComp):null;return w&&w.reuse&&w.reuse.apply(w,arguments),_}},S.exports=cc.NodePool},{}],359:[function(L,S){var T,_,w=[],B=[],A=0,O=0,R=0,P=null,E=null,D=0,I=0,M=0,N=0,k=null,F=cc.Class({ctor:function(){this._privateMode=!1,this._inited=!1,this._invalid=!0,this._enableCacheAttachedInfo=!1,this.frames=[],this.totalTime=0,this.isCompleted=!1,this._frameIdx=-1,this._armatureInfo=null,this._animationName=null,this._tempSegments=null,this._tempColors=null,this._tempBoneInfos=null},init:function(V,j){this._inited=!0,this._armatureInfo=V,this._animationName=j},clear:function(){this._inited=!1;for(var V=0,j=this.frames.length;V<j;V++)this.frames[V].segments.length=0;this.invalidAllFrame()},begin:function(){if(this._invalid){var V=this._armatureInfo,j=V.curAnimationCache;j&&j!=this&&(this._privateMode?j.invalidAllFrame():j.updateToFrame()),V.armature.animation.play(this._animationName,1),V.curAnimationCache=this,this._invalid=!1,this._frameIdx=-1,this.totalTime=0,this.isCompleted=!1}},end:function(){this._needToUpdate()||(this._armatureInfo.curAnimationCache=null,this.frames.length=this._frameIdx+1,this.isCompleted=!0)},_needToUpdate:function(V){return!this._armatureInfo.armature.animation.isCompleted&&this.totalTime<30&&(V==null||this._frameIdx<V)},updateToFrame:function(V){if(this._inited&&(this.begin(),this._needToUpdate(V))){var j=this._armatureInfo.armature;do j.advanceTime(1/60),this._frameIdx++,this._updateFrame(j,this._frameIdx),this.totalTime+=1/60;while(this._needToUpdate(V));this.end()}},isInited:function(){return this._inited},isInvalid:function(){return this._invalid},invalidAllFrame:function(){this.isCompleted=!1,this._invalid=!0},updateAllFrame:function(){this.invalidAllFrame(),this.updateToFrame()},enableCacheAttachedInfo:function(){this._enableCacheAttachedInfo||(this._enableCacheAttachedInfo=!0,this.invalidAllFrame())},_updateFrame:function(V,j){R=0,A=0,O=0,P=null,E=null,D=0,I=0,M=0,N=0,k=null,this.frames[j]=this.frames[j]||{segments:[],colors:[],boneInfos:[],vertices:null,uintVert:null,indices:null};var H=this.frames[j],U=this._tempSegments=H.segments,X=this._tempColors=H.colors,Y=this._tempBoneInfos=H.boneInfos;this._traverseArmature(V,1),N>0&&(X[N-1].vfOffset=R),X.length=N,Y.length=A;var z=M-1;if(z>=0)if(I>0){var W=U[z];W.indexCount=I,W.vfCount=5*D,W.vertexCount=D,U.length=M}else U.length=M-1;if(U.length!==0){var Z=H.vertices,Q=H.uintVert;(!Z||Z.length<R)&&(Z=H.vertices=new Float32Array(R),Q=H.uintVert=new Uint32Array(Z.buffer));for(var ee=0,te=0;ee<R;)Z[ee++]=w[te++],Z[ee++]=w[te++],Z[ee++]=w[te++],Z[ee++]=w[te++],Q[ee++]=w[te++];var re=H.indices;(!re||re.length<O)&&(re=H.indices=new Uint16Array(O));for(var ie=0;ie<O;ie++)re[ie]=B[ie];H.vertices=Z,H.uintVert=Q,H.indices=re}},_traverseArmature:function(V,j){var H,U,X,Y,z,W,Z,Q,ee,te=this._tempColors,re=this._tempSegments,ie=this._tempBoneInfos,ne=w,he=B,pe=V._slots,K=V._bones;if(this._enableCacheAttachedInfo)for(var ue=0,le=K.length;ue<le;ue++,A++){var ce=K[ue],_e=ie[A];_e||(_e=ie[A]={globalTransformMatrix:new dragonBones.Matrix});var oe=ce.globalTransformMatrix;_e.globalTransformMatrix.copyFrom(oe)}for(var de=0,me=pe.length;de<me;de++)if((X=pe[de])._visible&&X._displayData){if(X.updateWorldMatrix(),z=X._color,X.childArmature)this._traverseArmature(X.childArmature,j*z.a/255);else if(Z=X.getTexture()){P===Z.nativeUrl&&E===X._blendMode||(P=Z.nativeUrl,E=X._blendMode,(Q=M-1)>=0&&(I>0?((ee=re[Q]).indexCount=I,ee.vertexCount=D,ee.vfCount=5*D):M--),re[M]={tex:Z,blendMode:X._blendMode,indexCount:0,vertexCount:0,vfCount:0},M++,I=0,D=0),W=(z.a*j<<24>>>0)+(z.b<<16)+(z.g<<8)+z.r,k!==W&&(k=W,N>0&&(te[N-1].vfOffset=R),te[N++]={r:z.r,g:z.g,b:z.b,a:z.a*j,vfOffset:0}),H=X._localVertices,U=X._indices,Y=X._worldMatrix.m;for(var ye=0,ge=H.length;ye<ge;)T=H[ye++],_=H[ye++],ne[R++]=T*Y[0]+_*Y[4]+Y[12],ne[R++]=T*Y[1]+_*Y[5]+Y[13],ne[R++]=H[ye++],ne[R++]=H[ye++],ne[R++]=W;for(var we=0,Te=U.length;we<Te;we++)he[O++]=D+U[we];I+=U.length,D+=H.length/4}}}}),G=cc.Class({ctor:function(){this._privateMode=!1,this._animationPool={},this._armatureCache={}},enablePrivateMode:function(){this._privateMode=!0},dispose:function(){for(var V in this._armatureCache){var j=this._armatureCache[V];if(j){var H=j.armature;H&&H.dispose()}}this._armatureCache=null,this._animationPool=null},_removeArmature:function(V){var j=this._armatureCache[V],H=j.animationsCache;for(var U in H){var X=H[U];X&&(this._animationPool[V+"#"+U]=X,X.clear())}var Y=j.armature;Y&&Y.dispose(),delete this._armatureCache[V]},resetArmature:function(V){for(var j in this._armatureCache)j.indexOf(V)!=-1&&this._removeArmature(j)},getArmatureCache:function(V,j,H){var U,X=this._armatureCache[j];if(X)U=X.armature;else{var Y=dragonBones.CCFactory.getInstance().buildArmatureDisplay(V,j,"",H);if(!Y||!Y._armature)return;if(U=Y._armature,!G.canCache(U))return void U.dispose();this._armatureCache[j]={armature:U,animationsCache:{},curAnimationCache:null}}return U},getAnimationCache:function(V,j){var H=this._armatureCache[V];return H?H.animationsCache[j]:null},initAnimationCache:function(V,j){if(!j)return null;var H=this._armatureCache[V],U=H&&H.armature;if(!U||!U.animation.hasAnimation(j))return null;var X=H.animationsCache,Y=X[j];if(!Y){var z=V+"#"+j;(Y=this._animationPool[z])?delete this._animationPool[z]:(Y=new F)._privateMode=this._privateMode,Y.init(H,j),X[j]=Y}return Y},invalidAnimationCache:function(V){var j=this._armatureCache[V];if(!j||!j.armature)return null;var H=j.animationsCache;for(var U in H)H[U].invalidAllFrame()},updateAnimationCache:function(V,j){if(j){var H=this.initAnimationCache(V,j);if(!H)return;H.updateAllFrame()}else{var U=this._armatureCache[V];if(!U||!U.armature)return null;var X=U.animationsCache;for(var Y in X)X[Y].updateAllFrame()}}});G.FrameTime=1/60,G.sharedCache=new G,G.canCache=function(V){for(var j=V._slots,H=0,U=j.length;H<U;H++)if(j[H].childArmature)return!1;return!0},S.exports=G},{}],360:[function(L,S){var T=L("../../cocos2d/core/components/CCRenderComponent"),_=L("../../cocos2d/core/event/event-target"),w=L("../../cocos2d/core/graphics/graphics"),B=L("../../cocos2d/core/renderer/render-flow").FLAG_POST_RENDER,A=L("./ArmatureCache"),O=L("./AttachUtil"),R=cc.Enum({default:-1}),P=cc.Enum({"<None>":0}),E=(cc.Enum({REALTIME:0}),cc.Enum({REALTIME:0,SHARED_CACHE:1,PRIVATE_CACHE:2})),D=cc.Class({name:"dragonBones.ArmatureDisplay",extends:T,editor:!1,statics:{AnimationCacheMode:E},properties:{_factory:{default:null,type:dragonBones.CCFactory,serializable:!1},dragonAsset:{default:null,type:dragonBones.DragonBonesAsset,notify:function(){this._refresh()},tooltip:!1},dragonAtlasAsset:{default:null,type:dragonBones.DragonBonesAtlasAsset,notify:function(){this._parseDragonAtlasAsset(),this._refresh()},tooltip:!1},_armatureName:"",armatureName:{get:function(){return this._armatureName},set:function(I){this._armatureName=I;var M=this.getAnimationNames(this._armatureName);(!this.animationName||M.indexOf(this.animationName)<0)&&(this.animationName=""),this._armature&&!this.isAnimationCached()&&this._factory._dragonBones.clock.remove(this._armature),this._refresh(),this._armature&&!this.isAnimationCached()&&this._factory._dragonBones.clock.add(this._armature)},visible:!1},_animationName:"",animationName:{get:function(){return this._animationName},set:function(I){this._animationName=I},visible:!1},_defaultArmatureIndex:{default:0,notify:function(){var I="";if(this.dragonAsset){var M;if(this.dragonAsset&&(M=this.dragonAsset.getArmatureEnum()),!M)return cc.errorID(7400,this.name);I=M[this._defaultArmatureIndex]}I!==void 0?this.armatureName=I:cc.errorID(7401,this.name)},type:R,visible:!0,editorOnly:!0,animatable:!1,displayName:"Armature",tooltip:!1},_animationIndex:{default:0,notify:function(){var I;if(this._animationIndex!==0){if(this.dragonAsset&&(I=this.dragonAsset.getAnimsEnum(this.armatureName)),I){var M=I[this._animationIndex];M!==void 0?this.playAnimation(M,this.playTimes):cc.errorID(7402,this.name)}}else this.animationName=""},type:P,visible:!0,editorOnly:!0,animatable:!1,displayName:"Animation",tooltip:!1},_preCacheMode:-1,_cacheMode:E.REALTIME,_defaultCacheMode:{default:0,type:E,notify:function(){if(this._defaultCacheMode!==E.REALTIME&&this._armature&&!A.canCache(this._armature))return this._defaultCacheMode=E.REALTIME,void cc.warn("Animation cache mode doesn't support skeletal nesting");this.setAnimationCacheMode(this._defaultCacheMode)},editorOnly:!0,visible:!0,animatable:!1,displayName:"Animation Cache Mode",tooltip:!1},timeScale:{default:1,notify:function(){this._armature&&!this.isAnimationCached()&&(this._armature.animation.timeScale=this.timeScale)},tooltip:!1},playTimes:{default:-1,tooltip:!1},premultipliedAlpha:{default:!1,tooltip:!1},debugBones:{default:!1,notify:function(){this._updateDebugDraw()},tooltip:!1},enableBatch:{default:!1,notify:function(){this._updateBatch()},tooltip:!1},_armatureKey:"",_accTime:0,_playCount:0,_frameCache:null,_curFrame:null,_playing:!1,_armatureCache:null},ctor:function(){this._eventTarget=new _,this._materialCache={},this._inited=!1,this.attachUtil=new O,this._factory=dragonBones.CCFactory.getInstance()},onLoad:function(){for(var I=this.node.children,M=0,N=I.length;M<N;M++){var k=I[M];(k._name&&k._name.search("CHILD_ARMATURE-"))===0&&k.destroy()}},_updateBatch:function(){var I=this.getMaterial(0);I&&I.define("CC_USE_MODEL",!this.enableBatch),this._materialCache={}},_updateMaterial:function(){var I=this.getMaterial(0);if(I){I.define("CC_USE_MODEL",!this.enableBatch),I.define("USE_TEXTURE",!0);var M=this.premultipliedAlpha?cc.gfx.BLEND_ONE:cc.gfx.BLEND_SRC_ALPHA,N=cc.gfx.BLEND_ONE_MINUS_SRC_ALPHA;I.setBlend(!0,cc.gfx.BLEND_FUNC_ADD,M,M,cc.gfx.BLEND_FUNC_ADD,N,N)}this._materialCache={}},disableRender:function(){this._super(),this.node._renderFlag&=~B},markForRender:function(I){this._super(I),I?this.node._renderFlag|=B:this.node._renderFlag&=~B},_validateRender:function(){var I=this.dragonAtlasAsset&&this.dragonAtlasAsset.texture;I&&I.loaded?this._super():this.disableRender()},__preload:function(){this._init()},_init:function(){if(!this._inited){this._inited=!0,this._resetAssembler(),this._activateMaterial(),this._parseDragonAtlasAsset(),this._refresh();for(var I=this.node.children,M=0,N=I.length;M<N;M++){var k=I[M];k&&k._name==="DEBUG_DRAW_NODE"&&k.destroy()}this._updateDebugDraw()}},getArmatureKey:function(){return this._armatureKey},setAnimationCacheMode:function(I){this._preCacheMode!==I&&(this._cacheMode=I,this._buildArmature(),this._armature&&!this.isAnimationCached()&&this._factory._dragonBones.clock.add(this._armature))},isAnimationCached:function(){return this._cacheMode!==E.REALTIME},onEnable:function(){this._super(),this._armature&&!this.isAnimationCached()&&this._factory._dragonBones.clock.add(this._armature)},onDisable:function(){this._super(),this._armature&&!this.isAnimationCached()&&this._factory._dragonBones.clock.remove(this._armature)},_emitCacheCompleteEvent:function(){this._eventTarget.emit(dragonBones.EventObject.LOOP_COMPLETE),this._eventTarget.emit(dragonBones.EventObject.COMPLETE)},update:function(I){if(this.isAnimationCached()&&this._frameCache){var M=this._frameCache;if(M.isInited()){var N=M.frames;if(this._playing){var k=A.FrameTime;this._accTime==0&&this._playCount==0&&this._eventTarget.emit(dragonBones.EventObject.START);var F=dragonBones.timeScale;this._accTime+=I*this.timeScale*F;var G=Math.floor(this._accTime/k);if(M.isCompleted||M.updateToFrame(G),M.isCompleted&&G>=N.length){if(this._playCount++,this.playTimes>0&&this._playCount>=this.playTimes)return this._curFrame=N[N.length-1],this._accTime=0,this._playing=!1,this._playCount=0,void this._emitCacheCompleteEvent();this._accTime=0,G=0,this._emitCacheCompleteEvent()}this._curFrame=N[G]}else M.isInvalid()&&(M.updateToFrame(),this._curFrame=N[N.length-1])}}},onDestroy:function(){this._super(),this._inited=!1,this._cacheMode===E.PRIVATE_CACHE?(this._armatureCache.dispose(),this._armatureCache=null,this._armature=null):this._cacheMode===E.SHARED_CACHE?(this._armatureCache=null,this._armature=null):this._armature&&(this._armature.dispose(),this._armature=null)},_updateDebugDraw:function(){if(this.debugBones){if(!this._debugDraw){var I=new cc.PrivateNode;I.name="DEBUG_DRAW_NODE";var M=I.addComponent(w);M.lineWidth=1,M.strokeColor=cc.color(255,0,0,255),this._debugDraw=M}this._debugDraw.node.parent=this.node}else this._debugDraw&&(this._debugDraw.node.parent=null)},_buildArmature:function(){if(this.dragonAsset&&this.dragonAtlasAsset&&this.armatureName){this._armature&&(this._preCacheMode===E.PRIVATE_CACHE?this._armatureCache.dispose():this._preCacheMode===E.REALTIME&&this._armature.dispose(),this._armatureCache=null,this._armature=null,this._displayProxy=null,this._frameCache=null,this._curFrame=null,this._playing=!1,this._preCacheMode=null),this._cacheMode===E.SHARED_CACHE?this._armatureCache=A.sharedCache:this._cacheMode===E.PRIVATE_CACHE&&(this._armatureCache=new A,this._armatureCache.enablePrivateMode());var I=this.dragonAtlasAsset._uuid;if(this._armatureKey=this.dragonAsset.init(this._factory,I),this.isAnimationCached()&&(this._armature=this._armatureCache.getArmatureCache(this.armatureName,this._armatureKey,I),this._armature||(this._cacheMode=E.REALTIME)),this._preCacheMode=this._cacheMode,this._cacheMode===E.REALTIME){if(this._displayProxy=this._factory.buildArmatureDisplay(this.armatureName,this._armatureKey,"",I),!this._displayProxy)return;this._displayProxy._ccNode=this.node,this._displayProxy.setEventTarget(this._eventTarget),this._armature=this._displayProxy._armature,this._armature.animation.timeScale=this.timeScale}if(this._cacheMode!==E.REALTIME&&this.debugBones&&cc.warn("Debug bones is invalid in cached mode"),this._armature){var M=this._armature.armatureData.aabb;this.node.setContentSize(M.width,M.height)}this._updateBatch(),this.attachUtil.init(this),this.attachUtil._associateAttachedNode(),this.animationName&&this.playAnimation(this.animationName,this.playTimes),this.markForRender(!0)}},_parseDragonAtlasAsset:function(){this.dragonAtlasAsset&&this.dragonAtlasAsset.init(this._factory)},_refresh:function(){this._buildArmature()},_updateCacheModeEnum:!1,_updateAnimEnum:!1,_updateArmatureEnum:!1,playAnimation:function(I,M){if(this.playTimes=M===void 0?-1:M,this.animationName=I,this.isAnimationCached()){var N=this._armatureCache.getAnimationCache(this._armatureKey,I);N||(N=this._armatureCache.initAnimationCache(this._armatureKey,I)),N&&(this._accTime=0,this._playCount=0,this._frameCache=N,this.attachUtil._hasAttachedNode()&&this._frameCache.enableCacheAttachedInfo(),this._frameCache.updateToFrame(0),this._playing=!0,this._curFrame=this._frameCache.frames[0])}else if(this._armature)return this._armature.animation.play(I,this.playTimes)},updateAnimationCache:function(I){this.isAnimationCached()&&this._armatureCache.updateAnimationCache(this._armatureKey,I)},invalidAnimationCache:function(){this.isAnimationCached()&&this._armatureCache.invalidAnimationCache(this._armatureKey)},getArmatureNames:function(){var I=this._factory.getDragonBonesData(this._armatureKey);return I&&I.armatureNames||[]},getAnimationNames:function(I){var M=[],N=this._factory.getDragonBonesData(this._armatureKey);if(N){var k=N.getArmature(I);if(k)for(var F in k.animations)k.animations.hasOwnProperty(F)&&M.push(F)}return M},on:function(I,M,N){this.addEventListener(I,M,N)},off:function(I,M,N){this.removeEventListener(I,M,N)},once:function(I,M,N){this._eventTarget.once(I,M,N)},addEventListener:function(I,M,N){this._eventTarget.on(I,M,N)},removeEventListener:function(I,M,N){this._eventTarget.off(I,M,N)},buildArmature:function(I,M){return this._factory.createArmatureNode(this,I,M)},armature:function(){return this._armature}});S.exports=dragonBones.ArmatureDisplay=D},{"../../cocos2d/core/components/CCRenderComponent":117,"../../cocos2d/core/event/event-target":143,"../../cocos2d/core/graphics/graphics":159,"../../cocos2d/core/renderer/render-flow":228,"./ArmatureCache":359,"./AttachUtil":361}],361:[function(L,S){var T,_=(T=L("../../cocos2d/core/value-types/mat4"))&&T.__esModule?T:{default:T},w=L("../../cocos2d/core/renderer/render-flow").FLAG_TRANSFORM,B=function(){},A=function(P){Object.defineProperty(P,"_worldMatDirty",{get:function(){return!0},set:function(){}}),P._calculWorldMatrix=B,P._mulMat=B},O=new _.default,R=cc.Class({name:"dragonBones.AttachUtil",ctor:function(){this._inited=!1,this._armature=null,this._armatureNode=null,this._armatureDisplay=null,this._attachedRootNode=null,this._attachedNodeArray=[],this._boneIndexToNode={}},init:function(P){this._inited=!0,this._armature=P._armature,this._armatureNode=P.node,this._armatureDisplay=P},reset:function(){this._inited=!1,this._armature=null,this._armatureNode=null,this._armatureDisplay=null},_prepareAttachNode:function(){if(this._armature){var P=this._armatureNode.getChildByName("ATTACHED_NODE_TREE");return P&&P.isValid||(P=new cc.Node("ATTACHED_NODE_TREE"),A(P),this._armatureNode.addChild(P)),this._armatureDisplay.isAnimationCached()&&this._armatureDisplay._frameCache&&this._armatureDisplay._frameCache.enableCacheAttachedInfo(),this._attachedRootNode=P,P}},_buildBoneAttachedNode:function(P,E){var D="ATTACHED_NODE:"+P.name,I=new cc.Node(D);return this._buildBoneRelation(I,P,E),I},_buildBoneRelation:function(P,E,D){A(P),P._bone=E,P._boneIndex=D,this._attachedNodeArray.push(P),this._boneIndexToNode[D]=P},getAttachedRootNode:function(){return this._attachedRootNode},getAttachedNodes:function(P){var E=this._attachedNodeArray,D=[];if(!this._inited)return D;for(var I=0,M=E.length;I<M;I++){var N=E[I];N&&N.isValid&&N.name==="ATTACHED_NODE:"+P&&D.push(N)}return D},_rebuildNodeArray:function(){for(var P=this._boneIndexToNode={},E=this._attachedNodeArray,D=this._attachedNodeArray=[],I=0,M=E.length;I<M;I++){var N=E[I];N&&N.isValid&&!N._toRemove&&(D.push(N),P[N._boneIndex]=N)}},_sortNodeArray:function(){this._attachedNodeArray.sort(function(P,E){return P._boneIndex<E._boneIndex?-1:1})},_getNodeByBoneIndex:function(P){var E=this._boneIndexToNode[P];return E&&E.isValid?E:null},destroyAttachedNodes:function(P){if(this._inited){for(var E=this._attachedNodeArray,D=function k(F){for(var G=F.children,V=0,j=G.length;V<j;V++){var H=G[V];H&&k(H)}F._toRemove=!0},I=0,M=E.length;I<M;I++){var N=E[I];N&&N.isValid&&N.name.split("ATTACHED_NODE:")[1]===P&&(D(N),N.removeFromParent(!0),N.destroy(),E[I]=null)}this._rebuildNodeArray()}},generateAttachedNodes:function(P){var E=[];if(!this._inited)return E;var D=this._prepareAttachNode();if(!D)return E;var I=0,M=[],N=(function(j){if(j){for(var H,U=j.getBones(),X=0,Y=U.length;X<Y;X++)(H=U[X])._boneIndex=I++,P===H.name&&M.push(H);for(var z,W=j.getSlots(),Z=0,Q=W.length;Z<Q;Z++)(z=W[Z]).childArmature&&N(z.childArmature)}}).bind(this);N(this._armature);for(var k=(function(j){if(j){var H=this._getNodeByBoneIndex(j._boneIndex);if(H)return H;H=this._buildBoneAttachedNode(j,j._boneIndex);var U=null;j.armature.parent&&(U=j.armature.parent.parent);var X=k(j.parent||U)||D;return H.parent=X,j.parent?H._rootNode=X._rootNode:H._rootNode=X,H}}).bind(this),F=0,G=M.length;F<G;F++){var V=k(M[F]);V&&E.push(V)}return this._sortNodeArray(),E},destroyAllAttachedNodes:function(){if(this._attachedRootNode=null,this._attachedNodeArray.length=0,this._boneIndexToNode={},this._inited){var P=this._armatureNode.getChildByName("ATTACHED_NODE_TREE");P&&(P.removeFromParent(!0),P.destroy(),P=null)}},generateAllAttachedNodes:function(){if(this._inited){this._boneIndexToNode={},this._attachedNodeArray.length=0;var P=this._prepareAttachNode();if(P){var E=0,D=(function(I){if(I){var M=P;I.parent&&(M=I.parent.parent._attachedNode);for(var N,k=I.getBones(),F=0,G=k.length;F<G;F++){var V=E++;(N=k[F])._attachedNode=null;var j=null;if(j=N.parent?N.parent._attachedNode:M){var H=j.getChildByName("ATTACHED_NODE:"+N.name);H&&H.isValid?this._buildBoneRelation(H,N,V):(H=this._buildBoneAttachedNode(N,V),j.addChild(H)),H._rootNode=M,N._attachedNode=H}}for(var U,X=I.getSlots(),Y=0,z=X.length;Y<z;Y++)(U=X[Y]).childArmature&&D(U.childArmature)}}).bind(this);return D(this._armature),P}}},_hasAttachedNode:function(){return!!this._inited&&!!this._armatureNode.getChildByName("ATTACHED_NODE_TREE")},_associateAttachedNode:function(){if(this._inited){var P=this._armatureNode.getChildByName("ATTACHED_NODE_TREE");if(P&&P.isValid){this._attachedRootNode=P,this._boneIndexToNode={},this._attachedNodeArray.length=0;var E=this._armature;if(E){A(P),this._armatureDisplay.isAnimationCached()&&this._armatureDisplay._frameCache&&this._armatureDisplay._frameCache.enableCacheAttachedInfo();var D=0,I=(function(M){if(M){var N=P;M.parent&&(N=M.parent.parent._attachedNode);for(var k,F=M.getBones(),G=0,V=F.length;G<V;G++){var j=D++;(k=F[G])._attachedNode=null;var H=null;if(H=k.parent?k.parent._attachedNode:N){var U=H.getChildByName("ATTACHED_NODE:"+k.name);U&&U.isValid&&(this._buildBoneRelation(U,k,j),U._rootNode=N,k._attachedNode=U)}}for(var X,Y=M.getSlots(),z=0,W=Y.length;z<W;z++)(X=Y[z]).childArmature&&I(X.childArmature)}}).bind(this);I(E)}}}},_syncAttachedNode:function(){if(this._inited){var P=this._attachedRootNode,E=this._attachedNodeArray;if(!P||!P.isValid)return this._attachedRootNode=null,void(E.length=0);var D=this._armatureNode._worldMatrix;_.default.copy(P._worldMatrix,D),P._renderFlag&=~w;var I=null,M=this._armatureDisplay.isAnimationCached();if(!M||(I=this._armatureDisplay._curFrame&&this._armatureDisplay._curFrame.boneInfos)){for(var N,k,F,G,V=this._armatureNode._mulMat,j=!1,H=0,U=E.length;H<U;H++){var X=E[H];if(X&&X.isValid){var Y=M?I[X._boneIndex]:X._bone;Y&&!Y._isInPool?(N=X._worldMatrix,k=X._rootNode._worldMatrix,F=Y.globalTransformMatrix,G=void 0,(G=O.m)[0]=F.a,G[1]=F.b,G[4]=-F.c,G[5]=-F.d,G[12]=F.tx,G[13]=F.ty,V(N,k,O),X._renderFlag&=~w):(X.removeFromParent(!0),X.destroy(),E[H]=null,j=!0)}else E[H]=null,j=!0}j&&this._rebuildNodeArray()}}}});S.exports=dragonBones.AttachUtil=R},{"../../cocos2d/core/renderer/render-flow":228,"../../cocos2d/core/value-types/mat4":288}],362:[function(L){var S=L("../../cocos2d/core/event/event-target");dragonBones.CCArmatureDisplay=cc.Class({name:"dragonBones.CCArmatureDisplay",properties:{node:{get:function(){return this}}},ctor:function(){this._eventTarget=new S},setEventTarget:function(T){this._eventTarget=T},getRootDisplay:function(){var T,_=this._armature._parent;if(!_)return this;for(;_;)T=_,_=_._armature._parent;return T._armature.getDisplay()},convertToRootSpace:function(T){var _=this._armature._parent;if(!_)return T;_.updateWorldMatrix();var w=_._worldMatrix.m,B=cc.v2(0,0);return B.x=T.x*w[0]+T.y*w[4]+w[12],B.y=T.x*w[1]+T.y*w[5]+w[13],B},convertToWorldSpace:function(T){var _=this.convertToRootSpace(T);return this.getRootNode().convertToWorldSpaceAR(_)},getRootNode:function(){var T=this.getRootDisplay();return T&&T._ccNode},dbInit:function(T){this._armature=T},dbClear:function(){this._armature=null},dbUpdate:function(){},advanceTimeBySelf:function(T){this.shouldAdvanced=!!T},hasDBEventListener:function(T){return this._eventTarget.hasEventListener(T)},addDBEventListener:function(T,_,w){this._eventTarget.on(T,_,w)},removeDBEventListener:function(T,_,w){this._eventTarget.off(T,_,w)},dispatchDBEvent:function(T,_){this._eventTarget.emit(T,_)}})},{"../../cocos2d/core/event/event-target":143}],363:[function(){var L=dragonBones.BaseObject,S=dragonBones.BaseFactory,T=dragonBones.CCFactory=cc.Class({name:"dragonBones.CCFactory",extends:S,statics:{_factory:null,getInstance:function(){return T._factory||(T._factory=new T),T._factory}},ctor:function(){var _=new dragonBones.CCArmatureDisplay;this._dragonBones=new dragonBones.DragonBones(_),cc.director._scheduler&&(cc.game.on(cc.game.EVENT_RESTART,this.initUpdate,this),this.initUpdate())},initUpdate:function(){cc.director._scheduler.enableForTarget(this),cc.director._scheduler.scheduleUpdate(this,cc.Scheduler.PRIORITY_SYSTEM,!1)},update:function(_){this._dragonBones.advanceTime(_)},getDragonBonesDataByRawData:function(_){return(_ instanceof ArrayBuffer?S._binaryParser:this._dataParser).parseDragonBonesData(_,1)},buildArmatureDisplay:function(_,w,B,A){var O=this.buildArmature(_,w,B,A);return O&&O._display},createArmatureNode:function(_,w,B){var A=(B=B||new cc.Node).getComponent(dragonBones.ArmatureDisplay);return A||(A=B.addComponent(dragonBones.ArmatureDisplay)),B.name=w,A._armatureName=w,A._N$dragonAsset=_.dragonAsset,A._N$dragonAtlasAsset=_.dragonAtlasAsset,A._init(),A},_buildTextureAtlasData:function(_,w){return _?_.renderTexture=w:_=L.borrowObject(dragonBones.CCTextureAtlasData),_},_sortSlots:function(){for(var _=this._slots,w=[],B=0,A=_.length;B<A;B++){for(var O=_[B],R=O._zOrder,P=!1,E=w.length-1;E>=0;E--)if(R>=w[E]._zOrder){w.splice(E+1,0,O),P=!0;break}P||w.unshift(O)}this._slots=w},_buildArmature:function(_){var w=L.borrowObject(dragonBones.Armature);w._skinData=_.skin,w._animation=L.borrowObject(dragonBones.Animation),w._animation._armature=w,w._animation.animations=_.armature.animations,w._isChildArmature=!1;var B=new dragonBones.CCArmatureDisplay;return w.init(_.armature,B,B,this._dragonBones),w},_buildSlot:function(_,w,B){var A=L.borrowObject(dragonBones.CCSlot),O=A;return A.init(w,B,O,O),A},getDragonBonesDataByUUID:function(_){for(var w in this._dragonBonesDataMap)if(w.indexOf(_)!=-1)return this._dragonBonesDataMap[w];return null},removeDragonBonesDataByUUID:function(_,w){for(var B in w===void 0&&(w=!0),this._dragonBonesDataMap)B.indexOf(_)!==-1&&(w&&this._dragonBones.bufferObject(this._dragonBonesDataMap[B]),delete this._dragonBonesDataMap[B])}})},{}],364:[function(L){var S,T=(S=L("../../cocos2d/core/value-types/mat4"))&&S.__esModule?S:{default:S},_=dragonBones.BinaryOffset,w=dragonBones.BoneType;dragonBones.CCSlot=cc.Class({name:"dragonBones.CCSlot",extends:dragonBones.Slot,ctor:function(){this._localVertices=[],this._indices=[],this._matrix=cc.mat4(),this._worldMatrix=cc.mat4(),this._worldMatrixDirty=!0,this._visible=!1,this._color=cc.color()},_onClear:function(){this._super(),this._localVertices.length=0,this._indices.length=0,T.default.identity(this._matrix),T.default.identity(this._worldMatrix),this._worldMatrixDirty=!0,this._color=cc.color(),this._visible=!1},statics:{toString:function(){return"[class dragonBones.CCSlot]"}},_onUpdateDisplay:function(){},_initDisplay:function(){},_addDisplay:function(){this._visible=!0},_replaceDisplay:function(){},_removeDisplay:function(){this._visible=!1},_disposeDisplay:function(){},_updateVisible:function(){this._visible=this.parent._visible},_updateZOrder:function(){},_updateBlendMode:function(){if(this._childArmature)for(var B=this._childArmature.getSlots(),A=0,O=B.length;A<O;A++){var R=B[A];R._blendMode=this._blendMode,R._updateBlendMode()}},_updateColor:function(){var B=this._color;B.r=255*this._colorTransform.redMultiplier,B.g=255*this._colorTransform.greenMultiplier,B.b=255*this._colorTransform.blueMultiplier,B.a=255*this._colorTransform.alphaMultiplier},getTexture:function(){return this._textureData&&this._textureData.spriteFrame&&this._textureData.spriteFrame.getTexture()},_updateFrame:function(){this._indices.length=0;var B=this._indices,A=this._localVertices,O=0,R=0,P=this._textureData;if(this._display&&!(this._displayIndex<0)&&P&&P.spriteFrame){var E=P.spriteFrame.getTexture(),D=E.width,I=E.height,M=P.region,N=this._deformVertices!==null&&this._display===this._meshDisplay?this._deformVertices.verticesData:null;if(N){var k=N.data,F=k.intArray,G=k.floatArray,V=F[N.offset+_.MeshVertexCount],j=F[N.offset+_.MeshTriangleCount],H=F[N.offset+_.MeshFloatOffset];H<0&&(H+=65536);for(var U=H+2*V,X=this._armature._armatureData.scale,Y=0,z=2*V;Y<z;Y+=2)A[R++]=G[H+Y]*X,A[R++]=-G[H+Y+1]*X,N.rotated?(A[R++]=(M.x+(1-G[U+Y])*M.width)/D,A[R++]=(M.y+G[U+Y+1]*M.height)/I):(A[R++]=(M.x+G[U+Y]*M.width)/D,A[R++]=(M.y+G[U+Y+1]*M.height)/I);for(var W=0;W<3*j;++W)B[O++]=F[N.offset+_.MeshVertexIndices+W];A.length=R,B.length=O,N.weight&&this._identityTransform()}else{var Z=M.x/D,Q=(M.y+M.height)/I,ee=(M.x+M.width)/D,te=M.y/I;A[R++]=0,A[R++]=0,A[R++]=Z,A[R++]=Q,A[R++]=M.width,A[R++]=0,A[R++]=ee,A[R++]=Q,A[R++]=0,A[R++]=M.height,A[R++]=Z,A[R++]=te,A[R++]=M.width,A[R++]=M.height,A[R++]=ee,A[R++]=te,B[0]=0,B[1]=1,B[2]=2,B[3]=1,B[4]=3,B[5]=2,A.length=R,B.length=6}this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0}},_updateMesh:function(){var B=this._armature._armatureData.scale,A=this._deformVertices.vertices,O=this._deformVertices.bones,R=this._deformVertices.verticesData,P=R.weight,E=A.length>0&&R.inheritDeform,D=this._localVertices;if(P){var I=R.data,M=I.intArray,N=I.floatArray,k=M[R.offset+_.MeshVertexCount],F=M[P.offset+_.WeigthFloatOffset];F<0&&(F+=65536);for(var G=0,V=P.offset+_.WeigthBoneIndices+O.length,j=F,H=0,U=0;G<k;G++,U+=4){for(var X=M[V++],Y=0,z=0,W=0;W<X;++W){var Z=O[M[V++]];if(Z!==null){var Q=Z.globalTransformMatrix,ee=N[j++],te=N[j++]*B,re=N[j++]*B;E&&(te+=A[H++],re+=A[H++]),Y+=(Q.a*te+Q.c*re+Q.tx)*ee,z+=(Q.b*te+Q.d*re+Q.ty)*ee}}D[U]=Y,D[U+1]=-z}}else if(E){var ie=this._parent._boneData.type!==w.Bone,ne=R.data,he=ne.intArray,pe=ne.floatArray,K=he[R.offset+_.MeshVertexCount],ue=he[R.offset+_.MeshFloatOffset];ue<0&&(ue+=65536);for(var le=0,ce=K,_e=0;le<ce;le++,_e+=4){var oe=pe[ue+2*le]*B+A[2*le],de=pe[ue+2*le+1]*B+A[2*le+1];if(ie){var me=this._parent._getGlobalTransformMatrix(oe,de);D[_e]=me.a*oe+me.c*de+me.tx,D[_e+1]=-me.b*oe+me.d*de+me.ty}else D[_e]=oe,D[_e+1]=-de}}P&&this._identityTransform()},_identityTransform:function(){var B=this._matrix.m;B[0]=1,B[1]=0,B[4]=-0,B[5]=-1,B[12]=0,B[13]=0,this._worldMatrixDirty=!0},_updateTransform:function(){var B=this._matrix.m;B[0]=this.globalTransformMatrix.a,B[1]=this.globalTransformMatrix.b,B[4]=-this.globalTransformMatrix.c,B[5]=-this.globalTransformMatrix.d,this._childArmature?(B[12]=this.globalTransformMatrix.tx,B[13]=this.globalTransformMatrix.ty):(B[12]=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX-this.globalTransformMatrix.c*this._pivotY),B[13]=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX-this.globalTransformMatrix.d*this._pivotY)),this._worldMatrixDirty=!0},updateWorldMatrix:function(){if(this._armature){var B=this._armature._parent;if(B&&B.updateWorldMatrix(),this._worldMatrixDirty){this.calculWorldMatrix();var A=this.childArmature;if(!A)return;for(var O=A.getSlots(),R=0,P=O.length;R<P;R++){var E=O[R];E&&(E._worldMatrixDirty=!0)}}}},_mulMat:function(B,A,O){var R=A.m,P=O.m,E=B.m,D=R[0],I=R[1],M=R[4],N=R[5],k=R[12],F=R[13],G=P[0],V=P[1],j=P[4],H=P[5],U=P[12],X=P[13];I!==0||M!==0?(E[0]=G*D+V*M,E[1]=G*I+V*N,E[4]=j*D+H*M,E[5]=j*I+H*N,E[12]=D*U+M*X+k,E[13]=I*U+N*X+F):(E[0]=G*D,E[1]=V*N,E[4]=j*D,E[5]=H*N,E[12]=D*U+k,E[13]=N*X+F)},calculWorldMatrix:function(){var B=this._armature._parent;B?this._mulMat(this._worldMatrix,B._worldMatrix,this._matrix):T.default.copy(this._worldMatrix,this._matrix),this._worldMatrixDirty=!1}})},{"../../cocos2d/core/value-types/mat4":288}],365:[function(){dragonBones.CCTextureAtlasData=cc.Class({extends:dragonBones.TextureAtlasData,name:"dragonBones.CCTextureAtlasData",properties:{_renderTexture:{default:null,serializable:!1},renderTexture:{get:function(){return this._renderTexture},set:function(L){if(this._renderTexture=L,L)for(var S in this.textures){var T=this.textures[S];if(!T.spriteFrame){var _;_=T.rotated?cc.rect(T.region.x,T.region.y,T.region.height,T.region.width):cc.rect(T.region.x,T.region.y,T.region.width,T.region.height);var w=cc.v2(0,0),B=cc.size(_.width,_.height);T.spriteFrame=new cc.SpriteFrame,T.spriteFrame.setTexture(L,_,!1,w,B)}}else for(var A in this.textures)this.textures[A].spriteFrame=null}}},statics:{toString:function(){return"[class dragonBones.CCTextureAtlasData]"}},_onClear:function(){dragonBones.TextureAtlasData.prototype._onClear.call(this),this.renderTexture=null},createTexture:function(){return dragonBones.BaseObject.borrowObject(dragonBones.CCTextureData)}}),dragonBones.CCTextureData=cc.Class({extends:dragonBones.TextureData,name:"dragonBones.CCTextureData",properties:{spriteFrame:{default:null,serializable:!1}},statics:{toString:function(){return"[class dragonBones.CCTextureData]"}},_onClear:function(){dragonBones.TextureData.prototype._onClear.call(this),this.spriteFrame=null}})},{}],366:[function(L,S){var T=L("./ArmatureCache").sharedCache,_=cc.Class({name:"dragonBones.DragonBonesAsset",extends:cc.Asset,ctor:function(){this.reset()},properties:{_dragonBonesJson:"",dragonBonesJson:{get:function(){return this._dragonBonesJson},set:function(w){this._dragonBonesJson=w,this._dragonBonesJsonData=JSON.parse(w),this.reset()}},_nativeAsset:{get:function(){return this._buffer},set:function(w){this._buffer=w.buffer||w,this.reset()},override:!0}},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){this._clear()},init:function(w,B){this._factory=w,!this._dragonBonesJsonData&&this.dragonBonesJson&&(this._dragonBonesJsonData=JSON.parse(this.dragonBonesJson));var A;if(A=this._dragonBonesJsonData?this._dragonBonesJsonData:this._nativeAsset,!this._uuid){var O=this._factory.getDragonBonesDataByRawData(A);O?this._uuid=O.name:cc.warn("dragonbones name is empty")}var R=this._uuid+"#"+B;return this._factory.getDragonBonesData(R)||this._factory.parseDragonBonesData(A,R),R},getArmatureEnum:!1,getAnimsEnum:!1,_clear:function(){this._factory&&(T.resetArmature(this._uuid),this._factory.removeDragonBonesDataByUUID(this._uuid,!0))},destroy:function(){this._clear(),this._super()}});dragonBones.DragonBonesAsset=S.exports=_},{"./ArmatureCache":359}],367:[function(L,S){var T=L("./ArmatureCache").sharedCache,_=cc.Class({name:"dragonBones.DragonBonesAtlasAsset",extends:cc.Asset,ctor:function(){this._clear()},properties:{_atlasJson:"",atlasJson:{get:function(){return this._atlasJson},set:function(w){this._atlasJson=w,this._atlasJsonData=JSON.parse(this.atlasJson),this._clear()}},_texture:{default:null,type:cc.Texture2D,formerlySerializedAs:"texture"},texture:{get:function(){return this._texture},set:function(w){this._texture=w,this._clear()}},_textureAtlasData:null},statics:{preventDeferredLoadDependents:!0},createNode:!1,init:function(w){this._factory=w,this._atlasJsonData||(this._atlasJsonData=JSON.parse(this.atlasJson));var B=this._atlasJsonData;this._uuid=this._uuid||B.name,this._textureAtlasData?w.addTextureAtlasData(this._textureAtlasData,this._uuid):this._textureAtlasData=w.parseTextureAtlasData(B,this.texture,this._uuid)},_clear:function(){this._factory&&(T.resetArmature(this._uuid),this._factory.removeTextureAtlasData(this._uuid,!0),this._factory.removeDragonBonesDataByUUID(this._uuid,!0)),this._textureAtlasData=null},destroy:function(){this._clear(),this._super()}});dragonBones.DragonBonesAtlasAsset=S.exports=_},{"./ArmatureCache":359}],368:[function(L){var S=typeof window>"u"?global:window;S.dragonBones=L("./lib/dragonBones"),cc.sys.platform!==cc.sys.TAOBAO&&cc.sys.platform!==cc.sys.TAOBAO_MINIGAME||(dragonBones=S.dragonBones),S.dragonBones!==void 0&&(dragonBones._timeScale=1,Object.defineProperty(dragonBones,"timeScale",{get:function(){return this._timeScale},set:function(T){this._timeScale=T,this.CCFactory.getInstance()._dragonBones.clock.timeScale=T},configurable:!0}),dragonBones.DisplayType={Image:0,Armature:1,Mesh:2},dragonBones.ArmatureType={Armature:0,MovieClip:1,Stage:2},dragonBones.ExtensionType={FFD:0,AdjustColor:10,BevelFilter:11,BlurFilter:12,DropShadowFilter:13,GlowFilter:14,GradientBevelFilter:15,GradientGlowFilter:16},dragonBones.EventType={Frame:0,Sound:1},dragonBones.ActionType={Play:0,Stop:1,GotoAndPlay:2,GotoAndStop:3,FadeIn:4,FadeOut:5},dragonBones.AnimationFadeOutMode={None:0,SameLayer:1,SameGroup:2,SameLayerAndGroup:3,All:4},dragonBones.BinaryOffset={WeigthBoneCount:0,WeigthFloatOffset:1,WeigthBoneIndices:2,MeshVertexCount:0,MeshTriangleCount:1,MeshFloatOffset:2,MeshWeightOffset:3,MeshVertexIndices:4,TimelineScale:0,TimelineOffset:1,TimelineKeyFrameCount:2,TimelineFrameValueCount:3,TimelineFrameValueOffset:4,TimelineFrameOffset:5,FramePosition:0,FrameTweenType:1,FrameTweenEasingOrCurveSampleCount:2,FrameCurveSamples:3,DeformMeshOffset:0,DeformCount:1,DeformValueCount:2,DeformValueOffset:3,DeformFloatOffset:4},dragonBones.BoneType={Bone:0,Surface:1},L("./CCFactory"),L("./CCSlot"),L("./CCTextureData"),L("./CCArmatureDisplay"),L("./ArmatureCache"),L("./DragonBonesAsset"),L("./DragonBonesAtlasAsset"),L("./ArmatureDisplay"),L("./webgl-assembler"))},{"./ArmatureCache":359,"./ArmatureDisplay":360,"./CCArmatureDisplay":362,"./CCFactory":363,"./CCSlot":364,"./CCTextureData":365,"./DragonBonesAsset":366,"./DragonBonesAtlasAsset":367,"./lib/dragonBones":369,"./webgl-assembler":370}],369:[function(L,S){var T,_,w,B=Object.setPrototypeOf||Array;w||(w={}),function(A){var O=function(){function R(P){this._clock=new A.WorldClock,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=P,console.info("DragonBones: "+R.VERSION+"\nWebsite: http://dragonbones.com/\nSource and Demo: https://github.com/DragonBones/")}return R.prototype.advanceTime=function(P){if(this._objects.length>0){for(var E=0,D=this._objects;E<D.length;E++)D[E].returnToPool();this._objects.length=0}if(this._clock.advanceTime(P),this._events.length>0){for(var I=0;I<this._events.length;++I){var M=this._events[I],N=M.armature;N._armatureData!==null&&(N.eventDispatcher.dispatchDBEvent(M.type,M),M.type===A.EventObject.SOUND_EVENT&&this._eventManager.dispatchDBEvent(M.type,M)),this.bufferObject(M)}this._events.length=0}},R.prototype.bufferEvent=function(P){this._events.indexOf(P)<0&&this._events.push(P)},R.prototype.bufferObject=function(P){this._objects.indexOf(P)<0&&this._objects.push(P)},Object.defineProperty(R.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),R.VERSION="5.6.300",R.yDown=!1,R.debug=!1,R.debugDraw=!1,R.webAssembly=!1,R}();A.DragonBones=O}(w||(w={})),console.warn||(console.warn=function(){}),console.assert||(console.assert=function(){}),Date.now||(Date.now=function(){return new Date().getTime()}),B=function(A,O){function R(){this.constructor=A}for(var P in O)O.hasOwnProperty(P)&&(A[P]=O[P]);R.prototype=O.prototype,A.prototype=new R},function(A){var O=function(){function R(){this.hashCode=R._hashCode++,this._isInPool=!1}return R._returnObject=function(P){var E=String(P.constructor),D=E in R._maxCountMap?R._maxCountMap[E]:R._defaultMaxCount,I=R._poolsMap[E]=R._poolsMap[E]||[];I.length<D&&(P._isInPool?console.warn("The object is already in the pool."):(P._isInPool=!0,I.push(P)))},R.toString=function(){throw new Error},R.setMaxCount=function(P,E){if((E<0||E!=E)&&(E=0),P!==null)(I=(D=String(P))in R._poolsMap?R._poolsMap[D]:null)!==null&&I.length>E&&(I.length=E),R._maxCountMap[D]=E;else for(var D in R._defaultMaxCount=E,R._poolsMap){var I;(I=R._poolsMap[D]).length>E&&(I.length=E),D in R._maxCountMap&&(R._maxCountMap[D]=E)}},R.clearPool=function(P){if(P===void 0&&(P=null),P!==null){var E=String(P);(I=E in R._poolsMap?R._poolsMap[E]:null)!==null&&I.length>0&&(I.length=0)}else for(var D in R._poolsMap){var I;(I=R._poolsMap[D]).length=0}},R.borrowObject=function(P){var E=String(P),D=E in R._poolsMap?R._poolsMap[E]:null;if(D!==null&&D.length>0){var I=D.pop();return I._isInPool=!1,I}var M=new P;return M._onClear(),M},R.prototype.returnToPool=function(){this._onClear(),R._returnObject(this)},R._hashCode=0,R._defaultMaxCount=3e3,R._maxCountMap={},R._poolsMap={},R}();A.BaseObject=O}(w||(w={})),function(A){var O=function(){function R(P,E,D,I,M,N){P===void 0&&(P=1),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=1),M===void 0&&(M=0),N===void 0&&(N=0),this.a=P,this.b=E,this.c=D,this.d=I,this.tx=M,this.ty=N}return R.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},R.prototype.copyFrom=function(P){return this.a=P.a,this.b=P.b,this.c=P.c,this.d=P.d,this.tx=P.tx,this.ty=P.ty,this},R.prototype.copyFromArray=function(P,E){return E===void 0&&(E=0),this.a=P[E],this.b=P[E+1],this.c=P[E+2],this.d=P[E+3],this.tx=P[E+4],this.ty=P[E+5],this},R.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},R.prototype.concat=function(P){var E=this.a*P.a,D=0,I=0,M=this.d*P.d,N=this.tx*P.a+P.tx,k=this.ty*P.d+P.ty;return this.b===0&&this.c===0||(E+=this.b*P.c,D+=this.b*P.d,I+=this.c*P.a,M+=this.c*P.b),P.b===0&&P.c===0||(D+=this.a*P.b,I+=this.d*P.c,N+=this.ty*P.c,k+=this.tx*P.b),this.a=E,this.b=D,this.c=I,this.d=M,this.tx=N,this.ty=k,this},R.prototype.invert=function(){var P=this.a,E=this.b,D=this.c,I=this.d,M=this.tx,N=this.ty;if(E===0&&D===0)return this.b=this.c=0,P===0||I===0?this.a=this.b=this.tx=this.ty=0:(P=this.a=1/P,I=this.d=1/I,this.tx=-P*M,this.ty=-I*N),this;var k=P*I-E*D;if(k===0)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;k=1/k;var F=this.a=I*k;return E=this.b=-E*k,D=this.c=-D*k,I=this.d=P*k,this.tx=-(F*M+D*N),this.ty=-(E*M+I*N),this},R.prototype.transformPoint=function(P,E,D,I){I===void 0&&(I=!1),D.x=this.a*P+this.c*E,D.y=this.b*P+this.d*E,I||(D.x+=this.tx,D.y+=this.ty)},R.prototype.transformRectangle=function(P,E){E===void 0&&(E=!1);var D=this.a,I=this.b,M=this.c,N=this.d,k=E?0:this.tx,F=E?0:this.ty,G=P.x,V=P.y,j=G+P.width,H=V+P.height,U=D*G+M*V+k,X=I*G+N*V+F,Y=D*j+M*V+k,z=I*j+N*V+F,W=D*j+M*H+k,Z=I*j+N*H+F,Q=D*G+M*H+k,ee=I*G+N*H+F,te=0;U>Y&&(te=U,U=Y,Y=te),W>Q&&(te=W,W=Q,Q=te),P.x=Math.floor(U<W?U:W),P.width=Math.ceil((Y>Q?Y:Q)-P.x),X>z&&(te=X,X=z,z=te),Z>ee&&(te=Z,Z=ee,ee=te),P.y=Math.floor(X<Z?X:Z),P.height=Math.ceil((z>ee?z:ee)-P.y)},R}();A.Matrix=O}(w||(w={})),function(A){var O=function(){function R(P,E,D,I,M,N){P===void 0&&(P=0),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=0),M===void 0&&(M=1),N===void 0&&(N=1),this.x=P,this.y=E,this.skew=D,this.rotation=I,this.scaleX=M,this.scaleY=N}return R.normalizeRadian=function(P){return(P=(P+Math.PI)%(2*Math.PI))+(P>0?-Math.PI:Math.PI)},R.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skew/Math.PI+" skewY:"+180*this.rotation/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},R.prototype.copyFrom=function(P){return this.x=P.x,this.y=P.y,this.skew=P.skew,this.rotation=P.rotation,this.scaleX=P.scaleX,this.scaleY=P.scaleY,this},R.prototype.identity=function(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this},R.prototype.add=function(P){return this.x+=P.x,this.y+=P.y,this.skew+=P.skew,this.rotation+=P.rotation,this.scaleX*=P.scaleX,this.scaleY*=P.scaleY,this},R.prototype.minus=function(P){return this.x-=P.x,this.y-=P.y,this.skew-=P.skew,this.rotation-=P.rotation,this.scaleX/=P.scaleX,this.scaleY/=P.scaleY,this},R.prototype.fromMatrix=function(P){var E=this.scaleX,D=this.scaleY,I=R.PI_Q;this.x=P.tx,this.y=P.ty,this.rotation=Math.atan(P.b/P.a);var M=Math.atan(-P.c/P.d);return this.scaleX=this.rotation>-I&&this.rotation<I?P.a/Math.cos(this.rotation):P.b/Math.sin(this.rotation),this.scaleY=M>-I&&M<I?P.d/Math.cos(M):-P.c/Math.sin(M),E>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),D>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,M-=Math.PI),this.skew=M-this.rotation,this},R.prototype.toMatrix=function(P){return this.rotation===0?(P.a=1,P.b=0):(P.a=Math.cos(this.rotation),P.b=Math.sin(this.rotation)),this.skew===0?(P.c=-P.b,P.d=P.a):(P.c=-Math.sin(this.skew+this.rotation),P.d=Math.cos(this.skew+this.rotation)),this.scaleX!==1&&(P.a*=this.scaleX,P.b*=this.scaleX),this.scaleY!==1&&(P.c*=this.scaleY,P.d*=this.scaleY),P.tx=this.x,P.ty=this.y,this},R.PI=Math.PI,R.PI_D=2*Math.PI,R.PI_H=Math.PI/2,R.PI_Q=Math.PI/4,R.RAD_DEG=180/Math.PI,R.DEG_RAD=Math.PI/180,R}();A.Transform=O}(w||(w={})),function(A){var O=function(){function R(P,E,D,I,M,N,k,F){P===void 0&&(P=1),E===void 0&&(E=1),D===void 0&&(D=1),I===void 0&&(I=1),M===void 0&&(M=0),N===void 0&&(N=0),k===void 0&&(k=0),F===void 0&&(F=0),this.alphaMultiplier=P,this.redMultiplier=E,this.greenMultiplier=D,this.blueMultiplier=I,this.alphaOffset=M,this.redOffset=N,this.greenOffset=k,this.blueOffset=F}return R.prototype.copyFrom=function(P){this.alphaMultiplier=P.alphaMultiplier,this.redMultiplier=P.redMultiplier,this.greenMultiplier=P.greenMultiplier,this.blueMultiplier=P.blueMultiplier,this.alphaOffset=P.alphaOffset,this.redOffset=P.redOffset,this.greenOffset=P.greenOffset,this.blueOffset=P.blueOffset},R.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},R}();A.ColorTransform=O}(w||(w={})),function(A){var O=function(){function R(P,E){P===void 0&&(P=0),E===void 0&&(E=0),this.x=P,this.y=E}return R.prototype.copyFrom=function(P){this.x=P.x,this.y=P.y},R.prototype.clear=function(){this.x=this.y=0},R}();A.Point=O}(w||(w={})),function(A){var O=function(){function R(P,E,D,I){P===void 0&&(P=0),E===void 0&&(E=0),D===void 0&&(D=0),I===void 0&&(I=0),this.x=P,this.y=E,this.width=D,this.height=I}return R.prototype.copyFrom=function(P){this.x=P.x,this.y=P.y,this.width=P.width,this.height=P.height},R.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},R}();A.Rectangle=O}(w||(w={})),function(A){var O=function(P){function E(){var D=P!==null&&P.apply(this,arguments)||this;return D.ints=[],D.floats=[],D.strings=[],D}return B(E,P),E.toString=function(){return"[class dragonBones.UserData]"},E.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},E.prototype.addInt=function(D){this.ints.push(D)},E.prototype.addFloat=function(D){this.floats.push(D)},E.prototype.addString=function(D){this.strings.push(D)},E.prototype.getInt=function(D){return D===void 0&&(D=0),D>=0&&D<this.ints.length?this.ints[D]:0},E.prototype.getFloat=function(D){return D===void 0&&(D=0),D>=0&&D<this.floats.length?this.floats[D]:0},E.prototype.getString=function(D){return D===void 0&&(D=0),D>=0&&D<this.strings.length?this.strings[D]:""},E}(A.BaseObject);A.UserData=O;var R=function(P){function E(){var D=P!==null&&P.apply(this,arguments)||this;return D.data=null,D}return B(E,P),E.toString=function(){return"[class dragonBones.ActionData]"},E.prototype._onClear=function(){this.data!==null&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null},E}(A.BaseObject);A.ActionData=R}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E.frameIndices=[],E.cachedFrames=[],E.armatureNames=[],E.armatures={},E.userData=null,E}return B(P,R),P.toString=function(){return"[class dragonBones.DragonBonesData]"},P.prototype._onClear=function(){for(var E in this.armatures)this.armatures[E].returnToPool(),delete this.armatures[E];this.userData!==null&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.userData=null},P.prototype.addArmature=function(E){E.name in this.armatures?console.warn("Same armature: "+E.name):(E.parent=this,this.armatures[E.name]=E,this.armatureNames.push(E.name))},P.prototype.getArmature=function(E){return E in this.armatures?this.armatures[E]:null},P.prototype.dispose=function(){console.warn("已废弃"),this.returnToPool()},P}(A.BaseObject);A.DragonBonesData=O}(w||(w={})),function(A){var O=function(D){function I(){var M=D!==null&&D.apply(this,arguments)||this;return M.aabb=new A.Rectangle,M.animationNames=[],M.sortedBones=[],M.sortedSlots=[],M.defaultActions=[],M.actions=[],M.bones={},M.slots={},M.constraints={},M.skins={},M.animations={},M.canvas=null,M.userData=null,M}return B(I,D),I.toString=function(){return"[class dragonBones.ArmatureData]"},I.prototype._onClear=function(){for(var M=0,N=this.defaultActions;M<N.length;M++)N[M].returnToPool();for(var k=0,F=this.actions;k<F.length;k++)F[k].returnToPool();for(var G in this.bones)this.bones[G].returnToPool(),delete this.bones[G];for(var G in this.slots)this.slots[G].returnToPool(),delete this.slots[G];for(var G in this.constraints)this.constraints[G].returnToPool(),delete this.constraints[G];for(var G in this.skins)this.skins[G].returnToPool(),delete this.skins[G];for(var G in this.animations)this.animations[G].returnToPool(),delete this.animations[G];this.canvas!==null&&this.canvas.returnToPool(),this.userData!==null&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null},I.prototype.sortBones=function(){var M=this.sortedBones.length;if(!(M<=0)){var N=this.sortedBones.concat(),k=0,F=0;for(this.sortedBones.length=0;F<M;){var G=N[k++];if(k>=M&&(k=0),!(this.sortedBones.indexOf(G)>=0)){var V=!1;for(var j in this.constraints){var H=this.constraints[j];if(H.root===G&&this.sortedBones.indexOf(H.target)<0){V=!0;break}}V||G.parent!==null&&this.sortedBones.indexOf(G.parent)<0||(this.sortedBones.push(G),F++)}}}},I.prototype.cacheFrames=function(M){if(!(this.cacheFrameRate>0))for(var N in this.cacheFrameRate=M,this.animations)this.animations[N].cacheFrames(this.cacheFrameRate)},I.prototype.setCacheFrame=function(M,N){var k=this.parent.cachedFrames,F=k.length;return k.length+=10,k[F]=M.a,k[F+1]=M.b,k[F+2]=M.c,k[F+3]=M.d,k[F+4]=M.tx,k[F+5]=M.ty,k[F+6]=N.rotation,k[F+7]=N.skew,k[F+8]=N.scaleX,k[F+9]=N.scaleY,F},I.prototype.getCacheFrame=function(M,N,k){var F=this.parent.cachedFrames;M.a=F[k],M.b=F[k+1],M.c=F[k+2],M.d=F[k+3],M.tx=F[k+4],M.ty=F[k+5],N.rotation=F[k+6],N.skew=F[k+7],N.scaleX=F[k+8],N.scaleY=F[k+9],N.x=M.tx,N.y=M.ty},I.prototype.addBone=function(M){M.name in this.bones?console.warn("Same bone: "+M.name):(this.bones[M.name]=M,this.sortedBones.push(M))},I.prototype.addSlot=function(M){M.name in this.slots?console.warn("Same slot: "+M.name):(this.slots[M.name]=M,this.sortedSlots.push(M))},I.prototype.addConstraint=function(M){M.name in this.constraints?console.warn("Same constraint: "+M.name):this.constraints[M.name]=M},I.prototype.addSkin=function(M){M.name in this.skins?console.warn("Same skin: "+M.name):(M.parent=this,this.skins[M.name]=M,this.defaultSkin===null&&(this.defaultSkin=M),M.name==="default"&&(this.defaultSkin=M))},I.prototype.addAnimation=function(M){M.name in this.animations?console.warn("Same animation: "+M.name):(M.parent=this,this.animations[M.name]=M,this.animationNames.push(M.name),this.defaultAnimation===null&&(this.defaultAnimation=M))},I.prototype.addAction=function(M,N){N?this.defaultActions.push(M):this.actions.push(M)},I.prototype.getBone=function(M){return M in this.bones?this.bones[M]:null},I.prototype.getSlot=function(M){return M in this.slots?this.slots[M]:null},I.prototype.getConstraint=function(M){return M in this.constraints?this.constraints[M]:null},I.prototype.getSkin=function(M){return M in this.skins?this.skins[M]:null},I.prototype.getMesh=function(M,N,k){var F=this.getSkin(M);return F===null?null:F.getDisplay(N,k)},I.prototype.getAnimation=function(M){return M in this.animations?this.animations[M]:null},I}(A.BaseObject);A.ArmatureData=O;var R=function(D){function I(){var M=D!==null&&D.apply(this,arguments)||this;return M.transform=new A.Transform,M.userData=null,M}return B(I,D),I.toString=function(){return"[class dragonBones.BoneData]"},I.prototype._onClear=function(){this.userData!==null&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=0,this.length=0,this.name="",this.transform.identity(),this.userData=null,this.parent=null},I}(A.BaseObject);A.BoneData=R;var P=function(D){function I(){var M=D!==null&&D.apply(this,arguments)||this;return M.vertices=[],M}return B(I,D),I.toString=function(){return"[class dragonBones.SurfaceData]"},I.prototype._onClear=function(){D.prototype._onClear.call(this),this.type=1,this.segmentX=0,this.segmentY=0,this.vertices.length=0},I}(R);A.SurfaceData=P;var E=function(D){function I(){var M=D!==null&&D.apply(this,arguments)||this;return M.color=null,M.userData=null,M}return B(I,D),I.createColor=function(){return new A.ColorTransform},I.toString=function(){return"[class dragonBones.SlotData]"},I.prototype._onClear=function(){this.userData!==null&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.name="",this.color=null,this.userData=null,this.parent=null},I.DEFAULT_COLOR=new A.ColorTransform,I}(A.BaseObject);A.SlotData=E}(w||(w={})),function(A){var O=function(E){function D(){return E!==null&&E.apply(this,arguments)||this}return B(D,E),D.prototype._onClear=function(){this.order=0,this.name="",this.type=0,this.target=null,this.root=null,this.bone=null},D}(A.BaseObject);A.ConstraintData=O;var R=function(E){function D(){return E!==null&&E.apply(this,arguments)||this}return B(D,E),D.toString=function(){return"[class dragonBones.IKConstraintData]"},D.prototype._onClear=function(){E.prototype._onClear.call(this),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1},D}(O);A.IKConstraintData=R;var P=function(E){function D(){var I=E!==null&&E.apply(this,arguments)||this;return I.bones=[],I}return B(D,E),D.toString=function(){return"[class dragonBones.PathConstraintData]"},D.prototype._onClear=function(){E.prototype._onClear.call(this),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=0,this.spacingMode=1,this.rotateMode=1,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0},D.prototype.AddBone=function(I){this.bones.push(I)},D}(O);A.PathConstraintData=P}(w||(w={})),function(A){var O=function(R){function P(){return R!==null&&R.apply(this,arguments)||this}return B(P,R),P.toString=function(){return"[class dragonBones.CanvasData]"},P.prototype._onClear=function(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0},P}(A.BaseObject);A.CanvasData=O}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E.displays={},E}return B(P,R),P.toString=function(){return"[class dragonBones.SkinData]"},P.prototype._onClear=function(){for(var E in this.displays){for(var D=0,I=this.displays[E];D<I.length;D++){var M=I[D];M!==null&&M.returnToPool()}delete this.displays[E]}this.name="",this.parent=null},P.prototype.addDisplay=function(E,D){E in this.displays||(this.displays[E]=[]),D!==null&&(D.parent=this),this.displays[E].push(D)},P.prototype.getDisplay=function(E,D){var I=this.getDisplays(E);if(I!==null)for(var M=0,N=I;M<N.length;M++){var k=N[M];if(k!==null&&k.name===D)return k}return null},P.prototype.getDisplays=function(E){return E in this.displays?this.displays[E]:null},P}(A.BaseObject);A.SkinData=O}(w||(w={})),function(A){var O=function(){function k(){this.weight=null}return k.prototype.clear=function(){this.isShared||this.weight===null||this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null},k.prototype.shareFrom=function(F){this.isShared=!0,this.offset=F.offset,this.weight=F.weight},k}();A.VerticesData=O;var R=function(k){function F(){var G=k!==null&&k.apply(this,arguments)||this;return G.transform=new A.Transform,G}return B(F,k),F.prototype._onClear=function(){this.name="",this.path="",this.transform.identity(),this.parent=null},F}(A.BaseObject);A.DisplayData=R;var P=function(k){function F(){var G=k!==null&&k.apply(this,arguments)||this;return G.pivot=new A.Point,G}return B(F,k),F.toString=function(){return"[class dragonBones.ImageDisplayData]"},F.prototype._onClear=function(){k.prototype._onClear.call(this),this.type=0,this.pivot.clear(),this.texture=null},F}(R);A.ImageDisplayData=P;var E=function(k){function F(){var G=k!==null&&k.apply(this,arguments)||this;return G.actions=[],G}return B(F,k),F.toString=function(){return"[class dragonBones.ArmatureDisplayData]"},F.prototype._onClear=function(){k.prototype._onClear.call(this);for(var G=0,V=this.actions;G<V.length;G++)V[G].returnToPool();this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null},F.prototype.addAction=function(G){this.actions.push(G)},F}(R);A.ArmatureDisplayData=E;var D=function(k){function F(){var G=k!==null&&k.apply(this,arguments)||this;return G.vertices=new O,G}return B(F,k),F.toString=function(){return"[class dragonBones.MeshDisplayData]"},F.prototype._onClear=function(){k.prototype._onClear.call(this),this.type=2,this.vertices.clear(),this.texture=null},F}(R);A.MeshDisplayData=D;var I=function(k){function F(){var G=k!==null&&k.apply(this,arguments)||this;return G.boundingBox=null,G}return B(F,k),F.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"},F.prototype._onClear=function(){k.prototype._onClear.call(this),this.boundingBox!==null&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null},F}(R);A.BoundingBoxDisplayData=I;var M=function(k){function F(){var G=k!==null&&k.apply(this,arguments)||this;return G.vertices=new O,G.curveLengths=[],G}return B(F,k),F.toString=function(){return"[class dragonBones.PathDisplayData]"},F.prototype._onClear=function(){k.prototype._onClear.call(this),this.type=4,this.closed=!1,this.constantSpeed=!1,this.vertices.clear(),this.curveLengths.length=0},F}(R);A.PathDisplayData=M;var N=function(k){function F(){var G=k!==null&&k.apply(this,arguments)||this;return G.bones=[],G}return B(F,k),F.toString=function(){return"[class dragonBones.WeightData]"},F.prototype._onClear=function(){this.count=0,this.offset=0,this.bones.length=0},F.prototype.addBone=function(G){this.bones.push(G)},F}(A.BaseObject);A.WeightData=N}(w||(w={})),function(A){var O=function(D){function I(){return D!==null&&D.apply(this,arguments)||this}return B(I,D),I.prototype._onClear=function(){this.color=0,this.width=0,this.height=0},I}(A.BaseObject);A.BoundingBoxData=O;var R=function(D){function I(){return D!==null&&D.apply(this,arguments)||this}return B(I,D),I.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"},I._computeOutCode=function(M,N,k,F,G,V){var j=0;return M<k?j|=1:M>G&&(j|=2),N<F?j|=4:N>V&&(j|=8),j},I.rectangleIntersectsSegment=function(M,N,k,F,G,V,j,H,U,X,Y){U===void 0&&(U=null),X===void 0&&(X=null),Y===void 0&&(Y=null);var z=M>G&&M<j&&N>V&&N<H,W=k>G&&k<j&&F>V&&F<H;if(z&&W)return-1;for(var Z=0,Q=I._computeOutCode(M,N,G,V,j,H),ee=I._computeOutCode(k,F,G,V,j,H);;){if((Q|ee)==0){Z=2;break}if((Q&ee)!=0)break;var te=0,re=0,ie=0,ne=Q!==0?Q:ee;(4&ne)!=0?(te=M+(k-M)*(V-N)/(F-N),re=V,Y!==null&&(ie=.5*-Math.PI)):(8&ne)!=0?(te=M+(k-M)*(H-N)/(F-N),re=H,Y!==null&&(ie=.5*Math.PI)):(2&ne)!=0?(re=N+(F-N)*(j-M)/(k-M),te=j,Y!==null&&(ie=0)):(1&ne)!=0&&(re=N+(F-N)*(G-M)/(k-M),te=G,Y!==null&&(ie=Math.PI)),ne===Q?(M=te,N=re,Q=I._computeOutCode(M,N,G,V,j,H),Y!==null&&(Y.x=ie)):(k=te,F=re,ee=I._computeOutCode(k,F,G,V,j,H),Y!==null&&(Y.y=ie))}return Z&&(z?(Z=2,U!==null&&(U.x=k,U.y=F),X!==null&&(X.x=k,X.y=k),Y!==null&&(Y.x=Y.y+Math.PI)):W?(Z=1,U!==null&&(U.x=M,U.y=N),X!==null&&(X.x=M,X.y=N),Y!==null&&(Y.y=Y.x+Math.PI)):(Z=3,U!==null&&(U.x=M,U.y=N),X!==null&&(X.x=k,X.y=F))),Z},I.prototype._onClear=function(){D.prototype._onClear.call(this),this.type=0},I.prototype.containsPoint=function(M,N){var k=.5*this.width;if(M>=-k&&M<=k){var F=.5*this.height;if(N>=-F&&N<=F)return!0}return!1},I.prototype.intersectsSegment=function(M,N,k,F,G,V,j){G===void 0&&(G=null),V===void 0&&(V=null),j===void 0&&(j=null);var H=.5*this.width,U=.5*this.height;return I.rectangleIntersectsSegment(M,N,k,F,-H,-U,H,U,G,V,j)},I}(O);A.RectangleBoundingBoxData=R;var P=function(D){function I(){return D!==null&&D.apply(this,arguments)||this}return B(I,D),I.toString=function(){return"[class dragonBones.EllipseData]"},I.ellipseIntersectsSegment=function(M,N,k,F,G,V,j,H,U,X,Y){U===void 0&&(U=null),X===void 0&&(X=null),Y===void 0&&(Y=null);var z=j/H,W=z*z,Z=k-M,Q=(F*=z)-(N*=z),ee=Math.sqrt(Z*Z+Q*Q),te=Z/ee,re=Q/ee,ie=(G-M)*te+(V-N)*re,ne=j*j,he=ne-(M*M+N*N)+ie*ie,pe=0;if(he>=0){var K=Math.sqrt(he),ue=ie-K,le=ie+K,ce=ue<0?-1:ue<=ee?0:1,_e=le<0?-1:le<=ee?0:1,oe=ce*_e;if(oe<0)return-1;oe===0&&(ce===-1?(pe=2,k=M+le*te,F=(N+le*re)/z,U!==null&&(U.x=k,U.y=F),X!==null&&(X.x=k,X.y=F),Y!==null&&(Y.x=Math.atan2(F/ne*W,k/ne),Y.y=Y.x+Math.PI)):_e===1?(pe=1,M+=ue*te,N=(N+ue*re)/z,U!==null&&(U.x=M,U.y=N),X!==null&&(X.x=M,X.y=N),Y!==null&&(Y.x=Math.atan2(N/ne*W,M/ne),Y.y=Y.x+Math.PI)):(pe=3,U!==null&&(U.x=M+ue*te,U.y=(N+ue*re)/z,Y!==null&&(Y.x=Math.atan2(U.y/ne*W,U.x/ne))),X!==null&&(X.x=M+le*te,X.y=(N+le*re)/z,Y!==null&&(Y.y=Math.atan2(X.y/ne*W,X.x/ne)))))}return pe},I.prototype._onClear=function(){D.prototype._onClear.call(this),this.type=1},I.prototype.containsPoint=function(M,N){var k=.5*this.width;if(M>=-k&&M<=k){var F=.5*this.height;if(N>=-F&&N<=F)return N*=k/F,Math.sqrt(M*M+N*N)<=k}return!1},I.prototype.intersectsSegment=function(M,N,k,F,G,V,j){return G===void 0&&(G=null),V===void 0&&(V=null),j===void 0&&(j=null),I.ellipseIntersectsSegment(M,N,k,F,0,0,.5*this.width,.5*this.height,G,V,j)},I}(O);A.EllipseBoundingBoxData=P;var E=function(D){function I(){var M=D!==null&&D.apply(this,arguments)||this;return M.vertices=[],M}return B(I,D),I.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"},I.polygonIntersectsSegment=function(M,N,k,F,G,V,j,H){V===void 0&&(V=null),j===void 0&&(j=null),H===void 0&&(H=null),M===k&&(M=k+1e-6),N===F&&(N=F+1e-6);for(var U=G.length,X=M-k,Y=N-F,z=M*F-N*k,W=0,Z=G[U-2],Q=G[U-1],ee=0,te=0,re=0,ie=0,ne=0,he=0,pe=0;pe<U;pe+=2){var K=G[pe],ue=G[pe+1];Z===K&&(Z=K+1e-4),Q===ue&&(Q=ue+1e-4);var le=Z-K,ce=Q-ue,_e=Z*ue-Q*K,oe=X*ce-Y*le,de=(z*le-X*_e)/oe;if((de>=Z&&de<=K||de>=K&&de<=Z)&&(X===0||de>=M&&de<=k||de>=k&&de<=M)){var me=(z*ce-Y*_e)/oe;if((me>=Q&&me<=ue||me>=ue&&me<=Q)&&(Y===0||me>=N&&me<=F||me>=F&&me<=N)){if(j===null){re=de,ie=me,ne=de,he=me,W++,H!==null&&(H.x=Math.atan2(ue-Q,K-Z)-.5*Math.PI,H.y=H.x);break}var ye=de-M;ye<0&&(ye=-ye),W===0?(ee=ye,te=ye,re=de,ie=me,ne=de,he=me,H!==null&&(H.x=Math.atan2(ue-Q,K-Z)-.5*Math.PI,H.y=H.x)):(ye<ee&&(ee=ye,re=de,ie=me,H!==null&&(H.x=Math.atan2(ue-Q,K-Z)-.5*Math.PI)),ye>te&&(te=ye,ne=de,he=me,H!==null&&(H.y=Math.atan2(ue-Q,K-Z)-.5*Math.PI))),W++}}Z=K,Q=ue}return W===1?(V!==null&&(V.x=re,V.y=ie),j!==null&&(j.x=re,j.y=ie),H!==null&&(H.y=H.x+Math.PI)):W>1&&(W++,V!==null&&(V.x=re,V.y=ie),j!==null&&(j.x=ne,j.y=he)),W},I.prototype._onClear=function(){D.prototype._onClear.call(this),this.type=2,this.x=0,this.y=0,this.vertices.length=0},I.prototype.containsPoint=function(M,N){var k=!1;if(M>=this.x&&M<=this.width&&N>=this.y&&N<=this.height)for(var F=0,G=this.vertices.length,V=G-2;F<G;F+=2){var j=this.vertices[V+1],H=this.vertices[F+1];if(H<N&&j>=N||j<N&&H>=N){var U=this.vertices[V],X=this.vertices[F];(N-H)*(U-X)/(j-H)+X<M&&(k=!k)}V=F}return k},I.prototype.intersectsSegment=function(M,N,k,F,G,V,j){G===void 0&&(G=null),V===void 0&&(V=null),j===void 0&&(j=null);var H=0;return R.rectangleIntersectsSegment(M,N,k,F,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)!==0&&(H=I.polygonIntersectsSegment(M,N,k,F,this.vertices,G,V,j)),H},I}(O);A.PolygonBoundingBoxData=E}(w||(w={})),function(A){var O=function(P){function E(){var D=P!==null&&P.apply(this,arguments)||this;return D.cachedFrames=[],D.boneTimelines={},D.surfaceTimelines={},D.slotTimelines={},D.constraintTimelines={},D.animationTimelines={},D.boneCachedFrameIndices={},D.slotCachedFrameIndices={},D.actionTimeline=null,D.zOrderTimeline=null,D}return B(E,P),E.toString=function(){return"[class dragonBones.AnimationData]"},E.prototype._onClear=function(){for(var D in this.boneTimelines){for(var I=0,M=this.boneTimelines[D];I<M.length;I++)M[I].returnToPool();delete this.boneTimelines[D]}for(var D in this.surfaceTimelines){for(var N=0,k=this.surfaceTimelines[D];N<k.length;N++)k[N].returnToPool();delete this.surfaceTimelines[D]}for(var D in this.slotTimelines){for(var F=0,G=this.slotTimelines[D];F<G.length;F++)G[F].returnToPool();delete this.slotTimelines[D]}for(var D in this.constraintTimelines){for(var V=0,j=this.constraintTimelines[D];V<j.length;V++)j[V].returnToPool();delete this.constraintTimelines[D]}for(var D in this.animationTimelines){for(var H=0,U=this.animationTimelines[D];H<U.length;H++)U[H].returnToPool();delete this.animationTimelines[D]}for(var D in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[D];for(var D in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[D];this.actionTimeline!==null&&this.actionTimeline.returnToPool(),this.zOrderTimeline!==null&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null},E.prototype.cacheFrames=function(D){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=Math.max(Math.ceil(D*this.scale),1);var I=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=I;for(var M=0,N=this.cacheFrames.length;M<N;++M)this.cachedFrames[M]=!1;for(var k=0,F=this.parent.sortedBones;k<F.length;k++){var G=F[k];for(M=0,N=(H=new Array(I)).length;M<N;++M)H[M]=-1;this.boneCachedFrameIndices[G.name]=H}for(var V=0,j=this.parent.sortedSlots;V<j.length;V++){var H,U=j[V];for(M=0,N=(H=new Array(I)).length;M<N;++M)H[M]=-1;this.slotCachedFrameIndices[U.name]=H}}},E.prototype.addBoneTimeline=function(D,I){var M=D.name in this.boneTimelines?this.boneTimelines[D.name]:this.boneTimelines[D.name]=[];M.indexOf(I)<0&&M.push(I)},E.prototype.addSurfaceTimeline=function(D,I){var M=D.name in this.surfaceTimelines?this.surfaceTimelines[D.name]:this.surfaceTimelines[D.name]=[];M.indexOf(I)<0&&M.push(I)},E.prototype.addSlotTimeline=function(D,I){var M=D.name in this.slotTimelines?this.slotTimelines[D.name]:this.slotTimelines[D.name]=[];M.indexOf(I)<0&&M.push(I)},E.prototype.addConstraintTimeline=function(D,I){var M=D.name in this.constraintTimelines?this.constraintTimelines[D.name]:this.constraintTimelines[D.name]=[];M.indexOf(I)<0&&M.push(I)},E.prototype.addAnimationTimeline=function(D,I){var M=D in this.animationTimelines?this.animationTimelines[D]:this.animationTimelines[D]=[];M.indexOf(I)<0&&M.push(I)},E.prototype.getBoneTimelines=function(D){return D in this.boneTimelines?this.boneTimelines[D]:null},E.prototype.getSurfaceTimelines=function(D){return D in this.surfaceTimelines?this.surfaceTimelines[D]:null},E.prototype.getSlotTimelines=function(D){return D in this.slotTimelines?this.slotTimelines[D]:null},E.prototype.getConstraintTimelines=function(D){return D in this.constraintTimelines?this.constraintTimelines[D]:null},E.prototype.getAnimationTimelines=function(D){return D in this.animationTimelines?this.animationTimelines[D]:null},E.prototype.getBoneCachedFrameIndices=function(D){return D in this.boneCachedFrameIndices?this.boneCachedFrameIndices[D]:null},E.prototype.getSlotCachedFrameIndices=function(D){return D in this.slotCachedFrameIndices?this.slotCachedFrameIndices[D]:null},E}(A.BaseObject);A.AnimationData=O;var R=function(P){function E(){return P!==null&&P.apply(this,arguments)||this}return B(E,P),E.toString=function(){return"[class dragonBones.TimelineData]"},E.prototype._onClear=function(){this.type=10,this.offset=0,this.frameIndicesOffset=-1},E}(A.BaseObject);A.TimelineData=R}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E.boneMask=[],E}return B(P,R),P.toString=function(){return"[class dragonBones.AnimationConfig]"},P.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additiveBlending=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0},P.prototype.clear=function(){this._onClear()},P.prototype.copyFrom=function(E){this.pauseFadeOut=E.pauseFadeOut,this.fadeOutMode=E.fadeOutMode,this.autoFadeOutTime=E.autoFadeOutTime,this.fadeOutTweenType=E.fadeOutTweenType,this.actionEnabled=E.actionEnabled,this.additiveBlending=E.additiveBlending,this.displayControl=E.displayControl,this.pauseFadeIn=E.pauseFadeIn,this.resetToPose=E.resetToPose,this.playTimes=E.playTimes,this.layer=E.layer,this.position=E.position,this.duration=E.duration,this.timeScale=E.timeScale,this.fadeInTime=E.fadeInTime,this.fadeOutTime=E.fadeOutTime,this.fadeInTweenType=E.fadeInTweenType,this.weight=E.weight,this.name=E.name,this.animation=E.animation,this.group=E.group,this.boneMask.length=E.boneMask.length;for(var D=0,I=this.boneMask.length;D<I;++D)this.boneMask[D]=E.boneMask[D]},P.prototype.containsBoneMask=function(E){return this.boneMask.length===0||this.boneMask.indexOf(E)>=0},P.prototype.addBoneMask=function(E,D,I){I===void 0&&(I=!0);var M=E.getBone(D);if(M!==null&&(this.boneMask.indexOf(D)<0&&this.boneMask.push(D),I))for(var N=0,k=E.getBones();N<k.length;N++){var F=k[N];this.boneMask.indexOf(F.name)<0&&M.contains(F)&&this.boneMask.push(F.name)}},P.prototype.removeBoneMask=function(E,D,I){I===void 0&&(I=!0);var M=this.boneMask.indexOf(D);if(M>=0&&this.boneMask.splice(M,1),I){var N=E.getBone(D);if(N!==null)if(this.boneMask.length>0)for(var k=0,F=E.getBones();k<F.length;k++){var G=F[k],V=this.boneMask.indexOf(G.name);V>=0&&N.contains(G)&&this.boneMask.splice(V,1)}else for(var j=0,H=E.getBones();j<H.length;j++)(G=H[j])!==N&&(N.contains(G)||this.boneMask.push(G.name))}},P}(A.BaseObject);A.AnimationConfig=O}(w||(w={})),function(A){var O=function(P){function E(){var D=P!==null&&P.apply(this,arguments)||this;return D.textures={},D}return B(E,P),E.prototype._onClear=function(){for(var D in this.textures)this.textures[D].returnToPool(),delete this.textures[D];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""},E.prototype.copyFrom=function(D){for(var I in this.autoSearch=D.autoSearch,this.scale=D.scale,this.width=D.width,this.height=D.height,this.name=D.name,this.imagePath=D.imagePath,this.textures)this.textures[I].returnToPool(),delete this.textures[I];for(var I in D.textures){var M=this.createTexture();M.copyFrom(D.textures[I]),this.textures[I]=M}},E.prototype.addTexture=function(D){D.name in this.textures?console.warn("Same texture: "+D.name):(D.parent=this,this.textures[D.name]=D)},E.prototype.getTexture=function(D){return D in this.textures?this.textures[D]:null},E}(A.BaseObject);A.TextureAtlasData=O;var R=function(P){function E(){var D=P!==null&&P.apply(this,arguments)||this;return D.region=new A.Rectangle,D.frame=null,D}return B(E,P),E.createRectangle=function(){return new A.Rectangle},E.prototype._onClear=function(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null},E.prototype.copyFrom=function(D){this.rotated=D.rotated,this.name=D.name,this.region.copyFrom(D.region),this.parent=D.parent,this.frame===null&&D.frame!==null?this.frame=E.createRectangle():this.frame!==null&&D.frame===null&&(this.frame=null),this.frame!==null&&D.frame!==null&&this.frame.copyFrom(D.frame)},E}(A.BaseObject);A.TextureData=R}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E.vertices=[],E.bones=[],E}return B(P,R),P.toString=function(){return"[class dragonBones.DeformVertices]"},P.prototype._onClear=function(){this.verticesDirty=!1,this.vertices.length=0,this.bones.length=0,this.verticesData=null},P.prototype.init=function(E,D){if(this.verticesData=E,this.verticesData!==null){var I;I=this.verticesData.weight!==null?2*this.verticesData.weight.count:2*this.verticesData.data.intArray[this.verticesData.offset+0],this.verticesDirty=!0,this.vertices.length=I,this.bones.length=0;for(var M=0,N=this.vertices.length;M<N;++M)this.vertices[M]=0;if(this.verticesData.weight!==null)for(M=0,N=this.verticesData.weight.bones.length;M<N;++M){var k=D.getBone(this.verticesData.weight.bones[M].name);this.bones.push(k)}}else this.verticesDirty=!1,this.vertices.length=0,this.bones.length=0,this.verticesData=null},P.prototype.isBonesUpdate=function(){for(var E=0,D=this.bones;E<D.length;E++){var I=D[E];if(I!==null&&I._childrenTransformDirty)return!0}return!1},P}(A.BaseObject);A.DeformVertices=O}(w||(w={})),_=function(A){function O(){var R=A!==null&&A.apply(this,arguments)||this;return R._bones=[],R._slots=[],R._constraints=[],R._actions=[],R._animation=null,R._proxy=null,R._replaceTextureAtlasData=null,R._clock=null,R}return B(O,A),O.toString=function(){return"[class dragonBones.Armature]"},O._onSortSlots=function(R,P){return R._zOrder>P._zOrder?1:-1},O.prototype._onClear=function(){this._clock!==null&&this._clock.remove(this);for(var R=0,P=this._bones;R<P.length;R++)P[R].returnToPool();for(var E=0,D=this._slots;E<D.length;E++)D[E].returnToPool();for(var I=0,M=this._constraints;I<M.length;I++)M[I].returnToPool();for(var N=0,k=this._actions;N<k.length;N++)k[N].returnToPool();this._animation!==null&&this._animation.returnToPool(),this._proxy!==null&&this._proxy.dbClear(),this._replaceTextureAtlasData!==null&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null},O.prototype._sortZOrder=function(R,P){var E=this._armatureData.sortedSlots,D=R===null;if(this._zOrderDirty||!D){for(var I=0,M=E.length;I<M;++I){var N=D?I:R[P+I];if(!(N<0||N>=M)){var k=E[N],F=this.getSlot(k.name);F!==null&&F._setZorder(I)}}this._slotsDirty=!0,this._zOrderDirty=!D}},O.prototype._addBone=function(R){this._bones.indexOf(R)<0&&this._bones.push(R)},O.prototype._addSlot=function(R){this._slots.indexOf(R)<0&&this._slots.push(R)},O.prototype._addConstraint=function(R){this._constraints.indexOf(R)<0&&this._constraints.push(R)},O.prototype._bufferAction=function(R,P){this._actions.indexOf(R)<0&&(P?this._actions.push(R):this._actions.unshift(R))},O.prototype.dispose=function(){this._armatureData!==null&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))},O.prototype.init=function(R,P,E,D){this._armatureData===null&&(this._armatureData=R,this._animation=T.BaseObject.borrowObject(T.Animation),this._proxy=P,this._display=E,this._dragonBones=D,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)},O.prototype.advanceTime=function(R){if(!this._lockUpdate)if(this._armatureData!==null)if(this._armatureData.parent!==null){var P=this._cacheFrameIndex;if(this._animation.advanceTime(R),this._slotsDirty&&(this._slotsDirty=!1,this._slots.sort(O._onSortSlots)),this._cacheFrameIndex<0||this._cacheFrameIndex!==P){var E=0,D=0;for(E=0,D=this._bones.length;E<D;++E)this._bones[E].update(this._cacheFrameIndex);for(E=0,D=this._slots.length;E<D;++E)this._slots[E].update(this._cacheFrameIndex)}if(this._actions.length>0){this._lockUpdate=!0;for(var I=0,M=this._actions;I<M.length;I++){var N=M[I],k=N.actionData;if(k!==null&&k.type===0)if(N.slot!==null)(V=N.slot.childArmature)!==null&&V.animation.fadeIn(k.name);else if(N.bone!==null)for(var F=0,G=this.getSlots();F<G.length;F++){var V,j=G[F];j.parent===N.bone&&(V=j.childArmature)!==null&&V.animation.fadeIn(k.name)}else this._animation.fadeIn(k.name);N.returnToPool()}this._actions.length=0,this._lockUpdate=!1}this._proxy.dbUpdate()}else console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");else console.warn("The armature has been disposed.")},O.prototype.invalidUpdate=function(R,P){if(R===void 0&&(R=null),P===void 0&&(P=!1),R!==null&&R.length>0){if((N=this.getBone(R))!==null&&(N.invalidUpdate(),P))for(var E=0,D=this._slots;E<D.length;E++)(G=D[E]).parent===N&&G.invalidUpdate()}else{for(var I=0,M=this._bones;I<M.length;I++){var N;(N=M[I]).invalidUpdate()}if(P)for(var k=0,F=this._slots;k<F.length;k++){var G;(G=F[k]).invalidUpdate()}}},O.prototype.containsPoint=function(R,P){for(var E=0,D=this._slots;E<D.length;E++){var I=D[E];if(I.containsPoint(R,P))return I}return null},O.prototype.intersectsSegment=function(R,P,E,D,I,M,N){I===void 0&&(I=null),M===void 0&&(M=null),N===void 0&&(N=null);for(var k=R===E,F=0,G=0,V=0,j=0,H=0,U=0,X=0,Y=0,z=null,W=null,Z=0,Q=this._slots;Z<Q.length;Z++){var ee=Q[Z];if(ee.intersectsSegment(R,P,E,D,I,M,N)>0){if(I===null&&M===null){z=ee;break}var te;I!==null&&((te=k?I.y-P:I.x-R)<0&&(te=-te),(z===null||te<F)&&(F=te,V=I.x,j=I.y,z=ee,N&&(X=N.x))),M!==null&&((te=M.x-R)<0&&(te=-te),(W===null||te>G)&&(G=te,H=M.x,U=M.y,W=ee,N!==null&&(Y=N.y)))}}return z!==null&&I!==null&&(I.x=V,I.y=j,N!==null&&(N.x=X)),W!==null&&M!==null&&(M.x=H,M.y=U,N!==null&&(N.y=Y)),z},O.prototype.getBone=function(R){for(var P=0,E=this._bones;P<E.length;P++){var D=E[P];if(D.name===R)return D}return null},O.prototype.getBoneByDisplay=function(R){var P=this.getSlotByDisplay(R);return P!==null?P.parent:null},O.prototype.getSlot=function(R){for(var P=0,E=this._slots;P<E.length;P++){var D=E[P];if(D.name===R)return D}return null},O.prototype.getSlotByDisplay=function(R){if(R!==null)for(var P=0,E=this._slots;P<E.length;P++){var D=E[P];if(D.display===R)return D}return null},O.prototype.getBones=function(){return this._bones},O.prototype.getSlots=function(){return this._slots},Object.defineProperty(O.prototype,"flipX",{get:function(){return this._flipX},set:function(R){this._flipX!==R&&(this._flipX=R,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"flipY",{get:function(){return this._flipY},set:function(R){this._flipY!==R&&(this._flipY=R,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(R){if(this._armatureData.cacheFrameRate!==R){this._armatureData.cacheFrames(R);for(var P=0,E=this._slots;P<E.length;P++){var D=E[P].childArmature;D!==null&&(D.cacheFrameRate=R)}}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"name",{get:function(){return this._armatureData.name},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(R){if(this._replacedTexture!==R){this._replaceTextureAtlasData!==null&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=R;for(var P=0,E=this._slots;P<E.length;P++){var D=E[P];D.invalidUpdate(),D.update(-1)}}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"clock",{get:function(){return this._clock},set:function(R){if(this._clock!==R){this._clock!==null&&this._clock.remove(this),this._clock=R,this._clock&&this._clock.add(this);for(var P=0,E=this._slots;P<E.length;P++){var D=E[P].childArmature;D!==null&&(D.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),O.prototype.replaceTexture=function(R){this.replacedTexture=R},O.prototype.hasEventListener=function(R){return this._proxy.hasDBEventListener(R)},O.prototype.addEventListener=function(R,P,E){this._proxy.addDBEventListener(R,P,E)},O.prototype.removeEventListener=function(R,P,E){this._proxy.removeDBEventListener(R,P,E)},O.prototype.enableAnimationCache=function(R){console.warn("Deprecated."),this.cacheFrameRate=R},O.prototype.getDisplay=function(){return this._display},O}((T=w||(w={})).BaseObject),T.Armature=_,function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E.globalTransformMatrix=new A.Matrix,E.global=new A.Transform,E.offset=new A.Transform,E}return B(P,R),P.prototype._onClear=function(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._armature=null},P.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(P.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),P._helpMatrix=new A.Matrix,P._helpTransform=new A.Transform,P._helpPoint=new A.Point,P}(A.BaseObject);A.TransformObject=O}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E.animationPose=new A.Transform,E._blendState=new A.BlendState,E}return B(P,R),P.toString=function(){return"[class dragonBones.Bone]"},P.prototype._onClear=function(){R.prototype._onClear.call(this),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._blendState.clear(),this._boneData=null,this._parent=null,this._cachedFrameIndices=null},P.prototype._updateGlobalTransformMatrix=function(E){var D=this._boneData,I=this.global,M=this.globalTransformMatrix,N=this.origin,k=this.offset,F=this.animationPose,G=this._parent,V=this._armature.flipX,j=this._armature.flipY===A.DragonBones.yDown,H=G!==null,U=0;if(this.offsetMode===1?N!==null?(I.x=N.x+k.x+F.x,I.scaleX=N.scaleX*k.scaleX*F.scaleX,I.scaleY=N.scaleY*k.scaleY*F.scaleY,A.DragonBones.yDown?(I.y=N.y+k.y+F.y,I.skew=N.skew+k.skew+F.skew,I.rotation=N.rotation+k.rotation+F.rotation):(I.y=N.y-k.y+F.y,I.skew=N.skew-k.skew+F.skew,I.rotation=N.rotation-k.rotation+F.rotation)):(I.copyFrom(k),A.DragonBones.yDown||(I.y=-I.y,I.skew=-I.skew,I.rotation=-I.rotation),I.add(F)):this.offsetMode===0?N!==null?I.copyFrom(N).add(F):I.copyFrom(F):(H=!1,I.copyFrom(k),A.DragonBones.yDown||(I.y=-I.y,I.skew=-I.skew,I.rotation=-I.rotation)),H){var X=G._boneData.type===0?G.globalTransformMatrix:G._getGlobalTransformMatrix(I.x,I.y);if(D.inheritScale)D.inheritRotation||(G.updateGlobalTransform(),U=V&&j?I.rotation-(G.global.rotation+Math.PI):V?I.rotation+G.global.rotation+Math.PI:j?I.rotation+G.global.rotation:I.rotation-G.global.rotation,I.rotation=U),I.toMatrix(M),M.concat(X),D.inheritTranslation?(I.x=M.tx,I.y=M.ty):(M.tx=I.x,M.ty=I.y),E?I.fromMatrix(M):this._globalDirty=!0;else{if(D.inheritTranslation){var Y=I.x,z=I.y;I.x=X.a*Y+X.c*z+X.tx,I.y=X.b*Y+X.d*z+X.ty}else V&&(I.x=-I.x),j&&(I.y=-I.y);D.inheritRotation?(G.updateGlobalTransform(),U=G.global.scaleX<0?I.rotation+G.global.rotation+Math.PI:I.rotation+G.global.rotation,X.a*X.d-X.b*X.c<0&&(U-=2*I.rotation,(V!==j||D.inheritReflection)&&(I.skew+=Math.PI),A.DragonBones.yDown||(I.skew=-I.skew)),I.rotation=U):(V||j)&&(V&&j?U=I.rotation+Math.PI:(U=V?Math.PI-I.rotation:-I.rotation,I.skew+=Math.PI),I.rotation=U),I.toMatrix(M)}}else(V||j)&&(V&&(I.x=-I.x),j&&(I.y=-I.y),V&&j?U=I.rotation+Math.PI:(U=V?Math.PI-I.rotation:-I.rotation,I.skew+=Math.PI),I.rotation=U),I.toMatrix(M)},P.prototype.init=function(E,D){this._boneData===null&&(this._boneData=E,this._armature=D,this._boneData.parent!==null&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)},P.prototype.update=function(E){if(this._blendState.dirty=!1,E>=0&&this._cachedFrameIndices!==null){var D=this._cachedFrameIndices[E];if(D>=0&&this._cachedFrameIndex===D)this._transformDirty=!1;else if(D>=0)this._transformDirty=!0,this._cachedFrameIndex=D;else{if(this._hasConstraint)for(var I=0,M=this._armature._constraints;I<M.length;I++)(F=M[I])._root===this&&F.update();this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[E]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var N=0,k=this._armature._constraints;N<k.length;N++){var F;(F=k[N])._root===this&&F.update()}(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&(E=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var G=E>=0;this._localDirty&&this._updateGlobalTransformMatrix(G),G&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[E]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},P.prototype.updateByConstraint=function(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)},P.prototype.invalidUpdate=function(){this._transformDirty=!0},P.prototype.contains=function(E){if(E===this)return!1;for(var D=E;D!==this&&D!==null;)D=D.parent;return D===this},Object.defineProperty(P.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"visible",{get:function(){return this._visible},set:function(E){if(this._visible!==E){this._visible=E;for(var D=0,I=this._armature.getSlots();D<I.length;D++){var M=I[D];M.parent===this&&M._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"name",{get:function(){return this._boneData.name},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),P.prototype.getBones=function(){console.warn("Deprecated.");for(var E=new Array,D=0,I=this._armature.getBones();D<I.length;D++){var M=I[D];M.parent===this&&E.push(M)}return E},P.prototype.getSlots=function(){console.warn("Deprecated.");for(var E=new Array,D=0,I=this._armature.getSlots();D<I.length;D++){var M=I[D];M.parent===this&&E.push(M)}return E},Object.defineProperty(P.prototype,"slot",{get:function(){console.warn("Deprecated.");for(var E=0,D=this._armature.getSlots();E<D.length;E++){var I=D[E];if(I.parent===this)return I}return null},enumerable:!0,configurable:!0}),P}(A.TransformObject);A.Bone=O}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E._vertices=[],E._deformVertices=[],E._hullCache=[],E._matrixCahce=[],E}return B(P,R),P.toString=function(){return"[class dragonBones.Surface]"},P.prototype._onClear=function(){R.prototype._onClear.call(this),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0},P.prototype._getAffineTransform=function(E,D,I,M,N,k,F,G,V,j,H,U,X){var Y=F-N,z=G-k,W=V-N,Z=j-k;H.rotation=Math.atan2(z,Y),H.skew=Math.atan2(Z,W)-.5*Math.PI-H.rotation,X&&(H.rotation+=Math.PI),H.scaleX=Math.sqrt(Y*Y+z*z)/I,H.scaleY=Math.sqrt(W*W+Z*Z)/M,H.toMatrix(U),H.x=U.tx=N-(U.a*E+U.c*D),H.y=U.ty=k-(U.b*E+U.d*D)},P.prototype._updateVertices=function(){var E=this._boneData.vertices,D=this._vertices,I=this._deformVertices;if(this._parent!==null)if(this._parent._boneData.type===1)for(var M=0,N=E.length;M<N;M+=2){var k=E[M]+I[M],F=E[M+1]+I[M],G=this._parent._getGlobalTransformMatrix(k,F);D[M]=G.a*k+G.c*F+G.tx,D[M+1]=G.b*k+G.d*F+G.ty}else{var V=this._parent.globalTransformMatrix;for(M=0,N=E.length;M<N;M+=2)k=E[M]+I[M],F=E[M+1]+I[M+1],D[M]=V.a*k+V.c*F+V.tx,D[M+1]=V.b*k+V.d*F+V.ty}else for(M=0,N=E.length;M<N;M+=2)D[M]=E[M]+I[M],D[M+1]=E[M+1]+I[M+1]},P.prototype._updateGlobalTransformMatrix=function(){var E=2*this._boneData.segmentX,D=this._vertices.length-2,I=this._vertices[0],M=this._vertices[1],N=this._vertices[E],k=this._vertices[E+1],F=this._vertices[D],G=this._vertices[D+1],V=this._vertices[D-E],j=this._vertices[D-E+1],H=I+.5*(F-I),U=M+.5*(G-M),X=H+.5*(N+.5*(V-N)-H),Y=U+.5*(k+.5*(j-k)-U),z=N+.5*(F-N),W=k+.5*(G-k),Z=V+.5*(F-V),Q=j+.5*(G-j);this._globalDirty=!1,this._getAffineTransform(0,0,200,200,X,Y,z,W,Z,Q,this.global,this.globalTransformMatrix,!1)},P.prototype._getGlobalTransformMatrix=function(E,D){var I=1e3;if(E<-I||I<E||D<-I||I<D)return this.globalTransformMatrix;var M=!1,N=200,k=this._boneData,F=k.segmentX,G=k.segmentY,V=2*k.segmentX,j=this._dX,H=this._dY,U=Math.floor((E+N)/j),X=Math.floor((D+N)/H),Y=0,z=U*j-N,W=X*H-N,Z=this._matrixCahce,Q=P._helpMatrix;if(E<-N){if(D<-N||D>=N)return this.globalTransformMatrix;if(Y=7*(2*(F*(G+1)+2*F+G+X)+((M=D>this._kX*(E+N)+W)?1:0)),this._matrixCahce[Y]>0)Q.copyFromArray(Z,Y+1);else{var ee=X*(V+2),te=this._hullCache[4],re=this._hullCache[5],ie=this._hullCache[2]-(G-X)*te,ne=this._hullCache[3]-(G-X)*re,he=this._vertices;M?this._getAffineTransform(-N,W+H,800,H,he[ee+V+2],he[ee+V+3],ie+te,ne+re,he[ee],he[ee+1],P._helpTransform,Q,!0):this._getAffineTransform(-I,W,800,H,ie,ne,he[ee],he[ee+1],ie+te,ne+re,P._helpTransform,Q,!1),Z[Y]=1,Z[Y+1]=Q.a,Z[Y+2]=Q.b,Z[Y+3]=Q.c,Z[Y+4]=Q.d,Z[Y+5]=Q.tx,Z[Y+6]=Q.ty}}else if(E>=N){if(D<-N||D>=N)return this.globalTransformMatrix;Y=7*(2*(F*(G+1)+F+X)+((M=D>this._kX*(E-I)+W)?1:0)),this._matrixCahce[Y]>0?Q.copyFromArray(Z,Y+1):(ee=(X+1)*(V+2)-2,te=this._hullCache[4],re=this._hullCache[5],ie=this._hullCache[0]+X*te,ne=this._hullCache[1]+X*re,he=this._vertices,M?this._getAffineTransform(I,W+H,800,H,ie+te,ne+re,he[ee+V+2],he[ee+V+3],ie,ne,P._helpTransform,Q,!0):this._getAffineTransform(N,W,800,H,he[ee],he[ee+1],ie,ne,he[ee+V+2],he[ee+V+3],P._helpTransform,Q,!1),Z[Y]=1,Z[Y+1]=Q.a,Z[Y+2]=Q.b,Z[Y+3]=Q.c,Z[Y+4]=Q.d,Z[Y+5]=Q.tx,Z[Y+6]=Q.ty)}else if(D<-N){if(E<-N||E>=N)return this.globalTransformMatrix;Y=7*(F*(G+1)+2*U+((M=D>this._kY*(E-z-j)-I)?1:0)),this._matrixCahce[Y]>0?Q.copyFromArray(Z,Y+1):(ee=2*U,te=this._hullCache[10],re=this._hullCache[11],ie=this._hullCache[8]+U*te,ne=this._hullCache[9]+U*re,he=this._vertices,M?this._getAffineTransform(z+j,-N,j,800,he[ee+2],he[ee+3],he[ee],he[ee+1],ie+te,ne+re,P._helpTransform,Q,!0):this._getAffineTransform(z,-I,j,800,ie,ne,ie+te,ne+re,he[ee],he[ee+1],P._helpTransform,Q,!1),Z[Y]=1,Z[Y+1]=Q.a,Z[Y+2]=Q.b,Z[Y+3]=Q.c,Z[Y+4]=Q.d,Z[Y+5]=Q.tx,Z[Y+6]=Q.ty)}else if(D>=N){if(E<-N||E>=N)return this.globalTransformMatrix;Y=7*(2*(F*(G+1)+F+G+X)+((M=D>this._kY*(E-z-j)+N)?1:0)),this._matrixCahce[Y]>0?Q.copyFromArray(Z,Y+1):(ee=G*(V+2)+2*U,te=this._hullCache[10],re=this._hullCache[11],ie=this._hullCache[6]-(F-U)*te,ne=this._hullCache[7]-(F-U)*re,he=this._vertices,M?this._getAffineTransform(z+j,I,j,800,ie+te,ne+re,ie,ne,he[ee+2],he[ee+3],P._helpTransform,Q,!0):this._getAffineTransform(z,N,j,800,he[ee],he[ee+1],he[ee+2],he[ee+3],ie,ne,P._helpTransform,Q,!1),Z[Y]=1,Z[Y+1]=Q.a,Z[Y+2]=Q.b,Z[Y+3]=Q.c,Z[Y+4]=Q.d,Z[Y+5]=Q.tx,Z[Y+6]=Q.ty)}else Y=7*(2*(F*X+U)+((M=D>this._k*(E-z-j)+W)?1:0)),this._matrixCahce[Y]>0?Q.copyFromArray(Z,Y+1):(ee=2*U+X*(V+2),he=this._vertices,M?this._getAffineTransform(z+j,W+H,j,H,he[ee+V+4],he[ee+V+5],he[ee+V+2],he[ee+V+3],he[ee+2],he[ee+3],P._helpTransform,Q,!0):this._getAffineTransform(z,W,j,H,he[ee],he[ee+1],he[ee+2],he[ee+3],he[ee+V+2],he[ee+V+3],P._helpTransform,Q,!1),Z[Y]=1,Z[Y+1]=Q.a,Z[Y+2]=Q.b,Z[Y+3]=Q.c,Z[Y+4]=Q.d,Z[Y+5]=Q.tx,Z[Y+6]=Q.ty);return Q},P.prototype.init=function(E,D){if(this._boneData===null){R.prototype.init.call(this,E,D);var I=E.segmentX,M=E.segmentY,N=E.vertices.length;this._dX=400/I,this._dY=400/M,this._k=-this._dY/this._dX,this._kX=-this._dY/800,this._kY=-800/this._dX,this._vertices.length=N,this._deformVertices.length=N,this._matrixCahce.length=14*(I*M+2*I+2*M),this._hullCache.length=10;for(var k=0;k<N;++k)this._deformVertices[k]=0}},P.prototype.update=function(E){if(this._blendState.dirty=!1,E>=0&&this._cachedFrameIndices!==null){var D=this._cachedFrameIndices[E];if(D>=0&&this._cachedFrameIndex===D)this._transformDirty=!1;else if(D>=0)this._transformDirty=!0,this._cachedFrameIndex=D;else{if(this._hasConstraint)for(var I=0,M=this._armature._constraints;I<M.length;I++)(F=M[I])._root===this&&F.update();this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[E]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var N=0,k=this._armature._constraints;N<k.length;N++){var F;(F=k[N])._root===this&&F.update()}(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&(E=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(var G=0,V=this._matrixCahce.length;G<V;G+=7)this._matrixCahce[G]=-1;if(this._updateVertices(),this._cachedFrameIndex<0){var j=E>=0;this._localDirty&&this._updateGlobalTransformMatrix(j),j&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[E]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);var H=2*this.global.x,U=2*this.global.y,X=P._helpPoint;this.globalTransformMatrix.transformPoint(1e3,-200,X),this._hullCache[0]=X.x,this._hullCache[1]=X.y,this._hullCache[2]=H-X.x,this._hullCache[3]=U-X.y,this.globalTransformMatrix.transformPoint(0,this._dY,X,!0),this._hullCache[4]=X.x,this._hullCache[5]=X.y,this.globalTransformMatrix.transformPoint(200,1e3,X),this._hullCache[6]=X.x,this._hullCache[7]=X.y,this._hullCache[8]=H-X.x,this._hullCache[9]=U-X.y,this.globalTransformMatrix.transformPoint(this._dX,0,X,!0),this._hullCache[10]=X.x,this._hullCache[11]=X.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},P}(A.Bone);A.Surface=O}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E._localMatrix=new A.Matrix,E._colorTransform=new A.ColorTransform,E._displayDatas=[],E._displayList=[],E._deformVertices=null,E._rawDisplay=null,E._meshDisplay=null,E}return B(P,R),P.prototype._onClear=function(){R.prototype._onClear.call(this);for(var E=[],D=0,I=this._displayList;D<I.length;D++)(k=I[D])!==null&&k!==this._rawDisplay&&k!==this._meshDisplay&&E.indexOf(k)<0&&E.push(k);for(var M=0,N=E;M<N.length;M++){var k;(k=N[M])instanceof A.Armature?k.dispose():this._disposeDisplay(k,!0)}this._deformVertices!==null&&this._deformVertices.returnToPool(),this._meshDisplay!==null&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),this._rawDisplay!==null&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDirty=!1,this._zOrderDirty=!1,this._blendModeDirty=!1,this._colorDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayList.length=0,this._displayDatas.length=0,this._slotData=null,this._rawDisplayDatas=null,this._displayData=null,this._boundingBoxData=null,this._textureData=null,this._deformVertices=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null},P.prototype._getDefaultRawDisplayData=function(E){var D=this._armature._armatureData.defaultSkin;if(D!==null){var I=D.getDisplays(this._slotData.name);if(I!==null)return E<I.length?I[E]:null}return null},P.prototype._updateDisplayData=function(){var E=this._displayData,D=this._deformVertices!==null?this._deformVertices.verticesData:null,I=this._textureData,M=null,N=null;if(this._displayData=null,this._boundingBoxData=null,this._textureData=null,this._displayIndex>=0&&(this._rawDisplayDatas!==null&&(M=this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null),M===null&&(M=this._getDefaultRawDisplayData(this._displayIndex)),this._displayIndex<this._displayDatas.length&&(this._displayData=this._displayDatas[this._displayIndex])),this._displayData!==null&&(this._displayData.type===2?N=this._displayData.vertices:this._displayData.type===4?N=this._displayData.vertices:M!==null&&(M.type===2||M.type===4)&&(N=M.vertices),this._displayData.type===3?this._boundingBoxData=this._displayData.boundingBox:M!==null&&M.type===3&&(this._boundingBoxData=M.boundingBox),this._displayData.type===0?this._textureData=this._displayData.texture:this._displayData.type===2&&(this._textureData=this._displayData.texture)),this._displayData!==E||N!==D||this._textureData!==I){if(N===null&&this._textureData!==null){var k=this._displayData,F=this._textureData.parent.scale*this._armature._armatureData.scale,G=this._textureData.frame;this._pivotX=k.pivot.x,this._pivotY=k.pivot.y;var V=G!==null?G:this._textureData.region,j=V.width,H=V.height;this._textureData.rotated&&G===null&&(j=V.height,H=V.width),this._pivotX*=j*F,this._pivotY*=H*F,G!==null&&(this._pivotX+=G.x*F,this._pivotY+=G.y*F),this._displayData!==null&&M!==null&&this._displayData!==M&&(M.transform.toMatrix(P._helpMatrix),P._helpMatrix.invert(),P._helpMatrix.transformPoint(0,0,P._helpPoint),this._pivotX-=P._helpPoint.x,this._pivotY-=P._helpPoint.y,this._displayData.transform.toMatrix(P._helpMatrix),P._helpMatrix.invert(),P._helpMatrix.transformPoint(0,0,P._helpPoint),this._pivotX+=P._helpPoint.x,this._pivotY+=P._helpPoint.y),A.DragonBones.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*F-this._pivotY)}else this._pivotX=0,this._pivotY=0;M!==null?this.origin=M.transform:this._displayData!==null?this.origin=this._displayData.transform:this.origin=null,N!==D?(this._deformVertices===null&&(this._deformVertices=A.BaseObject.borrowObject(A.DeformVertices)),this._deformVertices.init(N,this._armature)):this._deformVertices!==null&&this._textureData!==I&&(this._deformVertices.verticesDirty=!0),this._displayDirty=!0,this._transformDirty=!0}},P.prototype._updateDisplay=function(){var E=this._display!==null?this._display:this._rawDisplay,D=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],this._display!==null&&this._display instanceof A.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null);var I=this._display!==null?this._display:this._rawDisplay;if(I!==E&&(this._onUpdateDisplay(),this._replaceDisplay(E),this._transformDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0),I!==this._rawDisplay&&I!==this._meshDisplay||this._updateFrame(),this._childArmature!==D&&(D!==null&&(D._parent=null,D.clock=null,D.inheritAnimation&&D.animation.reset()),this._childArmature!==null&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(this._childArmature.cacheFrameRate===0){var M=this._armature.cacheFrameRate;M!==0&&(this._childArmature.cacheFrameRate=M)}var N=null;if(this._displayData!==null&&this._displayData.type===1)N=this._displayData.actions;else if(this._displayIndex>=0&&this._rawDisplayDatas!==null){var k=this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null;k===null&&(k=this._getDefaultRawDisplayData(this._displayIndex)),k!==null&&k.type===1&&(N=k.actions)}if(N!==null&&N.length>0)for(var F=0,G=N;F<G.length;F++){var V=G[F],j=A.BaseObject.borrowObject(A.EventObject);A.EventObject.actionDataToInstance(V,j,this._armature),j.slot=this,this._armature._bufferAction(j,!1)}else this._childArmature.animation.play()}},P.prototype._updateGlobalTransformMatrix=function(E){var D=this._parent._boneData.type===0?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(D),E?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},P.prototype._setDisplayIndex=function(E,D){if(D===void 0&&(D=!1),D){if(this._animationDisplayIndex===E)return!1;this._animationDisplayIndex=E}return this._displayIndex!==E&&(this._displayIndex=E,this._displayDirty=!0,this._updateDisplayData(),this._displayDirty)},P.prototype._setZorder=function(E){return this._zOrder,this._zOrder=E,this._zOrderDirty=!0,this._zOrderDirty},P.prototype._setColor=function(E){return this._colorTransform.copyFrom(E),this._colorDirty=!0,this._colorDirty},P.prototype._setDisplayList=function(E){if(E!==null&&E.length>0){this._displayList.length!==E.length&&(this._displayList.length=E.length);for(var D=0,I=E.length;D<I;++D){var M=E[D];M!==null&&M!==this._rawDisplay&&M!==this._meshDisplay&&!(M instanceof A.Armature)&&this._displayList.indexOf(M)<0&&this._initDisplay(M,!0),this._displayList[D]=M}}else this._displayList.length>0&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!==this._displayList[this._displayIndex]:this._displayDirty=this._display!==null,this._updateDisplayData(),this._displayDirty},P.prototype.init=function(E,D,I,M){if(this._slotData===null){this._slotData=E,this._isFromCache=!1,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=I,this._meshDisplay=M,this._armature=D;var N=this._armature.getBone(this._slotData.parent.name);N!==null&&(this._parent=N),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay()}},P.prototype.update=function(E){if(this._isFromCache=!1,this._displayDirty&&(this._displayDirty=!1,this._updateDisplay(),this._transformDirty&&(this.origin!==null?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix))),this._zOrderDirty&&(this._zOrderDirty=!1,this._updateZOrder()),E>=0&&this._cachedFrameIndices!==null){var D=this._cachedFrameIndices[E];D>=0&&this._cachedFrameIndex===D?this._transformDirty=!1:D>=0?(this._transformDirty=!0,this._cachedFrameIndex=D):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[E]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(E=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._display!==null){if(this._visibleDirty&&(this._visibleDirty=!1,this._updateVisible()),this._blendModeDirty&&(this._blendModeDirty=!1,this._updateBlendMode()),this._colorDirty&&(this._colorDirty=!1,this._updateColor()),this._deformVertices!==null&&this._deformVertices.verticesData!==null&&this._display===this._meshDisplay){var I=this._deformVertices.verticesData.weight!==null,M=this._parent._boneData.type!==0;if((this._deformVertices.verticesDirty||I&&this._deformVertices.isBonesUpdate()||M&&this._parent._childrenTransformDirty)&&(this._deformVertices.verticesDirty=!1,this._updateMesh()),I||M)return}if(this._transformDirty){if(this._transformDirty=!1,this._cachedFrameIndex<0){var N=E>=0;this._updateGlobalTransformMatrix(N),N&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[E]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._isFromCache=!0,this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform()}}},P.prototype.updateTransformAndMatrix=function(){this._transformDirty&&(this._transformDirty=!1,this._updateGlobalTransformMatrix(!1))},P.prototype.replaceDisplayData=function(E,D){if(D===void 0&&(D=-1),D<0&&(D=this._displayIndex<0?0:this._displayIndex),this._displayDatas.length<=D){this._displayDatas.length=D+1;for(var I=0,M=this._displayDatas.length;I<M;++I)this._displayDatas[I]||(this._displayDatas[I]=null)}this._displayDatas[D]=E},P.prototype.containsPoint=function(E,D){return this._boundingBoxData!==null&&(this.updateTransformAndMatrix(),P._helpMatrix.copyFrom(this.globalTransformMatrix),P._helpMatrix.invert(),P._helpMatrix.transformPoint(E,D,P._helpPoint),this._boundingBoxData.containsPoint(P._helpPoint.x,P._helpPoint.y))},P.prototype.intersectsSegment=function(E,D,I,M,N,k,F){if(N===void 0&&(N=null),k===void 0&&(k=null),F===void 0&&(F=null),this._boundingBoxData===null)return 0;this.updateTransformAndMatrix(),P._helpMatrix.copyFrom(this.globalTransformMatrix),P._helpMatrix.invert(),P._helpMatrix.transformPoint(E,D,P._helpPoint),E=P._helpPoint.x,D=P._helpPoint.y,P._helpMatrix.transformPoint(I,M,P._helpPoint),I=P._helpPoint.x,M=P._helpPoint.y;var G=this._boundingBoxData.intersectsSegment(E,D,I,M,N,k,F);return G>0&&(G===1||G===2?N!==null?(this.globalTransformMatrix.transformPoint(N.x,N.y,N),k!==null&&(k.x=N.x,k.y=N.y)):k!==null&&this.globalTransformMatrix.transformPoint(k.x,k.y,k):(N!==null&&this.globalTransformMatrix.transformPoint(N.x,N.y,N),k!==null&&this.globalTransformMatrix.transformPoint(k.x,k.y,k)),F!==null&&(this.globalTransformMatrix.transformPoint(Math.cos(F.x),Math.sin(F.x),P._helpPoint,!0),F.x=Math.atan2(P._helpPoint.y,P._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(F.y),Math.sin(F.y),P._helpPoint,!0),F.y=Math.atan2(P._helpPoint.y,P._helpPoint.x))),G},P.prototype.invalidUpdate=function(){this._displayDirty=!0,this._transformDirty=!0},Object.defineProperty(P.prototype,"visible",{get:function(){return this._visible},set:function(E){this._visible!==E&&(this._visible=E,this._updateVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(E){this._setDisplayIndex(E)&&this.update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"name",{get:function(){return this._slotData.name},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(E){var D=this._displayList.concat(),I=new Array;this._setDisplayList(E)&&this.update(-1);for(var M=0,N=D;M<N.length;M++)(G=N[M])!==null&&G!==this._rawDisplay&&G!==this._meshDisplay&&this._displayList.indexOf(G)<0&&I.indexOf(G)<0&&I.push(G);for(var k=0,F=I;k<F.length;k++){var G;(G=F[k])instanceof A.Armature||this._disposeDisplay(G,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"slotData",{get:function(){return this._slotData},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"rawDisplayDatas",{get:function(){return this._rawDisplayDatas},set:function(E){if(this._rawDisplayDatas!==E)if(this._displayDirty=!0,this._rawDisplayDatas=E,this._rawDisplayDatas!==null){this._displayDatas.length=this._rawDisplayDatas.length;for(var D=0,I=this._displayDatas.length;D<I;++D){var M=this._rawDisplayDatas[D];M===null&&(M=this._getDefaultRawDisplayData(D)),this._displayDatas[D]=M}}else this._displayDatas.length=0},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"displayData",{get:function(){return this._displayData},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"display",{get:function(){return this._display},set:function(E){if(this._display!==E){var D=this._displayList.length;if(this._displayIndex<0&&D===0&&(this._displayIndex=0),!(this._displayIndex<0)){var I=this.displayList;D<=this._displayIndex&&(I.length=this._displayIndex+1),I[this._displayIndex]=E,this.displayList=I}}},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"childArmature",{get:function(){return this._childArmature},set:function(E){this._childArmature!==E&&(this.display=E)},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),P.prototype.getDisplay=function(){return this._display},P.prototype.setDisplay=function(E){this.display=E},P}(A.TransformObject);A.Slot=O}(w||(w={})),function(A){var O=function(E){function D(){return E!==null&&E.apply(this,arguments)||this}return B(D,E),D.prototype._onClear=function(){this._armature=null,this._target=null,this._root=null,this._bone=null},Object.defineProperty(D.prototype,"name",{get:function(){return this._constraintData.name},enumerable:!0,configurable:!0}),D._helpMatrix=new A.Matrix,D._helpTransform=new A.Transform,D._helpPoint=new A.Point,D}(A.BaseObject);A.Constraint=O;var R=function(E){function D(){return E!==null&&E.apply(this,arguments)||this}return B(D,E),D.toString=function(){return"[class dragonBones.IKConstraint]"},D.prototype._onClear=function(){E.prototype._onClear.call(this),this._scaleEnabled=!1,this._bendPositive=!1,this._weight=1,this._constraintData=null},D.prototype._computeA=function(){var I=this._target.global,M=this._root.global,N=this._root.globalTransformMatrix,k=Math.atan2(I.y-M.y,I.x-M.x);M.scaleX<0&&(k+=Math.PI),M.rotation+=A.Transform.normalizeRadian(k-M.rotation)*this._weight,M.toMatrix(N)},D.prototype._computeB=function(){var I=this._bone._boneData.length,M=this._root,N=this._target.global,k=M.global,F=this._bone.global,G=this._bone.globalTransformMatrix,V=G.a*I,j=G.b*I,H=V*V+j*j,U=Math.sqrt(H),X=F.x-k.x,Y=F.y-k.y,z=X*X+Y*Y,W=Math.sqrt(z),Z=F.rotation,Q=k.rotation,ee=Math.atan2(Y,X),te=(X=N.x-k.x)*X+(Y=N.y-k.y)*Y,re=Math.sqrt(te),ie=0;if(U+W<=re||re+U<=W||re+W<=U)ie=Math.atan2(N.y-k.y,N.x-k.x),U+W<=re||W<U&&(ie+=Math.PI);else{var ne=(z-H+te)/(2*te),he=Math.sqrt(z-ne*ne*te)/re,pe=k.x+X*ne,K=k.y+Y*ne,ue=-Y*he,le=X*he,ce=!1,_e=M.parent;if(_e!==null){var oe=_e.globalTransformMatrix;ce=oe.a*oe.d-oe.b*oe.c<0}ce!==this._bendPositive?(F.x=pe-ue,F.y=K-le):(F.x=pe+ue,F.y=K+le),ie=Math.atan2(F.y-k.y,F.x-k.x)}var de=A.Transform.normalizeRadian(ie-ee);k.rotation=Q+de*this._weight,k.toMatrix(M.globalTransformMatrix);var me=ee+de*this._weight;F.x=k.x+Math.cos(me)*W,F.y=k.y+Math.sin(me)*W;var ye=Math.atan2(N.y-F.y,N.x-F.x);F.scaleX<0&&(ye+=Math.PI),F.rotation=k.rotation+Z-Q+A.Transform.normalizeRadian(ye-de-Z)*this._weight,F.toMatrix(G)},D.prototype.init=function(I,M){if(this._constraintData===null){this._constraintData=I,this._armature=M,this._target=this._armature.getBone(this._constraintData.target.name),this._root=this._armature.getBone(this._constraintData.root.name),this._bone=this._constraintData.bone!==null?this._armature.getBone(this._constraintData.bone.name):null;var N=this._constraintData;this._scaleEnabled=N.scaleEnabled,this._bendPositive=N.bendPositive,this._weight=N.weight,this._root._hasConstraint=!0}},D.prototype.update=function(){this._root.updateByConstraint(),this._bone!==null?(this._bone.updateByConstraint(),this._computeB()):this._computeA()},D.prototype.invalidUpdate=function(){this._root.invalidUpdate(),this._bone!==null&&this._bone.invalidUpdate()},D}(O);A.IKConstraint=R;var P=function(E){function D(){var I=E!==null&&E.apply(this,arguments)||this;return I._bones=[],I._spaces=[],I._positions=[],I._curves=[],I._boneLengths=[],I._pathGlobalVertices=[],I._segments=[10],I}return B(D,E),D.toString=function(){return"[class dragonBones.PathConstraint]"},D.prototype._onClear=function(){E.prototype._onClear.call(this),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0},D.prototype._updatePathVertices=function(I){var M=this._armature,N=M.armatureData.parent,k=M.armatureData.scale,F=N.intArray,G=N.floatArray,V=I.offset,j=F[V+0],H=F[V+2];this._pathGlobalVertices.length=2*j;var U=I.weight;if(U!==null)for(var X=this._pathSlot._deformVertices.bones,Y=U.bones.length,z=U.offset,W=F[z+1],Z=z+2+Y,Q=(ue=0,0);ue<j;ue++){for(var ee=0,te=0,re=0,ie=F[Z++];re<ie;re++){var ne=X[F[Z++]];if(ne!==null){ne.updateByConstraint(),K=ne.globalTransformMatrix;var he=G[W++];ce=G[W++]*k,_e=G[W++]*k,ee+=(K.a*ce+K.c*_e+K.tx)*he,te+=(K.b*ce+K.d*_e+K.ty)*he}}this._pathGlobalVertices[Q++]=ee,this._pathGlobalVertices[Q++]=te}else{var pe=this._pathSlot.parent;pe.updateByConstraint();for(var K=pe.globalTransformMatrix,ue=0,le=H;ue<j;ue+=2){var ce=G[le++]*k,_e=G[le++]*k,oe=K.a*ce+K.c*_e+K.tx,de=K.b*ce+K.d*_e+K.ty;this._pathGlobalVertices[ue]=oe,this._pathGlobalVertices[ue+1]=de}}},D.prototype._computeVertices=function(I,M,N,k){for(var F=N,G=I;F<M;F+=2)k[F]=this._pathGlobalVertices[G++],k[F+1]=this._pathGlobalVertices[G++]},D.prototype._computeBezierCurve=function(I,M,N,k,F){var G=this._armature.armatureData.parent.intArray[I.vertices.offset+0],V=this._positions,j=this._spaces,H=I.closed,U=Array(),X=2*G,Y=X/6,z=-1,W=this.position;V.length=3*M+2;var Z=0;if(I.constantSpeed){H?(X+=2,U.length=G,this._computeVertices(2,X-4,0,U),this._computeVertices(0,2,X-4,U),U[X-2]=U[0],U[X-1]=U[1]):(Y--,X-=4,U.length=X,this._computeVertices(2,X,0,U));var Q=new Array(Y);Z=0;for(var ee,te,re,ie,ne,he,pe,K,ue=U[0],le=U[1],ce=0,_e=0,oe=0,de=0,me=0,ye=0,ge=(Ve=0,2);Ve<Y;Ve++,ge+=6)ce=U[ge],_e=U[ge+1],oe=U[ge+2],de=U[ge+3],ne=2*(ee=.1875*(ue-2*ce+oe))+(re=.09375*(3*(ce-oe)-ue+(me=U[ge+4]))),he=2*(te=.1875*(le-2*_e+de))+(ie=.09375*(3*(_e-de)-le+(ye=U[ge+5]))),pe=.75*(ce-ue)+ee+.16666667*re,K=.75*(_e-le)+te+.16666667*ie,Z+=Math.sqrt(pe*pe+K*K),pe+=ne,K+=he,ne+=re,he+=ie,Z+=Math.sqrt(pe*pe+K*K),pe+=ne,K+=he,Z+=Math.sqrt(pe*pe+K*K),pe+=ne+re,K+=he+ie,Z+=Math.sqrt(pe*pe+K*K),Q[Ve]=Z,ue=me,le=ye;if(k&&(W*=Z),F)for(Ve=0;Ve<M;Ve++)j[Ve]*=Z;for(var we=this._segments,Te=0,Ee=(Ve=0,Pe=0,ke=0,0);Ve<M;Ve++,Pe+=3){var De=W+=j[Ve];if(H)(De%=Z)<0&&(De+=Z),ke=0;else if(De<0||De>Z)continue;for(;;ke++){var fe=Q[ke];if(!(De>fe)){ke===0?De/=fe:De=(De-(be=Q[ke-1]))/(fe-be);break}}if(ke!==z){z=ke;var Ce=6*ke;for(ue=U[Ce],le=U[Ce+1],ce=U[Ce+2],_e=U[Ce+3],oe=U[Ce+4],de=U[Ce+5],ne=2*(ee=.03*(ue-2*ce+oe))+(re=.006*(3*(ce-oe)-ue+(me=U[Ce+6]))),he=2*(te=.03*(le-2*_e+de))+(ie=.006*(3*(_e-de)-le+(ye=U[Ce+7]))),pe=.3*(ce-ue)+ee+.16666667*re,K=.3*(_e-le)+te+.16666667*ie,Te=Math.sqrt(pe*pe+K*K),we[0]=Te,Ce=1;Ce<8;Ce++)pe+=ne,K+=he,ne+=re,he+=ie,Te+=Math.sqrt(pe*pe+K*K),we[Ce]=Te;pe+=ne,K+=he,Te+=Math.sqrt(pe*pe+K*K),we[8]=Te,pe+=ne+re,K+=he+ie,Te+=Math.sqrt(pe*pe+K*K),we[9]=Te,Ee=0}for(De*=Te;;Ee++){var Se=we[Ee];if(!(De>Se)){var be;Ee===0?De/=Se:De=Ee+(De-(be=we[Ee-1]))/(Se-be);break}}this.addCurvePosition(.1*De,ue,le,ce,_e,oe,de,me,ye,V,Pe,N)}}else{var Re=I.curveLengths;if(Z=Re[Y-=H?1:2],k&&(W*=Z),F)for(var Ve=0;Ve<M;Ve++)j[Ve]*=Z;U.length=8,Ve=0;for(var Pe=0,ke=0;Ve<M;Ve++,Pe+=3){if(W+=j[Ve],H)(W%=Z)<0&&(W+=Z),ke=0;else if(W<0||W>Z)continue;for(var Ne=0;;ke++){var Ae=Re[ke];if(!(W>Ae)){if(ke===0)Ne=W/Ae;else{var Oe=Re[ke-1];Ne=(W-Oe)/(Ae-Oe)}break}}ke!==z&&(z=ke,H&&ke===Y?(this._computeVertices(X-4,4,0,U),this._computeVertices(0,4,4,U)):this._computeVertices(6*ke+2,8,0,U)),this.addCurvePosition(Ne,U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],V,Pe,N)}}},D.prototype.addCurvePosition=function(I,M,N,k,F,G,V,j,H,U,X,Y){if(I===0)return U[X]=M,U[X+1]=N,void(U[X+2]=0);if(I===1)return U[X]=j,U[X+1]=H,void(U[X+2]=0);var z=1-I,W=z*z,Z=I*I,Q=W*z,ee=W*I*3,te=z*Z*3,re=I*Z,ie=Q*M+ee*k+te*G+re*j,ne=Q*N+ee*F+te*V+re*H;U[X]=ie,U[X+1]=ne,U[X+2]=Y?Math.atan2(ne-(Q*N+ee*F+te*V),ie-(Q*M+ee*k+te*G)):0},D.prototype.init=function(I,M){this._constraintData=I,this._armature=M;var N=I;this.pathOffset=N.pathDisplayData.vertices.offset,this.position=N.position,this.spacing=N.spacing,this.rotateOffset=N.rotateOffset,this.rotateMix=N.rotateMix,this.translateMix=N.translateMix,this._root=this._armature.getBone(N.root.name),this._target=this._armature.getBone(N.target.name),this._pathSlot=this._armature.getSlot(N.pathSlot.name);for(var k=0,F=N.bones.length;k<F;k++){var G=this._armature.getBone(N.bones[k].name);G!==null&&this._bones.push(G)}N.rotateMode===2&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0},D.prototype.update=function(){var I=this._pathSlot;if(I._deformVertices!==null&&I._deformVertices.verticesData!==null&&I._deformVertices.verticesData.offset===this.pathOffset){var M=this._constraintData,N=I._displayData,k=!1,F=I._deformVertices;if(this._root._childrenTransformDirty?(this._updatePathVertices(N.vertices),k=!0):F!==null&&(F.verticesDirty||F.isBonesUpdate())&&(this._updatePathVertices(N.vertices),F.verticesDirty=!1,k=!0),k||this.dirty){var G=M.positionMode,V=M.spacingMode,j=M.rotateMode,H=this._bones,U=V===0,X=j===2,Y=j===0,z=H.length,W=Y?z:z+1,Z=this.spacing,Q=this._spaces;if(Q.length=W,X||U){Q[0]=0;for(var ee=0,te=W-1;ee<te;ee++){(me=H[ee]).updateByConstraint();var re=me._boneData.length,ie=re*(ye=me.globalTransformMatrix).a,ne=re*ye.b,he=Math.sqrt(ie*ie+ne*ne);X&&(this._boneLengths[ee]=he),Q[ee+1]=(re+Z)*he/re}}else for(ee=0;ee<W;ee++)Q[ee]=Z;this._computeBezierCurve(N,W,Y,G===1,V===2);var pe,K=this._positions,ue=this.rotateOffset,le=K[0],ce=K[1];ue===0?pe=j===1:(pe=!1,(me=I.parent)!==null&&(ue*=(ye=me.globalTransformMatrix).a*ye.d-ye.b*ye.c>0?A.Transform.DEG_RAD:-A.Transform.DEG_RAD));for(var _e=this.rotateMix,oe=this.translateMix,de=(ee=0,3);ee<z;ee++,de+=3){var me,ye;(me=H[ee]).updateByConstraint(),(ye=me.globalTransformMatrix).tx+=(le-ye.tx)*oe,ye.ty+=(ce-ye.ty)*oe;var ge=(ie=K[de])-le,we=(ne=K[de+1])-ce;if(X){var Te=this._boneLengths[ee],Ee=(Math.sqrt(ge*ge+we*we)/Te-1)*_e+1;ye.a*=Ee,ye.b*=Ee}if(le=ie,ce=ne,_e>0){var De=ye.a,fe=ye.b,Ce=ye.c,Se=ye.d,be=void 0,Re=void 0,Ve=void 0;if(be=Y?K[de-1]:Math.atan2(we,ge),be-=Math.atan2(fe,De),pe){Re=Math.cos(be),Ve=Math.sin(be);var Pe=me._boneData.length;le+=(Pe*(Re*De-Ve*fe)-ge)*_e,ce+=(Pe*(Ve*De+Re*fe)-we)*_e}else be+=ue;be>A.Transform.PI?be-=A.Transform.PI_D:be<-A.Transform.PI&&(be+=A.Transform.PI_D),be*=_e,Re=Math.cos(be),Ve=Math.sin(be),ye.a=Re*De-Ve*fe,ye.b=Ve*De+Re*fe,ye.c=Re*Ce-Ve*Se,ye.d=Ve*Ce+Re*Se}me.global.fromMatrix(ye)}this.dirty=!1}}},D.prototype.invalidUpdate=function(){},D}(O);A.PathConstraint=P}(w||(w={})),function(A){var O=function(){function R(P){P===void 0&&(P=0),this.time=0,this.timeScale=1,this._systemTime=0,this._animatebles=[],this._clock=null,this.time=P,this._systemTime=.001*new Date().getTime()}return R.prototype.advanceTime=function(P){P!=P&&(P=0);var E=.001*Date.now();if(P<0&&(P=E-this._systemTime),this._systemTime=E,this.timeScale!==1&&(P*=this.timeScale),P!==0){P<0?this.time-=P:this.time+=P;for(var D=0,I=0,M=this._animatebles.length;D<M;++D){var N=this._animatebles[D];N!==null?(I>0&&(this._animatebles[D-I]=N,this._animatebles[D]=null),N.advanceTime(P)):I++}if(I>0){for(M=this._animatebles.length;D<M;++D){var k=this._animatebles[D];k!==null?this._animatebles[D-I]=k:I++}this._animatebles.length-=I}}},R.prototype.contains=function(P){if(P===this)return!1;for(var E=P;E!==this&&E!==null;)E=E.clock;return E===this},R.prototype.add=function(P){this._animatebles.indexOf(P)<0&&(this._animatebles.push(P),P.clock=this)},R.prototype.remove=function(P){var E=this._animatebles.indexOf(P);E>=0&&(this._animatebles[E]=null,P.clock=null)},R.prototype.clear=function(){for(var P=0,E=this._animatebles;P<E.length;P++){var D=E[P];D!==null&&(D.clock=null)}},Object.defineProperty(R.prototype,"clock",{get:function(){return this._clock},set:function(P){this._clock!==P&&(this._clock!==null&&this._clock.remove(this),this._clock=P,this._clock!==null&&this._clock.add(this))},enumerable:!0,configurable:!0}),R.clock=new R,R}();A.WorldClock=O}(w||(w={})),function(A){var O=function(R){function P(){var E=R!==null&&R.apply(this,arguments)||this;return E._animationNames=[],E._animationStates=[],E._animations={},E._animationConfig=null,E}return B(P,R),P.toString=function(){return"[class dragonBones.Animation]"},P.prototype._onClear=function(){for(var E=0,D=this._animationStates;E<D.length;E++)D[E].returnToPool();for(var I in this._animations)delete this._animations[I];this._animationConfig!==null&&this._animationConfig.returnToPool(),this.timeScale=1,this._lockUpdate=!1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null},P.prototype._fadeOut=function(E){switch(E.fadeOutMode){case 1:for(var D=0,I=this._animationStates;D<I.length;D++)(j=I[D])._parent===null&&j.layer===E.layer&&j.fadeOut(E.fadeOutTime,E.pauseFadeOut);break;case 2:for(var M=0,N=this._animationStates;M<N.length;M++)(j=N[M])._parent===null&&j.group===E.group&&j.fadeOut(E.fadeOutTime,E.pauseFadeOut);break;case 3:for(var k=0,F=this._animationStates;k<F.length;k++)(j=F[k])._parent===null&&j.layer===E.layer&&j.group===E.group&&j.fadeOut(E.fadeOutTime,E.pauseFadeOut);break;case 4:for(var G=0,V=this._animationStates;G<V.length;G++){var j;(j=V[G])._parent===null&&j.fadeOut(E.fadeOutTime,E.pauseFadeOut)}}},P.prototype.init=function(E){this._armature===null&&(this._armature=E,this._animationConfig=A.BaseObject.borrowObject(A.AnimationConfig))},P.prototype.advanceTime=function(E){E<0&&(E=-E),this._armature.inheritAnimation&&this._armature._parent!==null?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,this._inheritTimeScale!==1&&(E*=this._inheritTimeScale);var D=this._animationStates.length;if(D===1)if((z=this._animationStates[0])._fadeState>0&&z._subFadeState>0)this._armature._dragonBones.bufferObject(z),this._animationStates.length=0,this._lastAnimationState=null;else{var I=z._animationData,M=I.cacheFrameRate;if(this._animationDirty&&M>0){this._animationDirty=!1;for(var N=0,k=this._armature.getBones();N<k.length;N++){var F=k[N];F._cachedFrameIndices=I.getBoneCachedFrameIndices(F.name)}for(var G=0,V=this._armature.getSlots();G<V.length;G++){var j=V[G],H=j.rawDisplayDatas;if(H!==null&&H.length>0){var U=H[0];if(U!==null&&U.parent===this._armature.armatureData.defaultSkin){j._cachedFrameIndices=I.getSlotCachedFrameIndices(j.name);continue}}j._cachedFrameIndices=null}}z.advanceTime(E,M)}else if(D>1){for(var X=0,Y=0;X<D;++X){var z;(z=this._animationStates[X])._fadeState>0&&z._subFadeState>0?(Y++,this._armature._dragonBones.bufferObject(z),this._animationDirty=!0,this._lastAnimationState===z&&(this._lastAnimationState=null)):(Y>0&&(this._animationStates[X-Y]=z),z.advanceTime(E,0)),X===D-1&&Y>0&&(this._animationStates.length-=Y,this._lastAnimationState===null&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1},P.prototype.reset=function(){for(var E=0,D=this._animationStates;E<D.length;E++)D[E].returnToPool();this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},P.prototype.stop=function(E){if(E===void 0&&(E=null),E!==null)(M=this.getState(E))!==null&&M.stop();else for(var D=0,I=this._animationStates;D<I.length;D++){var M;(M=I[D]).stop()}},P.prototype.playConfig=function(E){var D=E.animation;if(!(D in this._animations))return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+D),null;var I=this._animations[D];if(E.fadeOutMode===5)for(var M=0,N=this._animationStates;M<N.length;M++){var k=N[M];if(k._animationData===I)return k}this._animationStates.length===0?E.fadeInTime=0:E.fadeInTime<0&&(E.fadeInTime=I.fadeInTime),E.fadeOutTime<0&&(E.fadeOutTime=E.fadeInTime),E.timeScale<=-100&&(E.timeScale=1/I.scale),I.frameCount>1?(E.position<0?(E.position%=I.duration,E.position=I.duration-E.position):E.position===I.duration?E.position-=1e-6:E.position>I.duration&&(E.position%=I.duration),E.duration>0&&E.position+E.duration>I.duration&&(E.duration=I.duration-E.position),E.playTimes<0&&(E.playTimes=I.playTimes)):(E.playTimes=1,E.position=0,E.duration>0&&(E.duration=0)),E.duration===0&&(E.duration=-1),this._fadeOut(E);var F=A.BaseObject.borrowObject(A.AnimationState);if(F.init(this._armature,I,E),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,this._animationStates.length>0){for(var G=!1,V=0,j=this._animationStates.length;V<j;++V){if(F.layer>this._animationStates[V].layer){G=!0,this._animationStates.splice(V,0,F);break}if(V!==j-1&&F.layer>this._animationStates[V+1].layer){G=!0,this._animationStates.splice(V+1,0,F);break}}G||this._animationStates.push(F)}else this._animationStates.push(F);for(var H=0,U=this._armature.getSlots();H<U.length;H++){var X=U[H].childArmature;X!==null&&X.inheritAnimation&&X.animation.hasAnimation(D)&&X.animation.getState(D)===null&&X.animation.fadeIn(D)}var Y=!1;for(var z in I.animationTimelines){this._lockUpdate||(Y=!0,this._lockUpdate=!0);var W=this.fadeIn(z,E.fadeInTime,1,F.layer,null,0);W!==null&&(W.resetToPose=!1,W._parent=F,W.stop())}return Y&&(this._lockUpdate=!1),this._lockUpdate||(E.fadeInTime<=0&&this._armature.advanceTime(0),this._lastAnimationState=F),F},P.prototype.play=function(E,D){if(E===void 0&&(E=null),D===void 0&&(D=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=D,this._animationConfig.fadeInTime=0,this._animationConfig.animation=E!==null?E:"",E!==null&&E.length>0)this.playConfig(this._animationConfig);else if(this._lastAnimationState===null){var I=this._armature.armatureData.defaultAnimation;I!==null&&(this._animationConfig.animation=I.name,this.playConfig(this._animationConfig))}else this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):this._lastAnimationState.play();return this._lastAnimationState},P.prototype.fadeIn=function(E,D,I,M,N,k){return D===void 0&&(D=-1),I===void 0&&(I=-1),M===void 0&&(M=0),N===void 0&&(N=null),k===void 0&&(k=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=k,this._animationConfig.playTimes=I,this._animationConfig.layer=M,this._animationConfig.fadeInTime=D,this._animationConfig.animation=E,this._animationConfig.group=N!==null?N:"",this.playConfig(this._animationConfig)},P.prototype.gotoAndPlayByTime=function(E,D,I){return D===void 0&&(D=0),I===void 0&&(I=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=I,this._animationConfig.position=D,this._animationConfig.fadeInTime=0,this._animationConfig.animation=E,this.playConfig(this._animationConfig)},P.prototype.gotoAndPlayByFrame=function(E,D,I){D===void 0&&(D=0),I===void 0&&(I=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=I,this._animationConfig.fadeInTime=0,this._animationConfig.animation=E;var M=E in this._animations?this._animations[E]:null;return M!==null&&(this._animationConfig.position=M.duration*D/M.frameCount),this.playConfig(this._animationConfig)},P.prototype.gotoAndPlayByProgress=function(E,D,I){D===void 0&&(D=0),I===void 0&&(I=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=I,this._animationConfig.fadeInTime=0,this._animationConfig.animation=E;var M=E in this._animations?this._animations[E]:null;return M!==null&&(this._animationConfig.position=M.duration*(D>0?D:0)),this.playConfig(this._animationConfig)},P.prototype.gotoAndStopByTime=function(E,D){D===void 0&&(D=0);var I=this.gotoAndPlayByTime(E,D,1);return I!==null&&I.stop(),I},P.prototype.gotoAndStopByFrame=function(E,D){D===void 0&&(D=0);var I=this.gotoAndPlayByFrame(E,D,1);return I!==null&&I.stop(),I},P.prototype.gotoAndStopByProgress=function(E,D){D===void 0&&(D=0);var I=this.gotoAndPlayByProgress(E,D,1);return I!==null&&I.stop(),I},P.prototype.getState=function(E){for(var D=this._animationStates.length;D--;){var I=this._animationStates[D];if(I.name===E)return I}return null},P.prototype.hasAnimation=function(E){return E in this._animations},P.prototype.getStates=function(){return this._animationStates},Object.defineProperty(P.prototype,"isPlaying",{get:function(){for(var E=0,D=this._animationStates;E<D.length;E++)if(D[E].isPlaying)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"isCompleted",{get:function(){for(var E=0,D=this._animationStates;E<D.length;E++)if(!D[E].isCompleted)return!1;return this._animationStates.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"lastAnimationName",{get:function(){return this._lastAnimationState!==null?this._lastAnimationState.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"animations",{get:function(){return this._animations},set:function(E){if(this._animations!==E){for(var D in this._animationNames.length=0,this._animations)delete this._animations[D];for(var D in E)this._animationNames.push(D),this._animations[D]=E[D]}},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),P.prototype.gotoAndPlay=function(E,D,I,M,N,k,F,G,V){D===void 0&&(D=-1),I===void 0&&(I=-1),M===void 0&&(M=-1),N===void 0&&(N=0),k===void 0&&(k=null),F===void 0&&(F=3),console.warn("Deprecated."),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.fadeOutMode=F,this._animationConfig.playTimes=M,this._animationConfig.layer=N,this._animationConfig.fadeInTime=D,this._animationConfig.animation=E,this._animationConfig.group=k!==null?k:"";var j=this._animations[E];return j&&I>0&&(this._animationConfig.timeScale=j.duration/I),this.playConfig(this._animationConfig)},P.prototype.gotoAndStop=function(E,D){return D===void 0&&(D=0),console.warn("Deprecated."),this.gotoAndStopByTime(E,D)},Object.defineProperty(P.prototype,"animationList",{get:function(){return console.warn("Deprecated."),this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"animationDataList",{get:function(){console.warn("Deprecated.");for(var E=[],D=0,I=this._animationNames.length;D<I;++D)E.push(this._animations[this._animationNames[D]]);return E},enumerable:!0,configurable:!0}),P}(A.BaseObject);A.Animation=O}(w||(w={})),function(A){var O=function(E){function D(){var I=E!==null&&E.apply(this,arguments)||this;return I._blendState=new P,I._boneMask=[],I._boneTimelines=[],I._surfaceTimelines=[],I._slotTimelines=[],I._constraintTimelines=[],I._animationTimelines=[],I._poseTimelines=[],I._bonePoses={},I._actionTimeline=null,I._zOrderTimeline=null,I._parent=null,I}return B(D,E),D.toString=function(){return"[class dragonBones.AnimationState]"},D.prototype._onClear=function(){for(var I=0,M=this._boneTimelines;I<M.length;I++)M[I].returnToPool();for(var N=0,k=this._surfaceTimelines;N<k.length;N++)k[N].returnToPool();for(var F=0,G=this._slotTimelines;F<G.length;F++)G[F].returnToPool();for(var V=0,j=this._constraintTimelines;V<j.length;V++)j[V].returnToPool();for(var H=0,U=this._animationTimelines;H<U.length;H++)U[H].returnToPool();for(var X in this._bonePoses)this._bonePoses[X].returnToPool(),delete this._bonePoses[X];this._actionTimeline!==null&&this._actionTimeline.returnToPool(),this._zOrderTimeline!==null&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additiveBlending=!1,this.displayControl=!1,this.resetToPose=!1,this.playTimes=1,this.layer=0,this.timeScale=1,this.weight=1,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._blendState.clear(),this._boneMask.length=0,this._boneTimelines.length=0,this._surfaceTimelines.length=0,this._slotTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._parent=null},D.prototype._updateTimelines=function(){for(var I=0,M=this._armature._constraints;I<M.length;I++){var N=M[I];if((j=this._animationData.getConstraintTimelines(N.name))!==null)for(var k=0,F=j;k<F.length;k++)switch((Y=F[k]).type){case 30:(z=A.BaseObject.borrowObject(A.IKConstraintTimelineState)).constraint=N,z.init(this._armature,this,Y),this._constraintTimelines.push(z)}else this.resetToPose&&((z=A.BaseObject.borrowObject(A.IKConstraintTimelineState)).constraint=N,z.init(this._armature,this,null),this._constraintTimelines.push(z),this._poseTimelines.push(z))}for(var G=0,V=this._armature.animation.getStates();G<V.length;G++){var j,H=V[G];if(H._parent===this&&(j=this._animationData.getAnimationTimelines(H.name))!==null)for(var U=0,X=j;U<X.length;U++){var Y;switch((Y=X[U]).type){case 40:var z;(z=A.BaseObject.borrowObject(A.AnimationTimelineState)).animationState=H,z.init(this._armature,this,Y),this._animationTimelines.push(z)}}}},D.prototype._updateBoneAndSlotTimelines=function(){for(var I={},M=0,N=this._boneTimelines;M<N.length;M++)(V=(ee=N[M]).bone.name)in I||(I[V]=[]),I[V].push(ee);for(var k=0,F=this._armature.getBones();k<F.length;k++){var G=F[k],V=G.name;if(this.containsBoneMask(V)){if(V in I)delete I[V];else if(G._boneData.type===0){var j=this._animationData.getBoneTimelines(V),H=V in this._bonePoses?this._bonePoses[V]:this._bonePoses[V]=A.BaseObject.borrowObject(R);if(j!==null)for(var U=0,X=j;U<X.length;U++)switch((de=X[U]).type){case 10:(ee=A.BaseObject.borrowObject(A.BoneAllTimelineState)).bone=G,ee.bonePose=H,ee.init(this._armature,this,de),this._boneTimelines.push(ee);break;case 11:(ee=A.BaseObject.borrowObject(A.BoneTranslateTimelineState)).bone=G,ee.bonePose=H,ee.init(this._armature,this,de),this._boneTimelines.push(ee);break;case 12:(ee=A.BaseObject.borrowObject(A.BoneRotateTimelineState)).bone=G,ee.bonePose=H,ee.init(this._armature,this,de),this._boneTimelines.push(ee);break;case 13:(ee=A.BaseObject.borrowObject(A.BoneScaleTimelineState)).bone=G,ee.bonePose=H,ee.init(this._armature,this,de),this._boneTimelines.push(ee)}else this.resetToPose&&((ee=A.BaseObject.borrowObject(A.BoneAllTimelineState)).bone=G,ee.bonePose=H,ee.init(this._armature,this,null),this._boneTimelines.push(ee),this._poseTimelines.push(ee))}else if(G._boneData.type===1)if((j=this._animationData.getSurfaceTimelines(V))!==null)for(var Y=0,z=j;Y<z.length;Y++)switch((de=z[Y]).type){case 50:(ee=A.BaseObject.borrowObject(A.SurfaceTimelineState)).surface=G,ee.init(this._armature,this,de),this._surfaceTimelines.push(ee)}else this.resetToPose&&((ee=A.BaseObject.borrowObject(A.SurfaceTimelineState)).surface=G,ee.init(this._armature,this,null),this._surfaceTimelines.push(ee),this._poseTimelines.push(ee))}}for(var W in I)for(var Z=0,Q=I[W];Z<Q.length;Z++){var ee=Q[Z];this._boneTimelines.splice(this._boneTimelines.indexOf(ee),1),ee.returnToPool()}for(var te={},re=[],ie=0,ne=this._slotTimelines;ie<ne.length;ie++)(V=(ee=ne[ie]).slot.name)in te||(te[V]=[]),te[V].push(ee);for(var he=0,pe=this._armature.getSlots();he<pe.length;he++){var K=pe[he],ue=K.parent.name;if(this.containsBoneMask(ue))if(V=K.name,j=this._animationData.getSlotTimelines(V),V in te)delete te[V];else{var le=!1,ce=!1;if(re.length=0,j!==null)for(var _e=0,oe=j;_e<oe.length;_e++){var de;switch((de=oe[_e]).type){case 20:(ee=A.BaseObject.borrowObject(A.SlotDislayTimelineState)).slot=K,ee.init(this._armature,this,de),this._slotTimelines.push(ee),le=!0;break;case 21:(ee=A.BaseObject.borrowObject(A.SlotColorTimelineState)).slot=K,ee.init(this._armature,this,de),this._slotTimelines.push(ee),ce=!0;break;case 22:(ee=A.BaseObject.borrowObject(A.DeformTimelineState)).slot=K,ee.init(this._armature,this,de),this._slotTimelines.push(ee),re.push(ee.vertexOffset)}}if(this.resetToPose&&(le||((ee=A.BaseObject.borrowObject(A.SlotDislayTimelineState)).slot=K,ee.init(this._armature,this,null),this._slotTimelines.push(ee),this._poseTimelines.push(ee)),ce||((ee=A.BaseObject.borrowObject(A.SlotColorTimelineState)).slot=K,ee.init(this._armature,this,null),this._slotTimelines.push(ee),this._poseTimelines.push(ee)),K.rawDisplayDatas!==null))for(var me=0,ye=K.rawDisplayDatas;me<ye.length;me++){var ge=ye[me];if(ge!==null&&ge.type===2){var we=ge.vertices.offset;re.indexOf(we)<0&&((ee=A.BaseObject.borrowObject(A.DeformTimelineState)).vertexOffset=we,ee.slot=K,ee.init(this._armature,this,null),this._slotTimelines.push(ee),this._poseTimelines.push(ee))}}}}for(var W in te)for(var Te=0,Ee=te[W];Te<Ee.length;Te++)ee=Ee[Te],this._slotTimelines.splice(this._slotTimelines.indexOf(ee),1),ee.returnToPool()},D.prototype._advanceFadeTime=function(I){var M,N=this._fadeState>0;if(this._subFadeState<0){this._subFadeState=0;var k=N?A.EventObject.FADE_OUT:A.EventObject.FADE_IN;this._armature.eventDispatcher.hasDBEventListener(k)&&((M=A.BaseObject.borrowObject(A.EventObject)).type=k,M.armature=this._armature,M.animationState=this,this._armature._dragonBones.bufferEvent(M))}I<0&&(I=-I),this._fadeTime+=I,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=N?0:1):this._fadeTime>0?this._fadeProgress=N?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=N?1:0,this._subFadeState>0&&(N||(this._playheadState|=1,this._fadeState=0),k=N?A.EventObject.FADE_OUT_COMPLETE:A.EventObject.FADE_IN_COMPLETE,this._armature.eventDispatcher.hasDBEventListener(k)&&((M=A.BaseObject.borrowObject(A.EventObject)).type=k,M.armature=this._armature,M.animationState=this,this._armature._dragonBones.bufferEvent(M)))},D.prototype.init=function(I,M,N){if(this._armature===null){if(this._armature=I,this._animationData=M,this.resetToPose=N.resetToPose,this.additiveBlending=N.additiveBlending,this.displayControl=N.displayControl,this.actionEnabled=N.actionEnabled,this.layer=N.layer,this.playTimes=N.playTimes,this.timeScale=N.timeScale,this.fadeTotalTime=N.fadeInTime,this.autoFadeOutTime=N.autoFadeOutTime,this.weight=N.weight,this.name=N.name.length>0?N.name:N.animation,this.group=N.group,N.pauseFadeIn?this._playheadState=2:this._playheadState=3,N.duration<0?(this._position=0,this._duration=this._animationData.duration,N.position!==0?this.timeScale>=0?this._time=N.position:this._time=N.position-this._duration:this._time=0):(this._position=N.position,this._duration=N.duration,this._time=0),this.timeScale<0&&this._time===0&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),N.boneMask.length>0){this._boneMask.length=N.boneMask.length;for(var k=0,F=this._boneMask.length;k<F;++k)this._boneMask[k]=N.boneMask[k]}this._actionTimeline=A.BaseObject.borrowObject(A.ActionTimelineState),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),this._animationData.zOrderTimeline!==null&&(this._zOrderTimeline=A.BaseObject.borrowObject(A.ZOrderTimelineState),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}},D.prototype.advanceTime=function(I,M){if(this._blendState.dirty=!1,this._fadeState===0&&this._subFadeState===0||this._advanceFadeTime(I),this._playheadState===3&&(this.timeScale!==1&&(I*=this.timeScale),this._time+=I),this._timelineDirty!==0&&(this._timelineDirty===2&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines()),this.weight!==0){var N=this._fadeState===0&&M>0,k=!0,F=!0,G=this._time;if(this._weightResult=this.weight*this._fadeProgress,this._parent!==null&&(this._weightResult*=this._parent._weightResult/this._parent._fadeProgress),this._actionTimeline.playState<=0&&this._actionTimeline.update(G),N){var V=2*M;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*V)/V}if(this._zOrderTimeline!==null&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(G),N){var j=Math.floor(this._actionTimeline.currentTime*M);this._armature._cacheFrameIndex===j?(k=!1,F=!1):(this._armature._cacheFrameIndex=j,this._animationData.cachedFrames[j]?F=!1:this._animationData.cachedFrames[j]=!0)}if(k){if(F)for(var H=0,U=this._boneTimelines.length;H<U;++H)(Z=this._boneTimelines[H]).playState<=0&&Z.update(G),(H===U-1||Z.bone!==this._boneTimelines[H+1].bone)&&(X=Z.bone._blendState.update(this._weightResult,this.layer))!==0&&Z.blend(X);for(H=0,U=this._surfaceTimelines.length;H<U;++H){var X=(Z=this._surfaceTimelines[H]).surface._blendState.update(this._weightResult,this.layer);Z.playState<=0&&Z.update(G),X!==0&&Z.blend(X)}if(this.displayControl)for(H=0,U=this._slotTimelines.length;H<U;++H){var Y=(Z=this._slotTimelines[H]).slot.displayController;Y!==null&&Y!==this.name&&Y!==this.group||Z.playState<=0&&Z.update(G)}for(H=0,U=this._constraintTimelines.length;H<U;++H)(Z=this._constraintTimelines[H]).playState<=0&&Z.update(G);for(H=0,U=this._animationTimelines.length;H<U;++H)X=(Z=this._animationTimelines[H]).animationState._blendState.update(this._weightResult,this.layer),Z.playState<=0&&Z.update(G),X!==0&&Z.blend(X)}if(this._fadeState===0){if(this._subFadeState>0&&(this._subFadeState=0,this._poseTimelines.length>0)){for(var z=0,W=this._poseTimelines;z<W.length;z++){var Z;(Z=W[z])instanceof A.BoneTimelineState?this._boneTimelines.splice(this._boneTimelines.indexOf(Z),1):Z instanceof A.SurfaceTimelineState?this._surfaceTimelines.splice(this._surfaceTimelines.indexOf(Z),1):Z instanceof A.SlotTimelineState?this._slotTimelines.splice(this._slotTimelines.indexOf(Z),1):Z instanceof A.ConstraintTimelineState&&this._constraintTimelines.splice(this._constraintTimelines.indexOf(Z),1),Z.returnToPool()}this._poseTimelines.length=0}this._actionTimeline.playState>0&&this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime)}}},D.prototype.play=function(){this._playheadState=3},D.prototype.stop=function(){this._playheadState&=1},D.prototype.fadeOut=function(I,M){if(M===void 0&&(M=!0),I<0&&(I=0),M&&(this._playheadState&=2),this._fadeState>0){if(I>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(I<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var N=0,k=this._boneTimelines;N<k.length;N++)(z=k[N]).fadeOut();for(var F=0,G=this._surfaceTimelines;F<G.length;F++)(z=G[F]).fadeOut();for(var V=0,j=this._slotTimelines;V<j.length;V++)(z=j[V]).fadeOut();for(var H=0,U=this._constraintTimelines;H<U.length;H++)(z=U[H]).fadeOut();for(var X=0,Y=this._animationTimelines;X<Y.length;X++){var z;(z=Y[X]).animationState.fadeOut(I,M),z.fadeOut()}}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?I/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},D.prototype.containsBoneMask=function(I){return this._boneMask.length===0||this._boneMask.indexOf(I)>=0},D.prototype.addBoneMask=function(I,M){M===void 0&&(M=!0);var N=this._armature.getBone(I);if(N!==null){if(this._boneMask.indexOf(I)<0&&this._boneMask.push(I),M)for(var k=0,F=this._armature.getBones();k<F.length;k++){var G=F[k];this._boneMask.indexOf(G.name)<0&&N.contains(G)&&this._boneMask.push(G.name)}this._timelineDirty=1}},D.prototype.removeBoneMask=function(I,M){M===void 0&&(M=!0);var N=this._boneMask.indexOf(I);if(N>=0&&this._boneMask.splice(N,1),M){var k=this._armature.getBone(I);if(k!==null){var F=this._armature.getBones();if(this._boneMask.length>0)for(var G=0,V=F;G<V.length;G++){var j=V[G],H=this._boneMask.indexOf(j.name);H>=0&&k.contains(j)&&this._boneMask.splice(H,1)}else for(var U=0,X=F;U<X.length;U++)(j=X[U])!==k&&(k.contains(j)||this._boneMask.push(j.name))}}this._timelineDirty=1},D.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._timelineDirty=1},Object.defineProperty(D.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"isFadeOut",{get:function(){return this._fadeState>0},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"isFadeComplete",{get:function(){return this._fadeState===0},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"isPlaying",{get:function(){return(2&this._playheadState)!=0&&this._actionTimeline.playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"isCompleted",{get:function(){return this._actionTimeline.playState>0},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(I){var M=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if((I<0||this._duration<I)&&(I=I%this._duration+M*this._duration)<0&&(I+=this._duration),this.playTimes>0&&M===this.playTimes-1&&I===this._duration&&(I=this._duration-1e-6),this._time!==I){this._time=I,this._actionTimeline.setCurrentTime(this._time),this._zOrderTimeline!==null&&(this._zOrderTimeline.playState=-1);for(var N=0,k=this._boneTimelines;N<k.length;N++)k[N].playState=-1;for(var F=0,G=this._slotTimelines;F<G.length;F++)G[F].playState=-1}},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),D}(A.BaseObject);A.AnimationState=O;var R=function(E){function D(){var I=E!==null&&E.apply(this,arguments)||this;return I.current=new A.Transform,I.delta=new A.Transform,I.result=new A.Transform,I}return B(D,E),D.toString=function(){return"[class dragonBones.BonePose]"},D.prototype._onClear=function(){this.current.identity(),this.delta.identity(),this.result.identity()},D}(A.BaseObject);A.BonePose=R;var P=function(){function E(){}return E.prototype.update=function(D,I){if(this.dirty){if(!(this.leftWeight>0))return 0;if(this.layer!==I){if(this.layerWeight>=this.leftWeight)return this.leftWeight=0,0;this.layer=I,this.leftWeight-=this.layerWeight,this.layerWeight=0}return D*=this.leftWeight,this.layerWeight+=D,this.blendWeight=D,2}return this.dirty=!0,this.layer=I,this.layerWeight=D,this.leftWeight=1,this.blendWeight=D,1},E.prototype.clear=function(){this.dirty=!1,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0},E}();A.BlendState=P}(w||(w={})),function(A){var O=function(I){function M(){return I!==null&&I.apply(this,arguments)||this}return B(M,I),M.prototype._onClear=function(){this.playState=-1,this.currentPlayTimes=-1,this.currentTime=-1,this._tweenState=0,this._frameRate=0,this._frameValueOffset=0,this._frameCount=0,this._frameOffset=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._dragonBonesData=null,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._frameIntArray=null,this._frameFloatArray=null,this._timelineArray=null,this._frameIndices=null},M.prototype._setCurrentTime=function(N){var k=this.playState,F=this.currentPlayTimes,G=this.currentTime;if(this._actionTimeline!==null&&this._frameCount<=1)this.playState=this._actionTimeline.playState>=0?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(this._actionTimeline===null||this._timeScale!==1||this._timeOffset!==0){var V=this._animationState.playTimes,j=V*this._duration;N*=this._timeScale,this._timeOffset!==0&&(N+=this._timeOffset*this._animationData.duration),V>0&&(N>=j||N<=-j)?(this.playState<=0&&this._animationState._playheadState===3&&(this.playState=1),this.currentPlayTimes=V,this.currentTime=N<0?0:this._duration+1e-6):(this.playState!==0&&this._animationState._playheadState===3&&(this.playState=0),N<0?(N=-N,this.currentPlayTimes=Math.floor(N/this._duration),this.currentTime=this._duration-N%this._duration):(this.currentPlayTimes=Math.floor(N/this._duration),this.currentTime=N%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return(this.currentPlayTimes!==F||this.currentTime!==G)&&((k<0&&this.playState!==k||this.playState<=0&&this.currentPlayTimes!==F)&&(this._frameIndex=-1),!0)},M.prototype.init=function(N,k,F){this._armature=N,this._animationState=k,this._timelineData=F,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState._animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,this._dragonBonesData=this._animationData.parent.parent,this._timelineData!==null&&(this._frameIntArray=this._dragonBonesData.frameIntArray,this._frameFloatArray=this._dragonBonesData.frameFloatArray,this._frameArray=this._dragonBonesData.frameArray,this._timelineArray=this._dragonBonesData.timelineArray,this._frameIndices=this._dragonBonesData.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=.01*this._timelineArray[this._timelineData.offset+1])},M.prototype.fadeOut=function(){},M.prototype.update=function(N){if(this._setCurrentTime(N)){if(this._frameCount>1){var k=Math.floor(this.currentTime*this._frameRate),F=this._frameIndices[this._timelineData.frameIndicesOffset+k];this._frameIndex!==F&&(this._frameIndex=F,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())}else this._frameIndex<0&&(this._frameIndex=0,this._timelineData!==null&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame());this._tweenState!==0&&this._onUpdateFrame()}},M}(A.BaseObject);A.TimelineState=O;var R=function(I){function M(){return I!==null&&I.apply(this,arguments)||this}return B(M,I),M._getEasingValue=function(N,k,F){var G=k;switch(N){case 3:G=Math.pow(k,2);break;case 4:G=1-Math.pow(1-k,2);break;case 5:G=.5*(1-Math.cos(k*Math.PI))}return(G-k)*F+k},M._getEasingCurveValue=function(N,k,F,G){if(N<=0)return 0;if(N>=1)return 1;var V=F+1,j=Math.floor(N*V),H=j===0?0:k[G+j-1];return 1e-4*(H+((j===V-1?1e4:k[G+j])-H)*(N*V-j))},M.prototype._onClear=function(){I.prototype._onClear.call(this),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenProgress=0,this._tweenEasing=0},M.prototype._onArriveAtFrame=function(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||this._animationState.playTimes===0||this._animationState.currentPlayTimes<this._animationState.playTimes-1))if(this._tweenType=this._frameArray[this._frameOffset+1],this._tweenState=this._tweenType===0?1:2,this._tweenType===2?this._curveCount=this._frameArray[this._frameOffset+2]:this._tweenType!==0&&this._tweenType!==1&&(this._tweenEasing=.01*this._frameArray[this._frameOffset+2]),this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{var N=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],k=this._frameArray[N]*this._frameRateR-this._framePosition;this._frameDurationR=k>0?1/k:0}else this._tweenState=1},M.prototype._onUpdateFrame=function(){this._tweenState===2?(this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,this._tweenType===2?this._tweenProgress=M._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):this._tweenType!==1&&(this._tweenProgress=M._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing))):this._tweenProgress=0},M}(O);A.TweenTimelineState=R;var P=function(I){function M(){return I!==null&&I.apply(this,arguments)||this}return B(M,I),M.prototype._onClear=function(){I.prototype._onClear.call(this),this.bone=null,this.bonePose=null},M.prototype.blend=function(N){var k=this.bone._blendState.blendWeight,F=this.bone.animationPose,G=this.bonePose.result;N===2?(F.x+=G.x*k,F.y+=G.y*k,F.rotation+=G.rotation*k,F.skew+=G.skew*k,F.scaleX+=(G.scaleX-1)*k,F.scaleY+=(G.scaleY-1)*k):k!==1?(F.x=G.x*k,F.y=G.y*k,F.rotation=G.rotation*k,F.skew=G.skew*k,F.scaleX=(G.scaleX-1)*k+1,F.scaleY=(G.scaleY-1)*k+1):(F.x=G.x,F.y=G.y,F.rotation=G.rotation,F.skew=G.skew,F.scaleX=G.scaleX,F.scaleY=G.scaleY),this._animationState._fadeState===0&&this._animationState._subFadeState===0||(this.bone._transformDirty=!0)},M}(R);A.BoneTimelineState=P;var E=function(I){function M(){return I!==null&&I.apply(this,arguments)||this}return B(M,I),M.prototype._onClear=function(){I.prototype._onClear.call(this),this.slot=null},M}(R);A.SlotTimelineState=E;var D=function(I){function M(){return I!==null&&I.apply(this,arguments)||this}return B(M,I),M.prototype._onClear=function(){I.prototype._onClear.call(this),this.constraint=null},M}(R);A.ConstraintTimelineState=D}(w||(w={})),function(A){var O=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.ActionTimelineState]"},H.prototype._onCrossFrame=function(U){var X=this._armature.eventDispatcher;if(this._animationState.actionEnabled)for(var Y=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+U],z=this._frameArray[Y+1],W=this._animationData.parent.actions,Z=0;Z<z;++Z){var Q=W[this._frameArray[Y+2+Z]];if(Q.type===0)(ee=A.BaseObject.borrowObject(A.EventObject)).time=this._frameArray[Y]/this._frameRate,ee.animationState=this._animationState,A.EventObject.actionDataToInstance(Q,ee,this._armature),this._armature._bufferAction(ee,!0);else{var ee,te=Q.type===10?A.EventObject.FRAME_EVENT:A.EventObject.SOUND_EVENT;(Q.type===11||X.hasDBEventListener(te))&&((ee=A.BaseObject.borrowObject(A.EventObject)).time=this._frameArray[Y]/this._frameRate,ee.animationState=this._animationState,A.EventObject.actionDataToInstance(Q,ee,this._armature),this._armature._dragonBones.bufferEvent(ee))}}},H.prototype._onArriveAtFrame=function(){},H.prototype._onUpdateFrame=function(){},H.prototype.update=function(U){var X=this.playState,Y=this.currentPlayTimes,z=this.currentTime;if(this._setCurrentTime(U)){var W=this._armature.eventDispatcher;if(X<0){if(this.playState===X)return;if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),Y=this.currentPlayTimes,W.hasDBEventListener(A.EventObject.START)){var Z=A.BaseObject.borrowObject(A.EventObject);Z.type=A.EventObject.START,Z.armature=this._armature,Z.animationState=this._animationState,this._armature._dragonBones.bufferEvent(Z)}}var Q=this._animationState.timeScale<0,ee=null,te=null;if(this.currentPlayTimes!==Y&&(W.hasDBEventListener(A.EventObject.LOOP_COMPLETE)&&((ee=A.BaseObject.borrowObject(A.EventObject)).type=A.EventObject.LOOP_COMPLETE,ee.armature=this._armature,ee.animationState=this._animationState),this.playState>0&&W.hasDBEventListener(A.EventObject.COMPLETE)&&((te=A.BaseObject.borrowObject(A.EventObject)).type=A.EventObject.COMPLETE,te.armature=this._armature,te.animationState=this._animationState)),this._frameCount>1){var re=this._timelineData,ie=Math.floor(this.currentTime*this._frameRate),ne=this._frameIndices[re.frameIndicesOffset+ie];if(this._frameIndex!==ne){var he=this._frameIndex;if(this._frameIndex=ne,this._timelineArray!==null)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[re.offset+5+this._frameIndex],Q){if(he<0){var pe=Math.floor(z*this._frameRate);he=this._frameIndices[re.frameIndicesOffset+pe],this.currentPlayTimes===Y&&he===ne&&(he=-1)}for(;he>=0;){var K=this._animationData.frameOffset+this._timelineArray[re.offset+5+he],ue=this._frameArray[K]/this._frameRate;if(this._position<=ue&&ue<=this._position+this._duration&&this._onCrossFrame(he),ee!==null&&he===0&&(this._armature._dragonBones.bufferEvent(ee),ee=null),he>0?he--:he=this._frameCount-1,he===ne)break}}else for(he<0&&(pe=Math.floor(z*this._frameRate),he=this._frameIndices[re.frameIndicesOffset+pe],K=this._animationData.frameOffset+this._timelineArray[re.offset+5+he],ue=this._frameArray[K]/this._frameRate,this.currentPlayTimes===Y&&(z<=ue?he>0?he--:he=this._frameCount-1:he===ne&&(he=-1)));he>=0&&(he<this._frameCount-1?he++:he=0,K=this._animationData.frameOffset+this._timelineArray[re.offset+5+he],ue=this._frameArray[K]/this._frameRate,this._position<=ue&&ue<=this._position+this._duration&&this._onCrossFrame(he),ee!==null&&he===0&&(this._armature._dragonBones.bufferEvent(ee),ee=null),he!==ne););}}else this._frameIndex<0&&(this._frameIndex=0,this._timelineData!==null)&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5],ue=this._frameArray[this._frameOffset]/this._frameRate,this.currentPlayTimes===Y?z<=ue&&this._onCrossFrame(this._frameIndex):this._position<=ue&&(Q||ee===null||(this._armature._dragonBones.bufferEvent(ee),ee=null),this._onCrossFrame(this._frameIndex)));ee!==null&&this._armature._dragonBones.bufferEvent(ee),te!==null&&this._armature._dragonBones.bufferEvent(te)}},H.prototype.setCurrentTime=function(U){this._setCurrentTime(U),this._frameIndex=-1},H}(A.TimelineState);A.ActionTimelineState=O;var R=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},H.prototype._onArriveAtFrame=function(){this.playState>=0&&(this._frameArray[this._frameOffset+1]>0?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))},H.prototype._onUpdateFrame=function(){},H}(A.TimelineState);A.ZOrderTimelineState=R;var P=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.BoneAllTimelineState]"},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._animationData.frameFloatOffset+this._frameValueOffset+6*this._frameIndex,X=this._armature._armatureData.scale,Y=this._frameFloatArray,z=this.bonePose.current,W=this.bonePose.delta;z.x=Y[U++]*X,z.y=Y[U++]*X,z.rotation=Y[U++],z.skew=Y[U++],z.scaleX=Y[U++],z.scaleY=Y[U++],this._tweenState===2?(this._frameIndex===this._frameCount-1&&(U=this._animationData.frameFloatOffset+this._frameValueOffset),W.x=Y[U++]*X-z.x,W.y=Y[U++]*X-z.y,W.rotation=Y[U++]-z.rotation,W.skew=Y[U++]-z.skew,W.scaleX=Y[U++]-z.scaleX,W.scaleY=Y[U++]-z.scaleY):(W.x=0,W.y=0,W.rotation=0,W.skew=0,W.scaleX=0,W.scaleY=0)}else z=this.bonePose.current,W=this.bonePose.delta,z.x=0,z.y=0,z.rotation=0,z.skew=0,z.scaleX=1,z.scaleY=1,W.x=0,W.y=0,W.rotation=0,W.skew=0,W.scaleX=0,W.scaleY=0},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this);var U=this.bonePose.current,X=this.bonePose.delta,Y=this.bonePose.result;this.bone._transformDirty=!0,this._tweenState!==2&&(this._tweenState=0),Y.x=U.x+X.x*this._tweenProgress,Y.y=U.y+X.y*this._tweenProgress,Y.rotation=U.rotation+X.rotation*this._tweenProgress,Y.skew=U.skew+X.skew*this._tweenProgress,Y.scaleX=U.scaleX+X.scaleX*this._tweenProgress,Y.scaleY=U.scaleY+X.scaleY*this._tweenProgress},H.prototype.fadeOut=function(){var U=this.bonePose.result;U.rotation=A.Transform.normalizeRadian(U.rotation),U.skew=A.Transform.normalizeRadian(U.skew)},H}(A.BoneTimelineState);A.BoneAllTimelineState=P;var E=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,X=this._armature._armatureData.scale,Y=this._frameFloatArray,z=this.bonePose.current,W=this.bonePose.delta;z.x=Y[U++]*X,z.y=Y[U++]*X,this._tweenState===2?(this._frameIndex===this._frameCount-1&&(U=this._animationData.frameFloatOffset+this._frameValueOffset),W.x=Y[U++]*X-z.x,W.y=Y[U++]*X-z.y):(W.x=0,W.y=0)}else z=this.bonePose.current,W=this.bonePose.delta,z.x=0,z.y=0,W.x=0,W.y=0},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this);var U=this.bonePose.current,X=this.bonePose.delta,Y=this.bonePose.result;this.bone._transformDirty=!0,this._tweenState!==2&&(this._tweenState=0),Y.x=U.x+X.x*this._tweenProgress,Y.y=U.y+X.y*this._tweenProgress},H}(A.BoneTimelineState);A.BoneTranslateTimelineState=E;var D=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,X=this._frameFloatArray,Y=this.bonePose.current,z=this.bonePose.delta;Y.rotation=X[U++],Y.skew=X[U++],this._tweenState===2?(this._frameIndex===this._frameCount-1?(U=this._animationData.frameFloatOffset+this._frameValueOffset,z.rotation=A.Transform.normalizeRadian(X[U++]-Y.rotation)):z.rotation=X[U++]-Y.rotation,z.skew=X[U++]-Y.skew):(z.rotation=0,z.skew=0)}else Y=this.bonePose.current,z=this.bonePose.delta,Y.rotation=0,Y.skew=0,z.rotation=0,z.skew=0},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this);var U=this.bonePose.current,X=this.bonePose.delta,Y=this.bonePose.result;this.bone._transformDirty=!0,this._tweenState!==2&&(this._tweenState=0),Y.rotation=U.rotation+X.rotation*this._tweenProgress,Y.skew=U.skew+X.skew*this._tweenProgress},H.prototype.fadeOut=function(){var U=this.bonePose.result;U.rotation=A.Transform.normalizeRadian(U.rotation),U.skew=A.Transform.normalizeRadian(U.skew)},H}(A.BoneTimelineState);A.BoneRotateTimelineState=D;var I=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,X=this._frameFloatArray,Y=this.bonePose.current,z=this.bonePose.delta;Y.scaleX=X[U++],Y.scaleY=X[U++],this._tweenState===2?(this._frameIndex===this._frameCount-1&&(U=this._animationData.frameFloatOffset+this._frameValueOffset),z.scaleX=X[U++]-Y.scaleX,z.scaleY=X[U++]-Y.scaleY):(z.scaleX=0,z.scaleY=0)}else Y=this.bonePose.current,z=this.bonePose.delta,Y.scaleX=1,Y.scaleY=1,z.scaleX=0,z.scaleY=0},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this);var U=this.bonePose.current,X=this.bonePose.delta,Y=this.bonePose.result;this.bone._transformDirty=!0,this._tweenState!==2&&(this._tweenState=0),Y.scaleX=U.scaleX+X.scaleX*this._tweenProgress,Y.scaleY=U.scaleY+X.scaleY*this._tweenProgress},H}(A.BoneTimelineState);A.BoneScaleTimelineState=I;var M=function(j){function H(){var U=j!==null&&j.apply(this,arguments)||this;return U._current=[],U._delta=[],U._result=[],U}return B(H,j),H.toString=function(){return"[class dragonBones.SurfaceTimelineState]"},H.prototype._onClear=function(){j.prototype._onClear.call(this),this.surface=null,this._frameFloatOffset=0,this._valueCount=0,this._deformCount=0,this._valueOffset=0,this._current.length=0,this._delta.length=0,this._result.length=0},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount,X=this._armature._armatureData.scale,Y=this._frameFloatArray;if(this._tweenState===2){var z=U+this._valueCount;this._frameIndex===this._frameCount-1&&(z=this._animationData.frameFloatOffset+this._frameValueOffset);for(var W=0;W<this._valueCount;++W)this._delta[W]=Y[z+W]*X-(this._current[W]=Y[U+W]*X)}else for(W=0;W<this._valueCount;++W)this._current[W]=Y[U+W]*X}else for(W=0;W<this._valueCount;++W)this._current[W]=0},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this),this.surface._transformDirty=!0,this._tweenState!==2&&(this._tweenState=0);for(var U=0;U<this._valueCount;++U)this._result[U]=this._current[U]+this._delta[U]*this._tweenProgress},H.prototype.init=function(U,X,Y){if(j.prototype.init.call(this,U,X,Y),this._timelineData!==null){var z=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this._deformCount=this._frameIntArray[z+1],this._valueCount=this._frameIntArray[z+2],this._valueOffset=this._frameIntArray[z+3],this._frameFloatOffset=this._frameIntArray[z+4]+this._animationData.frameFloatOffset}else this._deformCount=this.surface._deformVertices.length,this._valueCount=this._deformCount,this._valueOffset=0,this._frameFloatOffset=0;this._current.length=this._valueCount,this._delta.length=this._valueCount,this._result.length=this._valueCount;for(var W=0;W<this._valueCount;++W)this._delta[W]=0},H.prototype.blend=function(U){for(var X=this.surface._blendState.blendWeight,Y=this.surface._deformVertices,z=0;z<this._deformCount;++z){var W;W=z<this._valueOffset?this._frameFloatArray[this._frameFloatOffset+z]:z<this._valueOffset+this._valueCount?this._result[z-this._valueOffset]:this._frameFloatArray[this._frameFloatOffset+z-this._valueCount],U===2?Y[z]+=W*X:Y[z]=X!==1?W*X:W}this._animationState._fadeState===0&&this._animationState._subFadeState===0||(this.surface._transformDirty=!0)},H}(A.TweenTimelineState);A.SurfaceTimelineState=M;var N=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.SlotDislayTimelineState]"},H.prototype._onArriveAtFrame=function(){if(this.playState>=0){var U=this._timelineData!==null?this._frameArray[this._frameOffset+1]:this.slot._slotData.displayIndex;this.slot.displayIndex!==U&&this.slot._setDisplayIndex(U,!0)}},H}(A.SlotTimelineState);A.SlotDislayTimelineState=N;var k=function(j){function H(){var U=j!==null&&j.apply(this,arguments)||this;return U._current=[0,0,0,0,0,0,0,0],U._delta=[0,0,0,0,0,0,0,0],U._result=[0,0,0,0,0,0,0,0],U}return B(H,j),H.toString=function(){return"[class dragonBones.SlotColorTimelineState]"},H.prototype._onClear=function(){j.prototype._onClear.call(this),this._dirty=!1},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._dragonBonesData.intArray,X=this._frameIntArray,Y=this._animationData.frameIntOffset+this._frameValueOffset+1*this._frameIndex,z=X[Y];z<0&&(z+=65536),this._current[0]=U[z++],this._current[1]=U[z++],this._current[2]=U[z++],this._current[3]=U[z++],this._current[4]=U[z++],this._current[5]=U[z++],this._current[6]=U[z++],this._current[7]=U[z++],this._tweenState===2&&((z=this._frameIndex===this._frameCount-1?X[this._animationData.frameIntOffset+this._frameValueOffset]:X[Y+1])<0&&(z+=65536),this._delta[0]=U[z++]-this._current[0],this._delta[1]=U[z++]-this._current[1],this._delta[2]=U[z++]-this._current[2],this._delta[3]=U[z++]-this._current[3],this._delta[4]=U[z++]-this._current[4],this._delta[5]=U[z++]-this._current[5],this._delta[6]=U[z++]-this._current[6],this._delta[7]=U[z++]-this._current[7])}else{var W=this.slot._slotData.color;this._current[0]=100*W.alphaMultiplier,this._current[1]=100*W.redMultiplier,this._current[2]=100*W.greenMultiplier,this._current[3]=100*W.blueMultiplier,this._current[4]=W.alphaOffset,this._current[5]=W.redOffset,this._current[6]=W.greenOffset,this._current[7]=W.blueOffset}},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this),this._dirty=!0,this._tweenState!==2&&(this._tweenState=0),this._result[0]=.01*(this._current[0]+this._delta[0]*this._tweenProgress),this._result[1]=.01*(this._current[1]+this._delta[1]*this._tweenProgress),this._result[2]=.01*(this._current[2]+this._delta[2]*this._tweenProgress),this._result[3]=.01*(this._current[3]+this._delta[3]*this._tweenProgress),this._result[4]=this._current[4]+this._delta[4]*this._tweenProgress,this._result[5]=this._current[5]+this._delta[5]*this._tweenProgress,this._result[6]=this._current[6]+this._delta[6]*this._tweenProgress,this._result[7]=this._current[7]+this._delta[7]*this._tweenProgress},H.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},H.prototype.update=function(U){if(j.prototype.update.call(this,U),this._tweenState!==0||this._dirty){var X=this.slot._colorTransform;if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){if(X.alphaMultiplier!==this._result[0]||X.redMultiplier!==this._result[1]||X.greenMultiplier!==this._result[2]||X.blueMultiplier!==this._result[3]||X.alphaOffset!==this._result[4]||X.redOffset!==this._result[5]||X.greenOffset!==this._result[6]||X.blueOffset!==this._result[7]){var Y=Math.pow(this._animationState._fadeProgress,4);X.alphaMultiplier+=(this._result[0]-X.alphaMultiplier)*Y,X.redMultiplier+=(this._result[1]-X.redMultiplier)*Y,X.greenMultiplier+=(this._result[2]-X.greenMultiplier)*Y,X.blueMultiplier+=(this._result[3]-X.blueMultiplier)*Y,X.alphaOffset+=(this._result[4]-X.alphaOffset)*Y,X.redOffset+=(this._result[5]-X.redOffset)*Y,X.greenOffset+=(this._result[6]-X.greenOffset)*Y,X.blueOffset+=(this._result[7]-X.blueOffset)*Y,this.slot._colorDirty=!0}}else this._dirty&&(this._dirty=!1,X.alphaMultiplier===this._result[0]&&X.redMultiplier===this._result[1]&&X.greenMultiplier===this._result[2]&&X.blueMultiplier===this._result[3]&&X.alphaOffset===this._result[4]&&X.redOffset===this._result[5]&&X.greenOffset===this._result[6]&&X.blueOffset===this._result[7]||(X.alphaMultiplier=this._result[0],X.redMultiplier=this._result[1],X.greenMultiplier=this._result[2],X.blueMultiplier=this._result[3],X.alphaOffset=this._result[4],X.redOffset=this._result[5],X.greenOffset=this._result[6],X.blueOffset=this._result[7],this.slot._colorDirty=!0))}},H}(A.SlotTimelineState);A.SlotColorTimelineState=k;var F=function(j){function H(){var U=j!==null&&j.apply(this,arguments)||this;return U._current=[],U._delta=[],U._result=[],U}return B(H,j),H.toString=function(){return"[class dragonBones.DeformTimelineState]"},H.prototype._onClear=function(){j.prototype._onClear.call(this),this.vertexOffset=0,this._dirty=!1,this._frameFloatOffset=0,this._valueCount=0,this._deformCount=0,this._valueOffset=0,this._current.length=0,this._delta.length=0,this._result.length=0},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount,X=this._armature._armatureData.scale,Y=this._frameFloatArray;if(this._tweenState===2){var z=U+this._valueCount;this._frameIndex===this._frameCount-1&&(z=this._animationData.frameFloatOffset+this._frameValueOffset);for(var W=0;W<this._valueCount;++W)this._delta[W]=Y[z+W]*X-(this._current[W]=Y[U+W]*X)}else for(W=0;W<this._valueCount;++W)this._current[W]=Y[U+W]*X}else for(W=0;W<this._valueCount;++W)this._current[W]=0},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this),this._dirty=!0,this._tweenState!==2&&(this._tweenState=0);for(var U=0;U<this._valueCount;++U)this._result[U]=this._current[U]+this._delta[U]*this._tweenProgress},H.prototype.init=function(U,X,Y){if(j.prototype.init.call(this,U,X,Y),this._timelineData!==null){var z=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this.vertexOffset=this._frameIntArray[z+0],this.vertexOffset<0&&(this.vertexOffset+=65536),this._deformCount=this._frameIntArray[z+1],this._valueCount=this._frameIntArray[z+2],this._valueOffset=this._frameIntArray[z+3],this._frameFloatOffset=this._frameIntArray[z+4]+this._animationData.frameFloatOffset}else{var W=this.slot._deformVertices;this._deformCount=W!==null?W.vertices.length:0,this._valueCount=this._deformCount,this._valueOffset=0,this._frameFloatOffset=0}this._current.length=this._valueCount,this._delta.length=this._valueCount,this._result.length=this._valueCount;for(var Z=0;Z<this._valueCount;++Z)this._delta[Z]=0},H.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},H.prototype.update=function(U){var X=this.slot._deformVertices;if(X!==null&&X.verticesData!==null&&X.verticesData.offset===this.vertexOffset&&(j.prototype.update.call(this,U),this._tweenState!==0||this._dirty)){var Y=X.vertices;if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){for(var z=Math.pow(this._animationState._fadeProgress,2),W=0;W<this._deformCount;++W)W<this._valueOffset?Y[W]+=(this._frameFloatArray[this._frameFloatOffset+W]-Y[W])*z:W<this._valueOffset+this._valueCount?Y[W]+=(this._result[W-this._valueOffset]-Y[W])*z:Y[W]+=(this._frameFloatArray[this._frameFloatOffset+W-this._valueCount]-Y[W])*z;X.verticesDirty=!0}else if(this._dirty){for(this._dirty=!1,W=0;W<this._deformCount;++W)W<this._valueOffset?Y[W]=this._frameFloatArray[this._frameFloatOffset+W]:W<this._valueOffset+this._valueCount?Y[W]=this._result[W-this._valueOffset]:Y[W]=this._frameFloatArray[this._frameFloatOffset+W-this._valueCount];X.verticesDirty=!0}}},H}(A.SlotTimelineState);A.DeformTimelineState=F;var G=function(j){function H(){return j!==null&&j.apply(this,arguments)||this}return B(H,j),H.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"},H.prototype._onClear=function(){j.prototype._onClear.call(this),this._current=0,this._delta=0},H.prototype._onArriveAtFrame=function(){j.prototype._onArriveAtFrame.call(this);var U=this.constraint;if(this._timelineData!==null){var X=this._animationData.frameIntOffset+this._frameValueOffset+2*this._frameIndex,Y=this._frameIntArray,z=Y[X++]!==0;this._current=.01*Y[X++],this._tweenState===2?(this._frameIndex===this._frameCount-1&&(X=this._animationData.frameIntOffset+this._frameValueOffset),this._delta=.01*Y[X+1]-this._current):this._delta=0,U._bendPositive=z}else{var W=U._constraintData;this._current=W.weight,this._delta=0,U._bendPositive=W.bendPositive}U.invalidUpdate()},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this),this._tweenState!==2&&(this._tweenState=0);var U=this.constraint;U._weight=this._current+this._delta*this._tweenProgress,U.invalidUpdate()},H}(A.ConstraintTimelineState);A.IKConstraintTimelineState=G;var V=function(j){function H(){var U=j!==null&&j.apply(this,arguments)||this;return U._floats=[0,0,0,0,0,0],U}return B(H,j),H.toString=function(){return"[class dragonBones.AnimationTimelineState]"},H.prototype._onClear=function(){j.prototype._onClear.call(this),this.animationState=null},H.prototype._onArriveAtFrame=function(){if(j.prototype._onArriveAtFrame.call(this),this._timelineData!==null){var U=this._animationData.frameIntOffset+this._frameValueOffset+2*this._frameIndex,X=1/this.animationState._animationData.parent.frameRate,Y=this._frameIntArray;this._floats[0]=Y[U++]*X,this._floats[3]=.01*Y[U++],this._tweenState===2?(this._frameIndex===this._frameCount-1&&(U=this._animationData.frameIntOffset+this._frameValueOffset),this._floats[1]=Y[U++]*X-this._floats[0],this._floats[4]=.01*Y[U++]-this._floats[3]):(this._floats[1]=0,this._floats[4]=0)}},H.prototype._onUpdateFrame=function(){j.prototype._onUpdateFrame.call(this),this._tweenState!==2&&(this._tweenState=0),this._floats[0]>=0&&(this._floats[2]=this._floats[0]+this._floats[1]*this._tweenProgress),this._floats[5]=this._floats[3]+this._floats[4]*this._tweenProgress},H.prototype.blend=function(U){var X=this.animationState,Y=X._blendState.blendWeight;U===2?(X.weight+=this._floats[5]*Y,X.currentTime+=this._floats[2]*Y):(X.weight=this._floats[5]*Y,X.currentTime=this._floats[2]*Y)},H}(A.TweenTimelineState);A.AnimationTimelineState=V}(w||(w={})),function(A){var O=function(R){function P(){return R!==null&&R.apply(this,arguments)||this}return B(P,R),P.actionDataToInstance=function(E,D,I){E.type===0?D.type=P.FRAME_EVENT:D.type=E.type===10?P.FRAME_EVENT:P.SOUND_EVENT,D.name=E.name,D.armature=I,D.actionData=E,D.data=E.data,E.bone!==null&&(D.bone=I.getBone(E.bone.name)),E.slot!==null&&(D.slot=I.getSlot(E.slot.name))},P.toString=function(){return"[class dragonBones.EventObject]"},P.prototype._onClear=function(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null},P.START="start",P.LOOP_COMPLETE="loopComplete",P.COMPLETE="complete",P.FADE_IN="fadeIn",P.FADE_IN_COMPLETE="fadeInComplete",P.FADE_OUT="fadeOut",P.FADE_OUT_COMPLETE="fadeOutComplete",P.FRAME_EVENT="frameEvent",P.SOUND_EVENT="soundEvent",P}(A.BaseObject);A.EventObject=O}(w||(w={})),function(A){var O=function(){function R(){}return R._getArmatureType=function(P){switch(P.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},R._getBoneType=function(P){switch(P.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}},R._getDisplayType=function(P){switch(P.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}},R._getBoundingBoxType=function(P){switch(P.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}},R._getActionType=function(P){switch(P.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}},R._getBlendMode=function(P){switch(P.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},R._getPositionMode=function(P){switch(P.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}},R._getSpacingMode=function(P){switch(P.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}},R._getRotateMode=function(P){switch(P.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}},R.parseDragonBonesData=function(P){return console.warn("Deprecated."),P instanceof ArrayBuffer?A.BinaryDataParser.getInstance().parseDragonBonesData(P):A.ObjectDataParser.getInstance().parseDragonBonesData(P)},R.parseTextureAtlasData=function(P,E){E===void 0&&(E=1),console.warn("已废弃");for(var D={},I=P[R.SUB_TEXTURE],M=0,N=I.length;M<N;M++){var k=I[M],F=k[R.NAME],G=new A.Rectangle,V=null;G.x=k[R.X]/E,G.y=k[R.Y]/E,G.width=k[R.WIDTH]/E,G.height=k[R.HEIGHT]/E,R.FRAME_WIDTH in k&&((V=new A.Rectangle).x=k[R.FRAME_X]/E,V.y=k[R.FRAME_Y]/E,V.width=k[R.FRAME_WIDTH]/E,V.height=k[R.FRAME_HEIGHT]/E),D[F]={region:G,frame:V,rotated:!1}}return D},R.DATA_VERSION_2_3="2.3",R.DATA_VERSION_3_0="3.0",R.DATA_VERSION_4_0="4.0",R.DATA_VERSION_4_5="4.5",R.DATA_VERSION_5_0="5.0",R.DATA_VERSION_5_5="5.5",R.DATA_VERSION=R.DATA_VERSION_5_5,R.DATA_VERSIONS=[R.DATA_VERSION_4_0,R.DATA_VERSION_4_5,R.DATA_VERSION_5_0,R.DATA_VERSION_5_5],R.TEXTURE_ATLAS="textureAtlas",R.SUB_TEXTURE="SubTexture",R.FORMAT="format",R.IMAGE_PATH="imagePath",R.WIDTH="width",R.HEIGHT="height",R.ROTATED="rotated",R.FRAME_X="frameX",R.FRAME_Y="frameY",R.FRAME_WIDTH="frameWidth",R.FRAME_HEIGHT="frameHeight",R.DRADON_BONES="dragonBones",R.USER_DATA="userData",R.ARMATURE="armature",R.BONE="bone",R.SURFACE="surface",R.SLOT="slot",R.CONSTRAINT="constraint",R.IK="ik",R.PATH_CONSTRAINT="path",R.SKIN="skin",R.DISPLAY="display",R.ANIMATION="animation",R.Z_ORDER="zOrder",R.FFD="ffd",R.FRAME="frame",R.TRANSLATE_FRAME="translateFrame",R.ROTATE_FRAME="rotateFrame",R.SCALE_FRAME="scaleFrame",R.DISPLAY_FRAME="displayFrame",R.COLOR_FRAME="colorFrame",R.DEFAULT_ACTIONS="defaultActions",R.ACTIONS="actions",R.EVENTS="events",R.INTS="ints",R.FLOATS="floats",R.STRINGS="strings",R.CANVAS="canvas",R.TRANSFORM="transform",R.PIVOT="pivot",R.AABB="aabb",R.COLOR="color",R.VERSION="version",R.COMPATIBLE_VERSION="compatibleVersion",R.FRAME_RATE="frameRate",R.TYPE="type",R.SUB_TYPE="subType",R.NAME="name",R.PARENT="parent",R.TARGET="target",R.STAGE="stage",R.SHARE="share",R.PATH="path",R.LENGTH="length",R.DISPLAY_INDEX="displayIndex",R.BLEND_MODE="blendMode",R.INHERIT_TRANSLATION="inheritTranslation",R.INHERIT_ROTATION="inheritRotation",R.INHERIT_SCALE="inheritScale",R.INHERIT_REFLECTION="inheritReflection",R.INHERIT_ANIMATION="inheritAnimation",R.INHERIT_DEFORM="inheritDeform",R.SEGMENT_X="segmentX",R.SEGMENT_Y="segmentY",R.BEND_POSITIVE="bendPositive",R.CHAIN="chain",R.WEIGHT="weight",R.FADE_IN_TIME="fadeInTime",R.PLAY_TIMES="playTimes",R.SCALE="scale",R.OFFSET="offset",R.POSITION="position",R.DURATION="duration",R.TWEEN_EASING="tweenEasing",R.TWEEN_ROTATE="tweenRotate",R.TWEEN_SCALE="tweenScale",R.CLOCK_WISE="clockwise",R.CURVE="curve",R.SOUND="sound",R.EVENT="event",R.ACTION="action",R.X="x",R.Y="y",R.SKEW_X="skX",R.SKEW_Y="skY",R.SCALE_X="scX",R.SCALE_Y="scY",R.VALUE="value",R.ROTATE="rotate",R.SKEW="skew",R.ALPHA_OFFSET="aO",R.RED_OFFSET="rO",R.GREEN_OFFSET="gO",R.BLUE_OFFSET="bO",R.ALPHA_MULTIPLIER="aM",R.RED_MULTIPLIER="rM",R.GREEN_MULTIPLIER="gM",R.BLUE_MULTIPLIER="bM",R.UVS="uvs",R.VERTICES="vertices",R.TRIANGLES="triangles",R.WEIGHTS="weights",R.SLOT_POSE="slotPose",R.BONE_POSE="bonePose",R.GLUE_WEIGHTS="glueWeights",R.GLUE_MESHES="glueMeshes",R.BONES="bones",R.POSITION_MODE="positionMode",R.SPACING_MODE="spacingMode",R.ROTATE_MODE="rotateMode",R.SPACING="spacing",R.ROTATE_OFFSET="rotateOffset",R.ROTATE_MIX="rotateMix",R.TRANSLATE_MIX="translateMix",R.TARGET_DISPLAY="targetDisplay",R.CLOSED="closed",R.CONSTANT_SPEED="constantSpeed",R.VERTEX_COUNT="vertexCount",R.LENGTHS="lengths",R.GOTO_AND_PLAY="gotoAndPlay",R.DEFAULT_NAME="default",R}();A.DataParser=O}(w||(w={})),function(A){var O=function(P){function E(){var D=P!==null&&P.apply(this,arguments)||this;return D._rawTextureAtlasIndex=0,D._rawBones=[],D._data=null,D._armature=null,D._bone=null,D._surface=null,D._slot=null,D._skin=null,D._mesh=null,D._animation=null,D._timeline=null,D._rawTextureAtlases=null,D._defaultColorOffset=-1,D._prevClockwise=0,D._prevRotation=0,D._helpMatrixA=new A.Matrix,D._helpMatrixB=new A.Matrix,D._helpTransform=new A.Transform,D._helpColorTransform=new A.ColorTransform,D._helpPoint=new A.Point,D._helpArray=[],D._intArray=[],D._floatArray=[],D._frameIntArray=[],D._frameFloatArray=[],D._frameArray=[],D._timelineArray=[],D._cacheRawMeshes=[],D._cacheMeshes=[],D._actionFrames=[],D._weightSlotPose={},D._weightBonePoses={},D._cacheBones={},D._slotChildActions={},D}return B(E,P),E._getBoolean=function(D,I,M){if(I in D){var N=D[I],k=typeof N;if(k==="boolean")return N;if(k!=="string")return!!N;switch(N){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return M},E._getNumber=function(D,I,M){if(I in D){var N=D[I];return N===null||N==="NaN"?M:+N||0}return M},E._getString=function(D,I,M){if(I in D){var N=D[I];if(typeof N=="string"){if(A.DragonBones.webAssembly){for(var k=0,F=N.length;k<F;++k)if(N.charCodeAt(k)>255)return encodeURI(N)}return N}return String(N)}return M},E.prototype._getCurvePoint=function(D,I,M,N,k,F,G,V,j,H){var U=1-j,X=U*U,Y=j*j,z=U*X,W=3*j*X,Z=3*U*Y,Q=j*Y;H.x=z*D+W*M+Z*k+Q*G,H.y=z*I+W*N+Z*F+Q*V},E.prototype._samplingEasingCurve=function(D,I){for(var M=D.length,N=-2,k=0,F=I.length;k<F;++k){for(var G=(k+1)/(F+1);(N+6<M?D[N+6]:1)<G;)N+=6;for(var V=N>=0&&N+6<M,j=V?D[N]:0,H=V?D[N+1]:0,U=D[N+2],X=D[N+3],Y=D[N+4],z=D[N+5],W=V?D[N+6]:1,Z=V?D[N+7]:1,Q=0,ee=1;ee-Q>1e-4;){var te=.5*(ee+Q);this._getCurvePoint(j,H,U,X,Y,z,W,Z,te,this._helpPoint),G-this._helpPoint.x>0?Q=te:ee=te}I[k]=this._helpPoint.y}},E.prototype._parseActionDataInFrame=function(D,I,M,N){A.DataParser.EVENT in D&&this._mergeActionFrame(D[A.DataParser.EVENT],I,10,M,N),A.DataParser.SOUND in D&&this._mergeActionFrame(D[A.DataParser.SOUND],I,11,M,N),A.DataParser.ACTION in D&&this._mergeActionFrame(D[A.DataParser.ACTION],I,0,M,N),A.DataParser.EVENTS in D&&this._mergeActionFrame(D[A.DataParser.EVENTS],I,10,M,N),A.DataParser.ACTIONS in D&&this._mergeActionFrame(D[A.DataParser.ACTIONS],I,0,M,N)},E.prototype._mergeActionFrame=function(D,I,M,N,k){for(var F=A.DragonBones.webAssembly?this._armature.actions.size():this._armature.actions.length,G=this._parseActionData(D,M,N,k),V=0,j=null,H=0,U=G;H<U.length;H++){var X=U[H];this._armature.addAction(X,!1)}this._actionFrames.length===0&&((j=new R).frameStart=0,this._actionFrames.push(j),j=null);for(var Y=0,z=this._actionFrames;Y<z.length;Y++){var W=z[Y];if(W.frameStart===I){j=W;break}if(W.frameStart>I)break;V++}j===null&&((j=new R).frameStart=I,this._actionFrames.splice(V+1,0,j));for(var Z=0;Z<G.length;++Z)j.actions.push(F+Z)},E.prototype._parseArmature=function(D,I){var M=A.BaseObject.borrowObject(A.ArmatureData);if(M.name=E._getString(D,A.DataParser.NAME,""),M.frameRate=E._getNumber(D,A.DataParser.FRAME_RATE,this._data.frameRate),M.scale=I,A.DataParser.TYPE in D&&typeof D[A.DataParser.TYPE]=="string"?M.type=A.DataParser._getArmatureType(D[A.DataParser.TYPE]):M.type=E._getNumber(D,A.DataParser.TYPE,0),M.frameRate===0&&(M.frameRate=24),this._armature=M,A.DataParser.CANVAS in D){var N=D[A.DataParser.CANVAS],k=A.BaseObject.borrowObject(A.CanvasData);A.DataParser.COLOR in N?k.hasBackground=!0:k.hasBackground=!1,k.color=E._getNumber(N,A.DataParser.COLOR,0),k.x=E._getNumber(N,A.DataParser.X,0)*M.scale,k.y=E._getNumber(N,A.DataParser.Y,0)*M.scale,k.width=E._getNumber(N,A.DataParser.WIDTH,0)*M.scale,k.height=E._getNumber(N,A.DataParser.HEIGHT,0)*M.scale,M.canvas=k}if(A.DataParser.AABB in D){var F=D[A.DataParser.AABB];M.aabb.x=E._getNumber(F,A.DataParser.X,0)*M.scale,M.aabb.y=E._getNumber(F,A.DataParser.Y,0)*M.scale,M.aabb.width=E._getNumber(F,A.DataParser.WIDTH,0)*M.scale,M.aabb.height=E._getNumber(F,A.DataParser.HEIGHT,0)*M.scale}if(A.DataParser.BONE in D)for(var G=0,V=D[A.DataParser.BONE];G<V.length;G++){var j=V[G],H=E._getString(j,A.DataParser.PARENT,""),U=this._parseBone(j);if(H.length>0){var X=M.getBone(H);X!==null?U.parent=X:(H in this._cacheBones||(this._cacheBones[H]=[]),this._cacheBones[H].push(U))}if(U.name in this._cacheBones){for(var Y=0,z=this._cacheBones[U.name];Y<z.length;Y++)z[Y].parent=U;delete this._cacheBones[U.name]}M.addBone(U),this._rawBones.push(U)}if(A.DataParser.IK in D)for(var W=0,Z=D[A.DataParser.IK];W<Z.length;W++){var Q=Z[W];(le=this._parseIKConstraint(Q))&&M.addConstraint(le)}if(M.sortBones(),A.DataParser.SLOT in D)for(var ee=0,te=0,re=D[A.DataParser.SLOT];te<re.length;te++){var ie=re[te];M.addSlot(this._parseSlot(ie,ee++))}if(A.DataParser.SKIN in D)for(var ne=0,he=D[A.DataParser.SKIN];ne<he.length;ne++){var pe=he[ne];M.addSkin(this._parseSkin(pe))}if(A.DataParser.PATH_CONSTRAINT in D)for(var K=0,ue=D[A.DataParser.PATH_CONSTRAINT];K<ue.length;K++){var le,ce=ue[K];(le=this._parsePathConstraint(ce))&&M.addConstraint(le)}for(var _e=0,oe=this._cacheRawMeshes.length;_e<oe;++_e){var de=this._cacheRawMeshes[_e];A.DataParser.GLUE_WEIGHTS in de&&A.DataParser.GLUE_MESHES in de&&this._parseMeshGlue(de,this._cacheMeshes[_e])}for(_e=0,oe=this._cacheRawMeshes.length;_e<oe;++_e){var me=this._cacheRawMeshes[_e],ye=E._getString(me,A.DataParser.SHARE,"");if(ye.length!==0){var ge=E._getString(me,A.DataParser.SKIN,A.DataParser.DEFAULT_NAME);ge.length===0&&(ge=A.DataParser.DEFAULT_NAME);var we=M.getMesh(ge,"",ye);we!==null&&this._cacheMeshes[_e].vertices.shareFrom(we.vertices)}}if(A.DataParser.ANIMATION in D)for(var Te=0,Ee=D[A.DataParser.ANIMATION];Te<Ee.length;Te++){var De=Ee[Te],fe=this._parseAnimation(De);M.addAnimation(fe)}if(A.DataParser.DEFAULT_ACTIONS in D)for(var Ce=0,Se=this._parseActionData(D[A.DataParser.DEFAULT_ACTIONS],0,null,null);Ce<Se.length;Ce++){var be=Se[Ce];M.addAction(be,!0),be.type===0&&(fe=M.getAnimation(be.name))!==null&&(M.defaultAnimation=fe)}if(A.DataParser.ACTIONS in D)for(var Re=0,Ve=this._parseActionData(D[A.DataParser.ACTIONS],0,null,null);Re<Ve.length;Re++)be=Ve[Re],M.addAction(be,!1);for(var Pe in this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null,this._weightSlotPose)delete this._weightSlotPose[Pe];for(var Pe in this._weightBonePoses)delete this._weightBonePoses[Pe];for(var Pe in this._cacheBones)delete this._cacheBones[Pe];for(var Pe in this._slotChildActions)delete this._slotChildActions[Pe];return M},E.prototype._parseBone=function(D){var I=this._armature.scale;if((A.DataParser.TYPE in D&&typeof D[A.DataParser.TYPE]=="string"?A.DataParser._getBoneType(D[A.DataParser.TYPE]):E._getNumber(D,A.DataParser.TYPE,0))===0){var M=A.BaseObject.borrowObject(A.BoneData);return M.inheritTranslation=E._getBoolean(D,A.DataParser.INHERIT_TRANSLATION,!0),M.inheritRotation=E._getBoolean(D,A.DataParser.INHERIT_ROTATION,!0),M.inheritScale=E._getBoolean(D,A.DataParser.INHERIT_SCALE,!0),M.inheritReflection=E._getBoolean(D,A.DataParser.INHERIT_REFLECTION,!0),M.length=E._getNumber(D,A.DataParser.LENGTH,0)*I,M.name=E._getString(D,A.DataParser.NAME,""),A.DataParser.TRANSFORM in D&&this._parseTransform(D[A.DataParser.TRANSFORM],M.transform,I),M}var N=A.BaseObject.borrowObject(A.SurfaceData);if(N.name=E._getString(D,A.DataParser.NAME,""),N.segmentX=E._getNumber(D,A.DataParser.SEGMENT_X,0),N.segmentY=E._getNumber(D,A.DataParser.SEGMENT_Y,0),N.vertices.length=(N.segmentX+1)*(N.segmentY+1)*2,A.DataParser.VERTICES in D)for(var k=D[A.DataParser.VERTICES],F=0,G=N.vertices.length;F<G;++F)F<k.length?N.vertices[F]=k[F]*I:N.vertices[F]=0;return N},E.prototype._parseIKConstraint=function(D){var I=this._armature.getBone(E._getString(D,A.DataParser.BONE,""));if(I===null)return null;var M=this._armature.getBone(E._getString(D,A.DataParser.TARGET,""));if(M===null)return null;var N=A.BaseObject.borrowObject(A.IKConstraintData);return N.scaleEnabled=E._getBoolean(D,A.DataParser.SCALE,!1),N.bendPositive=E._getBoolean(D,A.DataParser.BEND_POSITIVE,!0),N.weight=E._getNumber(D,A.DataParser.WEIGHT,1),N.name=E._getString(D,A.DataParser.NAME,""),N.type=0,N.target=M,E._getNumber(D,A.DataParser.CHAIN,0)>0&&I.parent!==null?(N.root=I.parent,N.bone=I):(N.root=I,N.bone=null),N},E.prototype._parsePathConstraint=function(D){var I=this._armature.getSlot(E._getString(D,A.DataParser.TARGET,""));if(I===null)return null;var M=this._armature.defaultSkin;if(M===null)return null;var N=M.getDisplay(I.name,E._getString(D,A.DataParser.TARGET_DISPLAY,I.name));if(N===null||!(N instanceof A.PathDisplayData))return null;var k=D[A.DataParser.BONES];if(k===null||k.length===0)return null;var F=A.BaseObject.borrowObject(A.PathConstraintData);F.name=E._getString(D,A.DataParser.NAME,""),F.type=1,F.pathSlot=I,F.pathDisplayData=N,F.target=I.parent,F.positionMode=A.DataParser._getPositionMode(E._getString(D,A.DataParser.POSITION_MODE,"")),F.spacingMode=A.DataParser._getSpacingMode(E._getString(D,A.DataParser.SPACING_MODE,"")),F.rotateMode=A.DataParser._getRotateMode(E._getString(D,A.DataParser.ROTATE_MODE,"")),F.position=E._getNumber(D,A.DataParser.POSITION,0),F.spacing=E._getNumber(D,A.DataParser.SPACING,0),F.rotateOffset=E._getNumber(D,A.DataParser.ROTATE_OFFSET,0),F.rotateMix=E._getNumber(D,A.DataParser.ROTATE_MIX,1),F.translateMix=E._getNumber(D,A.DataParser.TRANSLATE_MIX,1);for(var G=0,V=k;G<V.length;G++){var j=V[G],H=this._armature.getBone(j);H!==null&&(F.AddBone(H),F.root===null&&(F.root=H))}return F},E.prototype._parseSlot=function(D,I){var M=A.BaseObject.borrowObject(A.SlotData);return M.displayIndex=E._getNumber(D,A.DataParser.DISPLAY_INDEX,0),M.zOrder=I,M.name=E._getString(D,A.DataParser.NAME,""),M.parent=this._armature.getBone(E._getString(D,A.DataParser.PARENT,"")),A.DataParser.BLEND_MODE in D&&typeof D[A.DataParser.BLEND_MODE]=="string"?M.blendMode=A.DataParser._getBlendMode(D[A.DataParser.BLEND_MODE]):M.blendMode=E._getNumber(D,A.DataParser.BLEND_MODE,0),A.DataParser.COLOR in D?(M.color=A.SlotData.createColor(),this._parseColorTransform(D[A.DataParser.COLOR],M.color)):M.color=A.SlotData.DEFAULT_COLOR,A.DataParser.ACTIONS in D&&(this._slotChildActions[M.name]=this._parseActionData(D[A.DataParser.ACTIONS],0,null,null)),M},E.prototype._parseSkin=function(D){var I=A.BaseObject.borrowObject(A.SkinData);if(I.name=E._getString(D,A.DataParser.NAME,A.DataParser.DEFAULT_NAME),I.name.length===0&&(I.name=A.DataParser.DEFAULT_NAME),A.DataParser.SLOT in D){var M=D[A.DataParser.SLOT];this._skin=I;for(var N=0,k=M;N<k.length;N++){var F=k[N],G=E._getString(F,A.DataParser.NAME,""),V=this._armature.getSlot(G);if(V!==null){if(this._slot=V,A.DataParser.DISPLAY in F)for(var j=0,H=F[A.DataParser.DISPLAY];j<H.length;j++){var U=H[j];U?I.addDisplay(G,this._parseDisplay(U)):I.addDisplay(G,null)}this._slot=null}}this._skin=null}return I},E.prototype._parseDisplay=function(D){var I=E._getString(D,A.DataParser.NAME,""),M=E._getString(D,A.DataParser.PATH,""),N=0,k=null;switch(N=A.DataParser.TYPE in D&&typeof D[A.DataParser.TYPE]=="string"?A.DataParser._getDisplayType(D[A.DataParser.TYPE]):E._getNumber(D,A.DataParser.TYPE,N)){case 0:var F=k=A.BaseObject.borrowObject(A.ImageDisplayData);F.name=I,F.path=M.length>0?M:I,this._parsePivot(D,F);break;case 1:var G=k=A.BaseObject.borrowObject(A.ArmatureDisplayData);if(G.name=I,G.path=M.length>0?M:I,G.inheritAnimation=!0,A.DataParser.ACTIONS in D)for(var V=0,j=this._parseActionData(D[A.DataParser.ACTIONS],0,null,null);V<j.length;V++){var H=j[V];G.addAction(H)}else if(this._slot.name in this._slotChildActions){var U=this._skin.getDisplays(this._slot.name);if(U===null?this._slot.displayIndex===0:this._slot.displayIndex===U.length){for(var X=0,Y=this._slotChildActions[this._slot.name];X<Y.length;X++)H=Y[X],G.addAction(H);delete this._slotChildActions[this._slot.name]}}break;case 2:var z=k=A.BaseObject.borrowObject(A.MeshDisplayData);z.vertices.inheritDeform=E._getBoolean(D,A.DataParser.INHERIT_DEFORM,!0),z.name=I,z.path=M.length>0?M:I,z.vertices.data=this._data,A.DataParser.SHARE in D?(this._cacheRawMeshes.push(D),this._cacheMeshes.push(z)):this._parseMesh(D,z),A.DataParser.GLUE_WEIGHTS in D&&A.DataParser.GLUE_MESHES in D&&(this._cacheRawMeshes.push(D),this._cacheMeshes.push(z));break;case 3:var W=this._parseBoundingBox(D);if(W!==null){var Z=k=A.BaseObject.borrowObject(A.BoundingBoxDisplayData);Z.name=I,Z.path=M.length>0?M:I,Z.boundingBox=W}break;case 4:var Q=D[A.DataParser.LENGTHS],ee=k=A.BaseObject.borrowObject(A.PathDisplayData);ee.closed=E._getBoolean(D,A.DataParser.CLOSED,!1),ee.constantSpeed=E._getBoolean(D,A.DataParser.CONSTANT_SPEED,!1),ee.name=I,ee.path=M.length>0?M:I,ee.vertices.data=this._data,ee.curveLengths.length=Q.length;for(var te=0,re=Q.length;te<re;++te)ee.curveLengths[te]=Q[te];this._parsePath(D,ee)}return k!==null&&A.DataParser.TRANSFORM in D&&this._parseTransform(D[A.DataParser.TRANSFORM],k.transform,this._armature.scale),k},E.prototype._parsePath=function(D,I){var M=D[A.DataParser.VERTICES],N=E._getNumber(D,A.DataParser.VERTEX_COUNT,0),k=this._floatArray.length,F=this._intArray.length;if(I.vertices.offset=F,this._intArray.length+=2,this._intArray[F+0]=N,this._intArray[F+2]=k,A.DataParser.WEIGHTS in D){var G=D[A.DataParser.WEIGHTS],V=D[A.DataParser.BONES],j=V.length,H=Math.floor(G.length-N)/2,U=this._intArray.length,X=this._floatArray.length,Y=this._armature.sortedBones,z=A.BaseObject.borrowObject(A.WeightData);for(z.count=H,z.offset=U,this._intArray.length+=2+j+N+H,this._intArray[U+0]=j,this._intArray[U+1]=X,le=0;le<j;le++){var W=V[le],Z=this._rawBones[W];z.addBone(Z),this._intArray[U+2+le]=Y.indexOf(Z)}this._floatArray.length+=3*H,le=0;for(var Q=0,ee=0,te=U+2+j,re=X;le<H;le++){var ie=G[Q++];this._intArray[te++]=ie;for(var ne=0;ne<ie;ne++){var he=G[Q++],pe=G[Q++],K=M[ee++],ue=M[ee++];this._intArray[te++]=V.indexOf(he),this._floatArray[re++]=pe,this._floatArray[re++]=K,this._floatArray[re++]=ue}}I.vertices.weight=z}else{this._floatArray.length+=M.length;for(var le=0,ce=M.length;le<ce;++le)this._floatArray[k+le]=M[le]}},E.prototype._parsePivot=function(D,I){if(A.DataParser.PIVOT in D){var M=D[A.DataParser.PIVOT];I.pivot.x=E._getNumber(M,A.DataParser.X,0),I.pivot.y=E._getNumber(M,A.DataParser.Y,0)}else I.pivot.x=.5,I.pivot.y=.5},E.prototype._parseMesh=function(D,I){var M=D[A.DataParser.VERTICES],N=D[A.DataParser.UVS],k=D[A.DataParser.TRIANGLES],F=Math.floor(M.length/2),G=Math.floor(k.length/3),V=this._floatArray.length,j=V+2*F,H=this._intArray.length,U=this._skin.name+"_"+this._slot.name+"_"+I.name;I.vertices.offset=H,this._intArray.length+=4+3*G,this._intArray[H+0]=F,this._intArray[H+1]=G,this._intArray[H+2]=V;for(var X=0,Y=3*G;X<Y;++X)this._intArray[H+4+X]=k[X];for(this._floatArray.length+=2*F+2*F,X=0,Y=2*F;X<Y;++X)this._floatArray[V+X]=M[X],this._floatArray[j+X]=N[X];if(A.DataParser.WEIGHTS in D){var z=D[A.DataParser.WEIGHTS],W=D[A.DataParser.SLOT_POSE],Z=D[A.DataParser.BONE_POSE],Q=this._armature.sortedBones,ee=new Array,te=Math.floor(Z.length/7),re=this._floatArray.length,ie=Math.floor(z.length-F)/2,ne=this._intArray.length,he=A.BaseObject.borrowObject(A.WeightData);for(he.count=ie,he.offset=ne,ee.length=te,this._intArray.length+=2+te+F+ie,this._intArray[ne+1]=re,X=0;X<te;++X){var pe=Z[7*X],K=this._rawBones[pe];he.addBone(K),ee[X]=pe,this._intArray[ne+2+X]=Q.indexOf(K)}this._floatArray.length+=3*ie,this._helpMatrixA.copyFromArray(W,0),X=0;for(var ue=0,le=ne+2+te,ce=re;X<F;++X){var _e=2*X,oe=this._intArray[le++]=z[ue++],de=this._floatArray[V+_e],me=this._floatArray[V+_e+1];this._helpMatrixA.transformPoint(de,me,this._helpPoint),de=this._helpPoint.x,me=this._helpPoint.y;for(var ye=0;ye<oe;++ye){pe=z[ue++];var ge=ee.indexOf(pe);this._helpMatrixB.copyFromArray(Z,7*ge+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(de,me,this._helpPoint),this._intArray[le++]=ge,this._floatArray[ce++]=z[ue++],this._floatArray[ce++]=this._helpPoint.x,this._floatArray[ce++]=this._helpPoint.y}}I.vertices.weight=he,this._weightSlotPose[U]=W,this._weightBonePoses[U]=Z}},E.prototype._parseMeshGlue=function(){},E.prototype._parseBoundingBox=function(D){var I=null,M=0;switch(M=A.DataParser.SUB_TYPE in D&&typeof D[A.DataParser.SUB_TYPE]=="string"?A.DataParser._getBoundingBoxType(D[A.DataParser.SUB_TYPE]):E._getNumber(D,A.DataParser.SUB_TYPE,M)){case 0:I=A.BaseObject.borrowObject(A.RectangleBoundingBoxData);break;case 1:I=A.BaseObject.borrowObject(A.EllipseBoundingBoxData);break;case 2:I=this._parsePolygonBoundingBox(D)}return I!==null&&(I.color=E._getNumber(D,A.DataParser.COLOR,0),I.type!==0&&I.type!==1||(I.width=E._getNumber(D,A.DataParser.WIDTH,0),I.height=E._getNumber(D,A.DataParser.HEIGHT,0))),I},E.prototype._parsePolygonBoundingBox=function(D){var I=A.BaseObject.borrowObject(A.PolygonBoundingBoxData);if(A.DataParser.VERTICES in D){var M=this._armature.scale,N=D[A.DataParser.VERTICES],k=I.vertices;A.DragonBones.webAssembly?k.resize(N.length,0):k.length=N.length;for(var F=0,G=N.length;F<G;F+=2){var V=N[F]*M,j=N[F+1]*M;A.DragonBones.webAssembly?(k.set(F,V),k.set(F+1,j)):(k[F]=V,k[F+1]=j),F===0?(I.x=V,I.y=j,I.width=V,I.height=j):(V<I.x?I.x=V:V>I.width&&(I.width=V),j<I.y?I.y=j:j>I.height&&(I.height=j))}I.width-=I.x,I.height-=I.y}else console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.");return I},E.prototype._parseAnimation=function(D){var I=A.BaseObject.borrowObject(A.AnimationData);if(I.frameCount=Math.max(E._getNumber(D,A.DataParser.DURATION,1),1),I.playTimes=E._getNumber(D,A.DataParser.PLAY_TIMES,1),I.duration=I.frameCount/this._armature.frameRate,I.fadeInTime=E._getNumber(D,A.DataParser.FADE_IN_TIME,0),I.scale=E._getNumber(D,A.DataParser.SCALE,1),I.name=E._getString(D,A.DataParser.NAME,A.DataParser.DEFAULT_NAME),I.name.length===0&&(I.name=A.DataParser.DEFAULT_NAME),I.frameIntOffset=this._frameIntArray.length,I.frameFloatOffset=this._frameFloatArray.length,I.frameOffset=this._frameArray.length,this._animation=I,A.DataParser.FRAME in D){var M=D[A.DataParser.FRAME],N=M.length;if(N>0)for(var k=0,F=0;k<N;++k){var G=M[k];this._parseActionDataInFrame(G,F,null,null),F+=E._getNumber(G,A.DataParser.DURATION,1)}}if(A.DataParser.Z_ORDER in D&&(this._animation.zOrderTimeline=this._parseTimeline(D[A.DataParser.Z_ORDER],null,A.DataParser.FRAME,1,!1,!1,0,this._parseZOrderFrame)),A.DataParser.BONE in D)for(var V=0,j=D[A.DataParser.BONE];V<j.length;V++){var H=j[V];this._parseBoneTimeline(H)}if(A.DataParser.SURFACE in D)for(var U=0,X=D[A.DataParser.SURFACE];U<X.length;U++){H=X[U];var Y=E._getString(H,A.DataParser.NAME,"");this._surface=this._armature.getBone(Y),this._surface!==null&&((le=this._parseTimeline(H,null,A.DataParser.FRAME,50,!1,!0,0,this._parseSurfaceFrame))!==null&&this._animation.addSurfaceTimeline(this._surface,le),this._surface=null)}if(A.DataParser.SLOT in D){for(var z=0,W=D[A.DataParser.SLOT];z<W.length;z++)H=W[z],this._parseSlotTimeline(H);this._actionFrames.sort(function(_e,oe){return _e.frameStart-oe.frameStart})}if(A.DataParser.FFD in D)for(var Z=0,Q=D[A.DataParser.FFD];Z<Q.length;Z++){H=Q[Z];var ee=E._getString(H,A.DataParser.SKIN,A.DataParser.DEFAULT_NAME),te=E._getString(H,A.DataParser.SLOT,""),re=E._getString(H,A.DataParser.NAME,"");ee.length===0&&(ee=A.DataParser.DEFAULT_NAME),this._slot=this._armature.getSlot(te),this._mesh=this._armature.getMesh(ee,te,re),this._slot!==null&&this._mesh!==null&&((le=this._parseTimeline(H,null,A.DataParser.FRAME,22,!1,!0,0,this._parseSlotFFDFrame))!==null&&this._animation.addSlotTimeline(this._slot,le),this._slot=null,this._mesh=null)}if(A.DataParser.IK in D)for(var ie=0,ne=D[A.DataParser.IK];ie<ne.length;ie++){H=ne[ie];var he=E._getString(H,A.DataParser.NAME,""),pe=this._armature.getConstraint(he);pe!==null&&(le=this._parseTimeline(H,null,A.DataParser.FRAME,30,!0,!1,2,this._parseIKConstraintFrame))!==null&&this._animation.addConstraintTimeline(pe,le)}if(A.DataParser.ANIMATION in D)for(var K=0,ue=D[A.DataParser.ANIMATION];K<ue.length;K++){H=ue[K];var le,ce=E._getString(H,A.DataParser.NAME,"");(le=this._parseTimeline(H,null,A.DataParser.FRAME,40,!0,!1,2,this._parseAnimationFrame))!==null&&this._animation.addAnimationTimeline(ce,le)}return this._actionFrames.length>0&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,!1,!1,0,this._parseActionFrame),this._actionFrames.length=0),this._animation=null,I},E.prototype._parseTimeline=function(D,I,M,N,k,F,G,V){if(D!==null&&M.length>0&&M in D&&(I=D[M]),I===null)return null;var j=I.length;if(j===0)return null;var H=this._frameIntArray.length,U=this._frameFloatArray.length,X=A.BaseObject.borrowObject(A.TimelineData),Y=this._timelineArray.length;if(this._timelineArray.length+=5+j,D!==null?(this._timelineArray[Y+0]=Math.round(100*E._getNumber(D,A.DataParser.SCALE,1)),this._timelineArray[Y+1]=Math.round(100*E._getNumber(D,A.DataParser.OFFSET,0))):(this._timelineArray[Y+0]=100,this._timelineArray[Y+1]=0),this._timelineArray[Y+2]=j,this._timelineArray[Y+3]=G,this._timelineArray[Y+4]=k?H-this._animation.frameIntOffset:F?U-this._animation.frameFloatOffset:0,this._timeline=X,X.type=N,X.offset=Y,j===1)X.frameIndicesOffset=-1,this._timelineArray[Y+5+0]=V.call(this,I[0],0,0)-this._animation.frameOffset;else{var z=this._animation.frameCount+1,W=this._data.frameIndices,Z=0;A.DragonBones.webAssembly?(Z=W.size(),W.resize(Z+z,0)):(Z=W.length,W.length+=z),X.frameIndicesOffset=Z;for(var Q=0,ee=0,te=0,re=0;Q<z;++Q){if(te+re<=Q&&ee<j){var ie=I[ee];te=Q,re=ee===j-1?this._animation.frameCount-te:ie instanceof R?this._actionFrames[ee+1].frameStart-te:E._getNumber(ie,A.DataParser.DURATION,1),this._timelineArray[Y+5+ee]=V.call(this,ie,te,re)-this._animation.frameOffset,ee++}A.DragonBones.webAssembly?W.set(Z+Q,ee-1):W[Z+Q]=ee-1}}return this._timeline=null,X},E.prototype._parseBoneTimeline=function(D){var I,M=this._armature.getBone(E._getString(D,A.DataParser.NAME,""));M!==null&&(this._bone=M,this._slot=this._armature.getSlot(this._bone.name),A.DataParser.TRANSLATE_FRAME in D&&(I=this._parseTimeline(D,null,A.DataParser.TRANSLATE_FRAME,11,!1,!0,2,this._parseBoneTranslateFrame))!==null&&this._animation.addBoneTimeline(M,I),A.DataParser.ROTATE_FRAME in D&&(I=this._parseTimeline(D,null,A.DataParser.ROTATE_FRAME,12,!1,!0,2,this._parseBoneRotateFrame))!==null&&this._animation.addBoneTimeline(M,I),A.DataParser.SCALE_FRAME in D&&(I=this._parseTimeline(D,null,A.DataParser.SCALE_FRAME,13,!1,!0,2,this._parseBoneScaleFrame))!==null&&this._animation.addBoneTimeline(M,I),A.DataParser.FRAME in D&&(I=this._parseTimeline(D,null,A.DataParser.FRAME,10,!1,!0,6,this._parseBoneAllFrame))!==null&&this._animation.addBoneTimeline(M,I),this._bone=null,this._slot=null)},E.prototype._parseSlotTimeline=function(D){var I=this._armature.getSlot(E._getString(D,A.DataParser.NAME,""));if(I!==null){this._slot=I;var M;(M=A.DataParser.DISPLAY_FRAME in D?this._parseTimeline(D,null,A.DataParser.DISPLAY_FRAME,20,!1,!1,0,this._parseSlotDisplayFrame):this._parseTimeline(D,null,A.DataParser.FRAME,20,!1,!1,0,this._parseSlotDisplayFrame))!==null&&this._animation.addSlotTimeline(I,M);var N;(N=A.DataParser.COLOR_FRAME in D?this._parseTimeline(D,null,A.DataParser.COLOR_FRAME,21,!0,!1,1,this._parseSlotColorFrame):this._parseTimeline(D,null,A.DataParser.FRAME,21,!0,!1,1,this._parseSlotColorFrame))!==null&&this._animation.addSlotTimeline(I,N),this._slot=null}},E.prototype._parseFrame=function(D,I){var M=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[M+0]=I,M},E.prototype._parseTweenFrame=function(D,I,M){var N=this._parseFrame(D,I,M);if(M>0)if(A.DataParser.CURVE in D){var k=M+1;this._helpArray.length=k,this._samplingEasingCurve(D[A.DataParser.CURVE],this._helpArray),this._frameArray.length+=2+this._helpArray.length,this._frameArray[N+1]=2,this._frameArray[N+2]=k;for(var F=0;F<k;++F)this._frameArray[N+3+F]=Math.round(1e4*this._helpArray[F])}else{var G=-2;A.DataParser.TWEEN_EASING in D&&(G=E._getNumber(D,A.DataParser.TWEEN_EASING,-2)),G===-2?(this._frameArray.length+=1,this._frameArray[N+1]=0):G===0?(this._frameArray.length+=1,this._frameArray[N+1]=1):G<0?(this._frameArray.length+=2,this._frameArray[N+1]=3,this._frameArray[N+2]=Math.round(100*-G)):G<=1?(this._frameArray.length+=2,this._frameArray[N+1]=4,this._frameArray[N+2]=Math.round(100*G)):(this._frameArray.length+=2,this._frameArray[N+1]=5,this._frameArray[N+2]=Math.round(100*G-100))}else this._frameArray.length+=1,this._frameArray[N+1]=0;return N},E.prototype._parseActionFrame=function(D,I){var M=this._frameArray.length,N=D.actions.length;this._frameArray.length+=2+N,this._frameArray[M+0]=I,this._frameArray[M+0+1]=N;for(var k=0;k<N;++k)this._frameArray[M+0+2+k]=D.actions[k];return M},E.prototype._parseZOrderFrame=function(D,I,M){var N=this._parseFrame(D,I,M);if(A.DataParser.Z_ORDER in D){var k=D[A.DataParser.Z_ORDER];if(k.length>0){for(var F=this._armature.sortedSlots.length,G=new Array(F-k.length/2),V=new Array(F),j=0;j<G.length;++j)G[j]=0;for(var H=0;H<F;++H)V[H]=-1;for(var U=0,X=0,Y=0,z=k.length;Y<z;Y+=2){for(var W=k[Y],Z=k[Y+1];U!==W;)G[X++]=U++;V[U+Z]=U++}for(;U<F;)G[X++]=U++;this._frameArray.length+=1+F,this._frameArray[N+1]=F;for(var Q=F;Q--;)V[Q]===-1?this._frameArray[N+2+Q]=G[--X]||0:this._frameArray[N+2+Q]=V[Q]||0;return N}}return this._frameArray.length+=1,this._frameArray[N+1]=0,N},E.prototype._parseBoneAllFrame=function(D,I,M){this._helpTransform.identity(),A.DataParser.TRANSFORM in D&&this._parseTransform(D[A.DataParser.TRANSFORM],this._helpTransform,1);var N=this._helpTransform.rotation;I!==0&&(this._prevClockwise===0?N=this._prevRotation+A.Transform.normalizeRadian(N-this._prevRotation):((this._prevClockwise>0?N>=this._prevRotation:N<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),N=this._prevRotation+N-this._prevRotation+A.Transform.PI_D*this._prevClockwise)),this._prevClockwise=E._getNumber(D,A.DataParser.TWEEN_ROTATE,0),this._prevRotation=N;var k=this._parseTweenFrame(D,I,M),F=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[F++]=this._helpTransform.x,this._frameFloatArray[F++]=this._helpTransform.y,this._frameFloatArray[F++]=N,this._frameFloatArray[F++]=this._helpTransform.skew,this._frameFloatArray[F++]=this._helpTransform.scaleX,this._frameFloatArray[F++]=this._helpTransform.scaleY,this._parseActionDataInFrame(D,I,this._bone,this._slot),k},E.prototype._parseBoneTranslateFrame=function(D,I,M){var N=this._parseTweenFrame(D,I,M),k=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[k++]=E._getNumber(D,A.DataParser.X,0),this._frameFloatArray[k++]=E._getNumber(D,A.DataParser.Y,0),N},E.prototype._parseBoneRotateFrame=function(D,I,M){var N=E._getNumber(D,A.DataParser.ROTATE,0)*A.Transform.DEG_RAD;I!==0&&(this._prevClockwise===0?N=this._prevRotation+A.Transform.normalizeRadian(N-this._prevRotation):((this._prevClockwise>0?N>=this._prevRotation:N<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),N=this._prevRotation+N-this._prevRotation+A.Transform.PI_D*this._prevClockwise)),this._prevClockwise=E._getNumber(D,A.DataParser.CLOCK_WISE,0),this._prevRotation=N;var k=this._parseTweenFrame(D,I,M),F=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[F++]=N,this._frameFloatArray[F++]=E._getNumber(D,A.DataParser.SKEW,0)*A.Transform.DEG_RAD,k},E.prototype._parseBoneScaleFrame=function(D,I,M){var N=this._parseTweenFrame(D,I,M),k=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[k++]=E._getNumber(D,A.DataParser.X,1),this._frameFloatArray[k++]=E._getNumber(D,A.DataParser.Y,1),N},E.prototype._parseSurfaceFrame=function(D,I,M){var N=this._frameFloatArray.length,k=this._parseTweenFrame(D,I,M),F=D[A.DataParser.VERTICES],G=E._getNumber(D,A.DataParser.OFFSET,0),V=this._surface.vertices.length/2,j=0,H=0;this._frameFloatArray.length+=2*V;for(var U=0;U<2*V;U+=2)j=U<G||U-G>=F.length?0:F[U-G],H=U+1<G||U+1-G>=F.length?0:F[U+1-G],this._frameFloatArray[N+U]=j,this._frameFloatArray[N+U+1]=H;if(I===0){var X=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[X+0]=0,this._frameIntArray[X+1]=this._frameFloatArray.length-N,this._frameIntArray[X+2]=this._frameFloatArray.length-N,this._frameIntArray[X+3]=0,this._frameIntArray[X+4]=N-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=X-this._animation.frameIntOffset}return k},E.prototype._parseSlotDisplayFrame=function(D,I,M){var N=this._parseFrame(D,I,M);return this._frameArray.length+=1,A.DataParser.VALUE in D?this._frameArray[N+1]=E._getNumber(D,A.DataParser.VALUE,0):this._frameArray[N+1]=E._getNumber(D,A.DataParser.DISPLAY_INDEX,0),this._parseActionDataInFrame(D,I,this._slot.parent,this._slot),N},E.prototype._parseSlotColorFrame=function(D,I,M){var N=this._parseTweenFrame(D,I,M),k=-1;if(A.DataParser.VALUE in D||A.DataParser.COLOR in D){var F=A.DataParser.VALUE in D?D[A.DataParser.VALUE]:D[A.DataParser.COLOR];for(var G in F){this._parseColorTransform(F,this._helpColorTransform),k=this._intArray.length,this._intArray.length+=8,this._intArray[k++]=Math.round(100*this._helpColorTransform.alphaMultiplier),this._intArray[k++]=Math.round(100*this._helpColorTransform.redMultiplier),this._intArray[k++]=Math.round(100*this._helpColorTransform.greenMultiplier),this._intArray[k++]=Math.round(100*this._helpColorTransform.blueMultiplier),this._intArray[k++]=Math.round(this._helpColorTransform.alphaOffset),this._intArray[k++]=Math.round(this._helpColorTransform.redOffset),this._intArray[k++]=Math.round(this._helpColorTransform.greenOffset),this._intArray[k++]=Math.round(this._helpColorTransform.blueOffset),k-=8;break}}k<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=k=this._intArray.length,this._intArray.length+=8,this._intArray[k++]=100,this._intArray[k++]=100,this._intArray[k++]=100,this._intArray[k++]=100,this._intArray[k++]=0,this._intArray[k++]=0,this._intArray[k++]=0,this._intArray[k++]=0),k=this._defaultColorOffset);var V=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[V]=k,N},E.prototype._parseSlotFFDFrame=function(D,I,M){var N=this._frameFloatArray.length,k=this._parseTweenFrame(D,I,M),F=A.DataParser.VERTICES in D?D[A.DataParser.VERTICES]:null,G=E._getNumber(D,A.DataParser.OFFSET,0),V=this._intArray[this._mesh.vertices.offset+0],j=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,H=this._mesh.vertices.weight,U=0,X=0,Y=0,z=0;if(H!==null){var W=this._weightSlotPose[j];this._helpMatrixA.copyFromArray(W,0),this._frameFloatArray.length+=2*H.count,Y=H.offset+2+H.bones.length}else this._frameFloatArray.length+=2*V;for(var Z=0;Z<2*V;Z+=2)if(F===null?(U=0,X=0):(U=Z<G||Z-G>=F.length?0:F[Z-G],X=Z+1<G||Z+1-G>=F.length?0:F[Z+1-G]),H!==null){var Q=this._weightBonePoses[j],ee=this._intArray[Y++];this._helpMatrixA.transformPoint(U,X,this._helpPoint,!0),U=this._helpPoint.x,X=this._helpPoint.y;for(var te=0;te<ee;++te){var re=this._intArray[Y++];this._helpMatrixB.copyFromArray(Q,7*re+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(U,X,this._helpPoint,!0),this._frameFloatArray[N+z++]=this._helpPoint.x,this._frameFloatArray[N+z++]=this._helpPoint.y}}else this._frameFloatArray[N+Z]=U,this._frameFloatArray[N+Z+1]=X;if(I===0){var ie=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[ie+0]=this._mesh.vertices.offset,this._frameIntArray[ie+1]=this._frameFloatArray.length-N,this._frameIntArray[ie+2]=this._frameFloatArray.length-N,this._frameIntArray[ie+3]=0,this._frameIntArray[ie+4]=N-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=ie-this._animation.frameIntOffset}return k},E.prototype._parseIKConstraintFrame=function(D,I,M){var N=this._parseTweenFrame(D,I,M),k=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[k++]=E._getBoolean(D,A.DataParser.BEND_POSITIVE,!0)?1:0,this._frameIntArray[k++]=Math.round(100*E._getNumber(D,A.DataParser.WEIGHT,1)),N},E.prototype._parseAnimationFrame=function(D,I,M){var N=this._parseTweenFrame(D,I,M),k=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[k++]=E._getNumber(D,A.DataParser.VALUE,0),this._frameIntArray[k++]=Math.round(100*E._getNumber(D,A.DataParser.WEIGHT,1)),N},E.prototype._parseActionData=function(D,I,M,N){var k=new Array;if(typeof D=="string")(j=A.BaseObject.borrowObject(A.ActionData)).type=I,j.name=D,j.bone=M,j.slot=N,k.push(j);else if(D instanceof Array)for(var F=0,G=D;F<G.length;F++){var V=G[F],j=A.BaseObject.borrowObject(A.ActionData);if(A.DataParser.GOTO_AND_PLAY in V?(j.type=0,j.name=E._getString(V,A.DataParser.GOTO_AND_PLAY,"")):(A.DataParser.TYPE in V&&typeof V[A.DataParser.TYPE]=="string"?j.type=A.DataParser._getActionType(V[A.DataParser.TYPE]):j.type=E._getNumber(V,A.DataParser.TYPE,I),j.name=E._getString(V,A.DataParser.NAME,"")),A.DataParser.BONE in V){var H=E._getString(V,A.DataParser.BONE,"");j.bone=this._armature.getBone(H)}else j.bone=M;if(A.DataParser.SLOT in V){var U=E._getString(V,A.DataParser.SLOT,"");j.slot=this._armature.getSlot(U)}else j.slot=N;var X=null;if(A.DataParser.INTS in V){X===null&&(X=A.BaseObject.borrowObject(A.UserData));for(var Y=0,z=V[A.DataParser.INTS];Y<z.length;Y++){var W=z[Y];X.addInt(W)}}if(A.DataParser.FLOATS in V){X===null&&(X=A.BaseObject.borrowObject(A.UserData));for(var Z=0,Q=V[A.DataParser.FLOATS];Z<Q.length;Z++)W=Q[Z],X.addFloat(W)}if(A.DataParser.STRINGS in V){X===null&&(X=A.BaseObject.borrowObject(A.UserData));for(var ee=0,te=V[A.DataParser.STRINGS];ee<te.length;ee++)W=te[ee],X.addString(W)}j.data=X,k.push(j)}return k},E.prototype._parseTransform=function(D,I,M){I.x=E._getNumber(D,A.DataParser.X,0)*M,I.y=E._getNumber(D,A.DataParser.Y,0)*M,A.DataParser.ROTATE in D||A.DataParser.SKEW in D?(I.rotation=A.Transform.normalizeRadian(E._getNumber(D,A.DataParser.ROTATE,0)*A.Transform.DEG_RAD),I.skew=A.Transform.normalizeRadian(E._getNumber(D,A.DataParser.SKEW,0)*A.Transform.DEG_RAD)):(A.DataParser.SKEW_X in D||A.DataParser.SKEW_Y in D)&&(I.rotation=A.Transform.normalizeRadian(E._getNumber(D,A.DataParser.SKEW_Y,0)*A.Transform.DEG_RAD),I.skew=A.Transform.normalizeRadian(E._getNumber(D,A.DataParser.SKEW_X,0)*A.Transform.DEG_RAD)-I.rotation),I.scaleX=E._getNumber(D,A.DataParser.SCALE_X,1),I.scaleY=E._getNumber(D,A.DataParser.SCALE_Y,1)},E.prototype._parseColorTransform=function(D,I){I.alphaMultiplier=.01*E._getNumber(D,A.DataParser.ALPHA_MULTIPLIER,100),I.redMultiplier=.01*E._getNumber(D,A.DataParser.RED_MULTIPLIER,100),I.greenMultiplier=.01*E._getNumber(D,A.DataParser.GREEN_MULTIPLIER,100),I.blueMultiplier=.01*E._getNumber(D,A.DataParser.BLUE_MULTIPLIER,100),I.alphaOffset=E._getNumber(D,A.DataParser.ALPHA_OFFSET,0),I.redOffset=E._getNumber(D,A.DataParser.RED_OFFSET,0),I.greenOffset=E._getNumber(D,A.DataParser.GREEN_OFFSET,0),I.blueOffset=E._getNumber(D,A.DataParser.BLUE_OFFSET,0)},E.prototype._parseArray=function(){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0},E.prototype._modifyArray=function(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!=0&&this._timelineArray.push(0);var D=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,I=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,M=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,N=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,k=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,F=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,G=D+I+M+N+k+F;if(A.DragonBones.webAssembly){for(var V=A.webAssemblyModule.HEAP16.buffer,j=A.webAssemblyModule._malloc(G),H=new Int16Array(V,j,this._intArray.length),U=new Float32Array(V,j+D,this._floatArray.length),X=new Int16Array(V,j+D+I,this._frameIntArray.length),Y=new Float32Array(V,j+D+I+M,this._frameFloatArray.length),z=new Int16Array(V,j+D+I+M+N,this._frameArray.length),W=new Uint16Array(V,j+D+I+M+N+k,this._timelineArray.length),Z=0,Q=this._intArray.length;Z<Q;++Z)H[Z]=this._intArray[Z];for(Z=0,Q=this._floatArray.length;Z<Q;++Z)U[Z]=this._floatArray[Z];for(Z=0,Q=this._frameIntArray.length;Z<Q;++Z)X[Z]=this._frameIntArray[Z];for(Z=0,Q=this._frameFloatArray.length;Z<Q;++Z)Y[Z]=this._frameFloatArray[Z];for(Z=0,Q=this._frameArray.length;Z<Q;++Z)z[Z]=this._frameArray[Z];for(Z=0,Q=this._timelineArray.length;Z<Q;++Z)W[Z]=this._timelineArray[Z];A.webAssemblyModule.setDataBinary(this._data,j,D,I,M,N,k,F)}else{var ee=new ArrayBuffer(G);for(H=new Int16Array(ee,0,this._intArray.length),U=new Float32Array(ee,D,this._floatArray.length),X=new Int16Array(ee,D+I,this._frameIntArray.length),Y=new Float32Array(ee,D+I+M,this._frameFloatArray.length),z=new Int16Array(ee,D+I+M+N,this._frameArray.length),W=new Uint16Array(ee,D+I+M+N+k,this._timelineArray.length),Z=0,Q=this._intArray.length;Z<Q;++Z)H[Z]=this._intArray[Z];for(Z=0,Q=this._floatArray.length;Z<Q;++Z)U[Z]=this._floatArray[Z];for(Z=0,Q=this._frameIntArray.length;Z<Q;++Z)X[Z]=this._frameIntArray[Z];for(Z=0,Q=this._frameFloatArray.length;Z<Q;++Z)Y[Z]=this._frameFloatArray[Z];for(Z=0,Q=this._frameArray.length;Z<Q;++Z)z[Z]=this._frameArray[Z];for(Z=0,Q=this._timelineArray.length;Z<Q;++Z)W[Z]=this._timelineArray[Z];this._data.binary=ee,this._data.intArray=H,this._data.floatArray=U,this._data.frameIntArray=X,this._data.frameFloatArray=Y,this._data.frameArray=z,this._data.timelineArray=W}this._defaultColorOffset=-1},E.prototype.parseDragonBonesData=function(D,I){I===void 0&&(I=1),console.assert(D!=null,"Data error.");var M=E._getString(D,A.DataParser.VERSION,""),N=E._getString(D,A.DataParser.COMPATIBLE_VERSION,"");if(A.DataParser.DATA_VERSIONS.indexOf(M)>=0||A.DataParser.DATA_VERSIONS.indexOf(N)>=0){var k=A.BaseObject.borrowObject(A.DragonBonesData);if(k.version=M,k.name=E._getString(D,A.DataParser.NAME,""),k.frameRate=E._getNumber(D,A.DataParser.FRAME_RATE,24),k.frameRate===0&&(k.frameRate=24),A.DataParser.ARMATURE in D){this._data=k,this._parseArray(D);for(var F=0,G=D[A.DataParser.ARMATURE];F<G.length;F++){var V=G[F];k.addArmature(this._parseArmature(V,I))}this._data.binary||this._modifyArray(),A.DataParser.STAGE in D?k.stage=k.getArmature(E._getString(D,A.DataParser.STAGE,"")):k.armatureNames.length>0&&(k.stage=k.getArmature(k.armatureNames[0])),this._data=null}return A.DataParser.TEXTURE_ATLAS in D&&(this._rawTextureAtlases=D[A.DataParser.TEXTURE_ATLAS]),k}return console.assert(!1,"Nonsupport data version: "+M+"\nPlease convert DragonBones data to support version.\nRead more: https://github.com/DragonBones/Tools/"),null},E.prototype.parseTextureAtlasData=function(D,I,M){if(M===void 0&&(M=1),console.assert(D!==void 0),D===null){if(this._rawTextureAtlases===null||this._rawTextureAtlases.length===0)return!1;var N=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(N,I,M),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(I.width=E._getNumber(D,A.DataParser.WIDTH,0),I.height=E._getNumber(D,A.DataParser.HEIGHT,0),I.scale=M===1?1/E._getNumber(D,A.DataParser.SCALE,1):M,I.name=E._getString(D,A.DataParser.NAME,""),I.imagePath=E._getString(D,A.DataParser.IMAGE_PATH,""),A.DataParser.SUB_TEXTURE in D)for(var k=D[A.DataParser.SUB_TEXTURE],F=0,G=k.length;F<G;++F){var V=k[F],j=I.createTexture();j.rotated=E._getBoolean(V,A.DataParser.ROTATED,!1),j.name=E._getString(V,A.DataParser.NAME,""),j.region.x=E._getNumber(V,A.DataParser.X,0),j.region.y=E._getNumber(V,A.DataParser.Y,0),j.region.width=E._getNumber(V,A.DataParser.WIDTH,0),j.region.height=E._getNumber(V,A.DataParser.HEIGHT,0);var H=E._getNumber(V,A.DataParser.FRAME_WIDTH,-1),U=E._getNumber(V,A.DataParser.FRAME_HEIGHT,-1);H>0&&U>0&&(j.frame=A.TextureData.createRectangle(),j.frame.x=E._getNumber(V,A.DataParser.FRAME_X,0),j.frame.y=E._getNumber(V,A.DataParser.FRAME_Y,0),j.frame.width=H,j.frame.height=U),I.addTexture(j)}return!0},E.getInstance=function(){return E._objectDataParserInstance===null&&(E._objectDataParserInstance=new E),E._objectDataParserInstance},E._objectDataParserInstance=null,E}(A.DataParser);A.ObjectDataParser=O;var R=function(){this.frameStart=0,this.actions=[]};A.ActionFrame=R}(w||(w={})),function(A){var O=function(R){function P(){return R!==null&&R.apply(this,arguments)||this}return B(P,R),P.prototype._inRange=function(E,D,I){return D<=E&&E<=I},P.prototype._decodeUTF8=function(E){for(var D,I=0,M="",N=0,k=0,F=0,G=0;E.length>I;){var V=E[I++];if(V===-1)D=k!==0?65533:-1;else if(k===0)this._inRange(V,0,127)?D=V:(this._inRange(V,194,223)?(k=1,G=128,N=V-192):this._inRange(V,224,239)?(k=2,G=2048,N=V-224):this._inRange(V,240,244)&&(k=3,G=65536,N=V-240),N*=Math.pow(64,k),D=null);else if(this._inRange(V,128,191))if(F+=1,N+=(V-128)*Math.pow(64,k-F),F!==k)D=null;else{var j=N,H=G;N=0,k=0,F=0,G=0,D=this._inRange(j,H,1114111)&&!this._inRange(j,55296,57343)?j:V}else N=0,k=0,F=0,G=0,I--,D=V;D!==null&&D!==-1&&(D<=65535?D>0&&(M+=String.fromCharCode(D)):(D-=65536,M+=String.fromCharCode(55296+(D>>10&1023)),M+=String.fromCharCode(56320+(1023&D))))}return M},P.prototype._getUTF16Key=function(E){for(var D=0,I=E.length;D<I;++D)if(E.charCodeAt(D)>255)return encodeURI(E);return E},P.prototype._parseBinaryTimeline=function(E,D,I){I===void 0&&(I=null);var M=I!==null?I:A.BaseObject.borrowObject(A.TimelineData);M.type=E,M.offset=D,this._timeline=M;var N=this._timelineArrayBuffer[M.offset+2];if(N===1)M.frameIndicesOffset=-1;else{var k=0,F=this._animation.frameCount+1,G=this._data.frameIndices;A.DragonBones.webAssembly?(k=G.size(),G.resize(k+F,0)):(k=G.length,G.length+=F),M.frameIndicesOffset=k;for(var V=0,j=0,H=0,U=0;V<F;++V)H+U<=V&&j<N&&(H=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[M.offset+5+j]],U=j===N-1?this._animation.frameCount-H:this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[M.offset+5+j+1]]-H,j++),A.DragonBones.webAssembly?G.set(k+V,j-1):G[k+V]=j-1}return this._timeline=null,M},P.prototype._parseVertices=function(E,D){D.offset=E[A.DataParser.OFFSET];var I=this._intArrayBuffer[D.offset+3];if(I>=0){var M=A.BaseObject.borrowObject(A.WeightData),N=this._intArrayBuffer[D.offset+0],k=this._intArrayBuffer[I+0];M.offset=I;for(var F=0;F<k;++F){var G=this._intArrayBuffer[I+2+F];M.addBone(this._rawBones[G])}for(var V=I+2+k,j=0,H=(F=0,N);F<H;++F){var U=this._intArrayBuffer[V++];j+=U,V+=U}M.count=j,D.weight=M}},P.prototype._parseMesh=function(E,D){this._parseVertices(E,D.vertices)},P.prototype._parsePath=function(E,D){this._parseVertices(E,D.vertices)},P.prototype._parseAnimation=function(E){var D=A.BaseObject.borrowObject(A.AnimationData);D.frameCount=Math.max(A.ObjectDataParser._getNumber(E,A.DataParser.DURATION,1),1),D.playTimes=A.ObjectDataParser._getNumber(E,A.DataParser.PLAY_TIMES,1),D.duration=D.frameCount/this._armature.frameRate,D.fadeInTime=A.ObjectDataParser._getNumber(E,A.DataParser.FADE_IN_TIME,0),D.scale=A.ObjectDataParser._getNumber(E,A.DataParser.SCALE,1),D.name=A.ObjectDataParser._getString(E,A.DataParser.NAME,A.DataParser.DEFAULT_NAME),D.name.length===0&&(D.name=A.DataParser.DEFAULT_NAME);var I=E[A.DataParser.OFFSET];if(D.frameIntOffset=I[0],D.frameFloatOffset=I[1],D.frameOffset=I[2],this._animation=D,A.DataParser.ACTION in E&&(D.actionTimeline=this._parseBinaryTimeline(0,E[A.DataParser.ACTION])),A.DataParser.Z_ORDER in E&&(D.zOrderTimeline=this._parseBinaryTimeline(1,E[A.DataParser.Z_ORDER])),A.DataParser.BONE in E){var M=E[A.DataParser.BONE];for(var N in M){var k=M[N];A.DragonBones.webAssembly&&(N=this._getUTF16Key(N));var F=this._armature.getBone(N);if(F!==null)for(var G=0,V=k.length;G<V;G+=2){var j=k[G],H=k[G+1],U=this._parseBinaryTimeline(j,H);this._animation.addBoneTimeline(F,U)}}}if(A.DataParser.SURFACE in E)for(var N in M=E[A.DataParser.SURFACE]){k=M[N],A.DragonBones.webAssembly&&(N=this._getUTF16Key(N));var X=this._armature.getBone(N);if(X!==null)for(G=0,V=k.length;G<V;G+=2)j=k[G],H=k[G+1],U=this._parseBinaryTimeline(j,H),this._animation.addSurfaceTimeline(X,U)}if(A.DataParser.SLOT in E)for(var N in M=E[A.DataParser.SLOT]){k=M[N],A.DragonBones.webAssembly&&(N=this._getUTF16Key(N));var Y=this._armature.getSlot(N);if(Y!==null)for(G=0,V=k.length;G<V;G+=2)j=k[G],H=k[G+1],U=this._parseBinaryTimeline(j,H),this._animation.addSlotTimeline(Y,U)}if(A.DataParser.CONSTRAINT in E)for(var N in M=E[A.DataParser.CONSTRAINT]){k=M[N],A.DragonBones.webAssembly&&(N=this._getUTF16Key(N));var z=this._armature.getConstraint(N);if(z!==null)for(G=0,V=k.length;G<V;G+=2)j=k[G],H=k[G+1],U=this._parseBinaryTimeline(j,H),this._animation.addConstraintTimeline(z,U)}if(A.DataParser.ANIMATION in E)for(var N in M=E[A.DataParser.ANIMATION])for(k=M[N],A.DragonBones.webAssembly&&(N=this._getUTF16Key(N)),G=0,V=k.length;G<V;G+=2)j=k[G],H=k[G+1],U=this._parseBinaryTimeline(j,H),this._animation.addAnimationTimeline(N,U);return this._animation=null,D},P.prototype._parseArray=function(E){var D=E[A.DataParser.OFFSET],I=D[1],M=D[3],N=D[5],k=D[7],F=D[9],G=D[11],V=new Int16Array(this._binary,this._binaryOffset+D[0],I/Int16Array.BYTES_PER_ELEMENT),j=new Float32Array(this._binary,this._binaryOffset+D[2],M/Float32Array.BYTES_PER_ELEMENT),H=new Int16Array(this._binary,this._binaryOffset+D[4],N/Int16Array.BYTES_PER_ELEMENT),U=new Float32Array(this._binary,this._binaryOffset+D[6],k/Float32Array.BYTES_PER_ELEMENT),X=new Int16Array(this._binary,this._binaryOffset+D[8],F/Int16Array.BYTES_PER_ELEMENT),Y=new Uint16Array(this._binary,this._binaryOffset+D[10],G/Uint16Array.BYTES_PER_ELEMENT);if(A.DragonBones.webAssembly){for(var z=I+M+N+k+F+G,W=A.webAssemblyModule._malloc(z),Z=new Uint8Array(this._binary,this._binaryOffset,z/Uint8Array.BYTES_PER_ELEMENT),Q=new Uint8Array(A.webAssemblyModule.HEAP16.buffer,W,Z.length),ee=0,te=Z.length;ee<te;++ee)Q[ee]=Z[ee];A.webAssemblyModule.setDataBinary(this._data,W,I,M,N,k,F,G),this._intArrayBuffer=V,this._floatArrayBuffer=j,this._frameIntArrayBuffer=H,this._frameFloatArrayBuffer=U,this._frameArrayBuffer=X,this._timelineArrayBuffer=Y}else this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=V,this._data.floatArray=this._floatArrayBuffer=j,this._data.frameIntArray=this._frameIntArrayBuffer=H,this._data.frameFloatArray=this._frameFloatArrayBuffer=U,this._data.frameArray=this._frameArrayBuffer=X,this._data.timelineArray=this._timelineArrayBuffer=Y},P.prototype.parseDragonBonesData=function(E,D){D===void 0&&(D=1),console.assert(E!=null&&E instanceof ArrayBuffer,"Data error.");var I=new Uint8Array(E,0,8);if(I[0]!==68||I[1]!==66||I[2]!==68||I[3]!==84)return console.assert(!1,"Nonsupport data."),null;var M=new Uint32Array(E,8,1)[0],N=new Uint8Array(E,12,M),k=this._decodeUTF8(N),F=JSON.parse(k);return this._binaryOffset=12+M,this._binary=E,R.prototype.parseDragonBonesData.call(this,F,D)},P.getInstance=function(){return P._binaryDataParserInstance===null&&(P._binaryDataParserInstance=new P),P._binaryDataParserInstance},P._binaryDataParserInstance=null,P}(A.ObjectDataParser);A.BinaryDataParser=O}(w||(w={})),function(A){var O=function(){function P(E){E===void 0&&(E=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,this._dataParser=null,P._objectParser===null&&(P._objectParser=new A.ObjectDataParser),P._binaryParser===null&&(P._binaryParser=new A.BinaryDataParser),this._dataParser=E!==null?E:P._objectParser}return P.prototype._isSupportMesh=function(){return!0},P.prototype._getTextureData=function(E,D){if(E in this._textureAtlasDataMap){for(var I=0,M=this._textureAtlasDataMap[E];I<M.length;I++)if((V=(G=M[I]).getTexture(D))!==null)return V}if(this.autoSearch)for(var N in this._textureAtlasDataMap)for(var k=0,F=this._textureAtlasDataMap[N];k<F.length;k++){var G,V;if((G=F[k]).autoSearch&&(V=G.getTexture(D))!==null)return V}return null},P.prototype._fillBuildArmaturePackage=function(E,D,I,M,N){var k=null,F=null;if(D.length>0&&D in this._dragonBonesDataMap&&(F=(k=this._dragonBonesDataMap[D]).getArmature(I)),F===null&&(D.length===0||this.autoSearch)){for(var G in this._dragonBonesDataMap)if(k=this._dragonBonesDataMap[G],(D.length===0||k.autoSearch)&&(F=k.getArmature(I))!==null){D=G;break}}if(F!==null){if(E.dataName=D,E.textureAtlasName=N,E.data=k,E.armature=F,E.skin=null,M.length>0&&(E.skin=F.getSkin(M),E.skin===null&&this.autoSearch))for(var G in this._dragonBonesDataMap){var V=this._dragonBonesDataMap[G].getArmature(M);if(V!==null){E.skin=V.defaultSkin;break}}return E.skin===null&&(E.skin=F.defaultSkin),!0}return!1},P.prototype._buildBones=function(E,D){for(var I=0,M=E.armature.sortedBones;I<M.length;I++){var N=M[I];A.BaseObject.borrowObject(N.type===0?A.Bone:A.Surface).init(N,D)}},P.prototype._buildSlots=function(E,D){var I=E.skin,M=E.armature.defaultSkin;if(I!==null&&M!==null){var N={};for(var k in M.displays){var F=M.getDisplays(k);N[k]=F}if(I!==M)for(var k in I.displays)F=I.getDisplays(k),N[k]=F;for(var G=0,V=E.armature.sortedSlots;G<V.length;G++){var j=V[G],H=j.name in N?N[j.name]:null,U=this._buildSlot(E,j,D);if(U.rawDisplayDatas=H,H!==null){for(var X=new Array,Y=0,z=A.DragonBones.webAssembly?H.size():H.length;Y<z;++Y){var W=A.DragonBones.webAssembly?H.get(Y):H[Y];W!==null?X.push(this._getSlotDisplay(E,W,null,U)):X.push(null)}U._setDisplayList(X)}U._setDisplayIndex(j.displayIndex,!0)}}},P.prototype._buildConstraints=function(E,D){var I=E.armature.constraints;for(var M in I){var N=I[M];switch(N.type){case 0:var k=A.BaseObject.borrowObject(A.IKConstraint);k.init(N,D),D._addConstraint(k);break;case 1:var F=A.BaseObject.borrowObject(A.PathConstraint);F.init(N,D),D._addConstraint(F);break;default:var G=A.BaseObject.borrowObject(A.IKConstraint);G.init(N,D),D._addConstraint(G)}}},P.prototype._buildChildArmature=function(E,D,I){return this.buildArmature(I.path,E!==null?E.dataName:"","",E!==null?E.textureAtlasName:"")},P.prototype._getSlotDisplay=function(E,D,I,M){var N=E!==null?E.dataName:D.parent.parent.parent.name,k=null;switch(D.type){case 0:var F=D;E!==null&&E.textureAtlasName.length>0&&(F.texture=this._getTextureData(E.textureAtlasName,D.path)),F.texture===null&&(F.texture=this._getTextureData(N,D.path)),k=I!==null&&I.type===2&&this._isSupportMesh()?M.meshDisplay:M.rawDisplay;break;case 2:var G=D;E!==null&&E.textureAtlasName.length>0&&(G.texture=this._getTextureData(E.textureAtlasName,G.path)),G.texture===null&&(G.texture=this._getTextureData(N,G.path)),k=this._isSupportMesh()?M.meshDisplay:M.rawDisplay;break;case 1:var V=D,j=this._buildChildArmature(E,M,D);if(j!==null){if(j.inheritAnimation=V.inheritAnimation,!j.inheritAnimation){var H=V.actions.length>0?V.actions:j.armatureData.defaultActions;if(H.length>0)for(var U=0,X=H;U<X.length;U++){var Y=X[U],z=A.BaseObject.borrowObject(A.EventObject);A.EventObject.actionDataToInstance(Y,z,M.armature),z.slot=M,M.armature._bufferAction(z,!1)}else j.animation.play()}V.armature=j.armatureData}k=j}return k},P.prototype.parseDragonBonesData=function(E,D,I){D===void 0&&(D=null),I===void 0&&(I=1);for(var M=E instanceof ArrayBuffer?P._binaryParser:this._dataParser,N=M.parseDragonBonesData(E,I);;){var k=this._buildTextureAtlasData(null,null);if(!M.parseTextureAtlasData(null,k,I)){k.returnToPool();break}this.addTextureAtlasData(k,D)}return N!==null&&this.addDragonBonesData(N,D),N},P.prototype.parseTextureAtlasData=function(E,D,I,M){I===void 0&&(I=null),M===void 0&&(M=1);var N=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(E,N,M),this._buildTextureAtlasData(N,D||null),this.addTextureAtlasData(N,I),N},P.prototype.updateTextureAtlasData=function(E,D){var I=this.getTextureAtlasData(E);if(I!==null)for(var M=0,N=I.length;M<N;++M)M<D.length&&this._buildTextureAtlasData(I[M],D[M])},P.prototype.getDragonBonesData=function(E){return E in this._dragonBonesDataMap?this._dragonBonesDataMap[E]:null},P.prototype.addDragonBonesData=function(E,D){if(D===void 0&&(D=null),(D=D!==null?D:E.name)in this._dragonBonesDataMap){if(this._dragonBonesDataMap[D]===E)return;console.warn("Can not add same name data: "+D)}else this._dragonBonesDataMap[D]=E},P.prototype.removeDragonBonesData=function(E,D){D===void 0&&(D=!0),E in this._dragonBonesDataMap&&(D&&this._dragonBones.bufferObject(this._dragonBonesDataMap[E]),delete this._dragonBonesDataMap[E])},P.prototype.getTextureAtlasData=function(E){return E in this._textureAtlasDataMap?this._textureAtlasDataMap[E]:null},P.prototype.addTextureAtlasData=function(E,D){D===void 0&&(D=null);var I=(D=D!==null?D:E.name)in this._textureAtlasDataMap?this._textureAtlasDataMap[D]:this._textureAtlasDataMap[D]=[];I.indexOf(E)<0&&I.push(E)},P.prototype.removeTextureAtlasData=function(E,D){if(D===void 0&&(D=!0),E in this._textureAtlasDataMap){var I=this._textureAtlasDataMap[E];if(D)for(var M=0,N=I;M<N.length;M++){var k=N[M];this._dragonBones.bufferObject(k)}delete this._textureAtlasDataMap[E]}},P.prototype.getArmatureData=function(E,D){D===void 0&&(D="");var I=new R;return this._fillBuildArmaturePackage(I,D,E,"","")?I.armature:null},P.prototype.clear=function(E){for(var D in E===void 0&&(E=!0),this._dragonBonesDataMap)E&&this._dragonBones.bufferObject(this._dragonBonesDataMap[D]),delete this._dragonBonesDataMap[D];for(var D in this._textureAtlasDataMap){if(E)for(var I=0,M=this._textureAtlasDataMap[D];I<M.length;I++){var N=M[I];this._dragonBones.bufferObject(N)}delete this._textureAtlasDataMap[D]}},P.prototype.buildArmature=function(E,D,I,M){D===void 0&&(D=""),I===void 0&&(I=""),M===void 0&&(M="");var N=new R;if(!this._fillBuildArmaturePackage(N,D||"",E,I||"",M||""))return console.warn("No armature data: "+E+", "+(D!==null?D:"")),null;var k=this._buildArmature(N);return this._buildBones(N,k),this._buildSlots(N,k),this._buildConstraints(N,k),k.invalidUpdate(null,!0),k.advanceTime(0),k},P.prototype.replaceDisplay=function(E,D,I){I===void 0&&(I=-1),I<0&&(I=E.displayIndex),I<0&&(I=0),E.replaceDisplayData(D,I);var M=E.displayList;if(M.length<=I){M.length=I+1;for(var N=0,k=M.length;N<k;++N)M[N]||(M[N]=null)}if(D!==null){var F=E.rawDisplayDatas,G=null;F&&(A.DragonBones.webAssembly?I<F.size()&&(G=F.get(I)):I<F.length&&(G=F[I])),M[I]=this._getSlotDisplay(null,D,G,E)}else M[I]=null;E.displayList=M},P.prototype.replaceSlotDisplay=function(E,D,I,M,N,k){k===void 0&&(k=-1);var F=this.getArmatureData(D,E||"");if(!F||!F.defaultSkin)return!1;var G=F.defaultSkin.getDisplay(I,M);return!!G&&(this.replaceDisplay(N,G,k),!0)},P.prototype.replaceSlotDisplayList=function(E,D,I,M){var N=this.getArmatureData(D,E||"");if(!N||!N.defaultSkin)return!1;var k=N.defaultSkin.getDisplays(I);if(!k)return!1;for(var F=0,G=0,V=A.DragonBones.webAssembly?k.size():k.length;G<V;++G){var j=A.DragonBones.webAssembly?k.get(G):k[G];this.replaceDisplay(M,j,F++)}return!0},P.prototype.replaceSkin=function(E,D,I,M){I===void 0&&(I=!1),M===void 0&&(M=null);for(var N=!1,k=D.parent.defaultSkin,F=0,G=E.getSlots();F<G.length;F++){var V=G[F];if(!(M!==null&&M.indexOf(V.name)>=0)){var j=D.getDisplays(V.name);if(j||(k!==null&&D!==k&&(j=k.getDisplays(V.name)),j)){var H=A.DragonBones.webAssembly?j.size():j.length,U=V.displayList;U.length=H;for(var X=0,Y=H;X<Y;++X){var z=A.DragonBones.webAssembly?j.get(X):j[X];U[X]=z!==null?this._getSlotDisplay(null,z,null,V):null}N=!0,V.rawDisplayDatas=j,V.displayList=U}else I&&(V.rawDisplayDatas=null,V.displayList=[])}}return N},P.prototype.replaceAnimation=function(E,D,I){I===void 0&&(I=!0);var M=D.defaultSkin;if(M===null)return!1;if(I)E.animation.animations=D.animations;else{var N=E.animation.animations,k={};for(var F in N)k[F]=N[F];for(var F in D.animations)k[F]=D.animations[F];E.animation.animations=k}for(var G=0,V=E.getSlots();G<V.length;G++)for(var j=V[G],H=0,U=0,X=j.displayList;U<X.length;U++){var Y=X[U];if(Y instanceof A.Armature){var z=M.getDisplays(j.name);if(z!==null&&H<(A.DragonBones.webAssembly?z.size():z.length)){var W=A.DragonBones.webAssembly?z.get(H):z[H];if(W!==null&&W.type===1){var Z=this.getArmatureData(W.path,W.parent.parent.parent.name);Z&&this.replaceAnimation(Y,Z,I)}}}H++}return!0},P.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},P.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},Object.defineProperty(P.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:!0,configurable:!0}),P.prototype.changeSkin=function(E,D,I){return I===void 0&&(I=null),this.replaceSkin(E,D,!1,I)},P.prototype.copyAnimationsToArmature=function(E,D,I,M,N){M===void 0&&(M=""),N===void 0&&(N=!0);var k=this.getArmatureData(D,M);return!!k&&this.replaceAnimation(E,k,N)},P._objectParser=null,P._binaryParser=null,P}();A.BaseFactory=O;var R=function(){this.dataName="",this.textureAtlasName="",this.skin=null};A.BuildArmaturePackage=R}(w||(w={})),S.exports=w},{}],370:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _=B(L("../../cocos2d/core/renderer/assembler")),w=B(L("../../cocos2d/core/value-types/mat4"));function B(Te){return Te&&Te.__esModule?Te:{default:Te}}function A(Te,Ee){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(De,fe){return De.__proto__=fe,De})(Te,Ee)}var O,R,P,E,D,I,M,N,k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee,te,re,ie,ne,he,pe,K,ue,le=L("./ArmatureDisplay"),ce=L("../../cocos2d/core/renderer/render-flow"),_e=cc.gfx,oe=cc.color(255,0,0,255),de=cc.color(0,0,255,255),me=cc.color(0,255,0,255);function ye(Te,Ee){if(!Te)return null;var De,fe;switch(Ee){case 1:De=D?cc.macro.ONE:cc.macro.SRC_ALPHA,fe=cc.macro.ONE;break;case 10:De=cc.macro.DST_COLOR,fe=cc.macro.ONE_MINUS_SRC_ALPHA;break;case 12:De=cc.macro.ONE,fe=cc.macro.ONE_MINUS_SRC_COLOR;break;case 0:default:De=D?cc.macro.ONE:cc.macro.SRC_ALPHA,fe=cc.macro.ONE_MINUS_SRC_ALPHA}var Ce=!G.enableBatch,Se=G._materials[0];if(!Se)return null;var be=G._materialCache,Re=Te.getId()+De+fe+Ce,Ve=be[Re];return Ve||(be.baseMaterial?Ve=cc.MaterialVariant.create(Se):(Ve=Se,be.baseMaterial=Se),Ve.define("CC_USE_MODEL",Ce),Ve.setProperty("texture",Te),Ve.setBlend(!0,_e.BLEND_FUNC_ADD,De,fe,_e.BLEND_FUNC_ADD,De,fe),be[Re]=Ve),Ve}function ge(Te,Ee){te=Te.a*Ee*E,I=D?te/255:1,Z=Te.r*O*I,Q=Te.g*R*I,ee=Te.b*P*I,W=(te<<24>>>0)+(ee<<16)+(Q<<8)+Z}var we=function(Te){var Ee,De;function fe(){return Te.apply(this,arguments)||this}De=Te,(Ee=fe).prototype=Object.create(De.prototype),Ee.prototype.constructor=Ee,A(Ee,De);var Ce=fe.prototype;return Ce.updateRenderData=function(){},Ce.realTimeTraverse=function(Se,be,Re){for(var Ve,Pe,ke,Ne,Ae,Oe,Fe,nt,Ze,Xe,$e=Se._slots,ot=0,ut=$e.length;ot<ut;ot++)if(Fe=(nt=$e[ot])._color,nt._visible&&nt._displayData){if(be?nt._mulMat(nt._worldMatrix,be,nt._matrix):w.default.copy(nt._worldMatrix,nt._matrix),nt.childArmature)this.realTimeTraverse(nt.childArmature,nt._worldMatrix,Re*Fe.a/255);else if(Ne=ye(nt.getTexture(),nt._blendMode)){(M||Ne.getHash()!==F.material.getHash())&&(M=!1,F._flush(),F.node=k,F.material=Ne),ge(Fe,Re),Ze=nt._worldMatrix.m,Ae=nt._localVertices,U=Ae.length>>2,Oe=nt._indices,X=Oe.length,Xe=N.request(U,X),j=Xe.indiceOffset,V=Xe.byteOffset>>2,H=Xe.vertexOffset,Ve=N._vData,Pe=N._iData,ke=N._uintVData,ie=Ze[0],ne=Ze[4],he=Ze[12],pe=Ze[1],K=Ze[5],ue=Ze[13];for(var gt=0,Ue=Ae.length;gt<Ue;)Y=Ae[gt++],z=Ae[gt++],Ve[V++]=Y*ie+z*ne+he,Ve[V++]=Y*pe+z*K+ue,Ve[V++]=Ae[gt++],Ve[V++]=Ae[gt++],ke[V++]=W;for(var We=0,ht=Oe.length;We<ht;We++)Pe[j++]=H+Oe[We]}}},Ce.cacheTraverse=function(Se,be){if(Se){var Re=Se.segments;if(Re.length!=0){var Ve,Pe,ke,Ne,Ae,Oe=Se.vertices,Fe=Se.indices,nt=0,Ze=0,Xe=0;if(be){var $e=be.m;ie=$e[0],pe=$e[1],ne=$e[4],K=$e[5],he=$e[12],ue=$e[13]}var ot=16&re,ut=ot&&ie===1&&pe===0&&ne===0&&K===1,gt=0,Ue=Se.colors,We=Ue[gt++],ht=We.vfOffset;ge(We,1);for(var Be=0,je=Re.length;Be<je;Be++){var Qe=Re[Be];Ne=ye(Qe.tex,Qe.blendMode),(M||Ne.getHash()!==F.material.getHash())&&(M=!1,F._flush(),F.node=k,F.material=Ne),U=Qe.vertexCount,X=Qe.indexCount,Ae=N.request(U,X),j=Ae.indiceOffset,H=Ae.vertexOffset,V=Ae.byteOffset>>2,Ve=N._vData,Pe=N._iData,ke=N._uintVData;for(var st=j,pt=j+X;st<pt;st++)Pe[st]=H+Fe[Ze++];if(Xe=Qe.vfCount,Ve.set(Oe.subarray(nt,nt+Xe),V),nt+=Xe,ut)for(var qe=V,rt=V+Xe;qe<rt;qe+=5)Ve[qe]+=he,Ve[qe+1]+=ue;else if(ot)for(var bt=V,Dt=V+Xe;bt<Dt;bt+=5)Y=Ve[bt],z=Ve[bt+1],Ve[bt]=Y*ie+z*ne+he,Ve[bt+1]=Y*pe+z*K+ue;if(1&re)for(var Et=nt-Xe,Lt=V+4,Ot=V+4+Xe;Lt<Ot;Lt+=5,Et+=5)Et>=ht&&(ge(We=Ue[gt++],1),ht=We.vfOffset),ke[Lt]=W}}}},Ce.fillBuffers=function(Se,be){Se.node._renderFlag|=ce.FLAG_UPDATE_RENDER_DATA;var Re=Se._armature;if(Re){M=!0,D=Se.premultipliedAlpha,k=Se.node,N=be._meshBuffer,F=be,G=Se,re=0;var Ve=k._color;O=Ve.r/255,R=Ve.g/255,P=Ve.b/255,E=Ve.a/255,Ve._val!==4294967295&&(re|=1);var Pe=void 0;if(G.enableBatch&&(Pe=k._worldMatrix,M=!1,re|=16),Se.isAnimationCached())this.cacheTraverse(Se._curFrame,Pe);else{this.realTimeTraverse(Re,Pe,1);var ke=Se._debugDraw;if(Se.debugBones&&ke){ke.clear(),ke.lineWidth=5,ke.strokeColor=oe,ke.fillColor=de;for(var Ne=Re.getBones(),Ae=0,Oe=Ne.length;Ae<Oe;Ae++){var Fe=Ne[Ae],nt=Math.max(Fe.boneData.length,5),Ze=Fe.globalTransformMatrix.tx,Xe=Fe.globalTransformMatrix.ty,$e=Ze+Fe.globalTransformMatrix.a*nt,ot=Xe+Fe.globalTransformMatrix.b*nt;ke.moveTo(Ze,Xe),ke.lineTo($e,ot),ke.stroke(),ke.circle(Ze,Xe,2*Math.PI),ke.fill(),Ae===0&&(ke.fillColor=me)}}}be.worldMatDirty++,Se.attachUtil._syncAttachedNode(),k=void 0,N=void 0,F=void 0,G=void 0}},Ce.postFillBuffers=function(Se,be){be.worldMatDirty--},fe}(_.default);T.default=we,_.default.register(le,we),S.exports=T.default},{"../../cocos2d/core/renderer/assembler":224,"../../cocos2d/core/renderer/render-flow":228,"../../cocos2d/core/value-types/mat4":288,"./ArmatureDisplay":360}],371:[function(L,S){var T,_=(T=L("../../cocos2d/core/value-types/mat4"))&&T.__esModule?T:{default:T},w=L("../../cocos2d/core/renderer/render-flow").FLAG_TRANSFORM,B=function(){},A=function(P){Object.defineProperty(P,"_worldMatDirty",{get:function(){return!0},set:function(){}}),P._calculWorldMatrix=B,P._mulMat=B},O=new _.default,R=cc.Class({name:"sp.AttachUtil",ctor:function(){this._inited=!1,this._skeleton=null,this._skeletonNode=null,this._skeletonComp=null,this._attachedRootNode=null,this._attachedNodeArray=[],this._boneIndexToNode={}},init:function(P){this._inited=!0,this._skeleton=P._skeleton,this._skeletonNode=P.node,this._skeletonComp=P},reset:function(){this._inited=!1,this._skeleton=null,this._skeletonNode=null,this._skeletonComp=null},_prepareAttachNode:function(){if(this._skeleton){var P=this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");return P&&P.isValid||(P=new cc.Node("ATTACHED_NODE_TREE"),A(P),this._skeletonNode.addChild(P)),this._skeletonComp.isAnimationCached()&&this._skeletonComp._frameCache&&this._skeletonComp._frameCache.enableCacheAttachedInfo(),this._attachedRootNode=P,P}},_buildBoneAttachedNode:function(P,E){var D="ATTACHED_NODE:"+P.data.name,I=new cc.Node(D);return this._buildBoneRelation(I,P,E),I},_buildBoneRelation:function(P,E,D){A(P),P._bone=E,P._boneIndex=D,this._attachedNodeArray.push(P),this._boneIndexToNode[D]=P},getAttachedRootNode:function(){return this._attachedRootNode},getAttachedNodes:function(P){var E=this._attachedNodeArray,D=[];if(!this._inited)return D;for(var I=0,M=E.length;I<M;I++){var N=E[I];N&&N.isValid&&N.name==="ATTACHED_NODE:"+P&&D.push(N)}return D},_rebuildNodeArray:function(){for(var P=this._boneIndexToNode={},E=this._attachedNodeArray,D=this._attachedNodeArray=[],I=0,M=E.length;I<M;I++){var N=E[I];N&&N.isValid&&!N._toRemove&&(D.push(N),P[N._boneIndex]=N)}},_sortNodeArray:function(){this._attachedNodeArray.sort(function(P,E){return P._boneIndex<E._boneIndex?-1:1})},_getNodeByBoneIndex:function(P){var E=this._boneIndexToNode[P];return E&&E.isValid?E:null},destroyAttachedNodes:function(P){if(this._inited){for(var E=this._attachedNodeArray,D=function k(F){for(var G=F.children,V=0,j=G.length;V<j;V++){var H=G[V];H&&k(H)}F._toRemove=!0},I=0,M=E.length;I<M;I++){var N=E[I];N&&N.isValid&&N.name.split("ATTACHED_NODE:")[1]===P&&(D(N),N.removeFromParent(!0),N.destroy(),E[I]=null)}this._rebuildNodeArray()}},generateAttachedNodes:function(P){var E=[];if(!this._inited)return E;var D=this._prepareAttachNode();if(!D)return E;for(var I=[],M=this._skeleton.bones,N=0,k=M.length;N<k;N++){var F=M[N];F.data.name==P&&I.push(F)}for(var G=(function(U){if(U){var X=U.data,Y=this._getNodeByBoneIndex(X.index);if(Y)return Y;Y=this._buildBoneAttachedNode(U,X.index);var z=G(U.parent)||D;return Y.parent=z,Y}}).bind(this),V=0,j=I.length;V<j;V++){var H=G(I[V]);E.push(H)}return this._sortNodeArray(),E},destroyAllAttachedNodes:function(){if(this._attachedRootNode=null,this._attachedNodeArray.length=0,this._boneIndexToNode={},this._inited){var P=this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");P&&(P.removeFromParent(!0),P.destroy(),P=null)}},generateAllAttachedNodes:function(){if(this._inited){this._boneIndexToNode={},this._attachedNodeArray.length=0;var P=this._prepareAttachNode();if(P){for(var E=this._skeleton.bones,D=0,I=E.length;D<I;D++){var M=E[D],N=M.data,k=null;if(M.parent){var F=M.parent.data.index;k=this._boneIndexToNode[F]}else k=P;if(k){var G=k.getChildByName("ATTACHED_NODE:"+N.name);G&&G.isValid?this._buildBoneRelation(G,M,N.index):(G=this._buildBoneAttachedNode(M,N.index),k.addChild(G))}}return P}}},_hasAttachedNode:function(){return!!this._inited&&!!this._skeletonNode.getChildByName("ATTACHED_NODE_TREE")},_associateAttachedNode:function(){if(this._inited){var P=this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");if(P&&P.isValid){this._attachedRootNode=P,this._boneIndexToNode={},this._attachedNodeArray.length=0,A(P),this._skeletonComp.isAnimationCached()&&this._skeletonComp._frameCache&&this._skeletonComp._frameCache.enableCacheAttachedInfo();for(var E=this._skeleton.bones,D=0,I=E.length;D<I;D++){var M=E[D],N=M.data,k=null;if(M.parent){var F=M.parent.data.index;k=this._boneIndexToNode[F]}else k=P;if(k){var G=k.getChildByName("ATTACHED_NODE:"+N.name);G&&G.isValid&&this._buildBoneRelation(G,M,N.index)}}}}},_syncAttachedNode:function(){if(this._inited){var P=this._attachedRootNode,E=this._attachedNodeArray;if(!P||!P.isValid)return this._attachedRootNode=null,void(E.length=0);var D=this._skeletonNode._worldMatrix;_.default.copy(P._worldMatrix,D),P._renderFlag&=~w;var I;if(I=this._skeletonComp.isAnimationCached()?this._skeletonComp._curFrame&&this._skeletonComp._curFrame.boneInfos:this._skeleton.bones){for(var M=this._skeletonNode._mulMat,N=function(H,U,X){var Y=O.m;Y[0]=X.a,Y[1]=X.c,Y[4]=X.b,Y[5]=X.d,Y[12]=X.worldX,Y[13]=X.worldY,M(H,U,O)},k=!1,F=0,G=E.length;F<G;F++){var V=E[F];if(V&&V.isValid){var j=I[V._boneIndex];j?(N(V._worldMatrix,P._worldMatrix,j),V._renderFlag&=~w):(V.removeFromParent(!0),V.destroy(),E[F]=null,k=!0)}else E[F]=null,k=!0}k&&this._rebuildNodeArray()}}}});S.exports=sp.AttachUtil=R},{"../../cocos2d/core/renderer/render-flow":228,"../../cocos2d/core/value-types/mat4":288}],372:[function(L,S){var T=L("./track-entry-listeners"),_=L("../../cocos2d/core/components/CCRenderComponent"),w=L("./lib/spine"),B=L("../../cocos2d/core/graphics/graphics"),A=L("../../cocos2d/core/renderer/render-flow").FLAG_POST_RENDER,O=L("./skeleton-cache"),R=L("./AttachUtil"),P=cc.Enum({default:-1}),E=cc.Enum({"<None>":0}),D=cc.Enum({REALTIME:0,SHARED_CACHE:1,PRIVATE_CACHE:2});sp.Skeleton=cc.Class({name:"sp.Skeleton",extends:_,editor:!1,statics:{AnimationCacheMode:D},properties:{paused:{default:!1,visible:!1},skeletonData:{default:null,type:sp.SkeletonData,notify:function(){this.defaultSkin="",this.defaultAnimation="",this._updateSkeletonData()},tooltip:!1},defaultSkin:{default:"",visible:!1},defaultAnimation:{default:"",visible:!1},animation:{get:function(){if(this.isAnimationCached())return this._animationName;var I=this.getCurrent(0);return I&&I.animation.name||""},set:function(I){this.defaultAnimation=I,I?this.setAnimation(0,I,this.loop):this.isAnimationCached()||(this.clearTrack(0),this.setToSetupPose())},visible:!1},_defaultSkinIndex:{get:function(){if(this.skeletonData){var I=this.skeletonData.getSkinsEnum();if(I)if(this.defaultSkin===""){if(I.hasOwnProperty(0))return this._defaultSkinIndex=0,0}else{var M=I[this.defaultSkin];if(M!==void 0)return M}}return 0},set:function(I){var M;if(this.skeletonData&&(M=this.skeletonData.getSkinsEnum()),!M)return cc.errorID("",this.name);var N=M[I];N!==void 0?(this.defaultSkin=N,this.setSkin(this.defaultSkin)):cc.errorID(7501,this.name)},type:P,visible:!0,animatable:!1,displayName:"Default Skin",tooltip:!1},_animationIndex:{get:function(){var I=this.animation;if(this.skeletonData&&I){var M=this.skeletonData.getAnimsEnum();if(M){var N=M[I];if(N!==void 0)return N}}return 0},set:function(I){if(I!==0){var M;if(this.skeletonData&&(M=this.skeletonData.getAnimsEnum()),!M)return cc.errorID(7502,this.name);var N=M[I];N!==void 0?this.animation=N:cc.errorID(7503,this.name)}else this.animation=""},type:E,visible:!0,animatable:!1,displayName:"Animation",tooltip:!1},_preCacheMode:-1,_cacheMode:D.REALTIME,_defaultCacheMode:{default:0,type:D,notify:function(){this.setAnimationCacheMode(this._defaultCacheMode)},editorOnly:!0,visible:!0,animatable:!1,displayName:"Animation Cache Mode",tooltip:!1},loop:{default:!0,tooltip:!1},premultipliedAlpha:{default:!0,tooltip:!1},timeScale:{default:1,tooltip:!1},debugSlots:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},debugBones:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},debugMesh:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},useTint:{default:!1,tooltip:!1,notify:function(){this._updateUseTint()}},enableBatch:{default:!1,notify:function(){this._updateBatch()},tooltip:!1},_accTime:0,_playCount:0,_frameCache:null,_curFrame:null,_skeletonCache:null,_animationName:"",_animationQueue:[],_headAniInfo:null,_playTimes:0,_isAniComplete:!0},ctor:function(){this._effectDelegate=null,this._skeleton=null,this._rootBone=null,this._listener=null,this._materialCache={},this._debugRenderer=null,this._startSlotIndex=-1,this._endSlotIndex=-1,this._startEntry={animation:{name:""},trackIndex:0},this._endEntry={animation:{name:""},trackIndex:0},this.attachUtil=new R},_getDefaultMaterial:function(){return cc.Material.getBuiltinMaterial("2d-spine")},_updateMaterial:function(){var I=this.useTint||this.isAnimationCached()&&!0,M=this.getMaterial(0);if(M){M.define("USE_TINT",I),M.define("CC_USE_MODEL",!this.enableBatch);var N=this.premultipliedAlpha?cc.gfx.BLEND_ONE:cc.gfx.BLEND_SRC_ALPHA,k=cc.gfx.BLEND_ONE_MINUS_SRC_ALPHA;M.setBlend(!0,cc.gfx.BLEND_FUNC_ADD,N,N,cc.gfx.BLEND_FUNC_ADD,k,k)}this._materialCache={}},disableRender:function(){this._super(),this.node._renderFlag&=~A},markForRender:function(I){this._super(I),I?this.node._renderFlag|=A:this.node._renderFlag&=~A},_updateUseTint:function(){var I=this.getMaterial(0);if(I){var M=this.useTint||this.isAnimationCached()&&!0;I.define("USE_TINT",M)}this._materialCache={}},_updateBatch:function(){var I=this.getMaterial(0);I&&I.define("CC_USE_MODEL",!this.enableBatch),this._materialCache={}},_validateRender:function(){var I=this.skeletonData;I&&I.isTexturesLoaded()?this._super():this.disableRender()},setSkeletonData:function(I){if(I.width!=null&&I.height!=null&&this.node.setContentSize(I.width,I.height),this._cacheMode===D.SHARED_CACHE?this._skeletonCache=O.sharedCache:this._cacheMode===D.PRIVATE_CACHE&&(this._skeletonCache=new O,this._skeletonCache.enablePrivateMode()),this.isAnimationCached()){(this.debugBones||this.debugSlots)&&cc.warn("Debug bones or slots is invalid in cached mode");var M=this._skeletonCache.getSkeletonCache(this.skeletonData._uuid,I);this._skeleton=M.skeleton,this._clipper=M.clipper,this._rootBone=this._skeleton.getRootBone()}else this._skeleton=new w.Skeleton(I),this._clipper=new w.SkeletonClipping,this._rootBone=this._skeleton.getRootBone();this.markForRender(!0)},setSlotsRange:function(I,M){this.isAnimationCached()?cc.warn("Slots visible range can not be modified in cached mode."):(this._startSlotIndex=I,this._endSlotIndex=M)},setAnimationStateData:function(I){if(this.isAnimationCached())cc.warn("'setAnimationStateData' interface can not be invoked in cached mode.");else{var M=new w.AnimationState(I);this._listener&&(this._state&&this._state.removeListener(this._listener),M.addListener(this._listener)),this._state=M}},__preload:function(){this._super();for(var I=this.node.children,M=0,N=I.length;M<N;M++){var k=I[M];k&&k._name==="DEBUG_DRAW_NODE"&&k.destroy()}this._updateSkeletonData(),this._updateDebugDraw(),this._updateUseTint(),this._updateBatch()},setAnimationCacheMode:function(I){this._preCacheMode!==I&&(this._cacheMode=I,this._updateSkeletonData(),this._updateUseTint())},isAnimationCached:function(){return this._cacheMode!==D.REALTIME},update:function(I){if(!this.paused)if(I*=this.timeScale*sp.timeScale,this.isAnimationCached()){if(this._isAniComplete){if(this._animationQueue.length===0&&!this._headAniInfo){var M=this._frameCache;if(M&&M.isInvalid()){M.updateToFrame();var N=M.frames;this._curFrame=N[N.length-1]}return}if(this._headAniInfo||(this._headAniInfo=this._animationQueue.shift()),this._accTime+=I,this._accTime>this._headAniInfo.delay){var k=this._headAniInfo;this._headAniInfo=null,this.setAnimation(0,k.animationName,k.loop)}return}this._updateCache(I)}else this._updateRealtime(I)},_emitCacheCompleteEvent:function(){this._listener&&(this._endEntry.animation.name=this._animationName,this._listener.complete&&this._listener.complete(this._endEntry),this._listener.end&&this._listener.end(this._endEntry))},_updateCache:function(I){var M=this._frameCache;if(M.isInited()){var N=M.frames,k=O.FrameTime;this._accTime==0&&this._playCount==0&&(this._startEntry.animation.name=this._animationName,this._listener&&this._listener.start&&this._listener.start(this._startEntry)),this._accTime+=I;var F=Math.floor(this._accTime/k);if(M.isCompleted||M.updateToFrame(F),M.isCompleted&&F>=N.length){if(this._playCount++,this._playTimes>0&&this._playCount>=this._playTimes)return this._curFrame=N[N.length-1],this._accTime=0,this._playCount=0,this._isAniComplete=!0,void this._emitCacheCompleteEvent();this._accTime=0,F=0,this._emitCacheCompleteEvent()}this._curFrame=N[F]}},_updateRealtime:function(I){var M=this._skeleton,N=this._state;M&&(M.update(I),N&&(N.update(I),N.apply(M)))},setVertexEffectDelegate:function(I){this._effectDelegate=I},updateWorldTransform:function(){this.isAnimationCached()&&this._skeleton&&this._skeleton.updateWorldTransform()},setToSetupPose:function(){this._skeleton&&this._skeleton.setToSetupPose()},setBonesToSetupPose:function(){this._skeleton&&this._skeleton.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._skeleton&&this._skeleton.setSlotsToSetupPose()},updateAnimationCache:function(I){if(this.isAnimationCached()){var M=this.skeletonData._uuid;this._skeletonCache&&this._skeletonCache.updateAnimationCache(M,I)}},invalidAnimationCache:function(){this.isAnimationCached()&&this._skeletonCache&&this._skeletonCache.invalidAnimationCache(this.skeletonData._uuid)},findBone:function(I){return this._skeleton?this._skeleton.findBone(I):null},findSlot:function(I){return this._skeleton?this._skeleton.findSlot(I):null},setSkin:function(I){this._skeleton&&(this._skeleton.setSkinByName(I),this._skeleton.setSlotsToSetupPose()),this.invalidAnimationCache()},getAttachment:function(I,M){return this._skeleton?this._skeleton.getAttachmentByName(I,M):null},setAttachment:function(I,M){this._skeleton&&this._skeleton.setAttachment(I,M),this.invalidAnimationCache()},getTextureAtlas:function(I){return I.region},setMix:function(I,M,N){this._state&&this._state.data.setMix(I,M,N)},setAnimation:function(I,M,N){if(this._playTimes=N?0:1,this._animationName=M,this.isAnimationCached()){if(I!==0&&cc.warn("Track index can not greater than 0 in cached mode."),!this._skeletonCache)return null;var k=this._skeletonCache.getAnimationCache(this.skeletonData._uuid,M);k||(k=this._skeletonCache.initAnimationCache(this.skeletonData._uuid,M)),k&&(this._isAniComplete=!1,this._accTime=0,this._playCount=0,this._frameCache=k,this.attachUtil._hasAttachedNode()&&this._frameCache.enableCacheAttachedInfo(),this._frameCache.updateToFrame(0),this._curFrame=this._frameCache.frames[0])}else if(this._skeleton){var F=this._skeleton.data.findAnimation(M);if(!F)return cc.logID(7509,M),null;var G=this._state.setAnimationWith(I,F,N);return this._state.apply(this._skeleton),G}return null},addAnimation:function(I,M,N,k){if(k=k||0,this.isAnimationCached())I!==0&&cc.warn("Track index can not greater than 0 in cached mode."),this._animationQueue.push({animationName:M,loop:N,delay:k});else if(this._skeleton){var F=this._skeleton.data.findAnimation(M);return F?this._state.addAnimationWith(I,F,N,k):(cc.logID(7510,M),null)}return null},findAnimation:function(I){return this._skeleton?this._skeleton.data.findAnimation(I):null},getCurrent:function(I){if(this.isAnimationCached())cc.warn("'getCurrent' interface can not be invoked in cached mode.");else if(this._state)return this._state.getCurrent(I);return null},clearTracks:function(){this.isAnimationCached()?cc.warn("'clearTracks' interface can not be invoked in cached mode."):this._state&&this._state.clearTracks()},clearTrack:function(I){this.isAnimationCached()?cc.warn("'clearTrack' interface can not be invoked in cached mode."):this._state&&this._state.clearTrack(I)},setStartListener:function(I){this._ensureListener(),this._listener.start=I},setInterruptListener:function(I){this._ensureListener(),this._listener.interrupt=I},setEndListener:function(I){this._ensureListener(),this._listener.end=I},setDisposeListener:function(I){this._ensureListener(),this._listener.dispose=I},setCompleteListener:function(I){this._ensureListener(),this._listener.complete=I},setEventListener:function(I){this._ensureListener(),this._listener.event=I},setTrackStartListener:function(I,M){T.getListeners(I).start=M},setTrackInterruptListener:function(I,M){T.getListeners(I).interrupt=M},setTrackEndListener:function(I,M){T.getListeners(I).end=M},setTrackDisposeListener:function(I,M){T.getListeners(I).dispose=M},setTrackCompleteListener:function(I,M){T.getListeners(I).complete=function(N){var k=Math.floor(N.trackTime/N.animationEnd);M(N,k)}},setTrackEventListener:function(I,M){T.getListeners(I).event=M},getState:function(){return this._state},_resetDefaultAnim:!1,_resetDefaultSkin:!1,_updateAnimEnum:!1,_updateSkinEnum:!1,_ensureListener:function(){this._listener||(this._listener=new T,this._state&&this._state.addListener(this._listener))},_updateSkeletonData:function(){if(this.skeletonData){var I=this.skeletonData.getRuntimeData();if(I){try{this.setSkeletonData(I),this.isAnimationCached()||this.setAnimationStateData(new w.AnimationStateData(this._skeleton.data)),this.defaultSkin&&this.setSkin(this.defaultSkin)}catch(M){cc.warn(M)}this.attachUtil.init(this),this.attachUtil._associateAttachedNode(),this._preCacheMode=this._cacheMode,this.animation=this.defaultAnimation}else this.disableRender()}else this.disableRender()},_refreshInspector:function(){this._updateAnimEnum(),this._updateSkinEnum(),Editor.Utils.refreshSelectedInspector("node",this.node.uuid)},_updateDebugDraw:function(){if(this.debugBones||this.debugSlots){if(!this._debugRenderer){var I=new cc.PrivateNode;I.name="DEBUG_DRAW_NODE";var M=I.addComponent(B);M.lineWidth=1,M.strokeColor=cc.color(255,0,0,255),this._debugRenderer=M}this._debugRenderer.node.parent=this.node,this.isAnimationCached()&&cc.warn("Debug bones or slots is invalid in cached mode")}else this._debugRenderer&&(this._debugRenderer.node.parent=null)}}),S.exports=sp.Skeleton},{"../../cocos2d/core/components/CCRenderComponent":117,"../../cocos2d/core/graphics/graphics":159,"../../cocos2d/core/renderer/render-flow":228,"./AttachUtil":371,"./lib/spine":374,"./skeleton-cache":375,"./track-entry-listeners":379}],373:[function(L){var S=typeof window>"u"?global:window;S.spine=L("./lib/spine"),S.sp=S.sp||{},sp._timeScale=1,Object.defineProperty(sp,"timeScale",{get:function(){return this._timeScale},set:function(T){this._timeScale=T},configurable:!0}),sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.AnimationEventType=cc.Enum({START:0,INTERRUPT:1,END:2,DISPOSE:3,COMPLETE:4,EVENT:5}),sp.spine=S.spine,L("./skeleton-texture"),L("./skeleton-data"),L("./vertex-effect-delegate"),L("./Skeleton"),L("./spine-assembler")},{"./Skeleton":372,"./lib/spine":374,"./skeleton-data":376,"./skeleton-texture":377,"./spine-assembler":378,"./vertex-effect-delegate":380}],374:[function(L,S){var T,_,w,B=(T=function(A,O){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,P){R.__proto__=P}||function(R,P){for(var E in P)P.hasOwnProperty(E)&&(R[E]=P[E])})(A,O)},function(A,O){function R(){this.constructor=A}T(A,O),A.prototype=O===null?Object.create(O):(R.prototype=O.prototype,new R)});(function(A){var O,R,P,E=function(){function ee(te,re,ie){if(te==null)throw new Error("name cannot be null.");if(re==null)throw new Error("timelines cannot be null.");this.name=te,this.timelines=re,this.timelineIds=[];for(var ne=0;ne<re.length;ne++)this.timelineIds[re[ne].getPropertyId()]=!0;this.duration=ie}return ee.prototype.hasTimeline=function(te){return this.timelineIds[te]==1},ee.prototype.apply=function(te,re,ie,ne,he,pe,K,ue){if(te==null)throw new Error("skeleton cannot be null.");ne&&this.duration!=0&&(ie%=this.duration,re>0&&(re%=this.duration));for(var le=this.timelines,ce=0,_e=le.length;ce<_e;ce++)le[ce].apply(te,re,ie,he,pe,K,ue)},ee.binarySearch=function(te,re,ie){ie===void 0&&(ie=1);var ne=0,he=te.length/ie-2;if(he==0)return ie;for(var pe=he>>>1;;){if(te[(pe+1)*ie]<=re?ne=pe+1:he=pe,ne==he)return(ne+1)*ie;pe=ne+he>>>1}},ee.linearSearch=function(te,re,ie){for(var ne=0,he=te.length-ie;ne<=he;ne+=ie)if(te[ne]>re)return ne;return-1},ee}();A.Animation=E,function(ee){ee[ee.setup=0]="setup",ee[ee.first=1]="first",ee[ee.replace=2]="replace",ee[ee.add=3]="add"}(O=A.MixBlend||(A.MixBlend={})),function(ee){ee[ee.mixIn=0]="mixIn",ee[ee.mixOut=1]="mixOut"}(R=A.MixDirection||(A.MixDirection={})),function(ee){ee[ee.rotate=0]="rotate",ee[ee.translate=1]="translate",ee[ee.scale=2]="scale",ee[ee.shear=3]="shear",ee[ee.attachment=4]="attachment",ee[ee.color=5]="color",ee[ee.deform=6]="deform",ee[ee.event=7]="event",ee[ee.drawOrder=8]="drawOrder",ee[ee.ikConstraint=9]="ikConstraint",ee[ee.transformConstraint=10]="transformConstraint",ee[ee.pathConstraintPosition=11]="pathConstraintPosition",ee[ee.pathConstraintSpacing=12]="pathConstraintSpacing",ee[ee.pathConstraintMix=13]="pathConstraintMix",ee[ee.twoColor=14]="twoColor"}(P=A.TimelineType||(A.TimelineType={}));var D=function(){function ee(te){if(te<=0)throw new Error("frameCount must be > 0: "+te);this.curves=A.Utils.newFloatArray((te-1)*ee.BEZIER_SIZE)}return ee.prototype.getFrameCount=function(){return this.curves.length/ee.BEZIER_SIZE+1},ee.prototype.setLinear=function(te){this.curves[te*ee.BEZIER_SIZE]=ee.LINEAR},ee.prototype.setStepped=function(te){this.curves[te*ee.BEZIER_SIZE]=ee.STEPPED},ee.prototype.getCurveType=function(te){var re=te*ee.BEZIER_SIZE;if(re==this.curves.length)return ee.LINEAR;var ie=this.curves[re];return ie==ee.LINEAR?ee.LINEAR:ie==ee.STEPPED?ee.STEPPED:ee.BEZIER},ee.prototype.setCurve=function(te,re,ie,ne,he){var pe=.03*(2*-re+ne),K=.03*(2*-ie+he),ue=.006*(3*(re-ne)+1),le=.006*(3*(ie-he)+1),ce=2*pe+ue,_e=2*K+le,oe=.3*re+pe+.16666667*ue,de=.3*ie+K+.16666667*le,me=te*ee.BEZIER_SIZE,ye=this.curves;ye[me++]=ee.BEZIER;for(var ge=oe,we=de,Te=me+ee.BEZIER_SIZE-1;me<Te;me+=2)ye[me]=ge,ye[me+1]=we,oe+=ce,de+=_e,ce+=ue,_e+=le,ge+=oe,we+=de},ee.prototype.getCurvePercent=function(te,re){re=A.MathUtils.clamp(re,0,1);var ie=this.curves,ne=te*ee.BEZIER_SIZE,he=ie[ne];if(he==ee.LINEAR)return re;if(he==ee.STEPPED)return 0;for(var pe=0,K=++ne,ue=ne+ee.BEZIER_SIZE-1;ne<ue;ne+=2)if((pe=ie[ne])>=re){var le=void 0,ce=void 0;return ne==K?(le=0,ce=0):(le=ie[ne-2],ce=ie[ne-1]),ce+(ie[ne+1]-ce)*(re-le)/(pe-le)}var _e=ie[ne-1];return _e+(1-_e)*(re-pe)/(1-pe)},ee.LINEAR=0,ee.STEPPED=1,ee.BEZIER=2,ee.BEZIER_SIZE=19,ee}();A.CurveTimeline=D;var I=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re<<1),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.rotate<<24)+this.boneIndex},te.prototype.setFrame=function(re,ie,ne){re<<=1,this.frames[re]=ie,this.frames[re+te.ROTATION]=ne},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=this.frames,le=re.bones[this.boneIndex];if(le.active)if(ne<ue[0])switch(K){case O.setup:return void(le.rotation=le.data.rotation);case O.first:var ce=le.data.rotation-le.rotation;le.rotation+=(ce-360*(16384-(16384.499999999996-ce/360|0)))*pe}else if(ne>=ue[ue.length-te.ENTRIES]){var _e=ue[ue.length+te.PREV_ROTATION];switch(K){case O.setup:le.rotation=le.data.rotation+_e*pe;break;case O.first:case O.replace:_e+=le.data.rotation-le.rotation,_e-=360*(16384-(16384.499999999996-_e/360|0));case O.add:le.rotation+=_e*pe}}else{var oe=E.binarySearch(ue,ne,te.ENTRIES),de=ue[oe+te.PREV_ROTATION],me=ue[oe],ye=this.getCurvePercent((oe>>1)-1,1-(ne-me)/(ue[oe+te.PREV_TIME]-me)),ge=ue[oe+te.ROTATION]-de;switch(ge=de+(ge-360*(16384-(16384.499999999996-ge/360|0)))*ye,K){case O.setup:le.rotation=le.data.rotation+(ge-360*(16384-(16384.499999999996-ge/360|0)))*pe;break;case O.first:case O.replace:ge+=le.data.rotation-le.rotation;case O.add:le.rotation+=(ge-360*(16384-(16384.499999999996-ge/360|0)))*pe}}},te.ENTRIES=2,te.PREV_TIME=-2,te.PREV_ROTATION=-1,te.ROTATION=1,te}(D);A.RotateTimeline=I;var M=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re*te.ENTRIES),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.translate<<24)+this.boneIndex},te.prototype.setFrame=function(re,ie,ne,he){re*=te.ENTRIES,this.frames[re]=ie,this.frames[re+te.X]=ne,this.frames[re+te.Y]=he},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=this.frames,le=re.bones[this.boneIndex];if(le.active)if(ne<ue[0])switch(K){case O.setup:return le.x=le.data.x,void(le.y=le.data.y);case O.first:le.x+=(le.data.x-le.x)*pe,le.y+=(le.data.y-le.y)*pe}else{var ce=0,_e=0;if(ne>=ue[ue.length-te.ENTRIES])ce=ue[ue.length+te.PREV_X],_e=ue[ue.length+te.PREV_Y];else{var oe=E.binarySearch(ue,ne,te.ENTRIES);ce=ue[oe+te.PREV_X],_e=ue[oe+te.PREV_Y];var de=ue[oe],me=this.getCurvePercent(oe/te.ENTRIES-1,1-(ne-de)/(ue[oe+te.PREV_TIME]-de));ce+=(ue[oe+te.X]-ce)*me,_e+=(ue[oe+te.Y]-_e)*me}switch(K){case O.setup:le.x=le.data.x+ce*pe,le.y=le.data.y+_e*pe;break;case O.first:case O.replace:le.x+=(le.data.x+ce-le.x)*pe,le.y+=(le.data.y+_e-le.y)*pe;break;case O.add:le.x+=ce*pe,le.y+=_e*pe}}},te.ENTRIES=3,te.PREV_TIME=-3,te.PREV_X=-2,te.PREV_Y=-1,te.X=1,te.Y=2,te}(D);A.TranslateTimeline=M;var N=function(ee){function te(re){return ee.call(this,re)||this}return B(te,ee),te.prototype.getPropertyId=function(){return(P.scale<<24)+this.boneIndex},te.prototype.apply=function(re,ie,ne,he,pe,K,ue){var le=this.frames,ce=re.bones[this.boneIndex];if(ce.active)if(ne<le[0])switch(K){case O.setup:return ce.scaleX=ce.data.scaleX,void(ce.scaleY=ce.data.scaleY);case O.first:ce.scaleX+=(ce.data.scaleX-ce.scaleX)*pe,ce.scaleY+=(ce.data.scaleY-ce.scaleY)*pe}else{var _e=0,oe=0;if(ne>=le[le.length-te.ENTRIES])_e=le[le.length+te.PREV_X]*ce.data.scaleX,oe=le[le.length+te.PREV_Y]*ce.data.scaleY;else{var de=E.binarySearch(le,ne,te.ENTRIES);_e=le[de+te.PREV_X],oe=le[de+te.PREV_Y];var me=le[de],ye=this.getCurvePercent(de/te.ENTRIES-1,1-(ne-me)/(le[de+te.PREV_TIME]-me));_e=(_e+(le[de+te.X]-_e)*ye)*ce.data.scaleX,oe=(oe+(le[de+te.Y]-oe)*ye)*ce.data.scaleY}if(pe==1)K==O.add?(ce.scaleX+=_e-ce.data.scaleX,ce.scaleY+=oe-ce.data.scaleY):(ce.scaleX=_e,ce.scaleY=oe);else{var ge=0,we=0;if(ue==R.mixOut)switch(K){case O.setup:ge=ce.data.scaleX,we=ce.data.scaleY,ce.scaleX=ge+(Math.abs(_e)*A.MathUtils.signum(ge)-ge)*pe,ce.scaleY=we+(Math.abs(oe)*A.MathUtils.signum(we)-we)*pe;break;case O.first:case O.replace:ge=ce.scaleX,we=ce.scaleY,ce.scaleX=ge+(Math.abs(_e)*A.MathUtils.signum(ge)-ge)*pe,ce.scaleY=we+(Math.abs(oe)*A.MathUtils.signum(we)-we)*pe;break;case O.add:ge=ce.scaleX,we=ce.scaleY,ce.scaleX=ge+(Math.abs(_e)*A.MathUtils.signum(ge)-ce.data.scaleX)*pe,ce.scaleY=we+(Math.abs(oe)*A.MathUtils.signum(we)-ce.data.scaleY)*pe}else switch(K){case O.setup:ge=Math.abs(ce.data.scaleX)*A.MathUtils.signum(_e),we=Math.abs(ce.data.scaleY)*A.MathUtils.signum(oe),ce.scaleX=ge+(_e-ge)*pe,ce.scaleY=we+(oe-we)*pe;break;case O.first:case O.replace:ge=Math.abs(ce.scaleX)*A.MathUtils.signum(_e),we=Math.abs(ce.scaleY)*A.MathUtils.signum(oe),ce.scaleX=ge+(_e-ge)*pe,ce.scaleY=we+(oe-we)*pe;break;case O.add:ge=A.MathUtils.signum(_e),we=A.MathUtils.signum(oe),ce.scaleX=Math.abs(ce.scaleX)*ge+(_e-Math.abs(ce.data.scaleX)*ge)*pe,ce.scaleY=Math.abs(ce.scaleY)*we+(oe-Math.abs(ce.data.scaleY)*we)*pe}}}},te}(M);A.ScaleTimeline=N;var k=function(ee){function te(re){return ee.call(this,re)||this}return B(te,ee),te.prototype.getPropertyId=function(){return(P.shear<<24)+this.boneIndex},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=this.frames,le=re.bones[this.boneIndex];if(le.active)if(ne<ue[0])switch(K){case O.setup:return le.shearX=le.data.shearX,void(le.shearY=le.data.shearY);case O.first:le.shearX+=(le.data.shearX-le.shearX)*pe,le.shearY+=(le.data.shearY-le.shearY)*pe}else{var ce=0,_e=0;if(ne>=ue[ue.length-te.ENTRIES])ce=ue[ue.length+te.PREV_X],_e=ue[ue.length+te.PREV_Y];else{var oe=E.binarySearch(ue,ne,te.ENTRIES);ce=ue[oe+te.PREV_X],_e=ue[oe+te.PREV_Y];var de=ue[oe],me=this.getCurvePercent(oe/te.ENTRIES-1,1-(ne-de)/(ue[oe+te.PREV_TIME]-de));ce+=(ue[oe+te.X]-ce)*me,_e+=(ue[oe+te.Y]-_e)*me}switch(K){case O.setup:le.shearX=le.data.shearX+ce*pe,le.shearY=le.data.shearY+_e*pe;break;case O.first:case O.replace:le.shearX+=(le.data.shearX+ce-le.shearX)*pe,le.shearY+=(le.data.shearY+_e-le.shearY)*pe;break;case O.add:le.shearX+=ce*pe,le.shearY+=_e*pe}}},te}(M);A.ShearTimeline=k;var F=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re*te.ENTRIES),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.color<<24)+this.slotIndex},te.prototype.setFrame=function(re,ie,ne,he,pe,K){re*=te.ENTRIES,this.frames[re]=ie,this.frames[re+te.R]=ne,this.frames[re+te.G]=he,this.frames[re+te.B]=pe,this.frames[re+te.A]=K},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=re.slots[this.slotIndex];if(ue.bone.active){var le=this.frames;if(ne<le[0])switch(K){case O.setup:return void ue.color.setFromColor(ue.data.color);case O.first:var ce=ue.color,_e=ue.data.color;ce.add((_e.r-ce.r)*pe,(_e.g-ce.g)*pe,(_e.b-ce.b)*pe,(_e.a-ce.a)*pe)}else{var oe=0,de=0,me=0,ye=0;if(ne>=le[le.length-te.ENTRIES]){var ge=le.length;oe=le[ge+te.PREV_R],de=le[ge+te.PREV_G],me=le[ge+te.PREV_B],ye=le[ge+te.PREV_A]}else{var we=E.binarySearch(le,ne,te.ENTRIES);oe=le[we+te.PREV_R],de=le[we+te.PREV_G],me=le[we+te.PREV_B],ye=le[we+te.PREV_A];var Te=le[we],Ee=this.getCurvePercent(we/te.ENTRIES-1,1-(ne-Te)/(le[we+te.PREV_TIME]-Te));oe+=(le[we+te.R]-oe)*Ee,de+=(le[we+te.G]-de)*Ee,me+=(le[we+te.B]-me)*Ee,ye+=(le[we+te.A]-ye)*Ee}pe==1?ue.color.set(oe,de,me,ye):(ce=ue.color,K==O.setup&&ce.setFromColor(ue.data.color),ce.add((oe-ce.r)*pe,(de-ce.g)*pe,(me-ce.b)*pe,(ye-ce.a)*pe))}}},te.ENTRIES=5,te.PREV_TIME=-5,te.PREV_R=-4,te.PREV_G=-3,te.PREV_B=-2,te.PREV_A=-1,te.R=1,te.G=2,te.B=3,te.A=4,te}(D);A.ColorTimeline=F;var G=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re*te.ENTRIES),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.twoColor<<24)+this.slotIndex},te.prototype.setFrame=function(re,ie,ne,he,pe,K,ue,le,ce){re*=te.ENTRIES,this.frames[re]=ie,this.frames[re+te.R]=ne,this.frames[re+te.G]=he,this.frames[re+te.B]=pe,this.frames[re+te.A]=K,this.frames[re+te.R2]=ue,this.frames[re+te.G2]=le,this.frames[re+te.B2]=ce},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=re.slots[this.slotIndex];if(ue.bone.active){var le=this.frames;if(ne<le[0])switch(K){case O.setup:return ue.color.setFromColor(ue.data.color),void ue.darkColor.setFromColor(ue.data.darkColor);case O.first:var ce=ue.color,_e=ue.darkColor,oe=ue.data.color,de=ue.data.darkColor;ce.add((oe.r-ce.r)*pe,(oe.g-ce.g)*pe,(oe.b-ce.b)*pe,(oe.a-ce.a)*pe),_e.add((de.r-_e.r)*pe,(de.g-_e.g)*pe,(de.b-_e.b)*pe,0)}else{var me=0,ye=0,ge=0,we=0,Te=0,Ee=0,De=0;if(ne>=le[le.length-te.ENTRIES]){var fe=le.length;me=le[fe+te.PREV_R],ye=le[fe+te.PREV_G],ge=le[fe+te.PREV_B],we=le[fe+te.PREV_A],Te=le[fe+te.PREV_R2],Ee=le[fe+te.PREV_G2],De=le[fe+te.PREV_B2]}else{var Ce=E.binarySearch(le,ne,te.ENTRIES);me=le[Ce+te.PREV_R],ye=le[Ce+te.PREV_G],ge=le[Ce+te.PREV_B],we=le[Ce+te.PREV_A],Te=le[Ce+te.PREV_R2],Ee=le[Ce+te.PREV_G2],De=le[Ce+te.PREV_B2];var Se=le[Ce],be=this.getCurvePercent(Ce/te.ENTRIES-1,1-(ne-Se)/(le[Ce+te.PREV_TIME]-Se));me+=(le[Ce+te.R]-me)*be,ye+=(le[Ce+te.G]-ye)*be,ge+=(le[Ce+te.B]-ge)*be,we+=(le[Ce+te.A]-we)*be,Te+=(le[Ce+te.R2]-Te)*be,Ee+=(le[Ce+te.G2]-Ee)*be,De+=(le[Ce+te.B2]-De)*be}pe==1?(ue.color.set(me,ye,ge,we),ue.darkColor.set(Te,Ee,De,1)):(ce=ue.color,_e=ue.darkColor,K==O.setup&&(ce.setFromColor(ue.data.color),_e.setFromColor(ue.data.darkColor)),ce.add((me-ce.r)*pe,(ye-ce.g)*pe,(ge-ce.b)*pe,(we-ce.a)*pe),_e.add((Te-_e.r)*pe,(Ee-_e.g)*pe,(De-_e.b)*pe,0))}}},te.ENTRIES=8,te.PREV_TIME=-8,te.PREV_R=-7,te.PREV_G=-6,te.PREV_B=-5,te.PREV_A=-4,te.PREV_R2=-3,te.PREV_G2=-2,te.PREV_B2=-1,te.R=1,te.G=2,te.B=3,te.A=4,te.R2=5,te.G2=6,te.B2=7,te}(D);A.TwoColorTimeline=G;var V=function(){function ee(te){this.frames=A.Utils.newFloatArray(te),this.attachmentNames=new Array(te)}return ee.prototype.getPropertyId=function(){return(P.attachment<<24)+this.slotIndex},ee.prototype.getFrameCount=function(){return this.frames.length},ee.prototype.setFrame=function(te,re,ie){this.frames[te]=re,this.attachmentNames[te]=ie},ee.prototype.apply=function(te,re,ie,ne,he,pe,K){var ue=te.slots[this.slotIndex];if(ue.bone.active)if(K!=R.mixOut||pe!=O.setup){var le=this.frames;if(ie<le[0]){if(pe==O.setup||pe==O.first){var ce=ue.data.attachmentName;ue.setAttachment(ce==null?null:te.getAttachment(this.slotIndex,ce))}}else{var _e;_e=ie>=le[le.length-1]?le.length-1:E.binarySearch(le,ie,1)-1;var oe=this.attachmentNames[_e];te.slots[this.slotIndex].setAttachment(oe==null?null:te.getAttachment(this.slotIndex,oe))}}else{var de=ue.data.attachmentName;ue.setAttachment(de==null?null:te.getAttachment(this.slotIndex,de))}},ee}();A.AttachmentTimeline=V;var j=null,H=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re),ie.frameVertices=new Array(re),j==null&&(j=A.Utils.newFloatArray(64)),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.deform<<27)+ +this.attachment.id+this.slotIndex},te.prototype.setFrame=function(re,ie,ne){this.frames[re]=ie,this.frameVertices[re]=ne},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=re.slots[this.slotIndex];if(ue.bone.active){var le=ue.getAttachment();if(le instanceof A.VertexAttachment&&le.deformAttachment==this.attachment){var ce=ue.deform;ce.length==0&&(K=O.setup);var _e=this.frameVertices,oe=_e[0].length,de=this.frames;if(ne<de[0]){var me=le;switch(K){case O.setup:return void(ce.length=0);case O.first:if(pe==1){ce.length=0;break}var ye=A.Utils.setArraySize(ce,oe);if(me.bones==null)for(var ge=me.vertices,we=0;we<oe;we++)ye[we]+=(ge[we]-ye[we])*pe;else for(pe=1-pe,we=0;we<oe;we++)ye[we]*=pe}}else{var Te=A.Utils.setArraySize(ce,oe);if(ne>=de[de.length-1]){var Ee=_e[de.length-1];if(pe==1)if(K==O.add)if((me=le).bones==null){ge=me.vertices;for(var De=0;De<oe;De++)Te[De]+=Ee[De]-ge[De]}else for(var fe=0;fe<oe;fe++)Te[fe]+=Ee[fe];else A.Utils.arrayCopy(Ee,0,Te,0,oe);else switch(K){case O.setup:var Ce=le;if(Ce.bones==null){ge=Ce.vertices;for(var Se=0;Se<oe;Se++){var be=ge[Se];Te[Se]=be+(Ee[Se]-be)*pe}}else for(var Re=0;Re<oe;Re++)Te[Re]=Ee[Re]*pe;break;case O.first:case O.replace:for(var Ve=0;Ve<oe;Ve++)Te[Ve]+=(Ee[Ve]-Te[Ve])*pe;case O.add:if((me=le).bones==null){ge=me.vertices;for(var Pe=0;Pe<oe;Pe++)Te[Pe]+=(Ee[Pe]-ge[Pe])*pe}else for(var ke=0;ke<oe;ke++)Te[ke]+=Ee[ke]*pe}}else{var Ne=E.binarySearch(de,ne),Ae=_e[Ne-1],Oe=_e[Ne],Fe=de[Ne],nt=this.getCurvePercent(Ne-1,1-(ne-Fe)/(de[Ne-1]-Fe));if(pe==1)if(K==O.add)if((me=le).bones==null){ge=me.vertices;for(var Ze=0;Ze<oe;Ze++){var Xe=Ae[Ze];Te[Ze]+=Xe+(Oe[Ze]-Xe)*nt-ge[Ze]}}else for(var $e=0;$e<oe;$e++)Xe=Ae[$e],Te[$e]+=Xe+(Oe[$e]-Xe)*nt;else for(var ot=0;ot<oe;ot++)Xe=Ae[ot],Te[ot]=Xe+(Oe[ot]-Xe)*nt;else switch(K){case O.setup:var ut=le;if(ut.bones==null){ge=ut.vertices;for(var gt=0;gt<oe;gt++)Xe=Ae[gt],be=ge[gt],Te[gt]=be+(Xe+(Oe[gt]-Xe)*nt-be)*pe}else for(var Ue=0;Ue<oe;Ue++)Xe=Ae[Ue],Te[Ue]=(Xe+(Oe[Ue]-Xe)*nt)*pe;break;case O.first:case O.replace:for(var We=0;We<oe;We++)Xe=Ae[We],Te[We]+=(Xe+(Oe[We]-Xe)*nt-Te[We])*pe;break;case O.add:if((me=le).bones==null){ge=me.vertices;for(var ht=0;ht<oe;ht++)Xe=Ae[ht],Te[ht]+=(Xe+(Oe[ht]-Xe)*nt-ge[ht])*pe}else for(var Be=0;Be<oe;Be++)Xe=Ae[Be],Te[Be]+=(Xe+(Oe[Be]-Xe)*nt)*pe}}}}}},te}(D);A.DeformTimeline=H;var U=function(){function ee(te){this.frames=A.Utils.newFloatArray(te),this.events=new Array(te)}return ee.prototype.getPropertyId=function(){return P.event<<24},ee.prototype.getFrameCount=function(){return this.frames.length},ee.prototype.setFrame=function(te,re){this.frames[te]=re.time,this.events[te]=re},ee.prototype.apply=function(te,re,ie,ne,he,pe,K){if(ne!=null){var ue=this.frames,le=this.frames.length;if(re>ie)this.apply(te,re,Number.MAX_VALUE,ne,he,pe,K),re=-1;else if(re>=ue[le-1])return;if(!(ie<ue[0])){var ce=0;if(re<ue[0])ce=0;else for(var _e=ue[ce=E.binarySearch(ue,re)];ce>0&&ue[ce-1]==_e;)ce--;for(;ce<le&&ie>=ue[ce];ce++)ne.push(this.events[ce])}}},ee}();A.EventTimeline=U;var X=function(){function ee(te){this.frames=A.Utils.newFloatArray(te),this.drawOrders=new Array(te)}return ee.prototype.getPropertyId=function(){return P.drawOrder<<24},ee.prototype.getFrameCount=function(){return this.frames.length},ee.prototype.setFrame=function(te,re,ie){this.frames[te]=re,this.drawOrders[te]=ie},ee.prototype.apply=function(te,re,ie,ne,he,pe,K){var ue=te.drawOrder,le=te.slots;if(K!=R.mixOut||pe!=O.setup){var ce=this.frames;if(ie<ce[0])pe!=O.setup&&pe!=O.first||A.Utils.arrayCopy(te.slots,0,te.drawOrder,0,te.slots.length);else{var _e;_e=ie>=ce[ce.length-1]?ce.length-1:E.binarySearch(ce,ie)-1;var oe=this.drawOrders[_e];if(oe==null)A.Utils.arrayCopy(le,0,ue,0,le.length);else for(var de=0,me=oe.length;de<me;de++)ue[de]=le[oe[de]]}}else A.Utils.arrayCopy(te.slots,0,te.drawOrder,0,te.slots.length)},ee}();A.DrawOrderTimeline=X;var Y=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re*te.ENTRIES),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.ikConstraint<<24)+this.ikConstraintIndex},te.prototype.setFrame=function(re,ie,ne,he,pe,K,ue){re*=te.ENTRIES,this.frames[re]=ie,this.frames[re+te.MIX]=ne,this.frames[re+te.SOFTNESS]=he,this.frames[re+te.BEND_DIRECTION]=pe,this.frames[re+te.COMPRESS]=K?1:0,this.frames[re+te.STRETCH]=ue?1:0},te.prototype.apply=function(re,ie,ne,he,pe,K,ue){var le=this.frames,ce=re.ikConstraints[this.ikConstraintIndex];if(ce.active)if(ne<le[0])switch(K){case O.setup:return ce.mix=ce.data.mix,ce.softness=ce.data.softness,ce.bendDirection=ce.data.bendDirection,ce.compress=ce.data.compress,void(ce.stretch=ce.data.stretch);case O.first:ce.mix+=(ce.data.mix-ce.mix)*pe,ce.softness+=(ce.data.softness-ce.softness)*pe,ce.bendDirection=ce.data.bendDirection,ce.compress=ce.data.compress,ce.stretch=ce.data.stretch}else if(ne>=le[le.length-te.ENTRIES])K==O.setup?(ce.mix=ce.data.mix+(le[le.length+te.PREV_MIX]-ce.data.mix)*pe,ce.softness=ce.data.softness+(le[le.length+te.PREV_SOFTNESS]-ce.data.softness)*pe,ue==R.mixOut?(ce.bendDirection=ce.data.bendDirection,ce.compress=ce.data.compress,ce.stretch=ce.data.stretch):(ce.bendDirection=le[le.length+te.PREV_BEND_DIRECTION],ce.compress=le[le.length+te.PREV_COMPRESS]!=0,ce.stretch=le[le.length+te.PREV_STRETCH]!=0)):(ce.mix+=(le[le.length+te.PREV_MIX]-ce.mix)*pe,ce.softness+=(le[le.length+te.PREV_SOFTNESS]-ce.softness)*pe,ue==R.mixIn&&(ce.bendDirection=le[le.length+te.PREV_BEND_DIRECTION],ce.compress=le[le.length+te.PREV_COMPRESS]!=0,ce.stretch=le[le.length+te.PREV_STRETCH]!=0));else{var _e=E.binarySearch(le,ne,te.ENTRIES),oe=le[_e+te.PREV_MIX],de=le[_e+te.PREV_SOFTNESS],me=le[_e],ye=this.getCurvePercent(_e/te.ENTRIES-1,1-(ne-me)/(le[_e+te.PREV_TIME]-me));K==O.setup?(ce.mix=ce.data.mix+(oe+(le[_e+te.MIX]-oe)*ye-ce.data.mix)*pe,ce.softness=ce.data.softness+(de+(le[_e+te.SOFTNESS]-de)*ye-ce.data.softness)*pe,ue==R.mixOut?(ce.bendDirection=ce.data.bendDirection,ce.compress=ce.data.compress,ce.stretch=ce.data.stretch):(ce.bendDirection=le[_e+te.PREV_BEND_DIRECTION],ce.compress=le[_e+te.PREV_COMPRESS]!=0,ce.stretch=le[_e+te.PREV_STRETCH]!=0)):(ce.mix+=(oe+(le[_e+te.MIX]-oe)*ye-ce.mix)*pe,ce.softness+=(de+(le[_e+te.SOFTNESS]-de)*ye-ce.softness)*pe,ue==R.mixIn&&(ce.bendDirection=le[_e+te.PREV_BEND_DIRECTION],ce.compress=le[_e+te.PREV_COMPRESS]!=0,ce.stretch=le[_e+te.PREV_STRETCH]!=0))}},te.ENTRIES=6,te.PREV_TIME=-6,te.PREV_MIX=-5,te.PREV_SOFTNESS=-4,te.PREV_BEND_DIRECTION=-3,te.PREV_COMPRESS=-2,te.PREV_STRETCH=-1,te.MIX=1,te.SOFTNESS=2,te.BEND_DIRECTION=3,te.COMPRESS=4,te.STRETCH=5,te}(D);A.IkConstraintTimeline=Y;var z=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re*te.ENTRIES),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.transformConstraint<<24)+this.transformConstraintIndex},te.prototype.setFrame=function(re,ie,ne,he,pe,K){re*=te.ENTRIES,this.frames[re]=ie,this.frames[re+te.ROTATE]=ne,this.frames[re+te.TRANSLATE]=he,this.frames[re+te.SCALE]=pe,this.frames[re+te.SHEAR]=K},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=this.frames,le=re.transformConstraints[this.transformConstraintIndex];if(le.active)if(ne<ue[0]){var ce=le.data;switch(K){case O.setup:return le.rotateMix=ce.rotateMix,le.translateMix=ce.translateMix,le.scaleMix=ce.scaleMix,void(le.shearMix=ce.shearMix);case O.first:le.rotateMix+=(ce.rotateMix-le.rotateMix)*pe,le.translateMix+=(ce.translateMix-le.translateMix)*pe,le.scaleMix+=(ce.scaleMix-le.scaleMix)*pe,le.shearMix+=(ce.shearMix-le.shearMix)*pe}}else{var _e=0,oe=0,de=0,me=0;if(ne>=ue[ue.length-te.ENTRIES]){var ye=ue.length;_e=ue[ye+te.PREV_ROTATE],oe=ue[ye+te.PREV_TRANSLATE],de=ue[ye+te.PREV_SCALE],me=ue[ye+te.PREV_SHEAR]}else{var ge=E.binarySearch(ue,ne,te.ENTRIES);_e=ue[ge+te.PREV_ROTATE],oe=ue[ge+te.PREV_TRANSLATE],de=ue[ge+te.PREV_SCALE],me=ue[ge+te.PREV_SHEAR];var we=ue[ge],Te=this.getCurvePercent(ge/te.ENTRIES-1,1-(ne-we)/(ue[ge+te.PREV_TIME]-we));_e+=(ue[ge+te.ROTATE]-_e)*Te,oe+=(ue[ge+te.TRANSLATE]-oe)*Te,de+=(ue[ge+te.SCALE]-de)*Te,me+=(ue[ge+te.SHEAR]-me)*Te}K==O.setup?(ce=le.data,le.rotateMix=ce.rotateMix+(_e-ce.rotateMix)*pe,le.translateMix=ce.translateMix+(oe-ce.translateMix)*pe,le.scaleMix=ce.scaleMix+(de-ce.scaleMix)*pe,le.shearMix=ce.shearMix+(me-ce.shearMix)*pe):(le.rotateMix+=(_e-le.rotateMix)*pe,le.translateMix+=(oe-le.translateMix)*pe,le.scaleMix+=(de-le.scaleMix)*pe,le.shearMix+=(me-le.shearMix)*pe)}},te.ENTRIES=5,te.PREV_TIME=-5,te.PREV_ROTATE=-4,te.PREV_TRANSLATE=-3,te.PREV_SCALE=-2,te.PREV_SHEAR=-1,te.ROTATE=1,te.TRANSLATE=2,te.SCALE=3,te.SHEAR=4,te}(D);A.TransformConstraintTimeline=z;var W=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re*te.ENTRIES),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.pathConstraintPosition<<24)+this.pathConstraintIndex},te.prototype.setFrame=function(re,ie,ne){re*=te.ENTRIES,this.frames[re]=ie,this.frames[re+te.VALUE]=ne},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=this.frames,le=re.pathConstraints[this.pathConstraintIndex];if(le.active)if(ne<ue[0])switch(K){case O.setup:return void(le.position=le.data.position);case O.first:le.position+=(le.data.position-le.position)*pe}else{var ce=0;if(ne>=ue[ue.length-te.ENTRIES])ce=ue[ue.length+te.PREV_VALUE];else{var _e=E.binarySearch(ue,ne,te.ENTRIES);ce=ue[_e+te.PREV_VALUE];var oe=ue[_e],de=this.getCurvePercent(_e/te.ENTRIES-1,1-(ne-oe)/(ue[_e+te.PREV_TIME]-oe));ce+=(ue[_e+te.VALUE]-ce)*de}K==O.setup?le.position=le.data.position+(ce-le.data.position)*pe:le.position+=(ce-le.position)*pe}},te.ENTRIES=2,te.PREV_TIME=-2,te.PREV_VALUE=-1,te.VALUE=1,te}(D);A.PathConstraintPositionTimeline=W;var Z=function(ee){function te(re){return ee.call(this,re)||this}return B(te,ee),te.prototype.getPropertyId=function(){return(P.pathConstraintSpacing<<24)+this.pathConstraintIndex},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=this.frames,le=re.pathConstraints[this.pathConstraintIndex];if(le.active)if(ne<ue[0])switch(K){case O.setup:return void(le.spacing=le.data.spacing);case O.first:le.spacing+=(le.data.spacing-le.spacing)*pe}else{var ce=0;if(ne>=ue[ue.length-te.ENTRIES])ce=ue[ue.length+te.PREV_VALUE];else{var _e=E.binarySearch(ue,ne,te.ENTRIES);ce=ue[_e+te.PREV_VALUE];var oe=ue[_e],de=this.getCurvePercent(_e/te.ENTRIES-1,1-(ne-oe)/(ue[_e+te.PREV_TIME]-oe));ce+=(ue[_e+te.VALUE]-ce)*de}K==O.setup?le.spacing=le.data.spacing+(ce-le.data.spacing)*pe:le.spacing+=(ce-le.spacing)*pe}},te}(W);A.PathConstraintSpacingTimeline=Z;var Q=function(ee){function te(re){var ie=ee.call(this,re)||this;return ie.frames=A.Utils.newFloatArray(re*te.ENTRIES),ie}return B(te,ee),te.prototype.getPropertyId=function(){return(P.pathConstraintMix<<24)+this.pathConstraintIndex},te.prototype.setFrame=function(re,ie,ne,he){re*=te.ENTRIES,this.frames[re]=ie,this.frames[re+te.ROTATE]=ne,this.frames[re+te.TRANSLATE]=he},te.prototype.apply=function(re,ie,ne,he,pe,K){var ue=this.frames,le=re.pathConstraints[this.pathConstraintIndex];if(le.active)if(ne<ue[0])switch(K){case O.setup:return le.rotateMix=le.data.rotateMix,void(le.translateMix=le.data.translateMix);case O.first:le.rotateMix+=(le.data.rotateMix-le.rotateMix)*pe,le.translateMix+=(le.data.translateMix-le.translateMix)*pe}else{var ce=0,_e=0;if(ne>=ue[ue.length-te.ENTRIES])ce=ue[ue.length+te.PREV_ROTATE],_e=ue[ue.length+te.PREV_TRANSLATE];else{var oe=E.binarySearch(ue,ne,te.ENTRIES);ce=ue[oe+te.PREV_ROTATE],_e=ue[oe+te.PREV_TRANSLATE];var de=ue[oe],me=this.getCurvePercent(oe/te.ENTRIES-1,1-(ne-de)/(ue[oe+te.PREV_TIME]-de));ce+=(ue[oe+te.ROTATE]-ce)*me,_e+=(ue[oe+te.TRANSLATE]-_e)*me}K==O.setup?(le.rotateMix=le.data.rotateMix+(ce-le.data.rotateMix)*pe,le.translateMix=le.data.translateMix+(_e-le.data.translateMix)*pe):(le.rotateMix+=(ce-le.rotateMix)*pe,le.translateMix+=(_e-le.translateMix)*pe)}},te.ENTRIES=3,te.PREV_TIME=-3,te.PREV_ROTATE=-2,te.PREV_TRANSLATE=-1,te.ROTATE=1,te.TRANSLATE=2,te}(D);A.PathConstraintMixTimeline=Q})(w||(w={})),function(A){var O=function(){function I(M){this.tracks=new Array,this.timeScale=1,this.events=new Array,this.listeners=new Array,this.queue=new E(this),this.propertyIDs=new A.IntSet,this.animationsChanged=!1,this.trackEntryPool=new A.Pool(function(){return new R}),this.data=M}return I.prototype.update=function(M){M*=this.timeScale;for(var N=this.tracks,k=0,F=N.length;k<F;k++){var G=N[k];if(G!=null){G.animationLast=G.nextAnimationLast,G.trackLast=G.nextTrackLast;var V=M*G.timeScale;if(G.delay>0){if(G.delay-=V,G.delay>0)continue;V=-G.delay,G.delay=0}var j=G.next;if(j!=null){var H=G.trackLast-j.delay;if(H>=0){for(j.delay=0,j.trackTime+=G.timeScale==0?0:(H/G.timeScale+M)*j.timeScale,G.trackTime+=V,this.setCurrent(k,j,!0);j.mixingFrom!=null;)j.mixTime+=M,j=j.mixingFrom;continue}}else if(G.trackLast>=G.trackEnd&&G.mixingFrom==null){N[k]=null,this.queue.end(G),this.disposeNext(G);continue}if(G.mixingFrom!=null&&this.updateMixingFrom(G,M)){var U=G.mixingFrom;for(G.mixingFrom=null,U!=null&&(U.mixingTo=null);U!=null;)this.queue.end(U),U=U.mixingFrom}G.trackTime+=V}}this.queue.drain()},I.prototype.updateMixingFrom=function(M,N){var k=M.mixingFrom;if(k==null)return!0;var F=this.updateMixingFrom(k,N);return k.animationLast=k.nextAnimationLast,k.trackLast=k.nextTrackLast,M.mixTime>0&&M.mixTime>=M.mixDuration?(k.totalAlpha!=0&&M.mixDuration!=0||(M.mixingFrom=k.mixingFrom,k.mixingFrom!=null&&(k.mixingFrom.mixingTo=M),M.interruptAlpha=k.interruptAlpha,this.queue.end(k)),F):(k.trackTime+=N*k.timeScale,M.mixTime+=N,!1)},I.prototype.apply=function(M){if(M==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var N=this.events,k=this.tracks,F=!1,G=0,V=k.length;G<V;G++){var j=k[G];if(!(j==null||j.delay>0)){F=!0;var H=G==0?A.MixBlend.first:j.mixBlend,U=j.alpha;j.mixingFrom!=null?U*=this.applyMixingFrom(j,M,H):j.trackTime>=j.trackEnd&&j.next==null&&(U=0);var X=j.animationLast,Y=j.getAnimationTime(),z=j.animation.timelines.length,W=j.animation.timelines;if(G==0&&U==1||H==A.MixBlend.add)for(var Z=0;Z<z;Z++)A.Utils.webkit602BugfixHelper(U,H),W[Z].apply(M,X,Y,N,U,H,A.MixDirection.mixIn);else{var Q=j.timelineMode,ee=j.timelinesRotation.length==0;ee&&A.Utils.setArraySize(j.timelinesRotation,z<<1,null);var te=j.timelinesRotation;for(Z=0;Z<z;Z++){var re=W[Z],ie=(Q[Z]&I.NOT_LAST-1)==I.SUBSEQUENT?H:A.MixBlend.setup;re instanceof A.RotateTimeline?this.applyRotateTimeline(re,M,Y,U,ie,te,Z<<1,ee):(A.Utils.webkit602BugfixHelper(U,H),re.apply(M,X,Y,N,U,ie,A.MixDirection.mixIn))}}this.queueEvents(j,Y),N.length=0,j.nextAnimationLast=Y,j.nextTrackLast=j.trackTime}}return this.queue.drain(),F},I.prototype.applyMixingFrom=function(M,N,k){var F=M.mixingFrom;F.mixingFrom!=null&&this.applyMixingFrom(F,N,k);var G=0;M.mixDuration==0?(G=1,k==A.MixBlend.first&&(k=A.MixBlend.setup)):((G=M.mixTime/M.mixDuration)>1&&(G=1),k!=A.MixBlend.first&&(k=F.mixBlend));var V=G<F.eventThreshold?this.events:null,j=G<F.attachmentThreshold,H=G<F.drawOrderThreshold,U=F.animationLast,X=F.getAnimationTime(),Y=F.animation.timelines.length,z=F.animation.timelines,W=F.alpha*M.interruptAlpha,Z=W*(1-G);if(k==A.MixBlend.add)for(var Q=0;Q<Y;Q++)z[Q].apply(N,U,X,V,Z,k,A.MixDirection.mixOut);else{var ee=F.timelineMode,te=F.timelineHoldMix,re=F.timelinesRotation.length==0;re&&A.Utils.setArraySize(F.timelinesRotation,Y<<1,null);var ie=F.timelinesRotation;for(F.totalAlpha=0,Q=0;Q<Y;Q++){var ne=z[Q],he=A.MixDirection.mixOut,pe=void 0,K=0;switch(ee[Q]&I.NOT_LAST-1){case I.SUBSEQUENT:if(pe=k,!j&&ne instanceof A.AttachmentTimeline){if((ee[Q]&I.NOT_LAST)==I.NOT_LAST)continue;pe=A.MixBlend.setup}if(!H&&ne instanceof A.DrawOrderTimeline)continue;K=Z;break;case I.FIRST:pe=A.MixBlend.setup,K=Z;break;case I.HOLD:pe=A.MixBlend.setup,K=W;break;default:pe=A.MixBlend.setup;var ue=te[Q];K=W*Math.max(0,1-ue.mixTime/ue.mixDuration)}F.totalAlpha+=K,ne instanceof A.RotateTimeline?this.applyRotateTimeline(ne,N,X,K,pe,ie,Q<<1,re):(A.Utils.webkit602BugfixHelper(K,k),pe==A.MixBlend.setup&&(ne instanceof A.AttachmentTimeline?(j||(ee[Q]&I.NOT_LAST)==I.NOT_LAST)&&(he=A.MixDirection.mixIn):ne instanceof A.DrawOrderTimeline&&H&&(he=A.MixDirection.mixIn)),ne.apply(N,U,X,V,K,pe,he))}}return M.mixDuration>0&&this.queueEvents(F,X),this.events.length=0,F.nextAnimationLast=X,F.nextTrackLast=F.trackTime,G},I.prototype.applyRotateTimeline=function(M,N,k,F,G,V,j,H){if(H&&(V[j]=0),F!=1){var U=M,X=U.frames,Y=N.bones[U.boneIndex];if(Y.active){var z=0,W=0;if(k<X[0])switch(G){case A.MixBlend.setup:Y.rotation=Y.data.rotation;default:return;case A.MixBlend.first:z=Y.rotation,W=Y.data.rotation}else if(z=G==A.MixBlend.setup?Y.data.rotation:Y.rotation,k>=X[X.length-A.RotateTimeline.ENTRIES])W=Y.data.rotation+X[X.length+A.RotateTimeline.PREV_ROTATION];else{var Z=A.Animation.binarySearch(X,k,A.RotateTimeline.ENTRIES),Q=X[Z+A.RotateTimeline.PREV_ROTATION],ee=X[Z],te=U.getCurvePercent((Z>>1)-1,1-(k-ee)/(X[Z+A.RotateTimeline.PREV_TIME]-ee));W=X[Z+A.RotateTimeline.ROTATION]-Q,W=Q+(W-=360*(16384-(16384.499999999996-W/360|0)))*te+Y.data.rotation,W-=360*(16384-(16384.499999999996-W/360|0))}var re=0,ie=W-z;if((ie-=360*(16384-(16384.499999999996-ie/360|0)))==0)re=V[j];else{var ne=0,he=0;H?(ne=0,he=ie):(ne=V[j],he=V[j+1]);var pe=ie>0,K=ne>=0;A.MathUtils.signum(he)!=A.MathUtils.signum(ie)&&Math.abs(he)<=90&&(Math.abs(ne)>180&&(ne+=360*A.MathUtils.signum(ne)),K=pe),re=ie+ne-ne%360,K!=pe&&(re+=360*A.MathUtils.signum(ne)),V[j]=re}V[j+1]=ie,z+=re*F,Y.rotation=z-360*(16384-(16384.499999999996-z/360|0))}}else M.apply(N,0,k,null,1,G,A.MixDirection.mixIn)},I.prototype.queueEvents=function(M,N){for(var k=M.animationStart,F=M.animationEnd,G=F-k,V=M.trackLast%G,j=this.events,H=0,U=j.length;H<U;H++){var X=j[H];if(X.time<V)break;X.time>F||this.queue.event(M,X)}for((M.loop?G==0||V>M.trackTime%G:N>=F&&M.animationLast<F)&&this.queue.complete(M);H<U;H++)j[H].time<k||this.queue.event(M,j[H])},I.prototype.clearTracks=function(){var M=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var N=0,k=this.tracks.length;N<k;N++)this.clearTrack(N);this.tracks.length=0,this.queue.drainDisabled=M,this.queue.drain()},I.prototype.clearTrack=function(M){if(!(M>=this.tracks.length)){var N=this.tracks[M];if(N!=null){this.queue.end(N),this.disposeNext(N);for(var k=N;;){var F=k.mixingFrom;if(F==null)break;this.queue.end(F),k.mixingFrom=null,k.mixingTo=null,k=F}this.tracks[N.trackIndex]=null,this.queue.drain()}}},I.prototype.setCurrent=function(M,N,k){var F=this.expandToIndex(M);this.tracks[M]=N,F!=null&&(k&&this.queue.interrupt(F),N.mixingFrom=F,F.mixingTo=N,N.mixTime=0,F.mixingFrom!=null&&F.mixDuration>0&&(N.interruptAlpha*=Math.min(1,F.mixTime/F.mixDuration)),F.timelinesRotation.length=0),this.queue.start(N)},I.prototype.setAnimation=function(M,N,k){var F=this.data.skeletonData.findAnimation(N);if(F==null)throw new Error("Animation not found: "+N);return this.setAnimationWith(M,F,k)},I.prototype.setAnimationWith=function(M,N,k){if(N==null)throw new Error("animation cannot be null.");var F=!0,G=this.expandToIndex(M);G!=null&&(G.nextTrackLast==-1?(this.tracks[M]=G.mixingFrom,this.queue.interrupt(G),this.queue.end(G),this.disposeNext(G),G=G.mixingFrom,F=!1):this.disposeNext(G));var V=this.trackEntry(M,N,k,G);return this.setCurrent(M,V,F),this.queue.drain(),V},I.prototype.addAnimation=function(M,N,k,F){var G=this.data.skeletonData.findAnimation(N);if(G==null)throw new Error("Animation not found: "+N);return this.addAnimationWith(M,G,k,F)},I.prototype.addAnimationWith=function(M,N,k,F){if(N==null)throw new Error("animation cannot be null.");var G=this.expandToIndex(M);if(G!=null)for(;G.next!=null;)G=G.next;var V=this.trackEntry(M,N,k,G);if(G==null)this.setCurrent(M,V,!0),this.queue.drain();else if(G.next=V,F<=0){var j=G.animationEnd-G.animationStart;j!=0?(G.loop?F+=j*(1+(G.trackTime/j|0)):F+=Math.max(j,G.trackTime),F-=this.data.getMix(G.animation,N)):F=G.trackTime}return V.delay=F,V},I.prototype.setEmptyAnimation=function(M,N){var k=this.setAnimationWith(M,I.emptyAnimation,!1);return k.mixDuration=N,k.trackEnd=N,k},I.prototype.addEmptyAnimation=function(M,N,k){k<=0&&(k-=N);var F=this.addAnimationWith(M,I.emptyAnimation,!1,k);return F.mixDuration=N,F.trackEnd=N,F},I.prototype.setEmptyAnimations=function(M){var N=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var k=0,F=this.tracks.length;k<F;k++){var G=this.tracks[k];G!=null&&this.setEmptyAnimation(G.trackIndex,M)}this.queue.drainDisabled=N,this.queue.drain()},I.prototype.expandToIndex=function(M){return M<this.tracks.length?this.tracks[M]:(A.Utils.ensureArrayCapacity(this.tracks,M+1,null),this.tracks.length=M+1,null)},I.prototype.trackEntry=function(M,N,k,F){var G=this.trackEntryPool.obtain();return G.trackIndex=M,G.animation=N,G.loop=k,G.holdPrevious=!1,G.eventThreshold=0,G.attachmentThreshold=0,G.drawOrderThreshold=0,G.animationStart=0,G.animationEnd=N.duration,G.animationLast=-1,G.nextAnimationLast=-1,G.delay=0,G.trackTime=0,G.trackLast=-1,G.nextTrackLast=-1,G.trackEnd=Number.MAX_VALUE,G.timeScale=1,G.alpha=1,G.interruptAlpha=1,G.mixTime=0,G.mixDuration=F==null?0:this.data.getMix(F.animation,N),G},I.prototype.disposeNext=function(M){for(var N=M.next;N!=null;)this.queue.dispose(N),N=N.next;M.next=null},I.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var M=0,N=this.tracks.length;M<N;M++)if((k=this.tracks[M])!=null){for(;k.mixingFrom!=null;)k=k.mixingFrom;do k.mixingFrom!=null&&k.mixBlend==A.MixBlend.add||this.computeHold(k),k=k.mixingTo;while(k!=null)}for(this.propertyIDs.clear(),M=this.tracks.length-1;M>=0;M--)for(var k=this.tracks[M];k!=null;)this.computeNotLast(k),k=k.mixingFrom},I.prototype.computeHold=function(M){var N=M.mixingTo,k=M.animation.timelines,F=M.animation.timelines.length,G=A.Utils.setArraySize(M.timelineMode,F);M.timelineHoldMix.length=0;var V=A.Utils.setArraySize(M.timelineHoldMix,F),j=this.propertyIDs;if(N!=null&&N.holdPrevious)for(var H=0;H<F;H++)j.add(k[H].getPropertyId()),G[H]=I.HOLD;else e:for(H=0;H<F;H++){var U=k[H],X=U.getPropertyId();if(j.add(X))if(N==null||U instanceof A.AttachmentTimeline||U instanceof A.DrawOrderTimeline||U instanceof A.EventTimeline||!N.animation.hasTimeline(X))G[H]=I.FIRST;else{for(var Y=N.mixingTo;Y!=null;Y=Y.mixingTo)if(!Y.animation.hasTimeline(X)){if(M.mixDuration>0){G[H]=I.HOLD_MIX,V[H]=Y;continue e}break}G[H]=I.HOLD}else G[H]=I.SUBSEQUENT}},I.prototype.computeNotLast=function(M){for(var N=M.animation.timelines,k=M.animation.timelines.length,F=M.timelineMode,G=this.propertyIDs,V=0;V<k;V++)if(N[V]instanceof A.AttachmentTimeline){var j=N[V];G.add(j.slotIndex)||(F[V]|=I.NOT_LAST)}},I.prototype.getCurrent=function(M){return M>=this.tracks.length?null:this.tracks[M]},I.prototype.addListener=function(M){if(M==null)throw new Error("listener cannot be null.");this.listeners.push(M)},I.prototype.removeListener=function(M){var N=this.listeners.indexOf(M);N>=0&&this.listeners.splice(N,1)},I.prototype.clearListeners=function(){this.listeners.length=0},I.prototype.clearListenerNotifications=function(){this.queue.clear()},I.emptyAnimation=new A.Animation("<empty>",[],0),I.SUBSEQUENT=0,I.FIRST=1,I.HOLD=2,I.HOLD_MIX=3,I.NOT_LAST=4,I}();A.AnimationState=O;var R=function(){function I(){this.mixBlend=A.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return I.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},I.prototype.getAnimationTime=function(){if(this.loop){var M=this.animationEnd-this.animationStart;return M==0?this.animationStart:this.trackTime%M+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},I.prototype.setAnimationLast=function(M){this.animationLast=M,this.nextAnimationLast=M},I.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},I.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},I}();A.TrackEntry=R;var P,E=function(){function I(M){this.objects=[],this.drainDisabled=!1,this.animState=M}return I.prototype.start=function(M){this.objects.push(P.start),this.objects.push(M),this.animState.animationsChanged=!0},I.prototype.interrupt=function(M){this.objects.push(P.interrupt),this.objects.push(M)},I.prototype.end=function(M){this.objects.push(P.end),this.objects.push(M),this.animState.animationsChanged=!0},I.prototype.dispose=function(M){this.objects.push(P.dispose),this.objects.push(M)},I.prototype.complete=function(M){this.objects.push(P.complete),this.objects.push(M)},I.prototype.event=function(M,N){this.objects.push(P.event),this.objects.push(M),this.objects.push(N)},I.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var M=this.objects,N=this.animState.listeners,k=0;k<M.length;k+=2){var F=M[k],G=M[k+1];switch(F){case P.start:G.listener!=null&&G.listener.start&&G.listener.start(G);for(var V=0;V<N.length;V++)N[V].start&&N[V].start(G);break;case P.interrupt:for(G.listener!=null&&G.listener.interrupt&&G.listener.interrupt(G),V=0;V<N.length;V++)N[V].interrupt&&N[V].interrupt(G);break;case P.end:for(G.listener!=null&&G.listener.end&&G.listener.end(G),V=0;V<N.length;V++)N[V].end&&N[V].end(G);case P.dispose:for(G.listener!=null&&G.listener.dispose&&G.listener.dispose(G),V=0;V<N.length;V++)N[V].dispose&&N[V].dispose(G);this.animState.trackEntryPool.free(G);break;case P.complete:for(G.listener!=null&&G.listener.complete&&G.listener.complete(G),V=0;V<N.length;V++)N[V].complete&&N[V].complete(G);break;case P.event:var j=M[2+k++];for(G.listener!=null&&G.listener.event&&G.listener.event(G,j),V=0;V<N.length;V++)N[V].event&&N[V].event(G,j)}}this.clear(),this.drainDisabled=!1}},I.prototype.clear=function(){this.objects.length=0},I}();A.EventQueue=E,function(I){I[I.start=0]="start",I[I.interrupt=1]="interrupt",I[I.end=2]="end",I[I.dispose=3]="dispose",I[I.complete=4]="complete",I[I.event=5]="event"}(P=A.EventType||(A.EventType={}));var D=function(){function I(){}return I.prototype.start=function(){},I.prototype.interrupt=function(){},I.prototype.end=function(){},I.prototype.dispose=function(){},I.prototype.complete=function(){},I.prototype.event=function(){},I}();A.AnimationStateAdapter=D}(w||(w={})),function(A){var O=function(){function R(P){if(this.animationToMixTime={},this.defaultMix=0,P==null)throw new Error("skeletonData cannot be null.");this.skeletonData=P}return R.prototype.setMix=function(P,E,D){var I=this.skeletonData.findAnimation(P);if(I==null)throw new Error("Animation not found: "+P);var M=this.skeletonData.findAnimation(E);if(M==null)throw new Error("Animation not found: "+E);this.setMixWith(I,M,D)},R.prototype.setMixWith=function(P,E,D){if(P==null)throw new Error("from cannot be null.");if(E==null)throw new Error("to cannot be null.");var I=P.name+"."+E.name;this.animationToMixTime[I]=D},R.prototype.getMix=function(P,E){var D=P.name+"."+E.name,I=this.animationToMixTime[D];return I===void 0?this.defaultMix:I},R}();A.AnimationStateData=O}(w||(w={})),function(A){var O=function(){function R(P,E){E===void 0&&(E=""),this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.textureLoader=P,this.pathPrefix=E}return R.downloadText=function(P,E,D){var I=new XMLHttpRequest;I.open("GET",P,!0),I.onload=function(){I.status==200?E(I.responseText):D(I.status,I.responseText)},I.onerror=function(){D(I.status,I.responseText)},I.send()},R.downloadBinary=function(P,E,D){var I=new XMLHttpRequest;I.open("GET",P,!0),I.responseType="arraybuffer",I.onload=function(){I.status==200?E(new Uint8Array(I.response)):D(I.status,I.responseText)},I.onerror=function(){D(I.status,I.responseText)},I.send()},R.prototype.loadBinary=function(P,E,D){var I=this;E===void 0&&(E=null),D===void 0&&(D=null),P=this.pathPrefix+P,this.toLoad++,R.downloadBinary(P,function(M){I.assets[P]=M,E&&E(P,M),I.toLoad--,I.loaded++},function(M,N){I.errors[P]="Couldn't load binary "+P+": status "+status+", "+N,D&&D(P,"Couldn't load binary "+P+": status "+status+", "+N),I.toLoad--,I.loaded++})},R.prototype.loadText=function(P,E,D){var I=this;E===void 0&&(E=null),D===void 0&&(D=null),P=this.pathPrefix+P,this.toLoad++,R.downloadText(P,function(M){I.assets[P]=M,E&&E(P,M),I.toLoad--,I.loaded++},function(M,N){I.errors[P]="Couldn't load text "+P+": status "+status+", "+N,D&&D(P,"Couldn't load text "+P+": status "+status+", "+N),I.toLoad--,I.loaded++})},R.prototype.loadTexture=function(P,E,D){var I=this;E===void 0&&(E=null),D===void 0&&(D=null),P=this.pathPrefix+P,this.toLoad++;var M=new Image;M.crossOrigin="anonymous",M.onload=function(){var N=I.textureLoader(M);I.assets[P]=N,I.toLoad--,I.loaded++,E&&E(P,M)},M.onerror=function(){I.errors[P]="Couldn't load image "+P,I.toLoad--,I.loaded++,D&&D(P,"Couldn't load image "+P)},M.src=P},R.prototype.loadTextureData=function(P,E,D,I){var M=this;D===void 0&&(D=null),I===void 0&&(I=null),P=this.pathPrefix+P,this.toLoad++;var N=new Image;N.onload=function(){var k=M.textureLoader(N);M.assets[P]=k,M.toLoad--,M.loaded++,D&&D(P,N)},N.onerror=function(){M.errors[P]="Couldn't load image "+P,M.toLoad--,M.loaded++,I&&I(P,"Couldn't load image "+P)},N.src=E},R.prototype.loadTextureAtlas=function(P,E,D){var I=this;E===void 0&&(E=null),D===void 0&&(D=null);var M=P.lastIndexOf("/")>=0?P.substring(0,P.lastIndexOf("/")):"";P=this.pathPrefix+P,this.toLoad++,R.downloadText(P,function(N){var k={count:0},F=new Array;try{new A.TextureAtlas(N,function(U){F.push(M+"/"+U);var X=document.createElement("img");return X.width=16,X.height=16,new A.FakeTexture(X)})}catch(U){var G=U;return I.errors[P]="Couldn't load texture atlas "+P+": "+G.message,D&&D(P,"Couldn't load texture atlas "+P+": "+G.message),I.toLoad--,void I.loaded++}for(var V=function(U){var X=!1;I.loadTexture(U,function(Y){if(k.count++,k.count==F.length)if(X)I.errors[P]="Couldn't load texture atlas page "+Y+"} of atlas "+P,D&&D(P,"Couldn't load texture atlas page "+Y+" of atlas "+P),I.toLoad--,I.loaded++;else try{var z=new A.TextureAtlas(N,function(Z){return I.get(M+"/"+Z)});I.assets[P]=z,E&&E(P,z),I.toLoad--,I.loaded++}catch(Z){var W=Z;I.errors[P]="Couldn't load texture atlas "+P+": "+W.message,D&&D(P,"Couldn't load texture atlas "+P+": "+W.message),I.toLoad--,I.loaded++}},function(Y){X=!0,k.count++,k.count==F.length&&(I.errors[P]="Couldn't load texture atlas page "+Y+"} of atlas "+P,D&&D(P,"Couldn't load texture atlas page "+Y+" of atlas "+P),I.toLoad--,I.loaded++)})},j=0,H=F;j<H.length;j++)V(H[j])},function(N,k){I.errors[P]="Couldn't load texture atlas "+P+": status "+status+", "+k,D&&D(P,"Couldn't load texture atlas "+P+": status "+status+", "+k),I.toLoad--,I.loaded++})},R.prototype.get=function(P){return P=this.pathPrefix+P,this.assets[P]},R.prototype.remove=function(P){P=this.pathPrefix+P;var E=this.assets[P];E.dispose&&E.dispose(),this.assets[P]=null},R.prototype.removeAll=function(){for(var P in this.assets){var E=this.assets[P];E.dispose&&E.dispose()}this.assets={}},R.prototype.isLoadingComplete=function(){return this.toLoad==0},R.prototype.getToLoad=function(){return this.toLoad},R.prototype.getLoaded=function(){return this.loaded},R.prototype.dispose=function(){this.removeAll()},R.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},R.prototype.getErrors=function(){return this.errors},R}();A.AssetManager=O}(w||(w={})),function(A){var O=function(){function R(P){this.atlas=P}return R.prototype.newRegionAttachment=function(P,E,D){var I=this.atlas.findRegion(D);if(I==null)return null;I.renderObject=I;var M=new A.RegionAttachment(E);return M.setRegion(I),M},R.prototype.newMeshAttachment=function(P,E,D){var I=this.atlas.findRegion(D);if(I==null)return null;I.renderObject=I;var M=new A.MeshAttachment(E);return M.region=I,M},R.prototype.newBoundingBoxAttachment=function(P,E){return new A.BoundingBoxAttachment(E)},R.prototype.newPathAttachment=function(P,E){return new A.PathAttachment(E)},R.prototype.newPointAttachment=function(P,E){return new A.PointAttachment(E)},R.prototype.newClippingAttachment=function(P,E){return new A.ClippingAttachment(E)},R}();A.AtlasAttachmentLoader=O}(w||(w={})),function(A){(function(O){O[O.Normal=0]="Normal",O[O.Additive=1]="Additive",O[O.Multiply=2]="Multiply",O[O.Screen=3]="Screen"})(A.BlendMode||(A.BlendMode={}))}(w||(w={})),function(A){var O=function(){function R(P,E,D){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,P==null)throw new Error("data cannot be null.");if(E==null)throw new Error("skeleton cannot be null.");this.data=P,this.skeleton=E,this.parent=D,this.setToSetupPose()}return R.prototype.isActive=function(){return this.active},R.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},R.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},R.prototype.updateWorldTransformWith=function(P,E,D,I,M,N,k){this.ax=P,this.ay=E,this.arotation=D,this.ascaleX=I,this.ascaleY=M,this.ashearX=N,this.ashearY=k,this.appliedValid=!0;var F=this.parent;if(F==null){var G=this.skeleton,V=D+90+k,j=G.scaleX,H=G.scaleY;return this.a=A.MathUtils.cosDeg(D+N)*I*j,this.b=A.MathUtils.cosDeg(V)*M*j,this.c=A.MathUtils.sinDeg(D+N)*I*H,this.d=A.MathUtils.sinDeg(V)*M*H,this.worldX=P*j+G.x,void(this.worldY=E*H+G.y)}var U=F.a,X=F.b,Y=F.c,z=F.d;switch(this.worldX=U*P+X*E+F.worldX,this.worldY=Y*P+z*E+F.worldY,this.data.transformMode){case A.TransformMode.Normal:V=D+90+k;var W=A.MathUtils.cosDeg(D+N)*I,Z=A.MathUtils.cosDeg(V)*M,Q=A.MathUtils.sinDeg(D+N)*I,ee=A.MathUtils.sinDeg(V)*M;return this.a=U*W+X*Q,this.b=U*Z+X*ee,this.c=Y*W+z*Q,void(this.d=Y*Z+z*ee);case A.TransformMode.OnlyTranslation:V=D+90+k,this.a=A.MathUtils.cosDeg(D+N)*I,this.b=A.MathUtils.cosDeg(V)*M,this.c=A.MathUtils.sinDeg(D+N)*I,this.d=A.MathUtils.sinDeg(V)*M;break;case A.TransformMode.NoRotationOrReflection:var te=0;(ne=U*U+Y*Y)>1e-4?(X=Y*(ne=Math.abs(U*z-X*Y)/ne),z=U*ne,te=Math.atan2(Y,U)*A.MathUtils.radDeg):(U=0,Y=0,te=90-Math.atan2(z,X)*A.MathUtils.radDeg);var re=D+N-te,ie=D+k-te+90;W=A.MathUtils.cosDeg(re)*I,Z=A.MathUtils.cosDeg(ie)*M,Q=A.MathUtils.sinDeg(re)*I,ee=A.MathUtils.sinDeg(ie)*M,this.a=U*W-X*Q,this.b=U*Z-X*ee,this.c=Y*W+z*Q,this.d=Y*Z+z*ee;break;case A.TransformMode.NoScale:case A.TransformMode.NoScaleOrReflection:var ne,he=A.MathUtils.cosDeg(D),pe=A.MathUtils.sinDeg(D),K=(U*he+X*pe)/this.skeleton.scaleX,ue=(Y*he+z*pe)/this.skeleton.scaleY;(ne=Math.sqrt(K*K+ue*ue))>1e-5&&(ne=1/ne),K*=ne,ue*=ne,ne=Math.sqrt(K*K+ue*ue),this.data.transformMode==A.TransformMode.NoScale&&U*z-X*Y<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(ne=-ne);var le=Math.PI/2+Math.atan2(ue,K),ce=Math.cos(le)*ne,_e=Math.sin(le)*ne;W=A.MathUtils.cosDeg(N)*I,Z=A.MathUtils.cosDeg(90+k)*M,Q=A.MathUtils.sinDeg(N)*I,ee=A.MathUtils.sinDeg(90+k)*M,this.a=K*W+ce*Q,this.b=K*Z+ce*ee,this.c=ue*W+_e*Q,this.d=ue*Z+_e*ee}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY},R.prototype.setToSetupPose=function(){var P=this.data;this.x=P.x,this.y=P.y,this.rotation=P.rotation,this.scaleX=P.scaleX,this.scaleY=P.scaleY,this.shearX=P.shearX,this.shearY=P.shearY},R.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*A.MathUtils.radDeg},R.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*A.MathUtils.radDeg},R.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},R.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},R.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var P=this.parent;if(P==null)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*A.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*A.MathUtils.radDeg);var E=P.a,D=P.b,I=P.c,M=P.d,N=1/(E*M-D*I),k=this.worldX-P.worldX,F=this.worldY-P.worldY;this.ax=k*M*N-F*D*N,this.ay=F*E*N-k*I*N;var G=N*M,V=N*E,j=N*D,H=N*I,U=G*this.a-j*this.c,X=G*this.b-j*this.d,Y=V*this.c-H*this.a,z=V*this.d-H*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(U*U+Y*Y),this.ascaleX>1e-4){var W=U*z-X*Y;this.ascaleY=W/this.ascaleX,this.ashearY=Math.atan2(U*X+Y*z,W)*A.MathUtils.radDeg,this.arotation=Math.atan2(Y,U)*A.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(X*X+z*z),this.ashearY=0,this.arotation=90-Math.atan2(z,X)*A.MathUtils.radDeg},R.prototype.worldToLocal=function(P){var E=this.a,D=this.b,I=this.c,M=this.d,N=1/(E*M-D*I),k=P.x-this.worldX,F=P.y-this.worldY;return P.x=k*M*N-F*D*N,P.y=F*E*N-k*I*N,P},R.prototype.localToWorld=function(P){var E=P.x,D=P.y;return P.x=E*this.a+D*this.b+this.worldX,P.y=E*this.c+D*this.d+this.worldY,P},R.prototype.worldToLocalRotation=function(P){var E=A.MathUtils.sinDeg(P),D=A.MathUtils.cosDeg(P);return Math.atan2(this.a*E-this.c*D,this.d*D-this.b*E)*A.MathUtils.radDeg+this.rotation-this.shearX},R.prototype.localToWorldRotation=function(P){P-=this.rotation-this.shearX;var E=A.MathUtils.sinDeg(P),D=A.MathUtils.cosDeg(P);return Math.atan2(D*this.c+E*this.d,D*this.a+E*this.b)*A.MathUtils.radDeg},R.prototype.rotateWorld=function(P){var E=this.a,D=this.b,I=this.c,M=this.d,N=A.MathUtils.cosDeg(P),k=A.MathUtils.sinDeg(P);this.a=N*E-k*I,this.b=N*D-k*M,this.c=k*E+N*I,this.d=k*D+N*M,this.appliedValid=!1},R}();A.Bone=O}(w||(w={})),function(A){var O;A.BoneData=function(R,P,E){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=O.Normal,this.skinRequired=!1,this.color=new A.Color,R<0)throw new Error("index must be >= 0.");if(P==null)throw new Error("name cannot be null.");this.index=R,this.name=P,this.parent=E},function(R){R[R.Normal=0]="Normal",R[R.OnlyTranslation=1]="OnlyTranslation",R[R.NoRotationOrReflection=2]="NoRotationOrReflection",R[R.NoScale=3]="NoScale",R[R.NoScaleOrReflection=4]="NoScaleOrReflection"}(O=A.TransformMode||(A.TransformMode={}))}(w||(w={})),function(A){A.ConstraintData=function(O,R,P){this.name=O,this.order=R,this.skinRequired=P}}(w||(w={})),function(A){A.Event=function(O,R){if(R==null)throw new Error("data cannot be null.");this.time=O,this.data=R}}(w||(w={})),function(A){A.EventData=function(O){this.name=O}}(w||(w={})),function(A){var O=function(){function R(P,E){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,P==null)throw new Error("data cannot be null.");if(E==null)throw new Error("skeleton cannot be null.");this.data=P,this.mix=P.mix,this.softness=P.softness,this.bendDirection=P.bendDirection,this.compress=P.compress,this.stretch=P.stretch,this.bones=new Array;for(var D=0;D<P.bones.length;D++)this.bones.push(E.findBone(P.bones[D].name));this.target=E.findBone(P.target.name)}return R.prototype.isActive=function(){return this.active},R.prototype.apply=function(){this.update()},R.prototype.update=function(){var P=this.target,E=this.bones;switch(E.length){case 1:this.apply1(E[0],P.worldX,P.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(E[0],E[1],P.worldX,P.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}},R.prototype.apply1=function(P,E,D,I,M,N,k){P.appliedValid||P.updateAppliedTransform();var F=P.parent,G=1/(F.a*F.d-F.b*F.c),V=E-F.worldX,j=D-F.worldY,H=(V*F.d-j*F.b)*G-P.ax,U=(j*F.a-V*F.c)*G-P.ay,X=Math.atan2(U,H)*A.MathUtils.radDeg-P.ashearX-P.arotation;P.ascaleX<0&&(X+=180),X>180?X-=360:X<-180&&(X+=360);var Y=P.ascaleX,z=P.ascaleY;if(I||M){var W=P.data.length*Y,Z=Math.sqrt(H*H+U*U);if(I&&Z<W||M&&Z>W&&W>1e-4){var Q=(Z/W-1)*k+1;Y*=Q,N&&(z*=Q)}}P.updateWorldTransformWith(P.ax,P.ay,P.arotation+X*k,Y,z,P.ashearX,P.ashearY)},R.prototype.apply2=function(P,E,D,I,M,N,k,F){if(F!=0){P.appliedValid||P.updateAppliedTransform(),E.appliedValid||E.updateAppliedTransform();var G=P.ax,V=P.ay,j=P.ascaleX,H=j,U=P.ascaleY,X=E.ascaleX,Y=0,z=0,W=0;j<0?(j=-j,Y=180,W=-1):(Y=0,W=1),U<0&&(U=-U,W=-W),X<0?(X=-X,z=180):z=0;var Z=E.ax,Q=0,ee=0,te=0,re=P.a,ie=P.b,ne=P.c,he=P.d,pe=Math.abs(j-U)<=1e-4;pe?(ee=re*Z+ie*(Q=E.ay)+P.worldX,te=ne*Z+he*Q+P.worldY):(Q=0,ee=re*Z+P.worldX,te=ne*Z+P.worldY);var K=P.parent;re=K.a,ie=K.b,ne=K.c;var ue,le,ce=1/(re*(he=K.d)-ie*ne),_e=ee-K.worldX,oe=te-K.worldY,de=(_e*he-oe*ie)*ce-G,me=(oe*re-_e*ne)*ce-V,ye=Math.sqrt(de*de+me*me),ge=E.data.length*X;if(ye<1e-4)return this.apply1(P,D,I,!1,N,!1,F),void E.updateWorldTransformWith(Z,Q,0,E.ascaleX,E.ascaleY,E.ashearX,E.ashearY);var we=((_e=D-K.worldX)*he-(oe=I-K.worldY)*ie)*ce-G,Te=(oe*re-_e*ne)*ce-V,Ee=we*we+Te*Te;if(k!=0){k*=j*(X+1)/2;var De=Math.sqrt(Ee),fe=De-ye-ge*j+k;if(fe>0){var Ce=Math.min(1,fe/(2*k))-1;Ee=(we-=(Ce=(fe-k*(1-Ce*Ce))/De)*we)*we+(Te-=Ce*Te)*Te}}e:if(pe){var Se=(Ee-ye*ye-(ge*=j)*ge)/(2*ye*ge);Se<-1?Se=-1:Se>1&&(Se=1,N&&(H*=(Math.sqrt(Ee)/(ye+ge)-1)*F+1)),le=Math.acos(Se)*M,re=ye+ge*Se,ie=ge*Math.sin(le),ue=Math.atan2(Te*re-we*ie,we*re+Te*ie)}else{var be=(re=j*ge)*re,Re=(ie=U*ge)*ie,Ve=Math.atan2(Te,we),Pe=-2*Re*ye,ke=Re-be;if((he=Pe*Pe-4*ke*(ne=Re*ye*ye+be*Ee-be*Re))>=0){var Ne=Math.sqrt(he);Pe<0&&(Ne=-Ne);var Ae=(Ne=-(Pe+Ne)/2)/ke,Oe=ne/Ne,Fe=Math.abs(Ae)<Math.abs(Oe)?Ae:Oe;if(Fe*Fe<=Ee){oe=Math.sqrt(Ee-Fe*Fe)*M,ue=Ve-Math.atan2(oe,Fe),le=Math.atan2(oe/U,(Fe-ye)/j);break e}}var nt=A.MathUtils.PI,Ze=ye-re,Xe=Ze*Ze,$e=0,ot=0,ut=ye+re,gt=ut*ut,Ue=0;(ne=-re*ye/(be-Re))>=-1&&ne<=1&&(ne=Math.acos(ne),(he=(_e=re*Math.cos(ne)+ye)*_e+(oe=ie*Math.sin(ne))*oe)<Xe&&(nt=ne,Xe=he,Ze=_e,$e=oe),he>gt&&(ot=ne,gt=he,ut=_e,Ue=oe)),Ee<=(Xe+gt)/2?(ue=Ve-Math.atan2($e*M,Ze),le=nt*M):(ue=Ve-Math.atan2(Ue*M,ut),le=ot*M)}var We=Math.atan2(Q,Z)*W,ht=P.arotation;(ue=(ue-We)*A.MathUtils.radDeg+Y-ht)>180?ue-=360:ue<-180&&(ue+=360),P.updateWorldTransformWith(G,V,ht+ue*F,H,P.ascaleY,0,0),ht=E.arotation,(le=((le+We)*A.MathUtils.radDeg-E.ashearX)*W+z-ht)>180?le-=360:le<-180&&(le+=360),E.updateWorldTransformWith(Z,Q,ht+le*F,E.ascaleX,E.ascaleY,E.ashearX,E.ashearY)}else E.updateWorldTransform()},R}();A.IkConstraint=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E,0,!1)||this;return D.bones=new Array,D.bendDirection=1,D.compress=!1,D.stretch=!1,D.uniform=!1,D.mix=1,D.softness=0,D}return B(P,R),P}(A.ConstraintData);A.IkConstraintData=O}(w||(w={})),function(A){var O=function(){function R(P,E){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,P==null)throw new Error("data cannot be null.");if(E==null)throw new Error("skeleton cannot be null.");this.data=P,this.bones=new Array;for(var D=0,I=P.bones.length;D<I;D++)this.bones.push(E.findBone(P.bones[D].name));this.target=E.findSlot(P.target.name),this.position=P.position,this.spacing=P.spacing,this.rotateMix=P.rotateMix,this.translateMix=P.translateMix}return R.prototype.isActive=function(){return this.active},R.prototype.apply=function(){this.update()},R.prototype.update=function(){var P=this.target.getAttachment();if(P instanceof A.PathAttachment){var E=this.rotateMix,D=this.translateMix,I=E>0;if(D>0||I){var M=this.data,N=M.spacingMode==A.SpacingMode.Percent,k=M.rotateMode,F=k==A.RotateMode.Tangent,G=k==A.RotateMode.ChainScale,V=this.bones.length,j=F?V:V+1,H=this.bones,U=A.Utils.setArraySize(this.spaces,j),X=null,Y=this.spacing;if(G||!N){G&&(X=A.Utils.setArraySize(this.lengths,V));for(var z=M.spacingMode==A.SpacingMode.Length,W=0,Z=j-1;W<Z;){var Q=(ce=H[W]).data.length;if(Q<R.epsilon)G&&(X[W]=0),U[++W]=0;else if(N){if(G){var ee=Q*ce.a,te=Q*ce.c,re=Math.sqrt(ee*ee+te*te);X[W]=re}U[++W]=Y}else{ee=Q*ce.a,te=Q*ce.c;var ie=Math.sqrt(ee*ee+te*te);G&&(X[W]=ie),U[++W]=(z?Q+Y:Y)*ie/Q}}}else for(W=1;W<j;W++)U[W]=Y;var ne=this.computeWorldPositions(P,j,F,M.positionMode==A.PositionMode.Percent,N),he=ne[0],pe=ne[1],K=M.offsetRotation,ue=!1;K==0?ue=k==A.RotateMode.Chain:(ue=!1,K*=(le=this.target.bone).a*le.d-le.b*le.c>0?A.MathUtils.degRad:-A.MathUtils.degRad),W=0;for(var le=3;W<V;W++,le+=3){var ce;(ce=H[W]).worldX+=(he-ce.worldX)*D,ce.worldY+=(pe-ce.worldY)*D;var _e=(ee=ne[le])-he,oe=(te=ne[le+1])-pe;if(G){var de=X[W];if(de!=0){var me=(Math.sqrt(_e*_e+oe*oe)/de-1)*E+1;ce.a*=me,ce.c*=me}}if(he=ee,pe=te,I){var ye=ce.a,ge=ce.b,we=ce.c,Te=ce.d,Ee=0,De=0,fe=0;if(Ee=F?ne[le-1]:U[W+1]==0?ne[le+2]:Math.atan2(oe,_e),Ee-=Math.atan2(we,ye),ue){De=Math.cos(Ee),fe=Math.sin(Ee);var Ce=ce.data.length;he+=(Ce*(De*ye-fe*we)-_e)*E,pe+=(Ce*(fe*ye+De*we)-oe)*E}else Ee+=K;Ee>A.MathUtils.PI?Ee-=A.MathUtils.PI2:Ee<-A.MathUtils.PI&&(Ee+=A.MathUtils.PI2),Ee*=E,De=Math.cos(Ee),fe=Math.sin(Ee),ce.a=De*ye-fe*we,ce.b=De*ge-fe*Te,ce.c=fe*ye+De*we,ce.d=fe*ge+De*Te}ce.appliedValid=!1}}}},R.prototype.computeWorldPositions=function(P,E,D,I,M){var N=this.target,k=this.position,F=this.spaces,G=A.Utils.setArraySize(this.positions,3*E+2),V=null,j=P.closed,H=P.worldVerticesLength,U=H/6,X=R.NONE;if(!P.constantSpeed){var Y=P.lengths,z=Y[U-=j?1:2];if(I&&(k*=z),M)for(var W=1;W<E;W++)F[W]*=z;V=A.Utils.setArraySize(this.world,8),W=0;for(var Z=0,Q=0;W<E;W++,Z+=3){var ee=k+=be=F[W];if(j)(ee%=z)<0&&(ee+=z),Q=0;else{if(ee<0){X!=R.BEFORE&&(X=R.BEFORE,P.computeWorldVertices(N,2,4,V,0,2)),this.addBeforePosition(ee,V,0,G,Z);continue}if(ee>z){X!=R.AFTER&&(X=R.AFTER,P.computeWorldVertices(N,H-6,4,V,0,2)),this.addAfterPosition(ee-z,V,0,G,Z);continue}}for(;;Q++){var te=Y[Q];if(!(ee>te)){Q==0?ee/=te:ee=(ee-(ke=Y[Q-1]))/(te-ke);break}}Q!=X&&(X=Q,j&&Q==U?(P.computeWorldVertices(N,H-4,4,V,0,2),P.computeWorldVertices(N,0,4,V,4,2)):P.computeWorldVertices(N,6*Q+2,8,V,0,2)),this.addCurvePosition(ee,V[0],V[1],V[2],V[3],V[4],V[5],V[6],V[7],G,Z,D||W>0&&be==0)}return G}j?(H+=2,V=A.Utils.setArraySize(this.world,H),P.computeWorldVertices(N,2,H-4,V,0,2),P.computeWorldVertices(N,0,2,V,H-4,2),V[H-2]=V[0],V[H-1]=V[1]):(U--,H-=4,V=A.Utils.setArraySize(this.world,H),P.computeWorldVertices(N,2,H,V,0,2));for(var re=A.Utils.setArraySize(this.curves,U),ie=0,ne=V[0],he=V[1],pe=0,K=0,ue=0,le=0,ce=0,_e=0,oe=0,de=0,me=0,ye=0,ge=0,we=0,Te=0,Ee=0,De=(W=0,2);W<U;W++,De+=6)pe=V[De],K=V[De+1],ue=V[De+2],le=V[De+3],ge=2*(oe=.1875*(ne-2*pe+ue))+(me=.09375*(3*(pe-ue)-ne+(ce=V[De+4]))),we=2*(de=.1875*(he-2*K+le))+(ye=.09375*(3*(K-le)-he+(_e=V[De+5]))),Te=.75*(pe-ne)+oe+.16666667*me,Ee=.75*(K-he)+de+.16666667*ye,ie+=Math.sqrt(Te*Te+Ee*Ee),Te+=ge,Ee+=we,ge+=me,we+=ye,ie+=Math.sqrt(Te*Te+Ee*Ee),Te+=ge,Ee+=we,ie+=Math.sqrt(Te*Te+Ee*Ee),Te+=ge+me,Ee+=we+ye,ie+=Math.sqrt(Te*Te+Ee*Ee),re[W]=ie,ne=ce,he=_e;if(k*=I?ie:ie/P.lengths[U-1],M)for(W=1;W<E;W++)F[W]*=ie;for(var fe=this.segments,Ce=0,Se=(W=0,Z=0,Q=0,0);W<E;W++,Z+=3){var be;if(ee=k+=be=F[W],j)(ee%=ie)<0&&(ee+=ie),Q=0;else{if(ee<0){this.addBeforePosition(ee,V,0,G,Z);continue}if(ee>ie){this.addAfterPosition(ee-ie,V,H-4,G,Z);continue}}for(;;Q++){var Re=re[Q];if(!(ee>Re)){Q==0?ee/=Re:ee=(ee-(ke=re[Q-1]))/(Re-ke);break}}if(Q!=X){X=Q;var Ve=6*Q;for(ne=V[Ve],he=V[Ve+1],pe=V[Ve+2],K=V[Ve+3],ue=V[Ve+4],le=V[Ve+5],ge=2*(oe=.03*(ne-2*pe+ue))+(me=.006*(3*(pe-ue)-ne+(ce=V[Ve+6]))),we=2*(de=.03*(he-2*K+le))+(ye=.006*(3*(K-le)-he+(_e=V[Ve+7]))),Te=.3*(pe-ne)+oe+.16666667*me,Ee=.3*(K-he)+de+.16666667*ye,Ce=Math.sqrt(Te*Te+Ee*Ee),fe[0]=Ce,Ve=1;Ve<8;Ve++)Te+=ge,Ee+=we,ge+=me,we+=ye,Ce+=Math.sqrt(Te*Te+Ee*Ee),fe[Ve]=Ce;Te+=ge,Ee+=we,Ce+=Math.sqrt(Te*Te+Ee*Ee),fe[8]=Ce,Te+=ge+me,Ee+=we+ye,Ce+=Math.sqrt(Te*Te+Ee*Ee),fe[9]=Ce,Se=0}for(ee*=Ce;;Se++){var Pe=fe[Se];if(!(ee>Pe)){var ke;Se==0?ee/=Pe:ee=Se+(ee-(ke=fe[Se-1]))/(Pe-ke);break}}this.addCurvePosition(.1*ee,ne,he,pe,K,ue,le,ce,_e,G,Z,D||W>0&&be==0)}return G},R.prototype.addBeforePosition=function(P,E,D,I,M){var N=E[D],k=E[D+1],F=E[D+2]-N,G=E[D+3]-k,V=Math.atan2(G,F);I[M]=N+P*Math.cos(V),I[M+1]=k+P*Math.sin(V),I[M+2]=V},R.prototype.addAfterPosition=function(P,E,D,I,M){var N=E[D+2],k=E[D+3],F=N-E[D],G=k-E[D+1],V=Math.atan2(G,F);I[M]=N+P*Math.cos(V),I[M+1]=k+P*Math.sin(V),I[M+2]=V},R.prototype.addCurvePosition=function(P,E,D,I,M,N,k,F,G,V,j,H){if(P==0||isNaN(P))return V[j]=E,V[j+1]=D,void(V[j+2]=Math.atan2(M-D,I-E));var U=P*P,X=U*P,Y=1-P,z=Y*Y,W=z*Y,Z=Y*P,Q=3*Z,ee=Y*Q,te=Q*P,re=E*W+I*ee+N*te+F*X,ie=D*W+M*ee+k*te+G*X;V[j]=re,V[j+1]=ie,H&&(V[j+2]=P<.001?Math.atan2(M-D,I-E):Math.atan2(ie-(D*z+M*Z*2+k*U),re-(E*z+I*Z*2+N*U)))},R.NONE=-1,R.BEFORE=-2,R.AFTER=-3,R.epsilon=1e-5,R}();A.PathConstraint=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E,0,!1)||this;return D.bones=new Array,D}return B(P,R),P}(A.ConstraintData);A.PathConstraintData=O,function(R){R[R.Fixed=0]="Fixed",R[R.Percent=1]="Percent"}(A.PositionMode||(A.PositionMode={})),function(R){R[R.Length=0]="Length",R[R.Fixed=1]="Fixed",R[R.Percent=2]="Percent"}(A.SpacingMode||(A.SpacingMode={})),function(R){R[R.Tangent=0]="Tangent",R[R.Chain=1]="Chain",R[R.ChainScale=2]="ChainScale"}(A.RotateMode||(A.RotateMode={}))}(w||(w={})),function(A){var O=function(){function P(E){this.toLoad=new Array,this.assets={},this.clientId=E}return P.prototype.loaded=function(){var E=0;for(var D in this.assets)E++;return E},P}(),R=function(){function P(E){E===void 0&&(E=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=E}return P.prototype.queueAsset=function(E,D,I){var M=this.clientAssets[E];return M==null&&(M=new O(E),this.clientAssets[E]=M),D!==null&&(M.textureLoader=D),M.toLoad.push(I),this.queuedAssets[I]!==I&&(this.queuedAssets[I]=I,!0)},P.prototype.loadText=function(E,D){var I=this;if(D=this.pathPrefix+D,this.queueAsset(E,null,D)){var M=new XMLHttpRequest;M.onreadystatechange=function(){M.readyState==XMLHttpRequest.DONE&&(M.status>=200&&M.status<300?I.rawAssets[D]=M.responseText:I.errors[D]="Couldn't load text "+D+": status "+M.status+", "+M.responseText)},M.open("GET",D,!0),M.send()}},P.prototype.loadJson=function(E,D){var I=this;if(D=this.pathPrefix+D,this.queueAsset(E,null,D)){var M=new XMLHttpRequest;M.onreadystatechange=function(){M.readyState==XMLHttpRequest.DONE&&(M.status>=200&&M.status<300?I.rawAssets[D]=JSON.parse(M.responseText):I.errors[D]="Couldn't load text "+D+": status "+M.status+", "+M.responseText)},M.open("GET",D,!0),M.send()}},P.prototype.loadTexture=function(E,D,I){var M=this;if(I=this.pathPrefix+I,this.queueAsset(E,D,I)){var N=new Image;N.src=I,N.crossOrigin="anonymous",N.onload=function(){M.rawAssets[I]=N},N.onerror=function(){M.errors[I]="Couldn't load image "+I}}},P.prototype.get=function(E,D){D=this.pathPrefix+D;var I=this.clientAssets[E];return I==null||I.assets[D]},P.prototype.updateClientAssets=function(E){for(var D=0;D<E.toLoad.length;D++){var I=E.toLoad[D];if(E.assets[I]==null){var M=this.rawAssets[I];if(M==null)continue;M instanceof HTMLImageElement?E.assets[I]=E.textureLoader(M):E.assets[I]=M}}},P.prototype.isLoadingComplete=function(E){var D=this.clientAssets[E];return D==null||(this.updateClientAssets(D),D.toLoad.length==D.loaded())},P.prototype.dispose=function(){},P.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},P.prototype.getErrors=function(){return this.errors},P}();A.SharedAssetManager=R}(w||(w={})),function(A){var O=function(){function R(P){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,P==null)throw new Error("data cannot be null.");this.data=P,this.bones=new Array;for(var E=0;E<P.bones.length;E++){var D=P.bones[E],I=void 0;if(D.parent==null)I=new A.Bone(D,this,null);else{var M=this.bones[D.parent.index];I=new A.Bone(D,this,M),M.children.push(I)}this.bones.push(I)}for(this.slots=new Array,this.drawOrder=new Array,E=0;E<P.slots.length;E++){var N=P.slots[E],k=(I=this.bones[N.boneData.index],new A.Slot(N,I));this.slots.push(k),this.drawOrder.push(k)}for(this.ikConstraints=new Array,E=0;E<P.ikConstraints.length;E++){var F=P.ikConstraints[E];this.ikConstraints.push(new A.IkConstraint(F,this))}for(this.transformConstraints=new Array,E=0;E<P.transformConstraints.length;E++){var G=P.transformConstraints[E];this.transformConstraints.push(new A.TransformConstraint(G,this))}for(this.pathConstraints=new Array,E=0;E<P.pathConstraints.length;E++){var V=P.pathConstraints[E];this.pathConstraints.push(new A.PathConstraint(V,this))}this.color=new A.Color(1,1,1,1),this.updateCache()}return R.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var P=this.bones,E=0,D=P.length;E<D;E++)(M=P[E]).sorted=M.data.skinRequired,M.active=!M.sorted;if(this.skin!=null){var I=this.skin.bones;for(E=0,D=this.skin.bones.length;E<D;E++){var M=this.bones[I[E].index];do M.sorted=!1,M.active=!0,M=M.parent;while(M!=null)}}var N=this.ikConstraints,k=this.transformConstraints,F=this.pathConstraints,G=N.length,V=k.length,j=F.length,H=G+V+j;e:for(E=0;E<H;E++){for(var U=0;U<G;U++)if((X=N[U]).data.order==E){this.sortIkConstraint(X);continue e}for(U=0;U<V;U++)if((X=k[U]).data.order==E){this.sortTransformConstraint(X);continue e}for(U=0;U<j;U++){var X;if((X=F[U]).data.order==E){this.sortPathConstraint(X);continue e}}}for(E=0,D=P.length;E<D;E++)this.sortBone(P[E])},R.prototype.sortIkConstraint=function(P){if(P.active=P.target.isActive()&&(!P.data.skinRequired||this.skin!=null&&A.Utils.contains(this.skin.constraints,P.data,!0)),P.active){var E=P.target;this.sortBone(E);var D=P.bones,I=D[0];if(this.sortBone(I),D.length>1){var M=D[D.length-1];this._updateCache.indexOf(M)>-1||this.updateCacheReset.push(M)}this._updateCache.push(P),this.sortReset(I.children),D[D.length-1].sorted=!0}},R.prototype.sortPathConstraint=function(P){if(P.active=P.target.bone.isActive()&&(!P.data.skinRequired||this.skin!=null&&A.Utils.contains(this.skin.constraints,P.data,!0)),P.active){var E=P.target,D=E.data.index,I=E.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,D,I),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,D,I);for(var M=0,N=this.data.skins.length;M<N;M++)this.sortPathConstraintAttachment(this.data.skins[M],D,I);var k=E.getAttachment();k instanceof A.PathAttachment&&this.sortPathConstraintAttachmentWith(k,I);var F=P.bones,G=F.length;for(M=0;M<G;M++)this.sortBone(F[M]);for(this._updateCache.push(P),M=0;M<G;M++)this.sortReset(F[M].children);for(M=0;M<G;M++)F[M].sorted=!0}},R.prototype.sortTransformConstraint=function(P){if(P.active=P.target.isActive()&&(!P.data.skinRequired||this.skin!=null&&A.Utils.contains(this.skin.constraints,P.data,!0)),P.active){this.sortBone(P.target);var E=P.bones,D=E.length;if(P.data.local)for(var I=0;I<D;I++){var M=E[I];this.sortBone(M.parent),this._updateCache.indexOf(M)>-1||this.updateCacheReset.push(M)}else for(I=0;I<D;I++)this.sortBone(E[I]);this._updateCache.push(P);for(var N=0;N<D;N++)this.sortReset(E[N].children);for(N=0;N<D;N++)E[N].sorted=!0}},R.prototype.sortPathConstraintAttachment=function(P,E,D){var I=P.attachments[E];if(I)for(var M in I)this.sortPathConstraintAttachmentWith(I[M],D)},R.prototype.sortPathConstraintAttachmentWith=function(P,E){if(P instanceof A.PathAttachment){var D=P.bones;if(D==null)this.sortBone(E);else for(var I=this.bones,M=0;M<D.length;)for(var N=D[M++],k=M+N;M<k;M++){var F=D[M];this.sortBone(I[F])}}},R.prototype.sortBone=function(P){if(!P.sorted){var E=P.parent;E!=null&&this.sortBone(E),P.sorted=!0,this._updateCache.push(P)}},R.prototype.sortReset=function(P){for(var E=0,D=P.length;E<D;E++){var I=P[E];I.active&&(I.sorted&&this.sortReset(I.children),I.sorted=!1)}},R.prototype.updateWorldTransform=function(){for(var P=this.updateCacheReset,E=0,D=P.length;E<D;E++){var I=P[E];I.ax=I.x,I.ay=I.y,I.arotation=I.rotation,I.ascaleX=I.scaleX,I.ascaleY=I.scaleY,I.ashearX=I.shearX,I.ashearY=I.shearY,I.appliedValid=!0}var M=this._updateCache;for(E=0,D=M.length;E<D;E++)M[E].update()},R.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},R.prototype.setBonesToSetupPose=function(){for(var P=this.bones,E=0,D=P.length;E<D;E++)P[E].setToSetupPose();var I=this.ikConstraints;for(E=0,D=I.length;E<D;E++)(F=I[E]).mix=F.data.mix,F.softness=F.data.softness,F.bendDirection=F.data.bendDirection,F.compress=F.data.compress,F.stretch=F.data.stretch;var M=this.transformConstraints;for(E=0,D=M.length;E<D;E++){var N=(F=M[E]).data;F.rotateMix=N.rotateMix,F.translateMix=N.translateMix,F.scaleMix=N.scaleMix,F.shearMix=N.shearMix}var k=this.pathConstraints;for(E=0,D=k.length;E<D;E++){var F;N=(F=k[E]).data,F.position=N.position,F.spacing=N.spacing,F.rotateMix=N.rotateMix,F.translateMix=N.translateMix}},R.prototype.setSlotsToSetupPose=function(){var P=this.slots;A.Utils.arrayCopy(P,0,this.drawOrder,0,P.length);for(var E=0,D=P.length;E<D;E++)P[E].setToSetupPose()},R.prototype.getRootBone=function(){return this.bones.length==0?null:this.bones[0]},R.prototype.findBone=function(P){if(P==null)throw new Error("boneName cannot be null.");for(var E=this.bones,D=0,I=E.length;D<I;D++){var M=E[D];if(M.data.name==P)return M}return null},R.prototype.findBoneIndex=function(P){if(P==null)throw new Error("boneName cannot be null.");for(var E=this.bones,D=0,I=E.length;D<I;D++)if(E[D].data.name==P)return D;return-1},R.prototype.findSlot=function(P){if(P==null)throw new Error("slotName cannot be null.");for(var E=this.slots,D=0,I=E.length;D<I;D++){var M=E[D];if(M.data.name==P)return M}return null},R.prototype.findSlotIndex=function(P){if(P==null)throw new Error("slotName cannot be null.");for(var E=this.slots,D=0,I=E.length;D<I;D++)if(E[D].data.name==P)return D;return-1},R.prototype.setSkinByName=function(P){var E=this.data.findSkin(P);if(E==null)throw new Error("Skin not found: "+P);this.setSkin(E)},R.prototype.setSkin=function(P){if(P!=this.skin){if(P!=null)if(this.skin!=null)P.attachAll(this,this.skin);else for(var E=this.slots,D=0,I=E.length;D<I;D++){var M=E[D],N=M.data.attachmentName;if(N!=null){var k=P.getAttachment(D,N);k!=null&&M.setAttachment(k)}}this.skin=P,this.updateCache()}},R.prototype.getAttachmentByName=function(P,E){return this.getAttachment(this.data.findSlotIndex(P),E)},R.prototype.getAttachment=function(P,E){if(E==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){var D=this.skin.getAttachment(P,E);if(D!=null)return D}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(P,E):null},R.prototype.setAttachment=function(P,E){if(P==null)throw new Error("slotName cannot be null.");for(var D=this.slots,I=0,M=D.length;I<M;I++){var N=D[I];if(N.data.name==P){var k=null;if(E!=null&&(k=this.getAttachment(I,E))==null)throw new Error("Attachment not found: "+E+", for slot: "+P);return void N.setAttachment(k)}}throw new Error("Slot not found: "+P)},R.prototype.findIkConstraint=function(P){if(P==null)throw new Error("constraintName cannot be null.");for(var E=this.ikConstraints,D=0,I=E.length;D<I;D++){var M=E[D];if(M.data.name==P)return M}return null},R.prototype.findTransformConstraint=function(P){if(P==null)throw new Error("constraintName cannot be null.");for(var E=this.transformConstraints,D=0,I=E.length;D<I;D++){var M=E[D];if(M.data.name==P)return M}return null},R.prototype.findPathConstraint=function(P){if(P==null)throw new Error("constraintName cannot be null.");for(var E=this.pathConstraints,D=0,I=E.length;D<I;D++){var M=E[D];if(M.data.name==P)return M}return null},R.prototype.getBounds=function(P,E,D){if(D===void 0&&(D=new Array(2)),P==null)throw new Error("offset cannot be null.");if(E==null)throw new Error("size cannot be null.");for(var I=this.drawOrder,M=Number.POSITIVE_INFINITY,N=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,F=Number.NEGATIVE_INFINITY,G=0,V=I.length;G<V;G++){var j=I[G];if(j.bone.active){var H=0,U=null,X=j.getAttachment();if(X instanceof A.RegionAttachment)H=8,U=A.Utils.setArraySize(D,H,0),X.computeWorldVertices(j.bone,U,0,2);else if(X instanceof A.MeshAttachment){var Y=X;H=Y.worldVerticesLength,U=A.Utils.setArraySize(D,H,0),Y.computeWorldVertices(j,0,H,U,0,2)}if(U!=null)for(var z=0,W=U.length;z<W;z+=2){var Z=U[z],Q=U[z+1];M=Math.min(M,Z),N=Math.min(N,Q),k=Math.max(k,Z),F=Math.max(F,Q)}}}P.set(M,N),E.set(k-M,F-N)},R.prototype.update=function(P){this.time+=P},R}();A.Skeleton=O}(w||(w={})),function(A){var O=function(){function D(I){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=I}return D.prototype.readSkeletonData=function(I){var M=this.scale,N=new A.SkeletonData;N.name="";var k=new R(I);N.hash=k.readString(),N.version=k.readString(),N.x=k.readFloat(),N.y=k.readFloat(),N.width=k.readFloat(),N.height=k.readFloat();var F=k.readBoolean();F&&(N.fps=k.readFloat(),N.imagesPath=k.readString(),N.audioPath=k.readString());var G=0;G=k.readInt(!0);for(var V=0;V<G;V++)k.strings.push(k.readString());for(G=k.readInt(!0),V=0;V<G;V++){var j=k.readString(),H=V==0?null:N.bones[k.readInt(!0)];(Y=new A.BoneData(V,j,H)).rotation=k.readFloat(),Y.x=k.readFloat()*M,Y.y=k.readFloat()*M,Y.scaleX=k.readFloat(),Y.scaleY=k.readFloat(),Y.shearX=k.readFloat(),Y.shearY=k.readFloat(),Y.length=k.readFloat()*M,Y.transformMode=D.TransformModeValues[k.readInt(!0)],Y.skinRequired=k.readBoolean(),F&&A.Color.rgba8888ToColor(Y.color,k.readInt32()),N.bones.push(Y)}for(G=k.readInt(!0),V=0;V<G;V++){var U=k.readString(),X=N.bones[k.readInt(!0)],Y=new A.SlotData(V,U,X);A.Color.rgba8888ToColor(Y.color,k.readInt32());var z=k.readInt32();z!=-1&&A.Color.rgb888ToColor(Y.darkColor=new A.Color,z),Y.attachmentName=k.readStringRef(),Y.blendMode=D.BlendModeValues[k.readInt(!0)],N.slots.push(Y)}G=k.readInt(!0),V=0;for(var W=void 0;V<G;V++){(Y=new A.IkConstraintData(k.readString())).order=k.readInt(!0),Y.skinRequired=k.readBoolean(),W=k.readInt(!0);for(var Z=0;Z<W;Z++)Y.bones.push(N.bones[k.readInt(!0)]);Y.target=N.bones[k.readInt(!0)],Y.mix=k.readFloat(),Y.softness=k.readFloat()*M,Y.bendDirection=k.readByte(),Y.compress=k.readBoolean(),Y.stretch=k.readBoolean(),Y.uniform=k.readBoolean(),N.ikConstraints.push(Y)}for(G=k.readInt(!0),V=0,W=void 0;V<G;V++){for((Y=new A.TransformConstraintData(k.readString())).order=k.readInt(!0),Y.skinRequired=k.readBoolean(),W=k.readInt(!0),Z=0;Z<W;Z++)Y.bones.push(N.bones[k.readInt(!0)]);Y.target=N.bones[k.readInt(!0)],Y.local=k.readBoolean(),Y.relative=k.readBoolean(),Y.offsetRotation=k.readFloat(),Y.offsetX=k.readFloat()*M,Y.offsetY=k.readFloat()*M,Y.offsetScaleX=k.readFloat(),Y.offsetScaleY=k.readFloat(),Y.offsetShearY=k.readFloat(),Y.rotateMix=k.readFloat(),Y.translateMix=k.readFloat(),Y.scaleMix=k.readFloat(),Y.shearMix=k.readFloat(),N.transformConstraints.push(Y)}for(G=k.readInt(!0),V=0,W=void 0;V<G;V++){for((Y=new A.PathConstraintData(k.readString())).order=k.readInt(!0),Y.skinRequired=k.readBoolean(),W=k.readInt(!0),Z=0;Z<W;Z++)Y.bones.push(N.bones[k.readInt(!0)]);Y.target=N.slots[k.readInt(!0)],Y.positionMode=D.PositionModeValues[k.readInt(!0)],Y.spacingMode=D.SpacingModeValues[k.readInt(!0)],Y.rotateMode=D.RotateModeValues[k.readInt(!0)],Y.offsetRotation=k.readFloat(),Y.position=k.readFloat(),Y.positionMode==A.PositionMode.Fixed&&(Y.position*=M),Y.spacing=k.readFloat(),Y.spacingMode!=A.SpacingMode.Length&&Y.spacingMode!=A.SpacingMode.Fixed||(Y.spacing*=M),Y.rotateMix=k.readFloat(),Y.translateMix=k.readFloat(),N.pathConstraints.push(Y)}var Q=this.readSkin(k,N,!0,F);for(Q!=null&&(N.defaultSkin=Q,N.skins.push(Q)),V=N.skins.length,A.Utils.setArraySize(N.skins,G=V+k.readInt(!0));V<G;V++)N.skins[V]=this.readSkin(k,N,!1,F);for(G=this.linkedMeshes.length,V=0;V<G;V++){var ee=this.linkedMeshes[V],te=ee.skin==null?N.defaultSkin:N.findSkin(ee.skin);if(te==null)throw new Error("Skin not found: "+ee.skin);var re=te.getAttachment(ee.slotIndex,ee.parent);if(re==null)throw new Error("Parent mesh not found: "+ee.parent);ee.mesh.deformAttachment=ee.inheritDeform?re:ee.mesh,ee.mesh.setParentMesh(re),ee.mesh.updateUVs()}for(this.linkedMeshes.length=0,G=k.readInt(!0),V=0;V<G;V++)(Y=new A.EventData(k.readStringRef())).intValue=k.readInt(!1),Y.floatValue=k.readFloat(),Y.stringValue=k.readString(),Y.audioPath=k.readString(),Y.audioPath!=null&&(Y.volume=k.readFloat(),Y.balance=k.readFloat()),N.events.push(Y);for(G=k.readInt(!0),V=0;V<G;V++)N.animations.push(this.readAnimation(k,k.readString(),N));return N},D.prototype.readSkin=function(I,M,N,k){var F=null,G=0;if(N){if((G=I.readInt(!0))==0)return null;F=new A.Skin("default")}else{(F=new A.Skin(I.readStringRef())).bones.length=I.readInt(!0);for(var V=0,j=F.bones.length;V<j;V++)F.bones[V]=M.bones[I.readInt(!0)];for(V=0,j=I.readInt(!0);V<j;V++)F.constraints.push(M.ikConstraints[I.readInt(!0)]);for(V=0,j=I.readInt(!0);V<j;V++)F.constraints.push(M.transformConstraints[I.readInt(!0)]);for(V=0,j=I.readInt(!0);V<j;V++)F.constraints.push(M.pathConstraints[I.readInt(!0)]);G=I.readInt(!0)}for(V=0;V<G;V++)for(var H=I.readInt(!0),U=0,X=I.readInt(!0);U<X;U++){var Y=I.readStringRef(),z=this.readAttachment(I,M,F,H,Y,k);z!=null&&F.setAttachment(H,Y,z)}return F},D.prototype.readAttachment=function(I,M,N,k,F,G){var V=this.scale,j=I.readStringRef();j==null&&(j=F);var H=I.readByte();switch(D.AttachmentTypeValues[H]){case A.AttachmentType.Region:var U=I.readStringRef(),X=I.readFloat(),Y=I.readFloat(),z=I.readFloat(),W=I.readFloat(),Z=I.readFloat(),Q=I.readFloat(),ee=I.readFloat(),te=I.readInt32();U==null&&(U=j);var re=this.attachmentLoader.newRegionAttachment(N,j,U);return re==null?null:(re.path=U,re.x=Y*V,re.y=z*V,re.scaleX=W,re.scaleY=Z,re.rotation=X,re.width=Q*V,re.height=ee*V,A.Color.rgba8888ToColor(re.color,te),re.updateOffset(),re);case A.AttachmentType.BoundingBox:var ie=I.readInt(!0),ne=this.readVertices(I,ie),he=(te=G?I.readInt32():0,this.attachmentLoader.newBoundingBoxAttachment(N,j));return he==null?null:(he.worldVerticesLength=ie<<1,he.vertices=ne.vertices,he.bones=ne.bones,G&&A.Color.rgba8888ToColor(he.color,te),he);case A.AttachmentType.Mesh:U=I.readStringRef(),te=I.readInt32(),ie=I.readInt(!0);var pe=this.readFloatArray(I,ie<<1,1),K=this.readShortArray(I),ue=(ne=this.readVertices(I,ie),I.readInt(!0)),le=null;return Q=0,ee=0,G&&(le=this.readShortArray(I),Q=I.readFloat(),ee=I.readFloat()),U==null&&(U=j),(ce=this.attachmentLoader.newMeshAttachment(N,j,U))==null?null:(ce.path=U,A.Color.rgba8888ToColor(ce.color,te),ce.bones=ne.bones,ce.vertices=ne.vertices,ce.worldVerticesLength=ie<<1,ce.triangles=K,ce.regionUVs=pe,ce.updateUVs(),ce.hullLength=ue<<1,G&&(ce.edges=le,ce.width=Q*V,ce.height=ee*V),ce);case A.AttachmentType.LinkedMesh:U=I.readStringRef(),te=I.readInt32();var ce,_e=I.readStringRef(),oe=I.readStringRef(),de=I.readBoolean();return Q=0,ee=0,G&&(Q=I.readFloat(),ee=I.readFloat()),U==null&&(U=j),(ce=this.attachmentLoader.newMeshAttachment(N,j,U))==null?null:(ce.path=U,A.Color.rgba8888ToColor(ce.color,te),G&&(ce.width=Q*V,ce.height=ee*V),this.linkedMeshes.push(new P(ce,_e,k,oe,de)),ce);case A.AttachmentType.Path:for(var me=I.readBoolean(),ye=I.readBoolean(),ge=(ie=I.readInt(!0),ne=this.readVertices(I,ie),A.Utils.newArray(ie/3,0)),we=0,Te=ge.length;we<Te;we++)ge[we]=I.readFloat()*V;return te=G?I.readInt32():0,(U=this.attachmentLoader.newPathAttachment(N,j))==null?null:(U.closed=me,U.constantSpeed=ye,U.worldVerticesLength=ie<<1,U.vertices=ne.vertices,U.bones=ne.bones,U.lengths=ge,G&&A.Color.rgba8888ToColor(U.color,te),U);case A.AttachmentType.Point:X=I.readFloat(),Y=I.readFloat(),z=I.readFloat(),te=G?I.readInt32():0;var Ee=this.attachmentLoader.newPointAttachment(N,j);return Ee==null?null:(Ee.x=Y*V,Ee.y=z*V,Ee.rotation=X,G&&A.Color.rgba8888ToColor(Ee.color,te),Ee);case A.AttachmentType.Clipping:var De=I.readInt(!0),fe=(ie=I.readInt(!0),ne=this.readVertices(I,ie),te=G?I.readInt32():0,this.attachmentLoader.newClippingAttachment(N,j));return fe==null?null:(fe.endSlot=M.slots[De],fe.worldVerticesLength=ie<<1,fe.vertices=ne.vertices,fe.bones=ne.bones,G&&A.Color.rgba8888ToColor(fe.color,te),fe)}return null},D.prototype.readVertices=function(I,M){var N=M<<1,k=new E,F=this.scale;if(!I.readBoolean())return k.vertices=this.readFloatArray(I,N,F),k;for(var G=new Array,V=new Array,j=0;j<M;j++){var H=I.readInt(!0);V.push(H);for(var U=0;U<H;U++)V.push(I.readInt(!0)),G.push(I.readFloat()*F),G.push(I.readFloat()*F),G.push(I.readFloat())}return k.vertices=A.Utils.toFloatArray(G),k.bones=V,k},D.prototype.readFloatArray=function(I,M,N){var k=new Array(M);if(N==1)for(var F=0;F<M;F++)k[F]=I.readFloat();else for(F=0;F<M;F++)k[F]=I.readFloat()*N;return k},D.prototype.readShortArray=function(I){for(var M=I.readInt(!0),N=new Array(M),k=0;k<M;k++)N[k]=I.readShort();return N},D.prototype.readAnimation=function(I,M,N){for(var k=new Array,F=this.scale,G=0,V=new A.Color,j=new A.Color,H=0,U=I.readInt(!0);H<U;H++)for(var X=I.readInt(!0),Y=0,z=I.readInt(!0);Y<z;Y++){var W=I.readByte(),Z=I.readInt(!0);switch(W){case D.SLOT_ATTACHMENT:(re=new A.AttachmentTimeline(Z)).slotIndex=X;for(var Q=0;Q<Z;Q++)re.setFrame(Q,I.readFloat(),I.readStringRef());k.push(re),G=Math.max(G,re.frames[Z-1]);break;case D.SLOT_COLOR:for((re=new A.ColorTimeline(Z)).slotIndex=X,Q=0;Q<Z;Q++){var ee=I.readFloat();A.Color.rgba8888ToColor(V,I.readInt32()),re.setFrame(Q,ee,V.r,V.g,V.b,V.a),Q<Z-1&&this.readCurve(I,Q,re)}k.push(re),G=Math.max(G,re.frames[(Z-1)*A.ColorTimeline.ENTRIES]);break;case D.SLOT_TWO_COLOR:for((re=new A.TwoColorTimeline(Z)).slotIndex=X,Q=0;Q<Z;Q++)ee=I.readFloat(),A.Color.rgba8888ToColor(V,I.readInt32()),A.Color.rgb888ToColor(j,I.readInt32()),re.setFrame(Q,ee,V.r,V.g,V.b,V.a,j.r,j.g,j.b),Q<Z-1&&this.readCurve(I,Q,re);k.push(re),G=Math.max(G,re.frames[(Z-1)*A.TwoColorTimeline.ENTRIES])}}for(H=0,U=I.readInt(!0);H<U;H++){var te=I.readInt(!0);for(Y=0,z=I.readInt(!0);Y<z;Y++)switch(W=I.readByte(),Z=I.readInt(!0),W){case D.BONE_ROTATE:for((re=new A.RotateTimeline(Z)).boneIndex=te,Q=0;Q<Z;Q++)re.setFrame(Q,I.readFloat(),I.readFloat()),Q<Z-1&&this.readCurve(I,Q,re);k.push(re),G=Math.max(G,re.frames[(Z-1)*A.RotateTimeline.ENTRIES]);break;case D.BONE_TRANSLATE:case D.BONE_SCALE:case D.BONE_SHEAR:var re=void 0,ie=1;for(W==D.BONE_SCALE?re=new A.ScaleTimeline(Z):W==D.BONE_SHEAR?re=new A.ShearTimeline(Z):(re=new A.TranslateTimeline(Z),ie=F),re.boneIndex=te,Q=0;Q<Z;Q++)re.setFrame(Q,I.readFloat(),I.readFloat()*ie,I.readFloat()*ie),Q<Z-1&&this.readCurve(I,Q,re);k.push(re),G=Math.max(G,re.frames[(Z-1)*A.TranslateTimeline.ENTRIES])}}for(H=0,U=I.readInt(!0);H<U;H++){var ne=I.readInt(!0);for(Z=I.readInt(!0),(re=new A.IkConstraintTimeline(Z)).ikConstraintIndex=ne,Q=0;Q<Z;Q++)re.setFrame(Q,I.readFloat(),I.readFloat(),I.readFloat()*F,I.readByte(),I.readBoolean(),I.readBoolean()),Q<Z-1&&this.readCurve(I,Q,re);k.push(re),G=Math.max(G,re.frames[(Z-1)*A.IkConstraintTimeline.ENTRIES])}for(H=0,U=I.readInt(!0);H<U;H++){for(ne=I.readInt(!0),Z=I.readInt(!0),(re=new A.TransformConstraintTimeline(Z)).transformConstraintIndex=ne,Q=0;Q<Z;Q++)re.setFrame(Q,I.readFloat(),I.readFloat(),I.readFloat(),I.readFloat(),I.readFloat()),Q<Z-1&&this.readCurve(I,Q,re);k.push(re),G=Math.max(G,re.frames[(Z-1)*A.TransformConstraintTimeline.ENTRIES])}for(H=0,U=I.readInt(!0);H<U;H++){ne=I.readInt(!0);var he=N.pathConstraints[ne];for(Y=0,z=I.readInt(!0);Y<z;Y++)switch(W=I.readByte(),Z=I.readInt(!0),W){case D.PATH_POSITION:case D.PATH_SPACING:for(re=void 0,ie=1,W==D.PATH_SPACING?(re=new A.PathConstraintSpacingTimeline(Z),he.spacingMode!=A.SpacingMode.Length&&he.spacingMode!=A.SpacingMode.Fixed||(ie=F)):(re=new A.PathConstraintPositionTimeline(Z),he.positionMode==A.PositionMode.Fixed&&(ie=F)),re.pathConstraintIndex=ne,Q=0;Q<Z;Q++)re.setFrame(Q,I.readFloat(),I.readFloat()*ie),Q<Z-1&&this.readCurve(I,Q,re);k.push(re),G=Math.max(G,re.frames[(Z-1)*A.PathConstraintPositionTimeline.ENTRIES]);break;case D.PATH_MIX:for((re=new A.PathConstraintMixTimeline(Z)).pathConstraintIndex=ne,Q=0;Q<Z;Q++)re.setFrame(Q,I.readFloat(),I.readFloat(),I.readFloat()),Q<Z-1&&this.readCurve(I,Q,re);k.push(re),G=Math.max(G,re.frames[(Z-1)*A.PathConstraintMixTimeline.ENTRIES])}}for(H=0,U=I.readInt(!0);H<U;H++){var pe=N.skins[I.readInt(!0)];for(Y=0,z=I.readInt(!0);Y<z;Y++){X=I.readInt(!0);for(var K=0,ue=I.readInt(!0);K<ue;K++){var le=pe.getAttachment(X,I.readStringRef()),ce=le.bones!=null,_e=le.vertices,oe=ce?_e.length/3*2:_e.length;for(Z=I.readInt(!0),(re=new A.DeformTimeline(Z)).slotIndex=X,re.attachment=le,Q=0;Q<Z;Q++){ee=I.readFloat();var de=void 0,me=I.readInt(!0);if(me==0)de=ce?A.Utils.newFloatArray(oe):_e;else{de=A.Utils.newFloatArray(oe);var ye=I.readInt(!0);if(me+=ye,F==1)for(var ge=ye;ge<me;ge++)de[ge]=I.readFloat();else for(ge=ye;ge<me;ge++)de[ge]=I.readFloat()*F;if(!ce){ge=0;for(var we=de.length;ge<we;ge++)de[ge]+=_e[ge]}}re.setFrame(Q,ee,de),Q<Z-1&&this.readCurve(I,Q,re)}k.push(re),G=Math.max(G,re.frames[Z-1])}}}var Te=I.readInt(!0);if(Te>0){re=new A.DrawOrderTimeline(Te);var Ee=N.slots.length;for(H=0;H<Te;H++){ee=I.readFloat();var De=I.readInt(!0),fe=A.Utils.newArray(Ee,0);for(Y=Ee-1;Y>=0;Y--)fe[Y]=-1;var Ce=A.Utils.newArray(Ee-De,0),Se=0,be=0;for(Y=0;Y<De;Y++){for(X=I.readInt(!0);Se!=X;)Ce[be++]=Se++;fe[Se+I.readInt(!0)]=Se++}for(;Se<Ee;)Ce[be++]=Se++;for(Y=Ee-1;Y>=0;Y--)fe[Y]==-1&&(fe[Y]=Ce[--be]);re.setFrame(H,ee,fe)}k.push(re),G=Math.max(G,re.frames[Te-1])}var Re=I.readInt(!0);if(Re>0){for(re=new A.EventTimeline(Re),H=0;H<Re;H++){ee=I.readFloat();var Ve=N.events[I.readInt(!0)],Pe=new A.Event(ee,Ve);Pe.intValue=I.readInt(!1),Pe.floatValue=I.readFloat(),Pe.stringValue=I.readBoolean()?I.readString():Ve.stringValue,Pe.data.audioPath!=null&&(Pe.volume=I.readFloat(),Pe.balance=I.readFloat()),re.setFrame(H,Pe)}k.push(re),G=Math.max(G,re.frames[Re-1])}return new A.Animation(M,k,G)},D.prototype.readCurve=function(I,M,N){switch(I.readByte()){case D.CURVE_STEPPED:N.setStepped(M);break;case D.CURVE_BEZIER:this.setCurve(N,M,I.readFloat(),I.readFloat(),I.readFloat(),I.readFloat())}},D.prototype.setCurve=function(I,M,N,k,F,G){I.setCurve(M,N,k,F,G)},D.AttachmentTypeValues=[0,1,2,3,4,5,6],D.TransformModeValues=[A.TransformMode.Normal,A.TransformMode.OnlyTranslation,A.TransformMode.NoRotationOrReflection,A.TransformMode.NoScale,A.TransformMode.NoScaleOrReflection],D.PositionModeValues=[A.PositionMode.Fixed,A.PositionMode.Percent],D.SpacingModeValues=[A.SpacingMode.Length,A.SpacingMode.Fixed,A.SpacingMode.Percent],D.RotateModeValues=[A.RotateMode.Tangent,A.RotateMode.Chain,A.RotateMode.ChainScale],D.BlendModeValues=[A.BlendMode.Normal,A.BlendMode.Additive,A.BlendMode.Multiply,A.BlendMode.Screen],D.BONE_ROTATE=0,D.BONE_TRANSLATE=1,D.BONE_SCALE=2,D.BONE_SHEAR=3,D.SLOT_ATTACHMENT=0,D.SLOT_COLOR=1,D.SLOT_TWO_COLOR=2,D.PATH_POSITION=0,D.PATH_SPACING=1,D.PATH_MIX=2,D.CURVE_LINEAR=0,D.CURVE_STEPPED=1,D.CURVE_BEZIER=2,D}();A.SkeletonBinary=O;var R=function(){function D(I,M,N,k){M===void 0&&(M=new Array),N===void 0&&(N=0),k===void 0&&(k=new DataView(I.buffer)),this.strings=M,this.index=N,this.buffer=k}return D.prototype.readByte=function(){return this.buffer.getInt8(this.index++)},D.prototype.readShort=function(){var I=this.buffer.getInt16(this.index);return this.index+=2,I},D.prototype.readInt32=function(){var I=this.buffer.getInt32(this.index);return this.index+=4,I},D.prototype.readInt=function(I){var M=this.readByte(),N=127&M;return(128&M)!=0&&(N|=(127&(M=this.readByte()))<<7,(128&M)!=0&&(N|=(127&(M=this.readByte()))<<14,(128&M)!=0&&(N|=(127&(M=this.readByte()))<<21,(128&M)!=0&&(N|=(127&(M=this.readByte()))<<28)))),I?N:N>>>1^-(1&N)},D.prototype.readStringRef=function(){var I=this.readInt(!0);return I==0?null:this.strings[I-1]},D.prototype.readString=function(){var I=this.readInt(!0);switch(I){case 0:return null;case 1:return""}I--;for(var M="",N=0;N<I;){var k=this.readByte();switch(k>>4){case 12:case 13:M+=String.fromCharCode((31&k)<<6|63&this.readByte()),N+=2;break;case 14:M+=String.fromCharCode((15&k)<<12|(63&this.readByte())<<6|63&this.readByte()),N+=3;break;default:M+=String.fromCharCode(k),N++}}return M},D.prototype.readFloat=function(){var I=this.buffer.getFloat32(this.index);return this.index+=4,I},D.prototype.readBoolean=function(){return this.readByte()!=0},D}(),P=function(D,I,M,N,k){this.mesh=D,this.skin=I,this.slotIndex=M,this.parent=N,this.inheritDeform=k},E=function(D,I){D===void 0&&(D=null),I===void 0&&(I=null),this.bones=D,this.vertices=I}}(w||(w={})),function(A){var O=function(){function R(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new A.Pool(function(){return A.Utils.newFloatArray(16)})}return R.prototype.update=function(P,E){if(P==null)throw new Error("skeleton cannot be null.");var D=this.boundingBoxes,I=this.polygons,M=this.polygonPool,N=P.slots,k=N.length;D.length=0,M.freeAll(I),I.length=0;for(var F=0;F<k;F++){var G=N[F];if(G.bone.active){var V=G.getAttachment();if(V instanceof A.BoundingBoxAttachment){var j=V;D.push(j);var H=M.obtain();H.length!=j.worldVerticesLength&&(H=A.Utils.newFloatArray(j.worldVerticesLength)),I.push(H),j.computeWorldVertices(G,0,j.worldVerticesLength,H,0,2)}}}E?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},R.prototype.aabbCompute=function(){for(var P=Number.POSITIVE_INFINITY,E=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,I=Number.NEGATIVE_INFINITY,M=this.polygons,N=0,k=M.length;N<k;N++)for(var F=M[N],G=F,V=0,j=F.length;V<j;V+=2){var H=G[V],U=G[V+1];P=Math.min(P,H),E=Math.min(E,U),D=Math.max(D,H),I=Math.max(I,U)}this.minX=P,this.minY=E,this.maxX=D,this.maxY=I},R.prototype.aabbContainsPoint=function(P,E){return P>=this.minX&&P<=this.maxX&&E>=this.minY&&E<=this.maxY},R.prototype.aabbIntersectsSegment=function(P,E,D,I){var M=this.minX,N=this.minY,k=this.maxX,F=this.maxY;if(P<=M&&D<=M||E<=N&&I<=N||P>=k&&D>=k||E>=F&&I>=F)return!1;var G=(I-E)/(D-P),V=G*(M-P)+E;if(V>N&&V<F||(V=G*(k-P)+E)>N&&V<F)return!0;var j=(N-E)/G+P;return j>M&&j<k||(j=(F-E)/G+P)>M&&j<k},R.prototype.aabbIntersectsSkeleton=function(P){return this.minX<P.maxX&&this.maxX>P.minX&&this.minY<P.maxY&&this.maxY>P.minY},R.prototype.containsPoint=function(P,E){for(var D=this.polygons,I=0,M=D.length;I<M;I++)if(this.containsPointPolygon(D[I],P,E))return this.boundingBoxes[I];return null},R.prototype.containsPointPolygon=function(P,E,D){for(var I=P,M=P.length,N=M-2,k=!1,F=0;F<M;F+=2){var G=I[F+1],V=I[N+1];if(G<D&&V>=D||V<D&&G>=D){var j=I[F];j+(D-G)/(V-G)*(I[N]-j)<E&&(k=!k)}N=F}return k},R.prototype.intersectsSegment=function(P,E,D,I){for(var M=this.polygons,N=0,k=M.length;N<k;N++)if(this.intersectsSegmentPolygon(M[N],P,E,D,I))return this.boundingBoxes[N];return null},R.prototype.intersectsSegmentPolygon=function(P,E,D,I,M){for(var N=P,k=P.length,F=E-I,G=D-M,V=E*M-D*I,j=N[k-2],H=N[k-1],U=0;U<k;U+=2){var X=N[U],Y=N[U+1],z=j*Y-H*X,W=j-X,Z=H-Y,Q=F*Z-G*W,ee=(V*W-F*z)/Q;if((ee>=j&&ee<=X||ee>=X&&ee<=j)&&(ee>=E&&ee<=I||ee>=I&&ee<=E)){var te=(V*Z-G*z)/Q;if((te>=H&&te<=Y||te>=Y&&te<=H)&&(te>=D&&te<=M||te>=M&&te<=D))return!0}j=X,H=Y}return!1},R.prototype.getPolygon=function(P){if(P==null)throw new Error("boundingBox cannot be null.");var E=this.boundingBoxes.indexOf(P);return E==-1?null:this.polygons[E]},R.prototype.getWidth=function(){return this.maxX-this.minX},R.prototype.getHeight=function(){return this.maxY-this.minY},R}();A.SkeletonBounds=O}(w||(w={})),function(A){var O=function(){function R(){this.triangulator=new A.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}return R.prototype.clipStart=function(P,E){if(this.clipAttachment!=null)return 0;this.clipAttachment=E;var D=E.worldVerticesLength,I=A.Utils.setArraySize(this.clippingPolygon,D);E.computeWorldVertices(P,0,D,I,0,2);var M=this.clippingPolygon;R.makeClockwise(M);for(var N=this.clippingPolygons=this.triangulator.decompose(M,this.triangulator.triangulate(M)),k=0,F=N.length;k<F;k++){var G=N[k];R.makeClockwise(G),G.push(G[0]),G.push(G[1])}return N.length},R.prototype.clipEndWithSlot=function(P){this.clipAttachment!=null&&this.clipAttachment.endSlot==P.data&&this.clipEnd()},R.prototype.clipEnd=function(){this.clipAttachment!=null&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},R.prototype.isClipping=function(){return this.clipAttachment!=null},R.prototype.clipTriangles=function(P,E,D,I,M,N,k,F,G,V,j,H){var U=this.clipOutput,X=this.clippedVertices,Y=this.clippedTriangles,z=this.clippingPolygons,W=this.clippingPolygons.length,Z=F?12:8,Q=0;V=V||0,j=j||0,H=H||0,X.length=0,Y.length=0;e:for(var ee=V,te=V+I;ee<te;ee+=3){var re=D[ee]*G,ie=re+j,ne=re+H,he=P[ie],pe=P[ie+1],K=M[ne],ue=M[ne+1];ne=(re=D[ee+1]*G)+H;var le=P[ie=re+j],ce=P[ie+1],_e=M[ne],oe=M[ne+1];ne=(re=D[ee+2]*G)+H;for(var de=P[ie=re+j],me=P[ie+1],ye=M[ne],ge=M[ne+1],we=0;we<W;we++){var Te=X.length;if(!this.clip(he,pe,le,ce,de,me,z[we],U)){(Pe=A.Utils.setArraySize(X,Te+3*Z))[Te]=he,Pe[Te+1]=pe,Pe[Te+2]=N.r,Pe[Te+3]=N.g,Pe[Te+4]=N.b,Pe[Te+5]=N.a,F?(Pe[Te+6]=K,Pe[Te+7]=ue,Pe[Te+8]=k.r,Pe[Te+9]=k.g,Pe[Te+10]=k.b,Pe[Te+11]=k.a,Pe[Te+12]=le,Pe[Te+13]=ce,Pe[Te+14]=N.r,Pe[Te+15]=N.g,Pe[Te+16]=N.b,Pe[Te+17]=N.a,Pe[Te+18]=_e,Pe[Te+19]=oe,Pe[Te+20]=k.r,Pe[Te+21]=k.g,Pe[Te+22]=k.b,Pe[Te+23]=k.a,Pe[Te+24]=de,Pe[Te+25]=me,Pe[Te+26]=N.r,Pe[Te+27]=N.g,Pe[Te+28]=N.b,Pe[Te+29]=N.a,Pe[Te+30]=ye,Pe[Te+31]=ge,Pe[Te+32]=k.r,Pe[Te+33]=k.g,Pe[Te+34]=k.b,Pe[Te+35]=k.a):(Pe[Te+6]=K,Pe[Te+7]=ue,Pe[Te+8]=le,Pe[Te+9]=ce,Pe[Te+10]=N.r,Pe[Te+11]=N.g,Pe[Te+12]=N.b,Pe[Te+13]=N.a,Pe[Te+14]=_e,Pe[Te+15]=oe,Pe[Te+16]=de,Pe[Te+17]=me,Pe[Te+18]=N.r,Pe[Te+19]=N.g,Pe[Te+20]=N.b,Pe[Te+21]=N.a,Pe[Te+22]=ye,Pe[Te+23]=ge),Te=Y.length,($e=A.Utils.setArraySize(Y,Te+3))[Te]=Q,$e[Te+1]=Q+1,$e[Te+2]=Q+2,Q+=3;continue e}var Ee=U.length;if(Ee!=0){for(var De=ce-me,fe=de-le,Ce=he-de,Se=me-pe,be=1/(De*Ce+fe*(pe-me)),Re=Ee>>1,Ve=this.clipOutput,Pe=A.Utils.setArraySize(X,Te+Re*Z),ke=0;ke<Ee;ke+=2){var Ne=Ve[ke],Ae=Ve[ke+1];Pe[Te]=Ne,Pe[Te+1]=Ae,Pe[Te+2]=N.r,Pe[Te+3]=N.g,Pe[Te+4]=N.b,Pe[Te+5]=N.a;var Oe=Ne-de,Fe=Ae-me,nt=(De*Oe+fe*Fe)*be,Ze=(Se*Oe+Ce*Fe)*be,Xe=1-nt-Ze;Pe[Te+6]=K*nt+_e*Ze+ye*Xe,Pe[Te+7]=ue*nt+oe*Ze+ge*Xe,F&&(Pe[Te+8]=k.r,Pe[Te+9]=k.g,Pe[Te+10]=k.b,Pe[Te+11]=k.a),Te+=Z}Te=Y.length;var $e=A.Utils.setArraySize(Y,Te+3*(Re-2));for(Re--,ke=1;ke<Re;ke++)$e[Te]=Q,$e[Te+1]=Q+ke,$e[Te+2]=Q+ke+1,Te+=3;Q+=Re+1}}}},R.prototype.clip=function(P,E,D,I,M,N,k,F){var G=F,V=!1,j=null;k.length%4>=2?(j=F,F=this.scratch):j=this.scratch,j.length=0,j.push(P),j.push(E),j.push(D),j.push(I),j.push(M),j.push(N),j.push(P),j.push(E),F.length=0;for(var H=k,U=k.length-4,X=0;;X+=2){for(var Y=H[X],z=H[X+1],W=H[X+2],Z=H[X+3],Q=Y-W,ee=z-Z,te=j,re=j.length-2,ie=F.length,ne=0;ne<re;ne+=2){var he=te[ne],pe=te[ne+1],K=te[ne+2],ue=te[ne+3],le=Q*(ue-Z)-ee*(K-W)>0;if(Q*(pe-Z)-ee*(he-W)>0){if(le){F.push(K),F.push(ue);continue}var ce=(oe=ue-pe)*(W-Y)-(de=K-he)*(Z-z);if(Math.abs(ce)>1e-6){var _e=(de*(z-pe)-oe*(Y-he))/ce;F.push(Y+(W-Y)*_e),F.push(z+(Z-z)*_e)}else F.push(Y),F.push(z)}else if(le){var oe,de;ce=(oe=ue-pe)*(W-Y)-(de=K-he)*(Z-z),Math.abs(ce)>1e-6?(_e=(de*(z-pe)-oe*(Y-he))/ce,F.push(Y+(W-Y)*_e),F.push(z+(Z-z)*_e)):(F.push(Y),F.push(z)),F.push(K),F.push(ue)}V=!0}if(ie==F.length)return G.length=0,!0;if(F.push(F[0]),F.push(F[1]),X==U)break;var me=F;(F=j).length=0,j=me}if(G!=F){G.length=0,X=0;for(var ye=F.length-2;X<ye;X++)G[X]=F[X]}else G.length=G.length-2;return V},R.makeClockwise=function(P){for(var E=P,D=P.length,I=E[D-2]*E[1]-E[0]*E[D-1],M=0,N=0,k=0,F=0,G=D-3;F<G;F+=2)M=E[F],N=E[F+1],k=E[F+2],I+=M*E[F+3]-k*N;if(!(I<0)){F=0;var V=D-2;for(G=D>>1;F<G;F+=2){var j=E[F],H=E[F+1],U=V-F;E[F]=E[U],E[F+1]=E[U+1],E[U]=j,E[U+1]=H}}},R}();A.SkeletonClipping=O}(w||(w={})),function(A){var O=function(){function R(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return R.prototype.findBone=function(P){if(P==null)throw new Error("boneName cannot be null.");for(var E=this.bones,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findBoneIndex=function(P){if(P==null)throw new Error("boneName cannot be null.");for(var E=this.bones,D=0,I=E.length;D<I;D++)if(E[D].name==P)return D;return-1},R.prototype.findSlot=function(P){if(P==null)throw new Error("slotName cannot be null.");for(var E=this.slots,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findSlotIndex=function(P){if(P==null)throw new Error("slotName cannot be null.");for(var E=this.slots,D=0,I=E.length;D<I;D++)if(E[D].name==P)return D;return-1},R.prototype.findSkin=function(P){if(P==null)throw new Error("skinName cannot be null.");for(var E=this.skins,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findEvent=function(P){if(P==null)throw new Error("eventDataName cannot be null.");for(var E=this.events,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findAnimation=function(P){if(P==null)throw new Error("animationName cannot be null.");for(var E=this.animations,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findIkConstraint=function(P){if(P==null)throw new Error("constraintName cannot be null.");for(var E=this.ikConstraints,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findTransformConstraint=function(P){if(P==null)throw new Error("constraintName cannot be null.");for(var E=this.transformConstraints,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findPathConstraint=function(P){if(P==null)throw new Error("constraintName cannot be null.");for(var E=this.pathConstraints,D=0,I=E.length;D<I;D++){var M=E[D];if(M.name==P)return M}return null},R.prototype.findPathConstraintIndex=function(P){if(P==null)throw new Error("pathConstraintName cannot be null.");for(var E=this.pathConstraints,D=0,I=E.length;D<I;D++)if(E[D].name==P)return D;return-1},R}();A.SkeletonData=O}(w||(w={})),function(A){var O=function(){function P(E){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=E}return P.prototype.readSkeletonData=function(E){var D=this.scale,I=new A.SkeletonData,M=typeof E=="string"?JSON.parse(E):E,N=M.skeleton;if(N!=null&&(I.hash=N.hash,I.version=N.spine,I.x=N.x,I.y=N.y,I.width=N.width,I.height=N.height,I.fps=N.fps,I.imagesPath=N.images),M.bones)for(var k=0;k<M.bones.length;k++){var F=M.bones[k],G=null,V=this.getValue(F,"parent",null);if(V!=null&&(G=I.findBone(V))==null)throw new Error("Parent bone not found: "+V);(X=new A.BoneData(I.bones.length,F.name,G)).length=this.getValue(F,"length",0)*D,X.x=this.getValue(F,"x",0)*D,X.y=this.getValue(F,"y",0)*D,X.rotation=this.getValue(F,"rotation",0),X.scaleX=this.getValue(F,"scaleX",1),X.scaleY=this.getValue(F,"scaleY",1),X.shearX=this.getValue(F,"shearX",0),X.shearY=this.getValue(F,"shearY",0),X.transformMode=P.transformModeFromString(this.getValue(F,"transform","normal")),X.skinRequired=this.getValue(F,"skin",!1),I.bones.push(X)}if(M.slots)for(k=0;k<M.slots.length;k++){var j=(le=M.slots[k]).name,H=le.bone,U=I.findBone(H);if(U==null)throw new Error("Slot bone not found: "+H);var X=new A.SlotData(I.slots.length,j,U),Y=this.getValue(le,"color",null);Y!=null&&X.color.setFromString(Y);var z=this.getValue(le,"dark",null);z!=null&&(X.darkColor=new A.Color(1,1,1,1),X.darkColor.setFromString(z)),X.attachmentName=this.getValue(le,"attachment",null),X.blendMode=P.blendModeFromString(this.getValue(le,"blend","normal")),I.slots.push(X)}if(M.ik)for(k=0;k<M.ik.length;k++){var W=M.ik[k];(X=new A.IkConstraintData(W.name)).order=this.getValue(W,"order",0),X.skinRequired=this.getValue(W,"skin",!1);for(var Z=0;Z<W.bones.length;Z++){if(H=W.bones[Z],(pe=I.findBone(H))==null)throw new Error("IK bone not found: "+H);X.bones.push(pe)}var Q=W.target;if(X.target=I.findBone(Q),X.target==null)throw new Error("IK target bone not found: "+Q);X.mix=this.getValue(W,"mix",1),X.softness=this.getValue(W,"softness",0)*D,X.bendDirection=this.getValue(W,"bendPositive",!0)?1:-1,X.compress=this.getValue(W,"compress",!1),X.stretch=this.getValue(W,"stretch",!1),X.uniform=this.getValue(W,"uniform",!1),I.ikConstraints.push(X)}if(M.transform)for(k=0;k<M.transform.length;k++){for(W=M.transform[k],(X=new A.TransformConstraintData(W.name)).order=this.getValue(W,"order",0),X.skinRequired=this.getValue(W,"skin",!1),Z=0;Z<W.bones.length;Z++){if(H=W.bones[Z],(pe=I.findBone(H))==null)throw new Error("Transform constraint bone not found: "+H);X.bones.push(pe)}if(Q=W.target,X.target=I.findBone(Q),X.target==null)throw new Error("Transform constraint target bone not found: "+Q);X.local=this.getValue(W,"local",!1),X.relative=this.getValue(W,"relative",!1),X.offsetRotation=this.getValue(W,"rotation",0),X.offsetX=this.getValue(W,"x",0)*D,X.offsetY=this.getValue(W,"y",0)*D,X.offsetScaleX=this.getValue(W,"scaleX",0),X.offsetScaleY=this.getValue(W,"scaleY",0),X.offsetShearY=this.getValue(W,"shearY",0),X.rotateMix=this.getValue(W,"rotateMix",1),X.translateMix=this.getValue(W,"translateMix",1),X.scaleMix=this.getValue(W,"scaleMix",1),X.shearMix=this.getValue(W,"shearMix",1),I.transformConstraints.push(X)}if(M.path)for(k=0;k<M.path.length;k++){for(W=M.path[k],(X=new A.PathConstraintData(W.name)).order=this.getValue(W,"order",0),X.skinRequired=this.getValue(W,"skin",!1),Z=0;Z<W.bones.length;Z++){if(H=W.bones[Z],(pe=I.findBone(H))==null)throw new Error("Transform constraint bone not found: "+H);X.bones.push(pe)}if(Q=W.target,X.target=I.findSlot(Q),X.target==null)throw new Error("Path target slot not found: "+Q);X.positionMode=P.positionModeFromString(this.getValue(W,"positionMode","percent")),X.spacingMode=P.spacingModeFromString(this.getValue(W,"spacingMode","length")),X.rotateMode=P.rotateModeFromString(this.getValue(W,"rotateMode","tangent")),X.offsetRotation=this.getValue(W,"rotation",0),X.position=this.getValue(W,"position",0),X.positionMode==A.PositionMode.Fixed&&(X.position*=D),X.spacing=this.getValue(W,"spacing",0),X.spacingMode!=A.SpacingMode.Length&&X.spacingMode!=A.SpacingMode.Fixed||(X.spacing*=D),X.rotateMix=this.getValue(W,"rotateMix",1),X.translateMix=this.getValue(W,"translateMix",1),I.pathConstraints.push(X)}if(M.skins){var ee=M.skins;if(!(ee instanceof Array)){var te=[];for(var re in ee)te.push({name:re,attachments:ee[re]});ee=te}for(k=0;k<ee.length;k++){var ie=ee[k],ne=new A.Skin(ie.name);if(ie.bones)for(var he=0;he<ie.bones.length;he++){var pe;if((pe=I.findBone(ie.bones[he]))==null)throw new Error("Skin bone not found: "+ie.bones[k]);ne.bones.push(pe)}if(ie.ik)for(he=0;he<ie.ik.length;he++){if((K=I.findIkConstraint(ie.ik[he]))==null)throw new Error("Skin IK constraint not found: "+ie.ik[k]);ne.constraints.push(K)}if(ie.transform)for(he=0;he<ie.transform.length;he++){if((K=I.findTransformConstraint(ie.transform[he]))==null)throw new Error("Skin transform constraint not found: "+ie.transform[k]);ne.constraints.push(K)}if(ie.path)for(he=0;he<ie.path.length;he++){var K;if((K=I.findPathConstraint(ie.path[he]))==null)throw new Error("Skin path constraint not found: "+ie.path[k]);ne.constraints.push(K)}for(var j in ie.attachments){var ue=I.findSlot(j);if(ue==null)throw new Error("Slot not found: "+j);var le=ie.attachments[j];for(var ce in le){var _e=this.readAttachment(le[ce],ne,ue.index,ce,I);_e!=null&&ne.setAttachment(ue.index,ce,_e)}}I.skins.push(ne),ne.name=="default"&&(I.defaultSkin=ne)}}k=0;for(var oe=this.linkedMeshes.length;k<oe;k++){var de=this.linkedMeshes[k];if((ne=de.skin==null?I.defaultSkin:I.findSkin(de.skin))==null)throw new Error("Skin not found: "+de.skin);var me=ne.getAttachment(de.slotIndex,de.parent);if(me==null)throw new Error("Parent mesh not found: "+de.parent);de.mesh.deformAttachment=de.inheritDeform?me:de.mesh,de.mesh.setParentMesh(me),de.mesh.updateUVs()}if(this.linkedMeshes.length=0,M.events)for(var ye in M.events){var ge=M.events[ye];(X=new A.EventData(ye)).intValue=this.getValue(ge,"int",0),X.floatValue=this.getValue(ge,"float",0),X.stringValue=this.getValue(ge,"string",""),X.audioPath=this.getValue(ge,"audio",null),X.audioPath!=null&&(X.volume=this.getValue(ge,"volume",1),X.balance=this.getValue(ge,"balance",0)),I.events.push(X)}if(M.animations)for(var we in M.animations){var Te=M.animations[we];this.readAnimation(Te,we,I)}return I},P.prototype.readAttachment=function(E,D,I,M,N){var k=this.scale;switch(M=this.getValue(E,"name",M),this.getValue(E,"type","region")){case"region":var F=this.getValue(E,"path",M),G=this.attachmentLoader.newRegionAttachment(D,M,F);return G==null?null:(G.path=F,G.x=this.getValue(E,"x",0)*k,G.y=this.getValue(E,"y",0)*k,G.scaleX=this.getValue(E,"scaleX",1),G.scaleY=this.getValue(E,"scaleY",1),G.rotation=this.getValue(E,"rotation",0),G.width=E.width*k,G.height=E.height*k,(Q=this.getValue(E,"color",null))!=null&&G.color.setFromString(Q),G.updateOffset(),G);case"boundingbox":var V=this.attachmentLoader.newBoundingBoxAttachment(D,M);return V==null?null:(this.readVertices(E,V,E.vertexCount<<1),(Q=this.getValue(E,"color",null))!=null&&V.color.setFromString(Q),V);case"mesh":case"linkedmesh":F=this.getValue(E,"path",M);var j=this.attachmentLoader.newMeshAttachment(D,M,F);if(j==null)return null;j.path=F,(Q=this.getValue(E,"color",null))!=null&&j.color.setFromString(Q),j.width=this.getValue(E,"width",0)*k,j.height=this.getValue(E,"height",0)*k;var H=this.getValue(E,"parent",null);if(H!=null)return this.linkedMeshes.push(new R(j,this.getValue(E,"skin",null),I,H,this.getValue(E,"deform",!0))),j;var U=E.uvs;return this.readVertices(E,j,U.length),j.triangles=E.triangles,j.regionUVs=U,j.updateUVs(),j.edges=this.getValue(E,"edges",null),j.hullLength=2*this.getValue(E,"hull",0),j;case"path":if((F=this.attachmentLoader.newPathAttachment(D,M))==null)return null;F.closed=this.getValue(E,"closed",!1),F.constantSpeed=this.getValue(E,"constantSpeed",!0);var X=E.vertexCount;this.readVertices(E,F,X<<1);for(var Y=A.Utils.newArray(X/3,0),z=0;z<E.lengths.length;z++)Y[z]=E.lengths[z]*k;return F.lengths=Y,(Q=this.getValue(E,"color",null))!=null&&F.color.setFromString(Q),F;case"point":var W=this.attachmentLoader.newPointAttachment(D,M);return W==null?null:(W.x=this.getValue(E,"x",0)*k,W.y=this.getValue(E,"y",0)*k,W.rotation=this.getValue(E,"rotation",0),(Q=this.getValue(E,"color",null))!=null&&W.color.setFromString(Q),W);case"clipping":var Z=this.attachmentLoader.newClippingAttachment(D,M);if(Z==null)return null;var Q,ee=this.getValue(E,"end",null);if(ee!=null){var te=N.findSlot(ee);if(te==null)throw new Error("Clipping end slot not found: "+ee);Z.endSlot=te}return X=E.vertexCount,this.readVertices(E,Z,X<<1),(Q=this.getValue(E,"color",null))!=null&&Z.color.setFromString(Q),Z}return null},P.prototype.readVertices=function(E,D,I){var M=this.scale;D.worldVerticesLength=I;var N=E.vertices;if(I!=N.length){var k=new Array,F=new Array;for(H=0,U=N.length;H<U;){var G=N[H++];F.push(G);for(var V=H+4*G;H<V;H+=4)F.push(N[H]),k.push(N[H+1]*M),k.push(N[H+2]*M),k.push(N[H+3])}D.bones=F,D.vertices=A.Utils.toFloatArray(k)}else{var j=A.Utils.toFloatArray(N);if(M!=1)for(var H=0,U=N.length;H<U;H++)j[H]*=M;D.vertices=j}},P.prototype.readAnimation=function(E,D,I){var M=this.scale,N=new Array,k=0;if(E.slots)for(var F in E.slots){var G=E.slots[F];if((Fe=I.findSlotIndex(F))==-1)throw new Error("Slot not found: "+F);for(var V in G){var j=G[V];if(V=="attachment"){(te=new A.AttachmentTimeline(j.length)).slotIndex=Fe;for(var H=0,U=0;U<j.length;U++){var X=j[U];te.setFrame(H++,this.getValue(X,"time",0),X.name)}N.push(te),k=Math.max(k,te.frames[te.getFrameCount()-1])}else if(V=="color"){for((te=new A.ColorTimeline(j.length)).slotIndex=Fe,H=0,U=0;U<j.length;U++){X=j[U];var Y=new A.Color;Y.setFromString(X.color),te.setFrame(H,this.getValue(X,"time",0),Y.r,Y.g,Y.b,Y.a),this.readCurve(X,te,H),H++}N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.ColorTimeline.ENTRIES])}else{if(V!="twoColor")throw new Error("Invalid timeline type for a slot: "+V+" ("+F+")");for((te=new A.TwoColorTimeline(j.length)).slotIndex=Fe,H=0,U=0;U<j.length;U++){X=j[U];var z=new A.Color,W=new A.Color;z.setFromString(X.light),W.setFromString(X.dark),te.setFrame(H,this.getValue(X,"time",0),z.r,z.g,z.b,z.a,W.r,W.g,W.b),this.readCurve(X,te,H),H++}N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.TwoColorTimeline.ENTRIES])}}}if(E.bones)for(var Z in E.bones){var Q=E.bones[Z],ee=I.findBoneIndex(Z);if(ee==-1)throw new Error("Bone not found: "+Z);for(var V in Q)if(j=Q[V],V==="rotate"){for((te=new A.RotateTimeline(j.length)).boneIndex=ee,H=0,U=0;U<j.length;U++)X=j[U],te.setFrame(H,this.getValue(X,"time",0),this.getValue(X,"angle",0)),this.readCurve(X,te,H),H++;N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.RotateTimeline.ENTRIES])}else{if(V!=="translate"&&V!=="scale"&&V!=="shear")throw new Error("Invalid timeline type for a bone: "+V+" ("+Z+")");var te=null,re=1,ie=0;for(V==="scale"?(te=new A.ScaleTimeline(j.length),ie=1):V==="shear"?te=new A.ShearTimeline(j.length):(te=new A.TranslateTimeline(j.length),re=M),te.boneIndex=ee,H=0,U=0;U<j.length;U++){X=j[U];var ne=this.getValue(X,"x",ie),he=this.getValue(X,"y",ie);te.setFrame(H,this.getValue(X,"time",0),ne*re,he*re),this.readCurve(X,te,H),H++}N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.TranslateTimeline.ENTRIES])}}if(E.ik)for(var pe in E.ik){var K=E.ik[pe],ue=I.findIkConstraint(pe);for((te=new A.IkConstraintTimeline(K.length)).ikConstraintIndex=I.ikConstraints.indexOf(ue),H=0,U=0;U<K.length;U++)X=K[U],te.setFrame(H,this.getValue(X,"time",0),this.getValue(X,"mix",1),this.getValue(X,"softness",0)*M,this.getValue(X,"bendPositive",!0)?1:-1,this.getValue(X,"compress",!1),this.getValue(X,"stretch",!1)),this.readCurve(X,te,H),H++;N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.IkConstraintTimeline.ENTRIES])}if(E.transform)for(var pe in E.transform){for(K=E.transform[pe],ue=I.findTransformConstraint(pe),(te=new A.TransformConstraintTimeline(K.length)).transformConstraintIndex=I.transformConstraints.indexOf(ue),H=0,U=0;U<K.length;U++)X=K[U],te.setFrame(H,this.getValue(X,"time",0),this.getValue(X,"rotateMix",1),this.getValue(X,"translateMix",1),this.getValue(X,"scaleMix",1),this.getValue(X,"shearMix",1)),this.readCurve(X,te,H),H++;N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.TransformConstraintTimeline.ENTRIES])}var le=E.path||E.paths;if(le)for(var pe in le){K=le[pe];var ce=I.findPathConstraintIndex(pe);if(ce==-1)throw new Error("Path constraint not found: "+pe);var _e=I.pathConstraints[ce];for(var V in K)if(j=K[V],V==="position"||V==="spacing"){for(te=null,re=1,V==="spacing"?(te=new A.PathConstraintSpacingTimeline(j.length),_e.spacingMode!=A.SpacingMode.Length&&_e.spacingMode!=A.SpacingMode.Fixed||(re=M)):(te=new A.PathConstraintPositionTimeline(j.length),_e.positionMode==A.PositionMode.Fixed&&(re=M)),te.pathConstraintIndex=ce,H=0,U=0;U<j.length;U++)X=j[U],te.setFrame(H,this.getValue(X,"time",0),this.getValue(X,V,0)*re),this.readCurve(X,te,H),H++;N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.PathConstraintPositionTimeline.ENTRIES])}else if(V==="mix"){for((te=new A.PathConstraintMixTimeline(j.length)).pathConstraintIndex=ce,H=0,U=0;U<j.length;U++)X=j[U],te.setFrame(H,this.getValue(X,"time",0),this.getValue(X,"rotateMix",1),this.getValue(X,"translateMix",1)),this.readCurve(X,te,H),H++;N.push(te),k=Math.max(k,te.frames[(te.getFrameCount()-1)*A.PathConstraintMixTimeline.ENTRIES])}}if(E.deform)for(var oe in E.deform){var de=E.deform[oe],me=I.findSkin(oe);if(me==null)throw new Error("Skin not found: "+oe);for(var F in de){if(G=de[F],(Fe=I.findSlotIndex(F))==-1)throw new Error("Slot not found: "+G.name);for(var V in G){j=G[V];var ye=me.getAttachment(Fe,V);if(ye!=null){var ge=ye.bones!=null,we=ye.vertices,Te=ge?we.length/3*2:we.length;(te=new A.DeformTimeline(j.length)).slotIndex=Fe,te.attachment=ye,H=0;for(var Ee=0;Ee<j.length;Ee++){X=j[Ee];var De=void 0,fe=this.getValue(X,"vertices",null);if(fe==null)De=ge?A.Utils.newFloatArray(Te):we;else{De=A.Utils.newFloatArray(Te);var Ce=this.getValue(X,"offset",0);if(A.Utils.arrayCopy(fe,0,De,Ce,fe.length),M!=1)for(var Se=(U=Ce)+fe.length;U<Se;U++)De[U]*=M;if(!ge)for(U=0;U<Te;U++)De[U]+=we[U]}te.setFrame(H,this.getValue(X,"time",0),De),this.readCurve(X,te,H),H++}N.push(te),k=Math.max(k,te.frames[te.getFrameCount()-1])}}}}var be=E.drawOrder;if(be==null&&(be=E.draworder),be!=null){te=new A.DrawOrderTimeline(be.length);var Re=I.slots.length;for(H=0,Ee=0;Ee<be.length;Ee++){var Ve=be[Ee],Pe=null,ke=this.getValue(Ve,"offsets",null);if(ke!=null){Pe=A.Utils.newArray(Re,-1);var Ne=A.Utils.newArray(Re-ke.length,0),Ae=0,Oe=0;for(U=0;U<ke.length;U++){var Fe,nt=ke[U];if((Fe=I.findSlotIndex(nt.slot))==-1)throw new Error("Slot not found: "+nt.slot);for(;Ae!=Fe;)Ne[Oe++]=Ae++;Pe[Ae+nt.offset]=Ae++}for(;Ae<Re;)Ne[Oe++]=Ae++;for(U=Re-1;U>=0;U--)Pe[U]==-1&&(Pe[U]=Ne[--Oe])}te.setFrame(H++,this.getValue(Ve,"time",0),Pe)}N.push(te),k=Math.max(k,te.frames[te.getFrameCount()-1])}if(E.events){for(te=new A.EventTimeline(E.events.length),H=0,U=0;U<E.events.length;U++){var Ze=E.events[U],Xe=I.findEvent(Ze.name);if(Xe==null)throw new Error("Event not found: "+Ze.name);var $e=new A.Event(A.Utils.toSinglePrecision(this.getValue(Ze,"time",0)),Xe);$e.intValue=this.getValue(Ze,"int",Xe.intValue),$e.floatValue=this.getValue(Ze,"float",Xe.floatValue),$e.stringValue=this.getValue(Ze,"string",Xe.stringValue),$e.data.audioPath!=null&&($e.volume=this.getValue(Ze,"volume",1),$e.balance=this.getValue(Ze,"balance",0)),te.setFrame(H++,$e)}N.push(te),k=Math.max(k,te.frames[te.getFrameCount()-1])}if(isNaN(k))throw new Error("Error while parsing animation, duration is NaN");I.animations.push(new A.Animation(D,N,k))},P.prototype.readCurve=function(E,D,I){var M=E.curve;M&&(M=="stepped"?D.setStepped(I):Object.prototype.toString.call(M)==="[object Array]"?D.setCurve(I,M[0],M[1],M[2],M[3]):D.setCurve(I,M,this.getValue(E,"c2",0),this.getValue(E,"c3",1),this.getValue(E,"c4",1)))},P.prototype.getValue=function(E,D,I){return E[D]!==void 0?E[D]:I},P.blendModeFromString=function(E){if((E=E.toLowerCase())=="normal")return A.BlendMode.Normal;if(E=="additive")return A.BlendMode.Additive;if(E=="multiply")return A.BlendMode.Multiply;if(E=="screen")return A.BlendMode.Screen;throw new Error("Unknown blend mode: "+E)},P.positionModeFromString=function(E){if((E=E.toLowerCase())=="fixed")return A.PositionMode.Fixed;if(E=="percent")return A.PositionMode.Percent;throw new Error("Unknown position mode: "+E)},P.spacingModeFromString=function(E){if((E=E.toLowerCase())=="length")return A.SpacingMode.Length;if(E=="fixed")return A.SpacingMode.Fixed;if(E=="percent")return A.SpacingMode.Percent;throw new Error("Unknown position mode: "+E)},P.rotateModeFromString=function(E){if((E=E.toLowerCase())=="tangent")return A.RotateMode.Tangent;if(E=="chain")return A.RotateMode.Chain;if(E=="chainscale")return A.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+E)},P.transformModeFromString=function(E){if((E=E.toLowerCase())=="normal")return A.TransformMode.Normal;if(E=="onlytranslation")return A.TransformMode.OnlyTranslation;if(E=="norotationorreflection")return A.TransformMode.NoRotationOrReflection;if(E=="noscale")return A.TransformMode.NoScale;if(E=="noscaleorreflection")return A.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+E)},P}();A.SkeletonJson=O;var R=function(P,E,D,I,M){this.mesh=P,this.skin=E,this.slotIndex=D,this.parent=I,this.inheritDeform=M}}(w||(w={})),function(A){var O=function(P,E,D){this.slotIndex=P,this.name=E,this.attachment=D};A.SkinEntry=O;var R=function(){function P(E){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,E==null)throw new Error("name cannot be null.");this.name=E}return P.prototype.setAttachment=function(E,D,I){if(I==null)throw new Error("attachment cannot be null.");var M=this.attachments;E>=M.length&&(M.length=E+1),M[E]||(M[E]={}),M[E][D]=I},P.prototype.addSkin=function(E){for(var D=0;D<E.bones.length;D++){for(var I=E.bones[D],M=!1,N=0;N<this.bones.length;N++)if(this.bones[N]==I){M=!0;break}M||this.bones.push(I)}for(D=0;D<E.constraints.length;D++){var k=E.constraints[D];for(M=!1,N=0;N<this.constraints.length;N++)if(this.constraints[N]==k){M=!0;break}M||this.constraints.push(k)}var F=E.getAttachments();for(D=0;D<F.length;D++){var G=F[D];this.setAttachment(G.slotIndex,G.name,G.attachment)}},P.prototype.copySkin=function(E){for(var D=0;D<E.bones.length;D++){for(var I=E.bones[D],M=!1,N=0;N<this.bones.length;N++)if(this.bones[N]==I){M=!0;break}M||this.bones.push(I)}for(D=0;D<E.constraints.length;D++){var k=E.constraints[D];for(M=!1,N=0;N<this.constraints.length;N++)if(this.constraints[N]==k){M=!0;break}M||this.constraints.push(k)}var F=E.getAttachments();for(D=0;D<F.length;D++){var G=F[D];G.attachment!=null&&(G.attachment instanceof A.MeshAttachment?(G.attachment=G.attachment.newLinkedMesh(),this.setAttachment(G.slotIndex,G.name,G.attachment)):(G.attachment=G.attachment.copy(),this.setAttachment(G.slotIndex,G.name,G.attachment)))}},P.prototype.getAttachment=function(E,D){var I=this.attachments[E];return I?I[D]:null},P.prototype.removeAttachment=function(E,D){var I=this.attachments[E];I&&(I[D]=null)},P.prototype.getAttachments=function(){for(var E=new Array,D=0;D<this.attachments.length;D++){var I=this.attachments[D];if(I)for(var M in I){var N=I[M];N&&E.push(new O(D,M,N))}}return E},P.prototype.getAttachmentsForSlot=function(E,D){var I=this.attachments[E];if(I)for(var M in I){var N=I[M];N&&D.push(new O(E,M,N))}},P.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},P.prototype.attachAll=function(E,D){for(var I=0,M=0;M<E.slots.length;M++){var N=E.slots[M],k=N.getAttachment();if(k&&I<D.attachments.length){var F=D.attachments[I];for(var G in F)if(k==F[G]){var V=this.getAttachment(I,G);V!=null&&N.setAttachment(V);break}}I++}},P}();A.Skin=R}(w||(w={})),function(A){var O=function(){function R(P,E){if(this.deform=new Array,P==null)throw new Error("data cannot be null.");if(E==null)throw new Error("bone cannot be null.");this.data=P,this.bone=E,this.color=new A.Color,this.darkColor=P.darkColor==null?null:new A.Color,this.setToSetupPose()}return R.prototype.getSkeleton=function(){return this.bone.skeleton},R.prototype.getAttachment=function(){return this.attachment},R.prototype.setAttachment=function(P){this.attachment!=P&&(this.attachment=P,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)},R.prototype.setAttachmentTime=function(P){this.attachmentTime=this.bone.skeleton.time-P},R.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},R.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},R}();A.Slot=O}(w||(w={})),function(A){A.SlotData=function(O,R,P){if(this.color=new A.Color(1,1,1,1),O<0)throw new Error("index must be >= 0.");if(R==null)throw new Error("name cannot be null.");if(P==null)throw new Error("boneData cannot be null.");this.index=O,this.name=R,this.boneData=P}}(w||(w={})),function(A){var O,R,P=function(){function D(I){this._image=I}return D.prototype.getImage=function(){return this._image},D.filterFromString=function(I){switch(I.toLowerCase()){case"nearest":return O.Nearest;case"linear":return O.Linear;case"mipmap":return O.MipMap;case"mipmapnearestnearest":return O.MipMapNearestNearest;case"mipmaplinearnearest":return O.MipMapLinearNearest;case"mipmapnearestlinear":return O.MipMapNearestLinear;case"mipmaplinearlinear":return O.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+I)}},D.wrapFromString=function(I){switch(I.toLowerCase()){case"mirroredtepeat":return R.MirroredRepeat;case"clamptoedge":return R.ClampToEdge;case"repeat":return R.Repeat;default:throw new Error("Unknown texture wrap "+I)}},D}();A.Texture=P,function(D){D[D.Nearest=9728]="Nearest",D[D.Linear=9729]="Linear",D[D.MipMap=9987]="MipMap",D[D.MipMapNearestNearest=9984]="MipMapNearestNearest",D[D.MipMapLinearNearest=9985]="MipMapLinearNearest",D[D.MipMapNearestLinear=9986]="MipMapNearestLinear",D[D.MipMapLinearLinear=9987]="MipMapLinearLinear"}(O=A.TextureFilter||(A.TextureFilter={})),function(D){D[D.MirroredRepeat=33648]="MirroredRepeat",D[D.ClampToEdge=33071]="ClampToEdge",D[D.Repeat=10497]="Repeat"}(R=A.TextureWrap||(A.TextureWrap={})),A.TextureRegion=function(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0};var E=function(D){function I(){return D!==null&&D.apply(this,arguments)||this}return B(I,D),I.prototype.setFilters=function(){},I.prototype.setWraps=function(){},I.prototype.dispose=function(){},I}(P);A.FakeTexture=E}(w||(w={})),function(A){var O=function(){function D(I,M){this.pages=new Array,this.regions=new Array,this.load(I,M)}return D.prototype.load=function(I,M){if(M==null)throw new Error("textureLoader cannot be null.");for(var N=new R(I),k=new Array(4),F=null;;){var G=N.readLine();if(G==null)break;if((G=G.trim()).length==0)F=null;else if(F){var V=new E;V.name=G,V.page=F;var j=N.readValue();j.toLocaleLowerCase()=="true"?V.degrees=90:j.toLocaleLowerCase()=="false"?V.degrees=0:V.degrees=parseFloat(j),V.rotate=V.degrees==90,N.readTuple(k);var H=parseInt(k[0]),U=parseInt(k[1]);N.readTuple(k);var X=parseInt(k[0]),Y=parseInt(k[1]);V.u=H/F.width,V.v=U/F.height,V.rotate?(V.u2=(H+Y)/F.width,V.v2=(U+X)/F.height):(V.u2=(H+X)/F.width,V.v2=(U+Y)/F.height),V.x=H,V.y=U,V.width=Math.abs(X),V.height=Math.abs(Y),N.readTuple(k)==4&&N.readTuple(k)==4&&N.readTuple(k),V.originalWidth=parseInt(k[0]),V.originalHeight=parseInt(k[1]),N.readTuple(k),V.offsetX=parseInt(k[0]),V.offsetY=parseInt(k[1]),V.index=parseInt(N.readValue()),V.texture=F.texture,this.regions.push(V)}else{(F=new P).name=G,N.readTuple(k)==2&&(F.width=parseInt(k[0]),F.height=parseInt(k[1]),N.readTuple(k)),N.readTuple(k),F.minFilter=A.Texture.filterFromString(k[0]),F.magFilter=A.Texture.filterFromString(k[1]);var z=N.readValue();F.uWrap=A.TextureWrap.ClampToEdge,F.vWrap=A.TextureWrap.ClampToEdge,z=="x"?F.uWrap=A.TextureWrap.Repeat:z=="y"?F.vWrap=A.TextureWrap.Repeat:z=="xy"&&(F.uWrap=F.vWrap=A.TextureWrap.Repeat),F.texture=M(G),F.texture.setFilters(F.minFilter,F.magFilter),F.texture.setWraps(F.uWrap,F.vWrap),F.width=F.texture.getImage().width,F.height=F.texture.getImage().height,this.pages.push(F)}}},D.prototype.findRegion=function(I){for(var M=0;M<this.regions.length;M++)if(this.regions[M].name==I)return this.regions[M];return null},D.prototype.dispose=function(){for(var I=0;I<this.pages.length;I++)this.pages[I].texture.dispose()},D}();A.TextureAtlas=O;var R=function(){function D(I){this.index=0,this.lines=I.split(/\r\n|\r|\n/)}return D.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},D.prototype.readValue=function(){var I=this.readLine(),M=I.indexOf(":");if(M==-1)throw new Error("Invalid line: "+I);return I.substring(M+1).trim()},D.prototype.readTuple=function(I){var M=this.readLine(),N=M.indexOf(":");if(N==-1)throw new Error("Invalid line: "+M);for(var k=0,F=N+1;k<3;k++){var G=M.indexOf(",",F);if(G==-1)break;I[k]=M.substr(F,G-F).trim(),F=G+1}return I[k]=M.substring(F).trim(),k+1},D}(),P=function(){};A.TextureAtlasPage=P;var E=function(D){function I(){return D!==null&&D.apply(this,arguments)||this}return B(I,D),I}(A.TextureRegion);A.TextureAtlasRegion=E}(w||(w={})),function(A){var O=function(){function R(P,E){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new A.Vector2,this.active=!1,P==null)throw new Error("data cannot be null.");if(E==null)throw new Error("skeleton cannot be null.");this.data=P,this.rotateMix=P.rotateMix,this.translateMix=P.translateMix,this.scaleMix=P.scaleMix,this.shearMix=P.shearMix,this.bones=new Array;for(var D=0;D<P.bones.length;D++)this.bones.push(E.findBone(P.bones[D].name));this.target=E.findBone(P.target.name)}return R.prototype.isActive=function(){return this.active},R.prototype.apply=function(){this.update()},R.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},R.prototype.applyAbsoluteWorld=function(){for(var P=this.rotateMix,E=this.translateMix,D=this.scaleMix,I=this.shearMix,M=this.target,N=M.a,k=M.b,F=M.c,G=M.d,V=N*G-k*F>0?A.MathUtils.degRad:-A.MathUtils.degRad,j=this.data.offsetRotation*V,H=this.data.offsetShearY*V,U=this.bones,X=0,Y=U.length;X<Y;X++){var z=U[X],W=!1;if(P!=0){var Z=z.a,Q=z.b,ee=z.c,te=z.d;(K=Math.atan2(F,N)-Math.atan2(ee,Z)+j)>A.MathUtils.PI?K-=A.MathUtils.PI2:K<-A.MathUtils.PI&&(K+=A.MathUtils.PI2),K*=P;var re=Math.cos(K),ie=Math.sin(K);z.a=re*Z-ie*ee,z.b=re*Q-ie*te,z.c=ie*Z+re*ee,z.d=ie*Q+re*te,W=!0}if(E!=0){var ne=this.temp;M.localToWorld(ne.set(this.data.offsetX,this.data.offsetY)),z.worldX+=(ne.x-z.worldX)*E,z.worldY+=(ne.y-z.worldY)*E,W=!0}if(D>0){var he=Math.sqrt(z.a*z.a+z.c*z.c),pe=Math.sqrt(N*N+F*F);he>1e-5&&(he=(he+(pe-he+this.data.offsetScaleX)*D)/he),z.a*=he,z.c*=he,he=Math.sqrt(z.b*z.b+z.d*z.d),pe=Math.sqrt(k*k+G*G),he>1e-5&&(he=(he+(pe-he+this.data.offsetScaleY)*D)/he),z.b*=he,z.d*=he,W=!0}if(I>0){Q=z.b,te=z.d;var K,ue=Math.atan2(te,Q);(K=Math.atan2(G,k)-Math.atan2(F,N)-(ue-Math.atan2(z.c,z.a)))>A.MathUtils.PI?K-=A.MathUtils.PI2:K<-A.MathUtils.PI&&(K+=A.MathUtils.PI2),K=ue+(K+H)*I,he=Math.sqrt(Q*Q+te*te),z.b=Math.cos(K)*he,z.d=Math.sin(K)*he,W=!0}W&&(z.appliedValid=!1)}},R.prototype.applyRelativeWorld=function(){for(var P=this.rotateMix,E=this.translateMix,D=this.scaleMix,I=this.shearMix,M=this.target,N=M.a,k=M.b,F=M.c,G=M.d,V=N*G-k*F>0?A.MathUtils.degRad:-A.MathUtils.degRad,j=this.data.offsetRotation*V,H=this.data.offsetShearY*V,U=this.bones,X=0,Y=U.length;X<Y;X++){var z,W=U[X],Z=!1;if(P!=0){var Q=W.a,ee=W.b,te=W.c,re=W.d;(z=Math.atan2(F,N)+j)>A.MathUtils.PI?z-=A.MathUtils.PI2:z<-A.MathUtils.PI&&(z+=A.MathUtils.PI2),z*=P;var ie=Math.cos(z),ne=Math.sin(z);W.a=ie*Q-ne*te,W.b=ie*ee-ne*re,W.c=ne*Q+ie*te,W.d=ne*ee+ie*re,Z=!0}if(E!=0){var he=this.temp;M.localToWorld(he.set(this.data.offsetX,this.data.offsetY)),W.worldX+=he.x*E,W.worldY+=he.y*E,Z=!0}if(D>0){var pe=(Math.sqrt(N*N+F*F)-1+this.data.offsetScaleX)*D+1;W.a*=pe,W.c*=pe,pe=(Math.sqrt(k*k+G*G)-1+this.data.offsetScaleY)*D+1,W.b*=pe,W.d*=pe,Z=!0}I>0&&((z=Math.atan2(G,k)-Math.atan2(F,N))>A.MathUtils.PI?z-=A.MathUtils.PI2:z<-A.MathUtils.PI&&(z+=A.MathUtils.PI2),ee=W.b,re=W.d,z=Math.atan2(re,ee)+(z-A.MathUtils.PI/2+H)*I,pe=Math.sqrt(ee*ee+re*re),W.b=Math.cos(z)*pe,W.d=Math.sin(z)*pe,Z=!0),Z&&(W.appliedValid=!1)}},R.prototype.applyAbsoluteLocal=function(){var P=this.rotateMix,E=this.translateMix,D=this.scaleMix,I=this.shearMix,M=this.target;M.appliedValid||M.updateAppliedTransform();for(var N=this.bones,k=0,F=N.length;k<F;k++){var G=N[k];G.appliedValid||G.updateAppliedTransform();var V=G.arotation;if(P!=0){var j=M.arotation-V+this.data.offsetRotation;V+=(j-=360*(16384-(16384.499999999996-j/360|0)))*P}var H=G.ax,U=G.ay;E!=0&&(H+=(M.ax-H+this.data.offsetX)*E,U+=(M.ay-U+this.data.offsetY)*E);var X=G.ascaleX,Y=G.ascaleY;D!=0&&(X>1e-5&&(X=(X+(M.ascaleX-X+this.data.offsetScaleX)*D)/X),Y>1e-5&&(Y=(Y+(M.ascaleY-Y+this.data.offsetScaleY)*D)/Y));var z=G.ashearY;I!=0&&(j=M.ashearY-z+this.data.offsetShearY,j-=360*(16384-(16384.499999999996-j/360|0)),G.shearY+=j*I),G.updateWorldTransformWith(H,U,V,X,Y,G.ashearX,z)}},R.prototype.applyRelativeLocal=function(){var P=this.rotateMix,E=this.translateMix,D=this.scaleMix,I=this.shearMix,M=this.target;M.appliedValid||M.updateAppliedTransform();for(var N=this.bones,k=0,F=N.length;k<F;k++){var G=N[k];G.appliedValid||G.updateAppliedTransform();var V=G.arotation;P!=0&&(V+=(M.arotation+this.data.offsetRotation)*P);var j=G.ax,H=G.ay;E!=0&&(j+=(M.ax+this.data.offsetX)*E,H+=(M.ay+this.data.offsetY)*E);var U=G.ascaleX,X=G.ascaleY;D!=0&&(U>1e-5&&(U*=(M.ascaleX-1+this.data.offsetScaleX)*D+1),X>1e-5&&(X*=(M.ascaleY-1+this.data.offsetScaleY)*D+1));var Y=G.ashearY;I!=0&&(Y+=(M.ashearY+this.data.offsetShearY)*I),G.updateWorldTransformWith(j,H,V,U,X,G.ashearX,Y)}},R}();A.TransformConstraint=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E,0,!1)||this;return D.bones=new Array,D.rotateMix=0,D.translateMix=0,D.scaleMix=0,D.shearMix=0,D.offsetRotation=0,D.offsetX=0,D.offsetY=0,D.offsetScaleX=0,D.offsetScaleY=0,D.offsetShearY=0,D.relative=!1,D.local=!1,D}return B(P,R),P}(A.ConstraintData);A.TransformConstraintData=O}(w||(w={})),function(A){var O=function(){function R(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new A.Pool(function(){return new Array}),this.polygonIndicesPool=new A.Pool(function(){return new Array})}return R.prototype.triangulate=function(P){var E=P,D=P.length>>1,I=this.indicesArray;I.length=0;for(var M=0;M<D;M++)I[M]=M;var N=this.isConcaveArray;N.length=0,M=0;for(var k=D;M<k;++M)N[M]=R.isConcave(M,D,E,I);var F=this.triangles;for(F.length=0;D>3;){for(var G=D-1,V=(M=0,1);;){e:if(!N[M]){for(var j=I[G]<<1,H=I[M]<<1,U=I[V]<<1,X=E[j],Y=E[j+1],z=E[H],W=E[H+1],Z=E[U],Q=E[U+1],ee=(V+1)%D;ee!=G;ee=(ee+1)%D)if(N[ee]){var te=I[ee]<<1,re=E[te],ie=E[te+1];if(R.positiveArea(Z,Q,X,Y,re,ie)&&R.positiveArea(X,Y,z,W,re,ie)&&R.positiveArea(z,W,Z,Q,re,ie))break e}break}if(V==0){do{if(!N[M])break;M--}while(M>0);break}G=M,M=V,V=(V+1)%D}F.push(I[(D+M-1)%D]),F.push(I[M]),F.push(I[(M+1)%D]),I.splice(M,1),N.splice(M,1);var ne=(--D+M-1)%D,he=M==D?0:M;N[ne]=R.isConcave(ne,D,E,I),N[he]=R.isConcave(he,D,E,I)}return D==3&&(F.push(I[2]),F.push(I[0]),F.push(I[1])),F},R.prototype.decompose=function(P,E){var D=P,I=this.convexPolygons;this.polygonPool.freeAll(I),I.length=0;var M=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(M),M.length=0;var N=this.polygonIndicesPool.obtain();N.length=0;var k=this.polygonPool.obtain();k.length=0;for(var F=-1,G=0,V=0,j=E.length;V<j;V+=3){var H=E[V]<<1,U=E[V+1]<<1,X=E[V+2]<<1,Y=D[H],z=D[H+1],W=D[U],Z=D[U+1],Q=D[X],ee=D[X+1],te=!1;if(F==H){var re=k.length-4,ie=R.winding(k[re],k[re+1],k[re+2],k[re+3],Q,ee),ne=R.winding(Q,ee,k[0],k[1],k[2],k[3]);ie==G&&ne==G&&(k.push(Q),k.push(ee),N.push(X),te=!0)}te||(k.length>0?(I.push(k),M.push(N)):(this.polygonPool.free(k),this.polygonIndicesPool.free(N)),(k=this.polygonPool.obtain()).length=0,k.push(Y),k.push(z),k.push(W),k.push(Z),k.push(Q),k.push(ee),(N=this.polygonIndicesPool.obtain()).length=0,N.push(H),N.push(U),N.push(X),G=R.winding(Y,z,W,Z,Q,ee),F=H)}for(k.length>0&&(I.push(k),M.push(N)),V=0,j=I.length;V<j;V++)if((N=M[V]).length!=0){for(var he=N[0],pe=N[N.length-1],K=(k=I[V])[re=k.length-4],ue=k[re+1],le=k[re+2],ce=k[re+3],_e=k[0],oe=k[1],de=k[2],me=k[3],ye=R.winding(K,ue,le,ce,_e,oe),ge=0;ge<j;ge++)if(ge!=V){var we=M[ge];if(we.length==3){var Te=we[0],Ee=we[1],De=we[2],fe=I[ge];Q=fe[fe.length-2],ee=fe[fe.length-1],Te==he&&Ee==pe&&(ie=R.winding(K,ue,le,ce,Q,ee),ne=R.winding(Q,ee,_e,oe,de,me),ie==ye&&ne==ye&&(fe.length=0,we.length=0,k.push(Q),k.push(ee),N.push(De),K=le,ue=ce,le=Q,ce=ee,ge=0))}}}for(V=I.length-1;V>=0;V--)(k=I[V]).length==0&&(I.splice(V,1),this.polygonPool.free(k),N=M[V],M.splice(V,1),this.polygonIndicesPool.free(N));return I},R.isConcave=function(P,E,D,I){var M=I[(E+P-1)%E]<<1,N=I[P]<<1,k=I[(P+1)%E]<<1;return!this.positiveArea(D[M],D[M+1],D[N],D[N+1],D[k],D[k+1])},R.positiveArea=function(P,E,D,I,M,N){return P*(N-I)+D*(E-N)+M*(I-E)>=0},R.winding=function(P,E,D,I,M,N){var k=D-P,F=I-E;return M*F-N*k+k*E-P*F>=0?1:-1},R}();A.Triangulator=O}(w||(w={})),function(A){var O=function(){function j(){this.array=new Array}return j.prototype.add=function(H){var U=this.contains(H);return this.array[0|H]=0|H,!U},j.prototype.contains=function(H){return this.array[0|H]!=null},j.prototype.remove=function(H){this.array[0|H]=void 0},j.prototype.clear=function(){this.array.length=0},j}();A.IntSet=O;var R=function(){function j(H,U,X,Y){H===void 0&&(H=0),U===void 0&&(U=0),X===void 0&&(X=0),Y===void 0&&(Y=0),this.r=H,this.g=U,this.b=X,this.a=Y}return j.prototype.set=function(H,U,X,Y){return this.r=H,this.g=U,this.b=X,this.a=Y,this.clamp(),this},j.prototype.setFromColor=function(H){return this.r=H.r,this.g=H.g,this.b=H.b,this.a=H.a,this},j.prototype.setFromString=function(H){return H=H.charAt(0)=="#"?H.substr(1):H,this.r=parseInt(H.substr(0,2),16)/255,this.g=parseInt(H.substr(2,2),16)/255,this.b=parseInt(H.substr(4,2),16)/255,this.a=(H.length!=8?255:parseInt(H.substr(6,2),16))/255,this},j.prototype.add=function(H,U,X,Y){return this.r+=H,this.g+=U,this.b+=X,this.a+=Y,this.clamp(),this},j.prototype.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},j.rgba8888ToColor=function(H,U){H.r=((4278190080&U)>>>24)/255,H.g=((16711680&U)>>>16)/255,H.b=((65280&U)>>>8)/255,H.a=(255&U)/255},j.rgb888ToColor=function(H,U){H.r=((16711680&U)>>>16)/255,H.g=((65280&U)>>>8)/255,H.b=(255&U)/255},j.WHITE=new j(1,1,1,1),j.RED=new j(1,0,0,1),j.GREEN=new j(0,1,0,1),j.BLUE=new j(0,0,1,1),j.MAGENTA=new j(1,0,1,1),j}();A.Color=R;var P=function(){function j(){}return j.clamp=function(H,U,X){return H<U?U:H>X?X:H},j.cosDeg=function(H){return Math.cos(H*j.degRad)},j.sinDeg=function(H){return Math.sin(H*j.degRad)},j.signum=function(H){return H>0?1:H<0?-1:0},j.toInt=function(H){return H>0?Math.floor(H):Math.ceil(H)},j.cbrt=function(H){var U=Math.pow(Math.abs(H),.3333333333333333);return H<0?-U:U},j.randomTriangular=function(H,U){return j.randomTriangularWith(H,U,.5*(H+U))},j.randomTriangularWith=function(H,U,X){var Y=Math.random(),z=U-H;return Y<=(X-H)/z?H+Math.sqrt(Y*z*(X-H)):U-Math.sqrt((1-Y)*z*(U-X))},j.PI=3.1415927,j.PI2=2*j.PI,j.radiansToDegrees=180/j.PI,j.radDeg=j.radiansToDegrees,j.degreesToRadians=j.PI/180,j.degRad=j.degreesToRadians,j}();A.MathUtils=P;var E=function(){function j(){}return j.prototype.apply=function(H,U,X){return H+(U-H)*this.applyInternal(X)},j}();A.Interpolation=E;var D=function(j){function H(U){var X=j.call(this)||this;return X.power=2,X.power=U,X}return B(H,j),H.prototype.applyInternal=function(U){return U<=.5?Math.pow(2*U,this.power)/2:Math.pow(2*(U-1),this.power)/(this.power%2==0?-2:2)+1},H}(E);A.Pow=D;var I=function(j){function H(U){return j.call(this,U)||this}return B(H,j),H.prototype.applyInternal=function(U){return Math.pow(U-1,this.power)*(this.power%2==0?-1:1)+1},H}(D);A.PowOut=I;var M=function(){function j(){}return j.arrayCopy=function(H,U,X,Y,z){for(var W=U,Z=Y;W<U+z;W++,Z++)X[Z]=H[W]},j.setArraySize=function(H,U,X){X===void 0&&(X=0);var Y=H.length;if(Y==U)return H;if(H.length=U,Y<U)for(var z=Y;z<U;z++)H[z]=X;return H},j.ensureArrayCapacity=function(H,U,X){return X===void 0&&(X=0),H.length>=U?H:j.setArraySize(H,U,X)},j.newArray=function(H,U){for(var X=new Array(H),Y=0;Y<H;Y++)X[Y]=U;return X},j.newFloatArray=function(H){if(j.SUPPORTS_TYPED_ARRAYS)return new Float32Array(H);for(var U=new Array(H),X=0;X<U.length;X++)U[X]=0;return U},j.newShortArray=function(H){if(j.SUPPORTS_TYPED_ARRAYS)return new Int16Array(H);for(var U=new Array(H),X=0;X<U.length;X++)U[X]=0;return U},j.toFloatArray=function(H){return j.SUPPORTS_TYPED_ARRAYS?new Float32Array(H):H},j.toSinglePrecision=function(H){return j.SUPPORTS_TYPED_ARRAYS?Math.fround(H):H},j.webkit602BugfixHelper=function(){},j.contains=function(H,U,X){for(var Y=0;Y<H.length;Y++)if(H[Y]==U)return!0;return!1},j.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u",j}();A.Utils=M;var N=function(){function j(){}return j.logBones=function(H){for(var U=0;U<H.bones.length;U++){var X=H.bones[U];console.log(X.data.name+", "+X.a+", "+X.b+", "+X.c+", "+X.d+", "+X.worldX+", "+X.worldY)}},j}();A.DebugUtils=N;var k=function(){function j(H){this.items=new Array,this.instantiator=H}return j.prototype.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},j.prototype.free=function(H){H.reset&&H.reset(),this.items.push(H)},j.prototype.freeAll=function(H){for(var U=0;U<H.length;U++)H[U].reset&&H[U].reset(),this.items[U]=H[U]},j.prototype.clear=function(){this.items.length=0},j}();A.Pool=k;var F=function(){function j(H,U){H===void 0&&(H=0),U===void 0&&(U=0),this.x=H,this.y=U}return j.prototype.set=function(H,U){return this.x=H,this.y=U,this},j.prototype.length=function(){var H=this.x,U=this.y;return Math.sqrt(H*H+U*U)},j.prototype.normalize=function(){var H=this.length();return H!=0&&(this.x/=H,this.y/=H),this},j}();A.Vector2=F;var G=function(){function j(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return j.prototype.update=function(){var H=Date.now()/1e3;this.delta=H-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=H,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},j}();A.TimeKeeper=G;var V=function(){function j(H){H===void 0&&(H=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(H)}return j.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},j.prototype.addValue=function(H){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=H,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},j.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var H=0,U=0;U<this.values.length;U++)H+=this.values[U];this.mean=H/this.values.length,this.dirty=!1}return this.mean}return 0},j}();A.WindowedMean=V}(w||(w={})),Math.fround||(Math.fround=(_=new Float32Array(1),function(A){return _[0]=A,_[0]})),function(A){var O=function(P){if(P==null)throw new Error("name cannot be null.");this.name=P};A.Attachment=O;var R=function(P){function E(D){var I=P.call(this,D)||this;return I.id=(65535&E.nextID++)<<11,I.worldVerticesLength=0,I.deformAttachment=I,I}return B(E,P),E.prototype.computeWorldVertices=function(D,I,M,N,k,F){M=k+(M>>1)*F;var G=D.bone.skeleton,V=D.deform,j=this.vertices,H=this.bones;if(H!=null){for(var U=0,X=0,Y=0;Y<I;Y+=2)U+=(Q=H[U])+1,X+=Q;var z=G.bones;if(V.length==0)for(_e=k,K=3*X;_e<M;_e+=F){var W=0,Z=0,Q=H[U++];for(Q+=U;U<Q;U++,K+=3){ie=z[H[U]],oe=j[K],de=j[K+1];var ee=j[K+2];W+=(oe*ie.a+de*ie.b+ie.worldX)*ee,Z+=(oe*ie.c+de*ie.d+ie.worldY)*ee}N[_e]=W,N[_e+1]=Z}else for(var te=V,re=(_e=k,K=3*X,X<<1);_e<M;_e+=F){for(W=0,Z=0,Q=H[U++],Q+=U;U<Q;U++,K+=3,re+=2)ie=z[H[U]],oe=j[K]+te[re],de=j[K+1]+te[re+1],ee=j[K+2],W+=(oe*ie.a+de*ie.b+ie.worldX)*ee,Z+=(oe*ie.c+de*ie.d+ie.worldY)*ee;N[_e]=W,N[_e+1]=Z}}else{V.length>0&&(j=V);for(var ie,ne=(ie=D.bone).worldX,he=ie.worldY,pe=ie.a,K=ie.b,ue=ie.c,le=ie.d,ce=I,_e=k;_e<M;ce+=2,_e+=F){var oe=j[ce],de=j[ce+1];N[_e]=oe*pe+de*K+ne,N[_e+1]=oe*ue+de*le+he}}},E.prototype.copyTo=function(D){this.bones!=null?(D.bones=new Array(this.bones.length),A.Utils.arrayCopy(this.bones,0,D.bones,0,this.bones.length)):D.bones=null,this.vertices!=null?(D.vertices=A.Utils.newFloatArray(this.vertices.length),A.Utils.arrayCopy(this.vertices,0,D.vertices,0,this.vertices.length)):D.vertices=null,D.worldVerticesLength=this.worldVerticesLength,D.deformAttachment=this.deformAttachment},E.nextID=0,E}(O);A.VertexAttachment=R}(w||(w={})),function(A){(function(O){O[O.Region=0]="Region",O[O.BoundingBox=1]="BoundingBox",O[O.Mesh=2]="Mesh",O[O.LinkedMesh=3]="LinkedMesh",O[O.Path=4]="Path",O[O.Point=5]="Point",O[O.Clipping=6]="Clipping"})(A.AttachmentType||(A.AttachmentType={}))}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E)||this;return D.color=new A.Color(1,1,1,1),D}return B(P,R),P.prototype.copy=function(){var E=new P(name);return this.copyTo(E),E.color.setFromColor(this.color),E},P}(A.VertexAttachment);A.BoundingBoxAttachment=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E)||this;return D.color=new A.Color(.2275,.2275,.8078,1),D}return B(P,R),P.prototype.copy=function(){var E=new P(name);return this.copyTo(E),E.endSlot=this.endSlot,E.color.setFromColor(this.color),E},P}(A.VertexAttachment);A.ClippingAttachment=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E)||this;return D.color=new A.Color(1,1,1,1),D.tempColor=new A.Color(0,0,0,0),D}return B(P,R),P.prototype.updateUVs=function(){var E=this.regionUVs;this.uvs!=null&&this.uvs.length==E.length||(this.uvs=A.Utils.newFloatArray(E.length));var D=this.uvs,I=this.uvs.length,M=this.region.u,N=this.region.v,k=0,F=0;if(this.region instanceof A.TextureAtlasRegion){var G=this.region,V=G.texture.getImage().width,j=G.texture.getImage().height;switch(G.degrees){case 90:M-=(G.originalHeight-G.offsetY-G.height)/V,N-=(G.originalWidth-G.offsetX-G.width)/j,k=G.originalHeight/V,F=G.originalWidth/j;for(var H=0;H<I;H+=2)D[H]=M+E[H+1]*k,D[H+1]=N+(1-E[H])*F;return;case 180:for(M-=(G.originalWidth-G.offsetX-G.width)/V,N-=G.offsetY/j,k=G.originalWidth/V,F=G.originalHeight/j,H=0;H<I;H+=2)D[H]=M+(1-E[H])*k,D[H+1]=N+(1-E[H+1])*F;return;case 270:for(M-=G.offsetY/V,N-=G.offsetX/j,k=G.originalHeight/V,F=G.originalWidth/j,H=0;H<I;H+=2)D[H]=M+(1-E[H+1])*k,D[H+1]=N+E[H]*F;return}M-=G.offsetX/V,N-=(G.originalHeight-G.offsetY-G.height)/j,k=G.originalWidth/V,F=G.originalHeight/j}else this.region==null?(M=N=0,k=F=1):(k=this.region.u2-M,F=this.region.v2-N);for(H=0;H<I;H+=2)D[H]=M+E[H]*k,D[H+1]=N+E[H+1]*F},P.prototype.getParentMesh=function(){return this.parentMesh},P.prototype.setParentMesh=function(E){this.parentMesh=E,E!=null&&(this.bones=E.bones,this.vertices=E.vertices,this.worldVerticesLength=E.worldVerticesLength,this.regionUVs=E.regionUVs,this.triangles=E.triangles,this.hullLength=E.hullLength,this.worldVerticesLength=E.worldVerticesLength)},P.prototype.copy=function(){if(this.parentMesh!=null)return this.newLinkedMesh();var E=new P(this.name);return E.region=this.region,E.path=this.path,E.color.setFromColor(this.color),this.copyTo(E),E.regionUVs=new Array(this.regionUVs.length),A.Utils.arrayCopy(this.regionUVs,0,E.regionUVs,0,this.regionUVs.length),E.uvs=new Array(this.uvs.length),A.Utils.arrayCopy(this.uvs,0,E.uvs,0,this.uvs.length),E.triangles=new Array(this.triangles.length),A.Utils.arrayCopy(this.triangles,0,E.triangles,0,this.triangles.length),E.hullLength=this.hullLength,this.edges!=null&&(E.edges=new Array(this.edges.length),A.Utils.arrayCopy(this.edges,0,E.edges,0,this.edges.length)),E.width=this.width,E.height=this.height,E},P.prototype.newLinkedMesh=function(){var E=new P(this.name);return E.region=this.region,E.path=this.path,E.color.setFromColor(this.color),E.deformAttachment=this.deformAttachment,E.setParentMesh(this.parentMesh!=null?this.parentMesh:this),E.updateUVs(),E},P}(A.VertexAttachment);A.MeshAttachment=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E)||this;return D.closed=!1,D.constantSpeed=!1,D.color=new A.Color(1,1,1,1),D}return B(P,R),P.prototype.copy=function(){var E=new P(name);return this.copyTo(E),E.lengths=new Array(this.lengths.length),A.Utils.arrayCopy(this.lengths,0,E.lengths,0,this.lengths.length),E.closed=closed,E.constantSpeed=this.constantSpeed,E.color.setFromColor(this.color),E},P}(A.VertexAttachment);A.PathAttachment=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E)||this;return D.color=new A.Color(.38,.94,0,1),D}return B(P,R),P.prototype.computeWorldPosition=function(E,D){return D.x=this.x*E.a+this.y*E.b+E.worldX,D.y=this.x*E.c+this.y*E.d+E.worldY,D},P.prototype.computeWorldRotation=function(E){var D=A.MathUtils.cosDeg(this.rotation),I=A.MathUtils.sinDeg(this.rotation),M=D*E.a+I*E.b,N=D*E.c+I*E.d;return Math.atan2(N,M)*A.MathUtils.radDeg},P.prototype.copy=function(){var E=new P(name);return E.x=this.x,E.y=this.y,E.rotation=this.rotation,E.color.setFromColor(this.color),E},P}(A.VertexAttachment);A.PointAttachment=O}(w||(w={})),function(A){var O=function(R){function P(E){var D=R.call(this,E)||this;return D.x=0,D.y=0,D.scaleX=1,D.scaleY=1,D.rotation=0,D.width=0,D.height=0,D.color=new A.Color(1,1,1,1),D.offset=A.Utils.newFloatArray(8),D.uvs=A.Utils.newFloatArray(8),D.tempColor=new A.Color(1,1,1,1),D}return B(P,R),P.prototype.updateOffset=function(){var E=this.width/this.region.originalWidth*this.scaleX,D=this.height/this.region.originalHeight*this.scaleY,I=-this.width/2*this.scaleX+this.region.offsetX*E,M=-this.height/2*this.scaleY+this.region.offsetY*D,N=I+this.region.width*E,k=M+this.region.height*D,F=this.rotation*Math.PI/180,G=Math.cos(F),V=Math.sin(F),j=I*G+this.x,H=I*V,U=M*G+this.y,X=M*V,Y=N*G+this.x,z=N*V,W=k*G+this.y,Z=k*V,Q=this.offset;Q[P.OX1]=j-X,Q[P.OY1]=U+H,Q[P.OX2]=j-Z,Q[P.OY2]=W+H,Q[P.OX3]=Y-Z,Q[P.OY3]=W+z,Q[P.OX4]=Y-X,Q[P.OY4]=U+z},P.prototype.setRegion=function(E){this.region=E;var D=this.uvs;E.rotate?(D[2]=E.u,D[3]=E.v2,D[4]=E.u,D[5]=E.v,D[6]=E.u2,D[7]=E.v,D[0]=E.u2,D[1]=E.v2):(D[0]=E.u,D[1]=E.v2,D[2]=E.u,D[3]=E.v,D[4]=E.u2,D[5]=E.v,D[6]=E.u2,D[7]=E.v2)},P.prototype.computeWorldVertices=function(E,D,I,M){var N=this.offset,k=E.worldX,F=E.worldY,G=E.a,V=E.b,j=E.c,H=E.d,U=0,X=0;U=N[P.OX1],X=N[P.OY1],D[I]=U*G+X*V+k,D[I+1]=U*j+X*H+F,I+=M,U=N[P.OX2],X=N[P.OY2],D[I]=U*G+X*V+k,D[I+1]=U*j+X*H+F,I+=M,U=N[P.OX3],X=N[P.OY3],D[I]=U*G+X*V+k,D[I+1]=U*j+X*H+F,I+=M,U=N[P.OX4],X=N[P.OY4],D[I]=U*G+X*V+k,D[I+1]=U*j+X*H+F},P.prototype.copy=function(){var E=new P(name);return E.region=this.region,E.rendererObject=this.rendererObject,E.path=this.path,E.x=this.x,E.y=this.y,E.scaleX=this.scaleX,E.scaleY=this.scaleY,E.rotation=this.rotation,E.width=this.width,E.height=this.height,A.Utils.arrayCopy(this.uvs,0,E.uvs,0,8),A.Utils.arrayCopy(this.offset,0,E.offset,0,8),E.color.setFromColor(this.color),E},P.OX1=0,P.OY1=1,P.OX2=2,P.OY2=3,P.OX3=4,P.OY3=5,P.OX4=6,P.OY4=7,P.X1=0,P.Y1=1,P.C1R=2,P.C1G=3,P.C1B=4,P.C1A=5,P.U1=6,P.V1=7,P.X2=8,P.Y2=9,P.C2R=10,P.C2G=11,P.C2B=12,P.C2A=13,P.U2=14,P.V2=15,P.X3=16,P.Y3=17,P.C3R=18,P.C3G=19,P.C3B=20,P.C3A=21,P.U3=22,P.V3=23,P.X4=24,P.Y4=25,P.C4R=26,P.C4G=27,P.C4B=28,P.C4A=29,P.U4=30,P.V4=31,P}(A.Attachment);A.RegionAttachment=O}(w||(w={})),function(A){var O=function(){function R(P,E){this.jitterX=0,this.jitterY=0,this.jitterX=P,this.jitterY=E}return R.prototype.begin=function(){},R.prototype.transform=function(P){P.x+=A.MathUtils.randomTriangular(-this.jitterX,this.jitterY),P.y+=A.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},R.prototype.end=function(){},R}();A.JitterEffect=O}(w||(w={})),function(A){var O=function(){function R(P,E){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=P,this.interpolation=E}return R.prototype.begin=function(P){this.worldX=P.x+this.centerX,this.worldY=P.y+this.centerY},R.prototype.transform=function(P){var E=this.angle*A.MathUtils.degreesToRadians,D=P.x-this.worldX,I=P.y-this.worldY,M=Math.sqrt(D*D+I*I);if(M<this.radius){var N=this.interpolation.apply(0,E,(this.radius-M)/this.radius),k=Math.cos(N),F=Math.sin(N);P.x=k*D-F*I+this.worldX,P.y=F*D+k*I+this.worldY}},R.prototype.end=function(){},R.interpolation=new A.PowOut(2),R}();A.SwirlEffect=O}(w||(w={})),S.exports=w},{}],375:[function(L,S){var T,_,w,B,A,O,R=L("./track-entry-listeners"),P=L("./lib/spine"),E=[],D=[],I=0,M=0,N=0,k=null,F=null,G=0,V=0,j=0,H=0,U=null,X=null,Y=0,z=0,W=new P.Color(1,1,1,1),Z=new P.Color(1,1,1,1),Q=[0,1,2,2,3,0],ee=cc.Class({ctor:function(){this._privateMode=!1,this._inited=!1,this._invalid=!0,this._enableCacheAttachedInfo=!1,this.frames=[],this.totalTime=0,this._frameIdx=-1,this.isCompleted=!1,this._skeletonInfo=null,this._animationName=null,this._tempSegments=null,this._tempColors=null,this._tempBoneInfos=null},init:function(re,ie){this._inited=!0,this._animationName=ie,this._skeletonInfo=re},clear:function(){this._inited=!1;for(var re=0,ie=this.frames.length;re<ie;re++)this.frames[re].segments.length=0;this.invalidAllFrame()},bind:function(re){var ie=(function(ne){ne&&ne.animation.name===this._animationName&&(this.isCompleted=!0)}).bind(this);re.complete=ie},unbind:function(re){re.complete=null},begin:function(){if(this._invalid){var re=this._skeletonInfo,ie=re.curAnimationCache;ie&&ie!==this&&(this._privateMode?ie.invalidAllFrame():ie.updateToFrame());var ne=re.skeleton,he=re.listener,pe=re.state,K=ne.data.findAnimation(this._animationName);pe.setAnimationWith(0,K,!1),this.bind(he),re.curAnimationCache=this,this._frameIdx=-1,this.isCompleted=!1,this.totalTime=0,this._invalid=!1}},end:function(){this._needToUpdate()||(this._skeletonInfo.curAnimationCache=null,this.frames.length=this._frameIdx+1,this.isCompleted=!0,this.unbind(this._skeletonInfo.listener))},_needToUpdate:function(re){return!this.isCompleted&&this.totalTime<30&&(re==null||this._frameIdx<re)},updateToFrame:function(re){if(this._inited&&(this.begin(),this._needToUpdate(re))){var ie=this._skeletonInfo,ne=ie.skeleton,he=ie.clipper,pe=ie.state;do ne.update(1/60),pe.update(1/60),pe.apply(ne),ne.updateWorldTransform(),this._frameIdx++,this._updateFrame(ne,he,this._frameIdx),this.totalTime+=1/60;while(this._needToUpdate(re));this.end()}},isInited:function(){return this._inited},isInvalid:function(){return this._invalid},invalidAllFrame:function(){this.isCompleted=!1,this._invalid=!0},updateAllFrame:function(){this.invalidAllFrame(),this.updateToFrame()},enableCacheAttachedInfo:function(){this._enableCacheAttachedInfo||(this._enableCacheAttachedInfo=!0,this.invalidAllFrame())},_updateFrame:function(re,ie,ne){N=0,I=0,M=0,k=null,F=null,G=0,V=0,j=0,H=0,U=null,X=null,this.frames[ne]=this.frames[ne]||{segments:[],colors:[],boneInfos:[],vertices:null,uintVert:null,indices:null};var he=this.frames[ne],pe=this._tempSegments=he.segments,K=this._tempColors=he.colors,ue=this._tempBoneInfos=he.boneInfos;this._traverseSkeleton(re,ie),H>0&&(K[H-1].vfOffset=N),K.length=H,ue.length=I;var le=j-1;if(le>=0)if(V>0){var ce=pe[le];ce.indexCount=V,ce.vfCount=6*G,ce.vertexCount=G,pe.length=j}else pe.length=j-1;if(pe.length!=0){var _e=he.vertices,oe=he.uintVert;(!_e||_e.length<N)&&(_e=he.vertices=new Float32Array(N),oe=he.uintVert=new Uint32Array(_e.buffer));for(var de=0,me=0;de<N;)_e[de++]=E[me++],_e[de++]=E[me++],_e[de++]=E[me++],_e[de++]=E[me++],oe[de++]=E[me++],oe[de++]=E[me++];var ye=he.indices;(!ye||ye.length<M)&&(ye=he.indices=new Uint16Array(M));for(var ge=0;ge<M;ge++)ye[ge]=D[ge];he.vertices=_e,he.uintVert=oe,he.indices=ye}},fillVertices:function(re,ie,ne,he,pe){if(B=ne.a*ie.a*re.a*255,T=ie.r*re.r*255,_=ie.g*re.g*255,w=ie.b*re.b*255,W.r=T*ne.r,W.g=_*ne.g,W.b=w*ne.b,W.a=B,pe.darkColor==null?Z.set(0,0,0,1):(Z.r=pe.darkColor.r*T,Z.g=pe.darkColor.g*_,Z.b=pe.darkColor.b*w),Z.a=0,A=(W.a<<24>>>0)+(W.b<<16)+(W.g<<8)+W.r,O=(Z.a<<24>>>0)+(Z.b<<16)+(Z.g<<8)+Z.r,U!==A||X!==O){var K=this._tempColors;U=A,X=O,H>0&&(K[H-1].vfOffset=N),K[H++]={fr:W.r,fg:W.g,fb:W.b,fa:W.a,dr:Z.r,dg:Z.g,db:Z.b,da:Z.a,vfOffset:0}}if(he.isClipping()){he.clipTriangles(E,Y,D,z,E,W,Z,!0,6,M,N,N+2);var ue=he.clippedVertices,le=he.clippedTriangles;z=le.length,Y=ue.length/12*6;for(var ce=0,_e=M,oe=le.length;ce<oe;)D[_e++]=le[ce++];for(var de=0,me=ue.length,ye=N;de<me;de+=12,ye+=6)E[ye]=ue[de],E[ye+1]=ue[de+1],E[ye+2]=ue[de+6],E[ye+3]=ue[de+7],E[ye+4]=A,E[ye+5]=O}else for(var ge=N,we=N+Y;ge<we;ge+=6)E[ge+4]=A,E[ge+5]=O},_traverseSkeleton:function(re,ie){var ne,he,pe,K,ue,le,ce,_e,oe,de,me,ye,ge=this._tempSegments,we=this._tempBoneInfos,Te=re.color,Ee=re.bones;if(this._enableCacheAttachedInfo)for(var De=0,fe=Ee.length;De<fe;De++,I++){var Ce=Ee[De],Se=we[I];Se||(Se=we[I]={}),Se.a=Ce.a,Se.b=Ce.b,Se.c=Ce.c,Se.d=Ce.d,Se.worldX=Ce.worldX,Se.worldY=Ce.worldY}for(var be=0,Re=re.drawOrder.length;be<Re;be++)if((ye=re.drawOrder[be]).bone.active)if(Y=0,z=0,ne=ye.getAttachment())if(le=ne instanceof P.RegionAttachment,ce=ne instanceof P.MeshAttachment,ne instanceof P.ClippingAttachment)ie.clipStart(ye,ne);else if(le||ce)if(_e=ne.region.texture._texture)if(me=ye.data.blendMode,k===_e.nativeUrl&&F===me||(k=_e.nativeUrl,F=me,(oe=j-1)>=0&&(V>0?((de=ge[oe]).indexCount=V,de.vertexCount=G,de.vfCount=6*G):j--),ge[j]={tex:_e,blendMode:me,indexCount:0,vertexCount:0,vfCount:0},j++,V=0,G=0),le?(ue=Q,Y=24,z=6,ne.computeWorldVertices(ye.bone,E,N,6)):ce&&(ue=ne.triangles,Y=6*(ne.worldVerticesLength>>1),z=ue.length,ne.computeWorldVertices(ye,0,ne.worldVerticesLength,E,N,6)),Y!=0&&z!=0){for(var Ve=0,Pe=M,ke=ue.length;Ve<ke;)D[Pe++]=ue[Ve++];K=ne.uvs;for(var Ne=N,Ae=N+Y,Oe=0;Ne<Ae;Ne+=6,Oe+=2)E[Ne+2]=K[Oe],E[Ne+3]=K[Oe+1];if(he=ne.color,pe=ye.color,this.fillVertices(Te,he,pe,ie,ye),z>0){for(var Fe=M,nt=M+z;Fe<nt;Fe++)D[Fe]+=G;M+=z,N+=Y,V+=z,G+=Y/6}ie.clipEndWithSlot(ye)}else ie.clipEndWithSlot(ye);else ie.clipEndWithSlot(ye);else ie.clipEndWithSlot(ye);else ie.clipEndWithSlot(ye);ie.clipEnd()}}),te=cc.Class({ctor:function(){this._privateMode=!1,this._animationPool={},this._skeletonCache={}},enablePrivateMode:function(){this._privateMode=!0},clear:function(){this._animationPool={},this._skeletonCache={}},removeSkeleton:function(re){var ie=this._skeletonCache[re];if(ie){var ne=ie.animationsCache;for(var he in ne){var pe=ne[he];pe&&(this._animationPool[re+"#"+he]=pe,pe.clear())}delete this._skeletonCache[re]}},getSkeletonCache:function(re,ie){var ne=this._skeletonCache[re];if(!ne){var he=new P.Skeleton(ie),pe=new P.SkeletonClipping,K=new P.AnimationStateData(he.data),ue=new P.AnimationState(K),le=new R;ue.addListener(le),this._skeletonCache[re]=ne={skeleton:he,clipper:pe,state:ue,listener:le,animationsCache:{},curAnimationCache:null}}return ne},getAnimationCache:function(re,ie){var ne=this._skeletonCache[re];return ne?ne.animationsCache[ie]:null},invalidAnimationCache:function(re){var ie=this._skeletonCache[re];if(ie&&ie.skeleton){var ne=ie.animationsCache;for(var he in ne)ne[he].invalidAllFrame()}},initAnimationCache:function(re,ie){if(!ie)return null;var ne=this._skeletonCache[re],he=ne&&ne.skeleton;if(!he||!he.data.findAnimation(ie))return null;var pe=ne.animationsCache,K=pe[ie];if(!K){var ue=re+"#"+ie;(K=this._animationPool[ue])?delete this._animationPool[ue]:(K=new ee)._privateMode=this._privateMode,K.init(ne,ie),pe[ie]=K}return K},updateAnimationCache:function(re,ie){if(ie){var ne=this.initAnimationCache(re,ie);if(!ne)return null;ne.updateAllFrame()}else{var he=this._skeletonCache[re];if(!he||!he.skeleton)return;var pe=he.animationsCache;for(var K in pe)pe[K].updateAllFrame()}}});te.FrameTime=1/60,te.sharedCache=new te,S.exports=te},{"./lib/spine":374,"./track-entry-listeners":379}],376:[function(L,S){var T=L("./skeleton-cache").sharedCache,_=cc.Class({name:"sp.SkeletonData",extends:cc.Asset,ctor:function(){this.reset()},properties:{_skeletonJson:null,skeletonJsonStr:{get:function(){return this._skeletonJson?JSON.stringify(this._skeletonJson):""}},skeletonJson:{get:function(){return this._skeletonJson},set:function(w){this.reset(),this._skeletonJson=typeof w=="string"?JSON.parse(w):w,!this._uuid&&w.skeleton&&(this._uuid=w.skeleton.hash)}},_atlasText:"",atlasText:{get:function(){return this._atlasText},set:function(w){this._atlasText=w,this.reset()}},textures:{default:[],type:[cc.Texture2D]},textureNames:{default:[],type:[cc.String]},scale:1,_nativeAsset:{get:function(){return this._buffer},set:function(w){this._buffer=w.buffer||w,this.reset()},override:!0}},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){this._skeletonCache=null,this._atlasCache=null},ensureTexturesLoaded:function(w,B){var A=this.textures,O=A.length;if(O!=0)for(var R=0,P=function(){++R>=O&&(w&&w.call(B,!0),w=null)},E=0;E<O;E++){var D=A[E];D.loaded?P():D.once("load",P)}else w.call(B,!1)},isTexturesLoaded:function(){for(var w=this.textures,B=w.length,A=0;A<B;A++)if(!w[A].loaded)return!1;return!0},getRuntimeData:function(w){if(this._skeletonCache)return this._skeletonCache;if(!(this.textures&&this.textures.length>0)&&this.textureNames&&this.textureNames.length>0)return w||cc.errorID(7507,this.name),null;var B=this._getAtlas(w);if(!B)return null;var A=new sp.spine.AtlasAttachmentLoader(B),O=null,R=null;return this.skeletonJson?(R=new sp.spine.SkeletonJson(A),O=this.skeletonJson):(R=new sp.spine.SkeletonBinary(A),O=new Uint8Array(this._nativeAsset)),R.scale=this.scale,this._skeletonCache=R.readSkeletonData(O),B.dispose(),this._skeletonCache},getSkinsEnum:!1,getAnimsEnum:!1,_getTexture:function(w){for(var B=this.textureNames,A=0;A<B.length;A++)if(B[A]===w){var O=this.textures[A],R=new sp.SkeletonTexture({width:O.width,height:O.height});return R.setRealTexture(O),R}return cc.errorID(7506,w),null},_getAtlas:function(w){return this._atlasCache?this._atlasCache:this.atlasText?this._atlasCache=new sp.spine.TextureAtlas(this.atlasText,this._getTexture.bind(this)):(w||cc.errorID(7508,this.name),null)},destroy:function(){T.removeSkeleton(this._uuid),this._super()}});sp.SkeletonData=S.exports=_},{"./skeleton-cache":375}],377:[function(){sp.SkeletonTexture=cc.Class({name:"sp.SkeletonTexture",extends:sp.spine.Texture,_texture:null,_material:null,setRealTexture:function(L){this._texture=L},getRealTexture:function(){return this._texture},setFilters:function(L,S){this._texture&&this._texture.setFilters(L,S)},setWraps:function(L,S){this._texture&&this._texture.setWrapMode(L,S)},dispose:function(){}})},{}],378:[function(L,S,T){T.__esModule=!0,T.default=void 0;var _,w=(_=L("../../cocos2d/core/renderer/assembler"))&&_.__esModule?_:{default:_};function B(Et,Lt){return(B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Ot,Kt){return Ot.__proto__=Kt,Ot})(Et,Lt)}var A,O,R,P,E,D,I,M,N,k,F,G,V,j,H,U,X,Y=L("./Skeleton"),z=L("./lib/spine"),W=L("../../cocos2d/core/renderer/render-flow"),Z=L("../../cocos2d/core/renderer/webgl/vertex-format"),Q=Z.vfmtPosUvColor,ee=Z.vfmtPosUvTwoColor,te=cc.gfx,re=0,ie=[0,1,2,2,3,0],ne=cc.color(0,0,255,255),he=cc.color(255,0,0,255),pe=cc.color(0,255,0,255),K=cc.color(255,255,0,255),ue=null,le=null,ce=null,_e=null;ue=new z.Color(1,1,1,1),le=new z.Color(1,1,1,1),ce=new z.Vector2,_e=new z.Vector2;var oe,de,me,ye,ge,we,Te,Ee,De,fe,Ce,Se,be,Re,Ve,Pe,ke,Ne,Ae,Oe,Fe,nt,Ze,Xe,$e,ot,ut,gt,Ue,We=0,ht=0,Be=0,je=0,Qe=0,st=0,pt=0;function qe(Et,Lt){var Ot,Kt;switch(Lt){case z.BlendMode.Additive:Ot=A?cc.macro.ONE:cc.macro.SRC_ALPHA,Kt=cc.macro.ONE;break;case z.BlendMode.Multiply:Ot=cc.macro.DST_COLOR,Kt=cc.macro.ONE_MINUS_SRC_ALPHA;break;case z.BlendMode.Screen:Ot=cc.macro.ONE,Kt=cc.macro.ONE_MINUS_SRC_COLOR;break;case z.BlendMode.Normal:default:Ot=A?cc.macro.ONE:cc.macro.SRC_ALPHA,Kt=cc.macro.ONE_MINUS_SRC_ALPHA}var Jt=!Xe.enableBatch,Yt=Xe._materials[0];if(!Yt)return null;var Wt=Et.getId()+Ot+Kt+E+Jt,rr=Xe._materialCache,Ft=rr[Wt];return Ft||(rr.baseMaterial?Ft=cc.MaterialVariant.create(Yt):(Ft=Yt,rr.baseMaterial=Yt),Ft.define("CC_USE_MODEL",Jt),Ft.define("USE_TINT",E),Ft.setProperty("texture",Et),Ft.setBlend(!0,te.BLEND_FUNC_ADD,Ot,Kt,te.BLEND_FUNC_ADD,Ot,Kt),rr[Wt]=Ft),Ft}function rt(Et){Oe=Et.fa*G,Re=N*(O=A?Oe/255:1),Ve=k*O,Pe=F*O,ke=Et.fr*Re,Ne=Et.fg*Ve,Ae=Et.fb*Pe,V=(Oe<<24>>>0)+(Ae<<16)+(Ne<<8)+ke,Fe=Et.dr*Re,nt=Et.dg*Ve,Ze=Et.db*Pe,j=((A?255:0)<<24>>>0)+(Ze<<16)+(nt<<8)+Fe}function bt(Et){return(Et.a<<24>>>0)+(Et.b<<16)+(Et.g<<8)+Et.r}var Dt=function(Et){var Lt,Ot;function Kt(){return Et.apply(this,arguments)||this}Ot=Et,(Lt=Kt).prototype=Object.create(Ot.prototype),Lt.prototype.constructor=Lt,B(Lt,Ot);var Jt=Kt.prototype;return Jt.updateRenderData=function(Yt){if(!Yt.isAnimationCached()){var Wt=Yt._skeleton;Wt&&Wt.updateWorldTransform()}},Jt.fillVertices=function(Yt,Wt,rr,Ft,zt){var lr,nr=$e._vData,tt=$e._iData,ft=$e._uintVData;if(ue.a=rr.a*Wt.a*Yt.a*G*255,O=A?ue.a:255,oe=N*Wt.r*Yt.r*O,de=k*Wt.g*Yt.g*O,me=F*Wt.b*Yt.b*O,ue.r=oe*rr.r,ue.g=de*rr.g,ue.b=me*rr.b,zt.darkColor==null?le.set(0,0,0,1):(le.r=zt.darkColor.r*oe,le.g=zt.darkColor.g*de,le.b=zt.darkColor.b*me),le.a=A?255:0,Ft.isClipping()){var lt=nr.subarray(Be+2);Ft.clipTriangles(nr.subarray(Be),We,tt.subarray(st),Qe,lt,ue,le,E,U);var at=new Float32Array(Ft.clippedVertices),dt=Ft.clippedTriangles;if(Qe=dt.length,We=at.length/X*U,lr=$e.request(We/U,Qe),st=lr.indiceOffset,je=lr.vertexOffset,Be=lr.byteOffset>>2,nr=$e._vData,tt=$e._iData,ft=$e._uintVData,tt.set(dt,st),Ue)for(var _t=0,Ct=at.length,It=Be;_t<Ct;_t+=X,It+=U)ce.x=at[_t],ce.y=at[_t+1],ue.set(at[_t+2],at[_t+3],at[_t+4],at[_t+5]),_e.x=at[_t+6],_e.y=at[_t+7],E?le.set(at[_t+8],at[_t+9],at[_t+10],at[_t+11]):le.set(0,0,0,0),Ue.transform(ce,_e,ue,le),nr[It]=ce.x,nr[It+1]=ce.y,nr[It+2]=_e.x,nr[It+3]=_e.y,ft[It+4]=bt(ue),E&&(ft[It+5]=bt(le));else for(var xt=0,yt=at.length,At=Be;xt<yt;xt+=X,At+=U)nr[At]=at[xt],nr[At+1]=at[xt+1],nr[At+2]=at[xt+6],nr[At+3]=at[xt+7],V=(at[xt+5]<<24>>>0)+(at[xt+4]<<16)+(at[xt+3]<<8)+at[xt+2],ft[At+4]=V,E&&(j=(at[xt+11]<<24>>>0)+(at[xt+10]<<16)+(at[xt+9]<<8)+at[xt+8],ft[At+5]=j)}else if(Ue)for(var Rt=Be,Gt=Be+We;Rt<Gt;Rt+=U)ce.x=nr[Rt],ce.y=nr[Rt+1],_e.x=nr[Rt+2],_e.y=nr[Rt+3],Ue.transform(ce,_e,ue,le),nr[Rt]=ce.x,nr[Rt+1]=ce.y,nr[Rt+2]=_e.x,nr[Rt+3]=_e.y,ft[Rt+4]=bt(ue),E&&(ft[Rt+5]=bt(le));else{V=bt(ue),j=bt(le);for(var Mt=Be,Nt=Be+We;Mt<Nt;Mt+=U)ft[Mt+4]=V,E&&(ft[Mt+5]=j)}},Jt.realTimeTraverse=function(Yt){var Wt,rr,Ft,zt,lr,nr,tt,ft,lt,at,dt,_t,Ct=Xe._skeleton,It=Ct.color,xt=Xe._debugRenderer,yt=Xe._clipper,At=null;R=Xe._startSlotIndex,P=Xe._endSlotIndex,ye=!1,R==-1&&(ye=!0),D=Xe.debugSlots,I=Xe.debugBones,M=Xe.debugMesh,xt&&(I||D||M)&&(xt.clear(),xt.lineWidth=2),X=E?12:8,We=0,Be=0,je=0,Qe=0,st=0;for(var Rt=0,Gt=Ct.drawOrder.length;Rt<Gt;Rt++)if((dt=Ct.drawOrder[Rt])!=null&&dt.bone.active)if(R>=0&&R==dt.data.index&&(ye=!0),ye)if(P>=0&&P==dt.data.index&&(ye=!1),We=0,Qe=0,Ft=dt.getAttachment())if(ft=Ft instanceof z.RegionAttachment,lt=Ft instanceof z.MeshAttachment,Ft instanceof z.ClippingAttachment)yt.clipStart(dt,Ft);else if(ft||lt)if(At=qe(Ft.region.texture._texture,dt.data.blendMode)){if((ge||At.getHash()!==ot.material.getHash())&&(ge=!1,ot._flush(),ot.node=ut,ot.material=At),ft){if(tt=ie,We=4*U,Qe=6,at=$e.request(4,6),st=at.indiceOffset,je=at.vertexOffset,Be=at.byteOffset>>2,Wt=$e._vData,rr=$e._iData,Ft.computeWorldVertices(dt.bone,Wt,Be,U),xt&&D){xt.strokeColor=ne,xt.moveTo(Wt[Be],Wt[Be+1]);for(var Mt=Be+U,Nt=Be+We;Mt<Nt;Mt+=U)xt.lineTo(Wt[Mt],Wt[Mt+1]);xt.close(),xt.stroke()}}else if(lt&&(tt=Ft.triangles,We=(Ft.worldVerticesLength>>1)*U,Qe=tt.length,at=$e.request(We/U,Qe),st=at.indiceOffset,je=at.vertexOffset,Be=at.byteOffset>>2,Wt=$e._vData,rr=$e._iData,Ft.computeWorldVertices(dt,0,Ft.worldVerticesLength,Wt,Be,U),xt&&M)){xt.strokeColor=K;for(var kt=0,er=tt.length;kt<er;kt+=3){var hr=tt[kt]*U+Be,cr=tt[kt+1]*U+Be,xr=tt[kt+2]*U+Be;xt.moveTo(Wt[hr],Wt[hr+1]),xt.lineTo(Wt[cr],Wt[cr+1]),xt.lineTo(Wt[xr],Wt[xr+1]),xt.close(),xt.stroke()}}if(We!=0&&Qe!=0){rr.set(tt,st),nr=Ft.uvs;for(var Ar=Be,Er=Be+We,br=0;Ar<Er;Ar+=U,br+=2)Wt[Ar+2]=nr[br],Wt[Ar+3]=nr[br+1];if(zt=Ft.color,lr=dt.color,this.fillVertices(It,zt,lr,yt,dt),Wt=$e._vData,rr=$e._iData,Qe>0){for(var gr=st,Dr=st+Qe;gr<Dr;gr++)rr[gr]+=je;if(Yt){_t=Yt.m,Ee=_t[0],De=_t[4],fe=_t[12],Ce=_t[1],Se=_t[5],be=_t[13];for(var Ir=Be,$r=Be+We;Ir<$r;Ir+=U)we=Wt[Ir],Te=Wt[Ir+1],Wt[Ir]=we*Ee+Te*De+fe,Wt[Ir+1]=we*Ce+Te*Se+be}$e.adjust(We/U,Qe)}yt.clipEndWithSlot(dt)}else yt.clipEndWithSlot(dt)}else yt.clipEndWithSlot(dt);else yt.clipEndWithSlot(dt);else yt.clipEndWithSlot(dt);else yt.clipEndWithSlot(dt);if(yt.clipEnd(),xt&&I){var Br;xt.strokeColor=he,xt.fillColor=ne;for(var Qr=0,yi=Ct.bones.length;Qr<yi;Qr++){var xi=(Br=Ct.bones[Qr]).data.length*Br.a+Br.worldX,ui=Br.data.length*Br.c+Br.worldY;xt.moveTo(Br.worldX,Br.worldY),xt.lineTo(xi,ui),xt.stroke(),xt.circle(Br.worldX,Br.worldY,1.5*Math.PI),xt.fill(),Qr===0&&(xt.fillColor=pe)}}},Jt.cacheTraverse=function(Yt){var Wt=Xe._curFrame;if(Wt){var rr=Wt.segments;if(rr.length!=0){var Ft,zt,lr,nr,tt,ft,lt=Wt.vertices,at=Wt.indices,dt=0,_t=0,Ct=0;Yt&&(ft=Yt.m,Ee=ft[0],Ce=ft[1],De=ft[4],Se=ft[5],fe=ft[12],be=ft[13]);var It=16&re,xt=It&&Ee===1&&Ce===0&&De===0&&Se===1,yt=0,At=Wt.colors,Rt=At[yt++],Gt=Rt.vfOffset;rt(Rt);for(var Mt=0,Nt=rr.length;Mt<Nt;Mt++){var kt=rr[Mt];if(nr=qe(kt.tex,kt.blendMode)){(ge||nr.getHash()!==ot.material.getHash())&&(ge=!1,ot._flush(),ot.node=ut,ot.material=nr),ht=kt.vertexCount,Qe=kt.indexCount,tt=$e.request(ht,Qe),st=tt.indiceOffset,je=tt.vertexOffset,pt=tt.byteOffset>>2,Ft=$e._vData,zt=$e._iData,lr=$e._uintVData;for(var er=st,hr=st+Qe;er<hr;er++)zt[er]=je+at[_t++];if(Ct=kt.vfCount,Ft.set(lt.subarray(dt,dt+Ct),pt),dt+=Ct,xt)for(var cr=pt,xr=pt+Ct;cr<xr;cr+=6)Ft[cr]+=fe,Ft[cr+1]+=be;else if(It)for(var Ar=pt,Er=pt+Ct;Ar<Er;Ar+=6)we=Ft[Ar],Te=Ft[Ar+1],Ft[Ar]=we*Ee+Te*De+fe,Ft[Ar+1]=we*Ce+Te*Se+be;if($e.adjust(ht,Qe),gt)for(var br=dt-Ct,gr=pt+4,Dr=pt+4+Ct;gr<Dr;gr+=6,br+=6)br>=Gt&&(rt(Rt=At[yt++]),Gt=Rt.vfOffset),lr[gr]=V,lr[gr+1]=j}}}}},Jt.fillBuffers=function(Yt,Wt){var rr=Yt.node;if(rr._renderFlag|=W.FLAG_UPDATE_RENDER_DATA,Yt._skeleton){var Ft=rr._color;N=Ft.r/255,k=Ft.g/255,F=Ft.b/255,G=Ft.a/255,E=Yt.useTint||Yt.isAnimationCached(),H=E?ee:Q,U=E?6:5,ut=Yt.node,$e=Wt.getBuffer("spine",H),ot=Wt,Xe=Yt,ge=!0,A=Yt.premultipliedAlpha,O=1,re=0,gt=!1,Ue=Yt._effectDelegate&&Yt._effectDelegate._vertexEffect,(Ft._val!==4294967295||A)&&(gt=!0),E&&(re|=1);var zt=void 0;Xe.enableBatch&&(zt=ut._worldMatrix,ge=!1,re|=16),Yt.isAnimationCached()?this.cacheTraverse(zt):(Ue&&Ue.begin(Yt._skeleton),this.realTimeTraverse(zt),Ue&&Ue.end()),Wt.worldMatDirty++,Yt.attachUtil._syncAttachedNode(),ut=void 0,$e=void 0,ot=void 0,Xe=void 0,Ue=null}},Jt.postFillBuffers=function(Yt,Wt){Wt.worldMatDirty--},Kt}(w.default);T.default=Dt,w.default.register(Y,Dt),S.exports=T.default},{"../../cocos2d/core/renderer/assembler":224,"../../cocos2d/core/renderer/render-flow":228,"../../cocos2d/core/renderer/webgl/vertex-format":260,"./Skeleton":372,"./lib/spine":374}],379:[function(L,S){var T=function(){this.start=null,this.end=null,this.complete=null,this.event=null,this.interrupt=null,this.dispose=null};T.getListeners=function(_){return _.listener||(_.listener=new T),_.listener},S.exports=T},{}],380:[function(L,S){var T=L("./lib/spine");sp.VertexEffectDelegate=cc.Class({name:"sp.VertexEffectDelegate",ctor:function(){this._vertexEffect=null,this._interpolation=null,this._effectType="none"},clear:function(){this._vertexEffect=null,this._interpolation=null,this._effectType="none"},initJitter:function(_,w){return this._effectType="jitter",this._vertexEffect=new T.JitterEffect(_,w),this._vertexEffect},initSwirlWithPow:function(_,w){return this._interpolation=new T.Pow(w),this._vertexEffect=new T.SwirlEffect(_,this._interpolation),this._vertexEffect},initSwirlWithPowOut:function(_,w){return this._interpolation=new T.PowOut(w),this._vertexEffect=new T.SwirlEffect(_,this._interpolation),this._vertexEffect},getJitterVertexEffect:function(){return this._vertexEffect},getSwirlVertexEffect:function(){return this._vertexEffect},getVertexEffect:function(){return this._vertexEffect},getEffectType:function(){return this._effectType}}),S.exports=sp.VertexEffectDelegate},{"./lib/spine":374}],381:[function(L,S,T){var _;_=function(w){function B(ae,J){return ae!==void 0?ae:J}var A=1e37,O=1e-5,R=O*O,P=3.14159265359,E=2,D=8,I=.008,M=2/180*P,N=2*I,k=-1,F=function(){function ae(J,q,se){J===void 0&&(J=0),q===void 0&&(q=0),se===void 0&&(se=0),this.major=0,this.minor=0,this.revision=0,this.major=J,this.minor=q,this.revision=se}return ae.prototype.toString=function(){return this.major+"."+this.minor+"."+this.revision},ae}(),G=new F(2,3,2);function V(ae,J){for(var q=[],se=0;se<ae;++se)q.push(J(se));return q}function j(ae,J){J===void 0&&(J=0);for(var q=[],se=0;se<ae;++se)q.push(J);return q}var H=Math.abs,U=Math.min,X=Math.max;function Y(ae,J,q){return ae<J?J:ae>q?q:ae}var z=isFinite;function W(ae){return ae*ae}function Z(ae){return 1/Math.sqrt(ae)}var Q,ee=Math.sqrt,te=Math.pow,re=Math.cos,ie=Math.sin,ne=Math.acos,he=Math.asin,pe=Math.atan2,K=function(){function ae(J,q){J===void 0&&(J=0),q===void 0&&(q=0),this.x=J,this.y=q}return ae.prototype.Clone=function(){return new ae(this.x,this.y)},ae.prototype.SetZero=function(){return this.x=0,this.y=0,this},ae.prototype.Set=function(J,q){return this.x=J,this.y=q,this},ae.prototype.Copy=function(J){return this.x=J.x,this.y=J.y,this},ae.prototype.SelfAdd=function(J){return this.x+=J.x,this.y+=J.y,this},ae.prototype.SelfAddXY=function(J,q){return this.x+=J,this.y+=q,this},ae.prototype.SelfSub=function(J){return this.x-=J.x,this.y-=J.y,this},ae.prototype.SelfSubXY=function(J,q){return this.x-=J,this.y-=q,this},ae.prototype.SelfMul=function(J){return this.x*=J,this.y*=J,this},ae.prototype.SelfMulAdd=function(J,q){return this.x+=J*q.x,this.y+=J*q.y,this},ae.prototype.SelfMulSub=function(J,q){return this.x-=J*q.x,this.y-=J*q.y,this},ae.prototype.Dot=function(J){return this.x*J.x+this.y*J.y},ae.prototype.Cross=function(J){return this.x*J.y-this.y*J.x},ae.prototype.Length=function(){var J=this.x,q=this.y;return Math.sqrt(J*J+q*q)},ae.prototype.LengthSquared=function(){var J=this.x,q=this.y;return J*J+q*q},ae.prototype.Normalize=function(){var J=this.Length();if(J>=O){var q=1/J;this.x*=q,this.y*=q}return J},ae.prototype.SelfNormalize=function(){var J=this.Length();if(J>=O){var q=1/J;this.x*=q,this.y*=q}return this},ae.prototype.SelfRotate=function(J){var q=Math.cos(J),se=Math.sin(J),ve=this.x;return this.x=q*ve-se*this.y,this.y=se*ve+q*this.y,this},ae.prototype.IsValid=function(){return isFinite(this.x)&&isFinite(this.y)},ae.prototype.SelfCrossVS=function(J){var q=this.x;return this.x=J*this.y,this.y=-J*q,this},ae.prototype.SelfCrossSV=function(J){var q=this.x;return this.x=-J*this.y,this.y=J*q,this},ae.prototype.SelfMinV=function(J){return this.x=U(this.x,J.x),this.y=U(this.y,J.y),this},ae.prototype.SelfMaxV=function(J){return this.x=X(this.x,J.x),this.y=X(this.y,J.y),this},ae.prototype.SelfAbs=function(){return this.x=H(this.x),this.y=H(this.y),this},ae.prototype.SelfNeg=function(){return this.x=-this.x,this.y=-this.y,this},ae.prototype.SelfSkew=function(){var J=this.x;return this.x=-this.y,this.y=J,this},ae.MakeArray=function(J){return V(J,function(){return new ae})},ae.AbsV=function(J,q){return q.x=H(J.x),q.y=H(J.y),q},ae.MinV=function(J,q,se){return se.x=U(J.x,q.x),se.y=U(J.y,q.y),se},ae.MaxV=function(J,q,se){return se.x=X(J.x,q.x),se.y=X(J.y,q.y),se},ae.ClampV=function(J,q,se,ve){return ve.x=Y(J.x,q.x,se.x),ve.y=Y(J.y,q.y,se.y),ve},ae.RotateV=function(J,q,se){var ve=J.x,xe=J.y,Ie=Math.cos(q),Me=Math.sin(q);return se.x=Ie*ve-Me*xe,se.y=Me*ve+Ie*xe,se},ae.DotVV=function(J,q){return J.x*q.x+J.y*q.y},ae.CrossVV=function(J,q){return J.x*q.y-J.y*q.x},ae.CrossVS=function(J,q,se){var ve=J.x;return se.x=q*J.y,se.y=-q*ve,se},ae.CrossVOne=function(J,q){var se=J.x;return q.x=J.y,q.y=-se,q},ae.CrossSV=function(J,q,se){var ve=q.x;return se.x=-J*q.y,se.y=J*ve,se},ae.CrossOneV=function(J,q){var se=J.x;return q.x=-J.y,q.y=se,q},ae.AddVV=function(J,q,se){return se.x=J.x+q.x,se.y=J.y+q.y,se},ae.SubVV=function(J,q,se){return se.x=J.x-q.x,se.y=J.y-q.y,se},ae.MulSV=function(J,q,se){return se.x=q.x*J,se.y=q.y*J,se},ae.MulVS=function(J,q,se){return se.x=J.x*q,se.y=J.y*q,se},ae.AddVMulSV=function(J,q,se,ve){return ve.x=J.x+q*se.x,ve.y=J.y+q*se.y,ve},ae.SubVMulSV=function(J,q,se,ve){return ve.x=J.x-q*se.x,ve.y=J.y-q*se.y,ve},ae.AddVCrossSV=function(J,q,se,ve){var xe=se.x;return ve.x=J.x-q*se.y,ve.y=J.y+q*xe,ve},ae.MidVV=function(J,q,se){return se.x=.5*(J.x+q.x),se.y=.5*(J.y+q.y),se},ae.ExtVV=function(J,q,se){return se.x=.5*(q.x-J.x),se.y=.5*(q.y-J.y),se},ae.IsEqualToV=function(J,q){return J.x===q.x&&J.y===q.y},ae.DistanceVV=function(J,q){var se=J.x-q.x,ve=J.y-q.y;return Math.sqrt(se*se+ve*ve)},ae.DistanceSquaredVV=function(J,q){var se=J.x-q.x,ve=J.y-q.y;return se*se+ve*ve},ae.NegV=function(J,q){return q.x=-J.x,q.y=-J.y,q},ae.ZERO=new ae(0,0),ae.UNITX=new ae(1,0),ae.UNITY=new ae(0,1),ae.s_t0=new ae,ae.s_t1=new ae,ae.s_t2=new ae,ae.s_t3=new ae,ae}(),ue=new K(0,0),le=function(){function ae(J,q,se){J===void 0&&(J=0),q===void 0&&(q=0),se===void 0&&(se=0),this.x=J,this.y=q,this.z=se}return ae.prototype.Clone=function(){return new ae(this.x,this.y,this.z)},ae.prototype.SetZero=function(){return this.x=0,this.y=0,this.z=0,this},ae.prototype.SetXYZ=function(J,q,se){return this.x=J,this.y=q,this.z=se,this},ae.prototype.Copy=function(J){return this.x=J.x,this.y=J.y,this.z=J.z,this},ae.prototype.SelfNeg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},ae.prototype.SelfAdd=function(J){return this.x+=J.x,this.y+=J.y,this.z+=J.z,this},ae.prototype.SelfAddXYZ=function(J,q,se){return this.x+=J,this.y+=q,this.z+=se,this},ae.prototype.SelfSub=function(J){return this.x-=J.x,this.y-=J.y,this.z-=J.z,this},ae.prototype.SelfSubXYZ=function(J,q,se){return this.x-=J,this.y-=q,this.z-=se,this},ae.prototype.SelfMul=function(J){return this.x*=J,this.y*=J,this.z*=J,this},ae.DotV3V3=function(J,q){return J.x*q.x+J.y*q.y+J.z*q.z},ae.CrossV3V3=function(J,q,se){var ve=J.x,xe=J.y,Ie=J.z,Me=q.x,Le=q.y,Ge=q.z;return se.x=xe*Ge-Ie*Le,se.y=Ie*Me-ve*Ge,se.z=ve*Le-xe*Me,se},ae.ZERO=new ae(0,0,0),ae.s_t0=new ae,ae}(),ce=function(){function ae(){this.ex=new K(1,0),this.ey=new K(0,1)}return ae.prototype.Clone=function(){return new ae().Copy(this)},ae.FromVV=function(J,q){return new ae().SetVV(J,q)},ae.FromSSSS=function(J,q,se,ve){return new ae().SetSSSS(J,q,se,ve)},ae.FromAngle=function(J){return new ae().SetAngle(J)},ae.prototype.SetSSSS=function(J,q,se,ve){return this.ex.Set(J,se),this.ey.Set(q,ve),this},ae.prototype.SetVV=function(J,q){return this.ex.Copy(J),this.ey.Copy(q),this},ae.prototype.SetAngle=function(J){var q=Math.cos(J),se=Math.sin(J);return this.ex.Set(q,se),this.ey.Set(-se,q),this},ae.prototype.Copy=function(J){return this.ex.Copy(J.ex),this.ey.Copy(J.ey),this},ae.prototype.SetIdentity=function(){return this.ex.Set(1,0),this.ey.Set(0,1),this},ae.prototype.SetZero=function(){return this.ex.SetZero(),this.ey.SetZero(),this},ae.prototype.GetAngle=function(){return Math.atan2(this.ex.y,this.ex.x)},ae.prototype.GetInverse=function(J){var q=this.ex.x,se=this.ey.x,ve=this.ex.y,xe=this.ey.y,Ie=q*xe-se*ve;return Ie!==0&&(Ie=1/Ie),J.ex.x=Ie*xe,J.ey.x=-Ie*se,J.ex.y=-Ie*ve,J.ey.y=Ie*q,J},ae.prototype.Solve=function(J,q,se){var ve=this.ex.x,xe=this.ey.x,Ie=this.ex.y,Me=this.ey.y,Le=ve*Me-xe*Ie;return Le!==0&&(Le=1/Le),se.x=Le*(Me*J-xe*q),se.y=Le*(ve*q-Ie*J),se},ae.prototype.SelfAbs=function(){return this.ex.SelfAbs(),this.ey.SelfAbs(),this},ae.prototype.SelfInv=function(){return this.GetInverse(this),this},ae.prototype.SelfAddM=function(J){return this.ex.SelfAdd(J.ex),this.ey.SelfAdd(J.ey),this},ae.prototype.SelfSubM=function(J){return this.ex.SelfSub(J.ex),this.ey.SelfSub(J.ey),this},ae.AbsM=function(J,q){var se=J.ex,ve=J.ey;return q.ex.x=H(se.x),q.ex.y=H(se.y),q.ey.x=H(ve.x),q.ey.y=H(ve.y),q},ae.MulMV=function(J,q,se){var ve=J.ex,xe=J.ey,Ie=q.x,Me=q.y;return se.x=ve.x*Ie+xe.x*Me,se.y=ve.y*Ie+xe.y*Me,se},ae.MulTMV=function(J,q,se){var ve=J.ex,xe=J.ey,Ie=q.x,Me=q.y;return se.x=ve.x*Ie+ve.y*Me,se.y=xe.x*Ie+xe.y*Me,se},ae.AddMM=function(J,q,se){var ve=J.ex,xe=J.ey,Ie=q.ex,Me=q.ey;return se.ex.x=ve.x+Ie.x,se.ex.y=ve.y+Ie.y,se.ey.x=xe.x+Me.x,se.ey.y=xe.y+Me.y,se},ae.MulMM=function(J,q,se){var ve=J.ex.x,xe=J.ex.y,Ie=J.ey.x,Me=J.ey.y,Le=q.ex.x,Ge=q.ex.y,He=q.ey.x,Ye=q.ey.y;return se.ex.x=ve*Le+Ie*Ge,se.ex.y=xe*Le+Me*Ge,se.ey.x=ve*He+Ie*Ye,se.ey.y=xe*He+Me*Ye,se},ae.MulTMM=function(J,q,se){var ve=J.ex.x,xe=J.ex.y,Ie=J.ey.x,Me=J.ey.y,Le=q.ex.x,Ge=q.ex.y,He=q.ey.x,Ye=q.ey.y;return se.ex.x=ve*Le+xe*Ge,se.ex.y=Ie*Le+Me*Ge,se.ey.x=ve*He+xe*Ye,se.ey.y=Ie*He+Me*Ye,se},ae.IDENTITY=new ae,ae}(),_e=function(){function ae(){this.ex=new le(1,0,0),this.ey=new le(0,1,0),this.ez=new le(0,0,1)}return ae.prototype.Clone=function(){return new ae().Copy(this)},ae.prototype.SetVVV=function(J,q,se){return this.ex.Copy(J),this.ey.Copy(q),this.ez.Copy(se),this},ae.prototype.Copy=function(J){return this.ex.Copy(J.ex),this.ey.Copy(J.ey),this.ez.Copy(J.ez),this},ae.prototype.SetIdentity=function(){return this.ex.SetXYZ(1,0,0),this.ey.SetXYZ(0,1,0),this.ez.SetXYZ(0,0,1),this},ae.prototype.SetZero=function(){return this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero(),this},ae.prototype.SelfAddM=function(J){return this.ex.SelfAdd(J.ex),this.ey.SelfAdd(J.ey),this.ez.SelfAdd(J.ez),this},ae.prototype.Solve33=function(J,q,se,ve){var xe=this.ex.x,Ie=this.ex.y,Me=this.ex.z,Le=this.ey.x,Ge=this.ey.y,He=this.ey.z,Ye=this.ez.x,Je=this.ez.y,ze=this.ez.z,Ke=xe*(Ge*ze-He*Je)+Ie*(He*Ye-Le*ze)+Me*(Le*Je-Ge*Ye);return Ke!==0&&(Ke=1/Ke),ve.x=Ke*(J*(Ge*ze-He*Je)+q*(He*Ye-Le*ze)+se*(Le*Je-Ge*Ye)),ve.y=Ke*(xe*(q*ze-se*Je)+Ie*(se*Ye-J*ze)+Me*(J*Je-q*Ye)),ve.z=Ke*(xe*(Ge*se-He*q)+Ie*(He*J-Le*se)+Me*(Le*q-Ge*J)),ve},ae.prototype.Solve22=function(J,q,se){var ve=this.ex.x,xe=this.ey.x,Ie=this.ex.y,Me=this.ey.y,Le=ve*Me-xe*Ie;return Le!==0&&(Le=1/Le),se.x=Le*(Me*J-xe*q),se.y=Le*(ve*q-Ie*J),se},ae.prototype.GetInverse22=function(J){var q=this.ex.x,se=this.ey.x,ve=this.ex.y,xe=this.ey.y,Ie=q*xe-se*ve;Ie!==0&&(Ie=1/Ie),J.ex.x=Ie*xe,J.ey.x=-Ie*se,J.ex.z=0,J.ex.y=-Ie*ve,J.ey.y=Ie*q,J.ey.z=0,J.ez.x=0,J.ez.y=0,J.ez.z=0},ae.prototype.GetSymInverse33=function(J){var q=le.DotV3V3(this.ex,le.CrossV3V3(this.ey,this.ez,le.s_t0));q!==0&&(q=1/q);var se=this.ex.x,ve=this.ey.x,xe=this.ez.x,Ie=this.ey.y,Me=this.ez.y,Le=this.ez.z;J.ex.x=q*(Ie*Le-Me*Me),J.ex.y=q*(xe*Me-ve*Le),J.ex.z=q*(ve*Me-xe*Ie),J.ey.x=J.ex.y,J.ey.y=q*(se*Le-xe*xe),J.ey.z=q*(xe*ve-se*Me),J.ez.x=J.ex.z,J.ez.y=J.ey.z,J.ez.z=q*(se*Ie-ve*ve)},ae.MulM33V3=function(J,q,se){var ve=q.x,xe=q.y,Ie=q.z;return se.x=J.ex.x*ve+J.ey.x*xe+J.ez.x*Ie,se.y=J.ex.y*ve+J.ey.y*xe+J.ez.y*Ie,se.z=J.ex.z*ve+J.ey.z*xe+J.ez.z*Ie,se},ae.MulM33XYZ=function(J,q,se,ve,xe){return xe.x=J.ex.x*q+J.ey.x*se+J.ez.x*ve,xe.y=J.ex.y*q+J.ey.y*se+J.ez.y*ve,xe.z=J.ex.z*q+J.ey.z*se+J.ez.z*ve,xe},ae.MulM33V2=function(J,q,se){var ve=q.x,xe=q.y;return se.x=J.ex.x*ve+J.ey.x*xe,se.y=J.ex.y*ve+J.ey.y*xe,se},ae.MulM33XY=function(J,q,se,ve){return ve.x=J.ex.x*q+J.ey.x*se,ve.y=J.ex.y*q+J.ey.y*se,ve},ae.IDENTITY=new ae,ae}(),oe=function(){function ae(J){J===void 0&&(J=0),this.s=0,this.c=1,J&&(this.s=Math.sin(J),this.c=Math.cos(J))}return ae.prototype.Clone=function(){return new ae().Copy(this)},ae.prototype.Copy=function(J){return this.s=J.s,this.c=J.c,this},ae.prototype.SetAngle=function(J){return this.s=Math.sin(J),this.c=Math.cos(J),this},ae.prototype.SetIdentity=function(){return this.s=0,this.c=1,this},ae.prototype.GetAngle=function(){return Math.atan2(this.s,this.c)},ae.prototype.GetXAxis=function(J){return J.x=this.c,J.y=this.s,J},ae.prototype.GetYAxis=function(J){return J.x=-this.s,J.y=this.c,J},ae.MulRR=function(J,q,se){var ve=J.c,xe=J.s,Ie=q.c,Me=q.s;return se.s=xe*Ie+ve*Me,se.c=ve*Ie-xe*Me,se},ae.MulTRR=function(J,q,se){var ve=J.c,xe=J.s,Ie=q.c,Me=q.s;return se.s=ve*Me-xe*Ie,se.c=ve*Ie+xe*Me,se},ae.MulRV=function(J,q,se){var ve=J.c,xe=J.s,Ie=q.x,Me=q.y;return se.x=ve*Ie-xe*Me,se.y=xe*Ie+ve*Me,se},ae.MulTRV=function(J,q,se){var ve=J.c,xe=J.s,Ie=q.x,Me=q.y;return se.x=ve*Ie+xe*Me,se.y=-xe*Ie+ve*Me,se},ae.IDENTITY=new ae,ae}(),de=function(){function ae(){this.p=new K,this.q=new oe}return ae.prototype.Clone=function(){return new ae().Copy(this)},ae.prototype.Copy=function(J){return this.p.Copy(J.p),this.q.Copy(J.q),this},ae.prototype.SetIdentity=function(){return this.p.SetZero(),this.q.SetIdentity(),this},ae.prototype.SetPositionRotation=function(J,q){return this.p.Copy(J),this.q.Copy(q),this},ae.prototype.SetPositionAngle=function(J,q){return this.p.Copy(J),this.q.SetAngle(q),this},ae.prototype.SetPosition=function(J){return this.p.Copy(J),this},ae.prototype.SetPositionXY=function(J,q){return this.p.Set(J,q),this},ae.prototype.SetRotation=function(J){return this.q.Copy(J),this},ae.prototype.SetRotationAngle=function(J){return this.q.SetAngle(J),this},ae.prototype.GetPosition=function(){return this.p},ae.prototype.GetRotation=function(){return this.q},ae.prototype.GetRotationAngle=function(){return this.q.GetAngle()},ae.prototype.GetAngle=function(){return this.q.GetAngle()},ae.MulXV=function(J,q,se){var ve=J.q.c,xe=J.q.s,Ie=q.x,Me=q.y;return se.x=ve*Ie-xe*Me+J.p.x,se.y=xe*Ie+ve*Me+J.p.y,se},ae.MulTXV=function(J,q,se){var ve=J.q.c,xe=J.q.s,Ie=q.x-J.p.x,Me=q.y-J.p.y;return se.x=ve*Ie+xe*Me,se.y=-xe*Ie+ve*Me,se},ae.MulXX=function(J,q,se){return oe.MulRR(J.q,q.q,se.q),K.AddVV(oe.MulRV(J.q,q.p,se.p),J.p,se.p),se},ae.MulTXX=function(J,q,se){return oe.MulTRR(J.q,q.q,se.q),oe.MulTRV(J.q,K.SubVV(q.p,J.p,se.p),se.p),se},ae.IDENTITY=new ae,ae}(),me=function(){function ae(){this.localCenter=new K,this.c0=new K,this.c=new K,this.a0=0,this.a=0,this.alpha0=0}return ae.prototype.Clone=function(){return new ae().Copy(this)},ae.prototype.Copy=function(J){return this.localCenter.Copy(J.localCenter),this.c0.Copy(J.c0),this.c.Copy(J.c),this.a0=J.a0,this.a=J.a,this.alpha0=J.alpha0,this},ae.prototype.GetTransform=function(J,q){var se=1-q;J.p.x=se*this.c0.x+q*this.c.x,J.p.y=se*this.c0.y+q*this.c.y;var ve=se*this.a0+q*this.a;return J.q.SetAngle(ve),J.p.SelfSub(oe.MulRV(J.q,this.localCenter,K.s_t0)),J},ae.prototype.Advance=function(J){var q=(J-this.alpha0)/(1-this.alpha0),se=1-q;this.c0.x=se*this.c0.x+q*this.c.x,this.c0.y=se*this.c0.y+q*this.c.y,this.a0=se*this.a0+q*this.a,this.alpha0=J},ae.prototype.Normalize=function(){var J=6.28318530718*Math.floor(this.a0/6.28318530718);this.a0-=J,this.a-=J},ae}(),ye=function(){function ae(J,q,se,ve){J===void 0&&(J=.5),q===void 0&&(q=.5),se===void 0&&(se=.5),ve===void 0&&(ve=1),this.r=J,this.g=q,this.b=se,this.a=ve}return ae.prototype.Clone=function(){return new ae().Copy(this)},ae.prototype.Copy=function(J){return this.r=J.r,this.g=J.g,this.b=J.b,this.a=J.a,this},ae.prototype.IsEqual=function(J){return this.r===J.r&&this.g===J.g&&this.b===J.b&&this.a===J.a},ae.prototype.IsZero=function(){return this.r===0&&this.g===0&&this.b===0&&this.a===0},ae.prototype.Set=function(J,q,se,ve){ve===void 0&&(ve=this.a),this.SetRGBA(J,q,se,ve)},ae.prototype.SetByteRGB=function(J,q,se){return this.r=J/255,this.g=q/255,this.b=se/255,this},ae.prototype.SetByteRGBA=function(J,q,se,ve){return this.r=J/255,this.g=q/255,this.b=se/255,this.a=ve/255,this},ae.prototype.SetRGB=function(J,q,se){return this.r=J,this.g=q,this.b=se,this},ae.prototype.SetRGBA=function(J,q,se,ve){return this.r=J,this.g=q,this.b=se,this.a=ve,this},ae.prototype.SelfAdd=function(J){return this.r+=J.r,this.g+=J.g,this.b+=J.b,this.a+=J.a,this},ae.prototype.Add=function(J,q){return q.r=this.r+J.r,q.g=this.g+J.g,q.b=this.b+J.b,q.a=this.a+J.a,q},ae.prototype.SelfSub=function(J){return this.r-=J.r,this.g-=J.g,this.b-=J.b,this.a-=J.a,this},ae.prototype.Sub=function(J,q){return q.r=this.r-J.r,q.g=this.g-J.g,q.b=this.b-J.b,q.a=this.a-J.a,q},ae.prototype.SelfMul=function(J){return this.r*=J,this.g*=J,this.b*=J,this.a*=J,this},ae.prototype.Mul=function(J,q){return q.r=this.r*J,q.g=this.g*J,q.b=this.b*J,q.a=this.a*J,q},ae.prototype.Mix=function(J,q){ae.MixColors(this,J,q)},ae.MixColors=function(J,q,se){var ve=se*(q.r-J.r),xe=se*(q.g-J.g),Ie=se*(q.b-J.b),Me=se*(q.a-J.a);J.r+=ve,J.g+=xe,J.b+=Ie,J.a+=Me,q.r-=ve,q.g-=xe,q.b-=Ie,q.a-=Me},ae.prototype.MakeStyleString=function(J){return J===void 0&&(J=this.a),ae.MakeStyleString(this.r,this.g,this.b,J)},ae.MakeStyleString=function(J,q,se,ve){return ve===void 0&&(ve=1),J*=255,q*=255,se*=255,ve<1?"rgba("+J+","+q+","+se+","+ve+")":"rgb("+J+","+q+","+se+")"},ae.ZERO=new ae(0,0,0,0),ae.RED=new ae(1,0,0),ae.GREEN=new ae(0,1,0),ae.BLUE=new ae(0,0,1),ae}();(Q=w.b2DrawFlags||(w.b2DrawFlags={}))[Q.e_none=0]="e_none",Q[Q.e_shapeBit=1]="e_shapeBit",Q[Q.e_jointBit=2]="e_jointBit",Q[Q.e_aabbBit=4]="e_aabbBit",Q[Q.e_pairBit=8]="e_pairBit",Q[Q.e_centerOfMassBit=16]="e_centerOfMassBit",Q[Q.e_particleBit=32]="e_particleBit",Q[Q.e_controllerBit=64]="e_controllerBit",Q[Q.e_all=63]="e_all";var ge=function(){function ae(){this.m_drawFlags=0}return ae.prototype.SetFlags=function(J){this.m_drawFlags=J},ae.prototype.GetFlags=function(){return this.m_drawFlags},ae.prototype.AppendFlags=function(J){this.m_drawFlags|=J},ae.prototype.ClearFlags=function(J){this.m_drawFlags&=~J},ae}(),we=function(){function ae(){this.m_start=Date.now()}return ae.prototype.Reset=function(){return this.m_start=Date.now(),this},ae.prototype.GetMilliseconds=function(){return Date.now()-this.m_start},ae}(),Te=function(){function ae(){this.m_count=0,this.m_min_count=0,this.m_max_count=0}return ae.prototype.GetCount=function(){return this.m_count},ae.prototype.GetMinCount=function(){return this.m_min_count},ae.prototype.GetMaxCount=function(){return this.m_max_count},ae.prototype.ResetCount=function(){var J=this.m_count;return this.m_count=0,J},ae.prototype.ResetMinCount=function(){this.m_min_count=0},ae.prototype.ResetMaxCount=function(){this.m_max_count=0},ae.prototype.Increment=function(){this.m_count++,this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)},ae.prototype.Decrement=function(){this.m_count--,this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)},ae}(),Ee=function(){function ae(J){this.m_stack=[],this.m_count=0,this.m_stack=V(J,function(){return null}),this.m_count=0}return ae.prototype.Reset=function(){return this.m_count=0,this},ae.prototype.Push=function(J){this.m_stack[this.m_count]=J,this.m_count++},ae.prototype.Pop=function(){this.m_count--;var J=this.m_stack[this.m_count];if(this.m_stack[this.m_count]=null,J===null)throw new Error;return J},ae.prototype.GetCount=function(){return this.m_count},ae}(),De=function(){function ae(){this.m_buffer=K.MakeArray(2),this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0}return ae.prototype.Copy=function(J){return J.m_vertices===J.m_buffer?(this.m_vertices=this.m_buffer,this.m_buffer[0].Copy(J.m_buffer[0]),this.m_buffer[1].Copy(J.m_buffer[1])):this.m_vertices=J.m_vertices,this.m_count=J.m_count,this.m_radius=J.m_radius,this},ae.prototype.Reset=function(){return this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0,this},ae.prototype.SetShape=function(J,q){J.SetupDistanceProxy(this,q)},ae.prototype.SetVerticesRadius=function(J,q,se){this.m_vertices=J,this.m_count=q,this.m_radius=se},ae.prototype.GetSupport=function(J){for(var q=0,se=K.DotVV(this.m_vertices[0],J),ve=1;ve<this.m_count;++ve){var xe=K.DotVV(this.m_vertices[ve],J);xe>se&&(q=ve,se=xe)}return q},ae.prototype.GetSupportVertex=function(J){for(var q=0,se=K.DotVV(this.m_vertices[0],J),ve=1;ve<this.m_count;++ve){var xe=K.DotVV(this.m_vertices[ve],J);xe>se&&(q=ve,se=xe)}return this.m_vertices[q]},ae.prototype.GetVertexCount=function(){return this.m_count},ae.prototype.GetVertex=function(J){return this.m_vertices[J]},ae}(),fe=function(){function ae(){this.metric=0,this.count=0,this.indexA=[0,0,0],this.indexB=[0,0,0]}return ae.prototype.Reset=function(){return this.metric=0,this.count=0,this},ae}(),Ce=function(){function ae(){this.proxyA=new De,this.proxyB=new De,this.transformA=new de,this.transformB=new de,this.useRadii=!1}return ae.prototype.Reset=function(){return this.proxyA.Reset(),this.proxyB.Reset(),this.transformA.SetIdentity(),this.transformB.SetIdentity(),this.useRadii=!1,this},ae}(),Se=function(){function ae(){this.pointA=new K,this.pointB=new K,this.distance=0,this.iterations=0}return ae.prototype.Reset=function(){return this.pointA.SetZero(),this.pointB.SetZero(),this.distance=0,this.iterations=0,this},ae}();w.b2_gjkCalls=0,w.b2_gjkIters=0,w.b2_gjkMaxIters=0;var be=function(){function ae(){this.wA=new K,this.wB=new K,this.w=new K,this.a=0,this.indexA=0,this.indexB=0}return ae.prototype.Copy=function(J){return this.wA.Copy(J.wA),this.wB.Copy(J.wB),this.w.Copy(J.w),this.a=J.a,this.indexA=J.indexA,this.indexB=J.indexB,this},ae}(),Re=function(){function ae(){this.m_v1=new be,this.m_v2=new be,this.m_v3=new be,this.m_vertices=[],this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return ae.prototype.ReadCache=function(J,q,se,ve,xe){this.m_count=J.count;for(var Ie=this.m_vertices,Me=0;Me<this.m_count;++Me){(Je=Ie[Me]).indexA=J.indexA[Me],Je.indexB=J.indexB[Me];var Le=q.GetVertex(Je.indexA),Ge=ve.GetVertex(Je.indexB);de.MulXV(se,Le,Je.wA),de.MulXV(xe,Ge,Je.wB),K.SubVV(Je.wB,Je.wA,Je.w),Je.a=0}if(this.m_count>1){var He=J.metric,Ye=this.GetMetric();(Ye<.5*He||2*He<Ye||Ye<O)&&(this.m_count=0)}var Je;this.m_count===0&&((Je=Ie[0]).indexA=0,Je.indexB=0,Le=q.GetVertex(0),Ge=ve.GetVertex(0),de.MulXV(se,Le,Je.wA),de.MulXV(xe,Ge,Je.wB),K.SubVV(Je.wB,Je.wA,Je.w),Je.a=1,this.m_count=1)},ae.prototype.WriteCache=function(J){J.metric=this.GetMetric(),J.count=this.m_count;for(var q=this.m_vertices,se=0;se<this.m_count;++se)J.indexA[se]=q[se].indexA,J.indexB[se]=q[se].indexB},ae.prototype.GetSearchDirection=function(J){switch(this.m_count){case 1:return K.NegV(this.m_v1.w,J);case 2:var q=K.SubVV(this.m_v2.w,this.m_v1.w,J);return K.CrossVV(q,K.NegV(this.m_v1.w,K.s_t0))>0?K.CrossOneV(q,J):K.CrossVOne(q,J);default:return J.SetZero()}},ae.prototype.GetClosestPoint=function(J){switch(this.m_count){case 0:return J.SetZero();case 1:return J.Copy(this.m_v1.w);case 2:return J.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:default:return J.SetZero()}},ae.prototype.GetWitnessPoints=function(J,q){switch(this.m_count){case 0:break;case 1:J.Copy(this.m_v1.wA),q.Copy(this.m_v1.wB);break;case 2:J.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,J.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,q.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,q.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:q.x=J.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,q.y=J.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y}},ae.prototype.GetMetric=function(){switch(this.m_count){case 0:case 1:return 0;case 2:return K.DistanceVV(this.m_v1.w,this.m_v2.w);case 3:return K.CrossVV(K.SubVV(this.m_v2.w,this.m_v1.w,K.s_t0),K.SubVV(this.m_v3.w,this.m_v1.w,K.s_t1));default:return 0}},ae.prototype.Solve2=function(){var J=this.m_v1.w,q=this.m_v2.w,se=K.SubVV(q,J,ae.s_e12),ve=-K.DotVV(J,se);if(ve<=0)return this.m_v1.a=1,void(this.m_count=1);var xe=K.DotVV(q,se);if(xe<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);var Ie=1/(xe+ve);this.m_v1.a=xe*Ie,this.m_v2.a=ve*Ie,this.m_count=2},ae.prototype.Solve3=function(){var J=this.m_v1.w,q=this.m_v2.w,se=this.m_v3.w,ve=K.SubVV(q,J,ae.s_e12),xe=K.DotVV(J,ve),Ie=K.DotVV(q,ve),Me=-xe,Le=K.SubVV(se,J,ae.s_e13),Ge=K.DotVV(J,Le),He=K.DotVV(se,Le),Ye=-Ge,Je=K.SubVV(se,q,ae.s_e23),ze=K.DotVV(q,Je),Ke=K.DotVV(se,Je),et=-ze,it=K.CrossVV(ve,Le),ct=it*K.CrossVV(q,se),mt=it*K.CrossVV(se,J),vt=it*K.CrossVV(J,q);if(Me<=0&&Ye<=0)return this.m_v1.a=1,void(this.m_count=1);if(Ie>0&&Me>0&&vt<=0){var Tt=1/(Ie+Me);return this.m_v1.a=Ie*Tt,this.m_v2.a=Me*Tt,void(this.m_count=2)}if(He>0&&Ye>0&&mt<=0){var wt=1/(He+Ye);return this.m_v1.a=He*wt,this.m_v3.a=Ye*wt,this.m_count=2,void this.m_v2.Copy(this.m_v3)}if(Ie<=0&&et<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);if(He<=0&&Ke<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v3);if(Ke>0&&et>0&&ct<=0){var Pt=1/(Ke+et);return this.m_v2.a=Ke*Pt,this.m_v3.a=et*Pt,this.m_count=2,void this.m_v1.Copy(this.m_v3)}var Bt=1/(ct+mt+vt);this.m_v1.a=ct*Bt,this.m_v2.a=mt*Bt,this.m_v3.a=vt*Bt,this.m_count=3},ae.s_e12=new K,ae.s_e13=new K,ae.s_e23=new K,ae}(),Ve=new Re,Pe=[0,0,0],ke=[0,0,0],Ne=new K,Ae=new K,Oe=new K,Fe=new K,nt=new K;function Ze(ae,J,q){++w.b2_gjkCalls;var se=q.proxyA,ve=q.proxyB,xe=q.transformA,Ie=q.transformB,Me=Ve;Me.ReadCache(J,se,xe,ve,Ie);for(var Le=Me.m_vertices,Ge=Pe,He=ke,Ye=0,Je=0;Je<20;){Ye=Me.m_count;for(var ze=0;ze<Ye;++ze)Ge[ze]=Le[ze].indexA,He[ze]=Le[ze].indexB;switch(Me.m_count){case 1:break;case 2:Me.Solve2();break;case 3:Me.Solve3()}if(Me.m_count===3)break;var Ke=Me.GetSearchDirection(Ae);if(Ke.LengthSquared()<R)break;var et=Le[Me.m_count];et.indexA=se.GetSupport(oe.MulTRV(xe.q,K.NegV(Ke,K.s_t0),Fe)),de.MulXV(xe,se.GetVertex(et.indexA),et.wA),et.indexB=ve.GetSupport(oe.MulTRV(Ie.q,Ke,nt)),de.MulXV(Ie,ve.GetVertex(et.indexB),et.wB),K.SubVV(et.wB,et.wA,et.w),++Je,++w.b2_gjkIters;var it=!1;for(ze=0;ze<Ye;++ze)if(et.indexA===Ge[ze]&&et.indexB===He[ze]){it=!0;break}if(it)break;++Me.m_count}if(w.b2_gjkMaxIters=X(w.b2_gjkMaxIters,Je),Me.GetWitnessPoints(ae.pointA,ae.pointB),ae.distance=K.DistanceVV(ae.pointA,ae.pointB),ae.iterations=Je,Me.WriteCache(J),q.useRadii){var ct=se.m_radius,mt=ve.m_radius;if(ae.distance>ct+mt&&ae.distance>O){ae.distance-=ct+mt;var vt=K.SubVV(ae.pointB,ae.pointA,Oe);vt.Normalize(),ae.pointA.SelfMulAdd(ct,vt),ae.pointB.SelfMulSub(mt,vt)}else{var Tt=K.MidVV(ae.pointA,ae.pointB,Ne);ae.pointA.Copy(Tt),ae.pointB.Copy(Tt),ae.distance=0}}}var Xe,$e=new K,ot=new Re,ut=new K,gt=new K,Ue=new K,We=new K,ht=new K,Be=new K;(Xe=w.b2ContactFeatureType||(w.b2ContactFeatureType={}))[Xe.e_vertex=0]="e_vertex",Xe[Xe.e_face=1]="e_face";var je,Qe=function(){function ae(){this._key=0,this._key_invalid=!1,this._indexA=0,this._indexB=0,this._typeA=0,this._typeB=0}return Object.defineProperty(ae.prototype,"key",{get:function(){return this._key_invalid&&(this._key_invalid=!1,this._key=this._indexA|this._indexB<<8|this._typeA<<16|this._typeB<<24),this._key},set:function(J){this._key=J,this._key_invalid=!1,this._indexA=255&this._key,this._indexB=this._key>>8&255,this._typeA=this._key>>16&255,this._typeB=this._key>>24&255},enumerable:!0,configurable:!0}),Object.defineProperty(ae.prototype,"indexA",{get:function(){return this._indexA},set:function(J){this._indexA=J,this._key_invalid=!0},enumerable:!0,configurable:!0}),Object.defineProperty(ae.prototype,"indexB",{get:function(){return this._indexB},set:function(J){this._indexB=J,this._key_invalid=!0},enumerable:!0,configurable:!0}),Object.defineProperty(ae.prototype,"typeA",{get:function(){return this._typeA},set:function(J){this._typeA=J,this._key_invalid=!0},enumerable:!0,configurable:!0}),Object.defineProperty(ae.prototype,"typeB",{get:function(){return this._typeB},set:function(J){this._typeB=J,this._key_invalid=!0},enumerable:!0,configurable:!0}),ae}(),st=function(){function ae(){this.cf=new Qe}return ae.prototype.Copy=function(J){return this.key=J.key,this},ae.prototype.Clone=function(){return new ae().Copy(this)},Object.defineProperty(ae.prototype,"key",{get:function(){return this.cf.key},set:function(J){this.cf.key=J},enumerable:!0,configurable:!0}),ae}(),pt=function(){function ae(){this.localPoint=new K,this.normalImpulse=0,this.tangentImpulse=0,this.id=new st}return ae.MakeArray=function(J){return V(J,function(){return new ae})},ae.prototype.Reset=function(){this.localPoint.SetZero(),this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0},ae.prototype.Copy=function(J){return this.localPoint.Copy(J.localPoint),this.normalImpulse=J.normalImpulse,this.tangentImpulse=J.tangentImpulse,this.id.Copy(J.id),this},ae}();(je=w.b2ManifoldType||(w.b2ManifoldType={}))[je.e_unknown=-1]="e_unknown",je[je.e_circles=0]="e_circles",je[je.e_faceA=1]="e_faceA",je[je.e_faceB=2]="e_faceB";var qe,rt=function(){function ae(){this.points=pt.MakeArray(E),this.localNormal=new K,this.localPoint=new K,this.type=w.b2ManifoldType.e_unknown,this.pointCount=0}return ae.prototype.Reset=function(){for(var J=0;J<E;++J)this.points[J].Reset();this.localNormal.SetZero(),this.localPoint.SetZero(),this.type=w.b2ManifoldType.e_unknown,this.pointCount=0},ae.prototype.Copy=function(J){this.pointCount=J.pointCount;for(var q=0;q<E;++q)this.points[q].Copy(J.points[q]);return this.localNormal.Copy(J.localNormal),this.localPoint.Copy(J.localPoint),this.type=J.type,this},ae.prototype.Clone=function(){return new ae().Copy(this)},ae}(),bt=function(){function ae(){this.normal=new K,this.points=K.MakeArray(E),this.separations=j(E)}return ae.prototype.Initialize=function(J,q,se,ve,xe){if(J.pointCount!==0)switch(J.type){case w.b2ManifoldType.e_circles:this.normal.Set(1,0);var Ie=de.MulXV(q,J.localPoint,ae.Initialize_s_pointA),Me=de.MulXV(ve,J.points[0].localPoint,ae.Initialize_s_pointB);K.DistanceSquaredVV(Ie,Me)>R&&K.SubVV(Me,Ie,this.normal).SelfNormalize();var Le=K.AddVMulSV(Ie,se,this.normal,ae.Initialize_s_cA),Ge=K.SubVMulSV(Me,xe,this.normal,ae.Initialize_s_cB);K.MidVV(Le,Ge,this.points[0]),this.separations[0]=K.DotVV(K.SubVV(Ge,Le,K.s_t0),this.normal);break;case w.b2ManifoldType.e_faceA:oe.MulRV(q.q,J.localNormal,this.normal);for(var He=de.MulXV(q,J.localPoint,ae.Initialize_s_planePoint),Ye=0;Ye<J.pointCount;++Ye){var Je=de.MulXV(ve,J.points[Ye].localPoint,ae.Initialize_s_clipPoint),ze=se-K.DotVV(K.SubVV(Je,He,K.s_t0),this.normal);Le=K.AddVMulSV(Je,ze,this.normal,ae.Initialize_s_cA),Ge=K.SubVMulSV(Je,xe,this.normal,ae.Initialize_s_cB),K.MidVV(Le,Ge,this.points[Ye]),this.separations[Ye]=K.DotVV(K.SubVV(Ge,Le,K.s_t0),this.normal)}break;case w.b2ManifoldType.e_faceB:for(oe.MulRV(ve.q,J.localNormal,this.normal),He=de.MulXV(ve,J.localPoint,ae.Initialize_s_planePoint),Ye=0;Ye<J.pointCount;++Ye)Je=de.MulXV(q,J.points[Ye].localPoint,ae.Initialize_s_clipPoint),ze=xe-K.DotVV(K.SubVV(Je,He,K.s_t0),this.normal),Ge=K.AddVMulSV(Je,ze,this.normal,ae.Initialize_s_cB),Le=K.SubVMulSV(Je,se,this.normal,ae.Initialize_s_cA),K.MidVV(Le,Ge,this.points[Ye]),this.separations[Ye]=K.DotVV(K.SubVV(Le,Ge,K.s_t0),this.normal);this.normal.SelfNeg()}},ae.Initialize_s_pointA=new K,ae.Initialize_s_pointB=new K,ae.Initialize_s_cA=new K,ae.Initialize_s_cB=new K,ae.Initialize_s_planePoint=new K,ae.Initialize_s_clipPoint=new K,ae}();(qe=w.b2PointState||(w.b2PointState={}))[qe.b2_nullState=0]="b2_nullState",qe[qe.b2_addState=1]="b2_addState",qe[qe.b2_persistState=2]="b2_persistState",qe[qe.b2_removeState=3]="b2_removeState";var Dt=function(){function ae(){this.v=new K,this.id=new st}return ae.MakeArray=function(J){return V(J,function(){return new ae})},ae.prototype.Copy=function(J){return this.v.Copy(J.v),this.id.Copy(J.id),this},ae}(),Et=function(){function ae(){this.p1=new K,this.p2=new K,this.maxFraction=1}return ae.prototype.Copy=function(J){return this.p1.Copy(J.p1),this.p2.Copy(J.p2),this.maxFraction=J.maxFraction,this},ae}(),Lt=function(){function ae(){this.normal=new K,this.fraction=0}return ae.prototype.Copy=function(J){return this.normal.Copy(J.normal),this.fraction=J.fraction,this},ae}(),Ot=function(){function ae(){this.lowerBound=new K,this.upperBound=new K,this.m_cache_center=new K,this.m_cache_extent=new K}return ae.prototype.Copy=function(J){return this.lowerBound.Copy(J.lowerBound),this.upperBound.Copy(J.upperBound),this},ae.prototype.IsValid=function(){var J=this.upperBound.x-this.lowerBound.x,q=this.upperBound.y-this.lowerBound.y,se=J>=0&&q>=0;return se&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},ae.prototype.GetCenter=function(){return K.MidVV(this.lowerBound,this.upperBound,this.m_cache_center)},ae.prototype.GetExtents=function(){return K.ExtVV(this.lowerBound,this.upperBound,this.m_cache_extent)},ae.prototype.GetPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))},ae.prototype.Combine1=function(J){return this.lowerBound.x=U(this.lowerBound.x,J.lowerBound.x),this.lowerBound.y=U(this.lowerBound.y,J.lowerBound.y),this.upperBound.x=X(this.upperBound.x,J.upperBound.x),this.upperBound.y=X(this.upperBound.y,J.upperBound.y),this},ae.prototype.Combine2=function(J,q){return this.lowerBound.x=U(J.lowerBound.x,q.lowerBound.x),this.lowerBound.y=U(J.lowerBound.y,q.lowerBound.y),this.upperBound.x=X(J.upperBound.x,q.upperBound.x),this.upperBound.y=X(J.upperBound.y,q.upperBound.y),this},ae.Combine=function(J,q,se){return se.Combine2(J,q),se},ae.prototype.Contains=function(J){var q=!0;return(q=(q=(q=q&&this.lowerBound.x<=J.lowerBound.x)&&this.lowerBound.y<=J.lowerBound.y)&&J.upperBound.x<=this.upperBound.x)&&J.upperBound.y<=this.upperBound.y},ae.prototype.RayCast=function(J,q){var se,ve,xe=-A,Ie=A,Me=q.p1.x,Le=q.p1.y,Ge=q.p2.x-q.p1.x,He=q.p2.y-q.p1.y,Ye=H(Ge),Je=H(He),ze=J.normal;if(Ye<O){if(Me<this.lowerBound.x||this.upperBound.x<Me)return!1}else{var Ke=1/Ge,et=-1;if((se=(this.lowerBound.x-Me)*Ke)>(ve=(this.upperBound.x-Me)*Ke)){var it=se;se=ve,ve=it,et=1}if(se>xe&&(ze.x=et,ze.y=0,xe=se),xe>(Ie=U(Ie,ve)))return!1}if(Je<O){if(Le<this.lowerBound.y||this.upperBound.y<Le)return!1}else if(Ke=1/He,et=-1,(se=(this.lowerBound.y-Le)*Ke)>(ve=(this.upperBound.y-Le)*Ke)&&(it=se,se=ve,ve=it,et=1),se>xe&&(ze.x=0,ze.y=et,xe=se),xe>(Ie=U(Ie,ve)))return!1;return!(xe<0||q.maxFraction<xe||(J.fraction=xe,0))},ae.prototype.TestContain=function(J){return!(J.x<this.lowerBound.x||this.upperBound.x<J.x||J.y<this.lowerBound.y||this.upperBound.y<J.y)},ae.prototype.TestOverlap=function(J){var q=J.lowerBound.x-this.upperBound.x,se=J.lowerBound.y-this.upperBound.y,ve=this.lowerBound.x-J.upperBound.x,xe=this.lowerBound.y-J.upperBound.y;return!(q>0||se>0||ve>0||xe>0)},ae}();function Kt(ae,J){var q=J.lowerBound.x-ae.upperBound.x,se=J.lowerBound.y-ae.upperBound.y,ve=ae.lowerBound.x-J.upperBound.x,xe=ae.lowerBound.y-J.upperBound.y;return!(q>0||se>0||ve>0||xe>0)}function Jt(ae,J,q,se,ve){var xe=0,Ie=J[0],Me=J[1],Le=K.DotVV(q,Ie.v)-se,Ge=K.DotVV(q,Me.v)-se;if(Le<=0&&ae[xe++].Copy(Ie),Ge<=0&&ae[xe++].Copy(Me),Le*Ge<0){var He=Le/(Le-Ge),Ye=ae[xe].v;Ye.x=Ie.v.x+He*(Me.v.x-Ie.v.x),Ye.y=Ie.v.y+He*(Me.v.y-Ie.v.y);var Je=ae[xe].id;Je.cf.indexA=ve,Je.cf.indexB=Ie.id.cf.indexB,Je.cf.typeA=w.b2ContactFeatureType.e_vertex,Je.cf.typeB=w.b2ContactFeatureType.e_face,++xe}return xe}var Yt=new Ce,Wt=new fe,rr=new Se;function Ft(ae,J,q,se,ve,xe){var Ie=Yt.Reset();Ie.proxyA.SetShape(ae,J),Ie.proxyB.SetShape(q,se),Ie.transformA.Copy(ve),Ie.transformB.Copy(xe),Ie.useRadii=!0;var Me=Wt.Reset();Me.count=0;var Le=rr.Reset();return Ze(Le,Me,Ie),Le.distance<10*O}function zt(ae){if(ae===null)throw new Error;return ae}var lr=function(){function ae(J){J===void 0&&(J=0),this.m_id=0,this.aabb=new Ot,this.parent=null,this.child1=null,this.child2=null,this.height=0,this.m_id=J}return ae.prototype.IsLeaf=function(){return this.child1===null},ae}(),nr=function(){function ae(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0,this.m_stack=new Ee(256)}return ae.prototype.Query=function(J,q){if(this.m_root!==null){var se=this.m_stack.Reset();for(se.Push(this.m_root);se.GetCount()>0;){var ve=se.Pop();if(ve.aabb.TestOverlap(J))if(ve.IsLeaf()){if(!q(ve))return}else se.Push(zt(ve.child1)),se.Push(zt(ve.child2))}}},ae.prototype.QueryPoint=function(J,q){if(this.m_root!==null){var se=this.m_stack.Reset();for(se.Push(this.m_root);se.GetCount()>0;){var ve=se.Pop();if(ve.aabb.TestContain(J))if(ve.IsLeaf()){if(!q(ve))return}else se.Push(zt(ve.child1)),se.Push(zt(ve.child2))}}},ae.prototype.RayCast=function(J,q){if(this.m_root!==null){var se=J.p1,ve=J.p2,xe=K.SubVV(ve,se,ae.s_r);xe.Normalize();var Ie=K.CrossOneV(xe,ae.s_v),Me=K.AbsV(Ie,ae.s_abs_v),Le=J.maxFraction,Ge=ae.s_segmentAABB,He=se.x+Le*(ve.x-se.x),Ye=se.y+Le*(ve.y-se.y);Ge.lowerBound.x=U(se.x,He),Ge.lowerBound.y=U(se.y,Ye),Ge.upperBound.x=X(se.x,He),Ge.upperBound.y=X(se.y,Ye);var Je=this.m_stack.Reset();for(Je.Push(this.m_root);Je.GetCount()>0;){var ze=Je.Pop();if(Kt(ze.aabb,Ge)){var Ke=ze.aabb.GetCenter(),et=ze.aabb.GetExtents();if(!(H(K.DotVV(Ie,K.SubVV(se,Ke,K.s_t0)))-K.DotVV(Me,et)>0))if(ze.IsLeaf()){var it=ae.s_subInput;it.p1.Copy(J.p1),it.p2.Copy(J.p2),it.maxFraction=Le;var ct=q(it,ze);if(ct===0)return;ct>0&&(Le=ct,He=se.x+Le*(ve.x-se.x),Ye=se.y+Le*(ve.y-se.y),Ge.lowerBound.x=U(se.x,He),Ge.lowerBound.y=U(se.y,Ye),Ge.upperBound.x=X(se.x,He),Ge.upperBound.y=X(se.y,Ye))}else Je.Push(zt(ze.child1)),Je.Push(zt(ze.child2))}}}},ae.prototype.AllocateNode=function(){if(this.m_freeList){var J=this.m_freeList;return this.m_freeList=J.parent,J.parent=null,J.child1=null,J.child2=null,J.height=0,delete J.userData,J}return new lr(ae.s_node_id++)},ae.prototype.FreeNode=function(J){J.parent=this.m_freeList,J.child1=null,J.child2=null,J.height=-1,delete J.userData,this.m_freeList=J},ae.prototype.CreateProxy=function(J,q){var se=this.AllocateNode();return se.aabb.lowerBound.x=J.lowerBound.x-.1,se.aabb.lowerBound.y=J.lowerBound.y-.1,se.aabb.upperBound.x=J.upperBound.x+.1,se.aabb.upperBound.y=J.upperBound.y+.1,se.userData=q,se.height=0,this.InsertLeaf(se),se},ae.prototype.DestroyProxy=function(J){this.RemoveLeaf(J),this.FreeNode(J)},ae.prototype.MoveProxy=function(J,q,se){if(J.aabb.Contains(q))return!1;this.RemoveLeaf(J);var ve=.1+2*(se.x>0?se.x:-se.x),xe=.1+2*(se.y>0?se.y:-se.y);return J.aabb.lowerBound.x=q.lowerBound.x-ve,J.aabb.lowerBound.y=q.lowerBound.y-xe,J.aabb.upperBound.x=q.upperBound.x+ve,J.aabb.upperBound.y=q.upperBound.y+xe,this.InsertLeaf(J),!0},ae.prototype.InsertLeaf=function(J){if(++this.m_insertionCount,this.m_root===null)return this.m_root=J,void(this.m_root.parent=null);for(var q=J.aabb,se=this.m_root;!se.IsLeaf();){var ve=zt(se.child1),xe=zt(se.child2),Ie=se.aabb.GetPerimeter(),Me=ae.s_combinedAABB;Me.Combine2(se.aabb,q);var Le=Me.GetPerimeter(),Ge=2*Le,He=2*(Le-Ie),Ye=void 0,Je=ae.s_aabb,ze=void 0;ve.IsLeaf()?(Je.Combine2(q,ve.aabb),Ye=Je.GetPerimeter()+He):(Je.Combine2(q,ve.aabb),ze=ve.aabb.GetPerimeter(),Ye=Je.GetPerimeter()-ze+He);var Ke=void 0;if(xe.IsLeaf()?(Je.Combine2(q,xe.aabb),Ke=Je.GetPerimeter()+He):(Je.Combine2(q,xe.aabb),ze=xe.aabb.GetPerimeter(),Ke=Je.GetPerimeter()-ze+He),Ge<Ye&&Ge<Ke)break;se=Ye<Ke?ve:xe}var et=se,it=et.parent,ct=this.AllocateNode();ct.parent=it,delete ct.userData,ct.aabb.Combine2(q,et.aabb),ct.height=et.height+1,it?(it.child1===et?it.child1=ct:it.child2=ct,ct.child1=et,ct.child2=J,et.parent=ct,J.parent=ct):(ct.child1=et,ct.child2=J,et.parent=ct,J.parent=ct,this.m_root=ct);for(var mt=J.parent;mt!==null;)ve=zt((mt=this.Balance(mt)).child1),xe=zt(mt.child2),mt.height=1+X(ve.height,xe.height),mt.aabb.Combine2(ve.aabb,xe.aabb),mt=mt.parent},ae.prototype.RemoveLeaf=function(J){if(J!==this.m_root){var q,se=zt(J.parent),ve=se&&se.parent;if(q=se.child1===J?zt(se.child2):zt(se.child1),ve){ve.child1===se?ve.child1=q:ve.child2=q,q.parent=ve,this.FreeNode(se);for(var xe=ve;xe;){var Ie=zt((xe=this.Balance(xe)).child1),Me=zt(xe.child2);xe.aabb.Combine2(Ie.aabb,Me.aabb),xe.height=1+X(Ie.height,Me.height),xe=xe.parent}}else this.m_root=q,q.parent=null,this.FreeNode(se)}else this.m_root=null},ae.prototype.Balance=function(J){if(J.IsLeaf()||J.height<2)return J;var q=zt(J.child1),se=zt(J.child2),ve=se.height-q.height;if(ve>1){var xe=zt(se.child1),Ie=zt(se.child2);return se.child1=J,se.parent=J.parent,J.parent=se,se.parent!==null?se.parent.child1===J?se.parent.child1=se:se.parent.child2=se:this.m_root=se,xe.height>Ie.height?(se.child2=xe,J.child2=Ie,Ie.parent=J,J.aabb.Combine2(q.aabb,Ie.aabb),se.aabb.Combine2(J.aabb,xe.aabb),J.height=1+X(q.height,Ie.height),se.height=1+X(J.height,xe.height)):(se.child2=Ie,J.child2=xe,xe.parent=J,J.aabb.Combine2(q.aabb,xe.aabb),se.aabb.Combine2(J.aabb,Ie.aabb),J.height=1+X(q.height,xe.height),se.height=1+X(J.height,Ie.height)),se}if(ve<-1){var Me=zt(q.child1),Le=zt(q.child2);return q.child1=J,q.parent=J.parent,J.parent=q,q.parent!==null?q.parent.child1===J?q.parent.child1=q:q.parent.child2=q:this.m_root=q,Me.height>Le.height?(q.child2=Me,J.child1=Le,Le.parent=J,J.aabb.Combine2(se.aabb,Le.aabb),q.aabb.Combine2(J.aabb,Me.aabb),J.height=1+X(se.height,Le.height),q.height=1+X(J.height,Me.height)):(q.child2=Le,J.child1=Me,Me.parent=J,J.aabb.Combine2(se.aabb,Me.aabb),q.aabb.Combine2(J.aabb,Le.aabb),J.height=1+X(se.height,Me.height),q.height=1+X(J.height,Le.height)),q}return J},ae.prototype.GetHeight=function(){return this.m_root===null?0:this.m_root.height},ae.GetAreaNode=function(J){if(J===null||J.IsLeaf())return 0;var q=J.aabb.GetPerimeter();return(q+=ae.GetAreaNode(J.child1))+ae.GetAreaNode(J.child2)},ae.prototype.GetAreaRatio=function(){if(this.m_root===null)return 0;var J=this.m_root.aabb.GetPerimeter();return ae.GetAreaNode(this.m_root)/J},ae.prototype.ComputeHeightNode=function(J){if(!J||J.IsLeaf())return 0;var q=this.ComputeHeightNode(J.child1),se=this.ComputeHeightNode(J.child2);return 1+X(q,se)},ae.prototype.ComputeHeight=function(){return this.ComputeHeightNode(this.m_root)},ae.prototype.ValidateStructure=function(J){if(J!==null){this.m_root;var q=J;if(!q.IsLeaf()){var se=zt(q.child1),ve=zt(q.child2);this.ValidateStructure(se),this.ValidateStructure(ve)}}},ae.prototype.ValidateMetrics=function(J){if(J!==null){var q=J;if(!q.IsLeaf()){var se=zt(q.child1),ve=zt(q.child2);ae.s_aabb.Combine2(se.aabb,ve.aabb),this.ValidateMetrics(se),this.ValidateMetrics(ve)}}},ae.prototype.Validate=function(){},ae.GetMaxBalanceNode=function(J,q){if(J===null||J.height<=1)return q;var se=zt(J.child1),ve=zt(J.child2),xe=H(ve.height-se.height);return X(q,xe)},ae.prototype.GetMaxBalance=function(){return ae.GetMaxBalanceNode(this.m_root,0)},ae.prototype.RebuildBottomUp=function(){this.Validate()},ae.ShiftOriginNode=function(J,q){if(J!==null&&!(J.height<=1)){var se=J.child1,ve=J.child2;ae.ShiftOriginNode(se,q),ae.ShiftOriginNode(ve,q),J.aabb.lowerBound.SelfSub(q),J.aabb.upperBound.SelfSub(q)}},ae.prototype.ShiftOrigin=function(J){ae.ShiftOriginNode(this.m_root,J)},ae.s_r=new K,ae.s_v=new K,ae.s_abs_v=new K,ae.s_segmentAABB=new Ot,ae.s_subInput=new Et,ae.s_combinedAABB=new Ot,ae.s_aabb=new Ot,ae.s_node_id=0,ae}(),tt=function(ae,J){this.proxyA=ae,this.proxyB=J},ft=function(){function ae(){this.m_tree=new nr,this.m_proxyCount=0,this.m_moveCount=0,this.m_moveBuffer=[],this.m_pairCount=0,this.m_pairBuffer=[]}return ae.prototype.CreateProxy=function(J,q){var se=this.m_tree.CreateProxy(J,q);return++this.m_proxyCount,this.BufferMove(se),se},ae.prototype.DestroyProxy=function(J){this.UnBufferMove(J),--this.m_proxyCount,this.m_tree.DestroyProxy(J)},ae.prototype.MoveProxy=function(J,q,se){this.m_tree.MoveProxy(J,q,se)&&this.BufferMove(J)},ae.prototype.TouchProxy=function(J){this.BufferMove(J)},ae.prototype.GetProxyCount=function(){return this.m_proxyCount},ae.prototype.UpdatePairs=function(J){var q=this;this.m_pairCount=0;for(var se=function(Ye){var Je=ve.m_moveBuffer[Ye];if(Je===null)return"continue";var ze=Je.aabb;ve.m_tree.Query(ze,function(Ke){if(Ke.m_id===Je.m_id)return!0;var et,it;if(Ke.m_id<Je.m_id?(et=Ke,it=Je):(et=Je,it=Ke),q.m_pairCount===q.m_pairBuffer.length)q.m_pairBuffer[q.m_pairCount]=new tt(et,it);else{var ct=q.m_pairBuffer[q.m_pairCount];ct.proxyA=et,ct.proxyB=it}return++q.m_pairCount,!0})},ve=this,xe=0;xe<this.m_moveCount;++xe)se(xe);this.m_moveCount=0,this.m_pairBuffer.length=this.m_pairCount,this.m_pairBuffer.sort(lt);for(var Ie=0;Ie<this.m_pairCount;){var Me=this.m_pairBuffer[Ie],Le=Me.proxyA.userData,Ge=Me.proxyB.userData;for(Le&&Ge&&J(Le,Ge),++Ie;Ie<this.m_pairCount;){var He=this.m_pairBuffer[Ie];if(He.proxyA.m_id!==Me.proxyA.m_id||He.proxyB.m_id!==Me.proxyB.m_id)break;++Ie}}},ae.prototype.Query=function(J,q){this.m_tree.Query(J,q)},ae.prototype.QueryPoint=function(J,q){this.m_tree.QueryPoint(J,q)},ae.prototype.RayCast=function(J,q){this.m_tree.RayCast(J,q)},ae.prototype.GetTreeHeight=function(){return this.m_tree.GetHeight()},ae.prototype.GetTreeBalance=function(){return this.m_tree.GetMaxBalance()},ae.prototype.GetTreeQuality=function(){return this.m_tree.GetAreaRatio()},ae.prototype.ShiftOrigin=function(J){this.m_tree.ShiftOrigin(J)},ae.prototype.BufferMove=function(J){this.m_moveBuffer[this.m_moveCount]=J,++this.m_moveCount},ae.prototype.UnBufferMove=function(J){var q=this.m_moveBuffer.indexOf(J);this.m_moveBuffer[q]=null},ae}();function lt(ae,J){return ae.proxyA.m_id===J.proxyA.m_id?ae.proxyB.m_id-J.proxyB.m_id:ae.proxyA.m_id-J.proxyA.m_id}w.b2_toiTime=0,w.b2_toiMaxTime=0,w.b2_toiCalls=0,w.b2_toiIters=0,w.b2_toiMaxIters=0,w.b2_toiRootIters=0,w.b2_toiMaxRootIters=0;var at,dt=new de,_t=new de,Ct=new K,It=new K,xt=new K,yt=new K,At=new K,Rt=function(){this.proxyA=new De,this.proxyB=new De,this.sweepA=new me,this.sweepB=new me,this.tMax=0};(at=w.b2TOIOutputState||(w.b2TOIOutputState={}))[at.e_unknown=0]="e_unknown",at[at.e_failed=1]="e_failed",at[at.e_overlapped=2]="e_overlapped",at[at.e_touching=3]="e_touching",at[at.e_separated=4]="e_separated";var Gt,Mt=function(){this.state=w.b2TOIOutputState.e_unknown,this.t=0};(Gt=w.b2SeparationFunctionType||(w.b2SeparationFunctionType={}))[Gt.e_unknown=-1]="e_unknown",Gt[Gt.e_points=0]="e_points",Gt[Gt.e_faceA=1]="e_faceA",Gt[Gt.e_faceB=2]="e_faceB";var Nt=function(){function ae(){this.m_sweepA=new me,this.m_sweepB=new me,this.m_type=w.b2SeparationFunctionType.e_unknown,this.m_localPoint=new K,this.m_axis=new K}return ae.prototype.Initialize=function(J,q,se,ve,xe,Ie){this.m_proxyA=q,this.m_proxyB=ve;var Me=J.count;this.m_sweepA.Copy(se),this.m_sweepB.Copy(xe);var Le=dt,Ge=_t;if(this.m_sweepA.GetTransform(Le,Ie),this.m_sweepB.GetTransform(Ge,Ie),Me===1){this.m_type=w.b2SeparationFunctionType.e_points;var He=this.m_proxyA.GetVertex(J.indexA[0]),Ye=this.m_proxyB.GetVertex(J.indexB[0]),Je=de.MulXV(Le,He,Ct),ze=de.MulXV(Ge,Ye,It);K.SubVV(ze,Je,this.m_axis);var Ke=this.m_axis.Normalize();return this.m_localPoint.SetZero(),Ke}if(J.indexA[0]===J.indexA[1]){this.m_type=w.b2SeparationFunctionType.e_faceB;var et=this.m_proxyB.GetVertex(J.indexB[0]),it=this.m_proxyB.GetVertex(J.indexB[1]);K.CrossVOne(K.SubVV(it,et,K.s_t0),this.m_axis).SelfNormalize();var ct=oe.MulRV(Ge.q,this.m_axis,xt);return K.MidVV(et,it,this.m_localPoint),ze=de.MulXV(Ge,this.m_localPoint,It),He=this.m_proxyA.GetVertex(J.indexA[0]),Je=de.MulXV(Le,He,Ct),(Ke=K.DotVV(K.SubVV(Je,ze,K.s_t0),ct))<0&&(this.m_axis.SelfNeg(),Ke=-Ke),Ke}this.m_type=w.b2SeparationFunctionType.e_faceA;var mt=this.m_proxyA.GetVertex(J.indexA[0]),vt=this.m_proxyA.GetVertex(J.indexA[1]);return K.CrossVOne(K.SubVV(vt,mt,K.s_t0),this.m_axis).SelfNormalize(),ct=oe.MulRV(Le.q,this.m_axis,xt),K.MidVV(mt,vt,this.m_localPoint),Je=de.MulXV(Le,this.m_localPoint,Ct),Ye=this.m_proxyB.GetVertex(J.indexB[0]),ze=de.MulXV(Ge,Ye,It),(Ke=K.DotVV(K.SubVV(ze,Je,K.s_t0),ct))<0&&(this.m_axis.SelfNeg(),Ke=-Ke),Ke},ae.prototype.FindMinSeparation=function(J,q,se){var ve=dt,xe=_t;switch(this.m_sweepA.GetTransform(ve,se),this.m_sweepB.GetTransform(xe,se),this.m_type){case w.b2SeparationFunctionType.e_points:var Ie=oe.MulTRV(ve.q,this.m_axis,yt),Me=oe.MulTRV(xe.q,K.NegV(this.m_axis,K.s_t0),At);J[0]=this.m_proxyA.GetSupport(Ie),q[0]=this.m_proxyB.GetSupport(Me);var Le=this.m_proxyA.GetVertex(J[0]),Ge=this.m_proxyB.GetVertex(q[0]),He=de.MulXV(ve,Le,Ct),Ye=de.MulXV(xe,Ge,It);return K.DotVV(K.SubVV(Ye,He,K.s_t0),this.m_axis);case w.b2SeparationFunctionType.e_faceA:var Je=oe.MulRV(ve.q,this.m_axis,xt);return He=de.MulXV(ve,this.m_localPoint,Ct),Me=oe.MulTRV(xe.q,K.NegV(Je,K.s_t0),At),J[0]=-1,q[0]=this.m_proxyB.GetSupport(Me),Ge=this.m_proxyB.GetVertex(q[0]),Ye=de.MulXV(xe,Ge,It),K.DotVV(K.SubVV(Ye,He,K.s_t0),Je);case w.b2SeparationFunctionType.e_faceB:return Je=oe.MulRV(xe.q,this.m_axis,xt),Ye=de.MulXV(xe,this.m_localPoint,It),Ie=oe.MulTRV(ve.q,K.NegV(Je,K.s_t0),yt),q[0]=-1,J[0]=this.m_proxyA.GetSupport(Ie),Le=this.m_proxyA.GetVertex(J[0]),He=de.MulXV(ve,Le,Ct),K.DotVV(K.SubVV(He,Ye,K.s_t0),Je);default:return J[0]=-1,q[0]=-1,0}},ae.prototype.Evaluate=function(J,q,se){var ve=dt,xe=_t;switch(this.m_sweepA.GetTransform(ve,se),this.m_sweepB.GetTransform(xe,se),this.m_type){case w.b2SeparationFunctionType.e_points:var Ie=this.m_proxyA.GetVertex(J),Me=this.m_proxyB.GetVertex(q),Le=de.MulXV(ve,Ie,Ct),Ge=de.MulXV(xe,Me,It);return K.DotVV(K.SubVV(Ge,Le,K.s_t0),this.m_axis);case w.b2SeparationFunctionType.e_faceA:var He=oe.MulRV(ve.q,this.m_axis,xt);return Le=de.MulXV(ve,this.m_localPoint,Ct),Me=this.m_proxyB.GetVertex(q),Ge=de.MulXV(xe,Me,It),K.DotVV(K.SubVV(Ge,Le,K.s_t0),He);case w.b2SeparationFunctionType.e_faceB:return He=oe.MulRV(xe.q,this.m_axis,xt),Ge=de.MulXV(xe,this.m_localPoint,It),Ie=this.m_proxyA.GetVertex(J),Le=de.MulXV(ve,Ie,Ct),K.DotVV(K.SubVV(Le,Ge,K.s_t0),He);default:return 0}},ae}(),kt=new we,er=new fe,hr=new Ce,cr=new Se,xr=new Nt,Ar=[0],Er=[0],br=new me,gr=new me;function Dr(ae,J){var q=kt.Reset();++w.b2_toiCalls,ae.state=w.b2TOIOutputState.e_unknown,ae.t=J.tMax;var se=J.proxyA,ve=J.proxyB,xe=br.Copy(J.sweepA),Ie=gr.Copy(J.sweepB);xe.Normalize(),Ie.Normalize();var Me=J.tMax,Le=se.m_radius+ve.m_radius,Ge=X(I,Le-3*I),He=.25*I,Ye=0,Je=0,ze=er;ze.count=0;var Ke=hr;for(Ke.proxyA.Copy(J.proxyA),Ke.proxyB.Copy(J.proxyB),Ke.useRadii=!1;;){var et=dt,it=_t;xe.GetTransform(et,Ye),Ie.GetTransform(it,Ye),Ke.transformA.Copy(et),Ke.transformB.Copy(it);var ct=cr;if(Ze(ct,ze,Ke),ct.distance<=0){ae.state=w.b2TOIOutputState.e_overlapped,ae.t=0;break}if(ct.distance<Ge+He){ae.state=w.b2TOIOutputState.e_touching,ae.t=Ye;break}var mt=xr;mt.Initialize(ze,se,xe,ve,Ie,Ye);for(var vt=!1,Tt=Me,wt=0;;){var Pt=Ar,Bt=Er,jt=mt.FindMinSeparation(Pt,Bt,Tt);if(jt>Ge+He){ae.state=w.b2TOIOutputState.e_separated,ae.t=Me,vt=!0;break}if(jt>Ge-He){Ye=Tt;break}var Xt=mt.Evaluate(Pt[0],Bt[0],Ye);if(Xt<Ge-He){ae.state=w.b2TOIOutputState.e_failed,ae.t=Ye,vt=!0;break}if(Xt<=Ge+He){ae.state=w.b2TOIOutputState.e_touching,ae.t=Ye,vt=!0;break}for(var Ht=0,$t=Ye,Qt=Tt;;){var ur;ur=1&Ht?$t+(Ge-Xt)*(Qt-$t)/(jt-Xt):.5*($t+Qt),++Ht,++w.b2_toiRootIters;var tr=mt.Evaluate(Pt[0],Bt[0],ur);if(H(tr-Ge)<He){Tt=ur;break}if(tr>Ge?($t=ur,Xt=tr):(Qt=ur,jt=tr),Ht===50)break}if(w.b2_toiMaxRootIters=X(w.b2_toiMaxRootIters,Ht),++wt===D)break}if(++Je,++w.b2_toiIters,vt)break;if(Je===20){ae.state=w.b2TOIOutputState.e_failed,ae.t=Ye;break}}w.b2_toiMaxIters=X(w.b2_toiMaxIters,Je);var qt=q.GetMilliseconds();w.b2_toiMaxTime=X(w.b2_toiMaxTime,qt),w.b2_toiTime+=qt}var Ir=new K,$r=new K;function Br(ae,J,q,se,ve){ae.pointCount=0;var xe=de.MulXV(q,J.m_p,Ir),Ie=de.MulXV(ve,se.m_p,$r),Me=K.DistanceSquaredVV(xe,Ie),Le=J.m_radius+se.m_radius;Me>Le*Le||(ae.type=w.b2ManifoldType.e_circles,ae.localPoint.Copy(J.m_p),ae.localNormal.SetZero(),ae.pointCount=1,ae.points[0].localPoint.Copy(se.m_p),ae.points[0].id.key=0)}var Qr=new K,yi=new K,xi=new K;function ui(ae,J,q,se,ve){ae.pointCount=0;for(var xe=de.MulXV(ve,se.m_p,Qr),Ie=de.MulTXV(q,xe,yi),Me=0,Le=-A,Ge=J.m_radius+se.m_radius,He=J.m_count,Ye=J.m_vertices,Je=J.m_normals,ze=0;ze<He;++ze){var Ke=K.DotVV(Je[ze],K.SubVV(Ie,Ye[ze],K.s_t0));if(Ke>Ge)return;Ke>Le&&(Le=Ke,Me=ze)}var et=Me,it=(et+1)%He,ct=Ye[et],mt=Ye[it];if(Le<O)return ae.pointCount=1,ae.type=w.b2ManifoldType.e_faceA,ae.localNormal.Copy(Je[Me]),K.MidVV(ct,mt,ae.localPoint),ae.points[0].localPoint.Copy(se.m_p),void(ae.points[0].id.key=0);var vt=K.DotVV(K.SubVV(Ie,ct,K.s_t0),K.SubVV(mt,ct,K.s_t1)),Tt=K.DotVV(K.SubVV(Ie,mt,K.s_t0),K.SubVV(ct,mt,K.s_t1));if(vt<=0){if(K.DistanceSquaredVV(Ie,ct)>Ge*Ge)return;ae.pointCount=1,ae.type=w.b2ManifoldType.e_faceA,K.SubVV(Ie,ct,ae.localNormal).SelfNormalize(),ae.localPoint.Copy(ct),ae.points[0].localPoint.Copy(se.m_p),ae.points[0].id.key=0}else if(Tt<=0){if(K.DistanceSquaredVV(Ie,mt)>Ge*Ge)return;ae.pointCount=1,ae.type=w.b2ManifoldType.e_faceA,K.SubVV(Ie,mt,ae.localNormal).SelfNormalize(),ae.localPoint.Copy(mt),ae.points[0].localPoint.Copy(se.m_p),ae.points[0].id.key=0}else{var wt=K.MidVV(ct,mt,xi);if(K.DotVV(K.SubVV(Ie,wt,K.s_t1),Je[et])>Ge)return;ae.pointCount=1,ae.type=w.b2ManifoldType.e_faceA,ae.localNormal.Copy(Je[et]).SelfNormalize(),ae.localPoint.Copy(wt),ae.points[0].localPoint.Copy(se.m_p),ae.points[0].id.key=0}}var Hi=new K,Xi=new K,ha=new K,fa=new K;function Yi(ae,J,q,se,ve){for(var xe=ae.m_vertices,Ie=ae.m_normals,Me=se.m_count,Le=se.m_vertices,Ge=oe.MulRV(J.q,Ie[q],Hi),He=oe.MulTRV(ve.q,Ge,Xi),Ye=0,Je=A,ze=0;ze<Me;++ze){var Ke=K.DotVV(Le[ze],He);Ke<Je&&(Je=Ke,Ye=ze)}var et=de.MulXV(J,xe[q],ha),it=de.MulXV(ve,Le[Ye],fa);return K.DotVV(K.SubVV(it,et,K.s_t0),Ge)}var da=new K,pa=new K;function Yn(ae,J,q,se,ve){for(var xe=J.m_count,Ie=J.m_normals,Me=K.SubVV(de.MulXV(ve,se.m_centroid,K.s_t0),de.MulXV(q,J.m_centroid,K.s_t1),da),Le=oe.MulTRV(q.q,Me,pa),Ge=0,He=-A,Ye=0;Ye<xe;++Ye){var Je=K.DotVV(Ie[Ye],Le);Je>He&&(He=Je,Ge=Ye)}var ze=Yi(J,q,Ge,se,ve),Ke=(Ge+xe-1)%xe,et=Yi(J,q,Ke,se,ve),it=(Ge+1)%xe,ct=Yi(J,q,it,se,ve),mt=0,vt=0,Tt=0;if(et>ze&&et>ct)Tt=-1,mt=Ke,vt=et;else{if(!(ct>ze))return ae[0]=Ge,ze;Tt=1,mt=it,vt=ct}for(;(ze=Yi(J,q,Ge=Tt===-1?(mt+xe-1)%xe:(mt+1)%xe,se,ve))>vt;)mt=Ge,vt=ze;return ae[0]=mt,vt}var _a=new K;function ma(ae,J,q,se,ve,xe){for(var Ie=J.m_normals,Me=ve.m_count,Le=ve.m_vertices,Ge=ve.m_normals,He=oe.MulTRV(xe.q,oe.MulRV(q.q,Ie[se],K.s_t0),_a),Ye=0,Je=A,ze=0;ze<Me;++ze){var Ke=K.DotVV(He,Ge[ze]);Ke<Je&&(Je=Ke,Ye=ze)}var et=Ye,it=(et+1)%Me,ct=ae[0];de.MulXV(xe,Le[et],ct.v);var mt=ct.id.cf;mt.indexA=se,mt.indexB=et,mt.typeA=w.b2ContactFeatureType.e_face,mt.typeB=w.b2ContactFeatureType.e_vertex;var vt=ae[1];de.MulXV(xe,Le[it],vt.v);var Tt=vt.id.cf;Tt.indexA=se,Tt.indexB=it,Tt.typeA=w.b2ContactFeatureType.e_face,Tt.typeB=w.b2ContactFeatureType.e_vertex}var ga=Dt.MakeArray(2),va=Dt.MakeArray(2),ya=Dt.MakeArray(2),xa=[0],ba=[0],Ca=new K,Ta=new K,Sa=new K,wa=new K,Aa=new K,Ea=new K,Da=new K,Ia=new K;function Wn(ae,J,q,se,ve){ae.pointCount=0;var xe=J.m_radius+se.m_radius,Ie=xa;Ie[0]=0;var Me=Yn(Ie,J,q,se,ve);if(!(Me>xe)){var Le=ba;Le[0]=0;var Ge=Yn(Le,se,ve,J,q);if(!(Ge>xe)){var He,Ye,Je,ze,Ke=0,et=0;Ge>.98*Me+.001?(He=se,Ye=J,Je=ve,ze=q,Ke=Le[0],ae.type=w.b2ManifoldType.e_faceB,et=1):(He=J,Ye=se,Je=q,ze=ve,Ke=Ie[0],ae.type=w.b2ManifoldType.e_faceA,et=0);var it=ga;ma(it,He,Je,Ke,Ye,ze);var ct=He.m_count,mt=He.m_vertices,vt=Ke,Tt=(Ke+1)%ct,wt=mt[vt],Pt=mt[Tt],Bt=K.SubVV(Pt,wt,Ca);Bt.Normalize();var jt=K.CrossVOne(Bt,Ta),Xt=K.MidVV(wt,Pt,Sa),Ht=oe.MulRV(Je.q,Bt,Aa),$t=K.CrossVOne(Ht,wa),Qt=de.MulXV(Je,wt,Da),ur=de.MulXV(Je,Pt,Ia),tr=K.DotVV($t,Qt),qt=-K.DotVV(Ht,Qt)+xe,ar=K.DotVV(Ht,ur)+xe,or=va,vr=ya;if(!(Jt(or,it,K.NegV(Ht,Ea),qt,vt)<2||Jt(vr,or,Ht,ar,Tt)<2)){ae.localNormal.Copy(jt),ae.localPoint.Copy(Xt);for(var mr=0,wr=0;wr<E;++wr){var Tr=vr[wr];if(K.DotVV($t,Tr.v)-tr<=xe){var yr=ae.points[mr];if(de.MulTXV(ze,Tr.v,yr.localPoint),yr.id.Copy(Tr.id),et){var Rr=yr.id.cf;yr.id.cf.indexA=Rr.indexB,yr.id.cf.indexB=Rr.indexA,yr.id.cf.typeA=Rr.typeB,yr.id.cf.typeB=Rr.typeA}++mr}}ae.pointCount=mr}}}}var Pa=new K,Ba=new K,hn=new K,La=new K,Ra=new K,Oa=new K,Ma=new K,Na=new st;function fn(ae,J,q,se,ve){ae.pointCount=0;var xe=de.MulTXV(q,de.MulXV(ve,se.m_p,K.s_t0),Pa),Ie=J.m_vertex1,Me=J.m_vertex2,Le=K.SubVV(Me,Ie,Ba),Ge=K.DotVV(Le,K.SubVV(Me,xe,K.s_t0)),He=K.DotVV(Le,K.SubVV(xe,Ie,K.s_t0)),Ye=J.m_radius+se.m_radius,Je=Na;if(Je.cf.indexB=0,Je.cf.typeB=w.b2ContactFeatureType.e_vertex,He<=0){var ze=Ie,Ke=K.SubVV(xe,ze,hn);if(K.DotVV(Ke,Ke)>Ye*Ye)return;if(J.m_hasVertex0){var et=J.m_vertex0,it=Ie,ct=K.SubVV(it,et,La);if(K.DotVV(ct,K.SubVV(it,xe,K.s_t0))>0)return}return Je.cf.indexA=0,Je.cf.typeA=w.b2ContactFeatureType.e_vertex,ae.pointCount=1,ae.type=w.b2ManifoldType.e_circles,ae.localNormal.SetZero(),ae.localPoint.Copy(ze),ae.points[0].id.Copy(Je),void ae.points[0].localPoint.Copy(se.m_p)}if(Ge<=0){var mt=Me,vt=K.SubVV(xe,mt,hn);if(K.DotVV(vt,vt)>Ye*Ye)return;if(J.m_hasVertex3){var Tt=J.m_vertex3,wt=Me,Pt=K.SubVV(Tt,wt,Ra);if(K.DotVV(Pt,K.SubVV(xe,wt,K.s_t0))>0)return}return Je.cf.indexA=1,Je.cf.typeA=w.b2ContactFeatureType.e_vertex,ae.pointCount=1,ae.type=w.b2ManifoldType.e_circles,ae.localNormal.SetZero(),ae.localPoint.Copy(mt),ae.points[0].id.Copy(Je),void ae.points[0].localPoint.Copy(se.m_p)}var Bt=K.DotVV(Le,Le),jt=Oa;jt.x=1/Bt*(Ge*Ie.x+He*Me.x),jt.y=1/Bt*(Ge*Ie.y+He*Me.y);var Xt=K.SubVV(xe,jt,hn);if(!(K.DotVV(Xt,Xt)>Ye*Ye)){var Ht=Ma.Set(-Le.y,Le.x);K.DotVV(Ht,K.SubVV(xe,Ie,K.s_t0))<0&&Ht.Set(-Ht.x,-Ht.y),Ht.Normalize(),Je.cf.indexA=0,Je.cf.typeA=w.b2ContactFeatureType.e_face,ae.pointCount=1,ae.type=w.b2ManifoldType.e_faceA,ae.localNormal.Copy(Ht),ae.localPoint.Copy(Ie),ae.points[0].id.Copy(Je),ae.points[0].localPoint.Copy(se.m_p)}}var zn=function(){this.type=0,this.index=0,this.separation=0},ka=function(){this.vertices=K.MakeArray(D),this.normals=K.MakeArray(D),this.count=0},Fa=function(){this.i1=0,this.i2=0,this.v1=new K,this.v2=new K,this.normal=new K,this.sideNormal1=new K,this.sideOffset1=0,this.sideNormal2=new K,this.sideOffset2=0},Va=new(function(){function ae(){this.m_polygonB=new ka,this.m_xf=new de,this.m_centroidB=new K,this.m_v0=new K,this.m_v1=new K,this.m_v2=new K,this.m_v3=new K,this.m_normal0=new K,this.m_normal1=new K,this.m_normal2=new K,this.m_normal=new K,this.m_type1=0,this.m_type2=0,this.m_lowerLimit=new K,this.m_upperLimit=new K,this.m_radius=0,this.m_front=!1}return ae.prototype.Collide=function(J,q,se,ve,xe){de.MulTXX(se,xe,this.m_xf),de.MulXV(this.m_xf,ve.m_centroid,this.m_centroidB),this.m_v0.Copy(q.m_vertex0),this.m_v1.Copy(q.m_vertex1),this.m_v2.Copy(q.m_vertex2),this.m_v3.Copy(q.m_vertex3);var Ie=q.m_hasVertex0,Me=q.m_hasVertex3,Le=K.SubVV(this.m_v2,this.m_v1,ae.s_edge1);Le.Normalize(),this.m_normal1.Set(Le.y,-Le.x);var Ge=K.DotVV(this.m_normal1,K.SubVV(this.m_centroidB,this.m_v1,K.s_t0)),He=0,Ye=0,Je=!1,ze=!1;if(Ie){var Ke=K.SubVV(this.m_v1,this.m_v0,ae.s_edge0);Ke.Normalize(),this.m_normal0.Set(Ke.y,-Ke.x),Je=K.CrossVV(Ke,Le)>=0,He=K.DotVV(this.m_normal0,K.SubVV(this.m_centroidB,this.m_v0,K.s_t0))}if(Me){var et=K.SubVV(this.m_v3,this.m_v2,ae.s_edge2);et.Normalize(),this.m_normal2.Set(et.y,-et.x),ze=K.CrossVV(Le,et)>0,Ye=K.DotVV(this.m_normal2,K.SubVV(this.m_centroidB,this.m_v2,K.s_t0))}Ie&&Me?Je&&ze?(this.m_front=He>=0||Ge>=0||Ye>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):Je?(this.m_front=He>=0||Ge>=0&&Ye>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):ze?(this.m_front=Ye>=0||He>=0&&Ge>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):(this.m_front=He>=0&&Ge>=0&&Ye>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):Ie?Je?(this.m_front=He>=0||Ge>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):(this.m_front=He>=0&&Ge>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):Me?ze?(this.m_front=Ge>=0||Ye>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=Ge>=0&&Ye>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=Ge>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1))),this.m_polygonB.count=ve.m_count;for(var it=0;it<ve.m_count;++it)de.MulXV(this.m_xf,ve.m_vertices[it],this.m_polygonB.vertices[it]),oe.MulRV(this.m_xf.q,ve.m_normals[it],this.m_polygonB.normals[it]);this.m_radius=ve.m_radius+q.m_radius,J.pointCount=0;var ct=this.ComputeEdgeSeparation(ae.s_edgeAxis);if(ct.type!==0&&!(ct.separation>this.m_radius)){var mt=this.ComputePolygonSeparation(ae.s_polygonAxis);if(!(mt.type!==0&&mt.separation>this.m_radius)){var vt;vt=mt.type===0?ct:mt.separation>.98*ct.separation+.001?mt:ct;var Tt=ae.s_ie,wt=ae.s_rf;if(vt.type===1){J.type=w.b2ManifoldType.e_faceA;var Pt=0,Bt=K.DotVV(this.m_normal,this.m_polygonB.normals[0]);for(it=1;it<this.m_polygonB.count;++it){var jt=K.DotVV(this.m_normal,this.m_polygonB.normals[it]);jt<Bt&&(Bt=jt,Pt=it)}var Xt=Pt,Ht=(Xt+1)%this.m_polygonB.count;($t=Tt[0]).v.Copy(this.m_polygonB.vertices[Xt]),$t.id.cf.indexA=0,$t.id.cf.indexB=Xt,$t.id.cf.typeA=w.b2ContactFeatureType.e_face,$t.id.cf.typeB=w.b2ContactFeatureType.e_vertex,(Qt=Tt[1]).v.Copy(this.m_polygonB.vertices[Ht]),Qt.id.cf.indexA=0,Qt.id.cf.indexB=Ht,Qt.id.cf.typeA=w.b2ContactFeatureType.e_face,Qt.id.cf.typeB=w.b2ContactFeatureType.e_vertex,this.m_front?(wt.i1=0,wt.i2=1,wt.v1.Copy(this.m_v1),wt.v2.Copy(this.m_v2),wt.normal.Copy(this.m_normal1)):(wt.i1=1,wt.i2=0,wt.v1.Copy(this.m_v2),wt.v2.Copy(this.m_v1),wt.normal.Copy(this.m_normal1).SelfNeg())}else{var $t,Qt;J.type=w.b2ManifoldType.e_faceB,($t=Tt[0]).v.Copy(this.m_v1),$t.id.cf.indexA=0,$t.id.cf.indexB=vt.index,$t.id.cf.typeA=w.b2ContactFeatureType.e_vertex,$t.id.cf.typeB=w.b2ContactFeatureType.e_face,(Qt=Tt[1]).v.Copy(this.m_v2),Qt.id.cf.indexA=0,Qt.id.cf.indexB=vt.index,Qt.id.cf.typeA=w.b2ContactFeatureType.e_vertex,Qt.id.cf.typeB=w.b2ContactFeatureType.e_face,wt.i1=vt.index,wt.i2=(wt.i1+1)%this.m_polygonB.count,wt.v1.Copy(this.m_polygonB.vertices[wt.i1]),wt.v2.Copy(this.m_polygonB.vertices[wt.i2]),wt.normal.Copy(this.m_polygonB.normals[wt.i1])}wt.sideNormal1.Set(wt.normal.y,-wt.normal.x),wt.sideNormal2.Copy(wt.sideNormal1).SelfNeg(),wt.sideOffset1=K.DotVV(wt.sideNormal1,wt.v1),wt.sideOffset2=K.DotVV(wt.sideNormal2,wt.v2);var ur=ae.s_clipPoints1,tr=ae.s_clipPoints2;if(!(Jt(ur,Tt,wt.sideNormal1,wt.sideOffset1,wt.i1)<E||Jt(tr,ur,wt.sideNormal2,wt.sideOffset2,wt.i2)<E)){vt.type===1?(J.localNormal.Copy(wt.normal),J.localPoint.Copy(wt.v1)):(J.localNormal.Copy(ve.m_normals[wt.i1]),J.localPoint.Copy(ve.m_vertices[wt.i1]));var qt=0;for(it=0;it<E;++it)if(K.DotVV(wt.normal,K.SubVV(tr[it].v,wt.v1,K.s_t0))<=this.m_radius){var ar=J.points[qt];vt.type===1?(de.MulTXV(this.m_xf,tr[it].v,ar.localPoint),ar.id=tr[it].id):(ar.localPoint.Copy(tr[it].v),ar.id.cf.typeA=tr[it].id.cf.typeB,ar.id.cf.typeB=tr[it].id.cf.typeA,ar.id.cf.indexA=tr[it].id.cf.indexB,ar.id.cf.indexB=tr[it].id.cf.indexA),++qt}J.pointCount=qt}}}},ae.prototype.ComputeEdgeSeparation=function(J){var q=J;q.type=1,q.index=this.m_front?0:1,q.separation=A;for(var se=0;se<this.m_polygonB.count;++se){var ve=K.DotVV(this.m_normal,K.SubVV(this.m_polygonB.vertices[se],this.m_v1,K.s_t0));ve<q.separation&&(q.separation=ve)}return q},ae.prototype.ComputePolygonSeparation=function(J){var q=J;q.type=0,q.index=-1,q.separation=-A;for(var se=ae.s_perp.Set(-this.m_normal.y,this.m_normal.x),ve=0;ve<this.m_polygonB.count;++ve){var xe=K.NegV(this.m_polygonB.normals[ve],ae.s_n),Ie=K.DotVV(xe,K.SubVV(this.m_polygonB.vertices[ve],this.m_v1,K.s_t0)),Me=K.DotVV(xe,K.SubVV(this.m_polygonB.vertices[ve],this.m_v2,K.s_t0)),Le=U(Ie,Me);if(Le>this.m_radius)return q.type=2,q.index=ve,q.separation=Le,q;if(K.DotVV(xe,se)>=0){if(K.DotVV(K.SubVV(xe,this.m_upperLimit,K.s_t0),this.m_normal)<-M)continue}else if(K.DotVV(K.SubVV(xe,this.m_lowerLimit,K.s_t0),this.m_normal)<-M)continue;Le>q.separation&&(q.type=2,q.index=ve,q.separation=Le)}return q},ae.s_edge1=new K,ae.s_edge0=new K,ae.s_edge2=new K,ae.s_ie=Dt.MakeArray(2),ae.s_rf=new Fa,ae.s_clipPoints1=Dt.MakeArray(2),ae.s_clipPoints2=Dt.MakeArray(2),ae.s_edgeAxis=new zn,ae.s_polygonAxis=new zn,ae.s_n=new K,ae.s_perp=new K,ae}());function dn(ae,J,q,se,ve){Va.Collide(ae,J,q,se,ve)}var Xr,Wi=function(){this.mass=0,this.center=new K(0,0),this.I=0};(Xr=w.b2ShapeType||(w.b2ShapeType={}))[Xr.e_unknown=-1]="e_unknown",Xr[Xr.e_circleShape=0]="e_circleShape",Xr[Xr.e_edgeShape=1]="e_edgeShape",Xr[Xr.e_polygonShape=2]="e_polygonShape",Xr[Xr.e_chainShape=3]="e_chainShape",Xr[Xr.e_shapeTypeCount=4]="e_shapeTypeCount";var hi=function(){function ae(J,q){this.m_type=w.b2ShapeType.e_unknown,this.m_radius=0,this.m_type=J,this.m_radius=q}return ae.prototype.Copy=function(J){return this.m_radius=J.m_radius,this},ae.prototype.GetType=function(){return this.m_type},ae}(),Ga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ae,J){ae.__proto__=J}||function(ae,J){for(var q in J)J.hasOwnProperty(q)&&(ae[q]=J[q])};function sr(ae,J){function q(){this.constructor=ae}Ga(ae,J),ae.prototype=J===null?Object.create(J):(q.prototype=J.prototype,new q)}var ti,ja=function(ae){function J(q){q===void 0&&(q=0);var se=ae.call(this,w.b2ShapeType.e_circleShape,q)||this;return se.m_p=new K,se}return sr(J,ae),J.prototype.Set=function(q,se){return se===void 0&&(se=this.m_radius),this.m_p.Copy(q),this.m_radius=se,this},J.prototype.Clone=function(){return new J().Copy(this)},J.prototype.Copy=function(q){return ae.prototype.Copy.call(this,q),this.m_p.Copy(q.m_p),this},J.prototype.GetChildCount=function(){return 1},J.prototype.TestPoint=function(q,se){var ve=de.MulXV(q,this.m_p,J.TestPoint_s_center),xe=K.SubVV(se,ve,J.TestPoint_s_d);return K.DotVV(xe,xe)<=W(this.m_radius)},J.prototype.ComputeDistance=function(q,se,ve){var xe=de.MulXV(q,this.m_p,J.ComputeDistance_s_center);return K.SubVV(se,xe,ve),ve.Normalize()-this.m_radius},J.prototype.RayCast=function(q,se,ve){var xe=de.MulXV(ve,this.m_p,J.RayCast_s_position),Ie=K.SubVV(se.p1,xe,J.RayCast_s_s),Me=K.DotVV(Ie,Ie)-W(this.m_radius),Le=K.SubVV(se.p2,se.p1,J.RayCast_s_r),Ge=K.DotVV(Ie,Le),He=K.DotVV(Le,Le),Ye=Ge*Ge-He*Me;if(Ye<0||He<O)return!1;var Je=-(Ge+ee(Ye));return 0<=Je&&Je<=se.maxFraction*He&&(Je/=He,q.fraction=Je,K.AddVMulSV(Ie,Je,Le,q.normal).SelfNormalize(),!0)},J.prototype.ComputeAABB=function(q,se){var ve=de.MulXV(se,this.m_p,J.ComputeAABB_s_p);q.lowerBound.Set(ve.x-this.m_radius,ve.y-this.m_radius),q.upperBound.Set(ve.x+this.m_radius,ve.y+this.m_radius)},J.prototype.ComputeMass=function(q,se){var ve=W(this.m_radius);q.mass=se*P*ve,q.center.Copy(this.m_p),q.I=q.mass*(.5*ve+K.DotVV(this.m_p,this.m_p))},J.prototype.SetupDistanceProxy=function(q){q.m_vertices=q.m_buffer,q.m_vertices[0].Copy(this.m_p),q.m_count=1,q.m_radius=this.m_radius},J.prototype.ComputeSubmergedArea=function(q,se,ve,xe){var Ie=de.MulXV(ve,this.m_p,new K),Me=-(K.DotVV(q,Ie)-se);if(Me<-this.m_radius+O)return 0;if(Me>this.m_radius)return xe.Copy(Ie),P*this.m_radius*this.m_radius;var Le=this.m_radius*this.m_radius,Ge=Me*Me,He=Le*(he(Me/this.m_radius)+P/2)+Me*ee(Le-Ge),Ye=-2/3*te(Le-Ge,1.5)/He;return xe.x=Ie.x+q.x*Ye,xe.y=Ie.y+q.y*Ye,He},J.prototype.Dump=function(q){q("    const shape: b2CircleShape = new b2CircleShape();\n"),q("    shape.m_radius = %.15f;\n",this.m_radius),q("    shape.m_p.Set(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)},J.TestPoint_s_center=new K,J.TestPoint_s_d=new K,J.ComputeDistance_s_center=new K,J.RayCast_s_position=new K,J.RayCast_s_s=new K,J.RayCast_s_r=new K,J.ComputeAABB_s_p=new K,J}(hi),Ua=function(ae){function J(){var q=ae.call(this,w.b2ShapeType.e_polygonShape,N)||this;return q.m_centroid=new K(0,0),q.m_vertices=[],q.m_normals=[],q.m_count=0,q}return sr(J,ae),J.prototype.Clone=function(){return new J().Copy(this)},J.prototype.Copy=function(q){ae.prototype.Copy.call(this,q),this.m_centroid.Copy(q.m_centroid),this.m_count=q.m_count,this.m_vertices=K.MakeArray(this.m_count),this.m_normals=K.MakeArray(this.m_count);for(var se=0;se<this.m_count;++se)this.m_vertices[se].Copy(q.m_vertices[se]),this.m_normals[se].Copy(q.m_normals[se]);return this},J.prototype.GetChildCount=function(){return 1},J.prototype.Set=function(q,se,ve){if(se===void 0&&(se=q.length),ve===void 0&&(ve=0),se<3)return this.SetAsBox(1,1);for(var xe=U(se,D),Ie=J.Set_s_ps,Me=0,Le=0;Le<xe;++Le){for(var Ge=q[ve+Le],He=!0,Ye=0;Ye<Me;++Ye)if(K.DistanceSquaredVV(Ge,Ie[Ye])<.25*I*I){He=!1;break}He&&Ie[Me++].Copy(Ge)}if((xe=Me)<3)return this.SetAsBox(1,1);var Je=0,ze=Ie[0].x;for(Le=1;Le<xe;++Le){var Ke=Ie[Le].x;(Ke>ze||Ke===ze&&Ie[Le].y<Ie[Je].y)&&(Je=Le,ze=Ke)}for(var et=J.Set_s_hull,it=0,ct=Je;;){et[it]=ct;var mt=0;for(Ye=1;Ye<xe;++Ye)if(mt!==ct){var vt=K.SubVV(Ie[mt],Ie[et[it]],J.Set_s_r),Tt=(Ge=K.SubVV(Ie[Ye],Ie[et[it]],J.Set_s_v),K.CrossVV(vt,Ge));Tt<0&&(mt=Ye),Tt===0&&Ge.LengthSquared()>vt.LengthSquared()&&(mt=Ye)}else mt=Ye;if(++it,ct=mt,mt===Je)break}for(this.m_count=it,this.m_vertices=K.MakeArray(this.m_count),this.m_normals=K.MakeArray(this.m_count),Le=0;Le<it;++Le)this.m_vertices[Le].Copy(Ie[et[Le]]);for(Le=0;Le<it;++Le){var wt=this.m_vertices[Le],Pt=this.m_vertices[(Le+1)%it],Bt=K.SubVV(Pt,wt,K.s_t0);K.CrossVOne(Bt,this.m_normals[Le]).SelfNormalize()}return J.ComputeCentroid(this.m_vertices,it,this.m_centroid),this},J.prototype.SetAsArray=function(q,se){return se===void 0&&(se=q.length),this.Set(q,se)},J.prototype.SetAsBox=function(q,se,ve,xe){if(xe===void 0&&(xe=0),this.m_count=4,this.m_vertices=K.MakeArray(this.m_count),this.m_normals=K.MakeArray(this.m_count),this.m_vertices[0].Set(-q,-se),this.m_vertices[1].Set(q,-se),this.m_vertices[2].Set(q,se),this.m_vertices[3].Set(-q,se),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero(),ve){this.m_centroid.Copy(ve);var Ie=new de;Ie.SetPosition(ve),Ie.SetRotationAngle(xe);for(var Me=0;Me<this.m_count;++Me)de.MulXV(Ie,this.m_vertices[Me],this.m_vertices[Me]),oe.MulRV(Ie.q,this.m_normals[Me],this.m_normals[Me])}return this},J.prototype.TestPoint=function(q,se){for(var ve=de.MulTXV(q,se,J.TestPoint_s_pLocal),xe=0;xe<this.m_count;++xe)if(K.DotVV(this.m_normals[xe],K.SubVV(ve,this.m_vertices[xe],K.s_t0))>0)return!1;return!0},J.prototype.ComputeDistance=function(q,se,ve){for(var xe=de.MulTXV(q,se,J.ComputeDistance_s_pLocal),Ie=-A,Me=J.ComputeDistance_s_normalForMaxDistance.Copy(xe),Le=0;Le<this.m_count;++Le){var Ge=K.DotVV(this.m_normals[Le],K.SubVV(xe,this.m_vertices[Le],K.s_t0));Ge>Ie&&(Ie=Ge,Me.Copy(this.m_normals[Le]))}if(Ie>0){var He=J.ComputeDistance_s_minDistance.Copy(Me),Ye=Ie*Ie;for(Le=0;Le<this.m_count;++Le){var Je=K.SubVV(xe,this.m_vertices[Le],J.ComputeDistance_s_distance),ze=Je.LengthSquared();Ye>ze&&(He.Copy(Je),Ye=ze)}return oe.MulRV(q.q,He,ve),ve.Normalize(),Math.sqrt(Ye)}return oe.MulRV(q.q,Me,ve),Ie},J.prototype.RayCast=function(q,se,ve){for(var xe=de.MulTXV(ve,se.p1,J.RayCast_s_p1),Ie=de.MulTXV(ve,se.p2,J.RayCast_s_p2),Me=K.SubVV(Ie,xe,J.RayCast_s_d),Le=0,Ge=se.maxFraction,He=-1,Ye=0;Ye<this.m_count;++Ye){var Je=K.DotVV(this.m_normals[Ye],K.SubVV(this.m_vertices[Ye],xe,K.s_t0)),ze=K.DotVV(this.m_normals[Ye],Me);if(ze===0){if(Je<0)return!1}else ze<0&&Je<Le*ze?(Le=Je/ze,He=Ye):ze>0&&Je<Ge*ze&&(Ge=Je/ze);if(Ge<Le)return!1}return He>=0&&(q.fraction=Le,oe.MulRV(ve.q,this.m_normals[He],q.normal),!0)},J.prototype.ComputeAABB=function(q,se){for(var ve=de.MulXV(se,this.m_vertices[0],q.lowerBound),xe=q.upperBound.Copy(ve),Ie=0;Ie<this.m_count;++Ie){var Me=de.MulXV(se,this.m_vertices[Ie],J.ComputeAABB_s_v);K.MinV(Me,ve,ve),K.MaxV(Me,xe,xe)}var Le=this.m_radius;ve.SelfSubXY(Le,Le),xe.SelfAddXY(Le,Le)},J.prototype.ComputeMass=function(q,se){for(var ve=J.ComputeMass_s_center.SetZero(),xe=0,Ie=0,Me=J.ComputeMass_s_s.SetZero(),Le=0;Le<this.m_count;++Le)Me.SelfAdd(this.m_vertices[Le]);for(Me.SelfMul(1/this.m_count),Le=0;Le<this.m_count;++Le){var Ge=K.SubVV(this.m_vertices[Le],Me,J.ComputeMass_s_e1),He=K.SubVV(this.m_vertices[(Le+1)%this.m_count],Me,J.ComputeMass_s_e2),Ye=K.CrossVV(Ge,He),Je=.5*Ye;xe+=Je,ve.SelfAdd(K.MulSV(Je*(1/3),K.AddVV(Ge,He,K.s_t0),K.s_t1));var ze=Ge.x,Ke=Ge.y,et=He.x,it=He.y;Ie+=1/3*.25*Ye*(ze*ze+et*ze+et*et+Ke*Ke+it*Ke+it*it)}q.mass=se*xe,ve.SelfMul(1/xe),K.AddVV(ve,Me,q.center),q.I=se*Ie,q.I+=q.mass*(K.DotVV(q.center,q.center)-K.DotVV(ve,ve))},J.prototype.Validate=function(){for(var q=0;q<this.m_count;++q)for(var se=q,ve=(q+1)%this.m_count,xe=this.m_vertices[se],Ie=K.SubVV(this.m_vertices[ve],xe,J.Validate_s_e),Me=0;Me<this.m_count;++Me)if(Me!==se&&Me!==ve){var Le=K.SubVV(this.m_vertices[Me],xe,J.Validate_s_v);if(K.CrossVV(Ie,Le)<0)return!1}return!0},J.prototype.SetupDistanceProxy=function(q){q.m_vertices=this.m_vertices,q.m_count=this.m_count,q.m_radius=this.m_radius},J.prototype.ComputeSubmergedArea=function(q,se,ve,xe){for(var Ie=oe.MulTRV(ve.q,q,J.ComputeSubmergedArea_s_normalL),Me=se-K.DotVV(q,ve.p),Le=J.ComputeSubmergedArea_s_depths,Ge=0,He=-1,Ye=-1,Je=!1,ze=0;ze<this.m_count;++ze){Le[ze]=K.DotVV(Ie,this.m_vertices[ze])-Me;var Ke=Le[ze]<-O;ze>0&&(Ke?Je||(He=ze-1,Ge++):Je&&(Ye=ze-1,Ge++)),Je=Ke}switch(Ge){case 0:if(Je){var et=J.ComputeSubmergedArea_s_md;return this.ComputeMass(et,1),de.MulXV(ve,et.center,xe),et.mass}return 0;case 1:He===-1?He=this.m_count-1:Ye=this.m_count-1}for(var it,ct=(He+1)%this.m_count,mt=(Ye+1)%this.m_count,vt=(0-Le[He])/(Le[ct]-Le[He]),Tt=(0-Le[Ye])/(Le[mt]-Le[Ye]),wt=J.ComputeSubmergedArea_s_intoVec.Set(this.m_vertices[He].x*(1-vt)+this.m_vertices[ct].x*vt,this.m_vertices[He].y*(1-vt)+this.m_vertices[ct].y*vt),Pt=J.ComputeSubmergedArea_s_outoVec.Set(this.m_vertices[Ye].x*(1-Tt)+this.m_vertices[mt].x*Tt,this.m_vertices[Ye].y*(1-Tt)+this.m_vertices[mt].y*Tt),Bt=0,jt=J.ComputeSubmergedArea_s_center.SetZero(),Xt=this.m_vertices[ct],Ht=ct;Ht!==mt;){it=(Ht=(Ht+1)%this.m_count)===mt?Pt:this.m_vertices[Ht];var $t=.5*((Xt.x-wt.x)*(it.y-wt.y)-(Xt.y-wt.y)*(it.x-wt.x));Bt+=$t,jt.x+=$t*(wt.x+Xt.x+it.x)/3,jt.y+=$t*(wt.y+Xt.y+it.y)/3,Xt=it}return jt.SelfMul(1/Bt),de.MulXV(ve,jt,xe),Bt},J.prototype.Dump=function(q){q("    const shape: b2PolygonShape = new b2PolygonShape();\n"),q("    const vs: b2Vec2[] = b2Vec2.MakeArray(%d);\n",D);for(var se=0;se<this.m_count;++se)q("    vs[%d].Set(%.15f, %.15f);\n",se,this.m_vertices[se].x,this.m_vertices[se].y);q("    shape.Set(vs, %d);\n",this.m_count)},J.ComputeCentroid=function(q,se,ve){var xe=ve;xe.SetZero();for(var Ie=0,Me=J.ComputeCentroid_s_pRef.SetZero(),Le=0;Le<se;++Le){var Ge=Me,He=q[Le],Ye=q[(Le+1)%se],Je=K.SubVV(He,Ge,J.ComputeCentroid_s_e1),ze=K.SubVV(Ye,Ge,J.ComputeCentroid_s_e2),Ke=.5*K.CrossVV(Je,ze);Ie+=Ke,xe.x+=Ke*(1/3)*(Ge.x+He.x+Ye.x),xe.y+=Ke*(1/3)*(Ge.y+He.y+Ye.y)}return xe.SelfMul(1/Ie),xe},J.Set_s_ps=K.MakeArray(D),J.Set_s_hull=j(D),J.Set_s_r=new K,J.Set_s_v=new K,J.TestPoint_s_pLocal=new K,J.ComputeDistance_s_pLocal=new K,J.ComputeDistance_s_normalForMaxDistance=new K,J.ComputeDistance_s_minDistance=new K,J.ComputeDistance_s_distance=new K,J.RayCast_s_p1=new K,J.RayCast_s_p2=new K,J.RayCast_s_d=new K,J.ComputeAABB_s_v=new K,J.ComputeMass_s_center=new K,J.ComputeMass_s_s=new K,J.ComputeMass_s_e1=new K,J.ComputeMass_s_e2=new K,J.Validate_s_e=new K,J.Validate_s_v=new K,J.ComputeSubmergedArea_s_normalL=new K,J.ComputeSubmergedArea_s_depths=j(D),J.ComputeSubmergedArea_s_md=new Wi,J.ComputeSubmergedArea_s_intoVec=new K,J.ComputeSubmergedArea_s_outoVec=new K,J.ComputeSubmergedArea_s_center=new K,J.ComputeCentroid_s_pRef=new K,J.ComputeCentroid_s_e1=new K,J.ComputeCentroid_s_e2=new K,J}(hi),bi=function(ae){function J(){var q=ae.call(this,w.b2ShapeType.e_edgeShape,N)||this;return q.m_vertex1=new K,q.m_vertex2=new K,q.m_vertex0=new K,q.m_vertex3=new K,q.m_hasVertex0=!1,q.m_hasVertex3=!1,q}return sr(J,ae),J.prototype.Set=function(q,se){return this.m_vertex1.Copy(q),this.m_vertex2.Copy(se),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},J.prototype.Clone=function(){return new J().Copy(this)},J.prototype.Copy=function(q){return ae.prototype.Copy.call(this,q),this.m_vertex1.Copy(q.m_vertex1),this.m_vertex2.Copy(q.m_vertex2),this.m_vertex0.Copy(q.m_vertex0),this.m_vertex3.Copy(q.m_vertex3),this.m_hasVertex0=q.m_hasVertex0,this.m_hasVertex3=q.m_hasVertex3,this},J.prototype.GetChildCount=function(){return 1},J.prototype.TestPoint=function(){return!1},J.prototype.ComputeDistance=function(q,se,ve){var xe=de.MulXV(q,this.m_vertex1,J.ComputeDistance_s_v1),Ie=de.MulXV(q,this.m_vertex2,J.ComputeDistance_s_v2),Me=K.SubVV(se,xe,J.ComputeDistance_s_d),Le=K.SubVV(Ie,xe,J.ComputeDistance_s_s),Ge=K.DotVV(Me,Le);if(Ge>0){var He=K.DotVV(Le,Le);Ge>He?K.SubVV(se,Ie,Me):Me.SelfMulSub(Ge/He,Le)}return ve.Copy(Me),ve.Normalize()},J.prototype.RayCast=function(q,se,ve){var xe=de.MulTXV(ve,se.p1,J.RayCast_s_p1),Ie=de.MulTXV(ve,se.p2,J.RayCast_s_p2),Me=K.SubVV(Ie,xe,J.RayCast_s_d),Le=this.m_vertex1,Ge=this.m_vertex2,He=K.SubVV(Ge,Le,J.RayCast_s_e),Ye=q.normal.Set(He.y,-He.x).SelfNormalize(),Je=K.DotVV(Ye,K.SubVV(Le,xe,K.s_t0)),ze=K.DotVV(Ye,Me);if(ze===0)return!1;var Ke=Je/ze;if(Ke<0||se.maxFraction<Ke)return!1;var et=K.AddVMulSV(xe,Ke,Me,J.RayCast_s_q),it=K.SubVV(Ge,Le,J.RayCast_s_r),ct=K.DotVV(it,it);if(ct===0)return!1;var mt=K.DotVV(K.SubVV(et,Le,K.s_t0),it)/ct;return!(mt<0||1<mt||(q.fraction=Ke,oe.MulRV(ve.q,q.normal,q.normal),Je>0&&q.normal.SelfNeg(),0))},J.prototype.ComputeAABB=function(q,se){var ve=de.MulXV(se,this.m_vertex1,J.ComputeAABB_s_v1),xe=de.MulXV(se,this.m_vertex2,J.ComputeAABB_s_v2);K.MinV(ve,xe,q.lowerBound),K.MaxV(ve,xe,q.upperBound);var Ie=this.m_radius;q.lowerBound.SelfSubXY(Ie,Ie),q.upperBound.SelfAddXY(Ie,Ie)},J.prototype.ComputeMass=function(q){q.mass=0,K.MidVV(this.m_vertex1,this.m_vertex2,q.center),q.I=0},J.prototype.SetupDistanceProxy=function(q){q.m_vertices=q.m_buffer,q.m_vertices[0].Copy(this.m_vertex1),q.m_vertices[1].Copy(this.m_vertex2),q.m_count=2,q.m_radius=this.m_radius},J.prototype.ComputeSubmergedArea=function(q,se,ve,xe){return xe.SetZero(),0},J.prototype.Dump=function(q){q("    const shape: b2EdgeShape = new b2EdgeShape();\n"),q("    shape.m_radius = %.15f;\n",this.m_radius),q("    shape.m_vertex0.Set(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y),q("    shape.m_vertex1.Set(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y),q("    shape.m_vertex2.Set(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y),q("    shape.m_vertex3.Set(%.15f, %.15f);\n",this.m_vertex3.x,this.m_vertex3.y),q("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0),q("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)},J.ComputeDistance_s_v1=new K,J.ComputeDistance_s_v2=new K,J.ComputeDistance_s_d=new K,J.ComputeDistance_s_s=new K,J.RayCast_s_p1=new K,J.RayCast_s_p2=new K,J.RayCast_s_d=new K,J.RayCast_s_e=new K,J.RayCast_s_q=new K,J.RayCast_s_r=new K,J.ComputeAABB_s_v1=new K,J.ComputeAABB_s_v2=new K,J}(hi),Ha=function(ae){function J(){var q=ae.call(this,w.b2ShapeType.e_chainShape,N)||this;return q.m_vertices=[],q.m_count=0,q.m_prevVertex=new K,q.m_nextVertex=new K,q.m_hasPrevVertex=!1,q.m_hasNextVertex=!1,q}return sr(J,ae),J.prototype.CreateLoop=function(q,se,ve){if(se===void 0&&(se=q.length),ve===void 0&&(ve=0),se<3)return this;this.m_count=se+1,this.m_vertices=K.MakeArray(this.m_count);for(var xe=0;xe<se;++xe)this.m_vertices[xe].Copy(q[ve+xe]);return this.m_vertices[se].Copy(this.m_vertices[0]),this.m_prevVertex.Copy(this.m_vertices[this.m_count-2]),this.m_nextVertex.Copy(this.m_vertices[1]),this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},J.prototype.CreateChain=function(q,se,ve){se===void 0&&(se=q.length),ve===void 0&&(ve=0),this.m_count=se,this.m_vertices=K.MakeArray(se);for(var xe=0;xe<se;++xe)this.m_vertices[xe].Copy(q[ve+xe]);return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex.SetZero(),this.m_nextVertex.SetZero(),this},J.prototype.SetPrevVertex=function(q){return this.m_prevVertex.Copy(q),this.m_hasPrevVertex=!0,this},J.prototype.SetNextVertex=function(q){return this.m_nextVertex.Copy(q),this.m_hasNextVertex=!0,this},J.prototype.Clone=function(){return new J().Copy(this)},J.prototype.Copy=function(q){return ae.prototype.Copy.call(this,q),this.CreateChain(q.m_vertices,q.m_count),this.m_prevVertex.Copy(q.m_prevVertex),this.m_nextVertex.Copy(q.m_nextVertex),this.m_hasPrevVertex=q.m_hasPrevVertex,this.m_hasNextVertex=q.m_hasNextVertex,this},J.prototype.GetChildCount=function(){return this.m_count-1},J.prototype.GetChildEdge=function(q,se){q.m_type=w.b2ShapeType.e_edgeShape,q.m_radius=this.m_radius,q.m_vertex1.Copy(this.m_vertices[se]),q.m_vertex2.Copy(this.m_vertices[se+1]),se>0?(q.m_vertex0.Copy(this.m_vertices[se-1]),q.m_hasVertex0=!0):(q.m_vertex0.Copy(this.m_prevVertex),q.m_hasVertex0=this.m_hasPrevVertex),se<this.m_count-2?(q.m_vertex3.Copy(this.m_vertices[se+2]),q.m_hasVertex3=!0):(q.m_vertex3.Copy(this.m_nextVertex),q.m_hasVertex3=this.m_hasNextVertex)},J.prototype.TestPoint=function(){return!1},J.prototype.ComputeDistance=function(q,se,ve,xe){var Ie=J.ComputeDistance_s_edgeShape;return this.GetChildEdge(Ie,xe),Ie.ComputeDistance(q,se,ve,0)},J.prototype.RayCast=function(q,se,ve,xe){var Ie=J.RayCast_s_edgeShape;return Ie.m_vertex1.Copy(this.m_vertices[xe]),Ie.m_vertex2.Copy(this.m_vertices[(xe+1)%this.m_count]),Ie.RayCast(q,se,ve,0)},J.prototype.ComputeAABB=function(q,se,ve){var xe=this.m_vertices[ve],Ie=this.m_vertices[(ve+1)%this.m_count],Me=de.MulXV(se,xe,J.ComputeAABB_s_v1),Le=de.MulXV(se,Ie,J.ComputeAABB_s_v2);K.MinV(Me,Le,q.lowerBound),K.MaxV(Me,Le,q.upperBound)},J.prototype.ComputeMass=function(q){q.mass=0,q.center.SetZero(),q.I=0},J.prototype.SetupDistanceProxy=function(q,se){q.m_vertices=q.m_buffer,q.m_vertices[0].Copy(this.m_vertices[se]),se+1<this.m_count?q.m_vertices[1].Copy(this.m_vertices[se+1]):q.m_vertices[1].Copy(this.m_vertices[0]),q.m_count=2,q.m_radius=this.m_radius},J.prototype.ComputeSubmergedArea=function(q,se,ve,xe){return xe.SetZero(),0},J.prototype.Dump=function(q){q("    const shape: b2ChainShape = new b2ChainShape();\n"),q("    const vs: b2Vec2[] = b2Vec2.MakeArray(%d);\n",D);for(var se=0;se<this.m_count;++se)q("    vs[%d].Set(%.15f, %.15f);\n",se,this.m_vertices[se].x,this.m_vertices[se].y);q("    shape.CreateChain(vs, %d);\n",this.m_count),q("    shape.m_prevVertex.Set(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y),q("    shape.m_nextVertex.Set(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y),q("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false"),q("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")},J.ComputeDistance_s_edgeShape=new bi,J.RayCast_s_edgeShape=new bi,J.ComputeAABB_s_v1=new K,J.ComputeAABB_s_v2=new K,J}(hi),zi=function(){function ae(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return ae.prototype.Clone=function(){return new ae().Copy(this)},ae.prototype.Copy=function(J){return this.categoryBits=J.categoryBits,this.maskBits=J.maskBits,this.groupIndex=J.groupIndex||0,this},ae.DEFAULT=new ae,ae}(),Zn=function(){this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter=new zi},pn=function(ae){this.aabb=new Ot,this.childIndex=0,this.fixture=ae},Jn=function(){function ae(J,q){this.m_density=0,this.m_next=null,this.m_friction=0,this.m_restitution=0,this.m_proxies=[],this.m_proxyCount=0,this.m_filter=new zi,this.m_isSensor=!1,this.m_userData=null,this.m_body=q,this.m_shape=J.shape.Clone()}return ae.prototype.GetType=function(){return this.m_shape.GetType()},ae.prototype.GetShape=function(){return this.m_shape},ae.prototype.SetSensor=function(J){J!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=J)},ae.prototype.IsSensor=function(){return this.m_isSensor},ae.prototype.SetFilterData=function(J){this.m_filter.Copy(J),this.Refilter()},ae.prototype.GetFilterData=function(){return this.m_filter},ae.prototype.Refilter=function(){for(var J=this.m_body.GetContactList();J;){var q=J.contact,se=q.GetFixtureA(),ve=q.GetFixtureB();se!==this&&ve!==this||q.FlagForFiltering(),J=J.next}var xe=this.m_body.GetWorld();if(xe!==null)for(var Ie=xe.m_contactManager.m_broadPhase,Me=0;Me<this.m_proxyCount;++Me)Ie.TouchProxy(this.m_proxies[Me].treeNode)},ae.prototype.GetBody=function(){return this.m_body},ae.prototype.GetNext=function(){return this.m_next},ae.prototype.GetUserData=function(){return this.m_userData},ae.prototype.SetUserData=function(J){this.m_userData=J},ae.prototype.TestPoint=function(J){return this.m_shape.TestPoint(this.m_body.GetTransform(),J)},ae.prototype.ComputeDistance=function(J,q,se){return this.m_shape.ComputeDistance(this.m_body.GetTransform(),J,q,se)},ae.prototype.RayCast=function(J,q,se){return this.m_shape.RayCast(J,q,this.m_body.GetTransform(),se)},ae.prototype.GetMassData=function(J){return J===void 0&&(J=new Wi),this.m_shape.ComputeMass(J,this.m_density),J},ae.prototype.SetDensity=function(J){this.m_density=J},ae.prototype.GetDensity=function(){return this.m_density},ae.prototype.GetFriction=function(){return this.m_friction},ae.prototype.SetFriction=function(J){this.m_friction=J},ae.prototype.GetRestitution=function(){return this.m_restitution},ae.prototype.SetRestitution=function(J){this.m_restitution=J},ae.prototype.GetAABB=function(J){return this.m_proxies[J].aabb},ae.prototype.Dump=function(J,q){J("    const fd: b2FixtureDef = new b2FixtureDef();\n"),J("    fd.friction = %.15f;\n",this.m_friction),J("    fd.restitution = %.15f;\n",this.m_restitution),J("    fd.density = %.15f;\n",this.m_density),J("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),J("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),J("    fd.filter.maskBits = %d;\n",this.m_filter.maskBits),J("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(J),J("\n"),J("    fd.shape = shape;\n"),J("\n"),J("    bodies[%d].CreateFixture(fd);\n",q)},ae.prototype.Create=function(J){var q=this;this.m_userData=J.userData,this.m_friction=B(J.friction,.2),this.m_restitution=B(J.restitution,0),this.m_next=null,this.m_filter.Copy(B(J.filter,zi.DEFAULT)),this.m_isSensor=B(J.isSensor,!1),this.m_proxies=V(this.m_shape.GetChildCount(),function(){return new pn(q)}),this.m_proxyCount=0,this.m_density=B(J.density,0)},ae.prototype.Destroy=function(){},ae.prototype.CreateProxies=function(J){var q=this.m_body.m_world.m_contactManager.m_broadPhase;this.m_proxyCount=this.m_shape.GetChildCount();for(var se=0;se<this.m_proxyCount;++se){var ve=this.m_proxies[se]=new pn(this);this.m_shape.ComputeAABB(ve.aabb,J,se),ve.treeNode=q.CreateProxy(ve.aabb,ve),ve.childIndex=se}},ae.prototype.DestroyProxies=function(){for(var J=this.m_body.m_world.m_contactManager.m_broadPhase,q=0;q<this.m_proxyCount;++q){var se=this.m_proxies[q];delete se.treeNode.userData,J.DestroyProxy(se.treeNode),delete se.treeNode}this.m_proxyCount=0},ae.prototype.TouchProxies=function(){for(var J=this.m_body.m_world.m_contactManager.m_broadPhase,q=this.m_proxyCount,se=0;se<q;++se)J.TouchProxy(this.m_proxies[se].treeNode)},ae.prototype.Synchronize=function(J,q){if(this.m_proxyCount!==0)for(var se=this.m_body.m_world.m_contactManager.m_broadPhase,ve=0;ve<this.m_proxyCount;++ve){var xe=this.m_proxies[ve],Ie=ae.Synchronize_s_aabb1,Me=ae.Synchronize_s_aabb2;this.m_shape.ComputeAABB(Ie,J,ve),this.m_shape.ComputeAABB(Me,q,ve),xe.aabb.Combine2(Ie,Me);var Le=K.SubVV(q.p,J.p,ae.Synchronize_s_displacement);se.MoveProxy(xe.treeNode,xe.aabb,Le)}},ae.Synchronize_s_aabb1=new Ot,ae.Synchronize_s_aabb2=new Ot,ae.Synchronize_s_displacement=new K,ae}();(ti=w.b2BodyType||(w.b2BodyType={}))[ti.b2_unknown=-1]="b2_unknown",ti[ti.b2_staticBody=0]="b2_staticBody",ti[ti.b2_kinematicBody=1]="b2_kinematicBody",ti[ti.b2_dynamicBody=2]="b2_dynamicBody";var Cr,ri,Kn=function(){function ae(J,q){this.m_type=w.b2BodyType.b2_staticBody,this.m_islandFlag=!1,this.m_awakeFlag=!1,this.m_autoSleepFlag=!1,this.m_bulletFlag=!1,this.m_fixedRotationFlag=!1,this.m_activeFlag=!1,this.m_toiFlag=!1,this.m_islandIndex=0,this.m_xf=new de,this.m_xf0=new de,this.m_sweep=new me,this.m_linearVelocity=new K,this.m_angularVelocity=0,this.m_force=new K,this.m_torque=0,this.m_prev=null,this.m_next=null,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_jointList=null,this.m_contactList=null,this.m_mass=1,this.m_invMass=1,this.m_I=0,this.m_invI=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_gravityScale=1,this.m_sleepTime=0,this.m_userData=null,this.m_controllerList=null,this.m_controllerCount=0,this.m_bulletFlag=B(J.bullet,!1),this.m_fixedRotationFlag=B(J.fixedRotation,!1),this.m_autoSleepFlag=B(J.allowSleep,!0),this.m_awakeFlag=B(J.awake,!0),this.m_activeFlag=B(J.active,!0),this.m_world=q,this.m_xf.p.Copy(B(J.position,K.ZERO)),this.m_xf.q.SetAngle(B(J.angle,0)),this.m_xf0.Copy(this.m_xf),this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a=this.m_xf.q.GetAngle(),this.m_sweep.alpha0=0,this.m_linearVelocity.Copy(B(J.linearVelocity,K.ZERO)),this.m_angularVelocity=B(J.angularVelocity,0),this.m_linearDamping=B(J.linearDamping,0),this.m_angularDamping=B(J.angularDamping,0),this.m_gravityScale=B(J.gravityScale,1),this.m_force.SetZero(),this.m_torque=0,this.m_sleepTime=0,this.m_type=B(J.type,w.b2BodyType.b2_staticBody),J.type===w.b2BodyType.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_userData=J.userData,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_controllerList=null,this.m_controllerCount=0}return ae.prototype.CreateFixture=function(J,q){return q===void 0&&(q=0),J instanceof hi?this.CreateFixtureShapeDensity(J,q):this.CreateFixtureDef(J)},ae.prototype.CreateFixtureDef=function(J){if(this.m_world.IsLocked())throw new Error;var q=new Jn(J,this);return q.Create(J),this.m_activeFlag&&q.CreateProxies(this.m_xf),q.m_next=this.m_fixtureList,this.m_fixtureList=q,++this.m_fixtureCount,q.m_density>0&&this.ResetMassData(),this.m_world.m_newFixture=!0,q},ae.prototype.CreateFixtureShapeDensity=function(J,q){q===void 0&&(q=0);var se=ae.CreateFixtureShapeDensity_s_def;return se.shape=J,se.density=q,this.CreateFixtureDef(se)},ae.prototype.DestroyFixture=function(J){if(this.m_world.IsLocked())throw new Error;for(var q=this.m_fixtureList,se=null;q!==null;){if(q===J){se?se.m_next=J.m_next:this.m_fixtureList=J.m_next;break}se=q,q=q.m_next}for(var ve=this.m_contactList;ve;){var xe=ve.contact;ve=ve.next;var Ie=xe.GetFixtureA(),Me=xe.GetFixtureB();J!==Ie&&J!==Me||this.m_world.m_contactManager.Destroy(xe)}this.m_activeFlag&&J.DestroyProxies(),J.m_next=null,J.Destroy(),--this.m_fixtureCount,this.ResetMassData()},ae.prototype.SetTransformVec=function(J,q){this.SetTransformXY(J.x,J.y,q)},ae.prototype.SetTransformXY=function(J,q,se){if(this.m_world.IsLocked())throw new Error;this.m_xf.q.SetAngle(se),this.m_xf.p.Set(J,q),this.m_xf0.Copy(this.m_xf),de.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=se,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=se;for(var ve=this.m_fixtureList;ve;ve=ve.m_next)ve.Synchronize(this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()},ae.prototype.SetTransform=function(J){this.SetTransformVec(J.p,J.GetAngle())},ae.prototype.GetTransform=function(){return this.m_xf},ae.prototype.GetPosition=function(){return this.m_xf.p},ae.prototype.SetPosition=function(J){this.SetTransformVec(J,this.GetAngle())},ae.prototype.SetPositionXY=function(J,q){this.SetTransformXY(J,q,this.GetAngle())},ae.prototype.GetAngle=function(){return this.m_sweep.a},ae.prototype.SetAngle=function(J){this.SetTransformVec(this.GetPosition(),J)},ae.prototype.GetWorldCenter=function(){return this.m_sweep.c},ae.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},ae.prototype.SetLinearVelocity=function(J){this.m_type!==w.b2BodyType.b2_staticBody&&(K.DotVV(J,J)>0&&this.SetAwake(!0),this.m_linearVelocity.Copy(J))},ae.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},ae.prototype.SetAngularVelocity=function(J){this.m_type!==w.b2BodyType.b2_staticBody&&(J*J>0&&this.SetAwake(!0),this.m_angularVelocity=J)},ae.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},ae.prototype.GetDefinition=function(J){return J.type=this.GetType(),J.allowSleep=this.m_autoSleepFlag,J.angle=this.GetAngle(),J.angularDamping=this.m_angularDamping,J.gravityScale=this.m_gravityScale,J.angularVelocity=this.m_angularVelocity,J.fixedRotation=this.m_fixedRotationFlag,J.bullet=this.m_bulletFlag,J.awake=this.m_awakeFlag,J.linearDamping=this.m_linearDamping,J.linearVelocity.Copy(this.GetLinearVelocity()),J.position.Copy(this.GetPosition()),J.userData=this.GetUserData(),J},ae.prototype.ApplyForce=function(J,q,se){se===void 0&&(se=!0),this.m_type===w.b2BodyType.b2_dynamicBody&&(se&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=J.x,this.m_force.y+=J.y,this.m_torque+=(q.x-this.m_sweep.c.x)*J.y-(q.y-this.m_sweep.c.y)*J.x))},ae.prototype.ApplyForceToCenter=function(J,q){q===void 0&&(q=!0),this.m_type===w.b2BodyType.b2_dynamicBody&&(q&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=J.x,this.m_force.y+=J.y))},ae.prototype.ApplyTorque=function(J,q){q===void 0&&(q=!0),this.m_type===w.b2BodyType.b2_dynamicBody&&(q&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_torque+=J))},ae.prototype.ApplyLinearImpulse=function(J,q,se){se===void 0&&(se=!0),this.m_type===w.b2BodyType.b2_dynamicBody&&(se&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*J.x,this.m_linearVelocity.y+=this.m_invMass*J.y,this.m_angularVelocity+=this.m_invI*((q.x-this.m_sweep.c.x)*J.y-(q.y-this.m_sweep.c.y)*J.x)))},ae.prototype.ApplyLinearImpulseToCenter=function(J,q){q===void 0&&(q=!0),this.m_type===w.b2BodyType.b2_dynamicBody&&(q&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*J.x,this.m_linearVelocity.y+=this.m_invMass*J.y))},ae.prototype.ApplyAngularImpulse=function(J,q){q===void 0&&(q=!0),this.m_type===w.b2BodyType.b2_dynamicBody&&(q&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*J))},ae.prototype.GetMass=function(){return this.m_mass},ae.prototype.GetInertia=function(){return this.m_I+this.m_mass*K.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter)},ae.prototype.GetMassData=function(J){return J.mass=this.m_mass,J.I=this.m_I+this.m_mass*K.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter),J.center.Copy(this.m_sweep.localCenter),J},ae.prototype.SetMassData=function(J){if(this.m_world.IsLocked())throw new Error;if(this.m_type===w.b2BodyType.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=J.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,J.I>0&&!this.m_fixedRotationFlag&&(this.m_I=J.I-this.m_mass*K.DotVV(J.center,J.center),this.m_invI=1/this.m_I);var q=ae.SetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(J.center),de.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),K.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,K.SubVV(this.m_sweep.c,q,K.s_t0),this.m_linearVelocity)}},ae.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type===w.b2BodyType.b2_staticBody||this.m_type===w.b2BodyType.b2_kinematicBody)return this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);for(var J=ae.ResetMassData_s_localCenter.SetZero(),q=this.m_fixtureList;q;q=q.m_next)if(q.m_density!==0){var se=q.GetMassData(ae.ResetMassData_s_massData);this.m_mass+=se.mass,J.x+=se.center.x*se.mass,J.y+=se.center.y*se.mass,this.m_I+=se.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,J.x*=this.m_invMass,J.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&!this.m_fixedRotationFlag?(this.m_I-=this.m_mass*K.DotVV(J,J),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var ve=ae.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(J),de.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),K.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,K.SubVV(this.m_sweep.c,ve,K.s_t0),this.m_linearVelocity)},ae.prototype.GetWorldPoint=function(J,q){return de.MulXV(this.m_xf,J,q)},ae.prototype.GetWorldVector=function(J,q){return oe.MulRV(this.m_xf.q,J,q)},ae.prototype.GetLocalPoint=function(J,q){return de.MulTXV(this.m_xf,J,q)},ae.prototype.GetLocalVector=function(J,q){return oe.MulTRV(this.m_xf.q,J,q)},ae.prototype.GetLinearVelocityFromWorldPoint=function(J,q){return K.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,K.SubVV(J,this.m_sweep.c,K.s_t0),q)},ae.prototype.GetLinearVelocityFromLocalPoint=function(J,q){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(J,q),q)},ae.prototype.GetLinearDamping=function(){return this.m_linearDamping},ae.prototype.SetLinearDamping=function(J){this.m_linearDamping=J},ae.prototype.GetAngularDamping=function(){return this.m_angularDamping},ae.prototype.SetAngularDamping=function(J){this.m_angularDamping=J},ae.prototype.GetGravityScale=function(){return this.m_gravityScale},ae.prototype.SetGravityScale=function(J){this.m_gravityScale=J},ae.prototype.SetType=function(J){if(this.m_world.IsLocked())throw new Error;if(this.m_type!==J){this.m_type=J,this.ResetMassData(),this.m_type===w.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var q=this.m_contactList;q;){var se=q;q=q.next,this.m_world.m_contactManager.Destroy(se.contact)}this.m_contactList=null;for(var ve=this.m_fixtureList;ve;ve=ve.m_next)ve.TouchProxies()}},ae.prototype.GetType=function(){return this.m_type},ae.prototype.SetBullet=function(J){this.m_bulletFlag=J},ae.prototype.IsBullet=function(){return this.m_bulletFlag},ae.prototype.SetSleepingAllowed=function(J){this.m_autoSleepFlag=J,J||this.SetAwake(!0)},ae.prototype.IsSleepingAllowed=function(){return this.m_autoSleepFlag},ae.prototype.SetAwake=function(J){J?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},ae.prototype.IsAwake=function(){return this.m_awakeFlag},ae.prototype.SetActive=function(J){if(this.m_world.IsLocked())throw new Error;if(J!==this.IsActive())if(this.m_activeFlag=J,J)for(var q=this.m_fixtureList;q;q=q.m_next)q.CreateProxies(this.m_xf);else{for(q=this.m_fixtureList;q;q=q.m_next)q.DestroyProxies();for(var se=this.m_contactList;se;){var ve=se;se=se.next,this.m_world.m_contactManager.Destroy(ve.contact)}this.m_contactList=null}},ae.prototype.IsActive=function(){return this.m_activeFlag},ae.prototype.SetFixedRotation=function(J){this.m_fixedRotationFlag!==J&&(this.m_fixedRotationFlag=J,this.m_angularVelocity=0,this.ResetMassData())},ae.prototype.IsFixedRotation=function(){return this.m_fixedRotationFlag},ae.prototype.GetFixtureList=function(){return this.m_fixtureList},ae.prototype.GetJointList=function(){return this.m_jointList},ae.prototype.GetContactList=function(){return this.m_contactList},ae.prototype.GetNext=function(){return this.m_next},ae.prototype.GetUserData=function(){return this.m_userData},ae.prototype.SetUserData=function(J){this.m_userData=J},ae.prototype.GetWorld=function(){return this.m_world},ae.prototype.Dump=function(J){var q=this.m_islandIndex;J("{\n"),J("  const bd: b2BodyDef = new b2BodyDef();\n");var se="";switch(this.m_type){case w.b2BodyType.b2_staticBody:se="b2BodyType.b2_staticBody";break;case w.b2BodyType.b2_kinematicBody:se="b2BodyType.b2_kinematicBody";break;case w.b2BodyType.b2_dynamicBody:se="b2BodyType.b2_dynamicBody"}J("  bd.type = %s;\n",se),J("  bd.position.Set(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y),J("  bd.angle = %.15f;\n",this.m_sweep.a),J("  bd.linearVelocity.Set(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y),J("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity),J("  bd.linearDamping = %.15f;\n",this.m_linearDamping),J("  bd.angularDamping = %.15f;\n",this.m_angularDamping),J("  bd.allowSleep = %s;\n",this.m_autoSleepFlag?"true":"false"),J("  bd.awake = %s;\n",this.m_awakeFlag?"true":"false"),J("  bd.fixedRotation = %s;\n",this.m_fixedRotationFlag?"true":"false"),J("  bd.bullet = %s;\n",this.m_bulletFlag?"true":"false"),J("  bd.active = %s;\n",this.m_activeFlag?"true":"false"),J("  bd.gravityScale = %.15f;\n",this.m_gravityScale),J("\n"),J("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex),J("\n");for(var ve=this.m_fixtureList;ve;ve=ve.m_next)J("  {\n"),ve.Dump(J,q),J("  }\n");J("}\n")},ae.prototype.SynchronizeFixtures=function(){var J=ae.SynchronizeFixtures_s_xf1;J.q.SetAngle(this.m_sweep.a0),oe.MulRV(J.q,this.m_sweep.localCenter,J.p),K.SubVV(this.m_sweep.c0,J.p,J.p);for(var q=this.m_fixtureList;q;q=q.m_next)q.Synchronize(J,this.m_xf)},ae.prototype.SynchronizeTransform=function(){this.m_xf.q.SetAngle(this.m_sweep.a),oe.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),K.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)},ae.prototype.ShouldCollide=function(J){return(this.m_type!==w.b2BodyType.b2_staticBody||J.m_type!==w.b2BodyType.b2_staticBody)&&this.ShouldCollideConnected(J)},ae.prototype.ShouldCollideConnected=function(J){for(var q=this.m_jointList;q;q=q.next)if(q.other===J&&!q.joint.m_collideConnected)return!1;return!0},ae.prototype.Advance=function(J){this.m_sweep.Advance(J),this.m_sweep.c.Copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_xf.q.SetAngle(this.m_sweep.a),oe.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),K.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)},ae.prototype.GetControllerList=function(){return this.m_controllerList},ae.prototype.GetControllerCount=function(){return this.m_controllerCount},ae.CreateFixtureShapeDensity_s_def=new Zn,ae.SetMassData_s_oldCenter=new K,ae.ResetMassData_s_localCenter=new K,ae.ResetMassData_s_oldCenter=new K,ae.ResetMassData_s_massData=new Wi,ae.SynchronizeFixtures_s_xf1=new de,ae}();(Cr=w.b2JointType||(w.b2JointType={}))[Cr.e_unknownJoint=0]="e_unknownJoint",Cr[Cr.e_revoluteJoint=1]="e_revoluteJoint",Cr[Cr.e_prismaticJoint=2]="e_prismaticJoint",Cr[Cr.e_distanceJoint=3]="e_distanceJoint",Cr[Cr.e_pulleyJoint=4]="e_pulleyJoint",Cr[Cr.e_mouseJoint=5]="e_mouseJoint",Cr[Cr.e_gearJoint=6]="e_gearJoint",Cr[Cr.e_wheelJoint=7]="e_wheelJoint",Cr[Cr.e_weldJoint=8]="e_weldJoint",Cr[Cr.e_frictionJoint=9]="e_frictionJoint",Cr[Cr.e_ropeJoint=10]="e_ropeJoint",Cr[Cr.e_motorJoint=11]="e_motorJoint",Cr[Cr.e_areaJoint=12]="e_areaJoint",(ri=w.b2LimitState||(w.b2LimitState={}))[ri.e_inactiveLimit=0]="e_inactiveLimit",ri[ri.e_atLowerLimit=1]="e_atLowerLimit",ri[ri.e_atUpperLimit=2]="e_atUpperLimit",ri[ri.e_equalLimits=3]="e_equalLimits";var Xa=function(){function ae(){this.linear=new K,this.angularA=0,this.angularB=0}return ae.prototype.SetZero=function(){return this.linear.SetZero(),this.angularA=0,this.angularB=0,this},ae.prototype.Set=function(J,q,se){return this.linear.Copy(J),this.angularA=q,this.angularB=se,this},ae}(),_n=function(ae,J){this.prev=null,this.next=null,this.joint=ae,this.other=J},Fr=function(ae){this.type=w.b2JointType.e_unknownJoint,this.userData=null,this.collideConnected=!1,this.type=ae},Vr=function(){function ae(J){this.m_type=w.b2JointType.e_unknownJoint,this.m_prev=null,this.m_next=null,this.m_index=0,this.m_islandFlag=!1,this.m_collideConnected=!1,this.m_userData=null,this.m_type=J.type,this.m_edgeA=new _n(this,J.bodyB),this.m_edgeB=new _n(this,J.bodyA),this.m_bodyA=J.bodyA,this.m_bodyB=J.bodyB,this.m_collideConnected=B(J.collideConnected,!1),this.m_userData=J.userData}return ae.prototype.GetType=function(){return this.m_type},ae.prototype.GetBodyA=function(){return this.m_bodyA},ae.prototype.GetBodyB=function(){return this.m_bodyB},ae.prototype.GetNext=function(){return this.m_next},ae.prototype.GetUserData=function(){return this.m_userData},ae.prototype.SetUserData=function(J){this.m_userData=J},ae.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},ae.prototype.GetCollideConnected=function(){return this.m_collideConnected},ae.prototype.Dump=function(J){J("// Dump is not supported for this joint type.\n")},ae.prototype.ShiftOrigin=function(){},ae}(),$n=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_distanceJoint)||this;return q.localAnchorA=new K,q.localAnchorB=new K,q.length=1,q.frequencyHz=0,q.dampingRatio=0,q}return sr(J,ae),J.prototype.Initialize=function(q,se,ve,xe){this.bodyA=q,this.bodyB=se,this.bodyA.GetLocalPoint(ve,this.localAnchorA),this.bodyB.GetLocalPoint(xe,this.localAnchorB),this.length=K.DistanceVV(ve,xe),this.frequencyHz=0,this.dampingRatio=0},J}(Fr),Qn=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_frequencyHz=0,se.m_dampingRatio=0,se.m_bias=0,se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_gamma=0,se.m_impulse=0,se.m_length=0,se.m_indexA=0,se.m_indexB=0,se.m_u=new K,se.m_rA=new K,se.m_rB=new K,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_mass=0,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_frequencyHz=B(q.frequencyHz,0),se.m_dampingRatio=B(q.dampingRatio,0),se.m_localAnchorA.Copy(q.localAnchorA),se.m_localAnchorB.Copy(q.localAnchorB),se.m_length=q.length,se}return sr(J,ae),J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return se.x=q*this.m_impulse*this.m_u.x,se.y=q*this.m_impulse*this.m_u.y,se},J.prototype.GetReactionTorque=function(){return 0},J.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},J.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},J.prototype.SetLength=function(q){this.m_length=q},J.prototype.Length=function(){return this.m_length},J.prototype.SetFrequency=function(q){this.m_frequencyHz=q},J.prototype.GetFrequency=function(){return this.m_frequencyHz},J.prototype.SetDampingRatio=function(q){this.m_dampingRatio=q},J.prototype.GetDampingRatio=function(){return this.m_dampingRatio},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2DistanceJointDef = new b2DistanceJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.length = %.15f;\n",this.m_length),q("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),q("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.velocities[this.m_indexA].v,Ie=q.velocities[this.m_indexA].w,Me=q.positions[this.m_indexB].c,Le=q.positions[this.m_indexB].a,Ge=q.velocities[this.m_indexB].v,He=q.velocities[this.m_indexB].w,Ye=this.m_qA.SetAngle(ve),Je=this.m_qB.SetAngle(Le);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),oe.MulRV(Ye,this.m_lalcA,this.m_rA),K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),oe.MulRV(Je,this.m_lalcB,this.m_rB),this.m_u.x=Me.x+this.m_rB.x-se.x-this.m_rA.x,this.m_u.y=Me.y+this.m_rB.y-se.y-this.m_rA.y;var ze=this.m_u.Length();ze>I?this.m_u.SelfMul(1/ze):this.m_u.SetZero();var Ke=K.CrossVV(this.m_rA,this.m_u),et=K.CrossVV(this.m_rB,this.m_u),it=this.m_invMassA+this.m_invIA*Ke*Ke+this.m_invMassB+this.m_invIB*et*et;if(this.m_mass=it!==0?1/it:0,this.m_frequencyHz>0){var ct=ze-this.m_length,mt=2*P*this.m_frequencyHz,vt=2*this.m_mass*this.m_dampingRatio*mt,Tt=this.m_mass*mt*mt,wt=q.step.dt;this.m_gamma=wt*(vt+wt*Tt),this.m_gamma=this.m_gamma!==0?1/this.m_gamma:0,this.m_bias=ct*wt*Tt*this.m_gamma,it+=this.m_gamma,this.m_mass=it!==0?1/it:0}else this.m_gamma=0,this.m_bias=0;if(q.step.warmStarting){this.m_impulse*=q.step.dtRatio;var Pt=K.MulSV(this.m_impulse,this.m_u,J.InitVelocityConstraints_s_P);xe.SelfMulSub(this.m_invMassA,Pt),Ie-=this.m_invIA*K.CrossVV(this.m_rA,Pt),Ge.SelfMulAdd(this.m_invMassB,Pt),He+=this.m_invIB*K.CrossVV(this.m_rB,Pt)}else this.m_impulse=0;q.velocities[this.m_indexA].w=Ie,q.velocities[this.m_indexB].w=He},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=K.AddVCrossSV(se,ve,this.m_rA,J.SolveVelocityConstraints_s_vpA),Le=K.AddVCrossSV(xe,Ie,this.m_rB,J.SolveVelocityConstraints_s_vpB),Ge=K.DotVV(this.m_u,K.SubVV(Le,Me,K.s_t0)),He=-this.m_mass*(Ge+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=He;var Ye=K.MulSV(He,this.m_u,J.SolveVelocityConstraints_s_P);se.SelfMulSub(this.m_invMassA,Ye),ve-=this.m_invIA*K.CrossVV(this.m_rA,Ye),xe.SelfMulAdd(this.m_invMassB,Ye),Ie+=this.m_invIB*K.CrossVV(this.m_rB,Ye),q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(q){if(this.m_frequencyHz>0)return!0;var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.positions[this.m_indexB].c,Ie=q.positions[this.m_indexB].a,Me=this.m_qA.SetAngle(ve),Le=this.m_qB.SetAngle(Ie),Ge=oe.MulRV(Me,this.m_lalcA,this.m_rA),He=oe.MulRV(Le,this.m_lalcB,this.m_rB),Ye=this.m_u;Ye.x=xe.x+He.x-se.x-Ge.x,Ye.y=xe.y+He.y-se.y-Ge.y;var Je=this.m_u.Normalize()-this.m_length;Je=Y(Je,-.2,.2);var ze=-this.m_mass*Je,Ke=K.MulSV(ze,Ye,J.SolvePositionConstraints_s_P);return se.SelfMulSub(this.m_invMassA,Ke),ve-=this.m_invIA*K.CrossVV(Ge,Ke),xe.SelfMulAdd(this.m_invMassB,Ke),Ie+=this.m_invIB*K.CrossVV(He,Ke),q.positions[this.m_indexA].a=ve,q.positions[this.m_indexB].a=Ie,H(Je)<I},J.InitVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_vpA=new K,J.SolveVelocityConstraints_s_vpB=new K,J.SolveVelocityConstraints_s_P=new K,J.SolvePositionConstraints_s_P=new K,J}(Vr),Ya=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_areaJoint)||this;return q.bodies=[],q.frequencyHz=0,q.dampingRatio=0,q}return sr(J,ae),J.prototype.AddBody=function(q){this.bodies.push(q),this.bodies.length===1?this.bodyA=q:this.bodies.length===2&&(this.bodyB=q)},J}(Fr),qn=function(ae){function J(q){var se=ae.call(this,q)||this;se.m_frequencyHz=0,se.m_dampingRatio=0,se.m_impulse=0,se.m_targetArea=0,se.m_bodies=q.bodies,se.m_frequencyHz=B(q.frequencyHz,0),se.m_dampingRatio=B(q.dampingRatio,0),se.m_targetLengths=j(q.bodies.length),se.m_normals=K.MakeArray(q.bodies.length),se.m_joints=[],se.m_deltas=K.MakeArray(q.bodies.length),se.m_delta=new K;var ve=new $n;ve.frequencyHz=se.m_frequencyHz,ve.dampingRatio=se.m_dampingRatio,se.m_targetArea=0;for(var xe=0;xe<se.m_bodies.length;++xe){var Ie=se.m_bodies[xe],Me=se.m_bodies[(xe+1)%se.m_bodies.length],Le=Ie.GetWorldCenter(),Ge=Me.GetWorldCenter();se.m_targetLengths[xe]=K.DistanceVV(Le,Ge),se.m_targetArea+=K.CrossVV(Le,Ge),ve.Initialize(Ie,Me,Le,Ge),se.m_joints[xe]=Ie.GetWorld().CreateJoint(ve)}return se.m_targetArea*=.5,se}return sr(J,ae),J.prototype.GetAnchorA=function(q){return q},J.prototype.GetAnchorB=function(q){return q},J.prototype.GetReactionForce=function(q,se){return se},J.prototype.GetReactionTorque=function(){return 0},J.prototype.SetFrequency=function(q){this.m_frequencyHz=q;for(var se=0;se<this.m_joints.length;++se)this.m_joints[se].SetFrequency(q)},J.prototype.GetFrequency=function(){return this.m_frequencyHz},J.prototype.SetDampingRatio=function(q){this.m_dampingRatio=q;for(var se=0;se<this.m_joints.length;++se)this.m_joints[se].SetDampingRatio(q)},J.prototype.GetDampingRatio=function(){return this.m_dampingRatio},J.prototype.Dump=function(q){q("Area joint dumping is not supported.\n")},J.prototype.InitVelocityConstraints=function(q){for(var se=0;se<this.m_bodies.length;++se){var ve=this.m_bodies[(se+this.m_bodies.length-1)%this.m_bodies.length],xe=this.m_bodies[(se+1)%this.m_bodies.length],Ie=q.positions[ve.m_islandIndex].c,Me=q.positions[xe.m_islandIndex].c,Le=this.m_deltas[se];K.SubVV(Me,Ie,Le)}if(q.step.warmStarting)for(this.m_impulse*=q.step.dtRatio,se=0;se<this.m_bodies.length;++se){var Ge=this.m_bodies[se],He=q.velocities[Ge.m_islandIndex].v;Le=this.m_deltas[se],He.x+=Ge.m_invMass*Le.y*.5*this.m_impulse,He.y+=Ge.m_invMass*-Le.x*.5*this.m_impulse}else this.m_impulse=0},J.prototype.SolveVelocityConstraints=function(q){for(var se=0,ve=0,xe=0;xe<this.m_bodies.length;++xe){var Ie=this.m_bodies[xe],Me=q.velocities[Ie.m_islandIndex].v;se+=(Ge=this.m_deltas[xe]).LengthSquared()/Ie.GetMass(),ve+=K.CrossVV(Me,Ge)}var Le=-2*ve/se;for(this.m_impulse+=Le,xe=0;xe<this.m_bodies.length;++xe){Ie=this.m_bodies[xe],Me=q.velocities[Ie.m_islandIndex].v;var Ge=this.m_deltas[xe];Me.x+=Ie.m_invMass*Ge.y*.5*Le,Me.y+=Ie.m_invMass*-Ge.x*.5*Le}},J.prototype.SolvePositionConstraints=function(q){for(var se=0,ve=0,xe=0;xe<this.m_bodies.length;++xe){var Ie=this.m_bodies[xe],Me=this.m_bodies[(xe+1)%this.m_bodies.length],Le=q.positions[Ie.m_islandIndex].c,Ge=q.positions[Me.m_islandIndex].c,He=(ze=K.SubVV(Ge,Le,this.m_delta)).Length();He<O&&(He=1),this.m_normals[xe].x=ze.y/He,this.m_normals[xe].y=-ze.x/He,se+=He,ve+=K.CrossVV(Le,Ge)}ve*=.5;var Ye=.5*(this.m_targetArea-ve)/se,Je=!0;for(xe=0;xe<this.m_bodies.length;++xe){Ie=this.m_bodies[xe],Le=q.positions[Ie.m_islandIndex].c;var ze,Ke=(xe+1)%this.m_bodies.length;(ze=K.AddVV(this.m_normals[xe],this.m_normals[Ke],this.m_delta)).SelfMul(Ye);var et=ze.LengthSquared();et>W(.2)&&ze.SelfMul(.2/ee(et)),et>W(I)&&(Je=!1),Le.x+=ze.x,Le.y+=ze.y}return Je},J}(Vr),Wa=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_frictionJoint)||this;return q.localAnchorA=new K,q.localAnchorB=new K,q.maxForce=0,q.maxTorque=0,q}return sr(J,ae),J.prototype.Initialize=function(q,se,ve){this.bodyA=q,this.bodyB=se,this.bodyA.GetLocalPoint(ve,this.localAnchorA),this.bodyB.GetLocalPoint(ve,this.localAnchorB)},J}(Fr),es=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_linearImpulse=new K,se.m_angularImpulse=0,se.m_maxForce=0,se.m_maxTorque=0,se.m_indexA=0,se.m_indexB=0,se.m_rA=new K,se.m_rB=new K,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_linearMass=new ce,se.m_angularMass=0,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_K=new ce,se.m_localAnchorA.Copy(q.localAnchorA),se.m_localAnchorB.Copy(q.localAnchorB),se.m_linearImpulse.SetZero(),se.m_maxForce=B(q.maxForce,0),se.m_maxTorque=B(q.maxTorque,0),se.m_linearMass.SetZero(),se}return sr(J,ae),J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].a,ve=q.velocities[this.m_indexA].v,xe=q.velocities[this.m_indexA].w,Ie=q.positions[this.m_indexB].a,Me=q.velocities[this.m_indexB].v,Le=q.velocities[this.m_indexB].w,Ge=this.m_qA.SetAngle(se),He=this.m_qB.SetAngle(Ie);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var Ye=oe.MulRV(Ge,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var Je=oe.MulRV(He,this.m_lalcB,this.m_rB),ze=this.m_invMassA,Ke=this.m_invMassB,et=this.m_invIA,it=this.m_invIB,ct=this.m_K;if(ct.ex.x=ze+Ke+et*Ye.y*Ye.y+it*Je.y*Je.y,ct.ex.y=-et*Ye.x*Ye.y-it*Je.x*Je.y,ct.ey.x=ct.ex.y,ct.ey.y=ze+Ke+et*Ye.x*Ye.x+it*Je.x*Je.x,ct.GetInverse(this.m_linearMass),this.m_angularMass=et+it,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),q.step.warmStarting){this.m_linearImpulse.SelfMul(q.step.dtRatio),this.m_angularImpulse*=q.step.dtRatio;var mt=this.m_linearImpulse;ve.SelfMulSub(ze,mt),xe-=et*(K.CrossVV(this.m_rA,mt)+this.m_angularImpulse),Me.SelfMulAdd(Ke,mt),Le+=it*(K.CrossVV(this.m_rB,mt)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;q.velocities[this.m_indexA].w=xe,q.velocities[this.m_indexB].w=Le},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=this.m_invMassA,Le=this.m_invMassB,Ge=this.m_invIA,He=this.m_invIB,Ye=q.step.dt,Je=Ie-ve,ze=-this.m_angularMass*Je,Ke=this.m_angularImpulse,et=Ye*this.m_maxTorque;this.m_angularImpulse=Y(this.m_angularImpulse+ze,-et,et),ve-=Ge*(ze=this.m_angularImpulse-Ke),Ie+=He*ze;var it=K.SubVV(K.AddVCrossSV(xe,Ie,this.m_rB,K.s_t0),K.AddVCrossSV(se,ve,this.m_rA,K.s_t1),J.SolveVelocityConstraints_s_Cdot_v2),ct=ce.MulMV(this.m_linearMass,it,J.SolveVelocityConstraints_s_impulseV).SelfNeg(),mt=J.SolveVelocityConstraints_s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(ct),et=Ye*this.m_maxForce,this.m_linearImpulse.LengthSquared()>et*et&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(et)),K.SubVV(this.m_linearImpulse,mt,ct),se.SelfMulSub(Me,ct),ve-=Ge*K.CrossVV(this.m_rA,ct),xe.SelfMulAdd(Le,ct),Ie+=He*K.CrossVV(this.m_rB,ct),q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(){return!0},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return se.x=q*this.m_linearImpulse.x,se.y=q*this.m_linearImpulse.y,se},J.prototype.GetReactionTorque=function(q){return q*this.m_angularImpulse},J.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},J.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},J.prototype.SetMaxForce=function(q){this.m_maxForce=q},J.prototype.GetMaxForce=function(){return this.m_maxForce},J.prototype.SetMaxTorque=function(q){this.m_maxTorque=q},J.prototype.GetMaxTorque=function(){return this.m_maxTorque},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2FrictionJointDef = new b2FrictionJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.maxForce = %.15f;\n",this.m_maxForce),q("  jd.maxTorque = %.15f;\n",this.m_maxTorque),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.SolveVelocityConstraints_s_Cdot_v2=new K,J.SolveVelocityConstraints_s_impulseV=new K,J.SolveVelocityConstraints_s_oldImpulseV=new K,J}(Vr),za=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_gearJoint)||this;return q.ratio=1,q}return sr(J,ae),J}(Fr),ts=function(ae){function J(q){var se,ve,xe=ae.call(this,q)||this;xe.m_typeA=w.b2JointType.e_unknownJoint,xe.m_typeB=w.b2JointType.e_unknownJoint,xe.m_localAnchorA=new K,xe.m_localAnchorB=new K,xe.m_localAnchorC=new K,xe.m_localAnchorD=new K,xe.m_localAxisC=new K,xe.m_localAxisD=new K,xe.m_referenceAngleA=0,xe.m_referenceAngleB=0,xe.m_constant=0,xe.m_ratio=0,xe.m_impulse=0,xe.m_indexA=0,xe.m_indexB=0,xe.m_indexC=0,xe.m_indexD=0,xe.m_lcA=new K,xe.m_lcB=new K,xe.m_lcC=new K,xe.m_lcD=new K,xe.m_mA=0,xe.m_mB=0,xe.m_mC=0,xe.m_mD=0,xe.m_iA=0,xe.m_iB=0,xe.m_iC=0,xe.m_iD=0,xe.m_JvAC=new K,xe.m_JvBD=new K,xe.m_JwA=0,xe.m_JwB=0,xe.m_JwC=0,xe.m_JwD=0,xe.m_mass=0,xe.m_qA=new oe,xe.m_qB=new oe,xe.m_qC=new oe,xe.m_qD=new oe,xe.m_lalcA=new K,xe.m_lalcB=new K,xe.m_lalcC=new K,xe.m_lalcD=new K,xe.m_joint1=q.joint1,xe.m_joint2=q.joint2,xe.m_typeA=xe.m_joint1.GetType(),xe.m_typeB=xe.m_joint2.GetType(),xe.m_bodyC=xe.m_joint1.GetBodyA(),xe.m_bodyA=xe.m_joint1.GetBodyB();var Ie=xe.m_bodyA.m_xf,Me=xe.m_bodyA.m_sweep.a,Le=xe.m_bodyC.m_xf,Ge=xe.m_bodyC.m_sweep.a;if(xe.m_typeA===w.b2JointType.e_revoluteJoint){var He=q.joint1;xe.m_localAnchorC.Copy(He.m_localAnchorA),xe.m_localAnchorA.Copy(He.m_localAnchorB),xe.m_referenceAngleA=He.m_referenceAngle,xe.m_localAxisC.SetZero(),se=Me-Ge-xe.m_referenceAngleA}else{var Ye=q.joint1;xe.m_localAnchorC.Copy(Ye.m_localAnchorA),xe.m_localAnchorA.Copy(Ye.m_localAnchorB),xe.m_referenceAngleA=Ye.m_referenceAngle,xe.m_localAxisC.Copy(Ye.m_localXAxisA);var Je=xe.m_localAnchorC,ze=oe.MulTRV(Le.q,K.AddVV(oe.MulRV(Ie.q,xe.m_localAnchorA,K.s_t0),K.SubVV(Ie.p,Le.p,K.s_t1),K.s_t0),K.s_t0);se=K.DotVV(K.SubVV(ze,Je,K.s_t0),xe.m_localAxisC)}xe.m_bodyD=xe.m_joint2.GetBodyA(),xe.m_bodyB=xe.m_joint2.GetBodyB();var Ke=xe.m_bodyB.m_xf,et=xe.m_bodyB.m_sweep.a,it=xe.m_bodyD.m_xf,ct=xe.m_bodyD.m_sweep.a;if(xe.m_typeB===w.b2JointType.e_revoluteJoint)He=q.joint2,xe.m_localAnchorD.Copy(He.m_localAnchorA),xe.m_localAnchorB.Copy(He.m_localAnchorB),xe.m_referenceAngleB=He.m_referenceAngle,xe.m_localAxisD.SetZero(),ve=et-ct-xe.m_referenceAngleB;else{Ye=q.joint2,xe.m_localAnchorD.Copy(Ye.m_localAnchorA),xe.m_localAnchorB.Copy(Ye.m_localAnchorB),xe.m_referenceAngleB=Ye.m_referenceAngle,xe.m_localAxisD.Copy(Ye.m_localXAxisA);var mt=xe.m_localAnchorD,vt=oe.MulTRV(it.q,K.AddVV(oe.MulRV(Ke.q,xe.m_localAnchorB,K.s_t0),K.SubVV(Ke.p,it.p,K.s_t1),K.s_t0),K.s_t0);ve=K.DotVV(K.SubVV(vt,mt,K.s_t0),xe.m_localAxisD)}return xe.m_ratio=B(q.ratio,1),xe.m_constant=se+xe.m_ratio*ve,xe.m_impulse=0,xe}return sr(J,ae),J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var se=q.positions[this.m_indexA].a,ve=q.velocities[this.m_indexA].v,xe=q.velocities[this.m_indexA].w,Ie=q.positions[this.m_indexB].a,Me=q.velocities[this.m_indexB].v,Le=q.velocities[this.m_indexB].w,Ge=q.positions[this.m_indexC].a,He=q.velocities[this.m_indexC].v,Ye=q.velocities[this.m_indexC].w,Je=q.positions[this.m_indexD].a,ze=q.velocities[this.m_indexD].v,Ke=q.velocities[this.m_indexD].w,et=this.m_qA.SetAngle(se),it=this.m_qB.SetAngle(Ie),ct=this.m_qC.SetAngle(Ge),mt=this.m_qD.SetAngle(Je);if(this.m_mass=0,this.m_typeA===w.b2JointType.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var vt=oe.MulRV(ct,this.m_localAxisC,J.InitVelocityConstraints_s_u);K.SubVV(this.m_localAnchorC,this.m_lcC,this.m_lalcC);var Tt=oe.MulRV(ct,this.m_lalcC,J.InitVelocityConstraints_s_rC);K.SubVV(this.m_localAnchorA,this.m_lcA,this.m_lalcA);var wt=oe.MulRV(et,this.m_lalcA,J.InitVelocityConstraints_s_rA);this.m_JvAC.Copy(vt),this.m_JwC=K.CrossVV(Tt,vt),this.m_JwA=K.CrossVV(wt,vt),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB===w.b2JointType.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{vt=oe.MulRV(mt,this.m_localAxisD,J.InitVelocityConstraints_s_u),K.SubVV(this.m_localAnchorD,this.m_lcD,this.m_lalcD);var Pt=oe.MulRV(mt,this.m_lalcD,J.InitVelocityConstraints_s_rD);K.SubVV(this.m_localAnchorB,this.m_lcB,this.m_lalcB);var Bt=oe.MulRV(it,this.m_lalcB,J.InitVelocityConstraints_s_rB);K.MulSV(this.m_ratio,vt,this.m_JvBD),this.m_JwD=this.m_ratio*K.CrossVV(Pt,vt),this.m_JwB=this.m_ratio*K.CrossVV(Bt,vt),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,q.step.warmStarting?(ve.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),xe+=this.m_iA*this.m_impulse*this.m_JwA,Me.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),Le+=this.m_iB*this.m_impulse*this.m_JwB,He.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),Ye-=this.m_iC*this.m_impulse*this.m_JwC,ze.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),Ke-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,q.velocities[this.m_indexA].w=xe,q.velocities[this.m_indexB].w=Le,q.velocities[this.m_indexC].w=Ye,q.velocities[this.m_indexD].w=Ke},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=q.velocities[this.m_indexC].v,Le=q.velocities[this.m_indexC].w,Ge=q.velocities[this.m_indexD].v,He=q.velocities[this.m_indexD].w,Ye=K.DotVV(this.m_JvAC,K.SubVV(se,Me,K.s_t0))+K.DotVV(this.m_JvBD,K.SubVV(xe,Ge,K.s_t0));Ye+=this.m_JwA*ve-this.m_JwC*Le+(this.m_JwB*Ie-this.m_JwD*He);var Je=-this.m_mass*Ye;this.m_impulse+=Je,se.SelfMulAdd(this.m_mA*Je,this.m_JvAC),ve+=this.m_iA*Je*this.m_JwA,xe.SelfMulAdd(this.m_mB*Je,this.m_JvBD),Ie+=this.m_iB*Je*this.m_JwB,Me.SelfMulSub(this.m_mC*Je,this.m_JvAC),Le-=this.m_iC*Je*this.m_JwC,Ge.SelfMulSub(this.m_mD*Je,this.m_JvBD),He-=this.m_iD*Je*this.m_JwD,q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie,q.velocities[this.m_indexC].w=Le,q.velocities[this.m_indexD].w=He},J.prototype.SolvePositionConstraints=function(q){var se,ve,xe,Ie,Me,Le,Ge=q.positions[this.m_indexA].c,He=q.positions[this.m_indexA].a,Ye=q.positions[this.m_indexB].c,Je=q.positions[this.m_indexB].a,ze=q.positions[this.m_indexC].c,Ke=q.positions[this.m_indexC].a,et=q.positions[this.m_indexD].c,it=q.positions[this.m_indexD].a,ct=this.m_qA.SetAngle(He),mt=this.m_qB.SetAngle(Je),vt=this.m_qC.SetAngle(Ke),Tt=this.m_qD.SetAngle(it),wt=this.m_JvAC,Pt=this.m_JvBD,Bt=0;if(this.m_typeA===w.b2JointType.e_revoluteJoint)wt.SetZero(),xe=1,Me=1,Bt+=this.m_iA+this.m_iC,se=He-Ke-this.m_referenceAngleA;else{var jt=oe.MulRV(vt,this.m_localAxisC,J.SolvePositionConstraints_s_u),Xt=oe.MulRV(vt,this.m_lalcC,J.SolvePositionConstraints_s_rC),Ht=oe.MulRV(ct,this.m_lalcA,J.SolvePositionConstraints_s_rA);wt.Copy(jt),Me=K.CrossVV(Xt,jt),xe=K.CrossVV(Ht,jt),Bt+=this.m_mC+this.m_mA+this.m_iC*Me*Me+this.m_iA*xe*xe;var $t=this.m_lalcC,Qt=oe.MulTRV(vt,K.AddVV(Ht,K.SubVV(Ge,ze,K.s_t0),K.s_t0),K.s_t0);se=K.DotVV(K.SubVV(Qt,$t,K.s_t0),this.m_localAxisC)}if(this.m_typeB===w.b2JointType.e_revoluteJoint)Pt.SetZero(),Ie=this.m_ratio,Le=this.m_ratio,Bt+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),ve=Je-it-this.m_referenceAngleB;else{jt=oe.MulRV(Tt,this.m_localAxisD,J.SolvePositionConstraints_s_u);var ur=oe.MulRV(Tt,this.m_lalcD,J.SolvePositionConstraints_s_rD),tr=oe.MulRV(mt,this.m_lalcB,J.SolvePositionConstraints_s_rB);K.MulSV(this.m_ratio,jt,Pt),Le=this.m_ratio*K.CrossVV(ur,jt),Ie=this.m_ratio*K.CrossVV(tr,jt),Bt+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*Le*Le+this.m_iB*Ie*Ie;var qt=this.m_lalcD,ar=oe.MulTRV(Tt,K.AddVV(tr,K.SubVV(Ye,et,K.s_t0),K.s_t0),K.s_t0);ve=K.DotVV(K.SubVV(ar,qt,K.s_t0),this.m_localAxisD)}var or=se+this.m_ratio*ve-this.m_constant,vr=0;return Bt>0&&(vr=-or/Bt),Ge.SelfMulAdd(this.m_mA*vr,wt),He+=this.m_iA*vr*xe,Ye.SelfMulAdd(this.m_mB*vr,Pt),Je+=this.m_iB*vr*Ie,ze.SelfMulSub(this.m_mC*vr,wt),Ke-=this.m_iC*vr*Me,et.SelfMulSub(this.m_mD*vr,Pt),it-=this.m_iD*vr*Le,q.positions[this.m_indexA].a=He,q.positions[this.m_indexB].a=Je,q.positions[this.m_indexC].a=Ke,q.positions[this.m_indexD].a=it,0<I},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return K.MulSV(q*this.m_impulse,this.m_JvAC,se)},J.prototype.GetReactionTorque=function(q){return q*this.m_impulse*this.m_JwA},J.prototype.GetJoint1=function(){return this.m_joint1},J.prototype.GetJoint2=function(){return this.m_joint2},J.prototype.GetRatio=function(){return this.m_ratio},J.prototype.SetRatio=function(q){this.m_ratio=q},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex,xe=this.m_joint1.m_index,Ie=this.m_joint2.m_index;q("  const jd: b2GearJointDef = new b2GearJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.joint1 = joints[%d];\n",xe),q("  jd.joint2 = joints[%d];\n",Ie),q("  jd.ratio = %.15f;\n",this.m_ratio),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.InitVelocityConstraints_s_u=new K,J.InitVelocityConstraints_s_rA=new K,J.InitVelocityConstraints_s_rB=new K,J.InitVelocityConstraints_s_rC=new K,J.InitVelocityConstraints_s_rD=new K,J.SolvePositionConstraints_s_u=new K,J.SolvePositionConstraints_s_rA=new K,J.SolvePositionConstraints_s_rB=new K,J.SolvePositionConstraints_s_rC=new K,J.SolvePositionConstraints_s_rD=new K,J}(Vr),Za=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_motorJoint)||this;return q.linearOffset=new K(0,0),q.angularOffset=0,q.maxForce=1,q.maxTorque=1,q.correctionFactor=.3,q}return sr(J,ae),J.prototype.Initialize=function(q,se){this.bodyA=q,this.bodyB=se,this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var ve=this.bodyA.GetAngle(),xe=this.bodyB.GetAngle();this.angularOffset=xe-ve},J}(Fr),rs=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_linearOffset=new K,se.m_angularOffset=0,se.m_linearImpulse=new K,se.m_angularImpulse=0,se.m_maxForce=0,se.m_maxTorque=0,se.m_correctionFactor=.3,se.m_indexA=0,se.m_indexB=0,se.m_rA=new K,se.m_rB=new K,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_linearError=new K,se.m_angularError=0,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_linearMass=new ce,se.m_angularMass=0,se.m_qA=new oe,se.m_qB=new oe,se.m_K=new ce,se.m_linearOffset.Copy(B(q.linearOffset,K.ZERO)),se.m_linearImpulse.SetZero(),se.m_maxForce=B(q.maxForce,0),se.m_maxTorque=B(q.maxTorque,0),se.m_correctionFactor=B(q.correctionFactor,.3),se}return sr(J,ae),J.prototype.GetAnchorA=function(q){var se=this.m_bodyA.GetPosition();return q.x=se.x,q.y=se.y,q},J.prototype.GetAnchorB=function(q){var se=this.m_bodyB.GetPosition();return q.x=se.x,q.y=se.y,q},J.prototype.GetReactionForce=function(q,se){return K.MulSV(q,this.m_linearImpulse,se)},J.prototype.GetReactionTorque=function(q){return q*this.m_angularImpulse},J.prototype.SetLinearOffset=function(q){K.IsEqualToV(q,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(q))},J.prototype.GetLinearOffset=function(){return this.m_linearOffset},J.prototype.SetAngularOffset=function(q){q!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=q)},J.prototype.GetAngularOffset=function(){return this.m_angularOffset},J.prototype.SetMaxForce=function(q){this.m_maxForce=q},J.prototype.GetMaxForce=function(){return this.m_maxForce},J.prototype.SetMaxTorque=function(q){this.m_maxTorque=q},J.prototype.GetMaxTorque=function(){return this.m_maxTorque},J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.velocities[this.m_indexA].v,Ie=q.velocities[this.m_indexA].w,Me=q.positions[this.m_indexB].c,Le=q.positions[this.m_indexB].a,Ge=q.velocities[this.m_indexB].v,He=q.velocities[this.m_indexB].w,Ye=this.m_qA.SetAngle(ve),Je=this.m_qB.SetAngle(Le),ze=oe.MulRV(Ye,K.SubVV(this.m_linearOffset,this.m_localCenterA,K.s_t0),this.m_rA),Ke=oe.MulRV(Je,K.NegV(this.m_localCenterB,K.s_t0),this.m_rB),et=this.m_invMassA,it=this.m_invMassB,ct=this.m_invIA,mt=this.m_invIB,vt=this.m_K;if(vt.ex.x=et+it+ct*ze.y*ze.y+mt*Ke.y*Ke.y,vt.ex.y=-ct*ze.x*ze.y-mt*Ke.x*Ke.y,vt.ey.x=vt.ex.y,vt.ey.y=et+it+ct*ze.x*ze.x+mt*Ke.x*Ke.x,vt.GetInverse(this.m_linearMass),this.m_angularMass=ct+mt,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),K.SubVV(K.AddVV(Me,Ke,K.s_t0),K.AddVV(se,ze,K.s_t1),this.m_linearError),this.m_angularError=Le-ve-this.m_angularOffset,q.step.warmStarting){this.m_linearImpulse.SelfMul(q.step.dtRatio),this.m_angularImpulse*=q.step.dtRatio;var Tt=this.m_linearImpulse;xe.SelfMulSub(et,Tt),Ie-=ct*(K.CrossVV(ze,Tt)+this.m_angularImpulse),Ge.SelfMulAdd(it,Tt),He+=mt*(K.CrossVV(Ke,Tt)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;q.velocities[this.m_indexA].w=Ie,q.velocities[this.m_indexB].w=He},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=this.m_invMassA,Le=this.m_invMassB,Ge=this.m_invIA,He=this.m_invIB,Ye=q.step.dt,Je=q.step.inv_dt,ze=Ie-ve+Je*this.m_correctionFactor*this.m_angularError,Ke=-this.m_angularMass*ze,et=this.m_angularImpulse,it=Ye*this.m_maxTorque;this.m_angularImpulse=Y(this.m_angularImpulse+Ke,-it,it),ve-=Ge*(Ke=this.m_angularImpulse-et),Ie+=He*Ke;var ct=this.m_rA,mt=this.m_rB,vt=K.AddVV(K.SubVV(K.AddVV(xe,K.CrossSV(Ie,mt,K.s_t0),K.s_t0),K.AddVV(se,K.CrossSV(ve,ct,K.s_t1),K.s_t1),K.s_t2),K.MulSV(Je*this.m_correctionFactor,this.m_linearError,K.s_t3),J.SolveVelocityConstraints_s_Cdot_v2),Tt=ce.MulMV(this.m_linearMass,vt,J.SolveVelocityConstraints_s_impulse_v2).SelfNeg(),wt=J.SolveVelocityConstraints_s_oldImpulse_v2.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(Tt),it=Ye*this.m_maxForce,this.m_linearImpulse.LengthSquared()>it*it&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(it)),K.SubVV(this.m_linearImpulse,wt,Tt),se.SelfMulSub(Me,Tt),ve-=Ge*K.CrossVV(ct,Tt),xe.SelfMulAdd(Le,Tt),Ie+=He*K.CrossVV(mt,Tt),q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(){return!0},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2MotorJointDef = new b2MotorJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.linearOffset.Set(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y),q("  jd.angularOffset = %.15f;\n",this.m_angularOffset),q("  jd.maxForce = %.15f;\n",this.m_maxForce),q("  jd.maxTorque = %.15f;\n",this.m_maxTorque),q("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.SolveVelocityConstraints_s_Cdot_v2=new K,J.SolveVelocityConstraints_s_impulse_v2=new K,J.SolveVelocityConstraints_s_oldImpulse_v2=new K,J}(Vr),Ja=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_mouseJoint)||this;return q.target=new K,q.maxForce=0,q.frequencyHz=5,q.dampingRatio=.7,q}return sr(J,ae),J}(Fr),is=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_localAnchorB=new K,se.m_targetA=new K,se.m_frequencyHz=0,se.m_dampingRatio=0,se.m_beta=0,se.m_impulse=new K,se.m_maxForce=0,se.m_gamma=0,se.m_indexA=0,se.m_indexB=0,se.m_rB=new K,se.m_localCenterB=new K,se.m_invMassB=0,se.m_invIB=0,se.m_mass=new ce,se.m_C=new K,se.m_qB=new oe,se.m_lalcB=new K,se.m_K=new ce,se.m_targetA.Copy(B(q.target,K.ZERO)),de.MulTXV(se.m_bodyB.GetTransform(),se.m_targetA,se.m_localAnchorB),se.m_maxForce=B(q.maxForce,0),se.m_impulse.SetZero(),se.m_frequencyHz=B(q.frequencyHz,0),se.m_dampingRatio=B(q.dampingRatio,0),se.m_beta=0,se.m_gamma=0,se}return sr(J,ae),J.prototype.SetTarget=function(q){this.m_bodyB.IsAwake()||this.m_bodyB.SetAwake(!0),this.m_targetA.Copy(q)},J.prototype.GetTarget=function(){return this.m_targetA},J.prototype.SetMaxForce=function(q){this.m_maxForce=q},J.prototype.GetMaxForce=function(){return this.m_maxForce},J.prototype.SetFrequency=function(q){this.m_frequencyHz=q},J.prototype.GetFrequency=function(){return this.m_frequencyHz},J.prototype.SetDampingRatio=function(q){this.m_dampingRatio=q},J.prototype.GetDampingRatio=function(){return this.m_dampingRatio},J.prototype.InitVelocityConstraints=function(q){this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexB].c,ve=q.positions[this.m_indexB].a,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=this.m_qB.SetAngle(ve),Le=this.m_bodyB.GetMass(),Ge=2*P*this.m_frequencyHz,He=2*Le*this.m_dampingRatio*Ge,Ye=Le*Ge*Ge,Je=q.step.dt;this.m_gamma=Je*(He+Je*Ye),this.m_gamma!==0&&(this.m_gamma=1/this.m_gamma),this.m_beta=Je*Ye*this.m_gamma,K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),oe.MulRV(Me,this.m_lalcB,this.m_rB);var ze=this.m_K;ze.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,ze.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,ze.ey.x=ze.ex.y,ze.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,ze.GetInverse(this.m_mass),this.m_C.x=se.x+this.m_rB.x-this.m_targetA.x,this.m_C.y=se.y+this.m_rB.y-this.m_targetA.y,this.m_C.SelfMul(this.m_beta),Ie*=.98,q.step.warmStarting?(this.m_impulse.SelfMul(q.step.dtRatio),xe.x+=this.m_invMassB*this.m_impulse.x,xe.y+=this.m_invMassB*this.m_impulse.y,Ie+=this.m_invIB*K.CrossVV(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),q.velocities[this.m_indexB].w=Ie},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexB].v,ve=q.velocities[this.m_indexB].w,xe=K.AddVCrossSV(se,ve,this.m_rB,J.SolveVelocityConstraints_s_Cdot),Ie=ce.MulMV(this.m_mass,K.AddVV(xe,K.AddVV(this.m_C,K.MulSV(this.m_gamma,this.m_impulse,K.s_t0),K.s_t0),K.s_t0).SelfNeg(),J.SolveVelocityConstraints_s_impulse),Me=J.SolveVelocityConstraints_s_oldImpulse.Copy(this.m_impulse);this.m_impulse.SelfAdd(Ie);var Le=q.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>Le*Le&&this.m_impulse.SelfMul(Le/this.m_impulse.Length()),K.SubVV(this.m_impulse,Me,Ie),se.SelfMulAdd(this.m_invMassB,Ie),ve+=this.m_invIB*K.CrossVV(this.m_rB,Ie),q.velocities[this.m_indexB].w=ve},J.prototype.SolvePositionConstraints=function(){return!0},J.prototype.GetAnchorA=function(q){return q.x=this.m_targetA.x,q.y=this.m_targetA.y,q},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return K.MulSV(q,this.m_impulse,se)},J.prototype.GetReactionTorque=function(){return 0},J.prototype.Dump=function(q){q("Mouse joint dumping is not supported.\n")},J.prototype.ShiftOrigin=function(q){this.m_targetA.SelfSub(q)},J.SolveVelocityConstraints_s_Cdot=new K,J.SolveVelocityConstraints_s_impulse=new K,J.SolveVelocityConstraints_s_oldImpulse=new K,J}(Vr),Ka=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_prismaticJoint)||this;return q.localAnchorA=new K,q.localAnchorB=new K,q.localAxisA=new K(1,0),q.referenceAngle=0,q.enableLimit=!1,q.lowerTranslation=0,q.upperTranslation=0,q.enableMotor=!1,q.maxMotorForce=0,q.motorSpeed=0,q}return sr(J,ae),J.prototype.Initialize=function(q,se,ve,xe){this.bodyA=q,this.bodyB=se,this.bodyA.GetLocalPoint(ve,this.localAnchorA),this.bodyB.GetLocalPoint(ve,this.localAnchorB),this.bodyA.GetLocalVector(xe,this.localAxisA),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},J}(Fr),ns=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_localXAxisA=new K,se.m_localYAxisA=new K,se.m_referenceAngle=0,se.m_impulse=new le(0,0,0),se.m_motorImpulse=0,se.m_lowerTranslation=0,se.m_upperTranslation=0,se.m_maxMotorForce=0,se.m_motorSpeed=0,se.m_enableLimit=!1,se.m_enableMotor=!1,se.m_limitState=w.b2LimitState.e_inactiveLimit,se.m_indexA=0,se.m_indexB=0,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_axis=new K(0,0),se.m_perp=new K(0,0),se.m_s1=0,se.m_s2=0,se.m_a1=0,se.m_a2=0,se.m_K=new _e,se.m_K3=new _e,se.m_K2=new ce,se.m_motorMass=0,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_rA=new K,se.m_rB=new K,se.m_localAnchorA.Copy(B(q.localAnchorA,K.ZERO)),se.m_localAnchorB.Copy(B(q.localAnchorB,K.ZERO)),se.m_localXAxisA.Copy(B(q.localAxisA,new K(1,0))).SelfNormalize(),K.CrossOneV(se.m_localXAxisA,se.m_localYAxisA),se.m_referenceAngle=B(q.referenceAngle,0),se.m_lowerTranslation=B(q.lowerTranslation,0),se.m_upperTranslation=B(q.upperTranslation,0),se.m_maxMotorForce=B(q.maxMotorForce,0),se.m_motorSpeed=B(q.motorSpeed,0),se.m_enableLimit=B(q.enableLimit,!1),se.m_enableMotor=B(q.enableMotor,!1),se}return sr(J,ae),J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.velocities[this.m_indexA].v,Ie=q.velocities[this.m_indexA].w,Me=q.positions[this.m_indexB].c,Le=q.positions[this.m_indexB].a,Ge=q.velocities[this.m_indexB].v,He=q.velocities[this.m_indexB].w,Ye=this.m_qA.SetAngle(ve),Je=this.m_qB.SetAngle(Le);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var ze=oe.MulRV(Ye,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var Ke=oe.MulRV(Je,this.m_lalcB,this.m_rB),et=K.AddVV(K.SubVV(Me,se,K.s_t0),K.SubVV(Ke,ze,K.s_t1),J.InitVelocityConstraints_s_d),it=this.m_invMassA,ct=this.m_invMassB,mt=this.m_invIA,vt=this.m_invIB;if(oe.MulRV(Ye,this.m_localXAxisA,this.m_axis),this.m_a1=K.CrossVV(K.AddVV(et,ze,K.s_t0),this.m_axis),this.m_a2=K.CrossVV(Ke,this.m_axis),this.m_motorMass=it+ct+mt*this.m_a1*this.m_a1+vt*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),oe.MulRV(Ye,this.m_localYAxisA,this.m_perp),this.m_s1=K.CrossVV(K.AddVV(et,ze,K.s_t0),this.m_perp),this.m_s2=K.CrossVV(Ke,this.m_perp),this.m_K.ex.x=it+ct+mt*this.m_s1*this.m_s1+vt*this.m_s2*this.m_s2,this.m_K.ex.y=mt*this.m_s1+vt*this.m_s2,this.m_K.ex.z=mt*this.m_s1*this.m_a1+vt*this.m_s2*this.m_a2,this.m_K.ey.x=this.m_K.ex.y,this.m_K.ey.y=mt+vt,this.m_K.ey.y===0&&(this.m_K.ey.y=1),this.m_K.ey.z=mt*this.m_a1+vt*this.m_a2,this.m_K.ez.x=this.m_K.ex.z,this.m_K.ez.y=this.m_K.ey.z,this.m_K.ez.z=it+ct+mt*this.m_a1*this.m_a1+vt*this.m_a2*this.m_a2,this.m_enableLimit){var Tt=K.DotVV(this.m_axis,et);H(this.m_upperTranslation-this.m_lowerTranslation)<2*I?this.m_limitState=w.b2LimitState.e_equalLimits:Tt<=this.m_lowerTranslation?this.m_limitState!==w.b2LimitState.e_atLowerLimit&&(this.m_limitState=w.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):Tt>=this.m_upperTranslation?this.m_limitState!==w.b2LimitState.e_atUpperLimit&&(this.m_limitState=w.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=w.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=w.b2LimitState.e_inactiveLimit,this.m_impulse.z=0;if(this.m_enableMotor||(this.m_motorImpulse=0),q.step.warmStarting){this.m_impulse.SelfMul(q.step.dtRatio),this.m_motorImpulse*=q.step.dtRatio;var wt=K.AddVV(K.MulSV(this.m_impulse.x,this.m_perp,K.s_t0),K.MulSV(this.m_motorImpulse+this.m_impulse.z,this.m_axis,K.s_t1),J.InitVelocityConstraints_s_P),Pt=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,Bt=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;xe.SelfMulSub(it,wt),Ie-=mt*Pt,Ge.SelfMulAdd(ct,wt),He+=vt*Bt}else this.m_impulse.SetZero(),this.m_motorImpulse=0;q.velocities[this.m_indexA].w=Ie,q.velocities[this.m_indexB].w=He},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=this.m_invMassA,Le=this.m_invMassB,Ge=this.m_invIA,He=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==w.b2LimitState.e_equalLimits){var Ye=K.DotVV(this.m_axis,K.SubVV(xe,se,K.s_t0))+this.m_a2*Ie-this.m_a1*ve,Je=this.m_motorMass*(this.m_motorSpeed-Ye),ze=this.m_motorImpulse,Ke=q.step.dt*this.m_maxMotorForce;this.m_motorImpulse=Y(this.m_motorImpulse+Je,-Ke,Ke),Je=this.m_motorImpulse-ze;var et=K.MulSV(Je,this.m_axis,J.SolveVelocityConstraints_s_P),it=Je*this.m_a1,ct=Je*this.m_a2;se.SelfMulSub(Me,et),ve-=Ge*it,xe.SelfMulAdd(Le,et),Ie+=He*ct}var mt=K.DotVV(this.m_perp,K.SubVV(xe,se,K.s_t0))+this.m_s2*Ie-this.m_s1*ve,vt=Ie-ve;if(this.m_enableLimit&&this.m_limitState!==w.b2LimitState.e_inactiveLimit){var Tt=K.DotVV(this.m_axis,K.SubVV(xe,se,K.s_t0))+this.m_a2*Ie-this.m_a1*ve,wt=J.SolveVelocityConstraints_s_f1.Copy(this.m_impulse),Pt=this.m_K.Solve33(-mt,-vt,-Tt,J.SolveVelocityConstraints_s_df3);this.m_impulse.SelfAdd(Pt),this.m_limitState===w.b2LimitState.e_atLowerLimit?this.m_impulse.z=X(this.m_impulse.z,0):this.m_limitState===w.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=U(this.m_impulse.z,0));var Bt=-mt-(this.m_impulse.z-wt.z)*this.m_K.ez.x,jt=-vt-(this.m_impulse.z-wt.z)*this.m_K.ez.y,Xt=this.m_K.Solve22(Bt,jt,J.SolveVelocityConstraints_s_f2r);Xt.x+=wt.x,Xt.y+=wt.y,this.m_impulse.x=Xt.x,this.m_impulse.y=Xt.y,Pt.x=this.m_impulse.x-wt.x,Pt.y=this.m_impulse.y-wt.y,Pt.z=this.m_impulse.z-wt.z,et=K.AddVV(K.MulSV(Pt.x,this.m_perp,K.s_t0),K.MulSV(Pt.z,this.m_axis,K.s_t1),J.SolveVelocityConstraints_s_P),it=Pt.x*this.m_s1+Pt.y+Pt.z*this.m_a1,ct=Pt.x*this.m_s2+Pt.y+Pt.z*this.m_a2,se.SelfMulSub(Me,et),ve-=Ge*it,xe.SelfMulAdd(Le,et),Ie+=He*ct}else{var Ht=this.m_K.Solve22(-mt,-vt,J.SolveVelocityConstraints_s_df2);this.m_impulse.x+=Ht.x,this.m_impulse.y+=Ht.y,et=K.MulSV(Ht.x,this.m_perp,J.SolveVelocityConstraints_s_P),it=Ht.x*this.m_s1+Ht.y,ct=Ht.x*this.m_s2+Ht.y,se.SelfMulSub(Me,et),ve-=Ge*it,xe.SelfMulAdd(Le,et),Ie+=He*ct}q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(q){var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.positions[this.m_indexB].c,Ie=q.positions[this.m_indexB].a,Me=this.m_qA.SetAngle(ve),Le=this.m_qB.SetAngle(Ie),Ge=this.m_invMassA,He=this.m_invMassB,Ye=this.m_invIA,Je=this.m_invIB,ze=oe.MulRV(Me,this.m_lalcA,this.m_rA),Ke=oe.MulRV(Le,this.m_lalcB,this.m_rB),et=K.SubVV(K.AddVV(xe,Ke,K.s_t0),K.AddVV(se,ze,K.s_t1),J.SolvePositionConstraints_s_d),it=oe.MulRV(Me,this.m_localXAxisA,this.m_axis),ct=K.CrossVV(K.AddVV(et,ze,K.s_t0),it),mt=K.CrossVV(Ke,it),vt=oe.MulRV(Me,this.m_localYAxisA,this.m_perp),Tt=K.CrossVV(K.AddVV(et,ze,K.s_t0),vt),wt=K.CrossVV(Ke,vt),Pt=J.SolvePositionConstraints_s_impulse,Bt=K.DotVV(vt,et),jt=Ie-ve-this.m_referenceAngle,Xt=H(Bt),Ht=H(jt),$t=!1,Qt=0;if(this.m_enableLimit){var ur=K.DotVV(it,et);H(this.m_upperTranslation-this.m_lowerTranslation)<2*I?(Qt=Y(ur,-.2,.2),Xt=X(Xt,H(ur)),$t=!0):ur<=this.m_lowerTranslation?(Qt=Y(ur-this.m_lowerTranslation+I,-.2,0),Xt=X(Xt,this.m_lowerTranslation-ur),$t=!0):ur>=this.m_upperTranslation&&(Qt=Y(ur-this.m_upperTranslation-I,0,.2),Xt=X(Xt,ur-this.m_upperTranslation),$t=!0)}if($t){var tr=Ge+He+Ye*Tt*Tt+Je*wt*wt,qt=Ye*Tt+Je*wt,ar=Ye*Tt*ct+Je*wt*mt;(wr=Ye+Je)===0&&(wr=1);var or=Ye*ct+Je*mt,vr=Ge+He+Ye*ct*ct+Je*mt*mt,mr=this.m_K3;mr.ex.SetXYZ(tr,qt,ar),mr.ey.SetXYZ(qt,wr,or),mr.ez.SetXYZ(ar,or,vr),Pt=mr.Solve33(-Bt,-jt,-Qt,Pt)}else{var wr;tr=Ge+He+Ye*Tt*Tt+Je*wt*wt,qt=Ye*Tt+Je*wt,(wr=Ye+Je)===0&&(wr=1);var Tr=this.m_K2;Tr.ex.Set(tr,qt),Tr.ey.Set(qt,wr);var yr=Tr.Solve(-Bt,-jt,J.SolvePositionConstraints_s_impulse1);Pt.x=yr.x,Pt.y=yr.y,Pt.z=0}var Rr=K.AddVV(K.MulSV(Pt.x,vt,K.s_t0),K.MulSV(Pt.z,it,K.s_t1),J.SolvePositionConstraints_s_P),Sr=Pt.x*Tt+Pt.y+Pt.z*ct,ni=Pt.x*wt+Pt.y+Pt.z*mt;return se.SelfMulSub(Ge,Rr),ve-=Ye*Sr,xe.SelfMulAdd(He,Rr),Ie+=Je*ni,q.positions[this.m_indexA].a=ve,q.positions[this.m_indexB].a=Ie,Xt<=I&&Ht<=M},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return se.x=q*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),se.y=q*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y),se},J.prototype.GetReactionTorque=function(q){return q*this.m_impulse.y},J.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},J.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},J.prototype.GetLocalAxisA=function(){return this.m_localXAxisA},J.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},J.prototype.GetJointTranslation=function(){var q=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,J.GetJointTranslation_s_pA),se=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,J.GetJointTranslation_s_pB),ve=K.SubVV(se,q,J.GetJointTranslation_s_d),xe=this.m_bodyA.GetWorldVector(this.m_localXAxisA,J.GetJointTranslation_s_axis);return K.DotVV(ve,xe)},J.prototype.GetJointSpeed=function(){var q=this.m_bodyA,se=this.m_bodyB;K.SubVV(this.m_localAnchorA,q.m_sweep.localCenter,this.m_lalcA);var ve=oe.MulRV(q.m_xf.q,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,se.m_sweep.localCenter,this.m_lalcB);var xe=oe.MulRV(se.m_xf.q,this.m_lalcB,this.m_rB),Ie=K.AddVV(q.m_sweep.c,ve,K.s_t0),Me=K.AddVV(se.m_sweep.c,xe,K.s_t1),Le=K.SubVV(Me,Ie,K.s_t2),Ge=q.GetWorldVector(this.m_localXAxisA,this.m_axis),He=q.m_linearVelocity,Ye=se.m_linearVelocity,Je=q.m_angularVelocity,ze=se.m_angularVelocity;return K.DotVV(Le,K.CrossSV(Je,Ge,K.s_t0))+K.DotVV(Ge,K.SubVV(K.AddVCrossSV(Ye,ze,xe,K.s_t0),K.AddVCrossSV(He,Je,ve,K.s_t1),K.s_t0))},J.prototype.IsLimitEnabled=function(){return this.m_enableLimit},J.prototype.EnableLimit=function(q){q!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=q,this.m_impulse.z=0)},J.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},J.prototype.GetUpperLimit=function(){return this.m_upperTranslation},J.prototype.SetLimits=function(q,se){q===this.m_lowerTranslation&&se===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=q,this.m_upperTranslation=se,this.m_impulse.z=0)},J.prototype.IsMotorEnabled=function(){return this.m_enableMotor},J.prototype.EnableMotor=function(q){q!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=q)},J.prototype.SetMotorSpeed=function(q){q!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=q)},J.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},J.prototype.SetMaxMotorForce=function(q){q!==this.m_maxMotorForce&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=q)},J.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},J.prototype.GetMotorForce=function(q){return q*this.m_motorImpulse},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2PrismaticJointDef = new b2PrismaticJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),q("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),q("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),q("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation),q("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation),q("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),q("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),q("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.InitVelocityConstraints_s_d=new K,J.InitVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_f2r=new K,J.SolveVelocityConstraints_s_f1=new le,J.SolveVelocityConstraints_s_df3=new le,J.SolveVelocityConstraints_s_df2=new K,J.SolvePositionConstraints_s_d=new K,J.SolvePositionConstraints_s_impulse=new le,J.SolvePositionConstraints_s_impulse1=new K,J.SolvePositionConstraints_s_P=new K,J.GetJointTranslation_s_pA=new K,J.GetJointTranslation_s_pB=new K,J.GetJointTranslation_s_d=new K,J.GetJointTranslation_s_axis=new K,J}(Vr),$a=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_pulleyJoint)||this;return q.groundAnchorA=new K(-1,1),q.groundAnchorB=new K(1,1),q.localAnchorA=new K(-1,0),q.localAnchorB=new K(1,0),q.lengthA=0,q.lengthB=0,q.ratio=1,q.collideConnected=!0,q}return sr(J,ae),J.prototype.Initialize=function(q,se,ve,xe,Ie,Me,Le){this.bodyA=q,this.bodyB=se,this.groundAnchorA.Copy(ve),this.groundAnchorB.Copy(xe),this.bodyA.GetLocalPoint(Ie,this.localAnchorA),this.bodyB.GetLocalPoint(Me,this.localAnchorB),this.lengthA=K.DistanceVV(Ie,ve),this.lengthB=K.DistanceVV(Me,xe),this.ratio=Le},J}(Fr),ss=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_groundAnchorA=new K,se.m_groundAnchorB=new K,se.m_lengthA=0,se.m_lengthB=0,se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_constant=0,se.m_ratio=0,se.m_impulse=0,se.m_indexA=0,se.m_indexB=0,se.m_uA=new K,se.m_uB=new K,se.m_rA=new K,se.m_rB=new K,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_mass=0,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_groundAnchorA.Copy(B(q.groundAnchorA,new K(-1,1))),se.m_groundAnchorB.Copy(B(q.groundAnchorB,new K(1,0))),se.m_localAnchorA.Copy(B(q.localAnchorA,new K(-1,0))),se.m_localAnchorB.Copy(B(q.localAnchorB,new K(1,0))),se.m_lengthA=B(q.lengthA,0),se.m_lengthB=B(q.lengthB,0),se.m_ratio=B(q.ratio,1),se.m_constant=B(q.lengthA,0)+se.m_ratio*B(q.lengthB,0),se.m_impulse=0,se}return sr(J,ae),J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.velocities[this.m_indexA].v,Ie=q.velocities[this.m_indexA].w,Me=q.positions[this.m_indexB].c,Le=q.positions[this.m_indexB].a,Ge=q.velocities[this.m_indexB].v,He=q.velocities[this.m_indexB].w,Ye=this.m_qA.SetAngle(ve),Je=this.m_qB.SetAngle(Le);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),oe.MulRV(Ye,this.m_lalcA,this.m_rA),K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),oe.MulRV(Je,this.m_lalcB,this.m_rB),this.m_uA.Copy(se).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA),this.m_uB.Copy(Me).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);var ze=this.m_uA.Length(),Ke=this.m_uB.Length();ze>10*I?this.m_uA.SelfMul(1/ze):this.m_uA.SetZero(),Ke>10*I?this.m_uB.SelfMul(1/Ke):this.m_uB.SetZero();var et=K.CrossVV(this.m_rA,this.m_uA),it=K.CrossVV(this.m_rB,this.m_uB),ct=this.m_invMassA+this.m_invIA*et*et,mt=this.m_invMassB+this.m_invIB*it*it;if(this.m_mass=ct+this.m_ratio*this.m_ratio*mt,this.m_mass>0&&(this.m_mass=1/this.m_mass),q.step.warmStarting){this.m_impulse*=q.step.dtRatio;var vt=K.MulSV(-this.m_impulse,this.m_uA,J.InitVelocityConstraints_s_PA),Tt=K.MulSV(-this.m_ratio*this.m_impulse,this.m_uB,J.InitVelocityConstraints_s_PB);xe.SelfMulAdd(this.m_invMassA,vt),Ie+=this.m_invIA*K.CrossVV(this.m_rA,vt),Ge.SelfMulAdd(this.m_invMassB,Tt),He+=this.m_invIB*K.CrossVV(this.m_rB,Tt)}else this.m_impulse=0;q.velocities[this.m_indexA].w=Ie,q.velocities[this.m_indexB].w=He},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=K.AddVCrossSV(se,ve,this.m_rA,J.SolveVelocityConstraints_s_vpA),Le=K.AddVCrossSV(xe,Ie,this.m_rB,J.SolveVelocityConstraints_s_vpB),Ge=-K.DotVV(this.m_uA,Me)-this.m_ratio*K.DotVV(this.m_uB,Le),He=-this.m_mass*Ge;this.m_impulse+=He;var Ye=K.MulSV(-He,this.m_uA,J.SolveVelocityConstraints_s_PA),Je=K.MulSV(-this.m_ratio*He,this.m_uB,J.SolveVelocityConstraints_s_PB);se.SelfMulAdd(this.m_invMassA,Ye),ve+=this.m_invIA*K.CrossVV(this.m_rA,Ye),xe.SelfMulAdd(this.m_invMassB,Je),Ie+=this.m_invIB*K.CrossVV(this.m_rB,Je),q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(q){var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.positions[this.m_indexB].c,Ie=q.positions[this.m_indexB].a,Me=this.m_qA.SetAngle(ve),Le=this.m_qB.SetAngle(Ie);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var Ge=oe.MulRV(Me,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var He=oe.MulRV(Le,this.m_lalcB,this.m_rB),Ye=this.m_uA.Copy(se).SelfAdd(Ge).SelfSub(this.m_groundAnchorA),Je=this.m_uB.Copy(xe).SelfAdd(He).SelfSub(this.m_groundAnchorB),ze=Ye.Length(),Ke=Je.Length();ze>10*I?Ye.SelfMul(1/ze):Ye.SetZero(),Ke>10*I?Je.SelfMul(1/Ke):Je.SetZero();var et=K.CrossVV(Ge,Ye),it=K.CrossVV(He,Je),ct=this.m_invMassA+this.m_invIA*et*et,mt=this.m_invMassB+this.m_invIB*it*it,vt=ct+this.m_ratio*this.m_ratio*mt;vt>0&&(vt=1/vt);var Tt=this.m_constant-ze-this.m_ratio*Ke,wt=H(Tt),Pt=-vt*Tt,Bt=K.MulSV(-Pt,Ye,J.SolvePositionConstraints_s_PA),jt=K.MulSV(-this.m_ratio*Pt,Je,J.SolvePositionConstraints_s_PB);return se.SelfMulAdd(this.m_invMassA,Bt),ve+=this.m_invIA*K.CrossVV(Ge,Bt),xe.SelfMulAdd(this.m_invMassB,jt),Ie+=this.m_invIB*K.CrossVV(He,jt),q.positions[this.m_indexA].a=ve,q.positions[this.m_indexB].a=Ie,wt<I},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return se.x=q*this.m_impulse*this.m_uB.x,se.y=q*this.m_impulse*this.m_uB.y,se},J.prototype.GetReactionTorque=function(){return 0},J.prototype.GetGroundAnchorA=function(){return this.m_groundAnchorA},J.prototype.GetGroundAnchorB=function(){return this.m_groundAnchorB},J.prototype.GetLengthA=function(){return this.m_lengthA},J.prototype.GetLengthB=function(){return this.m_lengthB},J.prototype.GetRatio=function(){return this.m_ratio},J.prototype.GetCurrentLengthA=function(){var q=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,J.GetCurrentLengthA_s_p),se=this.m_groundAnchorA;return K.DistanceVV(q,se)},J.prototype.GetCurrentLengthB=function(){var q=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,J.GetCurrentLengthB_s_p),se=this.m_groundAnchorB;return K.DistanceVV(q,se)},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2PulleyJointDef = new b2PulleyJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.groundAnchorA.Set(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y),q("  jd.groundAnchorB.Set(%.15f, %.15f);\n",this.m_groundAnchorB.x,this.m_groundAnchorB.y),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.lengthA = %.15f;\n",this.m_lengthA),q("  jd.lengthB = %.15f;\n",this.m_lengthB),q("  jd.ratio = %.15f;\n",this.m_ratio),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.prototype.ShiftOrigin=function(q){this.m_groundAnchorA.SelfSub(q),this.m_groundAnchorB.SelfSub(q)},J.InitVelocityConstraints_s_PA=new K,J.InitVelocityConstraints_s_PB=new K,J.SolveVelocityConstraints_s_vpA=new K,J.SolveVelocityConstraints_s_vpB=new K,J.SolveVelocityConstraints_s_PA=new K,J.SolveVelocityConstraints_s_PB=new K,J.SolvePositionConstraints_s_PA=new K,J.SolvePositionConstraints_s_PB=new K,J.GetCurrentLengthA_s_p=new K,J.GetCurrentLengthB_s_p=new K,J}(Vr),Qa=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_revoluteJoint)||this;return q.localAnchorA=new K(0,0),q.localAnchorB=new K(0,0),q.referenceAngle=0,q.enableLimit=!1,q.lowerAngle=0,q.upperAngle=0,q.enableMotor=!1,q.motorSpeed=0,q.maxMotorTorque=0,q}return sr(J,ae),J.prototype.Initialize=function(q,se,ve){this.bodyA=q,this.bodyB=se,this.bodyA.GetLocalPoint(ve,this.localAnchorA),this.bodyB.GetLocalPoint(ve,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},J}(Fr),as=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_impulse=new le,se.m_motorImpulse=0,se.m_enableMotor=!1,se.m_maxMotorTorque=0,se.m_motorSpeed=0,se.m_enableLimit=!1,se.m_referenceAngle=0,se.m_lowerAngle=0,se.m_upperAngle=0,se.m_indexA=0,se.m_indexB=0,se.m_rA=new K,se.m_rB=new K,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_mass=new _e,se.m_motorMass=0,se.m_limitState=w.b2LimitState.e_inactiveLimit,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_K=new ce,se.m_localAnchorA.Copy(B(q.localAnchorA,K.ZERO)),se.m_localAnchorB.Copy(B(q.localAnchorB,K.ZERO)),se.m_referenceAngle=B(q.referenceAngle,0),se.m_impulse.SetZero(),se.m_motorImpulse=0,se.m_lowerAngle=B(q.lowerAngle,0),se.m_upperAngle=B(q.upperAngle,0),se.m_maxMotorTorque=B(q.maxMotorTorque,0),se.m_motorSpeed=B(q.motorSpeed,0),se.m_enableLimit=B(q.enableLimit,!1),se.m_enableMotor=B(q.enableMotor,!1),se.m_limitState=w.b2LimitState.e_inactiveLimit,se}return sr(J,ae),J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].a,ve=q.velocities[this.m_indexA].v,xe=q.velocities[this.m_indexA].w,Ie=q.positions[this.m_indexB].a,Me=q.velocities[this.m_indexB].v,Le=q.velocities[this.m_indexB].w,Ge=this.m_qA.SetAngle(se),He=this.m_qB.SetAngle(Ie);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),oe.MulRV(Ge,this.m_lalcA,this.m_rA),K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),oe.MulRV(He,this.m_lalcB,this.m_rB);var Ye=this.m_invMassA,Je=this.m_invMassB,ze=this.m_invIA,Ke=this.m_invIB,et=ze+Ke===0;if(this.m_mass.ex.x=Ye+Je+this.m_rA.y*this.m_rA.y*ze+this.m_rB.y*this.m_rB.y*Ke,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*ze-this.m_rB.y*this.m_rB.x*Ke,this.m_mass.ez.x=-this.m_rA.y*ze-this.m_rB.y*Ke,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=Ye+Je+this.m_rA.x*this.m_rA.x*ze+this.m_rB.x*this.m_rB.x*Ke,this.m_mass.ez.y=this.m_rA.x*ze+this.m_rB.x*Ke,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=ze+Ke,this.m_motorMass=ze+Ke,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_enableMotor&&!et||(this.m_motorImpulse=0),this.m_enableLimit&&!et){var it=Ie-se-this.m_referenceAngle;H(this.m_upperAngle-this.m_lowerAngle)<2*M?this.m_limitState=w.b2LimitState.e_equalLimits:it<=this.m_lowerAngle?(this.m_limitState!==w.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=w.b2LimitState.e_atLowerLimit):it>=this.m_upperAngle?(this.m_limitState!==w.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=w.b2LimitState.e_atUpperLimit):(this.m_limitState=w.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=w.b2LimitState.e_inactiveLimit;if(q.step.warmStarting){this.m_impulse.SelfMul(q.step.dtRatio),this.m_motorImpulse*=q.step.dtRatio;var ct=J.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);ve.SelfMulSub(Ye,ct),xe-=ze*(K.CrossVV(this.m_rA,ct)+this.m_motorImpulse+this.m_impulse.z),Me.SelfMulAdd(Je,ct),Le+=Ke*(K.CrossVV(this.m_rB,ct)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0;q.velocities[this.m_indexA].w=xe,q.velocities[this.m_indexB].w=Le},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=this.m_invMassA,Le=this.m_invMassB,Ge=this.m_invIA,He=this.m_invIB,Ye=Ge+He===0;if(this.m_enableMotor&&this.m_limitState!==w.b2LimitState.e_equalLimits&&!Ye){var Je=Ie-ve-this.m_motorSpeed,ze=-this.m_motorMass*Je,Ke=this.m_motorImpulse,et=q.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=Y(this.m_motorImpulse+ze,-et,et),ve-=Ge*(ze=this.m_motorImpulse-Ke),Ie+=He*ze}if(this.m_enableLimit&&this.m_limitState!==w.b2LimitState.e_inactiveLimit&&!Ye){var it=K.SubVV(K.AddVCrossSV(xe,Ie,this.m_rB,K.s_t0),K.AddVCrossSV(se,ve,this.m_rA,K.s_t1),J.SolveVelocityConstraints_s_Cdot1),ct=Ie-ve,mt=this.m_mass.Solve33(it.x,it.y,ct,J.SolveVelocityConstraints_s_impulse_v3).SelfNeg();if(this.m_limitState===w.b2LimitState.e_equalLimits)this.m_impulse.SelfAdd(mt);else if(this.m_limitState===w.b2LimitState.e_atLowerLimit)if(this.m_impulse.z+mt.z<0){var vt=-it.x+this.m_impulse.z*this.m_mass.ez.x,Tt=-it.y+this.m_impulse.z*this.m_mass.ez.y,wt=this.m_mass.Solve22(vt,Tt,J.SolveVelocityConstraints_s_reduced_v2);mt.x=wt.x,mt.y=wt.y,mt.z=-this.m_impulse.z,this.m_impulse.x+=wt.x,this.m_impulse.y+=wt.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(mt);else this.m_limitState===w.b2LimitState.e_atUpperLimit&&(this.m_impulse.z+mt.z>0?(vt=-it.x+this.m_impulse.z*this.m_mass.ez.x,Tt=-it.y+this.m_impulse.z*this.m_mass.ez.y,wt=this.m_mass.Solve22(vt,Tt,J.SolveVelocityConstraints_s_reduced_v2),mt.x=wt.x,mt.y=wt.y,mt.z=-this.m_impulse.z,this.m_impulse.x+=wt.x,this.m_impulse.y+=wt.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(mt));var Pt=J.SolveVelocityConstraints_s_P.Set(mt.x,mt.y);se.SelfMulSub(Me,Pt),ve-=Ge*(K.CrossVV(this.m_rA,Pt)+mt.z),xe.SelfMulAdd(Le,Pt),Ie+=He*(K.CrossVV(this.m_rB,Pt)+mt.z)}else{var Bt=K.SubVV(K.AddVCrossSV(xe,Ie,this.m_rB,K.s_t0),K.AddVCrossSV(se,ve,this.m_rA,K.s_t1),J.SolveVelocityConstraints_s_Cdot_v2),jt=this.m_mass.Solve22(-Bt.x,-Bt.y,J.SolveVelocityConstraints_s_impulse_v2);this.m_impulse.x+=jt.x,this.m_impulse.y+=jt.y,se.SelfMulSub(Me,jt),ve-=Ge*K.CrossVV(this.m_rA,jt),xe.SelfMulAdd(Le,jt),Ie+=He*K.CrossVV(this.m_rB,jt)}q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(q){var se,ve=q.positions[this.m_indexA].c,xe=q.positions[this.m_indexA].a,Ie=q.positions[this.m_indexB].c,Me=q.positions[this.m_indexB].a,Le=this.m_qA.SetAngle(xe),Ge=this.m_qB.SetAngle(Me),He=0,Ye=this.m_invIA+this.m_invIB===0;if(this.m_enableLimit&&this.m_limitState!==w.b2LimitState.e_inactiveLimit&&!Ye){var Je=Me-xe-this.m_referenceAngle,ze=0;if(this.m_limitState===w.b2LimitState.e_equalLimits){var Ke=Y(Je-this.m_lowerAngle,-.13962634015955555,.13962634015955555);ze=-this.m_motorMass*Ke,He=H(Ke)}else this.m_limitState===w.b2LimitState.e_atLowerLimit?(He=-(Ke=Je-this.m_lowerAngle),Ke=Y(Ke+M,-.13962634015955555,0),ze=-this.m_motorMass*Ke):this.m_limitState===w.b2LimitState.e_atUpperLimit&&(He=Ke=Je-this.m_upperAngle,Ke=Y(Ke-M,0,.13962634015955555),ze=-this.m_motorMass*Ke);xe-=this.m_invIA*ze,Me+=this.m_invIB*ze}Le.SetAngle(xe),Ge.SetAngle(Me),K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var et=oe.MulRV(Le,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var it=oe.MulRV(Ge,this.m_lalcB,this.m_rB),ct=K.SubVV(K.AddVV(Ie,it,K.s_t0),K.AddVV(ve,et,K.s_t1),J.SolvePositionConstraints_s_C_v2);se=ct.Length();var mt=this.m_invMassA,vt=this.m_invMassB,Tt=this.m_invIA,wt=this.m_invIB,Pt=this.m_K;Pt.ex.x=mt+vt+Tt*et.y*et.y+wt*it.y*it.y,Pt.ex.y=-Tt*et.x*et.y-wt*it.x*it.y,Pt.ey.x=Pt.ex.y,Pt.ey.y=mt+vt+Tt*et.x*et.x+wt*it.x*it.x;var Bt=Pt.Solve(ct.x,ct.y,J.SolvePositionConstraints_s_impulse).SelfNeg();return ve.SelfMulSub(mt,Bt),xe-=Tt*K.CrossVV(et,Bt),Ie.SelfMulAdd(vt,Bt),Me+=wt*K.CrossVV(it,Bt),q.positions[this.m_indexA].a=xe,q.positions[this.m_indexB].a=Me,se<=I&&He<=M},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return se.x=q*this.m_impulse.x,se.y=q*this.m_impulse.y,se},J.prototype.GetReactionTorque=function(q){return q*this.m_impulse.z},J.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},J.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},J.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},J.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},J.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},J.prototype.IsMotorEnabled=function(){return this.m_enableMotor},J.prototype.EnableMotor=function(q){q!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=q)},J.prototype.GetMotorTorque=function(q){return q*this.m_motorImpulse},J.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},J.prototype.SetMaxMotorTorque=function(q){q!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=q)},J.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque},J.prototype.IsLimitEnabled=function(){return this.m_enableLimit},J.prototype.EnableLimit=function(q){q!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=q,this.m_impulse.z=0)},J.prototype.GetLowerLimit=function(){return this.m_lowerAngle},J.prototype.GetUpperLimit=function(){return this.m_upperAngle},J.prototype.SetLimits=function(q,se){q===this.m_lowerAngle&&se===this.m_upperAngle||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=q,this.m_upperAngle=se)},J.prototype.SetMotorSpeed=function(q){q!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=q)},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2RevoluteJointDef = new b2RevoluteJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),q("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),q("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle),q("  jd.upperAngle = %.15f;\n",this.m_upperAngle),q("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),q("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),q("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.InitVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_Cdot_v2=new K,J.SolveVelocityConstraints_s_Cdot1=new K,J.SolveVelocityConstraints_s_impulse_v3=new le,J.SolveVelocityConstraints_s_reduced_v2=new K,J.SolveVelocityConstraints_s_impulse_v2=new K,J.SolvePositionConstraints_s_C_v2=new K,J.SolvePositionConstraints_s_impulse=new K,J}(Vr),qa=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_ropeJoint)||this;return q.localAnchorA=new K(-1,0),q.localAnchorB=new K(1,0),q.maxLength=0,q}return sr(J,ae),J}(Fr),os=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_maxLength=0,se.m_length=0,se.m_impulse=0,se.m_indexA=0,se.m_indexB=0,se.m_u=new K,se.m_rA=new K,se.m_rB=new K,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_mass=0,se.m_state=w.b2LimitState.e_inactiveLimit,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_localAnchorA.Copy(B(q.localAnchorA,new K(-1,0))),se.m_localAnchorB.Copy(B(q.localAnchorB,new K(1,0))),se.m_maxLength=B(q.maxLength,0),se}return sr(J,ae),J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.velocities[this.m_indexA].v,Ie=q.velocities[this.m_indexA].w,Me=q.positions[this.m_indexB].c,Le=q.positions[this.m_indexB].a,Ge=q.velocities[this.m_indexB].v,He=q.velocities[this.m_indexB].w,Ye=this.m_qA.SetAngle(ve),Je=this.m_qB.SetAngle(Le);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),oe.MulRV(Ye,this.m_lalcA,this.m_rA),K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),oe.MulRV(Je,this.m_lalcB,this.m_rB),this.m_u.Copy(Me).SelfAdd(this.m_rB).SelfSub(se).SelfSub(this.m_rA),this.m_length=this.m_u.Length();var ze=this.m_length-this.m_maxLength;if(this.m_state=ze>0?w.b2LimitState.e_atUpperLimit:w.b2LimitState.e_inactiveLimit,!(this.m_length>I))return this.m_u.SetZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.SelfMul(1/this.m_length);var Ke=K.CrossVV(this.m_rA,this.m_u),et=K.CrossVV(this.m_rB,this.m_u),it=this.m_invMassA+this.m_invIA*Ke*Ke+this.m_invMassB+this.m_invIB*et*et;if(this.m_mass=it!==0?1/it:0,q.step.warmStarting){this.m_impulse*=q.step.dtRatio;var ct=K.MulSV(this.m_impulse,this.m_u,J.InitVelocityConstraints_s_P);xe.SelfMulSub(this.m_invMassA,ct),Ie-=this.m_invIA*K.CrossVV(this.m_rA,ct),Ge.SelfMulAdd(this.m_invMassB,ct),He+=this.m_invIB*K.CrossVV(this.m_rB,ct)}else this.m_impulse=0;q.velocities[this.m_indexA].w=Ie,q.velocities[this.m_indexB].w=He},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=K.AddVCrossSV(se,ve,this.m_rA,J.SolveVelocityConstraints_s_vpA),Le=K.AddVCrossSV(xe,Ie,this.m_rB,J.SolveVelocityConstraints_s_vpB),Ge=this.m_length-this.m_maxLength,He=K.DotVV(this.m_u,K.SubVV(Le,Me,K.s_t0));Ge<0&&(He+=q.step.inv_dt*Ge);var Ye=-this.m_mass*He,Je=this.m_impulse;this.m_impulse=U(0,this.m_impulse+Ye),Ye=this.m_impulse-Je;var ze=K.MulSV(Ye,this.m_u,J.SolveVelocityConstraints_s_P);se.SelfMulSub(this.m_invMassA,ze),ve-=this.m_invIA*K.CrossVV(this.m_rA,ze),xe.SelfMulAdd(this.m_invMassB,ze),Ie+=this.m_invIB*K.CrossVV(this.m_rB,ze),q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(q){var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.positions[this.m_indexB].c,Ie=q.positions[this.m_indexB].a,Me=this.m_qA.SetAngle(ve),Le=this.m_qB.SetAngle(Ie);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var Ge=oe.MulRV(Me,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var He=oe.MulRV(Le,this.m_lalcB,this.m_rB),Ye=this.m_u.Copy(xe).SelfAdd(He).SelfSub(se).SelfSub(Ge),Je=Ye.Normalize(),ze=Je-this.m_maxLength;ze=Y(ze,0,.2);var Ke=-this.m_mass*ze,et=K.MulSV(Ke,Ye,J.SolvePositionConstraints_s_P);return se.SelfMulSub(this.m_invMassA,et),ve-=this.m_invIA*K.CrossVV(Ge,et),xe.SelfMulAdd(this.m_invMassB,et),Ie+=this.m_invIB*K.CrossVV(He,et),q.positions[this.m_indexA].a=ve,q.positions[this.m_indexB].a=Ie,Je-this.m_maxLength<I},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return K.MulSV(q*this.m_impulse,this.m_u,se)},J.prototype.GetReactionTorque=function(){return 0},J.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},J.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},J.prototype.SetMaxLength=function(q){this.m_maxLength=q},J.prototype.GetMaxLength=function(){return this.m_maxLength},J.prototype.GetLimitState=function(){return this.m_state},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2RopeJointDef = new b2RopeJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.maxLength = %.15f;\n",this.m_maxLength),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.InitVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_vpA=new K,J.SolveVelocityConstraints_s_vpB=new K,J.SolveVelocityConstraints_s_P=new K,J.SolvePositionConstraints_s_P=new K,J}(Vr),eo=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_weldJoint)||this;return q.localAnchorA=new K,q.localAnchorB=new K,q.referenceAngle=0,q.frequencyHz=0,q.dampingRatio=0,q}return sr(J,ae),J.prototype.Initialize=function(q,se,ve){this.bodyA=q,this.bodyB=se,this.bodyA.GetLocalPoint(ve,this.localAnchorA),this.bodyB.GetLocalPoint(ve,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},J}(Fr),ls=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_frequencyHz=0,se.m_dampingRatio=0,se.m_bias=0,se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_referenceAngle=0,se.m_gamma=0,se.m_impulse=new le(0,0,0),se.m_indexA=0,se.m_indexB=0,se.m_rA=new K,se.m_rB=new K,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_mass=new _e,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_K=new _e,se.m_frequencyHz=B(q.frequencyHz,0),se.m_dampingRatio=B(q.dampingRatio,0),se.m_localAnchorA.Copy(B(q.localAnchorA,K.ZERO)),se.m_localAnchorB.Copy(B(q.localAnchorB,K.ZERO)),se.m_referenceAngle=B(q.referenceAngle,0),se.m_impulse.SetZero(),se}return sr(J,ae),J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=q.positions[this.m_indexA].a,ve=q.velocities[this.m_indexA].v,xe=q.velocities[this.m_indexA].w,Ie=q.positions[this.m_indexB].a,Me=q.velocities[this.m_indexB].v,Le=q.velocities[this.m_indexB].w,Ge=this.m_qA.SetAngle(se),He=this.m_qB.SetAngle(Ie);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),oe.MulRV(Ge,this.m_lalcA,this.m_rA),K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),oe.MulRV(He,this.m_lalcB,this.m_rB);var Ye=this.m_invMassA,Je=this.m_invMassB,ze=this.m_invIA,Ke=this.m_invIB,et=this.m_K;if(et.ex.x=Ye+Je+this.m_rA.y*this.m_rA.y*ze+this.m_rB.y*this.m_rB.y*Ke,et.ey.x=-this.m_rA.y*this.m_rA.x*ze-this.m_rB.y*this.m_rB.x*Ke,et.ez.x=-this.m_rA.y*ze-this.m_rB.y*Ke,et.ex.y=et.ey.x,et.ey.y=Ye+Je+this.m_rA.x*this.m_rA.x*ze+this.m_rB.x*this.m_rB.x*Ke,et.ez.y=this.m_rA.x*ze+this.m_rB.x*Ke,et.ex.z=et.ez.x,et.ey.z=et.ez.y,et.ez.z=ze+Ke,this.m_frequencyHz>0){et.GetInverse22(this.m_mass);var it=ze+Ke,ct=it>0?1/it:0,mt=Ie-se-this.m_referenceAngle,vt=2*P*this.m_frequencyHz,Tt=2*ct*this.m_dampingRatio*vt,wt=ct*vt*vt,Pt=q.step.dt;this.m_gamma=Pt*(Tt+Pt*wt),this.m_gamma=this.m_gamma!==0?1/this.m_gamma:0,this.m_bias=mt*Pt*wt*this.m_gamma,it+=this.m_gamma,this.m_mass.ez.z=it!==0?1/it:0}else et.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0;if(q.step.warmStarting){this.m_impulse.SelfMul(q.step.dtRatio);var Bt=J.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);ve.SelfMulSub(Ye,Bt),xe-=ze*(K.CrossVV(this.m_rA,Bt)+this.m_impulse.z),Me.SelfMulAdd(Je,Bt),Le+=Ke*(K.CrossVV(this.m_rB,Bt)+this.m_impulse.z)}else this.m_impulse.SetZero();q.velocities[this.m_indexA].w=xe,q.velocities[this.m_indexB].w=Le},J.prototype.SolveVelocityConstraints=function(q){var se=q.velocities[this.m_indexA].v,ve=q.velocities[this.m_indexA].w,xe=q.velocities[this.m_indexB].v,Ie=q.velocities[this.m_indexB].w,Me=this.m_invMassA,Le=this.m_invMassB,Ge=this.m_invIA,He=this.m_invIB;if(this.m_frequencyHz>0){var Ye=Ie-ve,Je=-this.m_mass.ez.z*(Ye+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=Je,ve-=Ge*Je,Ie+=He*Je;var ze=K.SubVV(K.AddVCrossSV(xe,Ie,this.m_rB,K.s_t0),K.AddVCrossSV(se,ve,this.m_rA,K.s_t1),J.SolveVelocityConstraints_s_Cdot1),Ke=_e.MulM33XY(this.m_mass,ze.x,ze.y,J.SolveVelocityConstraints_s_impulse1).SelfNeg();this.m_impulse.x+=Ke.x,this.m_impulse.y+=Ke.y;var et=Ke;se.SelfMulSub(Me,et),ve-=Ge*K.CrossVV(this.m_rA,et),xe.SelfMulAdd(Le,et),Ie+=He*K.CrossVV(this.m_rB,et)}else{ze=K.SubVV(K.AddVCrossSV(xe,Ie,this.m_rB,K.s_t0),K.AddVCrossSV(se,ve,this.m_rA,K.s_t1),J.SolveVelocityConstraints_s_Cdot1),Ye=Ie-ve;var it=_e.MulM33XYZ(this.m_mass,ze.x,ze.y,Ye,J.SolveVelocityConstraints_s_impulse).SelfNeg();this.m_impulse.SelfAdd(it),et=J.SolveVelocityConstraints_s_P.Set(it.x,it.y),se.SelfMulSub(Me,et),ve-=Ge*(K.CrossVV(this.m_rA,et)+it.z),xe.SelfMulAdd(Le,et),Ie+=He*(K.CrossVV(this.m_rB,et)+it.z)}q.velocities[this.m_indexA].w=ve,q.velocities[this.m_indexB].w=Ie},J.prototype.SolvePositionConstraints=function(q){var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.positions[this.m_indexB].c,Ie=q.positions[this.m_indexB].a,Me=this.m_qA.SetAngle(ve),Le=this.m_qB.SetAngle(Ie),Ge=this.m_invMassA,He=this.m_invMassB,Ye=this.m_invIA,Je=this.m_invIB;K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var ze=oe.MulRV(Me,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var Ke,et,it=oe.MulRV(Le,this.m_lalcB,this.m_rB),ct=this.m_K;if(ct.ex.x=Ge+He+ze.y*ze.y*Ye+it.y*it.y*Je,ct.ey.x=-ze.y*ze.x*Ye-it.y*it.x*Je,ct.ez.x=-ze.y*Ye-it.y*Je,ct.ex.y=ct.ey.x,ct.ey.y=Ge+He+ze.x*ze.x*Ye+it.x*it.x*Je,ct.ez.y=ze.x*Ye+it.x*Je,ct.ex.z=ct.ez.x,ct.ey.z=ct.ez.y,ct.ez.z=Ye+Je,this.m_frequencyHz>0){Ke=(vt=K.SubVV(K.AddVV(xe,it,K.s_t0),K.AddVV(se,ze,K.s_t1),J.SolvePositionConstraints_s_C1)).Length(),et=0;var mt=ct.Solve22(vt.x,vt.y,J.SolvePositionConstraints_s_P).SelfNeg();se.SelfMulSub(Ge,mt),ve-=Ye*K.CrossVV(ze,mt),xe.SelfMulAdd(He,mt),Ie+=Je*K.CrossVV(it,mt)}else{var vt=K.SubVV(K.AddVV(xe,it,K.s_t0),K.AddVV(se,ze,K.s_t1),J.SolvePositionConstraints_s_C1),Tt=Ie-ve-this.m_referenceAngle;Ke=vt.Length(),et=H(Tt);var wt=ct.Solve33(vt.x,vt.y,Tt,J.SolvePositionConstraints_s_impulse).SelfNeg();mt=J.SolvePositionConstraints_s_P.Set(wt.x,wt.y),se.SelfMulSub(Ge,mt),ve-=Ye*(K.CrossVV(this.m_rA,mt)+wt.z),xe.SelfMulAdd(He,mt),Ie+=Je*(K.CrossVV(this.m_rB,mt)+wt.z)}return q.positions[this.m_indexA].a=ve,q.positions[this.m_indexB].a=Ie,Ke<=I&&et<=M},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return se.x=q*this.m_impulse.x,se.y=q*this.m_impulse.y,se},J.prototype.GetReactionTorque=function(q){return q*this.m_impulse.z},J.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},J.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},J.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},J.prototype.SetFrequency=function(q){this.m_frequencyHz=q},J.prototype.GetFrequency=function(){return this.m_frequencyHz},J.prototype.SetDampingRatio=function(q){this.m_dampingRatio=q},J.prototype.GetDampingRatio=function(){return this.m_dampingRatio},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2WeldJointDef = new b2WeldJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),q("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),q("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.InitVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_Cdot1=new K,J.SolveVelocityConstraints_s_impulse1=new K,J.SolveVelocityConstraints_s_impulse=new le,J.SolveVelocityConstraints_s_P=new K,J.SolvePositionConstraints_s_C1=new K,J.SolvePositionConstraints_s_P=new K,J.SolvePositionConstraints_s_impulse=new le,J}(Vr),to=function(ae){function J(){var q=ae.call(this,w.b2JointType.e_wheelJoint)||this;return q.localAnchorA=new K(0,0),q.localAnchorB=new K(0,0),q.localAxisA=new K(1,0),q.enableMotor=!1,q.maxMotorTorque=0,q.motorSpeed=0,q.frequencyHz=2,q.dampingRatio=.7,q}return sr(J,ae),J.prototype.Initialize=function(q,se,ve,xe){this.bodyA=q,this.bodyB=se,this.bodyA.GetLocalPoint(ve,this.localAnchorA),this.bodyB.GetLocalPoint(ve,this.localAnchorB),this.bodyA.GetLocalVector(xe,this.localAxisA)},J}(Fr),cs=function(ae){function J(q){var se=ae.call(this,q)||this;return se.m_frequencyHz=0,se.m_dampingRatio=0,se.m_localAnchorA=new K,se.m_localAnchorB=new K,se.m_localXAxisA=new K,se.m_localYAxisA=new K,se.m_impulse=0,se.m_motorImpulse=0,se.m_springImpulse=0,se.m_maxMotorTorque=0,se.m_motorSpeed=0,se.m_enableMotor=!1,se.m_indexA=0,se.m_indexB=0,se.m_localCenterA=new K,se.m_localCenterB=new K,se.m_invMassA=0,se.m_invMassB=0,se.m_invIA=0,se.m_invIB=0,se.m_ax=new K,se.m_ay=new K,se.m_sAx=0,se.m_sBx=0,se.m_sAy=0,se.m_sBy=0,se.m_mass=0,se.m_motorMass=0,se.m_springMass=0,se.m_bias=0,se.m_gamma=0,se.m_qA=new oe,se.m_qB=new oe,se.m_lalcA=new K,se.m_lalcB=new K,se.m_rA=new K,se.m_rB=new K,se.m_frequencyHz=B(q.frequencyHz,2),se.m_dampingRatio=B(q.dampingRatio,.7),se.m_localAnchorA.Copy(B(q.localAnchorA,K.ZERO)),se.m_localAnchorB.Copy(B(q.localAnchorB,K.ZERO)),se.m_localXAxisA.Copy(B(q.localAxisA,K.UNITX)),K.CrossOneV(se.m_localXAxisA,se.m_localYAxisA),se.m_maxMotorTorque=B(q.maxMotorTorque,0),se.m_motorSpeed=B(q.motorSpeed,0),se.m_enableMotor=B(q.enableMotor,!1),se.m_ax.SetZero(),se.m_ay.SetZero(),se}return sr(J,ae),J.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},J.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque},J.prototype.SetSpringFrequencyHz=function(q){this.m_frequencyHz=q},J.prototype.GetSpringFrequencyHz=function(){return this.m_frequencyHz},J.prototype.SetSpringDampingRatio=function(q){this.m_dampingRatio=q},J.prototype.GetSpringDampingRatio=function(){return this.m_dampingRatio},J.prototype.InitVelocityConstraints=function(q){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var se=this.m_invMassA,ve=this.m_invMassB,xe=this.m_invIA,Ie=this.m_invIB,Me=q.positions[this.m_indexA].c,Le=q.positions[this.m_indexA].a,Ge=q.velocities[this.m_indexA].v,He=q.velocities[this.m_indexA].w,Ye=q.positions[this.m_indexB].c,Je=q.positions[this.m_indexB].a,ze=q.velocities[this.m_indexB].v,Ke=q.velocities[this.m_indexB].w,et=this.m_qA.SetAngle(Le),it=this.m_qB.SetAngle(Je);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var ct=oe.MulRV(et,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var mt=oe.MulRV(it,this.m_lalcB,this.m_rB),vt=K.SubVV(K.AddVV(Ye,mt,K.s_t0),K.AddVV(Me,ct,K.s_t1),J.InitVelocityConstraints_s_d);if(oe.MulRV(et,this.m_localYAxisA,this.m_ay),this.m_sAy=K.CrossVV(K.AddVV(vt,ct,K.s_t0),this.m_ay),this.m_sBy=K.CrossVV(mt,this.m_ay),this.m_mass=se+ve+xe*this.m_sAy*this.m_sAy+Ie*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){oe.MulRV(et,this.m_localXAxisA,this.m_ax),this.m_sAx=K.CrossVV(K.AddVV(vt,ct,K.s_t0),this.m_ax),this.m_sBx=K.CrossVV(mt,this.m_ax);var Tt=se+ve+xe*this.m_sAx*this.m_sAx+Ie*this.m_sBx*this.m_sBx;if(Tt>0){this.m_springMass=1/Tt;var wt=K.DotVV(vt,this.m_ax),Pt=2*P*this.m_frequencyHz,Bt=2*this.m_springMass*this.m_dampingRatio*Pt,jt=this.m_springMass*Pt*Pt,Xt=q.step.dt;this.m_gamma=Xt*(Bt+Xt*jt),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=wt*Xt*jt*this.m_gamma,this.m_springMass=Tt+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=xe+Ie,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),q.step.warmStarting){this.m_impulse*=q.step.dtRatio,this.m_springImpulse*=q.step.dtRatio,this.m_motorImpulse*=q.step.dtRatio;var Ht=K.AddVV(K.MulSV(this.m_impulse,this.m_ay,K.s_t0),K.MulSV(this.m_springImpulse,this.m_ax,K.s_t1),J.InitVelocityConstraints_s_P),$t=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,Qt=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;Ge.SelfMulSub(this.m_invMassA,Ht),He-=this.m_invIA*$t,ze.SelfMulAdd(this.m_invMassB,Ht),Ke+=this.m_invIB*Qt}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;q.velocities[this.m_indexA].w=He,q.velocities[this.m_indexB].w=Ke},J.prototype.SolveVelocityConstraints=function(q){var se=this.m_invMassA,ve=this.m_invMassB,xe=this.m_invIA,Ie=this.m_invIB,Me=q.velocities[this.m_indexA].v,Le=q.velocities[this.m_indexA].w,Ge=q.velocities[this.m_indexB].v,He=q.velocities[this.m_indexB].w,Ye=K.DotVV(this.m_ax,K.SubVV(Ge,Me,K.s_t0))+this.m_sBx*He-this.m_sAx*Le,Je=-this.m_springMass*(Ye+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=Je;var ze=K.MulSV(Je,this.m_ax,J.SolveVelocityConstraints_s_P),Ke=Je*this.m_sAx,et=Je*this.m_sBx;Me.SelfMulSub(se,ze),Le-=xe*Ke,Ge.SelfMulAdd(ve,ze),Ye=(He+=Ie*et)-Le-this.m_motorSpeed,Je=-this.m_motorMass*Ye;var it=this.m_motorImpulse,ct=q.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=Y(this.m_motorImpulse+Je,-ct,ct),Le-=xe*(Je=this.m_motorImpulse-it),He+=Ie*Je,Ye=K.DotVV(this.m_ay,K.SubVV(Ge,Me,K.s_t0))+this.m_sBy*He-this.m_sAy*Le,Je=-this.m_mass*Ye,this.m_impulse+=Je,ze=K.MulSV(Je,this.m_ay,J.SolveVelocityConstraints_s_P),Ke=Je*this.m_sAy,et=Je*this.m_sBy,Me.SelfMulSub(se,ze),Le-=xe*Ke,Ge.SelfMulAdd(ve,ze),He+=Ie*et,q.velocities[this.m_indexA].w=Le,q.velocities[this.m_indexB].w=He},J.prototype.SolvePositionConstraints=function(q){var se=q.positions[this.m_indexA].c,ve=q.positions[this.m_indexA].a,xe=q.positions[this.m_indexB].c,Ie=q.positions[this.m_indexB].a,Me=this.m_qA.SetAngle(ve),Le=this.m_qB.SetAngle(Ie);K.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var Ge=oe.MulRV(Me,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var He,Ye=oe.MulRV(Le,this.m_lalcB,this.m_rB),Je=K.AddVV(K.SubVV(xe,se,K.s_t0),K.SubVV(Ye,Ge,K.s_t1),J.SolvePositionConstraints_s_d),ze=oe.MulRV(Me,this.m_localYAxisA,this.m_ay),Ke=K.CrossVV(K.AddVV(Je,Ge,K.s_t0),ze),et=K.CrossVV(Ye,ze),it=K.DotVV(Je,this.m_ay),ct=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;He=ct!==0?-it/ct:0;var mt=K.MulSV(He,ze,J.SolvePositionConstraints_s_P),vt=He*Ke,Tt=He*et;return se.SelfMulSub(this.m_invMassA,mt),ve-=this.m_invIA*vt,xe.SelfMulAdd(this.m_invMassB,mt),Ie+=this.m_invIB*Tt,q.positions[this.m_indexA].a=ve,q.positions[this.m_indexB].a=Ie,H(it)<=I},J.prototype.GetDefinition=function(q){return q},J.prototype.GetAnchorA=function(q){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,q)},J.prototype.GetAnchorB=function(q){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,q)},J.prototype.GetReactionForce=function(q,se){return se.x=q*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x),se.y=q*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y),se},J.prototype.GetReactionTorque=function(q){return q*this.m_motorImpulse},J.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},J.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},J.prototype.GetLocalAxisA=function(){return this.m_localXAxisA},J.prototype.GetJointTranslation=function(){return this.GetPrismaticJointTranslation()},J.prototype.GetJointLinearSpeed=function(){return this.GetPrismaticJointSpeed()},J.prototype.GetJointAngle=function(){return this.GetRevoluteJointAngle()},J.prototype.GetJointAngularSpeed=function(){return this.GetRevoluteJointSpeed()},J.prototype.GetPrismaticJointTranslation=function(){var q=this.m_bodyA,se=this.m_bodyB,ve=q.GetWorldPoint(this.m_localAnchorA,new K),xe=se.GetWorldPoint(this.m_localAnchorB,new K),Ie=K.SubVV(xe,ve,new K),Me=q.GetWorldVector(this.m_localXAxisA,new K);return K.DotVV(Ie,Me)},J.prototype.GetPrismaticJointSpeed=function(){var q=this.m_bodyA,se=this.m_bodyB;K.SubVV(this.m_localAnchorA,q.m_sweep.localCenter,this.m_lalcA);var ve=oe.MulRV(q.m_xf.q,this.m_lalcA,this.m_rA);K.SubVV(this.m_localAnchorB,se.m_sweep.localCenter,this.m_lalcB);var xe=oe.MulRV(se.m_xf.q,this.m_lalcB,this.m_rB),Ie=K.AddVV(q.m_sweep.c,ve,K.s_t0),Me=K.AddVV(se.m_sweep.c,xe,K.s_t1),Le=K.SubVV(Me,Ie,K.s_t2),Ge=q.GetWorldVector(this.m_localXAxisA,new K),He=q.m_linearVelocity,Ye=se.m_linearVelocity,Je=q.m_angularVelocity,ze=se.m_angularVelocity;return K.DotVV(Le,K.CrossSV(Je,Ge,K.s_t0))+K.DotVV(Ge,K.SubVV(K.AddVCrossSV(Ye,ze,xe,K.s_t0),K.AddVCrossSV(He,Je,ve,K.s_t1),K.s_t0))},J.prototype.GetRevoluteJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a},J.prototype.GetRevoluteJointSpeed=function(){var q=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-q},J.prototype.IsMotorEnabled=function(){return this.m_enableMotor},J.prototype.EnableMotor=function(q){q!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=q)},J.prototype.SetMotorSpeed=function(q){q!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=q)},J.prototype.SetMaxMotorTorque=function(q){q!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=q)},J.prototype.GetMotorTorque=function(q){return q*this.m_motorImpulse},J.prototype.Dump=function(q){var se=this.m_bodyA.m_islandIndex,ve=this.m_bodyB.m_islandIndex;q("  const jd: b2WheelJointDef = new b2WheelJointDef();\n"),q("  jd.bodyA = bodies[%d];\n",se),q("  jd.bodyB = bodies[%d];\n",ve),q("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),q("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),q("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),q("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),q("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),q("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),q("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),q("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),q("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),q("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},J.InitVelocityConstraints_s_d=new K,J.InitVelocityConstraints_s_P=new K,J.SolveVelocityConstraints_s_P=new K,J.SolvePositionConstraints_s_d=new K,J.SolvePositionConstraints_s_P=new K,J}(Vr);function mn(ae,J){return ee(ae*J)}function gn(ae,J){return ae>J?ae:J}var fr,vn=function(ae){this.prev=null,this.next=null,this.contact=ae},ii=function(){function ae(){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_prev=null,this.m_next=null,this.m_indexA=0,this.m_indexB=0,this.m_manifold=new rt,this.m_toiCount=0,this.m_toi=0,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_oldManifold=new rt,this.m_nodeA=new vn(this),this.m_nodeB=new vn(this)}return ae.prototype.GetManifold=function(){return this.m_manifold},ae.prototype.GetWorldManifold=function(J){var q=this.m_fixtureA.GetBody(),se=this.m_fixtureB.GetBody(),ve=this.m_fixtureA.GetShape(),xe=this.m_fixtureB.GetShape();J.Initialize(this.m_manifold,q.GetTransform(),ve.m_radius,se.GetTransform(),xe.m_radius)},ae.prototype.IsTouching=function(){return this.m_touchingFlag},ae.prototype.SetEnabled=function(J){this.m_enabledFlag=J},ae.prototype.IsEnabled=function(){return this.m_enabledFlag},ae.prototype.GetNext=function(){return this.m_next},ae.prototype.GetFixtureA=function(){return this.m_fixtureA},ae.prototype.GetChildIndexA=function(){return this.m_indexA},ae.prototype.GetFixtureB=function(){return this.m_fixtureB},ae.prototype.GetChildIndexB=function(){return this.m_indexB},ae.prototype.FlagForFiltering=function(){this.m_filterFlag=!0},ae.prototype.SetFriction=function(J){this.m_friction=J},ae.prototype.GetFriction=function(){return this.m_friction},ae.prototype.ResetFriction=function(){this.m_friction=mn(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},ae.prototype.SetRestitution=function(J){this.m_restitution=J},ae.prototype.GetRestitution=function(){return this.m_restitution},ae.prototype.ResetRestitution=function(){this.m_restitution=gn(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},ae.prototype.SetTangentSpeed=function(J){this.m_tangentSpeed=J},ae.prototype.GetTangentSpeed=function(){return this.m_tangentSpeed},ae.prototype.Reset=function(J,q,se,ve){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!0,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_fixtureA=J,this.m_fixtureB=se,this.m_indexA=q,this.m_indexB=ve,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,delete this.m_nodeA.contact,this.m_nodeA.prev=null,this.m_nodeA.next=null,delete this.m_nodeA.other,delete this.m_nodeB.contact,this.m_nodeB.prev=null,this.m_nodeB.next=null,delete this.m_nodeB.other,this.m_toiCount=0,this.m_friction=mn(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=gn(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},ae.prototype.Update=function(J){var q=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=q,this.m_enabledFlag=!0;var se=!1,ve=this.m_touchingFlag,xe=this.m_fixtureA.IsSensor(),Ie=this.m_fixtureB.IsSensor(),Me=xe||Ie,Le=this.m_fixtureA.GetBody(),Ge=this.m_fixtureB.GetBody(),He=Le.GetTransform(),Ye=Ge.GetTransform();if(Me){var Je=this.m_fixtureA.GetShape(),ze=this.m_fixtureB.GetShape();se=Ft(Je,this.m_indexA,ze,this.m_indexB,He,Ye),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,He,Ye),se=this.m_manifold.pointCount>0;for(var Ke=0;Ke<this.m_manifold.pointCount;++Ke){var et=this.m_manifold.points[Ke];et.normalImpulse=0,et.tangentImpulse=0;for(var it=et.id,ct=0;ct<this.m_oldManifold.pointCount;++ct){var mt=this.m_oldManifold.points[ct];if(mt.id.key===it.key){et.normalImpulse=mt.normalImpulse,et.tangentImpulse=mt.tangentImpulse;break}}}se!==ve&&(Le.SetAwake(!0),Ge.SetAwake(!0))}this.m_touchingFlag=se,!ve&&se&&J&&J.BeginContact(this),ve&&!se&&J&&J.EndContact(this),!Me&&se&&J&&J.PreSolve(this,this.m_oldManifold)},ae.prototype.ComputeTOI=function(J,q){var se=ae.ComputeTOI_s_input;se.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA),se.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB),se.sweepA.Copy(J),se.sweepB.Copy(q),se.tMax=I;var ve=ae.ComputeTOI_s_output;return Dr(ve,se),ve.t},ae.ComputeTOI_s_input=new Rt,ae.ComputeTOI_s_output=new Mt,ae}(),yn=function(ae){function J(){return ae.call(this)||this}return sr(J,ae),J.Create=function(){return new J},J.Destroy=function(){},J.prototype.Reset=function(q,se,ve,xe){ae.prototype.Reset.call(this,q,se,ve,xe)},J.prototype.Evaluate=function(q,se,ve){Br(q,this.m_fixtureA.GetShape(),se,this.m_fixtureB.GetShape(),ve)},J}(ii),xn=function(ae){function J(){return ae.call(this)||this}return sr(J,ae),J.Create=function(){return new J},J.Destroy=function(){},J.prototype.Reset=function(q,se,ve,xe){ae.prototype.Reset.call(this,q,se,ve,xe)},J.prototype.Evaluate=function(q,se,ve){Wn(q,this.m_fixtureA.GetShape(),se,this.m_fixtureB.GetShape(),ve)},J}(ii),bn=function(ae){function J(){return ae.call(this)||this}return sr(J,ae),J.Create=function(){return new J},J.Destroy=function(){},J.prototype.Reset=function(q,se,ve,xe){ae.prototype.Reset.call(this,q,se,ve,xe)},J.prototype.Evaluate=function(q,se,ve){ui(q,this.m_fixtureA.GetShape(),se,this.m_fixtureB.GetShape(),ve)},J}(ii),Cn=function(ae){function J(){return ae.call(this)||this}return sr(J,ae),J.Create=function(){return new J},J.Destroy=function(){},J.prototype.Reset=function(q,se,ve,xe){ae.prototype.Reset.call(this,q,se,ve,xe)},J.prototype.Evaluate=function(q,se,ve){fn(q,this.m_fixtureA.GetShape(),se,this.m_fixtureB.GetShape(),ve)},J}(ii),Tn=function(ae){function J(){return ae.call(this)||this}return sr(J,ae),J.Create=function(){return new J},J.Destroy=function(){},J.prototype.Reset=function(q,se,ve,xe){ae.prototype.Reset.call(this,q,se,ve,xe)},J.prototype.Evaluate=function(q,se,ve){dn(q,this.m_fixtureA.GetShape(),se,this.m_fixtureB.GetShape(),ve)},J}(ii),Sn=function(ae){function J(){return ae.call(this)||this}return sr(J,ae),J.Create=function(){return new J},J.Destroy=function(){},J.prototype.Reset=function(q,se,ve,xe){ae.prototype.Reset.call(this,q,se,ve,xe)},J.prototype.Evaluate=function(q,se,ve){var xe=this.m_fixtureA.GetShape(),Ie=this.m_fixtureB.GetShape(),Me=xe,Le=J.Evaluate_s_edge;Me.GetChildEdge(Le,this.m_indexA),fn(q,Le,se,Ie,ve)},J.Evaluate_s_edge=new bi,J}(ii),wn=function(ae){function J(){return ae.call(this)||this}return sr(J,ae),J.Create=function(){return new J},J.Destroy=function(){},J.prototype.Reset=function(q,se,ve,xe){ae.prototype.Reset.call(this,q,se,ve,xe)},J.prototype.Evaluate=function(q,se,ve){var xe=this.m_fixtureA.GetShape(),Ie=this.m_fixtureB.GetShape(),Me=xe,Le=J.Evaluate_s_edge;Me.GetChildEdge(Le,this.m_indexA),dn(q,Le,se,Ie,ve)},J.Evaluate_s_edge=new bi,J}(ii),us=function(){this.createFcn=null,this.destroyFcn=null,this.primary=!1},hs=function(){function ae(J){this.m_allocator=null,this.m_allocator=J,this.InitializeRegisters()}return ae.prototype.AddType=function(J,q,se,ve){var xe=this,Ie=V(256,function(){return J(xe.m_allocator)});function Me(Ge){return Ie.pop()||J(Ge)}function Le(Ge){Ie.push(Ge)}this.m_registers[se][ve].createFcn=Me,this.m_registers[se][ve].destroyFcn=Le,this.m_registers[se][ve].primary=!0,se!==ve&&(this.m_registers[ve][se].createFcn=Me,this.m_registers[ve][se].destroyFcn=Le,this.m_registers[ve][se].primary=!1)},ae.prototype.InitializeRegisters=function(){this.m_registers=[];for(var J=0;J<w.b2ShapeType.e_shapeTypeCount;J++){this.m_registers[J]=[];for(var q=0;q<w.b2ShapeType.e_shapeTypeCount;q++)this.m_registers[J][q]=new us}this.AddType(yn.Create,yn.Destroy,w.b2ShapeType.e_circleShape,w.b2ShapeType.e_circleShape),this.AddType(bn.Create,bn.Destroy,w.b2ShapeType.e_polygonShape,w.b2ShapeType.e_circleShape),this.AddType(xn.Create,xn.Destroy,w.b2ShapeType.e_polygonShape,w.b2ShapeType.e_polygonShape),this.AddType(Cn.Create,Cn.Destroy,w.b2ShapeType.e_edgeShape,w.b2ShapeType.e_circleShape),this.AddType(Tn.Create,Tn.Destroy,w.b2ShapeType.e_edgeShape,w.b2ShapeType.e_polygonShape),this.AddType(Sn.Create,Sn.Destroy,w.b2ShapeType.e_chainShape,w.b2ShapeType.e_circleShape),this.AddType(wn.Create,wn.Destroy,w.b2ShapeType.e_chainShape,w.b2ShapeType.e_polygonShape)},ae.prototype.Create=function(J,q,se,ve){var xe=J.GetType(),Ie=se.GetType(),Me=this.m_registers[xe][Ie];if(Me.createFcn){var Le=Me.createFcn(this.m_allocator);return Me.primary?Le.Reset(J,q,se,ve):Le.Reset(se,ve,J,q),Le}return null},ae.prototype.Destroy=function(J){var q=J.m_fixtureA,se=J.m_fixtureB;J.m_manifold.pointCount>0&&!q.IsSensor()&&!se.IsSensor()&&(q.GetBody().SetAwake(!0),se.GetBody().SetAwake(!0));var ve=q.GetType(),xe=se.GetType(),Ie=this.m_registers[ve][xe];Ie.destroyFcn&&Ie.destroyFcn(J,this.m_allocator)},ae}(),ro=function(){function ae(){}return ae.prototype.SayGoodbyeJoint=function(){},ae.prototype.SayGoodbyeFixture=function(){},ae.prototype.SayGoodbyeParticleGroup=function(){},ae.prototype.SayGoodbyeParticle=function(){},ae}(),fs=function(){function ae(){}return ae.prototype.ShouldCollide=function(J,q){var se=J.GetBody(),ve=q.GetBody();if(ve.GetType()===w.b2BodyType.b2_staticBody&&se.GetType()===w.b2BodyType.b2_staticBody||!ve.ShouldCollideConnected(se))return!1;var xe=J.GetFilterData(),Ie=q.GetFilterData();return xe.groupIndex===Ie.groupIndex&&xe.groupIndex!==0?xe.groupIndex>0:(xe.maskBits&Ie.categoryBits)!=0&&(xe.categoryBits&Ie.maskBits)!=0},ae.prototype.ShouldCollideFixtureParticle=function(){return!0},ae.prototype.ShouldCollideParticleParticle=function(){return!0},ae.b2_defaultFilter=new ae,ae}(),ds=function(){this.normalImpulses=j(E),this.tangentImpulses=j(E),this.count=0},ps=function(){function ae(){}return ae.prototype.BeginContact=function(){},ae.prototype.EndContact=function(){},ae.prototype.BeginContactFixtureParticle=function(){},ae.prototype.EndContactFixtureParticle=function(){},ae.prototype.BeginContactParticleParticle=function(){},ae.prototype.EndContactParticleParticle=function(){},ae.prototype.PreSolve=function(){},ae.prototype.PostSolve=function(){},ae.b2_defaultListener=new ae,ae}(),Ci=function(){function ae(){}return ae.prototype.ReportFixture=function(){return!0},ae.prototype.ReportParticle=function(){return!1},ae.prototype.ShouldQueryParticleSystem=function(){return!0},ae}(),io=function(){function ae(){}return ae.prototype.ReportFixture=function(J,q,se,ve){return ve},ae.prototype.ReportParticle=function(){return 0},ae.prototype.ShouldQueryParticleSystem=function(){return!0},ae}(),_s=function(){function ae(){this.m_broadPhase=new ft,this.m_contactList=null,this.m_contactCount=0,this.m_contactFilter=fs.b2_defaultFilter,this.m_contactListener=ps.b2_defaultListener,this.m_allocator=null,this.m_contactFactory=new hs(this.m_allocator)}return ae.prototype.AddPair=function(J,q){var se=J.fixture,ve=q.fixture,xe=J.childIndex,Ie=q.childIndex,Me=se.GetBody(),Le=ve.GetBody();if(Me!==Le){for(var Ge=Le.GetContactList();Ge;){if(Ge.other===Me){var He=Ge.contact.GetFixtureA(),Ye=Ge.contact.GetFixtureB(),Je=Ge.contact.GetChildIndexA(),ze=Ge.contact.GetChildIndexB();if(He===se&&Ye===ve&&Je===xe&&ze===Ie||He===ve&&Ye===se&&Je===Ie&&ze===xe)return}Ge=Ge.next}if(!this.m_contactFilter||this.m_contactFilter.ShouldCollide(se,ve)){var Ke=this.m_contactFactory.Create(se,xe,ve,Ie);Ke!==null&&(se=Ke.GetFixtureA(),ve=Ke.GetFixtureB(),xe=Ke.GetChildIndexA(),Ie=Ke.GetChildIndexB(),Me=se.m_body,Le=ve.m_body,Ke.m_prev=null,Ke.m_next=this.m_contactList,this.m_contactList!==null&&(this.m_contactList.m_prev=Ke),this.m_contactList=Ke,Ke.m_nodeA.contact=Ke,Ke.m_nodeA.other=Le,Ke.m_nodeA.prev=null,Ke.m_nodeA.next=Me.m_contactList,Me.m_contactList!==null&&(Me.m_contactList.prev=Ke.m_nodeA),Me.m_contactList=Ke.m_nodeA,Ke.m_nodeB.contact=Ke,Ke.m_nodeB.other=Me,Ke.m_nodeB.prev=null,Ke.m_nodeB.next=Le.m_contactList,Le.m_contactList!==null&&(Le.m_contactList.prev=Ke.m_nodeB),Le.m_contactList=Ke.m_nodeB,se.IsSensor()||ve.IsSensor()||(Me.SetAwake(!0),Le.SetAwake(!0)),++this.m_contactCount)}}},ae.prototype.FindNewContacts=function(){var J=this;this.m_broadPhase.UpdatePairs(function(q,se){J.AddPair(q,se)})},ae.prototype.Destroy=function(J){var q=J.GetFixtureA(),se=J.GetFixtureB(),ve=q.GetBody(),xe=se.GetBody();this.m_contactListener&&J.IsTouching()&&this.m_contactListener.EndContact(J),J.m_prev&&(J.m_prev.m_next=J.m_next),J.m_next&&(J.m_next.m_prev=J.m_prev),J===this.m_contactList&&(this.m_contactList=J.m_next),J.m_nodeA.prev&&(J.m_nodeA.prev.next=J.m_nodeA.next),J.m_nodeA.next&&(J.m_nodeA.next.prev=J.m_nodeA.prev),J.m_nodeA===ve.m_contactList&&(ve.m_contactList=J.m_nodeA.next),J.m_nodeB.prev&&(J.m_nodeB.prev.next=J.m_nodeB.next),J.m_nodeB.next&&(J.m_nodeB.next.prev=J.m_nodeB.prev),J.m_nodeB===xe.m_contactList&&(xe.m_contactList=J.m_nodeB.next),this.m_contactFactory.Destroy(J),--this.m_contactCount},ae.prototype.Collide=function(){for(var J=this.m_contactList;J;){var q=J.GetFixtureA(),se=J.GetFixtureB(),ve=J.GetChildIndexA(),xe=J.GetChildIndexB(),Ie=q.GetBody(),Me=se.GetBody();if(J.m_filterFlag){if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(q,se)){J=(He=J).m_next,this.Destroy(He);continue}J.m_filterFlag=!1}var Le=Ie.IsAwake()&&Ie.m_type!==w.b2BodyType.b2_staticBody,Ge=Me.IsAwake()&&Me.m_type!==w.b2BodyType.b2_staticBody;if(Le||Ge){var He,Ye=q.m_proxies[ve].treeNode,Je=se.m_proxies[xe].treeNode;Kt(Ye.aabb,Je.aabb)?(J.Update(this.m_contactListener),J=J.m_next):(J=(He=J).m_next,this.Destroy(He))}else J=J.m_next}},ae}(),An=function(){function ae(){this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0}return ae.prototype.Reset=function(){return this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0,this},ae}(),fi=function(){function ae(){this.dt=0,this.inv_dt=0,this.dtRatio=0,this.velocityIterations=0,this.positionIterations=0,this.particleIterations=0,this.warmStarting=!1}return ae.prototype.Copy=function(J){return this.dt=J.dt,this.inv_dt=J.inv_dt,this.dtRatio=J.dtRatio,this.positionIterations=J.positionIterations,this.velocityIterations=J.velocityIterations,this.particleIterations=J.particleIterations,this.warmStarting=J.warmStarting,this},ae}(),En=function(){function ae(){this.c=new K,this.a=0}return ae.MakeArray=function(J){return V(J,function(){return new ae})},ae}(),Dn=function(){function ae(){this.v=new K,this.w=0}return ae.MakeArray=function(J){return V(J,function(){return new ae})},ae}(),ms=function(){this.step=new fi},gs=function(){function ae(){this.rA=new K,this.rB=new K,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}return ae.MakeArray=function(J){return V(J,function(){return new ae})},ae}(),In=function(){function ae(){this.points=gs.MakeArray(E),this.normal=new K,this.tangent=new K,this.normalMass=new ce,this.K=new ce,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.invIA=0,this.invIB=0,this.friction=0,this.restitution=0,this.tangentSpeed=0,this.pointCount=0,this.contactIndex=0}return ae.MakeArray=function(J){return V(J,function(){return new ae})},ae}(),Pn=function(){function ae(){this.localPoints=K.MakeArray(E),this.localNormal=new K,this.localPoint=new K,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.localCenterA=new K,this.localCenterB=new K,this.invIA=0,this.invIB=0,this.type=w.b2ManifoldType.e_unknown,this.radiusA=0,this.radiusB=0,this.pointCount=0}return ae.MakeArray=function(J){return V(J,function(){return new ae})},ae}(),vs=function(){this.step=new fi,this.count=0,this.allocator=null},Bn=function(){function ae(){this.normal=new K,this.point=new K,this.separation=0}return ae.prototype.Initialize=function(J,q,se,ve){var xe=ae.Initialize_s_pointA,Ie=ae.Initialize_s_pointB,Me=ae.Initialize_s_planePoint,Le=ae.Initialize_s_clipPoint;switch(J.type){case w.b2ManifoldType.e_circles:de.MulXV(q,J.localPoint,xe),de.MulXV(se,J.localPoints[0],Ie),K.SubVV(Ie,xe,this.normal).SelfNormalize(),K.MidVV(xe,Ie,this.point),this.separation=K.DotVV(K.SubVV(Ie,xe,K.s_t0),this.normal)-J.radiusA-J.radiusB;break;case w.b2ManifoldType.e_faceA:oe.MulRV(q.q,J.localNormal,this.normal),de.MulXV(q,J.localPoint,Me),de.MulXV(se,J.localPoints[ve],Le),this.separation=K.DotVV(K.SubVV(Le,Me,K.s_t0),this.normal)-J.radiusA-J.radiusB,this.point.Copy(Le);break;case w.b2ManifoldType.e_faceB:oe.MulRV(se.q,J.localNormal,this.normal),de.MulXV(se,J.localPoint,Me),de.MulXV(q,J.localPoints[ve],Le),this.separation=K.DotVV(K.SubVV(Le,Me,K.s_t0),this.normal)-J.radiusA-J.radiusB,this.point.Copy(Le),this.normal.SelfNeg()}},ae.Initialize_s_pointA=new K,ae.Initialize_s_pointB=new K,ae.Initialize_s_planePoint=new K,ae.Initialize_s_clipPoint=new K,ae}(),ys=function(){function ae(){this.m_step=new fi,this.m_allocator=null,this.m_positionConstraints=Pn.MakeArray(1024),this.m_velocityConstraints=In.MakeArray(1024),this.m_count=0}return ae.prototype.Initialize=function(J){if(this.m_step.Copy(J.step),this.m_allocator=J.allocator,this.m_count=J.count,this.m_positionConstraints.length<this.m_count)for(var q=X(2*this.m_positionConstraints.length,this.m_count);this.m_positionConstraints.length<q;)this.m_positionConstraints[this.m_positionConstraints.length]=new Pn;if(this.m_velocityConstraints.length<this.m_count)for(q=X(2*this.m_velocityConstraints.length,this.m_count);this.m_velocityConstraints.length<q;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new In;this.m_positions=J.positions,this.m_velocities=J.velocities,this.m_contacts=J.contacts;for(var se=0;se<this.m_count;++se){var ve=this.m_contacts[se],xe=ve.m_fixtureA,Ie=ve.m_fixtureB,Me=xe.GetShape(),Le=Ie.GetShape(),Ge=Me.m_radius,He=Le.m_radius,Ye=xe.GetBody(),Je=Ie.GetBody(),ze=ve.GetManifold(),Ke=ze.pointCount,et=this.m_velocityConstraints[se];et.friction=ve.m_friction,et.restitution=ve.m_restitution,et.tangentSpeed=ve.m_tangentSpeed,et.indexA=Ye.m_islandIndex,et.indexB=Je.m_islandIndex,et.invMassA=Ye.m_invMass,et.invMassB=Je.m_invMass,et.invIA=Ye.m_invI,et.invIB=Je.m_invI,et.contactIndex=se,et.pointCount=Ke,et.K.SetZero(),et.normalMass.SetZero();var it=this.m_positionConstraints[se];it.indexA=Ye.m_islandIndex,it.indexB=Je.m_islandIndex,it.invMassA=Ye.m_invMass,it.invMassB=Je.m_invMass,it.localCenterA.Copy(Ye.m_sweep.localCenter),it.localCenterB.Copy(Je.m_sweep.localCenter),it.invIA=Ye.m_invI,it.invIB=Je.m_invI,it.localNormal.Copy(ze.localNormal),it.localPoint.Copy(ze.localPoint),it.pointCount=Ke,it.radiusA=Ge,it.radiusB=He,it.type=ze.type;for(var ct=0;ct<Ke;++ct){var mt=ze.points[ct],vt=et.points[ct];this.m_step.warmStarting?(vt.normalImpulse=this.m_step.dtRatio*mt.normalImpulse,vt.tangentImpulse=this.m_step.dtRatio*mt.tangentImpulse):(vt.normalImpulse=0,vt.tangentImpulse=0),vt.rA.SetZero(),vt.rB.SetZero(),vt.normalMass=0,vt.tangentMass=0,vt.velocityBias=0,it.localPoints[ct].Copy(mt.localPoint)}}return this},ae.prototype.InitializeVelocityConstraints=function(){for(var J=ae.InitializeVelocityConstraints_s_xfA,q=ae.InitializeVelocityConstraints_s_xfB,se=ae.InitializeVelocityConstraints_s_worldManifold,ve=0;ve<this.m_count;++ve){var xe=this.m_velocityConstraints[ve],Ie=this.m_positionConstraints[ve],Me=Ie.radiusA,Le=Ie.radiusB,Ge=this.m_contacts[xe.contactIndex].GetManifold(),He=xe.indexA,Ye=xe.indexB,Je=xe.invMassA,ze=xe.invMassB,Ke=xe.invIA,et=xe.invIB,it=Ie.localCenterA,ct=Ie.localCenterB,mt=this.m_positions[He].c,vt=this.m_positions[He].a,Tt=this.m_velocities[He].v,wt=this.m_velocities[He].w,Pt=this.m_positions[Ye].c,Bt=this.m_positions[Ye].a,jt=this.m_velocities[Ye].v,Xt=this.m_velocities[Ye].w;J.q.SetAngle(vt),q.q.SetAngle(Bt),K.SubVV(mt,oe.MulRV(J.q,it,K.s_t0),J.p),K.SubVV(Pt,oe.MulRV(q.q,ct,K.s_t0),q.p),se.Initialize(Ge,J,Me,q,Le),xe.normal.Copy(se.normal),K.CrossVOne(xe.normal,xe.tangent);for(var Ht=xe.pointCount,$t=0;$t<Ht;++$t){var Qt=xe.points[$t];K.SubVV(se.points[$t],mt,Qt.rA),K.SubVV(se.points[$t],Pt,Qt.rB);var ur=K.CrossVV(Qt.rA,xe.normal),tr=K.CrossVV(Qt.rB,xe.normal),qt=Je+ze+Ke*ur*ur+et*tr*tr;Qt.normalMass=qt>0?1/qt:0;var ar=xe.tangent,or=K.CrossVV(Qt.rA,ar),vr=K.CrossVV(Qt.rB,ar),mr=Je+ze+Ke*or*or+et*vr*vr;Qt.tangentMass=mr>0?1/mr:0,Qt.velocityBias=0;var wr=K.DotVV(xe.normal,K.SubVV(K.AddVCrossSV(jt,Xt,Qt.rB,K.s_t0),K.AddVCrossSV(Tt,wt,Qt.rA,K.s_t1),K.s_t0));wr<-1&&(Qt.velocityBias+=-xe.restitution*wr)}xe.pointCount}},ae.prototype.WarmStart=function(){for(var J=ae.WarmStart_s_P,q=0;q<this.m_count;++q){for(var se=this.m_velocityConstraints[q],ve=se.indexA,xe=se.indexB,Ie=se.invMassA,Me=se.invIA,Le=se.invMassB,Ge=se.invIB,He=se.pointCount,Ye=this.m_velocities[ve].v,Je=this.m_velocities[ve].w,ze=this.m_velocities[xe].v,Ke=this.m_velocities[xe].w,et=se.normal,it=se.tangent,ct=0;ct<He;++ct){var mt=se.points[ct];K.AddVV(K.MulSV(mt.normalImpulse,et,K.s_t0),K.MulSV(mt.tangentImpulse,it,K.s_t1),J),Je-=Me*K.CrossVV(mt.rA,J),Ye.SelfMulSub(Ie,J),Ke+=Ge*K.CrossVV(mt.rB,J),ze.SelfMulAdd(Le,J)}this.m_velocities[ve].w=Je,this.m_velocities[xe].w=Ke}},ae.prototype.SolveVelocityConstraints=function(){for(var J=ae.SolveVelocityConstraints_s_dv,q=(ae.SolveVelocityConstraints_s_dv1,ae.SolveVelocityConstraints_s_dv2,ae.SolveVelocityConstraints_s_P),se=(ae.SolveVelocityConstraints_s_a,ae.SolveVelocityConstraints_s_b,ae.SolveVelocityConstraints_s_x,ae.SolveVelocityConstraints_s_d,ae.SolveVelocityConstraints_s_P1,ae.SolveVelocityConstraints_s_P2,ae.SolveVelocityConstraints_s_P1P2,0);se<this.m_count;++se){for(var ve=this.m_velocityConstraints[se],xe=ve.indexA,Ie=ve.indexB,Me=ve.invMassA,Le=ve.invIA,Ge=ve.invMassB,He=ve.invIB,Ye=ve.pointCount,Je=this.m_velocities[xe].v,ze=this.m_velocities[xe].w,Ke=this.m_velocities[Ie].v,et=this.m_velocities[Ie].w,it=ve.normal,ct=ve.tangent,mt=ve.friction,vt=0;vt<Ye;++vt){var Tt=ve.points[vt];K.SubVV(K.AddVCrossSV(Ke,et,Tt.rB,K.s_t0),K.AddVCrossSV(Je,ze,Tt.rA,K.s_t1),J);var wt=K.DotVV(J,ct)-ve.tangentSpeed,Pt=Tt.tangentMass*-wt,Bt=mt*Tt.normalImpulse;Pt=(jt=Y(Tt.tangentImpulse+Pt,-Bt,Bt))-Tt.tangentImpulse,Tt.tangentImpulse=jt,K.MulSV(Pt,ct,q),Je.SelfMulSub(Me,q),ze-=Le*K.CrossVV(Tt.rA,q),Ke.SelfMulAdd(Ge,q),et+=He*K.CrossVV(Tt.rB,q)}for(ve.pointCount,vt=0;vt<Ye;++vt){Tt=ve.points[vt],K.SubVV(K.AddVCrossSV(Ke,et,Tt.rB,K.s_t0),K.AddVCrossSV(Je,ze,Tt.rA,K.s_t1),J);var jt,Xt=K.DotVV(J,it);Pt=-Tt.normalMass*(Xt-Tt.velocityBias),Pt=(jt=X(Tt.normalImpulse+Pt,0))-Tt.normalImpulse,Tt.normalImpulse=jt,K.MulSV(Pt,it,q),Je.SelfMulSub(Me,q),ze-=Le*K.CrossVV(Tt.rA,q),Ke.SelfMulAdd(Ge,q),et+=He*K.CrossVV(Tt.rB,q)}this.m_velocities[xe].w=ze,this.m_velocities[Ie].w=et}},ae.prototype.StoreImpulses=function(){for(var J=0;J<this.m_count;++J)for(var q=this.m_velocityConstraints[J],se=this.m_contacts[q.contactIndex].GetManifold(),ve=0;ve<q.pointCount;++ve)se.points[ve].normalImpulse=q.points[ve].normalImpulse,se.points[ve].tangentImpulse=q.points[ve].tangentImpulse},ae.prototype.SolvePositionConstraints=function(){for(var J=ae.SolvePositionConstraints_s_xfA,q=ae.SolvePositionConstraints_s_xfB,se=ae.SolvePositionConstraints_s_psm,ve=ae.SolvePositionConstraints_s_rA,xe=ae.SolvePositionConstraints_s_rB,Ie=ae.SolvePositionConstraints_s_P,Me=0,Le=0;Le<this.m_count;++Le){for(var Ge=this.m_positionConstraints[Le],He=Ge.indexA,Ye=Ge.indexB,Je=Ge.localCenterA,ze=Ge.invMassA,Ke=Ge.invIA,et=Ge.localCenterB,it=Ge.invMassB,ct=Ge.invIB,mt=Ge.pointCount,vt=this.m_positions[He].c,Tt=this.m_positions[He].a,wt=this.m_positions[Ye].c,Pt=this.m_positions[Ye].a,Bt=0;Bt<mt;++Bt){J.q.SetAngle(Tt),q.q.SetAngle(Pt),K.SubVV(vt,oe.MulRV(J.q,Je,K.s_t0),J.p),K.SubVV(wt,oe.MulRV(q.q,et,K.s_t0),q.p),se.Initialize(Ge,J,q,Bt);var jt=se.normal,Xt=se.point,Ht=se.separation;K.SubVV(Xt,vt,ve),K.SubVV(Xt,wt,xe),Me=U(Me,Ht);var $t=Y(.2*(Ht+I),-.2,0),Qt=K.CrossVV(ve,jt),ur=K.CrossVV(xe,jt),tr=ze+it+Ke*Qt*Qt+ct*ur*ur,qt=tr>0?-$t/tr:0;K.MulSV(qt,jt,Ie),vt.SelfMulSub(ze,Ie),Tt-=Ke*K.CrossVV(ve,Ie),wt.SelfMulAdd(it,Ie),Pt+=ct*K.CrossVV(xe,Ie)}this.m_positions[He].a=Tt,this.m_positions[Ye].a=Pt}return Me>-3*I},ae.prototype.SolveTOIPositionConstraints=function(J,q){for(var se=ae.SolveTOIPositionConstraints_s_xfA,ve=ae.SolveTOIPositionConstraints_s_xfB,xe=ae.SolveTOIPositionConstraints_s_psm,Ie=ae.SolveTOIPositionConstraints_s_rA,Me=ae.SolveTOIPositionConstraints_s_rB,Le=ae.SolveTOIPositionConstraints_s_P,Ge=0,He=0;He<this.m_count;++He){var Ye=this.m_positionConstraints[He],Je=Ye.indexA,ze=Ye.indexB,Ke=Ye.localCenterA,et=Ye.localCenterB,it=Ye.pointCount,ct=0,mt=0;Je!==J&&Je!==q||(ct=Ye.invMassA,mt=Ye.invIA);var vt=0,Tt=0;ze!==J&&ze!==q||(vt=Ye.invMassB,Tt=Ye.invIB);for(var wt=this.m_positions[Je].c,Pt=this.m_positions[Je].a,Bt=this.m_positions[ze].c,jt=this.m_positions[ze].a,Xt=0;Xt<it;++Xt){se.q.SetAngle(Pt),ve.q.SetAngle(jt),K.SubVV(wt,oe.MulRV(se.q,Ke,K.s_t0),se.p),K.SubVV(Bt,oe.MulRV(ve.q,et,K.s_t0),ve.p),xe.Initialize(Ye,se,ve,Xt);var Ht=xe.normal,$t=xe.point,Qt=xe.separation;K.SubVV($t,wt,Ie),K.SubVV($t,Bt,Me),Ge=U(Ge,Qt);var ur=Y(.75*(Qt+I),-.2,0),tr=K.CrossVV(Ie,Ht),qt=K.CrossVV(Me,Ht),ar=ct+vt+mt*tr*tr+Tt*qt*qt,or=ar>0?-ur/ar:0;K.MulSV(or,Ht,Le),wt.SelfMulSub(ct,Le),Pt-=mt*K.CrossVV(Ie,Le),Bt.SelfMulAdd(vt,Le),jt+=Tt*K.CrossVV(Me,Le)}this.m_positions[Je].a=Pt,this.m_positions[ze].a=jt}return Ge>=-1.5*I},ae.InitializeVelocityConstraints_s_xfA=new de,ae.InitializeVelocityConstraints_s_xfB=new de,ae.InitializeVelocityConstraints_s_worldManifold=new bt,ae.WarmStart_s_P=new K,ae.SolveVelocityConstraints_s_dv=new K,ae.SolveVelocityConstraints_s_dv1=new K,ae.SolveVelocityConstraints_s_dv2=new K,ae.SolveVelocityConstraints_s_P=new K,ae.SolveVelocityConstraints_s_a=new K,ae.SolveVelocityConstraints_s_b=new K,ae.SolveVelocityConstraints_s_x=new K,ae.SolveVelocityConstraints_s_d=new K,ae.SolveVelocityConstraints_s_P1=new K,ae.SolveVelocityConstraints_s_P2=new K,ae.SolveVelocityConstraints_s_P1P2=new K,ae.SolvePositionConstraints_s_xfA=new de,ae.SolvePositionConstraints_s_xfB=new de,ae.SolvePositionConstraints_s_psm=new Bn,ae.SolvePositionConstraints_s_rA=new K,ae.SolvePositionConstraints_s_rB=new K,ae.SolvePositionConstraints_s_P=new K,ae.SolveTOIPositionConstraints_s_xfA=new de,ae.SolveTOIPositionConstraints_s_xfB=new de,ae.SolveTOIPositionConstraints_s_psm=new Bn,ae.SolveTOIPositionConstraints_s_rA=new K,ae.SolveTOIPositionConstraints_s_rB=new K,ae.SolveTOIPositionConstraints_s_P=new K,ae}(),xs=function(){function ae(){this.m_allocator=null,this.m_bodies=[],this.m_contacts=[],this.m_joints=[],this.m_positions=En.MakeArray(1024),this.m_velocities=Dn.MakeArray(1024),this.m_bodyCount=0,this.m_jointCount=0,this.m_contactCount=0,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0}return ae.prototype.Initialize=function(J,q,se,ve,xe){if(this.m_bodyCapacity=J,this.m_contactCapacity=q,this.m_jointCapacity=se,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=ve,this.m_listener=xe,this.m_positions.length<J)for(var Ie=X(2*this.m_positions.length,J);this.m_positions.length<Ie;)this.m_positions[this.m_positions.length]=new En;if(this.m_velocities.length<J)for(Ie=X(2*this.m_velocities.length,J);this.m_velocities.length<Ie;)this.m_velocities[this.m_velocities.length]=new Dn},ae.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},ae.prototype.AddBody=function(J){J.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=J},ae.prototype.AddContact=function(J){this.m_contacts[this.m_contactCount++]=J},ae.prototype.AddJoint=function(J){this.m_joints[this.m_jointCount++]=J},ae.prototype.Solve=function(J,q,se,ve){for(var xe=ae.s_timer.Reset(),Ie=q.dt,Me=0;Me<this.m_bodyCount;++Me){var Le=this.m_bodies[Me];this.m_positions[Me].c.Copy(Le.m_sweep.c);var Ge=Le.m_sweep.a,He=this.m_velocities[Me].v.Copy(Le.m_linearVelocity),Ye=Le.m_angularVelocity;Le.m_sweep.c0.Copy(Le.m_sweep.c),Le.m_sweep.a0=Le.m_sweep.a,Le.m_type===w.b2BodyType.b2_dynamicBody&&(He.x+=Ie*(Le.m_gravityScale*se.x+Le.m_invMass*Le.m_force.x),He.y+=Ie*(Le.m_gravityScale*se.y+Le.m_invMass*Le.m_force.y),Ye+=Ie*Le.m_invI*Le.m_torque,He.SelfMul(1/(1+Ie*Le.m_linearDamping)),Ye*=1/(1+Ie*Le.m_angularDamping)),this.m_positions[Me].a=Ge,this.m_velocities[Me].w=Ye}xe.Reset();var Je=ae.s_solverData;Je.step.Copy(q),Je.positions=this.m_positions,Je.velocities=this.m_velocities;var ze=ae.s_contactSolverDef;ze.step.Copy(q),ze.contacts=this.m_contacts,ze.count=this.m_contactCount,ze.positions=this.m_positions,ze.velocities=this.m_velocities,ze.allocator=this.m_allocator;var Ke=ae.s_contactSolver.Initialize(ze);for(Ke.InitializeVelocityConstraints(),q.warmStarting&&Ke.WarmStart(),Me=0;Me<this.m_jointCount;++Me)this.m_joints[Me].InitVelocityConstraints(Je);for(J.solveInit=xe.GetMilliseconds(),xe.Reset(),Me=0;Me<q.velocityIterations;++Me){for(var et=0;et<this.m_jointCount;++et)this.m_joints[et].SolveVelocityConstraints(Je);Ke.SolveVelocityConstraints()}for(Ke.StoreImpulses(),J.solveVelocity=xe.GetMilliseconds(),Me=0;Me<this.m_bodyCount;++Me){var it=this.m_positions[Me].c,ct=(Ge=this.m_positions[Me].a,He=this.m_velocities[Me].v,Ye=this.m_velocities[Me].w,K.MulSV(Ie,He,ae.s_translation));if(K.DotVV(ct,ct)>4){var mt=2/ct.Length();He.SelfMul(mt)}var vt=Ie*Ye;vt*vt>2.4674011002726646&&(Ye*=mt=1.570796326795/H(vt)),it.x+=Ie*He.x,it.y+=Ie*He.y,Ge+=Ie*Ye,this.m_positions[Me].a=Ge,this.m_velocities[Me].w=Ye}xe.Reset();var Tt=!1;for(Me=0;Me<q.positionIterations;++Me){var wt=Ke.SolvePositionConstraints(),Pt=!0;for(et=0;et<this.m_jointCount;++et){var Bt=this.m_joints[et].SolvePositionConstraints(Je);Pt=Pt&&Bt}if(wt&&Pt){Tt=!0;break}}for(Me=0;Me<this.m_bodyCount;++Me){var jt=this.m_bodies[Me];jt.m_sweep.c.Copy(this.m_positions[Me].c),jt.m_sweep.a=this.m_positions[Me].a,jt.m_linearVelocity.Copy(this.m_velocities[Me].v),jt.m_angularVelocity=this.m_velocities[Me].w,jt.SynchronizeTransform()}if(J.solvePosition=xe.GetMilliseconds(),this.Report(Ke.m_velocityConstraints),ve){var Xt=A;for(Me=0;Me<this.m_bodyCount;++Me)(Le=this.m_bodies[Me]).GetType()!==w.b2BodyType.b2_staticBody&&(!Le.m_autoSleepFlag||Le.m_angularVelocity*Le.m_angularVelocity>.0012184696791469947||K.DotVV(Le.m_linearVelocity,Le.m_linearVelocity)>1e-4?(Le.m_sleepTime=0,Xt=0):(Le.m_sleepTime+=Ie,Xt=U(Xt,Le.m_sleepTime)));if(Xt>=.5&&Tt)for(Me=0;Me<this.m_bodyCount;++Me)(Le=this.m_bodies[Me]).SetAwake(!1)}},ae.prototype.SolveTOI=function(J,q,se){for(var ve=0;ve<this.m_bodyCount;++ve){var xe=this.m_bodies[ve];this.m_positions[ve].c.Copy(xe.m_sweep.c),this.m_positions[ve].a=xe.m_sweep.a,this.m_velocities[ve].v.Copy(xe.m_linearVelocity),this.m_velocities[ve].w=xe.m_angularVelocity}var Ie=ae.s_contactSolverDef;Ie.contacts=this.m_contacts,Ie.count=this.m_contactCount,Ie.allocator=this.m_allocator,Ie.step.Copy(J),Ie.positions=this.m_positions,Ie.velocities=this.m_velocities;var Me=ae.s_contactSolver.Initialize(Ie);for(ve=0;ve<J.positionIterations&&!Me.SolveTOIPositionConstraints(q,se);++ve);for(this.m_bodies[q].m_sweep.c0.Copy(this.m_positions[q].c),this.m_bodies[q].m_sweep.a0=this.m_positions[q].a,this.m_bodies[se].m_sweep.c0.Copy(this.m_positions[se].c),this.m_bodies[se].m_sweep.a0=this.m_positions[se].a,Me.InitializeVelocityConstraints(),ve=0;ve<J.velocityIterations;++ve)Me.SolveVelocityConstraints();var Le=J.dt;for(ve=0;ve<this.m_bodyCount;++ve){var Ge=this.m_positions[ve].c,He=this.m_positions[ve].a,Ye=this.m_velocities[ve].v,Je=this.m_velocities[ve].w,ze=K.MulSV(Le,Ye,ae.s_translation);if(K.DotVV(ze,ze)>4){var Ke=2/ze.Length();Ye.SelfMul(Ke)}var et=Le*Je;et*et>2.4674011002726646&&(Je*=Ke=1.570796326795/H(et)),Ge.SelfMulAdd(Le,Ye),He+=Le*Je,this.m_positions[ve].a=He,this.m_velocities[ve].w=Je;var it=this.m_bodies[ve];it.m_sweep.c.Copy(Ge),it.m_sweep.a=He,it.m_linearVelocity.Copy(Ye),it.m_angularVelocity=Je,it.SynchronizeTransform()}this.Report(Me.m_velocityConstraints)},ae.prototype.Report=function(J){if(this.m_listener!==null)for(var q=0;q<this.m_contactCount;++q){var se=this.m_contacts[q];if(se){var ve=J[q],xe=ae.s_impulse;xe.count=ve.pointCount;for(var Ie=0;Ie<ve.pointCount;++Ie)xe.normalImpulses[Ie]=ve.points[Ie].normalImpulse,xe.tangentImpulses[Ie]=ve.points[Ie].tangentImpulse;this.m_listener.PostSolve(se,xe)}}},ae.s_timer=new we,ae.s_solverData=new ms,ae.s_contactSolverDef=new vs,ae.s_contactSolver=new ys,ae.s_translation=new K,ae.s_impulse=new ds,ae}();(fr=w.b2ParticleFlag||(w.b2ParticleFlag={}))[fr.b2_waterParticle=0]="b2_waterParticle",fr[fr.b2_zombieParticle=2]="b2_zombieParticle",fr[fr.b2_wallParticle=4]="b2_wallParticle",fr[fr.b2_springParticle=8]="b2_springParticle",fr[fr.b2_elasticParticle=16]="b2_elasticParticle",fr[fr.b2_viscousParticle=32]="b2_viscousParticle",fr[fr.b2_powderParticle=64]="b2_powderParticle",fr[fr.b2_tensileParticle=128]="b2_tensileParticle",fr[fr.b2_colorMixingParticle=256]="b2_colorMixingParticle",fr[fr.b2_destructionListenerParticle=512]="b2_destructionListenerParticle",fr[fr.b2_barrierParticle=1024]="b2_barrierParticle",fr[fr.b2_staticPressureParticle=2048]="b2_staticPressureParticle",fr[fr.b2_reactiveParticle=4096]="b2_reactiveParticle",fr[fr.b2_repulsiveParticle=8192]="b2_repulsiveParticle",fr[fr.b2_fixtureContactListenerParticle=16384]="b2_fixtureContactListenerParticle",fr[fr.b2_particleContactListenerParticle=32768]="b2_particleContactListenerParticle",fr[fr.b2_fixtureContactFilterParticle=65536]="b2_fixtureContactFilterParticle",fr[fr.b2_particleContactFilterParticle=131072]="b2_particleContactFilterParticle";var Ln=function(){this.flags=0,this.position=new K,this.velocity=new K,this.color=new ye(0,0,0,0),this.lifetime=0,this.userData=null,this.group=null};function bs(ae,J,q){return Y(Math.ceil(Math.sqrt(ae/(.01*J))*q),1,8)}var Yr,Cs=function(){function ae(){this.m_index=k}return ae.prototype.GetIndex=function(){return this.m_index},ae.prototype.SetIndex=function(J){this.m_index=J},ae}();(Yr=w.b2ParticleGroupFlag||(w.b2ParticleGroupFlag={}))[Yr.b2_solidParticleGroup=1]="b2_solidParticleGroup",Yr[Yr.b2_rigidParticleGroup=2]="b2_rigidParticleGroup",Yr[Yr.b2_particleGroupCanBeEmpty=4]="b2_particleGroupCanBeEmpty",Yr[Yr.b2_particleGroupWillBeDestroyed=8]="b2_particleGroupWillBeDestroyed",Yr[Yr.b2_particleGroupNeedsUpdateDepth=16]="b2_particleGroupNeedsUpdateDepth",Yr[Yr.b2_particleGroupInternalMask=24]="b2_particleGroupInternalMask";var Ts=function(){this.flags=0,this.groupFlags=0,this.position=new K,this.angle=0,this.linearVelocity=new K,this.angularVelocity=0,this.color=new ye,this.strength=1,this.shapeCount=0,this.stride=0,this.particleCount=0,this.lifetime=0,this.userData=null,this.group=null},Ss=function(){function ae(J){this.m_firstIndex=0,this.m_lastIndex=0,this.m_groupFlags=0,this.m_strength=1,this.m_prev=null,this.m_next=null,this.m_timestamp=-1,this.m_mass=0,this.m_inertia=0,this.m_center=new K,this.m_linearVelocity=new K,this.m_angularVelocity=0,this.m_transform=new de,this.m_userData=null,this.m_system=J}return ae.prototype.GetNext=function(){return this.m_next},ae.prototype.GetParticleSystem=function(){return this.m_system},ae.prototype.GetParticleCount=function(){return this.m_lastIndex-this.m_firstIndex},ae.prototype.GetBufferIndex=function(){return this.m_firstIndex},ae.prototype.ContainsParticle=function(J){return this.m_firstIndex<=J&&J<this.m_lastIndex},ae.prototype.GetAllParticleFlags=function(){if(!this.m_system.m_flagsBuffer.data)throw new Error;for(var J=0,q=this.m_firstIndex;q<this.m_lastIndex;q++)J|=this.m_system.m_flagsBuffer.data[q];return J},ae.prototype.GetGroupFlags=function(){return this.m_groupFlags},ae.prototype.SetGroupFlags=function(J){J|=this.m_groupFlags&w.b2ParticleGroupFlag.b2_particleGroupInternalMask,this.m_system.SetGroupFlags(this,J)},ae.prototype.GetMass=function(){return this.UpdateStatistics(),this.m_mass},ae.prototype.GetInertia=function(){return this.UpdateStatistics(),this.m_inertia},ae.prototype.GetCenter=function(){return this.UpdateStatistics(),this.m_center},ae.prototype.GetLinearVelocity=function(){return this.UpdateStatistics(),this.m_linearVelocity},ae.prototype.GetAngularVelocity=function(){return this.UpdateStatistics(),this.m_angularVelocity},ae.prototype.GetTransform=function(){return this.m_transform},ae.prototype.GetPosition=function(){return this.m_transform.p},ae.prototype.GetAngle=function(){return this.m_transform.q.GetAngle()},ae.prototype.GetLinearVelocityFromWorldPoint=function(J,q){var se=ae.GetLinearVelocityFromWorldPoint_s_t0;return this.UpdateStatistics(),K.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,K.SubVV(J,this.m_center,se),q)},ae.prototype.GetUserData=function(){return this.m_userData},ae.prototype.SetUserData=function(J){this.m_userData=J},ae.prototype.ApplyForce=function(J){this.m_system.ApplyForce(this.m_firstIndex,this.m_lastIndex,J)},ae.prototype.ApplyLinearImpulse=function(J){this.m_system.ApplyLinearImpulse(this.m_firstIndex,this.m_lastIndex,J)},ae.prototype.DestroyParticles=function(J){if(this.m_system.m_world.IsLocked())throw new Error;for(var q=this.m_firstIndex;q<this.m_lastIndex;q++)this.m_system.DestroyParticle(q,J)},ae.prototype.UpdateStatistics=function(){if(!this.m_system.m_positionBuffer.data)throw new Error;if(!this.m_system.m_velocityBuffer.data)throw new Error;var J=new K,q=new K;if(this.m_timestamp!==this.m_system.m_timestamp){var se=this.m_system.GetParticleMass();this.m_mass=se*(this.m_lastIndex-this.m_firstIndex),this.m_center.SetZero(),this.m_linearVelocity.SetZero();for(var ve=this.m_firstIndex;ve<this.m_lastIndex;ve++)this.m_center.SelfMulAdd(se,this.m_system.m_positionBuffer.data[ve]),this.m_linearVelocity.SelfMulAdd(se,this.m_system.m_velocityBuffer.data[ve]);if(this.m_mass>0){var xe=1/this.m_mass;this.m_center.SelfMul(xe),this.m_linearVelocity.SelfMul(xe)}for(this.m_inertia=0,this.m_angularVelocity=0,ve=this.m_firstIndex;ve<this.m_lastIndex;ve++)K.SubVV(this.m_system.m_positionBuffer.data[ve],this.m_center,J),K.SubVV(this.m_system.m_velocityBuffer.data[ve],this.m_linearVelocity,q),this.m_inertia+=se*K.DotVV(J,J),this.m_angularVelocity+=se*K.CrossVV(J,q);this.m_inertia>0&&(this.m_angularVelocity*=1/this.m_inertia),this.m_timestamp=this.m_system.m_timestamp}},ae.GetLinearVelocityFromWorldPoint_s_t0=new K,ae}(),no=function(){function ae(J){this.m_front=0,this.m_back=0,this.m_capacity=0,this.m_buffer=V(J,function(){return null}),this.m_capacity=J}return ae.prototype.Push=function(J){if(this.m_back>=this.m_capacity){for(var q=this.m_front;q<this.m_back;q++)this.m_buffer[q-this.m_front]=this.m_buffer[q];this.m_back-=this.m_front,this.m_front=0,this.m_back>=this.m_capacity&&(this.m_capacity>0?(this.m_buffer.concat(V(this.m_capacity,function(){return null})),this.m_capacity*=2):(this.m_buffer.concat(V(1,function(){return null})),this.m_capacity=1))}this.m_buffer[this.m_back]=J,this.m_back++},ae.prototype.Pop=function(){this.m_buffer[this.m_front]=null,this.m_front++},ae.prototype.Empty=function(){return this.m_front===this.m_back},ae.prototype.Front=function(){var J=this.m_buffer[this.m_front];if(!J)throw new Error;return J},ae}(),Rn=function(){function ae(J){this.m_generatorCapacity=0,this.m_generatorCount=0,this.m_countX=0,this.m_countY=0,this.m_diagram=[],this.m_generatorBuffer=V(J,function(){return new ae.Generator}),this.m_generatorCapacity=J}return ae.prototype.AddGenerator=function(J,q,se){var ve=this.m_generatorBuffer[this.m_generatorCount++];ve.center.Copy(J),ve.tag=q,ve.necessary=se},ae.prototype.Generate=function(J,q){for(var se=1/J,ve=new K(+A,+A),xe=new K(-A,-A),Ie=0,Me=0;Me<this.m_generatorCount;Me++)(Je=this.m_generatorBuffer[Me]).necessary&&(K.MinV(ve,Je.center,ve),K.MaxV(xe,Je.center,xe),++Ie);if(Ie===0)return this.m_countX=0,void(this.m_countY=0);ve.x-=q,ve.y-=q,xe.x+=q,xe.y+=q,this.m_countX=1+Math.floor(se*(xe.x-ve.x)),this.m_countY=1+Math.floor(se*(xe.y-ve.y)),this.m_diagram=[];var Le=new no(4*this.m_countX*this.m_countY);for(Me=0;Me<this.m_generatorCount;Me++){(Je=this.m_generatorBuffer[Me]).center.SelfSub(ve).SelfMul(se);var Ge=Math.floor(Je.center.x),He=Math.floor(Je.center.y);Ge>=0&&He>=0&&Ge<this.m_countX&&He<this.m_countY&&Le.Push(new ae.Task(Ge,He,Ge+He*this.m_countX,Je))}for(;!Le.Empty();){Ge=(ze=Le.Front()).m_x,He=ze.m_y;var Ye=ze.m_i,Je=ze.m_generator;Le.Pop(),this.m_diagram[Ye]||(this.m_diagram[Ye]=Je,Ge>0&&Le.Push(new ae.Task(Ge-1,He,Ye-1,Je)),He>0&&Le.Push(new ae.Task(Ge,He-1,Ye-this.m_countX,Je)),Ge<this.m_countX-1&&Le.Push(new ae.Task(Ge+1,He,Ye+1,Je)),He<this.m_countY-1&&Le.Push(new ae.Task(Ge,He+1,Ye+this.m_countX,Je)))}for(He=0;He<this.m_countY;He++)for(Ge=0;Ge<this.m_countX-1;Ge++)Ye=Ge+He*this.m_countX,(Ke=this.m_diagram[Ye])!==(et=this.m_diagram[Ye+1])&&(Le.Push(new ae.Task(Ge,He,Ye,et)),Le.Push(new ae.Task(Ge+1,He,Ye+1,Ke)));for(He=0;He<this.m_countY-1;He++)for(Ge=0;Ge<this.m_countX;Ge++)Ye=Ge+He*this.m_countX,(Ke=this.m_diagram[Ye])!==(et=this.m_diagram[Ye+this.m_countX])&&(Le.Push(new ae.Task(Ge,He,Ye,et)),Le.Push(new ae.Task(Ge,He+1,Ye+this.m_countX,Ke)));for(;!Le.Empty();){var ze,Ke,et;if(Ge=(ze=Le.Front()).m_x,He=ze.m_y,Ye=ze.m_i,Me=ze.m_generator,Le.Pop(),(Ke=this.m_diagram[Ye])!==(et=Me)){var it=Ke.center.x-Ge,ct=Ke.center.y-He,mt=et.center.x-Ge,vt=et.center.y-He;it*it+ct*ct>mt*mt+vt*vt&&(this.m_diagram[Ye]=et,Ge>0&&Le.Push(new ae.Task(Ge-1,He,Ye-1,et)),He>0&&Le.Push(new ae.Task(Ge,He-1,Ye-this.m_countX,et)),Ge<this.m_countX-1&&Le.Push(new ae.Task(Ge+1,He,Ye+1,et)),He<this.m_countY-1&&Le.Push(new ae.Task(Ge,He+1,Ye+this.m_countX,et)))}}},ae.prototype.GetNodes=function(J){for(var q=0;q<this.m_countY-1;q++)for(var se=0;se<this.m_countX-1;se++){var ve=se+q*this.m_countX,xe=this.m_diagram[ve],Ie=this.m_diagram[ve+1],Me=this.m_diagram[ve+this.m_countX],Le=this.m_diagram[ve+1+this.m_countX];Ie!==Me&&(xe!==Ie&&xe!==Me&&(xe.necessary||Ie.necessary||Me.necessary)&&J(xe.tag,Ie.tag,Me.tag),Le!==Ie&&Le!==Me&&(xe.necessary||Ie.necessary||Me.necessary)&&J(Ie.tag,Le.tag,Me.tag))}},ae}();function Zi(ae,J,q){var se=ae[J];ae[J]=ae[q],ae[q]=se}function Ji(ae,J){return ae<J}function Ki(ae,J,q,se){q===void 0&&(q=ae.length-J),se===void 0&&(se=Ji);for(var ve=J,xe=[],Ie=0;;){for(;ve+1<q;q++){var Me=ae[ve+Math.floor(Math.random()*(q-ve))];xe[Ie++]=q;for(var Le=ve-1;;){for(;se(ae[++Le],Me););for(;se(Me,ae[--q]););if(Le>=q)break;Zi(ae,Le,q)}}if(Ie===0)break;ve=q,q=xe[--Ie]}return ae}function ws(ae,J,q,se){return q===void 0&&(q=ae.length-J),se===void 0&&(se=Ji),Ki(ae,J,q,se)}function As(ae,J,q){q===void 0&&(q=ae.length);for(var se=0,ve=0;ve<q;++ve)J(ae[ve])||(ve!==se?Zi(ae,se++,ve):++se);return se}function Es(ae,J,q,se,ve){ve===void 0&&(ve=Ji);for(var xe=q-J;xe>0;){var Ie=Math.floor(xe/2),Me=J+Ie;ve(ae[Me],se)?(J=++Me,xe-=Ie+1):xe=Ie}return J}function Ds(ae,J,q,se,ve){ve===void 0&&(ve=Ji);for(var xe=q-J;xe>0;){var Ie=Math.floor(xe/2),Me=J+Ie;ve(se,ae[Me])?xe=Ie:(J=++Me,xe-=Ie+1)}return J}function Mr(ae,J,q,se){for(var ve=q;J!==ve;)Zi(ae,J++,ve++),ve===se?ve=q:J===q&&(q=ve)}function so(ae,J,q,se){if(J===q)return q;for(var ve=J;++J!==q;)se(ae[ve],ae[J])||Zi(ae,++ve,J);return++ve}(function(ae){ae.Generator=function(){this.center=new K,this.tag=0,this.necessary=!1},ae.Task=function(J,q,se,ve){this.m_x=J,this.m_y=q,this.m_i=se,this.m_generator=ve}})(Rn||(Rn={}));var di=function(){function ae(J){this.data=[],this.count=0,this.capacity=0,this.allocator=J}return ae.prototype.Append=function(){return this.count>=this.capacity&&this.Grow(),this.count++},ae.prototype.Reserve=function(J){if(!(this.capacity>=J)){for(var q=this.capacity;q<J;++q)this.data[q]=this.allocator();this.capacity=J}},ae.prototype.Grow=function(){var J=this.capacity?2*this.capacity:256;this.Reserve(J)},ae.prototype.Free=function(){this.data.length!==0&&(this.data=[],this.capacity=0,this.count=0)},ae.prototype.Shorten=function(){},ae.prototype.Data=function(){return this.data},ae.prototype.GetCount=function(){return this.count},ae.prototype.SetCount=function(J){this.count=J},ae.prototype.GetCapacity=function(){return this.capacity},ae.prototype.RemoveIf=function(J){this.count=As(this.data,J,this.count)},ae.prototype.Unique=function(J){this.count=so(this.data,0,this.count,J)},ae}(),On=function(ae){function J(q){var se=ae.call(this)||this;return se.m_system=q,se}return sr(J,ae),J.prototype.ShouldQueryParticleSystem=function(){return!1},J.prototype.ReportFixture=function(q){if(q.IsSensor())return!0;for(var se=q.GetShape().GetChildCount(),ve=0;ve<se;ve++)for(var xe=q.GetAABB(ve),Ie=this.m_system.GetInsideBoundsEnumerator(xe),Me=void 0;(Me=Ie.GetNext())>=0;)this.ReportFixtureAndParticle(q,ve,Me);return!0},J.prototype.ReportParticle=function(){return!1},J.prototype.ReportFixtureAndParticle=function(){},J}(Ci),Is=function(){function ae(){this.indexA=0,this.indexB=0,this.weight=0,this.normal=new K,this.flags=0}return ae.prototype.SetIndices=function(J,q){this.indexA=J,this.indexB=q},ae.prototype.SetWeight=function(J){this.weight=J},ae.prototype.SetNormal=function(J){this.normal.Copy(J)},ae.prototype.SetFlags=function(J){this.flags=J},ae.prototype.GetIndexA=function(){return this.indexA},ae.prototype.GetIndexB=function(){return this.indexB},ae.prototype.GetWeight=function(){return this.weight},ae.prototype.GetNormal=function(){return this.normal},ae.prototype.GetFlags=function(){return this.flags},ae.prototype.IsEqual=function(J){return this.indexA===J.indexA&&this.indexB===J.indexB&&this.flags===J.flags&&this.weight===J.weight&&this.normal.x===J.normal.x&&this.normal.y===J.normal.y},ae.prototype.IsNotEqual=function(J){return!this.IsEqual(J)},ae.prototype.ApproximatelyEqual=function(J){return this.indexA===J.indexA&&this.indexB===J.indexB&&this.flags===J.flags&&H(this.weight-J.weight)<.01&&K.DistanceSquaredVV(this.normal,J.normal)<1e-4},ae}(),Ps=function(){this.index=0,this.weight=0,this.normal=new K,this.mass=0},Bs=function(){this.indexA=0,this.indexB=0,this.flags=0,this.strength=0,this.distance=0},Ls=function(){this.indexA=0,this.indexB=0,this.indexC=0,this.flags=0,this.strength=0,this.pa=new K(0,0),this.pb=new K(0,0),this.pc=new K(0,0),this.ka=0,this.kb=0,this.kc=0,this.s=0},Rs=function(){function ae(){this.strictContactCheck=!1,this.density=1,this.gravityScale=1,this.radius=1,this.maxCount=0,this.pressureStrength=.005,this.dampingStrength=1,this.elasticStrength=.25,this.springStrength=.25,this.viscousStrength=.25,this.surfaceTensionPressureStrength=.2,this.surfaceTensionNormalStrength=.2,this.repulsiveStrength=1,this.powderStrength=.5,this.ejectionStrength=.5,this.staticPressureStrength=.2,this.staticPressureRelaxation=.2,this.staticPressureIterations=8,this.colorMixingStrength=.5,this.destroyByAge=!0,this.lifetimeGranularity=1/60}return ae.prototype.Copy=function(J){return this.strictContactCheck=J.strictContactCheck,this.density=J.density,this.gravityScale=J.gravityScale,this.radius=J.radius,this.maxCount=J.maxCount,this.pressureStrength=J.pressureStrength,this.dampingStrength=J.dampingStrength,this.elasticStrength=J.elasticStrength,this.springStrength=J.springStrength,this.viscousStrength=J.viscousStrength,this.surfaceTensionPressureStrength=J.surfaceTensionPressureStrength,this.surfaceTensionNormalStrength=J.surfaceTensionNormalStrength,this.repulsiveStrength=J.repulsiveStrength,this.powderStrength=J.powderStrength,this.ejectionStrength=J.ejectionStrength,this.staticPressureStrength=J.staticPressureStrength,this.staticPressureRelaxation=J.staticPressureRelaxation,this.staticPressureIterations=J.staticPressureIterations,this.colorMixingStrength=J.colorMixingStrength,this.destroyByAge=J.destroyByAge,this.lifetimeGranularity=J.lifetimeGranularity,this},ae.prototype.Clone=function(){return new ae().Copy(this)},ae}();w.b2ParticleSystem=function(){function ae(J,q){this.m_paused=!1,this.m_timestamp=0,this.m_allParticleFlags=0,this.m_needsUpdateAllParticleFlags=!1,this.m_allGroupFlags=0,this.m_needsUpdateAllGroupFlags=!1,this.m_hasForce=!1,this.m_iterationIndex=0,this.m_inverseDensity=0,this.m_particleDiameter=0,this.m_inverseDiameter=0,this.m_squaredDiameter=0,this.m_count=0,this.m_internalAllocatedCapacity=0,this.m_handleIndexBuffer=new ae.UserOverridableBuffer,this.m_flagsBuffer=new ae.UserOverridableBuffer,this.m_positionBuffer=new ae.UserOverridableBuffer,this.m_velocityBuffer=new ae.UserOverridableBuffer,this.m_forceBuffer=[],this.m_weightBuffer=[],this.m_staticPressureBuffer=[],this.m_accumulationBuffer=[],this.m_accumulation2Buffer=[],this.m_depthBuffer=[],this.m_colorBuffer=new ae.UserOverridableBuffer,this.m_groupBuffer=[],this.m_userDataBuffer=new ae.UserOverridableBuffer,this.m_stuckThreshold=0,this.m_lastBodyContactStepBuffer=new ae.UserOverridableBuffer,this.m_bodyContactCountBuffer=new ae.UserOverridableBuffer,this.m_consecutiveContactStepsBuffer=new ae.UserOverridableBuffer,this.m_stuckParticleBuffer=new di(function(){return 0}),this.m_proxyBuffer=new di(function(){return new ae.Proxy}),this.m_contactBuffer=new di(function(){return new Is}),this.m_bodyContactBuffer=new di(function(){return new Ps}),this.m_pairBuffer=new di(function(){return new Bs}),this.m_triadBuffer=new di(function(){return new Ls}),this.m_expirationTimeBuffer=new ae.UserOverridableBuffer,this.m_indexByExpirationTimeBuffer=new ae.UserOverridableBuffer,this.m_timeElapsed=0,this.m_expirationTimeBufferRequiresSorting=!1,this.m_groupCount=0,this.m_groupList=null,this.m_def=new Rs,this.m_prev=null,this.m_next=null,this.SetStrictContactCheck(J.strictContactCheck),this.SetDensity(J.density),this.SetGravityScale(J.gravityScale),this.SetRadius(J.radius),this.SetMaxParticleCount(J.maxCount),this.m_def=J.Clone(),this.m_world=q,this.SetDestructionByAge(this.m_def.destroyByAge)}return ae.computeTag=function(J,q){return(q+ae.yOffset>>>0<<ae.yShift)+(ae.xScale*J+ae.xOffset>>>0)>>>0},ae.computeRelativeTag=function(J,q,se){return J+(se<<ae.yShift)+(q<<ae.xShift)>>>0},ae.prototype.Drop=function(){for(;this.m_groupList;)this.DestroyParticleGroup(this.m_groupList);this.FreeUserOverridableBuffer(this.m_handleIndexBuffer),this.FreeUserOverridableBuffer(this.m_flagsBuffer),this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer),this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer),this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer),this.FreeUserOverridableBuffer(this.m_positionBuffer),this.FreeUserOverridableBuffer(this.m_velocityBuffer),this.FreeUserOverridableBuffer(this.m_colorBuffer),this.FreeUserOverridableBuffer(this.m_userDataBuffer),this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer),this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer),this.FreeBuffer(this.m_forceBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_weightBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_staticPressureBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulationBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulation2Buffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_depthBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_groupBuffer,this.m_internalAllocatedCapacity)},ae.prototype.CreateParticle=function(J){if(this.m_world.IsLocked())throw new Error;if(this.m_count>=this.m_internalAllocatedCapacity){var q=this.m_count?2*this.m_count:256;this.ReallocateInternalAllocatedBuffers(q)}if(this.m_count>=this.m_internalAllocatedCapacity){if(!this.m_def.destroyByAge)return k;this.DestroyOldestParticle(0,!1),this.SolveZombie()}var se=this.m_count++;if(!this.m_flagsBuffer.data)throw new Error;if(this.m_flagsBuffer.data[se]=0,this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[se]=0),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[se]=0),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[se]=0),!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;this.m_positionBuffer.data[se]=(this.m_positionBuffer.data[se]||new K).Copy(B(J.position,K.ZERO)),this.m_velocityBuffer.data[se]=(this.m_velocityBuffer.data[se]||new K).Copy(B(J.velocity,K.ZERO)),this.m_weightBuffer[se]=0,this.m_forceBuffer[se]=(this.m_forceBuffer[se]||new K).SetZero(),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[se]=0),this.m_depthBuffer&&(this.m_depthBuffer[se]=0);var ve=new ye().Copy(B(J.color,ye.ZERO));!this.m_colorBuffer.data&&ve.IsZero()||(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data[se]=(this.m_colorBuffer.data[se]||new ye).Copy(ve)),(this.m_userDataBuffer.data||J.userData)&&(this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data[se]=J.userData),this.m_handleIndexBuffer.data&&(this.m_handleIndexBuffer.data[se]=null);var xe=this.m_proxyBuffer.data[this.m_proxyBuffer.Append()],Ie=B(J.lifetime,0),Me=Ie>0;if(this.m_expirationTimeBuffer.data||Me){if(this.SetParticleLifetime(se,Me?Ie:this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())),!this.m_indexByExpirationTimeBuffer.data)throw new Error;this.m_indexByExpirationTimeBuffer.data[se]=se}xe.index=se;var Le=B(J.group,null);return this.m_groupBuffer[se]=Le,Le&&(Le.m_firstIndex<Le.m_lastIndex?(this.RotateBuffer(Le.m_firstIndex,Le.m_lastIndex,se),Le.m_lastIndex=se+1):(Le.m_firstIndex=se,Le.m_lastIndex=se+1)),this.SetParticleFlags(se,B(J.flags,0)),se},ae.prototype.GetParticleHandleFromIndex=function(J){this.m_handleIndexBuffer.data=this.RequestBuffer(this.m_handleIndexBuffer.data);var q=this.m_handleIndexBuffer.data[J];return q||((q=new Cs).SetIndex(J),this.m_handleIndexBuffer.data[J]=q,q)},ae.prototype.DestroyParticle=function(J,q){if(q===void 0&&(q=!1),!this.m_flagsBuffer.data)throw new Error;var se=w.b2ParticleFlag.b2_zombieParticle;q&&(se|=w.b2ParticleFlag.b2_destructionListenerParticle),this.SetParticleFlags(J,this.m_flagsBuffer.data[J]|se)},ae.prototype.DestroyOldestParticle=function(J,q){q===void 0&&(q=!1);var se=this.GetParticleCount();if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;if(!this.m_expirationTimeBuffer.data)throw new Error;var ve=this.m_indexByExpirationTimeBuffer.data[se-(J+1)],xe=this.m_indexByExpirationTimeBuffer.data[J];this.DestroyParticle(this.m_expirationTimeBuffer.data[ve]>0?ve:xe,q)},ae.prototype.DestroyParticlesInShape=function(J,q,se){se===void 0&&(se=!1);var ve=ae.DestroyParticlesInShape_s_aabb;if(this.m_world.IsLocked())throw new Error;var xe=new ae.DestroyParticlesInShapeCallback(this,J,q,se),Ie=ve;return J.ComputeAABB(Ie,q,0),this.m_world.QueryAABB(xe,Ie),xe.Destroyed()},ae.prototype.CreateParticleGroup=function(J){var q=ae.CreateParticleGroup_s_transform;if(this.m_world.IsLocked())throw new Error;var se=q;se.SetPositionAngle(B(J.position,K.ZERO),B(J.angle,0));var ve=this.m_count;if(J.shape&&this.CreateParticlesWithShapeForGroup(J.shape,J,se),J.shapes&&this.CreateParticlesWithShapesForGroup(J.shapes,B(J.shapeCount,J.shapes.length),J,se),J.positionData)for(var xe=B(J.particleCount,J.positionData.length),Ie=0;Ie<xe;Ie++){var Me=J.positionData[Ie];this.CreateParticleForGroup(J,se,Me)}var Le=this.m_count,Ge=new Ss(this);for(Ge.m_firstIndex=ve,Ge.m_lastIndex=Le,Ge.m_strength=B(J.strength,1),Ge.m_userData=J.userData,Ge.m_transform.Copy(se),Ge.m_prev=null,Ge.m_next=this.m_groupList,this.m_groupList&&(this.m_groupList.m_prev=Ge),this.m_groupList=Ge,++this.m_groupCount,Ie=ve;Ie<Le;Ie++)this.m_groupBuffer[Ie]=Ge;this.SetGroupFlags(Ge,B(J.groupFlags,0));var He=new ae.ConnectionFilter;return this.UpdateContacts(!0),this.UpdatePairsAndTriads(ve,Le,He),J.group&&(this.JoinParticleGroups(J.group,Ge),Ge=J.group),Ge},ae.prototype.JoinParticleGroups=function(J,q){if(this.m_world.IsLocked())throw new Error;this.RotateBuffer(q.m_firstIndex,q.m_lastIndex,this.m_count),this.RotateBuffer(J.m_firstIndex,J.m_lastIndex,q.m_firstIndex);var se=new ae.JoinParticleGroupsFilter(q.m_firstIndex);this.UpdateContacts(!0),this.UpdatePairsAndTriads(J.m_firstIndex,q.m_lastIndex,se);for(var ve=q.m_firstIndex;ve<q.m_lastIndex;ve++)this.m_groupBuffer[ve]=J;var xe=J.m_groupFlags|q.m_groupFlags;this.SetGroupFlags(J,xe),J.m_lastIndex=q.m_lastIndex,q.m_firstIndex=q.m_lastIndex,this.DestroyParticleGroup(q)},ae.prototype.SplitParticleGroup=function(J){this.UpdateContacts(!0);var q=V(J.GetParticleCount(),function(){return new ae.ParticleListNode});ae.InitializeParticleLists(J,q),this.MergeParticleListsInContact(J,q);var se=ae.FindLongestParticleList(J,q);this.MergeZombieParticleListNodes(J,q,se),this.CreateParticleGroupsFromParticleList(J,q,se),this.UpdatePairsAndTriadsWithParticleList(J,q)},ae.prototype.GetParticleGroupList=function(){return this.m_groupList},ae.prototype.GetParticleGroupCount=function(){return this.m_groupCount},ae.prototype.GetParticleCount=function(){return this.m_count},ae.prototype.GetMaxParticleCount=function(){return this.m_def.maxCount},ae.prototype.SetMaxParticleCount=function(J){this.m_def.maxCount=J},ae.prototype.GetAllParticleFlags=function(){return this.m_allParticleFlags},ae.prototype.GetAllGroupFlags=function(){return this.m_allGroupFlags},ae.prototype.SetPaused=function(J){this.m_paused=J},ae.prototype.GetPaused=function(){return this.m_paused},ae.prototype.SetDensity=function(J){this.m_def.density=J,this.m_inverseDensity=1/this.m_def.density},ae.prototype.GetDensity=function(){return this.m_def.density},ae.prototype.SetGravityScale=function(J){this.m_def.gravityScale=J},ae.prototype.GetGravityScale=function(){return this.m_def.gravityScale},ae.prototype.SetDamping=function(J){this.m_def.dampingStrength=J},ae.prototype.GetDamping=function(){return this.m_def.dampingStrength},ae.prototype.SetStaticPressureIterations=function(J){this.m_def.staticPressureIterations=J},ae.prototype.GetStaticPressureIterations=function(){return this.m_def.staticPressureIterations},ae.prototype.SetRadius=function(J){this.m_particleDiameter=2*J,this.m_squaredDiameter=this.m_particleDiameter*this.m_particleDiameter,this.m_inverseDiameter=1/this.m_particleDiameter},ae.prototype.GetRadius=function(){return this.m_particleDiameter/2},ae.prototype.GetPositionBuffer=function(){if(!this.m_positionBuffer.data)throw new Error;return this.m_positionBuffer.data},ae.prototype.GetVelocityBuffer=function(){if(!this.m_velocityBuffer.data)throw new Error;return this.m_velocityBuffer.data},ae.prototype.GetColorBuffer=function(){return this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data},ae.prototype.GetGroupBuffer=function(){return this.m_groupBuffer},ae.prototype.GetWeightBuffer=function(){return this.m_weightBuffer},ae.prototype.GetUserDataBuffer=function(){return this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data},ae.prototype.GetFlagsBuffer=function(){if(!this.m_flagsBuffer.data)throw new Error;return this.m_flagsBuffer.data},ae.prototype.SetParticleFlags=function(J,q){if(!this.m_flagsBuffer.data)throw new Error;this.m_flagsBuffer.data[J]&~q&&(this.m_needsUpdateAllParticleFlags=!0),~this.m_allParticleFlags&q&&(q&w.b2ParticleFlag.b2_tensileParticle&&(this.m_accumulation2Buffer=this.RequestBuffer(this.m_accumulation2Buffer)),q&w.b2ParticleFlag.b2_colorMixingParticle&&(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data)),this.m_allParticleFlags|=q),this.m_flagsBuffer.data[J]=q},ae.prototype.GetParticleFlags=function(J){if(!this.m_flagsBuffer.data)throw new Error;return this.m_flagsBuffer.data[J]},ae.prototype.SetFlagsBuffer=function(J,q){this.SetUserOverridableBuffer(this.m_flagsBuffer,J,q)},ae.prototype.SetPositionBuffer=function(J,q){this.SetUserOverridableBuffer(this.m_positionBuffer,J,q)},ae.prototype.SetVelocityBuffer=function(J,q){this.SetUserOverridableBuffer(this.m_velocityBuffer,J,q)},ae.prototype.SetColorBuffer=function(J,q){this.SetUserOverridableBuffer(this.m_colorBuffer,J,q)},ae.prototype.SetUserDataBuffer=function(J,q){this.SetUserOverridableBuffer(this.m_userDataBuffer,J,q)},ae.prototype.GetContacts=function(){return this.m_contactBuffer.data},ae.prototype.GetContactCount=function(){return this.m_contactBuffer.count},ae.prototype.GetBodyContacts=function(){return this.m_bodyContactBuffer.data},ae.prototype.GetBodyContactCount=function(){return this.m_bodyContactBuffer.count},ae.prototype.GetPairs=function(){return this.m_pairBuffer.data},ae.prototype.GetPairCount=function(){return this.m_pairBuffer.count},ae.prototype.GetTriads=function(){return this.m_triadBuffer.data},ae.prototype.GetTriadCount=function(){return this.m_triadBuffer.count},ae.prototype.SetStuckThreshold=function(J){this.m_stuckThreshold=J,J>0&&(this.m_lastBodyContactStepBuffer.data=this.RequestBuffer(this.m_lastBodyContactStepBuffer.data),this.m_bodyContactCountBuffer.data=this.RequestBuffer(this.m_bodyContactCountBuffer.data),this.m_consecutiveContactStepsBuffer.data=this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))},ae.prototype.GetStuckCandidates=function(){return this.m_stuckParticleBuffer.Data()},ae.prototype.GetStuckCandidateCount=function(){return this.m_stuckParticleBuffer.GetCount()},ae.prototype.ComputeCollisionEnergy=function(){if(!this.m_velocityBuffer.data)throw new Error;for(var J=ae.ComputeCollisionEnergy_s_v,q=this.m_velocityBuffer.data,se=0,ve=0;ve<this.m_contactBuffer.count;ve++){var xe=this.m_contactBuffer.data[ve],Ie=xe.indexA,Me=xe.indexB,Le=xe.normal,Ge=K.SubVV(q[Me],q[Ie],J),He=K.DotVV(Ge,Le);He<0&&(se+=He*He)}return .5*this.GetParticleMass()*se},ae.prototype.SetStrictContactCheck=function(J){this.m_def.strictContactCheck=J},ae.prototype.GetStrictContactCheck=function(){return this.m_def.strictContactCheck},ae.prototype.SetParticleLifetime=function(J,q){var se=this.m_indexByExpirationTimeBuffer.data===null;if(this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),se)for(var ve=this.GetParticleCount(),xe=0;xe<ve;++xe)this.m_indexByExpirationTimeBuffer.data[xe]=xe;var Ie=q/this.m_def.lifetimeGranularity,Me=Ie>0?this.GetQuantizedTimeElapsed()+Ie:Ie;Me!==this.m_expirationTimeBuffer.data[J]&&(this.m_expirationTimeBuffer.data[J]=Me,this.m_expirationTimeBufferRequiresSorting=!0)},ae.prototype.GetParticleLifetime=function(J){return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[J])},ae.prototype.SetDestructionByAge=function(J){J&&this.GetExpirationTimeBuffer(),this.m_def.destroyByAge=J},ae.prototype.GetDestructionByAge=function(){return this.m_def.destroyByAge},ae.prototype.GetExpirationTimeBuffer=function(){return this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_expirationTimeBuffer.data},ae.prototype.ExpirationTimeToLifetime=function(J){return(J>0?J-this.GetQuantizedTimeElapsed():J)*this.m_def.lifetimeGranularity},ae.prototype.GetIndexByExpirationTimeBuffer=function(){if(this.GetParticleCount()?this.SetParticleLifetime(0,this.GetParticleLifetime(0)):this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),!this.m_indexByExpirationTimeBuffer.data)throw new Error;return this.m_indexByExpirationTimeBuffer.data},ae.prototype.ParticleApplyLinearImpulse=function(J,q){this.ApplyLinearImpulse(J,J+1,q)},ae.prototype.ApplyLinearImpulse=function(J,q,se){if(!this.m_velocityBuffer.data)throw new Error;for(var ve=this.m_velocityBuffer.data,xe=(q-J)*this.GetParticleMass(),Ie=new K().Copy(se).SelfMul(1/xe),Me=J;Me<q;Me++)ve[Me].SelfAdd(Ie)},ae.IsSignificantForce=function(J){return J.x!==0||J.y!==0},ae.prototype.ParticleApplyForce=function(J,q){if(!this.m_flagsBuffer.data)throw new Error;ae.IsSignificantForce(q)&&this.ForceCanBeApplied(this.m_flagsBuffer.data[J])&&(this.PrepareForceBuffer(),this.m_forceBuffer[J].SelfAdd(q))},ae.prototype.ApplyForce=function(J,q,se){var ve=new K().Copy(se).SelfMul(1/(q-J));if(ae.IsSignificantForce(ve)){this.PrepareForceBuffer();for(var xe=J;xe<q;xe++)this.m_forceBuffer[xe].SelfAdd(ve)}},ae.prototype.GetNext=function(){return this.m_next},ae.prototype.QueryAABB=function(J,q){if(this.m_proxyBuffer.count!==0){var se=this.m_proxyBuffer.count,ve=Es(this.m_proxyBuffer.data,0,se,ae.computeTag(this.m_inverseDiameter*q.lowerBound.x,this.m_inverseDiameter*q.lowerBound.y),ae.Proxy.CompareProxyTag),xe=Ds(this.m_proxyBuffer.data,ve,se,ae.computeTag(this.m_inverseDiameter*q.upperBound.x,this.m_inverseDiameter*q.upperBound.y),ae.Proxy.CompareTagProxy);if(!this.m_positionBuffer.data)throw new Error;for(var Ie=this.m_positionBuffer.data,Me=ve;Me<xe;++Me){var Le=this.m_proxyBuffer.data[Me].index,Ge=Ie[Le];if(q.lowerBound.x<Ge.x&&Ge.x<q.upperBound.x&&q.lowerBound.y<Ge.y&&Ge.y<q.upperBound.y&&!J.ReportParticle(this,Le))break}}},ae.prototype.QueryShapeAABB=function(J,q,se,ve){ve===void 0&&(ve=0);var xe=ae.QueryShapeAABB_s_aabb;q.ComputeAABB(xe,se,ve),this.QueryAABB(J,xe)},ae.prototype.QueryPointAABB=function(J,q,se){se===void 0&&(se=I);var ve=ae.QueryPointAABB_s_aabb;ve.lowerBound.Set(q.x-se,q.y-se),ve.upperBound.Set(q.x+se,q.y+se),this.QueryAABB(J,ve)},ae.prototype.RayCast=function(J,q,se){var ve=ae.RayCast_s_aabb,xe=ae.RayCast_s_p,Ie=ae.RayCast_s_v,Me=ae.RayCast_s_n,Le=ae.RayCast_s_point;if(this.m_proxyBuffer.count!==0){if(!this.m_positionBuffer.data)throw new Error;var Ge=this.m_positionBuffer.data,He=ve;K.MinV(q,se,He.lowerBound),K.MaxV(q,se,He.upperBound);for(var Ye,Je=1,ze=K.SubVV(se,q,Ie),Ke=K.DotVV(ze,ze),et=this.GetInsideBoundsEnumerator(He);(Ye=et.GetNext())>=0;){var it=K.SubVV(q,Ge[Ye],xe),ct=K.DotVV(it,ze),mt=ct*ct-Ke*(K.DotVV(it,it)-this.m_squaredDiameter);if(mt>=0){var vt=ee(mt),Tt=(-ct-vt)/Ke;if(Tt>Je||Tt<0&&((Tt=(-ct+vt)/Ke)<0||Tt>Je))continue;var wt=K.AddVMulSV(it,Tt,ze,Me);wt.Normalize();var Pt=J.ReportParticle(this,Ye,K.AddVMulSV(q,Tt,ze,Le),wt,Tt);if((Je=U(Je,Pt))<=0)break}}}},ae.prototype.ComputeAABB=function(J){var q=this.GetParticleCount();if(J.lowerBound.x=+A,J.lowerBound.y=+A,J.upperBound.x=-A,J.upperBound.y=-A,!this.m_positionBuffer.data)throw new Error;for(var se=this.m_positionBuffer.data,ve=0;ve<q;ve++){var xe=se[ve];K.MinV(J.lowerBound,xe,J.lowerBound),K.MaxV(J.upperBound,xe,J.upperBound)}J.lowerBound.x-=this.m_particleDiameter,J.lowerBound.y-=this.m_particleDiameter,J.upperBound.x+=this.m_particleDiameter,J.upperBound.y+=this.m_particleDiameter},ae.prototype.FreeBuffer=function(J){J!==null&&(J.length=0)},ae.prototype.FreeUserOverridableBuffer=function(J){J.userSuppliedCapacity===0&&this.FreeBuffer(J.data,this.m_internalAllocatedCapacity)},ae.prototype.ReallocateBuffer3=function(J,q,se){if(se<=q)throw new Error;var ve=J?J.slice():[];return ve.length=se,ve},ae.prototype.ReallocateBuffer5=function(J,q,se,ve,xe){if(ve<=se)throw new Error;if(q&&!(ve<=q))throw new Error;return xe&&!J||q||(J=this.ReallocateBuffer3(J,se,ve)),J},ae.prototype.ReallocateBuffer4=function(J,q,se,ve){return this.ReallocateBuffer5(J.data,J.userSuppliedCapacity,q,se,ve)},ae.prototype.RequestBuffer=function(J){return J||(this.m_internalAllocatedCapacity===0&&this.ReallocateInternalAllocatedBuffers(256),(J=[]).length=this.m_internalAllocatedCapacity),J},ae.prototype.ReallocateHandleBuffers=function(J){this.m_handleIndexBuffer.data=this.ReallocateBuffer4(this.m_handleIndexBuffer,this.m_internalAllocatedCapacity,J,!0)},ae.prototype.ReallocateInternalAllocatedBuffers=function(J){function q(ve,xe){return xe&&ve>xe?xe:ve}if(J=q(J,this.m_def.maxCount),J=q(J,this.m_flagsBuffer.userSuppliedCapacity),J=q(J,this.m_positionBuffer.userSuppliedCapacity),J=q(J,this.m_velocityBuffer.userSuppliedCapacity),J=q(J,this.m_colorBuffer.userSuppliedCapacity),J=q(J,this.m_userDataBuffer.userSuppliedCapacity),this.m_internalAllocatedCapacity<J){this.ReallocateHandleBuffers(J),this.m_flagsBuffer.data=this.ReallocateBuffer4(this.m_flagsBuffer,this.m_internalAllocatedCapacity,J,!1);var se=this.m_stuckThreshold>0;this.m_lastBodyContactStepBuffer.data=this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer,this.m_internalAllocatedCapacity,J,se),this.m_bodyContactCountBuffer.data=this.ReallocateBuffer4(this.m_bodyContactCountBuffer,this.m_internalAllocatedCapacity,J,se),this.m_consecutiveContactStepsBuffer.data=this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer,this.m_internalAllocatedCapacity,J,se),this.m_positionBuffer.data=this.ReallocateBuffer4(this.m_positionBuffer,this.m_internalAllocatedCapacity,J,!1),this.m_velocityBuffer.data=this.ReallocateBuffer4(this.m_velocityBuffer,this.m_internalAllocatedCapacity,J,!1),this.m_forceBuffer=this.ReallocateBuffer5(this.m_forceBuffer,0,this.m_internalAllocatedCapacity,J,!1),this.m_weightBuffer=this.ReallocateBuffer5(this.m_weightBuffer,0,this.m_internalAllocatedCapacity,J,!1),this.m_staticPressureBuffer=this.ReallocateBuffer5(this.m_staticPressureBuffer,0,this.m_internalAllocatedCapacity,J,!0),this.m_accumulationBuffer=this.ReallocateBuffer5(this.m_accumulationBuffer,0,this.m_internalAllocatedCapacity,J,!1),this.m_accumulation2Buffer=this.ReallocateBuffer5(this.m_accumulation2Buffer,0,this.m_internalAllocatedCapacity,J,!0),this.m_depthBuffer=this.ReallocateBuffer5(this.m_depthBuffer,0,this.m_internalAllocatedCapacity,J,!0),this.m_colorBuffer.data=this.ReallocateBuffer4(this.m_colorBuffer,this.m_internalAllocatedCapacity,J,!0),this.m_groupBuffer=this.ReallocateBuffer5(this.m_groupBuffer,0,this.m_internalAllocatedCapacity,J,!1),this.m_userDataBuffer.data=this.ReallocateBuffer4(this.m_userDataBuffer,this.m_internalAllocatedCapacity,J,!0),this.m_expirationTimeBuffer.data=this.ReallocateBuffer4(this.m_expirationTimeBuffer,this.m_internalAllocatedCapacity,J,!0),this.m_indexByExpirationTimeBuffer.data=this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer,this.m_internalAllocatedCapacity,J,!1),this.m_internalAllocatedCapacity=J}},ae.prototype.CreateParticleForGroup=function(J,q,se){var ve=new Ln;ve.flags=B(J.flags,0),de.MulXV(q,se,ve.position),K.AddVV(B(J.linearVelocity,K.ZERO),K.CrossSV(B(J.angularVelocity,0),K.SubVV(ve.position,B(J.position,K.ZERO),K.s_t0),K.s_t0),ve.velocity),ve.color.Copy(B(J.color,ye.ZERO)),ve.lifetime=B(J.lifetime,0),ve.userData=J.userData,this.CreateParticle(ve)},ae.prototype.CreateParticlesStrokeShapeForGroup=function(J,q,se){var ve=ae.CreateParticlesStrokeShapeForGroup_s_edge,xe=ae.CreateParticlesStrokeShapeForGroup_s_d,Ie=ae.CreateParticlesStrokeShapeForGroup_s_p,Me=B(q.stride,0);Me===0&&(Me=this.GetParticleStride());for(var Le=0,Ge=J.GetChildCount(),He=0;He<Ge;He++){var Ye=null;J.GetType()===w.b2ShapeType.e_edgeShape?Ye=J:(Ye=ve,J.GetChildEdge(Ye,He));for(var Je=K.SubVV(Ye.m_vertex2,Ye.m_vertex1,xe),ze=Je.Length();Le<ze;){var Ke=K.AddVMulSV(Ye.m_vertex1,Le/ze,Je,Ie);this.CreateParticleForGroup(q,se,Ke),Le+=Me}Le-=ze}},ae.prototype.CreateParticlesFillShapeForGroup=function(J,q,se){var ve=ae.CreateParticlesFillShapeForGroup_s_aabb,xe=ae.CreateParticlesFillShapeForGroup_s_p,Ie=B(q.stride,0);Ie===0&&(Ie=this.GetParticleStride());var Me=de.IDENTITY,Le=ve;J.ComputeAABB(Le,Me,0);for(var Ge=Math.floor(Le.lowerBound.y/Ie)*Ie;Ge<Le.upperBound.y;Ge+=Ie)for(var He=Math.floor(Le.lowerBound.x/Ie)*Ie;He<Le.upperBound.x;He+=Ie){var Ye=xe.Set(He,Ge);J.TestPoint(Me,Ye)&&this.CreateParticleForGroup(q,se,Ye)}},ae.prototype.CreateParticlesWithShapeForGroup=function(J,q,se){switch(J.GetType()){case w.b2ShapeType.e_edgeShape:case w.b2ShapeType.e_chainShape:this.CreateParticlesStrokeShapeForGroup(J,q,se);break;case w.b2ShapeType.e_polygonShape:case w.b2ShapeType.e_circleShape:this.CreateParticlesFillShapeForGroup(J,q,se)}},ae.prototype.CreateParticlesWithShapesForGroup=function(J,q,se,ve){var xe=new ae.CompositeShape(J,q);this.CreateParticlesFillShapeForGroup(xe,se,ve)},ae.prototype.CloneParticle=function(J,q){var se=new Ln;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;se.flags=this.m_flagsBuffer.data[J],se.position.Copy(this.m_positionBuffer.data[J]),se.velocity.Copy(this.m_velocityBuffer.data[J]),this.m_colorBuffer.data&&se.color.Copy(this.m_colorBuffer.data[J]),this.m_userDataBuffer.data&&(se.userData=this.m_userDataBuffer.data[J]),se.group=q;var ve=this.CreateParticle(se);if(this.m_handleIndexBuffer.data){var xe=this.m_handleIndexBuffer.data[J];xe&&xe.SetIndex(ve),this.m_handleIndexBuffer.data[ve]=xe,this.m_handleIndexBuffer.data[J]=null}return this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[ve]=this.m_lastBodyContactStepBuffer.data[J]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[ve]=this.m_bodyContactCountBuffer.data[J]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[ve]=this.m_consecutiveContactStepsBuffer.data[J]),this.m_hasForce&&this.m_forceBuffer[ve].Copy(this.m_forceBuffer[J]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[ve]=this.m_staticPressureBuffer[J]),this.m_depthBuffer&&(this.m_depthBuffer[ve]=this.m_depthBuffer[J]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[ve]=this.m_expirationTimeBuffer.data[J]),ve},ae.prototype.DestroyParticlesInGroup=function(J,q){q===void 0&&(q=!1);for(var se=J.m_firstIndex;se<J.m_lastIndex;se++)this.DestroyParticle(se,q)},ae.prototype.DestroyParticleGroup=function(J){this.m_world.m_destructionListener&&this.m_world.m_destructionListener.SayGoodbyeParticleGroup(J),this.SetGroupFlags(J,0);for(var q=J.m_firstIndex;q<J.m_lastIndex;q++)this.m_groupBuffer[q]=null;J.m_prev&&(J.m_prev.m_next=J.m_next),J.m_next&&(J.m_next.m_prev=J.m_prev),J===this.m_groupList&&(this.m_groupList=J.m_next),--this.m_groupCount},ae.ParticleCanBeConnected=function(J,q){return(J&(w.b2ParticleFlag.b2_wallParticle|w.b2ParticleFlag.b2_springParticle|w.b2ParticleFlag.b2_elasticParticle))!=0||q!==null&&(q.GetGroupFlags()&w.b2ParticleGroupFlag.b2_rigidParticleGroup)!=0},ae.prototype.UpdatePairsAndTriads=function(J,q,se){var ve=ae.UpdatePairsAndTriads_s_dab,xe=ae.UpdatePairsAndTriads_s_dbc,Ie=ae.UpdatePairsAndTriads_s_dca;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var Me=this.m_positionBuffer.data,Le=0,Ge=J;Ge<q;Ge++)Le|=this.m_flagsBuffer.data[Ge];if(Le&ae.k_pairFlags)for(var He=0;He<this.m_contactBuffer.count;He++){var Ye=this.m_contactBuffer.data[He],Je=Ye.indexA,ze=Ye.indexB,Ke=this.m_flagsBuffer.data[Je],et=this.m_flagsBuffer.data[ze],it=this.m_groupBuffer[Je],ct=this.m_groupBuffer[ze];if(Je>=J&&Je<q&&ze>=J&&ze<q&&!((Ke|et)&w.b2ParticleFlag.b2_zombieParticle)&&(Ke|et)&ae.k_pairFlags&&(se.IsNecessary(Je)||se.IsNecessary(ze))&&ae.ParticleCanBeConnected(Ke,it)&&ae.ParticleCanBeConnected(et,ct)&&se.ShouldCreatePair(Je,ze)){var mt=this.m_pairBuffer.data[this.m_pairBuffer.Append()];mt.indexA=Je,mt.indexB=ze,mt.flags=Ye.flags,mt.strength=U(it?it.m_strength:1,ct?ct.m_strength:1),mt.distance=K.DistanceVV(Me[Je],Me[ze])}ws(this.m_pairBuffer.data,0,this.m_pairBuffer.count,ae.ComparePairIndices),this.m_pairBuffer.Unique(ae.MatchPairIndices)}if(Le&ae.k_triadFlags){var vt=new Rn(q-J);for(Ge=J;Ge<q;Ge++){var Tt=this.m_flagsBuffer.data[Ge],wt=this.m_groupBuffer[Ge];Tt&w.b2ParticleFlag.b2_zombieParticle||!ae.ParticleCanBeConnected(Tt,wt)||vt.AddGenerator(Me[Ge],Ge,se.IsNecessary(Ge))}var Pt=this.GetParticleStride();vt.Generate(Pt/2,2*Pt);var Bt=this;vt.GetNodes(function(jt,Xt,Ht){if(!Bt.m_flagsBuffer.data)throw new Error;var $t=Bt.m_flagsBuffer.data[jt],Qt=Bt.m_flagsBuffer.data[Xt],ur=Bt.m_flagsBuffer.data[Ht];if(($t|Qt|ur)&ae.k_triadFlags&&se.ShouldCreateTriad(jt,Xt,Ht)){var tr=Me[jt],qt=Me[Xt],ar=Me[Ht],or=K.SubVV(tr,qt,ve),vr=K.SubVV(qt,ar,xe),mr=K.SubVV(ar,tr,Ie),wr=4*Bt.m_squaredDiameter;if(K.DotVV(or,or)>wr||K.DotVV(vr,vr)>wr||K.DotVV(mr,mr)>wr)return;var Tr=Bt.m_groupBuffer[jt],yr=Bt.m_groupBuffer[Xt],Rr=Bt.m_groupBuffer[Ht],Sr=Bt.m_triadBuffer.data[Bt.m_triadBuffer.Append()];Sr.indexA=jt,Sr.indexB=Xt,Sr.indexC=Ht,Sr.flags=$t|Qt|ur,Sr.strength=U(U(Tr?Tr.m_strength:1,yr?yr.m_strength:1),Rr?Rr.m_strength:1);var ni=(tr.x+qt.x+ar.x)/3,Gr=(tr.y+qt.y+ar.y)/3;Sr.pa.x=tr.x-ni,Sr.pa.y=tr.y-Gr,Sr.pb.x=qt.x-ni,Sr.pb.y=qt.y-Gr,Sr.pc.x=ar.x-ni,Sr.pc.y=ar.y-Gr,Sr.ka=-K.DotVV(mr,or),Sr.kb=-K.DotVV(or,vr),Sr.kc=-K.DotVV(vr,mr),Sr.s=K.CrossVV(tr,qt)+K.CrossVV(qt,ar)+K.CrossVV(ar,tr)}}),ws(this.m_triadBuffer.data,0,this.m_triadBuffer.count,ae.CompareTriadIndices),this.m_triadBuffer.Unique(ae.MatchTriadIndices)}},ae.prototype.UpdatePairsAndTriadsWithReactiveParticles=function(){var J=new ae.ReactiveFilter(this.m_flagsBuffer);if(this.UpdatePairsAndTriads(0,this.m_count,J),!this.m_flagsBuffer.data)throw new Error;for(var q=0;q<this.m_count;q++)this.m_flagsBuffer.data[q]&=~w.b2ParticleFlag.b2_reactiveParticle;this.m_allParticleFlags&=~w.b2ParticleFlag.b2_reactiveParticle},ae.ComparePairIndices=function(J,q){var se=J.indexA-q.indexA;return se!==0?se<0:J.indexB<q.indexB},ae.MatchPairIndices=function(J,q){return J.indexA===q.indexA&&J.indexB===q.indexB},ae.CompareTriadIndices=function(J,q){var se=J.indexA-q.indexA;if(se!==0)return se<0;var ve=J.indexB-q.indexB;return ve!==0?ve<0:J.indexC<q.indexC},ae.MatchTriadIndices=function(J,q){return J.indexA===q.indexA&&J.indexB===q.indexB&&J.indexC===q.indexC},ae.InitializeParticleLists=function(J,q){for(var se=J.GetBufferIndex(),ve=J.GetParticleCount(),xe=0;xe<ve;xe++){var Ie=q[xe];Ie.list=Ie,Ie.next=null,Ie.count=1,Ie.index=xe+se}},ae.prototype.MergeParticleListsInContact=function(J,q){for(var se=J.GetBufferIndex(),ve=0;ve<this.m_contactBuffer.count;ve++){var xe=this.m_contactBuffer.data[ve],Ie=xe.indexA,Me=xe.indexB;if(J.ContainsParticle(Ie)&&J.ContainsParticle(Me)){var Le=q[Ie-se].list,Ge=q[Me-se].list;if(Le!==Ge){if(Le.count<Ge.count){var He=Le;Le=Ge,Ge=He}ae.MergeParticleLists(Le,Ge)}}}},ae.MergeParticleLists=function(J,q){for(var se=q;;){se.list=J;var ve=se.next;if(!ve){se.next=J.next;break}se=ve}J.next=q,J.count+=q.count,q.count=0},ae.FindLongestParticleList=function(J,q){for(var se=J.GetParticleCount(),ve=q[0],xe=0;xe<se;xe++){var Ie=q[xe];ve.count<Ie.count&&(ve=Ie)}return ve},ae.prototype.MergeZombieParticleListNodes=function(J,q,se){if(!this.m_flagsBuffer.data)throw new Error;for(var ve=J.GetParticleCount(),xe=0;xe<ve;xe++){var Ie=q[xe];Ie!==se&&this.m_flagsBuffer.data[Ie.index]&w.b2ParticleFlag.b2_zombieParticle&&ae.MergeParticleListAndNode(se,Ie)}},ae.MergeParticleListAndNode=function(J,q){q.list=J,q.next=J.next,J.next=q,J.count++,q.count=0},ae.prototype.CreateParticleGroupsFromParticleList=function(J,q,se){if(!this.m_flagsBuffer.data)throw new Error;var ve=J.GetParticleCount(),xe=new Ts;xe.groupFlags=J.GetGroupFlags(),xe.userData=J.GetUserData();for(var Ie=0;Ie<ve;Ie++){var Me=q[Ie];if(Me.count&&Me!==se)for(var Le=this.CreateParticleGroup(xe),Ge=Me;Ge;Ge=Ge.next){var He=Ge.index,Ye=this.CloneParticle(He,Le);this.m_flagsBuffer.data[He]|=w.b2ParticleFlag.b2_zombieParticle,Ge.index=Ye}}},ae.prototype.UpdatePairsAndTriadsWithParticleList=function(J,q){for(var se=J.GetBufferIndex(),ve=0;ve<this.m_pairBuffer.count;ve++){var xe=this.m_pairBuffer.data[ve],Ie=xe.indexA,Me=xe.indexB;J.ContainsParticle(Ie)&&(xe.indexA=q[Ie-se].index),J.ContainsParticle(Me)&&(xe.indexB=q[Me-se].index)}for(ve=0;ve<this.m_triadBuffer.count;ve++){var Le=this.m_triadBuffer.data[ve],Ge=(Ie=Le.indexA,Me=Le.indexB,Le.indexC);J.ContainsParticle(Ie)&&(Le.indexA=q[Ie-se].index),J.ContainsParticle(Me)&&(Le.indexB=q[Me-se].index),J.ContainsParticle(Ge)&&(Le.indexC=q[Ge-se].index)}},ae.prototype.ComputeDepth=function(){for(var J=[],q=0,se=0;se<this.m_contactBuffer.count;se++){var ve=(ct=this.m_contactBuffer.data[se]).indexA,xe=ct.indexB,Ie=this.m_groupBuffer[ve],Me=this.m_groupBuffer[xe];Ie&&Ie===Me&&Ie.m_groupFlags&w.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&(J[q++]=ct)}for(var Le=[],Ge=0,He=this.m_groupList;He;He=He.GetNext())if(He.m_groupFlags&w.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth){Le[Ge++]=He,this.SetGroupFlags(He,He.m_groupFlags&~w.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);for(var Ye=He.m_firstIndex;Ye<He.m_lastIndex;Ye++)this.m_accumulationBuffer[Ye]=0}for(se=0;se<q;se++){ve=(ct=J[se]).indexA,xe=ct.indexB;var Je=ct.weight;this.m_accumulationBuffer[ve]+=Je,this.m_accumulationBuffer[xe]+=Je}for(Ye=0;Ye<Ge;Ye++)for(var ze=(He=Le[Ye]).m_firstIndex;ze<He.m_lastIndex;ze++)Je=this.m_accumulationBuffer[ze],this.m_depthBuffer[ze]=Je<.8?0:A;for(var Ke=ee(this.m_count)>>0,et=0;et<Ke;et++){var it=!1;for(se=0;se<q;se++){ve=(ct=J[se]).indexA,xe=ct.indexB;var ct,mt=1-ct.weight,vt=this.m_depthBuffer[ve],Tt=this.m_depthBuffer[xe],wt=Tt+mt,Pt=vt+mt;vt>wt&&(this.m_depthBuffer[ve]=wt,it=!0),Tt>Pt&&(this.m_depthBuffer[xe]=Pt,it=!0)}if(!it)break}for(Ye=0;Ye<Ge;Ye++)for(var Bt=(He=Le[Ye]).m_firstIndex;Bt<He.m_lastIndex;Bt++)this.m_depthBuffer[Bt]<A?this.m_depthBuffer[Bt]*=this.m_particleDiameter:this.m_depthBuffer[Bt]=0},ae.prototype.GetInsideBoundsEnumerator=function(J){var q=ae.computeTag(this.m_inverseDiameter*J.lowerBound.x-1,this.m_inverseDiameter*J.lowerBound.y-1),se=ae.computeTag(this.m_inverseDiameter*J.upperBound.x+1,this.m_inverseDiameter*J.upperBound.y+1),ve=this.m_proxyBuffer.count,xe=Es(this.m_proxyBuffer.data,0,ve,q,ae.Proxy.CompareProxyTag),Ie=Ds(this.m_proxyBuffer.data,0,ve,se,ae.Proxy.CompareTagProxy);return new ae.InsideBoundsEnumerator(this,q,se,xe,Ie)},ae.prototype.UpdateAllParticleFlags=function(){if(!this.m_flagsBuffer.data)throw new Error;this.m_allParticleFlags=0;for(var J=0;J<this.m_count;J++)this.m_allParticleFlags|=this.m_flagsBuffer.data[J];this.m_needsUpdateAllParticleFlags=!1},ae.prototype.UpdateAllGroupFlags=function(){this.m_allGroupFlags=0;for(var J=this.m_groupList;J;J=J.GetNext())this.m_allGroupFlags|=J.m_groupFlags;this.m_needsUpdateAllGroupFlags=!1},ae.prototype.AddContact=function(J,q){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;var se=ae.AddContact_s_d,ve=this.m_positionBuffer.data,xe=K.SubVV(ve[q],ve[J],se),Ie=K.DotVV(xe,xe);if(Ie<this.m_squaredDiameter){var Me=Z(Ie);isFinite(Me)||(Me=198177537e11);var Le=this.m_contactBuffer.data[this.m_contactBuffer.Append()];Le.indexA=J,Le.indexB=q,Le.flags=this.m_flagsBuffer.data[J]|this.m_flagsBuffer.data[q],Le.weight=1-Ie*Me*this.m_inverseDiameter,K.MulSV(Me,xe,Le.normal)}},ae.prototype.FindContacts_Reference=function(){var J=this.m_proxyBuffer.count;this.m_contactBuffer.count=0;for(var q=0,se=0;q<J;q++){for(var ve=ae.computeRelativeTag(this.m_proxyBuffer.data[q].tag,1,0),xe=q+1;xe<J&&!(ve<this.m_proxyBuffer.data[xe].tag);xe++)this.AddContact(this.m_proxyBuffer.data[q].index,this.m_proxyBuffer.data[xe].index,this.m_contactBuffer);for(var Ie=ae.computeRelativeTag(this.m_proxyBuffer.data[q].tag,-1,1);se<J&&!(Ie<=this.m_proxyBuffer.data[se].tag);se++);var Me=ae.computeRelativeTag(this.m_proxyBuffer.data[q].tag,1,1);for(xe=se;xe<J&&!(Me<this.m_proxyBuffer.data[xe].tag);xe++)this.AddContact(this.m_proxyBuffer.data[q].index,this.m_proxyBuffer.data[xe].index,this.m_contactBuffer)}},ae.prototype.FindContacts=function(J){this.FindContacts_Reference(J)},ae.prototype.UpdateProxies_Reference=function(){if(!this.m_positionBuffer.data)throw new Error;for(var J=this.m_positionBuffer.data,q=this.m_inverseDiameter,se=0;se<this.m_proxyBuffer.count;++se){var ve=this.m_proxyBuffer.data[se],xe=J[ve.index];ve.tag=ae.computeTag(q*xe.x,q*xe.y)}},ae.prototype.UpdateProxies=function(J){this.UpdateProxies_Reference(J)},ae.prototype.SortProxies=function(){Ki(this.m_proxyBuffer.data,0,this.m_proxyBuffer.count,ae.Proxy.CompareProxyProxy)},ae.prototype.FilterContacts=function(){var J=this.GetParticleContactFilter();if(J!==null){var q=this;this.m_contactBuffer.RemoveIf(function(se){return(se.flags&w.b2ParticleFlag.b2_particleContactFilterParticle)!=0&&!J.ShouldCollideParticleParticle(q,se.indexA,se.indexB)})}},ae.prototype.NotifyContactListenerPreContact=function(J){if(this.GetParticleContactListener()!==null)throw J.Initialize(this.m_contactBuffer,this.m_flagsBuffer),new Error},ae.prototype.NotifyContactListenerPostContact=function(){var J=this.GetParticleContactListener();if(J!==null){for(var q=0;q<this.m_contactBuffer.count;++q){var se=this.m_contactBuffer.data[q];J.BeginContactParticleParticle(this,se)}throw new Error}},ae.b2ParticleContactIsZombie=function(J){return(J.flags&w.b2ParticleFlag.b2_zombieParticle)===w.b2ParticleFlag.b2_zombieParticle},ae.prototype.UpdateContacts=function(J){this.UpdateProxies(this.m_proxyBuffer),this.SortProxies(this.m_proxyBuffer);var q=new ae.b2ParticlePairSet;this.NotifyContactListenerPreContact(q),this.FindContacts(this.m_contactBuffer),this.FilterContacts(this.m_contactBuffer),this.NotifyContactListenerPostContact(q),J&&this.m_contactBuffer.RemoveIf(ae.b2ParticleContactIsZombie)},ae.prototype.NotifyBodyContactListenerPreContact=function(J){if(this.GetFixtureContactListener()!==null)throw J.Initialize(this.m_bodyContactBuffer,this.m_flagsBuffer),new Error},ae.prototype.NotifyBodyContactListenerPostContact=function(){var J=this.GetFixtureContactListener();if(J!==null){for(var q=0;q<this.m_bodyContactBuffer.count;q++){var se=this.m_bodyContactBuffer.data[q];J.BeginContactFixtureParticle(this,se)}throw new Error}},ae.prototype.UpdateBodyContacts=function(){var J=ae.UpdateBodyContacts_s_aabb,q=new ae.FixtureParticleSet;if(this.NotifyBodyContactListenerPreContact(q),this.m_stuckThreshold>0){if(!this.m_bodyContactCountBuffer.data)throw new Error;if(!this.m_lastBodyContactStepBuffer.data)throw new Error;if(!this.m_consecutiveContactStepsBuffer.data)throw new Error;for(var se=this.GetParticleCount(),ve=0;ve<se;ve++)this.m_bodyContactCountBuffer.data[ve]=0,this.m_timestamp>this.m_lastBodyContactStepBuffer.data[ve]+1&&(this.m_consecutiveContactStepsBuffer.data[ve]=0)}this.m_bodyContactBuffer.SetCount(0),this.m_stuckParticleBuffer.SetCount(0);var xe=J;this.ComputeAABB(xe);var Ie=new ae.UpdateBodyContactsCallback(this,this.GetFixtureContactFilter());this.m_world.QueryAABB(Ie,xe),this.m_def.strictContactCheck&&this.RemoveSpuriousBodyContacts(),this.NotifyBodyContactListenerPostContact(q)},ae.prototype.Solve=function(J){var q=ae.Solve_s_subStep;if(this.m_count!==0&&(this.m_expirationTimeBuffer.data&&this.SolveLifetimes(J),this.m_allParticleFlags&w.b2ParticleFlag.b2_zombieParticle&&this.SolveZombie(),this.m_needsUpdateAllParticleFlags&&this.UpdateAllParticleFlags(),this.m_needsUpdateAllGroupFlags&&this.UpdateAllGroupFlags(),!this.m_paused))for(this.m_iterationIndex=0;this.m_iterationIndex<J.particleIterations;this.m_iterationIndex++){++this.m_timestamp;var se=q.Copy(J);if(se.dt/=J.particleIterations,se.inv_dt*=J.particleIterations,this.UpdateContacts(!1),this.UpdateBodyContacts(),this.ComputeWeight(),this.m_allGroupFlags&w.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&this.ComputeDepth(),this.m_allParticleFlags&w.b2ParticleFlag.b2_reactiveParticle&&this.UpdatePairsAndTriadsWithReactiveParticles(),this.m_hasForce&&this.SolveForce(se),this.m_allParticleFlags&w.b2ParticleFlag.b2_viscousParticle&&this.SolveViscous(),this.m_allParticleFlags&w.b2ParticleFlag.b2_repulsiveParticle&&this.SolveRepulsive(se),this.m_allParticleFlags&w.b2ParticleFlag.b2_powderParticle&&this.SolvePowder(se),this.m_allParticleFlags&w.b2ParticleFlag.b2_tensileParticle&&this.SolveTensile(se),this.m_allGroupFlags&w.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SolveSolid(se),this.m_allParticleFlags&w.b2ParticleFlag.b2_colorMixingParticle&&this.SolveColorMixing(),this.SolveGravity(se),this.m_allParticleFlags&w.b2ParticleFlag.b2_staticPressureParticle&&this.SolveStaticPressure(se),this.SolvePressure(se),this.SolveDamping(se),this.m_allParticleFlags&ae.k_extraDampingFlags&&this.SolveExtraDamping(),this.m_allParticleFlags&w.b2ParticleFlag.b2_elasticParticle&&this.SolveElastic(se),this.m_allParticleFlags&w.b2ParticleFlag.b2_springParticle&&this.SolveSpring(se),this.LimitVelocity(se),this.m_allGroupFlags&w.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigidDamping(),this.m_allParticleFlags&w.b2ParticleFlag.b2_barrierParticle&&this.SolveBarrier(se),this.SolveCollision(se),this.m_allGroupFlags&w.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigid(se),this.m_allParticleFlags&w.b2ParticleFlag.b2_wallParticle&&this.SolveWall(),!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var ve=0;ve<this.m_count;ve++)this.m_positionBuffer.data[ve].SelfMulAdd(se.dt,this.m_velocityBuffer.data[ve])}},ae.prototype.SolveCollision=function(J){var q=ae.SolveCollision_s_aabb;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;var se=this.m_positionBuffer.data,ve=this.m_velocityBuffer.data,xe=q;xe.lowerBound.x=+A,xe.lowerBound.y=+A,xe.upperBound.x=-A,xe.upperBound.y=-A;for(var Ie=0;Ie<this.m_count;Ie++){var Me=ve[Ie],Le=se[Ie],Ge=Le.x+J.dt*Me.x,He=Le.y+J.dt*Me.y;xe.lowerBound.x=U(xe.lowerBound.x,U(Le.x,Ge)),xe.lowerBound.y=U(xe.lowerBound.y,U(Le.y,He)),xe.upperBound.x=X(xe.upperBound.x,X(Le.x,Ge)),xe.upperBound.y=X(xe.upperBound.y,X(Le.y,He))}var Ye=new ae.SolveCollisionCallback(this,J);this.m_world.QueryAABB(Ye,xe)},ae.prototype.LimitVelocity=function(J){if(!this.m_velocityBuffer.data)throw new Error;for(var q=this.m_velocityBuffer.data,se=this.GetCriticalVelocitySquared(J),ve=0;ve<this.m_count;ve++){var xe=q[ve],Ie=K.DotVV(xe,xe);Ie>se&&xe.SelfMul(ee(se/Ie))}},ae.prototype.SolveGravity=function(J){if(!this.m_velocityBuffer.data)throw new Error;for(var q=ae.SolveGravity_s_gravity,se=this.m_velocityBuffer.data,ve=K.MulSV(J.dt*this.m_def.gravityScale,this.m_world.GetGravity(),q),xe=0;xe<this.m_count;xe++)se[xe].SelfAdd(ve)},ae.prototype.SolveBarrier=function(J){var q=ae.SolveBarrier_s_aabb,se=ae.SolveBarrier_s_va,ve=ae.SolveBarrier_s_vb,xe=ae.SolveBarrier_s_pba,Ie=ae.SolveBarrier_s_vba,Me=ae.SolveBarrier_s_vc,Le=ae.SolveBarrier_s_pca,Ge=ae.SolveBarrier_s_vca,He=ae.SolveBarrier_s_qba,Ye=ae.SolveBarrier_s_qca,Je=ae.SolveBarrier_s_dv,ze=ae.SolveBarrier_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var Ke=this.m_positionBuffer.data,et=this.m_velocityBuffer.data,it=0;it<this.m_count;it++)(this.m_flagsBuffer.data[it]&ae.k_barrierWallFlags)!=0&&et[it].SetZero();for(var ct=2.5*J.dt,mt=this.GetParticleMass(),vt=0;vt<this.m_pairBuffer.count;vt++){var Tt=this.m_pairBuffer.data[vt];if(Tt.flags&w.b2ParticleFlag.b2_barrierParticle){var wt=Tt.indexA,Pt=Tt.indexB,Bt=Ke[wt],jt=Ke[Pt],Xt=q;K.MinV(Bt,jt,Xt.lowerBound),K.MaxV(Bt,jt,Xt.upperBound);for(var Ht=this.m_groupBuffer[wt],$t=this.m_groupBuffer[Pt],Qt=this.GetLinearVelocity(Ht,wt,Bt,se),ur=this.GetLinearVelocity($t,Pt,jt,ve),tr=K.SubVV(jt,Bt,xe),qt=K.SubVV(ur,Qt,Ie),ar=this.GetInsideBoundsEnumerator(Xt),or=void 0;(or=ar.GetNext())>=0;){var vr=Ke[or],mr=this.m_groupBuffer[or];if(Ht!==mr&&$t!==mr){var wr=this.GetLinearVelocity(mr,or,vr,Me),Tr=K.SubVV(vr,Bt,Le),yr=K.SubVV(wr,Qt,Ge),Rr=K.CrossVV(qt,yr),Sr=K.CrossVV(tr,yr)-K.CrossVV(Tr,qt),ni=K.CrossVV(tr,Tr),Gr=void 0,jr=void 0,Wr=He,Si=Ye;if(Rr===0){if(Sr===0||!((jr=-ni/Sr)>=0&&jr<ct)||(K.AddVMulSV(tr,jr,qt,Wr),K.AddVMulSV(Tr,jr,yr,Si),!((Gr=K.DotVV(Wr,Si)/K.DotVV(Wr,Wr))>=0&&Gr<=1)))continue}else{var Ms=Sr*Sr-4*ni*Rr;if(Ms<0)continue;var Ns=ee(Ms),$i=(-Sr-Ns)/(2*Rr),Qi=(-Sr+Ns)/(2*Rr);if($i>Qi){var po=$i;$i=Qi,Qi=po}if(jr=$i,K.AddVMulSV(tr,jr,qt,Wr),K.AddVMulSV(Tr,jr,yr,Si),Gr=K.DotVV(Wr,Si)/K.DotVV(Wr,Wr),!(jr>=0&&jr<ct&&Gr>=0&&Gr<=1)&&(!((jr=Qi)>=0&&jr<ct)||(K.AddVMulSV(tr,jr,qt,Wr),K.AddVMulSV(Tr,jr,yr,Si),!((Gr=K.DotVV(Wr,Si)/K.DotVV(Wr,Wr))>=0&&Gr<=1))))continue}var qi=Je;qi.x=Qt.x+Gr*qt.x-wr.x,qi.y=Qt.y+Gr*qt.y-wr.y;var Mn=K.MulSV(mt,qi,ze);if(mr&&this.IsRigidGroup(mr)){var ks=mr.GetMass(),Fs=mr.GetInertia();ks>0&&mr.m_linearVelocity.SelfMulAdd(1/ks,Mn),Fs>0&&(mr.m_angularVelocity+=K.CrossVV(K.SubVV(vr,mr.GetCenter(),K.s_t0),Mn)/Fs)}else et[or].SelfAdd(qi);this.ParticleApplyForce(or,Mn.SelfMul(-J.inv_dt))}}}}},ae.prototype.SolveStaticPressure=function(J){if(!this.m_flagsBuffer.data)throw new Error;this.m_staticPressureBuffer=this.RequestBuffer(this.m_staticPressureBuffer);for(var q=this.GetCriticalPressure(J),se=this.m_def.staticPressureStrength*q,ve=.25*q,xe=this.m_def.staticPressureRelaxation,Ie=0;Ie<this.m_def.staticPressureIterations;Ie++){for(var Me=0;Me<this.m_count;Me++)this.m_accumulationBuffer[Me]=0;for(var Le=0;Le<this.m_contactBuffer.count;Le++){var Ge=this.m_contactBuffer.data[Le];if(Ge.flags&w.b2ParticleFlag.b2_staticPressureParticle){var He=Ge.indexA,Ye=Ge.indexB,Je=Ge.weight;this.m_accumulationBuffer[He]+=Je*this.m_staticPressureBuffer[Ye],this.m_accumulationBuffer[Ye]+=Je*this.m_staticPressureBuffer[He]}}for(Me=0;Me<this.m_count;Me++)if(Je=this.m_weightBuffer[Me],this.m_flagsBuffer.data[Me]&w.b2ParticleFlag.b2_staticPressureParticle){var ze=(this.m_accumulationBuffer[Me]+se*(Je-1))/(Je+xe);this.m_staticPressureBuffer[Me]=Y(ze,0,ve)}else this.m_staticPressureBuffer[Me]=0}},ae.prototype.ComputeWeight=function(){for(var J=0;J<this.m_count;J++)this.m_weightBuffer[J]=0;for(J=0;J<this.m_bodyContactBuffer.count;J++){var q=(ve=this.m_bodyContactBuffer.data[J]).index,se=ve.weight;this.m_weightBuffer[q]+=se}for(J=0;J<this.m_contactBuffer.count;J++){q=(ve=this.m_contactBuffer.data[J]).indexA;var ve,xe=ve.indexB;se=ve.weight,this.m_weightBuffer[q]+=se,this.m_weightBuffer[xe]+=se}},ae.prototype.SolvePressure=function(J){var q=ae.SolvePressure_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var se=this.m_positionBuffer.data,ve=this.m_velocityBuffer.data,xe=this.GetCriticalPressure(J),Ie=this.m_def.pressureStrength*xe,Me=.25*xe,Le=0;Le<this.m_count;Le++){var Ge=this.m_weightBuffer[Le],He=Ie*X(0,Ge-1);this.m_accumulationBuffer[Le]=U(He,Me)}if(this.m_allParticleFlags&ae.k_noPressureFlags)for(Le=0;Le<this.m_count;Le++)this.m_flagsBuffer.data[Le]&ae.k_noPressureFlags&&(this.m_accumulationBuffer[Le]=0);if(this.m_allParticleFlags&w.b2ParticleFlag.b2_staticPressureParticle)for(Le=0;Le<this.m_count;Le++)this.m_flagsBuffer.data[Le]&w.b2ParticleFlag.b2_staticPressureParticle&&(this.m_accumulationBuffer[Le]+=this.m_staticPressureBuffer[Le]);for(var Ye=J.dt/(this.m_def.density*this.m_particleDiameter),Je=this.GetParticleInvMass(),ze=0;ze<this.m_bodyContactBuffer.count;ze++){var Ke=(Tt=this.m_bodyContactBuffer.data[ze]).index,et=Tt.body,it=(Ge=Tt.weight,Tt.mass),ct=Tt.normal,mt=se[Ke],vt=(He=this.m_accumulationBuffer[Ke]+Ie*Ge,K.MulSV(Ye*Ge*it*He,ct,q));ve[Ke].SelfMulSub(Je,vt),et.ApplyLinearImpulse(vt,mt,!0)}for(ze=0;ze<this.m_contactBuffer.count;ze++){var Tt;Ke=(Tt=this.m_contactBuffer.data[ze]).indexA,et=Tt.indexB,Ge=Tt.weight,ct=Tt.normal,He=this.m_accumulationBuffer[Ke]+this.m_accumulationBuffer[et],vt=K.MulSV(Ye*Ge*He,ct,q),ve[Ke].SelfSub(vt),ve[et].SelfAdd(vt)}},ae.prototype.SolveDamping=function(J){var q=ae.SolveDamping_s_v,se=ae.SolveDamping_s_f;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var ve=this.m_positionBuffer.data,xe=this.m_velocityBuffer.data,Ie=this.m_def.dampingStrength,Me=1/this.GetCriticalVelocity(J),Le=this.GetParticleInvMass(),Ge=0;Ge<this.m_bodyContactBuffer.count;Ge++){var He=(vt=this.m_bodyContactBuffer.data[Ge]).index,Ye=vt.body,Je=vt.weight,ze=vt.mass,Ke=vt.normal,et=ve[He],it=K.SubVV(Ye.GetLinearVelocityFromWorldPoint(et,K.s_t0),xe[He],q);if((Tt=K.DotVV(it,Ke))<0){var ct=X(Ie*Je,U(-Me*Tt,.5)),mt=K.MulSV(ct*ze*Tt,Ke,se);xe[He].SelfMulAdd(Le,mt),Ye.ApplyLinearImpulse(mt.SelfNeg(),et,!0)}}for(Ge=0;Ge<this.m_contactBuffer.count;Ge++){var vt,Tt;He=(vt=this.m_contactBuffer.data[Ge]).indexA,Ye=vt.indexB,Je=vt.weight,Ke=vt.normal,it=K.SubVV(xe[Ye],xe[He],q),(Tt=K.DotVV(it,Ke))<0&&(ct=X(Ie*Je,U(-Me*Tt,.5)),mt=K.MulSV(ct*Tt,Ke,se),xe[He].SelfAdd(mt),xe[Ye].SelfSub(mt))}},ae.prototype.SolveRigidDamping=function(){var J=ae.SolveRigidDamping_s_t0,q=ae.SolveRigidDamping_s_t1,se=ae.SolveRigidDamping_s_p,ve=ae.SolveRigidDamping_s_v,xe=[0],Ie=[0],Me=[0],Le=[0],Ge=[0],He=[0];if(!this.m_positionBuffer.data)throw new Error;for(var Ye=this.m_positionBuffer.data,Je=this.m_def.dampingStrength,ze=0;ze<this.m_bodyContactBuffer.count;ze++){var Ke=(wt=this.m_bodyContactBuffer.data[ze]).index;if((Bt=this.m_groupBuffer[Ke])&&this.IsRigidGroup(Bt)){var et=wt.body,it=wt.normal,ct=wt.weight,mt=Ye[Ke],vt=K.SubVV(et.GetLinearVelocityFromWorldPoint(mt,J),Bt.GetLinearVelocityFromWorldPoint(mt,q),ve);if((Pt=K.DotVV(vt,it))<0){this.InitDampingParameterWithRigidGroupOrParticle(xe,Ie,Me,!0,Bt,Ke,mt,it),this.InitDampingParameter(Le,Ge,He,et.GetMass(),et.GetInertia()-et.GetMass()*et.GetLocalCenter().LengthSquared(),et.GetWorldCenter(),mt,it);var Tt=Je*U(ct,1)*this.ComputeDampingImpulse(xe[0],Ie[0],Me[0],Le[0],Ge[0],He[0],Pt);this.ApplyDamping(xe[0],Ie[0],Me[0],!0,Bt,Ke,Tt,it),et.ApplyLinearImpulse(K.MulSV(-Tt,it,K.s_t0),mt,!0)}}}for(ze=0;ze<this.m_contactBuffer.count;ze++){Ke=(wt=this.m_contactBuffer.data[ze]).indexA,et=wt.indexB,it=wt.normal,ct=wt.weight;var wt,Pt,Bt=this.m_groupBuffer[Ke],jt=this.m_groupBuffer[et],Xt=this.IsRigidGroup(Bt),Ht=this.IsRigidGroup(jt);Bt!==jt&&(Xt||Ht)&&(mt=K.MidVV(Ye[Ke],Ye[et],se),vt=K.SubVV(this.GetLinearVelocity(jt,et,mt,J),this.GetLinearVelocity(Bt,Ke,mt,q),ve),(Pt=K.DotVV(vt,it))<0&&(this.InitDampingParameterWithRigidGroupOrParticle(xe,Ie,Me,Xt,Bt,Ke,mt,it),this.InitDampingParameterWithRigidGroupOrParticle(Le,Ge,He,Ht,jt,et,mt,it),Tt=Je*ct*this.ComputeDampingImpulse(xe[0],Ie[0],Me[0],Le[0],Ge[0],He[0],Pt),this.ApplyDamping(xe[0],Ie[0],Me[0],Xt,Bt,Ke,Tt,it),this.ApplyDamping(Le[0],Ge[0],He[0],Ht,jt,et,-Tt,it)))}},ae.prototype.SolveExtraDamping=function(){var J=ae.SolveExtraDamping_s_v,q=ae.SolveExtraDamping_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var se=this.m_velocityBuffer.data,ve=this.m_positionBuffer.data,xe=this.GetParticleInvMass(),Ie=0;Ie<this.m_bodyContactBuffer.count;Ie++){var Me=this.m_bodyContactBuffer.data[Ie],Le=Me.index;if(this.m_flagsBuffer.data[Le]&ae.k_extraDampingFlags){var Ge=Me.body,He=Me.mass,Ye=Me.normal,Je=ve[Le],ze=K.SubVV(Ge.GetLinearVelocityFromWorldPoint(Je,K.s_t0),se[Le],J),Ke=K.DotVV(ze,Ye);if(Ke<0){var et=K.MulSV(.5*He*Ke,Ye,q);se[Le].SelfMulAdd(xe,et),Ge.ApplyLinearImpulse(et.SelfNeg(),Je,!0)}}}},ae.prototype.SolveWall=function(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var J=this.m_velocityBuffer.data,q=0;q<this.m_count;q++)this.m_flagsBuffer.data[q]&w.b2ParticleFlag.b2_wallParticle&&J[q].SetZero()},ae.prototype.SolveRigid=function(J){var q=ae.SolveRigid_s_position,se=ae.SolveRigid_s_rotation,ve=ae.SolveRigid_s_transform,xe=ae.SolveRigid_s_velocityTransform;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var Ie=this.m_positionBuffer.data,Me=this.m_velocityBuffer.data,Le=this.m_groupList;Le;Le=Le.GetNext())if(Le.m_groupFlags&w.b2ParticleGroupFlag.b2_rigidParticleGroup){Le.UpdateStatistics();var Ge=se;Ge.SetAngle(J.dt*Le.m_angularVelocity);var He=K.AddVV(Le.m_center,K.SubVV(K.MulSV(J.dt,Le.m_linearVelocity,K.s_t0),oe.MulRV(Ge,Le.m_center,K.s_t1),K.s_t0),q),Ye=ve;Ye.SetPositionRotation(He,Ge),de.MulXX(Ye,Le.m_transform,Le.m_transform);var Je=xe;Je.p.x=J.inv_dt*Ye.p.x,Je.p.y=J.inv_dt*Ye.p.y,Je.q.s=J.inv_dt*Ye.q.s,Je.q.c=J.inv_dt*(Ye.q.c-1);for(var ze=Le.m_firstIndex;ze<Le.m_lastIndex;ze++)de.MulXV(Je,Ie[ze],Me[ze])}},ae.prototype.SolveElastic=function(J){var q=ae.SolveElastic_s_pa,se=ae.SolveElastic_s_pb,ve=ae.SolveElastic_s_pc,xe=ae.SolveElastic_s_r,Ie=ae.SolveElastic_s_t0;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var Me=this.m_positionBuffer.data,Le=this.m_velocityBuffer.data,Ge=J.inv_dt*this.m_def.elasticStrength,He=0;He<this.m_triadBuffer.count;He++){var Ye=this.m_triadBuffer.data[He];if(Ye.flags&w.b2ParticleFlag.b2_elasticParticle){var Je=Ye.indexA,ze=Ye.indexB,Ke=Ye.indexC,et=Ye.pa,it=Ye.pb,ct=Ye.pc,mt=q.Copy(Me[Je]),vt=se.Copy(Me[ze]),Tt=ve.Copy(Me[Ke]),wt=Le[Je],Pt=Le[ze],Bt=Le[Ke];mt.SelfMulAdd(J.dt,wt),vt.SelfMulAdd(J.dt,Pt),Tt.SelfMulAdd(J.dt,Bt);var jt=(mt.x+vt.x+Tt.x)/3,Xt=(mt.y+vt.y+Tt.y)/3;mt.x-=jt,mt.y-=Xt,vt.x-=jt,vt.y-=Xt,Tt.x-=jt,Tt.y-=Xt;var Ht=xe;Ht.s=K.CrossVV(et,mt)+K.CrossVV(it,vt)+K.CrossVV(ct,Tt),Ht.c=K.DotVV(et,mt)+K.DotVV(it,vt)+K.DotVV(ct,Tt);var $t=Z(Ht.s*Ht.s+Ht.c*Ht.c);isFinite($t)||($t=198177537e11),Ht.s*=$t,Ht.c*=$t;var Qt=Ge*Ye.strength;oe.MulRV(Ht,et,Ie),K.SubVV(Ie,mt,Ie),K.MulSV(Qt,Ie,Ie),wt.SelfAdd(Ie),oe.MulRV(Ht,it,Ie),K.SubVV(Ie,vt,Ie),K.MulSV(Qt,Ie,Ie),Pt.SelfAdd(Ie),oe.MulRV(Ht,ct,Ie),K.SubVV(Ie,Tt,Ie),K.MulSV(Qt,Ie,Ie),Bt.SelfAdd(Ie)}}},ae.prototype.SolveSpring=function(J){var q=ae.SolveSpring_s_pa,se=ae.SolveSpring_s_pb,ve=ae.SolveSpring_s_d,xe=ae.SolveSpring_s_f;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var Ie=this.m_positionBuffer.data,Me=this.m_velocityBuffer.data,Le=J.inv_dt*this.m_def.springStrength,Ge=0;Ge<this.m_pairBuffer.count;Ge++){var He=this.m_pairBuffer.data[Ge];if(He.flags&w.b2ParticleFlag.b2_springParticle){var Ye=He.indexA,Je=He.indexB,ze=q.Copy(Ie[Ye]),Ke=se.Copy(Ie[Je]),et=Me[Ye],it=Me[Je];ze.SelfMulAdd(J.dt,et),Ke.SelfMulAdd(J.dt,it);var ct=K.SubVV(Ke,ze,ve),mt=He.distance,vt=ct.Length(),Tt=Le*He.strength,wt=K.MulSV(Tt*(mt-vt)/vt,ct,xe);et.SelfSub(wt),it.SelfAdd(wt)}}},ae.prototype.SolveTensile=function(J){var q=ae.SolveTensile_s_weightedNormal,se=ae.SolveTensile_s_s,ve=ae.SolveTensile_s_f;if(!this.m_velocityBuffer.data)throw new Error;for(var xe=this.m_velocityBuffer.data,Ie=0;Ie<this.m_count;Ie++)this.m_accumulation2Buffer[Ie]=new K,this.m_accumulation2Buffer[Ie].SetZero();for(var Me=0;Me<this.m_contactBuffer.count;Me++)if((ct=this.m_contactBuffer.data[Me]).flags&w.b2ParticleFlag.b2_tensileParticle){var Le=ct.indexA,Ge=ct.indexB,He=ct.weight,Ye=ct.normal,Je=K.MulSV((1-He)*He,Ye,q);this.m_accumulation2Buffer[Le].SelfSub(Je),this.m_accumulation2Buffer[Ge].SelfAdd(Je)}var ze=this.GetCriticalVelocity(J),Ke=this.m_def.surfaceTensionPressureStrength*ze,et=this.m_def.surfaceTensionNormalStrength*ze,it=.5*ze;for(Me=0;Me<this.m_contactBuffer.count;Me++){var ct;if((ct=this.m_contactBuffer.data[Me]).flags&w.b2ParticleFlag.b2_tensileParticle){Le=ct.indexA,Ge=ct.indexB,He=ct.weight,Ye=ct.normal;var mt=this.m_weightBuffer[Le]+this.m_weightBuffer[Ge],vt=K.SubVV(this.m_accumulation2Buffer[Ge],this.m_accumulation2Buffer[Le],se),Tt=U(Ke*(mt-2)+et*K.DotVV(vt,Ye),it)*He,wt=K.MulSV(Tt,Ye,ve);xe[Le].SelfSub(wt),xe[Ge].SelfAdd(wt)}}},ae.prototype.SolveViscous=function(){var J=ae.SolveViscous_s_v,q=ae.SolveViscous_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var se=this.m_positionBuffer.data,ve=this.m_velocityBuffer.data,xe=this.m_def.viscousStrength,Ie=this.GetParticleInvMass(),Me=0;Me<this.m_bodyContactBuffer.count;Me++){var Le=(et=this.m_bodyContactBuffer.data[Me]).index;if(this.m_flagsBuffer.data[Le]&w.b2ParticleFlag.b2_viscousParticle){var Ge=et.body,He=et.weight,Ye=et.mass,Je=se[Le],ze=K.SubVV(Ge.GetLinearVelocityFromWorldPoint(Je,K.s_t0),ve[Le],J),Ke=K.MulSV(xe*Ye*He,ze,q);ve[Le].SelfMulAdd(Ie,Ke),Ge.ApplyLinearImpulse(Ke.SelfNeg(),Je,!0)}}for(Me=0;Me<this.m_contactBuffer.count;Me++){var et;(et=this.m_contactBuffer.data[Me]).flags&w.b2ParticleFlag.b2_viscousParticle&&(Le=et.indexA,Ge=et.indexB,He=et.weight,ze=K.SubVV(ve[Ge],ve[Le],J),Ke=K.MulSV(xe*He,ze,q),ve[Le].SelfAdd(Ke),ve[Ge].SelfSub(Ke))}},ae.prototype.SolveRepulsive=function(J){var q=ae.SolveRepulsive_s_f;if(!this.m_velocityBuffer.data)throw new Error;for(var se=this.m_velocityBuffer.data,ve=this.m_def.repulsiveStrength*this.GetCriticalVelocity(J),xe=0;xe<this.m_contactBuffer.count;xe++){var Ie=this.m_contactBuffer.data[xe];if(Ie.flags&w.b2ParticleFlag.b2_repulsiveParticle){var Me=Ie.indexA,Le=Ie.indexB;if(this.m_groupBuffer[Me]!==this.m_groupBuffer[Le]){var Ge=Ie.weight,He=Ie.normal,Ye=K.MulSV(ve*Ge,He,q);se[Me].SelfSub(Ye),se[Le].SelfAdd(Ye)}}}},ae.prototype.SolvePowder=function(J){var q=ae.SolvePowder_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var se=this.m_positionBuffer.data,ve=this.m_velocityBuffer.data,xe=this.m_def.powderStrength*this.GetCriticalVelocity(J),Ie=this.GetParticleInvMass(),Me=0;Me<this.m_bodyContactBuffer.count;Me++){var Le=(Ke=this.m_bodyContactBuffer.data[Me]).index;if(this.m_flagsBuffer.data[Le]&w.b2ParticleFlag.b2_powderParticle&&(et=Ke.weight)>.25){var Ge=Ke.body,He=Ke.mass,Ye=se[Le],Je=Ke.normal,ze=K.MulSV(xe*He*(et-.25),Je,q);ve[Le].SelfMulSub(Ie,ze),Ge.ApplyLinearImpulse(ze,Ye,!0)}}for(Me=0;Me<this.m_contactBuffer.count;Me++){var Ke,et;(Ke=this.m_contactBuffer.data[Me]).flags&w.b2ParticleFlag.b2_powderParticle&&(et=Ke.weight)>.25&&(Le=Ke.indexA,Ge=Ke.indexB,Je=Ke.normal,ze=K.MulSV(xe*(et-.25),Je,q),ve[Le].SelfSub(ze),ve[Ge].SelfAdd(ze))}},ae.prototype.SolveSolid=function(J){var q=ae.SolveSolid_s_f;if(!this.m_velocityBuffer.data)throw new Error;var se=this.m_velocityBuffer.data;this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer);for(var ve=J.inv_dt*this.m_def.ejectionStrength,xe=0;xe<this.m_contactBuffer.count;xe++){var Ie=this.m_contactBuffer.data[xe],Me=Ie.indexA,Le=Ie.indexB;if(this.m_groupBuffer[Me]!==this.m_groupBuffer[Le]){var Ge=Ie.weight,He=Ie.normal,Ye=this.m_depthBuffer[Me]+this.m_depthBuffer[Le],Je=K.MulSV(ve*Ye*Ge,He,q);se[Me].SelfSub(Je),se[Le].SelfAdd(Je)}}},ae.prototype.SolveForce=function(J){if(!this.m_velocityBuffer.data)throw new Error;for(var q=this.m_velocityBuffer.data,se=J.dt*this.GetParticleInvMass(),ve=0;ve<this.m_count;ve++)q[ve].SelfMulAdd(se,this.m_forceBuffer[ve]);this.m_hasForce=!1},ae.prototype.SolveColorMixing=function(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_colorBuffer.data)throw new Error;var J=.5*this.m_def.colorMixingStrength;if(J)for(var q=0;q<this.m_contactBuffer.count;q++){var se=this.m_contactBuffer.data[q],ve=se.indexA,xe=se.indexB;if(this.m_flagsBuffer.data[ve]&this.m_flagsBuffer.data[xe]&w.b2ParticleFlag.b2_colorMixingParticle){var Ie=this.m_colorBuffer.data[ve],Me=this.m_colorBuffer.data[xe];ye.MixColors(Ie,Me,J)}}},ae.prototype.SolveZombie=function(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var J=0,q=[],se=0;se<this.m_count;se++)q[se]=k;var ve=0;for(se=0;se<this.m_count;se++){var xe=this.m_flagsBuffer.data[se];if(xe&w.b2ParticleFlag.b2_zombieParticle){var Ie=this.m_world.m_destructionListener;xe&w.b2ParticleFlag.b2_destructionListenerParticle&&Ie&&Ie.SayGoodbyeParticle(this,se),this.m_handleIndexBuffer.data&&(Me=this.m_handleIndexBuffer.data[se])&&(Me.SetIndex(k),this.m_handleIndexBuffer.data[se]=null),q[se]=k}else{var Me;q[se]=J,se!==J&&(this.m_handleIndexBuffer.data&&((Me=this.m_handleIndexBuffer.data[se])&&Me.SetIndex(J),this.m_handleIndexBuffer.data[J]=Me),this.m_flagsBuffer.data[J]=this.m_flagsBuffer.data[se],this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[J]=this.m_lastBodyContactStepBuffer.data[se]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[J]=this.m_bodyContactCountBuffer.data[se]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[J]=this.m_consecutiveContactStepsBuffer.data[se]),this.m_positionBuffer.data[J].Copy(this.m_positionBuffer.data[se]),this.m_velocityBuffer.data[J].Copy(this.m_velocityBuffer.data[se]),this.m_groupBuffer[J]=this.m_groupBuffer[se],this.m_hasForce&&this.m_forceBuffer[J].Copy(this.m_forceBuffer[se]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[J]=this.m_staticPressureBuffer[se]),this.m_depthBuffer&&(this.m_depthBuffer[J]=this.m_depthBuffer[se]),this.m_colorBuffer.data&&this.m_colorBuffer.data[J].Copy(this.m_colorBuffer.data[se]),this.m_userDataBuffer.data&&(this.m_userDataBuffer.data[J]=this.m_userDataBuffer.data[se]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[J]=this.m_expirationTimeBuffer.data[se])),J++,ve|=xe}}for(var Le=0;Le<this.m_proxyBuffer.count;Le++){var Ge=this.m_proxyBuffer.data[Le];Ge.index=q[Ge.index]}for(this.m_proxyBuffer.RemoveIf(function(Pt){return Pt.index<0}),Le=0;Le<this.m_contactBuffer.count;Le++)(He=this.m_contactBuffer.data[Le]).indexA=q[He.indexA],He.indexB=q[He.indexB];for(this.m_contactBuffer.RemoveIf(function(Pt){return Pt.indexA<0||Pt.indexB<0}),Le=0;Le<this.m_bodyContactBuffer.count;Le++){var He;(He=this.m_bodyContactBuffer.data[Le]).index=q[He.index]}for(this.m_bodyContactBuffer.RemoveIf(function(Pt){return Pt.index<0}),Le=0;Le<this.m_pairBuffer.count;Le++){var Ye=this.m_pairBuffer.data[Le];Ye.indexA=q[Ye.indexA],Ye.indexB=q[Ye.indexB]}for(this.m_pairBuffer.RemoveIf(function(Pt){return Pt.indexA<0||Pt.indexB<0}),Le=0;Le<this.m_triadBuffer.count;Le++){var Je=this.m_triadBuffer.data[Le];Je.indexA=q[Je.indexA],Je.indexB=q[Je.indexB],Je.indexC=q[Je.indexC]}if(this.m_triadBuffer.RemoveIf(function(Pt){return Pt.indexA<0||Pt.indexB<0||Pt.indexC<0}),this.m_indexByExpirationTimeBuffer.data)for(var ze=0,Ke=0;Ke<this.m_count;Ke++){var et=q[this.m_indexByExpirationTimeBuffer.data[Ke]];et!==k&&(this.m_indexByExpirationTimeBuffer.data[ze++]=et)}for(var it=this.m_groupList;it;it=it.GetNext()){var ct=J,mt=0,vt=!1;for(se=it.m_firstIndex;se<it.m_lastIndex;se++){var Tt=q[se];Tt>=0?(ct=U(ct,Tt),mt=X(mt,Tt+1)):vt=!0}ct<mt?(it.m_firstIndex=ct,it.m_lastIndex=mt,vt&&it.m_groupFlags&w.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SetGroupFlags(it,it.m_groupFlags|w.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)):(it.m_firstIndex=0,it.m_lastIndex=0,it.m_groupFlags&w.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty||this.SetGroupFlags(it,it.m_groupFlags|w.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))}for(this.m_count=J,this.m_allParticleFlags=ve,this.m_needsUpdateAllParticleFlags=!1,it=this.m_groupList;it;){var wt=it.GetNext();it.m_groupFlags&w.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed&&this.DestroyParticleGroup(it),it=wt}},ae.prototype.SolveLifetimes=function(J){if(!this.m_expirationTimeBuffer.data)throw new Error;if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;this.m_timeElapsed=this.LifetimeToExpirationTime(J.dt);var q=this.GetQuantizedTimeElapsed(),se=this.m_expirationTimeBuffer.data,ve=this.m_indexByExpirationTimeBuffer.data,xe=this.GetParticleCount();this.m_expirationTimeBufferRequiresSorting&&(Ki(ve,0,xe,function(Ge,He){var Ye=se[Ge],Je=se[He],ze=Ye<=0;return ze===Je<=0?Ye>Je:ze}),this.m_expirationTimeBufferRequiresSorting=!1);for(var Ie=xe-1;Ie>=0;--Ie){var Me=ve[Ie],Le=se[Me];if(q<Le||Le<=0)break;this.DestroyParticle(Me)}},ae.prototype.RotateBuffer=function(J,q,se){if(J!==q&&q!==se){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;if(Mr(this.m_flagsBuffer.data,J,q,se),this.m_lastBodyContactStepBuffer.data&&Mr(this.m_lastBodyContactStepBuffer.data,J,q,se),this.m_bodyContactCountBuffer.data&&Mr(this.m_bodyContactCountBuffer.data,J,q,se),this.m_consecutiveContactStepsBuffer.data&&Mr(this.m_consecutiveContactStepsBuffer.data,J,q,se),Mr(this.m_positionBuffer.data,J,q,se),Mr(this.m_velocityBuffer.data,J,q,se),Mr(this.m_groupBuffer,J,q,se),this.m_hasForce&&Mr(this.m_forceBuffer,J,q,se),this.m_staticPressureBuffer&&Mr(this.m_staticPressureBuffer,J,q,se),this.m_depthBuffer&&Mr(this.m_depthBuffer,J,q,se),this.m_colorBuffer.data&&Mr(this.m_colorBuffer.data,J,q,se),this.m_userDataBuffer.data&&Mr(this.m_userDataBuffer.data,J,q,se),this.m_handleIndexBuffer.data){Mr(this.m_handleIndexBuffer.data,J,q,se);for(var ve=J;ve<se;++ve){var xe=this.m_handleIndexBuffer.data[ve];xe&&xe.SetIndex(Ke(xe.GetIndex()))}}if(this.m_expirationTimeBuffer.data){Mr(this.m_expirationTimeBuffer.data,J,q,se);var Ie=this.GetParticleCount();if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;var Me=this.m_indexByExpirationTimeBuffer.data;for(ve=0;ve<Ie;++ve)Me[ve]=Ke(Me[ve])}for(var Le=0;Le<this.m_proxyBuffer.count;Le++){var Ge=this.m_proxyBuffer.data[Le];Ge.index=Ke(Ge.index)}for(Le=0;Le<this.m_contactBuffer.count;Le++)(He=this.m_contactBuffer.data[Le]).indexA=Ke(He.indexA),He.indexB=Ke(He.indexB);for(Le=0;Le<this.m_bodyContactBuffer.count;Le++){var He;(He=this.m_bodyContactBuffer.data[Le]).index=Ke(He.index)}for(Le=0;Le<this.m_pairBuffer.count;Le++){var Ye=this.m_pairBuffer.data[Le];Ye.indexA=Ke(Ye.indexA),Ye.indexB=Ke(Ye.indexB)}for(Le=0;Le<this.m_triadBuffer.count;Le++){var Je=this.m_triadBuffer.data[Le];Je.indexA=Ke(Je.indexA),Je.indexB=Ke(Je.indexB),Je.indexC=Ke(Je.indexC)}for(var ze=this.m_groupList;ze;ze=ze.GetNext())ze.m_firstIndex=Ke(ze.m_firstIndex),ze.m_lastIndex=Ke(ze.m_lastIndex-1)+1}function Ke(et){return et<J?et:et<q?et+se-q:et<se?et+J-q:et}},ae.prototype.GetCriticalVelocity=function(J){return this.m_particleDiameter*J.inv_dt},ae.prototype.GetCriticalVelocitySquared=function(J){var q=this.GetCriticalVelocity(J);return q*q},ae.prototype.GetCriticalPressure=function(J){return this.m_def.density*this.GetCriticalVelocitySquared(J)},ae.prototype.GetParticleStride=function(){return .75*this.m_particleDiameter},ae.prototype.GetParticleMass=function(){var J=this.GetParticleStride();return this.m_def.density*J*J},ae.prototype.GetParticleInvMass=function(){var J=this.m_inverseDiameter*1.3333333333333333;return this.m_inverseDensity*J*J},ae.prototype.GetFixtureContactFilter=function(){return this.m_allParticleFlags&w.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null},ae.prototype.GetParticleContactFilter=function(){return this.m_allParticleFlags&w.b2ParticleFlag.b2_particleContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null},ae.prototype.GetFixtureContactListener=function(){return this.m_allParticleFlags&w.b2ParticleFlag.b2_fixtureContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null},ae.prototype.GetParticleContactListener=function(){return this.m_allParticleFlags&w.b2ParticleFlag.b2_particleContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null},ae.prototype.SetUserOverridableBuffer=function(J,q,se){J.data=q,J.userSuppliedCapacity=se},ae.prototype.SetGroupFlags=function(J,q){var se=J.m_groupFlags;(se^q)&w.b2ParticleGroupFlag.b2_solidParticleGroup&&(q|=w.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),se&~q&&(this.m_needsUpdateAllGroupFlags=!0),~this.m_allGroupFlags&q&&(q&w.b2ParticleGroupFlag.b2_solidParticleGroup&&(this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer)),this.m_allGroupFlags|=q),J.m_groupFlags=q},ae.BodyContactCompare=function(J,q){return J.index===q.index?J.weight>q.weight:J.index<q.index},ae.prototype.RemoveSpuriousBodyContacts=function(){Ki(this.m_bodyContactBuffer.data,0,this.m_bodyContactBuffer.count,ae.BodyContactCompare);var J=ae.RemoveSpuriousBodyContacts_s_n,q=ae.RemoveSpuriousBodyContacts_s_pos,se=ae.RemoveSpuriousBodyContacts_s_normal,ve=this,xe=-1,Ie=0;this.m_bodyContactBuffer.count=As(this.m_bodyContactBuffer.data,function(Me){if(Me.index!==xe&&(Ie=0,xe=Me.index),Ie++>3)return!0;var Le=J.Copy(Me.normal);if(Le.SelfMul(ve.m_particleDiameter*(1-Me.weight)),!ve.m_positionBuffer.data)throw new Error;var Ge=K.AddVV(ve.m_positionBuffer.data[Me.index],Le,q);if(!Me.fixture.TestPoint(Ge)){for(var He=Me.fixture.GetShape().GetChildCount(),Ye=0;Ye<He;Ye++){var Je=se;if(Me.fixture.ComputeDistance(Ge,Je,Ye)<I)return!1}return!0}return!1},this.m_bodyContactBuffer.count)},ae.prototype.DetectStuckParticle=function(J){if(!(this.m_stuckThreshold<=0)){if(!this.m_bodyContactCountBuffer.data)throw new Error;if(!this.m_consecutiveContactStepsBuffer.data)throw new Error;if(!this.m_lastBodyContactStepBuffer.data)throw new Error;++this.m_bodyContactCountBuffer.data[J],this.m_bodyContactCountBuffer.data[J]===2&&(++this.m_consecutiveContactStepsBuffer.data[J],this.m_consecutiveContactStepsBuffer.data[J]>this.m_stuckThreshold&&(this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()]=J)),this.m_lastBodyContactStepBuffer.data[J]=this.m_timestamp}},ae.prototype.ValidateParticleIndex=function(J){return J>=0&&J<this.GetParticleCount()&&J!==k},ae.prototype.GetQuantizedTimeElapsed=function(){return Math.floor(this.m_timeElapsed/4294967296)},ae.prototype.LifetimeToExpirationTime=function(J){return this.m_timeElapsed+Math.floor(J/this.m_def.lifetimeGranularity*4294967296)},ae.prototype.ForceCanBeApplied=function(J){return!(J&w.b2ParticleFlag.b2_wallParticle)},ae.prototype.PrepareForceBuffer=function(){if(!this.m_hasForce){for(var J=0;J<this.m_count;J++)this.m_forceBuffer[J].SetZero();this.m_hasForce=!0}},ae.prototype.IsRigidGroup=function(J){return J!==null&&(J.m_groupFlags&w.b2ParticleGroupFlag.b2_rigidParticleGroup)!=0},ae.prototype.GetLinearVelocity=function(J,q,se,ve){if(J&&this.IsRigidGroup(J))return J.GetLinearVelocityFromWorldPoint(se,ve);if(!this.m_velocityBuffer.data)throw new Error;return ve.Copy(this.m_velocityBuffer.data[q])},ae.prototype.InitDampingParameter=function(J,q,se,ve,xe,Ie,Me,Le){J[0]=ve>0?1/ve:0,q[0]=xe>0?1/xe:0,se[0]=K.CrossVV(K.SubVV(Me,Ie,K.s_t0),Le)},ae.prototype.InitDampingParameterWithRigidGroupOrParticle=function(J,q,se,ve,xe,Ie,Me,Le){if(xe&&ve)this.InitDampingParameter(J,q,se,xe.GetMass(),xe.GetInertia(),xe.GetCenter(),Me,Le);else{if(!this.m_flagsBuffer.data)throw new Error;var Ge=this.m_flagsBuffer.data[Ie];this.InitDampingParameter(J,q,se,Ge&w.b2ParticleFlag.b2_wallParticle?0:this.GetParticleMass(),0,Me,Me,Le)}},ae.prototype.ComputeDampingImpulse=function(J,q,se,ve,xe,Ie,Me){var Le=J+q*se*se+ve+xe*Ie*Ie;return Le>0?Me/Le:0},ae.prototype.ApplyDamping=function(J,q,se,ve,xe,Ie,Me,Le){if(xe&&ve)xe.m_linearVelocity.SelfMulAdd(Me*J,Le),xe.m_angularVelocity+=Me*se*q;else{if(!this.m_velocityBuffer.data)throw new Error;this.m_velocityBuffer.data[Ie].SelfMulAdd(Me*J,Le)}},ae.xTruncBits=12,ae.yTruncBits=12,ae.tagBits=32,ae.yOffset=1<<ae.yTruncBits-1,ae.yShift=ae.tagBits-ae.yTruncBits,ae.xShift=ae.tagBits-ae.yTruncBits-ae.xTruncBits,ae.xScale=1<<ae.xShift,ae.xOffset=ae.xScale*(1<<ae.xTruncBits-1),ae.yMask=(1<<ae.yTruncBits)-1<<ae.yShift,ae.xMask=~ae.yMask,ae.DestroyParticlesInShape_s_aabb=new Ot,ae.CreateParticleGroup_s_transform=new de,ae.ComputeCollisionEnergy_s_v=new K,ae.QueryShapeAABB_s_aabb=new Ot,ae.QueryPointAABB_s_aabb=new Ot,ae.RayCast_s_aabb=new Ot,ae.RayCast_s_p=new K,ae.RayCast_s_v=new K,ae.RayCast_s_n=new K,ae.RayCast_s_point=new K,ae.k_pairFlags=w.b2ParticleFlag.b2_springParticle,ae.k_triadFlags=w.b2ParticleFlag.b2_elasticParticle,ae.k_noPressureFlags=w.b2ParticleFlag.b2_powderParticle|w.b2ParticleFlag.b2_tensileParticle,ae.k_extraDampingFlags=w.b2ParticleFlag.b2_staticPressureParticle,ae.k_barrierWallFlags=w.b2ParticleFlag.b2_barrierParticle|w.b2ParticleFlag.b2_wallParticle,ae.CreateParticlesStrokeShapeForGroup_s_edge=new bi,ae.CreateParticlesStrokeShapeForGroup_s_d=new K,ae.CreateParticlesStrokeShapeForGroup_s_p=new K,ae.CreateParticlesFillShapeForGroup_s_aabb=new Ot,ae.CreateParticlesFillShapeForGroup_s_p=new K,ae.UpdatePairsAndTriads_s_dab=new K,ae.UpdatePairsAndTriads_s_dbc=new K,ae.UpdatePairsAndTriads_s_dca=new K,ae.AddContact_s_d=new K,ae.UpdateBodyContacts_s_aabb=new Ot,ae.Solve_s_subStep=new fi,ae.SolveCollision_s_aabb=new Ot,ae.SolveGravity_s_gravity=new K,ae.SolveBarrier_s_aabb=new Ot,ae.SolveBarrier_s_va=new K,ae.SolveBarrier_s_vb=new K,ae.SolveBarrier_s_pba=new K,ae.SolveBarrier_s_vba=new K,ae.SolveBarrier_s_vc=new K,ae.SolveBarrier_s_pca=new K,ae.SolveBarrier_s_vca=new K,ae.SolveBarrier_s_qba=new K,ae.SolveBarrier_s_qca=new K,ae.SolveBarrier_s_dv=new K,ae.SolveBarrier_s_f=new K,ae.SolvePressure_s_f=new K,ae.SolveDamping_s_v=new K,ae.SolveDamping_s_f=new K,ae.SolveRigidDamping_s_t0=new K,ae.SolveRigidDamping_s_t1=new K,ae.SolveRigidDamping_s_p=new K,ae.SolveRigidDamping_s_v=new K,ae.SolveExtraDamping_s_v=new K,ae.SolveExtraDamping_s_f=new K,ae.SolveRigid_s_position=new K,ae.SolveRigid_s_rotation=new oe,ae.SolveRigid_s_transform=new de,ae.SolveRigid_s_velocityTransform=new de,ae.SolveElastic_s_pa=new K,ae.SolveElastic_s_pb=new K,ae.SolveElastic_s_pc=new K,ae.SolveElastic_s_r=new oe,ae.SolveElastic_s_t0=new K,ae.SolveSpring_s_pa=new K,ae.SolveSpring_s_pb=new K,ae.SolveSpring_s_d=new K,ae.SolveSpring_s_f=new K,ae.SolveTensile_s_weightedNormal=new K,ae.SolveTensile_s_s=new K,ae.SolveTensile_s_f=new K,ae.SolveViscous_s_v=new K,ae.SolveViscous_s_f=new K,ae.SolveRepulsive_s_f=new K,ae.SolvePowder_s_f=new K,ae.SolveSolid_s_f=new K,ae.RemoveSpuriousBodyContacts_s_n=new K,ae.RemoveSpuriousBodyContacts_s_pos=new K,ae.RemoveSpuriousBodyContacts_s_normal=new K,ae}(),function(ae){ae.UserOverridableBuffer=function(){this.data=null,this.userSuppliedCapacity=0};var J=function(){function ze(){this.index=k,this.tag=0}return ze.CompareProxyProxy=function(Ke,et){return Ke.tag<et.tag},ze.CompareTagProxy=function(Ke,et){return Ke<et.tag},ze.CompareProxyTag=function(Ke,et){return Ke.tag<et},ze}();ae.Proxy=J;var q=function(){function ze(Ke,et,it,ct,mt){this.m_system=Ke,this.m_xLower=(et&ae.xMask)>>>0,this.m_xUpper=(it&ae.xMask)>>>0,this.m_yLower=(et&ae.yMask)>>>0,this.m_yUpper=(it&ae.yMask)>>>0,this.m_first=ct,this.m_last=mt}return ze.prototype.GetNext=function(){for(;this.m_first<this.m_last;){var Ke=(this.m_system.m_proxyBuffer.data[this.m_first].tag&ae.xMask)>>>0;if(Ke>=this.m_xLower&&Ke<=this.m_xUpper)return this.m_system.m_proxyBuffer.data[this.m_first++].index;this.m_first++}return k},ze}();ae.InsideBoundsEnumerator=q,ae.ParticleListNode=function(){this.next=null,this.count=0,this.index=0};var se=function(){function ze(){}return ze.prototype.Allocate=function(Ke,et){return et},ze.prototype.Clear=function(){},ze.prototype.GetCount=function(){return 0},ze.prototype.Invalidate=function(){},ze.prototype.GetValidBuffer=function(){return[]},ze.prototype.GetBuffer=function(){return[]},ze.prototype.SetCount=function(){},ze}();ae.FixedSetAllocator=se,ae.FixtureParticle=function(ze,Ke){this.second=k,this.first=ze,this.second=Ke};var ve=function(ze){function Ke(){return ze!==null&&ze.apply(this,arguments)||this}return sr(Ke,ze),Ke.prototype.Initialize=function(){},Ke.prototype.Find=function(){return k},Ke}(ae.FixedSetAllocator);ae.FixtureParticleSet=ve,ae.ParticlePair=function(ze,Ke){this.first=k,this.second=k,this.first=ze,this.second=Ke};var xe=function(ze){function Ke(){return ze!==null&&ze.apply(this,arguments)||this}return sr(Ke,ze),Ke.prototype.Initialize=function(){},Ke.prototype.Find=function(){return k},Ke}(ae.FixedSetAllocator);ae.b2ParticlePairSet=xe;var Ie=function(){function ze(){}return ze.prototype.IsNecessary=function(){return!0},ze.prototype.ShouldCreatePair=function(){return!0},ze.prototype.ShouldCreateTriad=function(){return!0},ze}();ae.ConnectionFilter=Ie;var Me=function(ze){function Ke(et,it,ct,mt){var vt=ze.call(this)||this;return vt.m_callDestructionListener=!1,vt.m_destroyed=0,vt.m_system=et,vt.m_shape=it,vt.m_xf=ct,vt.m_callDestructionListener=mt,vt.m_destroyed=0,vt}return sr(Ke,ze),Ke.prototype.ReportFixture=function(){return!1},Ke.prototype.ReportParticle=function(et,it){if(et!==this.m_system)return!1;if(!this.m_system.m_positionBuffer.data)throw new Error;return this.m_shape.TestPoint(this.m_xf,this.m_system.m_positionBuffer.data[it])&&(this.m_system.DestroyParticle(it,this.m_callDestructionListener),this.m_destroyed++),!0},Ke.prototype.Destroyed=function(){return this.m_destroyed},Ke}(Ci);ae.DestroyParticlesInShapeCallback=Me;var Le=function(ze){function Ke(et){var it=ze.call(this)||this;return it.m_threshold=0,it.m_threshold=et,it}return sr(Ke,ze),Ke.prototype.ShouldCreatePair=function(et,it){return et<this.m_threshold&&this.m_threshold<=it||it<this.m_threshold&&this.m_threshold<=et},Ke.prototype.ShouldCreateTriad=function(et,it,ct){return(et<this.m_threshold||it<this.m_threshold||ct<this.m_threshold)&&(this.m_threshold<=et||this.m_threshold<=it||this.m_threshold<=ct)},Ke}(ae.ConnectionFilter);ae.JoinParticleGroupsFilter=Le;var Ge=function(ze){function Ke(et,it){it===void 0&&(it=et.length);var ct=ze.call(this,w.b2ShapeType.e_unknown,0)||this;return ct.m_shapeCount=0,ct.m_shapes=et,ct.m_shapeCount=it,ct}return sr(Ke,ze),Ke.prototype.Clone=function(){throw new Error},Ke.prototype.GetChildCount=function(){return 1},Ke.prototype.TestPoint=function(et,it){for(var ct=0;ct<this.m_shapeCount;ct++)if(this.m_shapes[ct].TestPoint(et,it))return!0;return!1},Ke.prototype.ComputeDistance=function(){return 0},Ke.prototype.RayCast=function(){return!1},Ke.prototype.ComputeAABB=function(et,it){var ct=new Ot;et.lowerBound.x=+A,et.lowerBound.y=+A,et.upperBound.x=-A,et.upperBound.y=-A;for(var mt=0;mt<this.m_shapeCount;mt++)for(var vt=this.m_shapes[mt].GetChildCount(),Tt=0;Tt<vt;Tt++){var wt=ct;this.m_shapes[mt].ComputeAABB(wt,it,Tt),et.Combine1(wt)}},Ke.prototype.ComputeMass=function(){},Ke.prototype.SetupDistanceProxy=function(){},Ke.prototype.ComputeSubmergedArea=function(){return 0},Ke.prototype.Dump=function(){},Ke}(hi);ae.CompositeShape=Ge;var He=function(ze){function Ke(et){var it=ze.call(this)||this;return it.m_flagsBuffer=et,it}return sr(Ke,ze),Ke.prototype.IsNecessary=function(et){if(!this.m_flagsBuffer.data)throw new Error;return(this.m_flagsBuffer.data[et]&w.b2ParticleFlag.b2_reactiveParticle)!=0},Ke}(ae.ConnectionFilter);ae.ReactiveFilter=He;var Ye=function(ze){function Ke(et,it){var ct=ze.call(this,et)||this;return ct.m_contactFilter=it,ct}return sr(Ke,ze),Ke.prototype.ShouldCollideFixtureParticle=function(et,it,ct){return!(this.m_contactFilter&&this.m_system.GetFlagsBuffer()[ct]&w.b2ParticleFlag.b2_fixtureContactFilterParticle)||this.m_contactFilter.ShouldCollideFixtureParticle(et,this.m_system,ct)},Ke.prototype.ReportFixtureAndParticle=function(et,it,ct){var mt=ae.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_n,vt=ae.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_rp;if(!this.m_system.m_flagsBuffer.data)throw new Error;if(!this.m_system.m_positionBuffer.data)throw new Error;var Tt=this.m_system.m_positionBuffer.data[ct],wt=mt,Pt=et.ComputeDistance(Tt,wt,it);if(Pt<this.m_system.m_particleDiameter&&this.ShouldCollideFixtureParticle(et,this.m_system,ct)){var Bt=et.GetBody(),jt=Bt.GetWorldCenter(),Xt=Bt.GetMass(),Ht=Bt.GetInertia()-Xt*Bt.GetLocalCenter().LengthSquared(),$t=Xt>0?1/Xt:0,Qt=Ht>0?1/Ht:0,ur=this.m_system.m_flagsBuffer.data[ct]&w.b2ParticleFlag.b2_wallParticle?0:this.m_system.GetParticleInvMass(),tr=K.SubVV(Tt,jt,vt),qt=K.CrossVV(tr,wt),ar=ur+$t+Qt*qt*qt,or=this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];or.index=ct,or.body=Bt,or.fixture=et,or.weight=1-Pt*this.m_system.m_inverseDiameter,or.normal.Copy(wt.SelfNeg()),or.mass=ar>0?1/ar:0,this.m_system.DetectStuckParticle(ct)}},Ke.ReportFixtureAndParticle_s_n=new K,Ke.ReportFixtureAndParticle_s_rp=new K,Ke}(On);ae.UpdateBodyContactsCallback=Ye;var Je=function(ze){function Ke(et,it){var ct=ze.call(this,et)||this;return ct.m_step=it,ct}return sr(Ke,ze),Ke.prototype.ReportFixtureAndParticle=function(et,it,ct){var mt=ae.SolveCollisionCallback.ReportFixtureAndParticle_s_p1,vt=ae.SolveCollisionCallback.ReportFixtureAndParticle_s_output,Tt=ae.SolveCollisionCallback.ReportFixtureAndParticle_s_input,wt=ae.SolveCollisionCallback.ReportFixtureAndParticle_s_p,Pt=ae.SolveCollisionCallback.ReportFixtureAndParticle_s_v,Bt=ae.SolveCollisionCallback.ReportFixtureAndParticle_s_f,jt=et.GetBody();if(!this.m_system.m_positionBuffer.data)throw new Error;if(!this.m_system.m_velocityBuffer.data)throw new Error;var Xt=this.m_system.m_positionBuffer.data[ct],Ht=this.m_system.m_velocityBuffer.data[ct],$t=vt,Qt=Tt;if(this.m_system.m_iterationIndex===0){var ur=de.MulTXV(jt.m_xf0,Xt,mt);et.GetShape().GetType()===w.b2ShapeType.e_circleShape&&(ur.SelfSub(jt.GetLocalCenter()),oe.MulRV(jt.m_xf0.q,ur,ur),oe.MulTRV(jt.m_xf.q,ur,ur),ur.SelfAdd(jt.GetLocalCenter())),de.MulXV(jt.m_xf,ur,Qt.p1)}else Qt.p1.Copy(Xt);if(K.AddVMulSV(Xt,this.m_step.dt,Ht,Qt.p2),Qt.maxFraction=1,et.RayCast($t,Qt,it)){var tr=$t.normal,qt=wt;qt.x=(1-$t.fraction)*Qt.p1.x+$t.fraction*Qt.p2.x+I*tr.x,qt.y=(1-$t.fraction)*Qt.p1.y+$t.fraction*Qt.p2.y+I*tr.y;var ar=Pt;ar.x=this.m_step.inv_dt*(qt.x-Xt.x),ar.y=this.m_step.inv_dt*(qt.y-Xt.y),this.m_system.m_velocityBuffer.data[ct].Copy(ar);var or=Bt;or.x=this.m_step.inv_dt*this.m_system.GetParticleMass()*(Ht.x-ar.x),or.y=this.m_step.inv_dt*this.m_system.GetParticleMass()*(Ht.y-ar.y),this.m_system.ParticleApplyForce(ct,or)}},Ke.prototype.ReportParticle=function(){return!1},Ke.ReportFixtureAndParticle_s_p1=new K,Ke.ReportFixtureAndParticle_s_output=new Lt,Ke.ReportFixtureAndParticle_s_input=new Et,Ke.ReportFixtureAndParticle_s_p=new K,Ke.ReportFixtureAndParticle_s_v=new K,Ke.ReportFixtureAndParticle_s_f=new K,Ke}(On);ae.SolveCollisionCallback=Je}(w.b2ParticleSystem||(w.b2ParticleSystem={}));var ao=function(){function ae(J){this.m_newFixture=!1,this.m_locked=!1,this.m_clearForces=!0,this.m_contactManager=new _s,this.m_bodyList=null,this.m_jointList=null,this.m_particleSystemList=null,this.m_bodyCount=0,this.m_jointCount=0,this.m_gravity=new K,this.m_allowSleep=!0,this.m_destructionListener=null,this.m_debugDraw=null,this.m_inv_dt0=0,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_profile=new An,this.m_island=new xs,this.s_stack=[],this.m_controllerList=null,this.m_controllerCount=0,this.m_gravity.Copy(J)}return ae.prototype.SetDestructionListener=function(J){this.m_destructionListener=J},ae.prototype.SetContactFilter=function(J){this.m_contactManager.m_contactFilter=J},ae.prototype.SetContactListener=function(J){this.m_contactManager.m_contactListener=J},ae.prototype.SetDebugDraw=function(J){this.m_debugDraw=J},ae.prototype.CreateBody=function(J){if(J===void 0&&(J={}),this.IsLocked())throw new Error;var q=new Kn(J,this);return q.m_prev=null,q.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=q),this.m_bodyList=q,++this.m_bodyCount,q},ae.prototype.DestroyBody=function(J){if(this.IsLocked())throw new Error;for(var q=J.m_jointList;q;){var se=q;q=q.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(se.joint),this.DestroyJoint(se.joint),J.m_jointList=q}J.m_jointList=null;for(var ve=J.m_controllerList;ve;){var xe=ve;ve=ve.nextController,xe.controller.RemoveBody(J)}for(var Ie=J.m_contactList;Ie;){var Me=Ie;Ie=Ie.next,this.m_contactManager.Destroy(Me.contact)}J.m_contactList=null;for(var Le=J.m_fixtureList;Le;){var Ge=Le;Le=Le.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(Ge),Ge.DestroyProxies(),Ge.Destroy(),J.m_fixtureList=Le,J.m_fixtureCount-=1}J.m_fixtureList=null,J.m_fixtureCount=0,J.m_prev&&(J.m_prev.m_next=J.m_next),J.m_next&&(J.m_next.m_prev=J.m_prev),J===this.m_bodyList&&(this.m_bodyList=J.m_next),--this.m_bodyCount},ae._Joint_Create=function(J){switch(J.type){case w.b2JointType.e_distanceJoint:return new Qn(J);case w.b2JointType.e_mouseJoint:return new is(J);case w.b2JointType.e_prismaticJoint:return new ns(J);case w.b2JointType.e_revoluteJoint:return new as(J);case w.b2JointType.e_pulleyJoint:return new ss(J);case w.b2JointType.e_gearJoint:return new ts(J);case w.b2JointType.e_wheelJoint:return new cs(J);case w.b2JointType.e_weldJoint:return new ls(J);case w.b2JointType.e_frictionJoint:return new es(J);case w.b2JointType.e_ropeJoint:return new os(J);case w.b2JointType.e_motorJoint:return new rs(J);case w.b2JointType.e_areaJoint:return new qn(J)}throw new Error},ae._Joint_Destroy=function(){},ae.prototype.CreateJoint=function(J){if(this.IsLocked())throw new Error;var q=ae._Joint_Create(J,null);q.m_prev=null,q.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=q),this.m_jointList=q,++this.m_jointCount,q.m_edgeA.prev=null,q.m_edgeA.next=q.m_bodyA.m_jointList,q.m_bodyA.m_jointList&&(q.m_bodyA.m_jointList.prev=q.m_edgeA),q.m_bodyA.m_jointList=q.m_edgeA,q.m_edgeB.prev=null,q.m_edgeB.next=q.m_bodyB.m_jointList,q.m_bodyB.m_jointList&&(q.m_bodyB.m_jointList.prev=q.m_edgeB),q.m_bodyB.m_jointList=q.m_edgeB;var se=J.bodyA,ve=J.bodyB;if(!J.collideConnected)for(var xe=ve.GetContactList();xe;)xe.other===se&&xe.contact.FlagForFiltering(),xe=xe.next;return q},ae.prototype.DestroyJoint=function(J){if(this.IsLocked())throw new Error;var q=J.m_collideConnected;J.m_prev&&(J.m_prev.m_next=J.m_next),J.m_next&&(J.m_next.m_prev=J.m_prev),J===this.m_jointList&&(this.m_jointList=J.m_next);var se=J.m_bodyA,ve=J.m_bodyB;if(se.SetAwake(!0),ve.SetAwake(!0),J.m_edgeA.prev&&(J.m_edgeA.prev.next=J.m_edgeA.next),J.m_edgeA.next&&(J.m_edgeA.next.prev=J.m_edgeA.prev),J.m_edgeA===se.m_jointList&&(se.m_jointList=J.m_edgeA.next),J.m_edgeA.prev=null,J.m_edgeA.next=null,J.m_edgeB.prev&&(J.m_edgeB.prev.next=J.m_edgeB.next),J.m_edgeB.next&&(J.m_edgeB.next.prev=J.m_edgeB.prev),J.m_edgeB===ve.m_jointList&&(ve.m_jointList=J.m_edgeB.next),J.m_edgeB.prev=null,J.m_edgeB.next=null,ae._Joint_Destroy(J,null),--this.m_jointCount,!q)for(var xe=ve.GetContactList();xe;)xe.other===se&&xe.contact.FlagForFiltering(),xe=xe.next},ae.prototype.CreateParticleSystem=function(J){if(this.IsLocked())throw new Error;var q=new w.b2ParticleSystem(J,this);return q.m_prev=null,q.m_next=this.m_particleSystemList,this.m_particleSystemList&&(this.m_particleSystemList.m_prev=q),this.m_particleSystemList=q,q},ae.prototype.DestroyParticleSystem=function(J){if(this.IsLocked())throw new Error;J.m_prev&&(J.m_prev.m_next=J.m_next),J.m_next&&(J.m_next.m_prev=J.m_prev),J===this.m_particleSystemList&&(this.m_particleSystemList=J.m_next)},ae.prototype.CalculateReasonableParticleIterations=function(J){return this.m_particleSystemList===null?1:bs(this.m_gravity.Length(),function(q){for(var se=A,ve=q.GetParticleSystemList();ve!==null;ve=ve.m_next)se=U(se,ve.GetRadius());return se}(this),J)},ae.prototype.Step=function(J,q,se,ve){ve===void 0&&(ve=this.CalculateReasonableParticleIterations(J));var xe=ae.Step_s_stepTimer.Reset();this.m_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_newFixture=!1),this.m_locked=!0;var Ie=ae.Step_s_step;Ie.dt=J,Ie.velocityIterations=q,Ie.positionIterations=se,Ie.particleIterations=ve,Ie.inv_dt=J>0?1/J:0,Ie.dtRatio=this.m_inv_dt0*J,Ie.warmStarting=this.m_warmStarting;var Me=ae.Step_s_timer.Reset();if(this.m_contactManager.Collide(),this.m_profile.collide=Me.GetMilliseconds(),this.m_stepComplete&&Ie.dt>0){for(var Le=ae.Step_s_timer.Reset(),Ge=this.m_particleSystemList;Ge;Ge=Ge.m_next)Ge.Solve(Ie);this.Solve(Ie),this.m_profile.solve=Le.GetMilliseconds()}if(this.m_continuousPhysics&&Ie.dt>0){var He=ae.Step_s_timer.Reset();this.SolveTOI(Ie),this.m_profile.solveTOI=He.GetMilliseconds()}Ie.dt>0&&(this.m_inv_dt0=Ie.inv_dt),this.m_clearForces&&this.ClearForces(),this.m_locked=!1,this.m_profile.step=xe.GetMilliseconds()},ae.prototype.ClearForces=function(){for(var J=this.m_bodyList;J;J=J.m_next)J.m_force.SetZero(),J.m_torque=0},ae.prototype.DrawParticleSystem=function(J){if(this.m_debugDraw!==null){var q=J.GetParticleCount();if(q){var se=J.GetRadius(),ve=J.GetPositionBuffer();if(J.m_colorBuffer.data){var xe=J.GetColorBuffer();this.m_debugDraw.DrawParticles(ve,se,xe,q)}else this.m_debugDraw.DrawParticles(ve,se,null,q)}}},ae.prototype.DrawDebugData=function(){if(this.m_debugDraw!==null){var J=this.m_debugDraw.GetFlags(),q=ae.DrawDebugData_s_color.SetRGB(0,0,0);if(J&w.b2DrawFlags.e_shapeBit)for(var se=this.m_bodyList;se;se=se.m_next){var ve=se.m_xf;this.m_debugDraw.PushTransform(ve);for(var xe=se.GetFixtureList();xe;xe=xe.m_next)se.IsActive()?se.GetType()===w.b2BodyType.b2_staticBody?(q.SetRGB(.5,.9,.5),this.DrawShape(xe,q)):se.GetType()===w.b2BodyType.b2_kinematicBody?(q.SetRGB(.5,.5,.9),this.DrawShape(xe,q)):se.IsAwake()?(q.SetRGB(.9,.7,.7),this.DrawShape(xe,q)):(q.SetRGB(.6,.6,.6),this.DrawShape(xe,q)):(q.SetRGB(.5,.5,.3),this.DrawShape(xe,q));this.m_debugDraw.PopTransform(ve)}if(J&w.b2DrawFlags.e_particleBit)for(var Ie=this.m_particleSystemList;Ie;Ie=Ie.m_next)this.DrawParticleSystem(Ie);if(J&w.b2DrawFlags.e_jointBit)for(var Me=this.m_jointList;Me;Me=Me.m_next)this.DrawJoint(Me);if(J&w.b2DrawFlags.e_aabbBit){q.SetRGB(.9,.3,.9);var Le=ae.DrawDebugData_s_vs;for(se=this.m_bodyList;se;se=se.m_next)if(se.IsActive())for(xe=se.GetFixtureList();xe;xe=xe.m_next)for(var Ge=0;Ge<xe.m_proxyCount;++Ge){var He=xe.m_proxies[Ge].treeNode.aabb;Le[0].Set(He.lowerBound.x,He.lowerBound.y),Le[1].Set(He.upperBound.x,He.lowerBound.y),Le[2].Set(He.upperBound.x,He.upperBound.y),Le[3].Set(He.lowerBound.x,He.upperBound.y),this.m_debugDraw.DrawPolygon(Le,4,q)}}if(J&w.b2DrawFlags.e_centerOfMassBit)for(se=this.m_bodyList;se;se=se.m_next)(ve=ae.DrawDebugData_s_xf).q.Copy(se.m_xf.q),ve.p.Copy(se.GetWorldCenter()),this.m_debugDraw.DrawTransform(ve);if(J&w.b2DrawFlags.e_controllerBit)for(var Ye=this.m_controllerList;Ye;Ye=Ye.m_next)Ye.Draw(this.m_debugDraw)}},ae.prototype.QueryAABB=function(J,q,se){if(this.m_contactManager.m_broadPhase.Query(q,function(xe){var Ie=xe.userData.fixture;return J?J.ReportFixture(Ie):!se||se(Ie)}),J instanceof Ci)for(var ve=this.m_particleSystemList;ve;ve=ve.m_next)J.ShouldQueryParticleSystem(ve)&&ve.QueryAABB(J,q)},ae.prototype.QueryAllAABB=function(J,q){return q===void 0&&(q=[]),this.QueryAABB(null,J,function(se){return q.push(se),!0}),q},ae.prototype.QueryPointAABB=function(J,q,se){if(this.m_contactManager.m_broadPhase.QueryPoint(q,function(xe){var Ie=xe.userData.fixture;return J?J.ReportFixture(Ie):!se||se(Ie)}),J instanceof Ci)for(var ve=this.m_particleSystemList;ve;ve=ve.m_next)J.ShouldQueryParticleSystem(ve)&&ve.QueryPointAABB(J,q)},ae.prototype.QueryAllPointAABB=function(J,q){return q===void 0&&(q=[]),this.QueryPointAABB(null,J,function(se){return q.push(se),!0}),q},ae.prototype.QueryFixtureShape=function(J,q,se,ve,xe){var Ie=ae.QueryFixtureShape_s_aabb;if(q.ComputeAABB(Ie,ve,se),this.m_contactManager.m_broadPhase.Query(Ie,function(Le){var Ge=Le.userData,He=Ge.fixture;if(Ft(q,se,He.GetShape(),Ge.childIndex,ve,He.GetBody().GetTransform())){if(J)return J.ReportFixture(He);if(xe)return xe(He)}return!0}),J instanceof Ci)for(var Me=this.m_particleSystemList;Me;Me=Me.m_next)J.ShouldQueryParticleSystem(Me)&&Me.QueryAABB(J,Ie)},ae.prototype.QueryAllFixtureShape=function(J,q,se,ve){return ve===void 0&&(ve=[]),this.QueryFixtureShape(null,J,q,se,function(xe){return ve.push(xe),!0}),ve},ae.prototype.QueryFixturePoint=function(J,q,se){if(this.m_contactManager.m_broadPhase.QueryPoint(q,function(xe){var Ie=xe.userData.fixture;if(Ie.TestPoint(q)){if(J)return J.ReportFixture(Ie);if(se)return se(Ie)}return!0}),J)for(var ve=this.m_particleSystemList;ve;ve=ve.m_next)J.ShouldQueryParticleSystem(ve)&&ve.QueryPointAABB(J,q)},ae.prototype.QueryAllFixturePoint=function(J,q){return q===void 0&&(q=[]),this.QueryFixturePoint(null,J,function(se){return q.push(se),!0}),q},ae.prototype.RayCast=function(J,q,se,ve){var xe=ae.RayCast_s_input;if(xe.maxFraction=1,xe.p1.Copy(q),xe.p2.Copy(se),this.m_contactManager.m_broadPhase.RayCast(xe,function(Me,Le){var Ge=Le.userData,He=Ge.fixture,Ye=Ge.childIndex,Je=ae.RayCast_s_output;if(He.RayCast(Je,Me,Ye)){var ze=Je.fraction,Ke=ae.RayCast_s_point;if(Ke.Set((1-ze)*q.x+ze*se.x,(1-ze)*q.y+ze*se.y),J)return J.ReportFixture(He,Ke,Je.normal,ze);if(ve)return ve(He,Ke,Je.normal,ze)}return Me.maxFraction}),J)for(var Ie=this.m_particleSystemList;Ie;Ie=Ie.m_next)J.ShouldQueryParticleSystem(Ie)&&Ie.RayCast(J,q,se)},ae.prototype.RayCastOne=function(J,q){var se=null,ve=1;return this.RayCast(null,J,q,function(xe,Ie,Me,Le){return Le<ve&&(ve=Le,se=xe),ve}),se},ae.prototype.RayCastAll=function(J,q,se){return se===void 0&&(se=[]),this.RayCast(null,J,q,function(ve){return se.push(ve),1}),se},ae.prototype.GetBodyList=function(){return this.m_bodyList},ae.prototype.GetJointList=function(){return this.m_jointList},ae.prototype.GetParticleSystemList=function(){return this.m_particleSystemList},ae.prototype.GetContactList=function(){return this.m_contactManager.m_contactList},ae.prototype.SetAllowSleeping=function(J){if(J!==this.m_allowSleep&&(this.m_allowSleep=J,!this.m_allowSleep))for(var q=this.m_bodyList;q;q=q.m_next)q.SetAwake(!0)},ae.prototype.GetAllowSleeping=function(){return this.m_allowSleep},ae.prototype.SetWarmStarting=function(J){this.m_warmStarting=J},ae.prototype.GetWarmStarting=function(){return this.m_warmStarting},ae.prototype.SetContinuousPhysics=function(J){this.m_continuousPhysics=J},ae.prototype.GetContinuousPhysics=function(){return this.m_continuousPhysics},ae.prototype.SetSubStepping=function(J){this.m_subStepping=J},ae.prototype.GetSubStepping=function(){return this.m_subStepping},ae.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},ae.prototype.GetBodyCount=function(){return this.m_bodyCount},ae.prototype.GetJointCount=function(){return this.m_jointCount},ae.prototype.GetContactCount=function(){return this.m_contactManager.m_contactCount},ae.prototype.GetTreeHeight=function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()},ae.prototype.GetTreeBalance=function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()},ae.prototype.GetTreeQuality=function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()},ae.prototype.SetGravity=function(J,q){if(q===void 0&&(q=!0),!K.IsEqualToV(this.m_gravity,J)&&(this.m_gravity.Copy(J),q))for(var se=this.m_bodyList;se;se=se.m_next)se.SetAwake(!0)},ae.prototype.GetGravity=function(){return this.m_gravity},ae.prototype.IsLocked=function(){return this.m_locked},ae.prototype.SetAutoClearForces=function(J){this.m_clearForces=J},ae.prototype.GetAutoClearForces=function(){return this.m_clearForces},ae.prototype.ShiftOrigin=function(J){if(this.IsLocked())throw new Error;for(var q=this.m_bodyList;q;q=q.m_next)q.m_xf.p.SelfSub(J),q.m_sweep.c0.SelfSub(J),q.m_sweep.c.SelfSub(J);for(var se=this.m_jointList;se;se=se.m_next)se.ShiftOrigin(J);this.m_contactManager.m_broadPhase.ShiftOrigin(J)},ae.prototype.GetContactManager=function(){return this.m_contactManager},ae.prototype.GetProfile=function(){return this.m_profile},ae.prototype.Dump=function(J){if(!this.m_locked){J("const g: b2Vec2 = new b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y),J("this.m_world.SetGravity(g);\n"),J("const bodies: b2Body[] = [];\n"),J("const joints: b2Joint[] = [];\n");for(var q=0,se=this.m_bodyList;se;se=se.m_next)se.m_islandIndex=q,se.Dump(J),++q;q=0;for(var ve=this.m_jointList;ve;ve=ve.m_next)ve.m_index=q,++q;for(ve=this.m_jointList;ve;ve=ve.m_next)ve.m_type!==w.b2JointType.e_gearJoint&&(J("{\n"),ve.Dump(J),J("}\n"));for(ve=this.m_jointList;ve;ve=ve.m_next)ve.m_type===w.b2JointType.e_gearJoint&&(J("{\n"),ve.Dump(J),J("}\n"))}},ae.prototype.DrawJoint=function(J){if(this.m_debugDraw!==null){var q=J.GetBodyA(),se=J.GetBodyB(),ve=q.m_xf,xe=se.m_xf,Ie=ve.p,Me=xe.p,Le=J.GetAnchorA(ae.DrawJoint_s_p1),Ge=J.GetAnchorB(ae.DrawJoint_s_p2),He=ae.DrawJoint_s_color.SetRGB(.5,.8,.8);switch(J.m_type){case w.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(Le,Ge,He);break;case w.b2JointType.e_pulleyJoint:var Ye=J,Je=Ye.GetGroundAnchorA(),ze=Ye.GetGroundAnchorB();this.m_debugDraw.DrawSegment(Je,Le,He),this.m_debugDraw.DrawSegment(ze,Ge,He),this.m_debugDraw.DrawSegment(Je,ze,He);break;case w.b2JointType.e_mouseJoint:var Ke=ae.DrawJoint_s_c;Ke.Set(0,1,0),this.m_debugDraw.DrawPoint(Le,4,Ke),this.m_debugDraw.DrawPoint(Ge,4,Ke),Ke.Set(.8,.8,.8),this.m_debugDraw.DrawSegment(Le,Ge,Ke);break;default:this.m_debugDraw.DrawSegment(Ie,Le,He),this.m_debugDraw.DrawSegment(Le,Ge,He),this.m_debugDraw.DrawSegment(Me,Ge,He)}}},ae.prototype.DrawShape=function(J,q){if(this.m_debugDraw!==null){var se=J.GetShape();switch(se.m_type){case w.b2ShapeType.e_circleShape:var ve=se,xe=ve.m_p,Ie=ve.m_radius,Me=K.UNITX;this.m_debugDraw.DrawSolidCircle(xe,Ie,Me,q);break;case w.b2ShapeType.e_edgeShape:var Le=se,Ge=Le.m_vertex1,He=Le.m_vertex2;this.m_debugDraw.DrawSegment(Ge,He,q);break;case w.b2ShapeType.e_chainShape:var Ye=se,Je=Ye.m_count,ze=Ye.m_vertices,Ke=ae.DrawShape_s_ghostColor.SetRGBA(.75*q.r,.75*q.g,.75*q.b,q.a);if(Ge=ze[0],this.m_debugDraw.DrawPoint(Ge,4,q),Ye.m_hasPrevVertex){var et=Ye.m_prevVertex;this.m_debugDraw.DrawSegment(et,Ge,Ke),this.m_debugDraw.DrawCircle(et,.1,Ke)}for(var it=1;it<Je;++it)He=ze[it],this.m_debugDraw.DrawSegment(Ge,He,q),this.m_debugDraw.DrawPoint(He,4,q),Ge=He;if(Ye.m_hasNextVertex){var ct=Ye.m_nextVertex;this.m_debugDraw.DrawSegment(ct,Ge,Ke),this.m_debugDraw.DrawCircle(ct,.1,Ke)}break;case w.b2ShapeType.e_polygonShape:var mt=se,vt=mt.m_count;ze=mt.m_vertices,this.m_debugDraw.DrawSolidPolygon(ze,vt,q)}}},ae.prototype.Solve=function(J){for(var q=this.m_bodyList;q;q=q.m_next)q.m_xf0.Copy(q.m_xf);for(var se=this.m_controllerList;se;se=se.m_next)se.Step(J);this.m_profile.solveInit=0,this.m_profile.solveVelocity=0,this.m_profile.solvePosition=0;var ve=this.m_island;for(ve.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener),q=this.m_bodyList;q;q=q.m_next)q.m_islandFlag=!1;for(var xe=this.m_contactManager.m_contactList;xe;xe=xe.m_next)xe.m_islandFlag=!1;for(var Ie=this.m_jointList;Ie;Ie=Ie.m_next)Ie.m_islandFlag=!1;for(var Me=this.s_stack,Le=this.m_bodyList;Le;Le=Le.m_next)if(!Le.m_islandFlag&&Le.IsAwake()&&Le.IsActive()&&Le.GetType()!==w.b2BodyType.b2_staticBody){ve.Clear();var Ge=0;for(Me[Ge++]=Le,Le.m_islandFlag=!0;Ge>0;){if(!(q=Me[--Ge]))throw new Error;if(ve.AddBody(q),q.m_awakeFlag=!0,q.GetType()!==w.b2BodyType.b2_staticBody){for(var He=q.m_contactList;He;He=He.next){var Ye=He.contact;if(!Ye.m_islandFlag&&Ye.IsEnabled()&&Ye.IsTouching()){var Je=Ye.m_fixtureA.m_isSensor,ze=Ye.m_fixtureB.m_isSensor;if(!Je&&!ze){if(ve.AddContact(Ye),Ye.m_islandFlag=!0,!(et=He.other))throw new Error;et.m_islandFlag||(Me[Ge++]=et,et.m_islandFlag=!0)}}}for(var Ke=q.m_jointList;Ke;Ke=Ke.next){var et;Ke.joint.m_islandFlag||(et=Ke.other).IsActive()&&(ve.AddJoint(Ke.joint),Ke.joint.m_islandFlag=!0,et.m_islandFlag||(Me[Ge++]=et,et.m_islandFlag=!0))}}}var it=new An;ve.Solve(it,J,this.m_gravity,this.m_allowSleep),this.m_profile.solveInit+=it.solveInit,this.m_profile.solveVelocity+=it.solveVelocity,this.m_profile.solvePosition+=it.solvePosition;for(var ct=0;ct<ve.m_bodyCount;++ct)(q=ve.m_bodies[ct]).GetType()===w.b2BodyType.b2_staticBody&&(q.m_islandFlag=!1)}for(ct=0;ct<Me.length&&Me[ct];++ct)Me[ct]=null;var mt=new we;for(q=this.m_bodyList;q;q=q.m_next)q.m_islandFlag&&q.GetType()!==w.b2BodyType.b2_staticBody&&q.SynchronizeFixtures();this.m_contactManager.FindNewContacts(),this.m_profile.broadphase=mt.GetMilliseconds()},ae.prototype.SolveTOI=function(J){var q=this.m_island;if(q.Initialize(64,32,0,null,this.m_contactManager.m_contactListener),this.m_stepComplete){for(var se=this.m_bodyList;se;se=se.m_next)se.m_islandFlag=!1,se.m_sweep.alpha0=0;for(var ve=this.m_contactManager.m_contactList;ve;ve=ve.m_next)ve.m_toiFlag=!1,ve.m_islandFlag=!1,ve.m_toiCount=0,ve.m_toi=1}for(;;){var xe=null,Ie=1;for(ve=this.m_contactManager.m_contactList;ve;ve=ve.m_next)if(ve.IsEnabled()&&!(ve.m_toiCount>8)){var Me=1;if(ve.m_toiFlag)Me=ve.m_toi;else{var Le=ve.GetFixtureA(),Ge=ve.GetFixtureB();if(Le.IsSensor()||Ge.IsSensor())continue;var He=Le.GetBody(),Ye=Ge.GetBody(),Je=He.m_type,ze=Ye.m_type,Ke=He.IsAwake()&&Je!==w.b2BodyType.b2_staticBody,et=Ye.IsAwake()&&ze!==w.b2BodyType.b2_staticBody;if(!Ke&&!et)continue;var it=He.IsBullet()||Je!==w.b2BodyType.b2_dynamicBody,ct=Ye.IsBullet()||ze!==w.b2BodyType.b2_dynamicBody;if(!it&&!ct)continue;var mt=He.m_sweep.alpha0;He.m_sweep.alpha0<Ye.m_sweep.alpha0?(mt=Ye.m_sweep.alpha0,He.m_sweep.Advance(mt)):Ye.m_sweep.alpha0<He.m_sweep.alpha0&&(mt=He.m_sweep.alpha0,Ye.m_sweep.Advance(mt));var vt=ve.GetChildIndexA(),Tt=ve.GetChildIndexB(),wt=ae.SolveTOI_s_toi_input;wt.proxyA.SetShape(Le.GetShape(),vt),wt.proxyB.SetShape(Ge.GetShape(),Tt),wt.sweepA.Copy(He.m_sweep),wt.sweepB.Copy(Ye.m_sweep),wt.tMax=1;var Pt=ae.SolveTOI_s_toi_output;Dr(Pt,wt);var Bt=Pt.t;Me=Pt.state===w.b2TOIOutputState.e_touching?U(mt+(1-mt)*Bt,1):1,ve.m_toi=Me,ve.m_toiFlag=!0}Me<Ie&&(xe=ve,Ie=Me)}if(xe===null||1-10*O<Ie){this.m_stepComplete=!0;break}var jt=xe.GetFixtureA(),Xt=xe.GetFixtureB(),Ht=jt.GetBody(),$t=Xt.GetBody(),Qt=ae.SolveTOI_s_backup1.Copy(Ht.m_sweep),ur=ae.SolveTOI_s_backup2.Copy($t.m_sweep);if(Ht.Advance(Ie),$t.Advance(Ie),xe.Update(this.m_contactManager.m_contactListener),xe.m_toiFlag=!1,++xe.m_toiCount,xe.IsEnabled()&&xe.IsTouching()){Ht.SetAwake(!0),$t.SetAwake(!0),q.Clear(),q.AddBody(Ht),q.AddBody($t),q.AddContact(xe),Ht.m_islandFlag=!0,$t.m_islandFlag=!0,xe.m_islandFlag=!0;for(var tr=0;tr<2;++tr)if((yr=tr===0?Ht:$t).m_type===w.b2BodyType.b2_dynamicBody)for(var qt=yr.m_contactList;qt&&q.m_bodyCount!==q.m_bodyCapacity&&q.m_contactCount!==q.m_contactCapacity;qt=qt.next){var ar=qt.contact;if(!ar.m_islandFlag){var or=qt.other;if(or.m_type!==w.b2BodyType.b2_dynamicBody||yr.IsBullet()||or.IsBullet()){var vr=ar.m_fixtureA.m_isSensor,mr=ar.m_fixtureB.m_isSensor;if(!vr&&!mr){var wr=ae.SolveTOI_s_backup.Copy(or.m_sweep);or.m_islandFlag||or.Advance(Ie),ar.Update(this.m_contactManager.m_contactListener),ar.IsEnabled()&&ar.IsTouching()?(ar.m_islandFlag=!0,q.AddContact(ar),or.m_islandFlag||(or.m_islandFlag=!0,or.m_type!==w.b2BodyType.b2_staticBody&&or.SetAwake(!0),q.AddBody(or))):(or.m_sweep.Copy(wr),or.SynchronizeTransform())}}}}var Tr=ae.SolveTOI_s_subStep;for(Tr.dt=(1-Ie)*J.dt,Tr.inv_dt=1/Tr.dt,Tr.dtRatio=1,Tr.positionIterations=20,Tr.velocityIterations=J.velocityIterations,Tr.particleIterations=J.particleIterations,Tr.warmStarting=!1,q.SolveTOI(Tr,Ht.m_islandIndex,$t.m_islandIndex),tr=0;tr<q.m_bodyCount;++tr){var yr;if((yr=q.m_bodies[tr]).m_islandFlag=!1,yr.m_type===w.b2BodyType.b2_dynamicBody)for(yr.SynchronizeFixtures(),qt=yr.m_contactList;qt;qt=qt.next)qt.contact.m_toiFlag=!1,qt.contact.m_islandFlag=!1}if(this.m_contactManager.FindNewContacts(),this.m_subStepping){this.m_stepComplete=!1;break}}else xe.SetEnabled(!1),Ht.m_sweep.Copy(Qt),$t.m_sweep.Copy(ur),Ht.SynchronizeTransform(),$t.SynchronizeTransform()}},ae.prototype.AddController=function(J){return J.m_next=this.m_controllerList,J.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=J),this.m_controllerList=J,++this.m_controllerCount,J},ae.prototype.RemoveController=function(J){return J.m_prev&&(J.m_prev.m_next=J.m_next),J.m_next&&(J.m_next.m_prev=J.m_prev),this.m_controllerList===J&&(this.m_controllerList=J.m_next),--this.m_controllerCount,J.m_prev=null,J.m_next=null,J},ae.Step_s_step=new fi,ae.Step_s_stepTimer=new we,ae.Step_s_timer=new we,ae.DrawDebugData_s_color=new ye(0,0,0),ae.DrawDebugData_s_vs=K.MakeArray(4),ae.DrawDebugData_s_xf=new de,ae.QueryFixtureShape_s_aabb=new Ot,ae.RayCast_s_input=new Et,ae.RayCast_s_output=new Lt,ae.RayCast_s_point=new K,ae.DrawJoint_s_p1=new K,ae.DrawJoint_s_p2=new K,ae.DrawJoint_s_color=new ye(.5,.8,.8),ae.DrawJoint_s_c=new ye,ae.DrawShape_s_ghostColor=new ye,ae.SolveTOI_s_subStep=new fi,ae.SolveTOI_s_backup=new me,ae.SolveTOI_s_backup1=new me,ae.SolveTOI_s_backup2=new me,ae.SolveTOI_s_toi_input=new Rt,ae.SolveTOI_s_toi_output=new Mt,ae}(),Os=function(ae,J){this.prevBody=null,this.nextBody=null,this.prevController=null,this.nextController=null,this.controller=ae,this.body=J},Ti=function(){function ae(){this.m_bodyList=null,this.m_bodyCount=0,this.m_prev=null,this.m_next=null}return ae.prototype.GetNext=function(){return this.m_next},ae.prototype.GetPrev=function(){return this.m_prev},ae.prototype.GetBodyList=function(){return this.m_bodyList},ae.prototype.AddBody=function(J){var q=new Os(this,J);q.nextBody=this.m_bodyList,q.prevBody=null,this.m_bodyList&&(this.m_bodyList.prevBody=q),this.m_bodyList=q,++this.m_bodyCount,q.nextController=J.m_controllerList,q.prevController=null,J.m_controllerList&&(J.m_controllerList.prevController=q),J.m_controllerList=q,++J.m_controllerCount},ae.prototype.RemoveBody=function(J){if(this.m_bodyCount<=0)throw new Error;for(var q=this.m_bodyList;q&&q.body!==J;)q=q.nextBody;if(q===null)throw new Error;q.prevBody&&(q.prevBody.nextBody=q.nextBody),q.nextBody&&(q.nextBody.prevBody=q.prevBody),this.m_bodyList===q&&(this.m_bodyList=q.nextBody),--this.m_bodyCount,q.nextController&&(q.nextController.prevController=q.prevController),q.prevController&&(q.prevController.nextController=q.nextController),J.m_controllerList===q&&(J.m_controllerList=q.nextController),--J.m_controllerCount},ae.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0},ae}(),oo=function(ae){function J(){var q=ae!==null&&ae.apply(this,arguments)||this;return q.normal=new K(0,1),q.offset=0,q.density=0,q.velocity=new K(0,0),q.linearDrag=0,q.angularDrag=0,q.useDensity=!1,q.useWorldGravity=!0,q.gravity=new K(0,0),q}return sr(J,ae),J.prototype.Step=function(){if(this.m_bodyList){this.useWorldGravity&&this.gravity.Copy(this.m_bodyList.body.GetWorld().GetGravity());for(var q=this.m_bodyList;q;q=q.nextBody){var se=q.body;if(se.IsAwake()){for(var ve=new K,xe=new K,Ie=0,Me=0,Le=se.GetFixtureList();Le;Le=Le.m_next){var Ge=new K,He=Le.GetShape().ComputeSubmergedArea(this.normal,this.offset,se.GetTransform(),Ge);Ie+=He,ve.x+=He*Ge.x,ve.y+=He*Ge.y;var Ye;Me+=He*(Ye=this.useDensity?Le.GetDensity():1),xe.x+=He*Ge.x*Ye,xe.y+=He*Ge.y*Ye}if(ve.x/=Ie,ve.y/=Ie,xe.x/=Me,xe.y/=Me,!(Ie<O)){var Je=this.gravity.Clone().SelfNeg();Je.SelfMul(this.density*Ie),se.ApplyForce(Je,xe);var ze=se.GetLinearVelocityFromWorldPoint(ve,new K);ze.SelfSub(this.velocity),ze.SelfMul(-this.linearDrag*Ie),se.ApplyForce(ze,ve),se.ApplyTorque(-se.GetInertia()/se.GetMass()*Ie*se.GetAngularVelocity()*this.angularDrag)}}}}},J.prototype.Draw=function(q){var se=100,ve=new K,xe=new K;ve.x=this.normal.x*this.offset+this.normal.y*se,ve.y=this.normal.y*this.offset-this.normal.x*se,xe.x=this.normal.x*this.offset-this.normal.y*se,xe.y=this.normal.y*this.offset+this.normal.x*se;var Ie=new ye(0,0,.8);q.DrawSegment(ve,xe,Ie)},J}(Ti),lo=function(ae){function J(){var q=ae!==null&&ae.apply(this,arguments)||this;return q.A=new K(0,0),q}return sr(J,ae),J.prototype.Step=function(q){for(var se=K.MulSV(q.dt,this.A,J.Step_s_dtA),ve=this.m_bodyList;ve;ve=ve.nextBody){var xe=ve.body;xe.IsAwake()&&xe.SetLinearVelocity(K.AddVV(xe.GetLinearVelocity(),se,K.s_t0))}},J.prototype.Draw=function(){},J.Step_s_dtA=new K,J}(Ti),co=function(ae){function J(){var q=ae!==null&&ae.apply(this,arguments)||this;return q.F=new K(0,0),q}return sr(J,ae),J.prototype.Step=function(){for(var q=this.m_bodyList;q;q=q.nextBody){var se=q.body;se.IsAwake()&&se.ApplyForce(this.F,se.GetWorldCenter())}},J.prototype.Draw=function(){},J}(Ti),uo=function(ae){function J(){var q=ae!==null&&ae.apply(this,arguments)||this;return q.G=1,q.invSqr=!0,q}return sr(J,ae),J.prototype.Step=function(){if(this.invSqr)for(var q=this.m_bodyList;q;q=q.nextBody)for(var se=(Le=q.body).GetWorldCenter(),ve=Le.GetMass(),xe=this.m_bodyList;xe&&xe!==q;xe=xe.nextBody){var Ie=(Ge=xe.body).GetWorldCenter(),Me=Ge.GetMass();(Je=(He=Ie.x-se.x)*He+(Ye=Ie.y-se.y)*Ye)<O||((ze=J.Step_s_f.Set(He,Ye)).SelfMul(this.G/Je/ee(Je)*ve*Me),Le.IsAwake()&&Le.ApplyForce(ze,se),Ge.IsAwake()&&Ge.ApplyForce(ze.SelfMul(-1),Ie))}else for(q=this.m_bodyList;q;q=q.nextBody){var Le;for(se=(Le=q.body).GetWorldCenter(),ve=Le.GetMass(),xe=this.m_bodyList;xe&&xe!==q;xe=xe.nextBody){var Ge,He,Ye,Je,ze;Ie=(Ge=xe.body).GetWorldCenter(),Me=Ge.GetMass(),(Je=(He=Ie.x-se.x)*He+(Ye=Ie.y-se.y)*Ye)<O||((ze=J.Step_s_f.Set(He,Ye)).SelfMul(this.G/Je*ve*Me),Le.IsAwake()&&Le.ApplyForce(ze,se),Ge.IsAwake()&&Ge.ApplyForce(ze.SelfMul(-1),Ie))}}},J.prototype.Draw=function(){},J.Step_s_f=new K,J}(Ti),ho=function(ae){function J(){var q=ae!==null&&ae.apply(this,arguments)||this;return q.T=new ce,q.maxTimestep=0,q}return sr(J,ae),J.prototype.Step=function(q){var se=q.dt;if(!(se<=O)){se>this.maxTimestep&&this.maxTimestep>0&&(se=this.maxTimestep);for(var ve=this.m_bodyList;ve;ve=ve.nextBody){var xe=ve.body;if(xe.IsAwake()){var Ie=xe.GetWorldVector(ce.MulMV(this.T,xe.GetLocalVector(xe.GetLinearVelocity(),K.s_t0),K.s_t1),J.Step_s_damping);xe.SetLinearVelocity(K.AddVV(xe.GetLinearVelocity(),K.MulSV(se,Ie,K.s_t0),K.s_t1))}}}},J.prototype.Draw=function(){},J.prototype.SetAxisAligned=function(q,se){this.T.ex.x=-q,this.T.ex.y=0,this.T.ey.x=0,this.T.ey.y=-se,this.maxTimestep=q>0||se>0?1/X(q,se):0},J.Step_s_damping=new K,J}(Ti),fo=function(){function ae(){this.m_count=0,this.m_ps=[],this.m_p0s=[],this.m_vs=[],this.m_ims=[],this.m_Ls=[],this.m_as=[],this.m_gravity=new K,this.m_damping=0,this.m_k2=1,this.m_k3=.1}return ae.prototype.GetVertexCount=function(){return this.m_count},ae.prototype.GetVertices=function(){return this.m_ps},ae.prototype.Initialize=function(J){this.m_count=J.count,this.m_ps=K.MakeArray(this.m_count),this.m_p0s=K.MakeArray(this.m_count),this.m_vs=K.MakeArray(this.m_count),this.m_ims=j(this.m_count);for(var q=0;q<this.m_count;++q){this.m_ps[q].Copy(J.vertices[q]),this.m_p0s[q].Copy(J.vertices[q]),this.m_vs[q].SetZero();var se=J.masses[q];this.m_ims[q]=se>0?1/se:0}var ve=this.m_count-1,xe=this.m_count-2;for(this.m_Ls=j(ve),this.m_as=j(xe),q=0;q<ve;++q){var Ie=this.m_ps[q],Me=this.m_ps[q+1];this.m_Ls[q]=K.DistanceVV(Ie,Me)}for(q=0;q<xe;++q){Ie=this.m_ps[q],Me=this.m_ps[q+1];var Le=this.m_ps[q+2],Ge=K.SubVV(Me,Ie,K.s_t0),He=K.SubVV(Le,Me,K.s_t1),Ye=K.CrossVV(Ge,He),Je=K.DotVV(Ge,He);this.m_as[q]=pe(Ye,Je)}this.m_gravity.Copy(J.gravity),this.m_damping=J.damping,this.m_k2=J.k2,this.m_k3=J.k3},ae.prototype.Step=function(J,q){if(J!==0){for(var se=Math.exp(-J*this.m_damping),ve=0;ve<this.m_count;++ve)this.m_p0s[ve].Copy(this.m_ps[ve]),this.m_ims[ve]>0&&this.m_vs[ve].SelfMulAdd(J,this.m_gravity),this.m_vs[ve].SelfMul(se),this.m_ps[ve].SelfMulAdd(J,this.m_vs[ve]);for(ve=0;ve<q;++ve)this.SolveC2(),this.SolveC3(),this.SolveC2();var xe=1/J;for(ve=0;ve<this.m_count;++ve)K.MulSV(xe,K.SubVV(this.m_ps[ve],this.m_p0s[ve],K.s_t0),this.m_vs[ve])}},ae.prototype.SolveC2=function(){for(var J=this.m_count-1,q=0;q<J;++q){var se=this.m_ps[q],ve=this.m_ps[q+1],xe=K.SubVV(ve,se,ae.s_d),Ie=xe.Normalize(),Me=this.m_ims[q],Le=this.m_ims[q+1];if(Me+Le!==0){var Ge=Me/(Me+Le),He=Le/(Me+Le);se.SelfMulSub(this.m_k2*Ge*(this.m_Ls[q]-Ie),xe),ve.SelfMulAdd(this.m_k2*He*(this.m_Ls[q]-Ie),xe)}}},ae.prototype.SetAngle=function(J){for(var q=this.m_count-2,se=0;se<q;++se)this.m_as[se]=J},ae.prototype.SolveC3=function(){for(var J=this.m_count-2,q=0;q<J;++q){var se=this.m_ps[q],ve=this.m_ps[q+1],xe=this.m_ps[q+2],Ie=this.m_ims[q],Me=this.m_ims[q+1],Le=this.m_ims[q+2],Ge=K.SubVV(ve,se,ae.s_d1),He=K.SubVV(xe,ve,ae.s_d2),Ye=Ge.LengthSquared(),Je=He.LengthSquared();if(Ye*Je!=0){var ze=K.CrossVV(Ge,He),Ke=K.DotVV(Ge,He),et=pe(ze,Ke),it=K.MulSV(-1/Ye,Ge.SelfSkew(),ae.s_Jd1),ct=K.MulSV(1/Je,He.SelfSkew(),ae.s_Jd2),mt=K.NegV(it,ae.s_J1),vt=K.SubVV(it,ct,ae.s_J2),Tt=ct,wt=Ie*K.DotVV(mt,mt)+Me*K.DotVV(vt,vt)+Le*K.DotVV(Tt,Tt);if(wt!==0){wt=1/wt;for(var Pt=et-this.m_as[q];Pt>P;)Pt=(et-=2*P)-this.m_as[q];for(;Pt<-P;)Pt=(et+=2*P)-this.m_as[q];var Bt=-this.m_k3*wt*Pt;se.SelfMulAdd(Ie*Bt,mt),ve.SelfMulAdd(Me*Bt,vt),xe.SelfMulAdd(Le*Bt,Tt)}}}},ae.prototype.Draw=function(J){for(var q=new ye(.4,.5,.7),se=0;se<this.m_count-1;++se)J.DrawSegment(this.m_ps[se],this.m_ps[se+1],q)},ae.s_d=new K,ae.s_d1=new K,ae.s_d2=new K,ae.s_Jd1=new K,ae.s_Jd2=new K,ae.s_J1=new K,ae.s_J2=new K,ae}();w.b2Assert=function(ae){for(var J=[],q=1;q<arguments.length;q++)J[q-1]=arguments[q];if(!ae)throw new(Error.bind.apply(Error,[void 0].concat(J)))},w.b2Maybe=B,w.b2_maxFloat=A,w.b2_epsilon=O,w.b2_epsilon_sq=R,w.b2_pi=P,w.b2_maxManifoldPoints=E,w.b2_maxPolygonVertices=D,w.b2_aabbExtension=.1,w.b2_aabbMultiplier=2,w.b2_linearSlop=I,w.b2_angularSlop=M,w.b2_polygonRadius=N,w.b2_maxSubSteps=8,w.b2_maxTOIContacts=32,w.b2_velocityThreshold=1,w.b2_maxLinearCorrection=.2,w.b2_maxAngularCorrection=.13962634015955555,w.b2_maxTranslation=2,w.b2_maxTranslationSquared=4,w.b2_maxRotation=1.570796326795,w.b2_maxRotationSquared=2.4674011002726646,w.b2_baumgarte=.2,w.b2_toiBaumgarte=.75,w.b2_invalidParticleIndex=k,w.b2_maxParticleIndex=2147483647,w.b2_particleStride=.75,w.b2_minParticleWeight=1,w.b2_maxParticlePressure=.25,w.b2_maxParticleForce=.5,w.b2_maxTriadDistance=2,w.b2_maxTriadDistanceSquared=4,w.b2_minParticleSystemBufferCapacity=256,w.b2_barrierCollisionTime=2.5,w.b2_timeToSleep=.5,w.b2_linearSleepTolerance=.01,w.b2_angularSleepTolerance=.03490658503988889,w.b2Alloc=function(){return null},w.b2Free=function(){},w.b2Log=function(ae){for(var J=[],q=1;q<arguments.length;q++)J[q-1]=arguments[q]},w.b2Version=F,w.b2_version=G,w.b2_branch="master",w.b2_commit="fbf51801d80fc389d43dc46524520e89043b6faf",w.b2ParseInt=function(ae){return parseInt(ae,10)},w.b2ParseUInt=function(ae){return Math.abs(parseInt(ae,10))},w.b2MakeArray=V,w.b2MakeNullArray=function(ae){for(var J=[],q=0;q<ae;++q)J.push(null);return J},w.b2MakeNumberArray=j,w.b2_pi_over_180=.017453292519944444,w.b2_180_over_pi=57.29577951307855,w.b2_two_pi=6.28318530718,w.b2Abs=H,w.b2Min=U,w.b2Max=X,w.b2Clamp=Y,w.b2Swap=function(ae,J){var q=ae[0];ae[0]=J[0],J[0]=q},w.b2IsValid=z,w.b2Sq=W,w.b2InvSqrt=Z,w.b2Sqrt=ee,w.b2Pow=te,w.b2DegToRad=function(ae){return .017453292519944444*ae},w.b2RadToDeg=function(ae){return 57.29577951307855*ae},w.b2Cos=re,w.b2Sin=ie,w.b2Acos=ne,w.b2Asin=he,w.b2Atan2=pe,w.b2NextPowerOfTwo=function(ae){return ae|=ae>>1&2147483647,ae|=ae>>2&1073741823,ae|=ae>>4&268435455,1+((ae|=ae>>8&16777215)|ae>>16&65535)},w.b2IsPowerOfTwo=function(ae){return ae>0&&(ae&ae-1)==0},w.b2Random=function(){return 2*Math.random()-1},w.b2RandomRange=function(ae,J){return(J-ae)*Math.random()+ae},w.b2Vec2=K,w.b2Vec2_zero=ue,w.b2Vec3=le,w.b2Mat22=ce,w.b2Mat33=_e,w.b2Rot=oe,w.b2Transform=de,w.b2Sweep=me,w.b2Color=ye,w.b2Draw=ge,w.b2Timer=we,w.b2Counter=Te,w.b2GrowableStack=Ee,w.b2BlockAllocator=function(){},w.b2StackAllocator=function(){},w.b2ContactFeature=Qe,w.b2ContactID=st,w.b2ManifoldPoint=pt,w.b2Manifold=rt,w.b2WorldManifold=bt,w.b2GetPointStates=function(ae,J,q,se){var ve;for(ve=0;ve<q.pointCount;++ve){var xe=q.points[ve].id.key;ae[ve]=w.b2PointState.b2_removeState;for(var Ie=0,Me=se.pointCount;Ie<Me;++Ie)if(se.points[Ie].id.key===xe){ae[ve]=w.b2PointState.b2_persistState;break}}for(;ve<E;++ve)ae[ve]=w.b2PointState.b2_nullState;for(ve=0;ve<se.pointCount;++ve)for(xe=se.points[ve].id.key,J[ve]=w.b2PointState.b2_addState,Ie=0,Me=q.pointCount;Ie<Me;++Ie)if(q.points[Ie].id.key===xe){J[ve]=w.b2PointState.b2_persistState;break}for(;ve<E;++ve)J[ve]=w.b2PointState.b2_nullState},w.b2ClipVertex=Dt,w.b2RayCastInput=Et,w.b2RayCastOutput=Lt,w.b2AABB=Ot,w.b2TestOverlapAABB=Kt,w.b2ClipSegmentToLine=Jt,w.b2TestOverlapShape=Ft,w.b2DistanceProxy=De,w.b2SimplexCache=fe,w.b2DistanceInput=Ce,w.b2DistanceOutput=Se,w.b2ShapeCastInput=function(){this.proxyA=new De,this.proxyB=new De,this.transformA=new de,this.transformB=new de,this.translationB=new K},w.b2ShapeCastOutput=function(){this.point=new K,this.normal=new K,this.lambda=0,this.iterations=0},w.b2_gjk_reset=function(){w.b2_gjkCalls=0,w.b2_gjkIters=0,w.b2_gjkMaxIters=0},w.b2SimplexVertex=be,w.b2Simplex=Re,w.b2Distance=Ze,w.b2ShapeCast=function(ae,J){ae.iterations=0,ae.lambda=1,ae.normal.SetZero(),ae.point.SetZero();var q=J.proxyA,se=J.proxyB,ve=X(q.m_radius,N)+X(se.m_radius,N),xe=J.transformA,Ie=J.transformB,Me=J.translationB,Le=$e.Set(0,0),Ge=0,He=ot;He.m_count=0;for(var Ye=He.m_vertices,Je=q.GetSupport(oe.MulTRV(xe.q,K.NegV(Me,K.s_t1),K.s_t0)),ze=de.MulXV(xe,q.GetVertex(Je),ut),Ke=se.GetSupport(oe.MulTRV(Ie.q,Me,K.s_t0)),et=de.MulXV(Ie,se.GetVertex(Ke),gt),it=K.SubVV(ze,et,Ue),ct=X(N,ve-N),mt=.5*I,vt=0;vt<20&&H(it.Length()-ct)>mt;){ae.iterations+=1,Je=q.GetSupport(oe.MulTRV(xe.q,K.NegV(it,K.s_t1),K.s_t0)),ze=de.MulXV(xe,q.GetVertex(Je),ut),Ke=se.GetSupport(oe.MulTRV(Ie.q,it,K.s_t0)),et=de.MulXV(Ie,se.GetVertex(Ke),gt);var Tt=K.SubVV(ze,et,We);it.Normalize();var wt=K.DotVV(it,Tt),Pt=K.DotVV(it,Me);if(wt-ct>Ge*Pt){if(Pt<=0||(Ge=(wt-ct)/Pt)>1)return!1;Le.Copy(it).SelfNeg(),He.m_count=0}var Bt=Ye[He.m_count];switch(Bt.indexA=Ke,Bt.wA.Copy(et).SelfMulAdd(Ge,Me),Bt.indexB=Je,Bt.wB.Copy(ze),Bt.w.Copy(Bt.wB).SelfSub(Bt.wA),Bt.a=1,He.m_count+=1,He.m_count){case 1:break;case 2:He.Solve2();break;case 3:He.Solve3()}if(He.m_count===3)return!1;He.GetClosestPoint(it),++vt}var jt=ht,Xt=Be;return He.GetWitnessPoints(jt,Xt),it.LengthSquared()>0&&(Le.Copy(it).SelfNeg(),Le.Normalize()),ae.normal.Copy(Le),ae.lambda=Ge,ae.iterations=vt,!0},w.b2Pair=tt,w.b2BroadPhase=ft,w.b2PairLessThan=lt,w.b2TreeNode=lr,w.b2DynamicTree=nr,w.b2_toi_reset=function(){w.b2_toiTime=0,w.b2_toiMaxTime=0,w.b2_toiCalls=0,w.b2_toiIters=0,w.b2_toiMaxIters=0,w.b2_toiRootIters=0,w.b2_toiMaxRootIters=0},w.b2TOIInput=Rt,w.b2TOIOutput=Mt,w.b2SeparationFunction=Nt,w.b2TimeOfImpact=Dr,w.b2CollideCircles=Br,w.b2CollidePolygonAndCircle=ui,w.b2CollidePolygons=Wn,w.b2CollideEdgeAndCircle=fn,w.b2CollideEdgeAndPolygon=dn,w.b2MassData=Wi,w.b2Shape=hi,w.b2CircleShape=ja,w.b2PolygonShape=Ua,w.b2EdgeShape=bi,w.b2ChainShape=Ha,w.b2Filter=zi,w.b2FixtureDef=Zn,w.b2FixtureProxy=pn,w.b2Fixture=Jn,w.b2BodyDef=function(){this.type=w.b2BodyType.b2_staticBody,this.position=new K(0,0),this.angle=0,this.linearVelocity=new K(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.active=!0,this.userData=null,this.gravityScale=1},w.b2Body=Kn,w.b2World=ao,w.b2DestructionListener=ro,w.b2ContactFilter=fs,w.b2ContactImpulse=ds,w.b2ContactListener=ps,w.b2QueryCallback=Ci,w.b2RayCastCallback=io,w.b2Island=xs,w.b2Profile=An,w.b2TimeStep=fi,w.b2Position=En,w.b2Velocity=Dn,w.b2SolverData=ms,w.b2ContactManager=_s,w.b2MixFriction=mn,w.b2MixRestitution=gn,w.b2ContactEdge=vn,w.b2Contact=ii,w.b2ContactRegister=us,w.b2ContactFactory=hs,w.g_blockSolve=!1,w.b2VelocityConstraintPoint=gs,w.b2ContactVelocityConstraint=In,w.b2ContactPositionConstraint=Pn,w.b2ContactSolverDef=vs,w.b2PositionSolverManifold=Bn,w.b2ContactSolver=ys,w.b2CircleContact=yn,w.b2PolygonContact=xn,w.b2PolygonAndCircleContact=bn,w.b2EdgeAndCircleContact=Cn,w.b2EdgeAndPolygonContact=Tn,w.b2ChainAndCircleContact=Sn,w.b2ChainAndPolygonContact=wn,w.b2Jacobian=Xa,w.b2JointEdge=_n,w.b2JointDef=Fr,w.b2Joint=Vr,w.b2AreaJointDef=Ya,w.b2AreaJoint=qn,w.b2DistanceJointDef=$n,w.b2DistanceJoint=Qn,w.b2FrictionJointDef=Wa,w.b2FrictionJoint=es,w.b2GearJointDef=za,w.b2GearJoint=ts,w.b2MotorJointDef=Za,w.b2MotorJoint=rs,w.b2MouseJointDef=Ja,w.b2MouseJoint=is,w.b2PrismaticJointDef=Ka,w.b2PrismaticJoint=ns,w.b2_minPulleyLength=2,w.b2PulleyJointDef=$a,w.b2PulleyJoint=ss,w.b2RevoluteJointDef=Qa,w.b2RevoluteJoint=as,w.b2RopeJointDef=qa,w.b2RopeJoint=os,w.b2WeldJointDef=eo,w.b2WeldJoint=ls,w.b2WheelJointDef=to,w.b2WheelJoint=cs,w.b2ControllerEdge=Os,w.b2Controller=Ti,w.b2BuoyancyController=oo,w.b2ConstantAccelController=lo,w.b2ConstantForceController=co,w.b2GravityController=uo,w.b2TensorDampingController=ho,w.b2ParticleDef=Ln,w.b2CalculateParticleIterations=bs,w.b2ParticleHandle=Cs,w.b2ParticleGroupDef=Ts,w.b2ParticleGroup=Ss,w.b2GrowableBuffer=di,w.b2FixtureParticleQueryCallback=On,w.b2ParticleContact=Is,w.b2ParticleBodyContact=Ps,w.b2ParticlePair=Bs,w.b2ParticleTriad=Ls,w.b2ParticleSystemDef=Rs,w.b2RopeDef=function(){this.vertices=[],this.count=0,this.masses=[],this.gravity=new K(0,0),this.damping=.1,this.k2=.9,this.k3=.1},w.b2Rope=fo,Object.defineProperty(w,"__esModule",{value:!0})},typeof T=="object"&&S!==void 0?_(T):typeof define=="function"&&define.amd?define(["exports"],_):_((void 0).box2d={})},{}],382:[function(L,S){var T=typeof window>"u"?global:window;T.cc=T.cc||{},cc.internal=cc.internal||{},L("./predefine"),L("./polyfill/string"),L("./polyfill/misc"),L("./polyfill/array"),L("./polyfill/object"),L("./polyfill/array-buffer"),L("./polyfill/number"),L("./polyfill/typescript"),L("./cocos2d/core/predefine"),L("./cocos2d"),L("./extends"),S.exports=T.cc},{"./cocos2d":299,"./cocos2d/core/predefine":221,"./extends":357,"./package":void 0,"./polyfill/array":384,"./polyfill/array-buffer":383,"./polyfill/misc":385,"./polyfill/number":386,"./polyfill/object":387,"./polyfill/string":388,"./polyfill/typescript":void 0,"./predefine":389}],383:[function(){if(!ArrayBuffer.isView){var L=Object.getPrototypeOf(Int8Array);ArrayBuffer.isView=typeof L=="function"?function(S){return S instanceof L}:function(S){if(typeof S!="object")return!1;var T=S.constructor;return T===Float64Array||T===Float32Array||T===Uint8Array||T===Uint32Array||T===Int8Array}}},{}],384:[function(){Array.isArray||(Array.isArray=function(L){return Object.prototype.toString.call(L)==="[object Array]"}),Array.prototype.find||(Array.prototype.find=function(L){for(var S=this.length,T=0;T<S;T++){var _=this[T];if(L.call(this,_,T,this))return _}}),Array.prototype.includes||(Array.prototype.includes=function(L){return this.indexOf(L)!==-1})},{}],385:[function(){if(Math.sign||(Math.sign=function(T){return(T=+T)==0||isNaN(T)?T:T>0?1:-1}),Math.log2||(Math.log2=function(T){return Math.log(T)*Math.LOG2E}),Number.isInteger||(Number.isInteger=function(T){return typeof T=="number"&&isFinite(T)&&Math.floor(T)===T}),!console.time){var L=window.performance||Date,S=Object.create(null);console.time=function(T){S[T]=L.now()},console.timeEnd=function(T){var _=S[T],w=L.now()-_;console.log(T+": "+w+"ms")}}},{}],386:[function(){Number.parseFloat=Number.parseFloat||parseFloat,Number.parseInt=Number.parseInt||parseInt},{}],387:[function(){Object.assign||(Object.assign=function(L,S){return cc.js.mixin(L,S)}),Object.getOwnPropertyDescriptors||(Object.getOwnPropertyDescriptors=function(L){var S={},T=Object.getOwnPropertyNames(L);Object.getOwnPropertySymbols&&(T=T.concat(Object.getOwnPropertySymbols(L)));for(var _=0;_<T.length;++_){var w=T[_];S[w]=Object.getOwnPropertyDescriptor(L,w)}return S})},{}],388:[function(){String.prototype.startsWith||(String.prototype.startsWith=function(L,S){return S=S||0,this.lastIndexOf(L,S)===S}),String.prototype.endsWith||(String.prototype.endsWith=function(L,S){(S===void 0||S>this.length)&&(S=this.length),S-=L.length;var T=this.indexOf(L,S);return T!==-1&&T===S}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")})},{}],389:[function(){var L=typeof window>"u"?global:window;function S(A,O){L[A]===void 0&&Object.defineProperty(L,A,{get:function(){var R;return A==="CC_WECHATGAMESUB"?R="cc.sys.platform === cc.sys.WECHAT_GAME_SUB":A==="CC_WECHATGAME"?R="cc.sys.platform === cc.sys.WECHAT_GAME":A==="CC_QQPLAY"&&(R="cc.sys.platform === cc.sys.QQ_PLAY"),cc.warnID(1400,A,R),O}})}function T(A){return typeof L[A]=="object"}(function(A,O){L[A]===void 0&&(L[A]=O)})("CC_BUILD",!1),L.CC_BUILD=!0,L.CC_DEV=!1,L.CC_DEBUG=!1,L.CC_JSB=!1,L.CC_NATIVERENDERER=!1,L.CC_SUPPORT_JIT=!0,L.CC_PHYSICS_BUILTIN=!1,L.CC_PHYSICS_CANNON=!1,L.CC_EDITOR=!1,L.CC_PREVIEW=!1,L.CC_TEST=!1,L.CC_RUNTIME=!1,L.CC_JSB=!1;var _=!(!T("wx")||!wx.getSharedCanvas),w=!(!T("wx")||!wx.getSystemInfoSync&&!wx.getSharedCanvas),B=T("bk");S("CC_WECHATGAMESUB",_),S("CC_WECHATGAME",w),S("CC_QQPLAY",B),L.CocosEngine=cc.ENGINE_VERSION="2.4.13"},{}]},{},[382]);var CodeNodeLg=cc.Class({name:"CodeNodeLg",extends:cc.Component,properties:{curve:null,onAssstLoadCb:null,bezierScale:1,assestLoaded:!0,t:{get(){return this._t},set(L){if(L>1&&(L=1),L<0&&(L=0),this._t=L,this.curve!=null){var S=this.curve.get(L);if(this.x=S.x*this.bezierScale,this.y=S.y*this.bezierScale,this.lookUp==1){var T=this.curve.derivative(L),_=Math.atan2(T.y,T.x),w=_*(180/Math.PI);this.angle=w}}}},_t:0,nodeName:{get(){return this.node.name},set(L){this.node.name=L}},src:{get(){return this.modal==4?this.string:this.customeName},set(L){this.node.name=L}},_modal:"",modal:{get(){return this._modal},set(L){this._modal!=L&&(this._modal=L,this.sprite!=null?(this.node.removeComponent(cc.Sprite),this.sprite=null):this.spineCom!=null?(this.node.removeComponent(sp.Skeleton),this.spineCom=null):this.label!=null&&(this.node.removeComponent(cc.Label),this.label=null),L==ObjectTypeEnum.spine?this.spineCom=this.node.addComponent(sp.Skeleton):L==ObjectTypeEnum.text?this.label=this.node.addComponent(cc.Label):L==ObjectTypeEnum.sprite&&(this.sprite=this.node.addComponent(cc.Sprite)))}},customeName:{get(){return this._customeName},set(L){if(this._customeName!=L){let S=L;S.indexOf("/")!=-1&&(S=S.split("/"),S=S[S.length-1]),S.indexOf(".")!=-1&&(S=S.split(".")[0]),this.node.name=S,this.modal==ObjectTypeEnum.sprite?this.sprite!=null&&(this.assestLoaded=!1,cc.assetManager.loadRemote(rootHost+"/"+L,(T,_)=>{cc.isValid(this.node)==!0&&_!=null&&this.sprite!=null&&(this.sprite.spriteFrame=new cc.SpriteFrame(_)),this.assestLoaded=!0,this.onAssstLoadCb!=null&&this.onAssstLoadCb()})):this.modal==ObjectTypeEnum.spine?this.spineCom!=null&&(this.assestLoaded=!1,loadNetSpine(L,T=>{T!=null&&cc.isValid(this.node)&&this.spineCom!=null&&(this.spineCom.skeletonData=T,this.checkAddComponent("SpinePlusComponent")),this.assestLoaded=!0,this.onAssstLoadCb!=null&&this.onAssstLoadCb()})):this.modal==ObjectTypeEnum.text?this.onAssstLoadCb!=null&&this.onAssstLoadCb():this.onAssstLoadCb!=null&&this.onAssstLoadCb(),this._customeName=L}L==""&&this.onAssstLoadCb!=null&&this.onAssstLoadCb()}},premulAlpha:{get(){return this.spineCom!=null?this.spineCom.premultipliedAlpha==!0?1:0:this.sprite!=null&&this.sprite.srcBlendFactor==cc.macro.BlendFactor.ONE?1:0},set(L){if(this.spineCom!=null)return this.spineCom.premultipliedAlpha=L!=0;if(this.sprite!=null)return this.sprite.srcBlendFactor=L==!0?cc.macro.BlendFactor.ONE:cc.macro.BlendFactor.SRC_ALPHA}},x:{get(){return this.node.x+this.offsetx},set(L){this.node.x=L-this.offsetx,this.dispatchListener("x",this.node.x)}},y:{get(){return this.node.y+this.offsety},set(L){this.node.y=L-this.offsety,this.dynamiczIndex&&(this.zIndex=6e3-Math.round(this.node.y+1500)*2),this.dispatchListener("y",this.node.y)}},realX:{get(){return this.node.x},set(L){this.node.x=L,this.dispatchListener("x",this.node.x)}},realY:{get(){return this.node.y},set(L){this.node.y=L,this.dynamiczIndex&&(this.zIndex=6e3-Math.round(this.node.y+1500)*2),this.dispatchListener("y",this.node.y)}},scaleX:{get(){return this.node.scaleX},set(L){this.node.scaleX=L,this.dispatchListener("scaleX",L)}},scaleY:{get(){return this.node.scaleY},set(L){this.node.scaleY=L,this.dispatchListener("scaleY",L)}},width:{get(){return this.node.width},set(L){this.node.width=L,this.dispatchListener("width",L),this.updatePreview()}},height:{get(){return this.node.height},set(L){this.node.height=L,this.dispatchListener("height",L),this.updatePreview()}},opacity:{get(){return this.node.opacity},set(L){this.node.opacity=L,this.dispatchListener("opacity",L)}},angle:{get(){return this.node.angle},set(L){this.node.angle=L,this.dispatchListener("angle",L)}},angleToPos:{get(){return this._angleToPos},set(L){this._angleToPos=L,this.realX=this.center[0]+Math.sin(this._angleToPos*(Math.PI/180))*this.radius,this.realY=this.center[1]+Math.cos(this._angleToPos*(Math.PI/180))*this.radius}},radius:{get(){return this._radius},set(L){this._radius=L,this.realX=this.center[0]+Math.sin(this._angleToPos*(Math.PI/180))*this.radius,this.realY=this.center[1]+Math.cos(this._angleToPos*(Math.PI/180))*this.radius}},center:{get(){return this._center},set(L){this._center=L,this.realX=this.center[0]+Math.sin(this._angleToPos*(Math.PI/180))*this.radius,this.realY=this.center[1]+Math.cos(this._angleToPos*(Math.PI/180))*this.radius}},zIndex:{get(){return this.node.zIndex},set(L){this.node.zIndex=L,this.dispatchListener("zIndex",L)}},active:{get(){return this.node.active==!0?1:0},set(L){this.node.active=L!=0,this.dispatchListener("active",L)}},parent:{get(){return this.node.parent},set(L){this.node.parent=L}},group:{get(){return this.node.group},set(L){}},zoomRatio:{get(){return this.camera!=null?this.camera.zoomRatio:0},set(L){this.camera!=null?this.camera.zoomRatio=L:(this.scaleX=1/L,this.scaleY=1/L,this.updatePreview())}},fontSize:{get(){return this.label==null?0:this.label.fontSize},set(L){this.label!=null&&(this.label.fontSize=L,this.label.lineHeight=L+10)}},overflow:{get(){return this.label==null?-1:this.label.overflow},set(L){this.label!=null&&(this.label.overflow=L)}},string:{get(){return this.label==null?"":this.label.string},set(L){this.label!=null&&(this.label.string=L,this.dispatchListener("string",L))}},anchorX:{get(){return this.node.anchorX},set(L){this.node.anchorX=L,this.updatePreview()}},anchorY:{get(){return this.node.anchorY},set(L){this.node.anchorY=L,this.updatePreview()}},color:{get(){return this.node.color.toHEX("#rrggbb")},set(L){this._color!=L&&(this._color=L),this.node.color=cc.Color.WHITE.fromHEX(L)}},ccColor:{get(){return this.node.color},set(L){}},r:{get(){return this.node.color.r},set(L){this.node.color=this.node.color.setR(L)}},g:{get(){return this.node.color.r},set(L){this.node.color=this.node.color.setG(L)}},b:{get(){return this.node.color.b},set(L){this.node.color=this.node.color.setB(L)}},outLineColor:{get(){return this._outLineColor},set(L){this._outLineColor!=L&&(this._outLineColor=L),this.outLineComp!=null&&(this.outLineComp.color=cc.Color.WHITE.fromHEX(L))}},outLineWidth:{get(){return this._outLineWidth},set(L){let S=this._outLineWidth;this._outLineWidth!=L&&(this._outLineWidth=L),this._outLineWidth<0&&(this._outLineWidth=0),this._outLineWidth>0?this.modal==ObjectTypeEnum.text?(this.outLineComp==null&&(this.outLineComp=this.addComponent(cc.LabelOutline),this.outLineComp.color=cc.Color.WHITE.fromHEX(this.outLineColor)),this.outLineComp.width=L):(this.spineCom!=null||this.sprite!=null)&&S==0&&this.setOutLine(!0):this.outLineComp!=null?this.outLineComp.width=0:(this.spineCom!=null||this.sprite!=null)&&S>0&&this.setOutLine(!1)}},_colliderValue:null,colliderValue:{get(){return this._colliderValue},set(L){if(Object.keys(L).length!=0&&L.pointArr!=null&&L.pointArr.length!=0&&this._colliderValue==null){let O=this.checkAddComponent("SpinePlusComponent");this._colliderValue=L,O.customCollider=!0;let R=L.scale||1;for(var S=[],T=0;T<L.pointArr.length;T++){var _=this.addComponent(cc.PolygonCollider);S.push(_);for(var w=L.pointArr[T],B=0;B<w.length;B++){var A=_.points[B];A||_.points.push(cc.v2()),_.points[B].x=(w[B].x-this.anchorX)*L.baseWidth/R+L.offsetX,_.points[B].y=(w[B].y-this.anchorY)*L.baseHeight/R*-1+L.offsetY}}O.polygonColliderArr=S}}},_outLineWidth:0,_outLineColor:"ffffff",_color:"ffffff",offsetx:0,offsety:0,_radius:0,_angleToPos:0,_center:[0,0],_customeName:"",useCenterMode:!1,inMapMap:0,girdX:0,girdY:0,widthGird:1,heightGird:1,girdTypeArr:[],dynamiczIndex:!1},setOutLine(L){L==!0?cc.resources.load("sharder/RenderOutLine",cc.Material,(S,T)=>{T!=null&&(this.spineCom!=null?this.spineCom.setMaterial(0,T):this.sprite!=null&&this.sprite.setMaterial(0,T))}):this.spineCom!=null?this.spineCom.setMaterial(0,cc.Material.getBuiltinMaterial("2d-spine")):this.sprite!=null&&this.sprite.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))},onLoad(){this.init()},init(){cc.isValid(this.node)!=!1&&(this.robotListenerCount={},this.camera=this.node.getComponent(cc.Camera),this.sprite=this.node.getComponent(cc.Sprite),this.spineCom=this.node.getComponent(sp.Skeleton),this.label=this.node.getComponent(cc.Label),this.outLineComp=this.node.getComponent(cc.LabelOutline),this.ctx=this.node.getComponent(cc.Graphics))},addComponent(L){if(typeof L=="string"&&cc.js.getClassByName(L)==null){console.warn("组件"+L+"不存在");return}var S=this.node.addComponent(L);return S},clearChildren(){if(cc.isValid(this.node))for(var L=0;L<this.node.children.length;L++)this.node.children[L].destroy()},checkAddComponent(L){if(typeof L=="string"&&cc.js.getClassByName(L)==null){console.warn("组件"+L+"不存在");return}let S=this.node.getComponent(L);return S==null&&(S=this.addComponent(L)),this.scheduleOnce(()=>{if(L=="SpinePlusComponent"&&this.graph!=null){var T=this.graph.vars.rootccNode;T==null&&(T=cc.director.getScene().getChildByName("Canvas"));var _=T.getChildByName("Camera");_!=null?(S.camera=_.getComponent(cc.Camera),S.camera==null&&(_=T.getChildByName("Main Camera"),S.camera=_.getComponent(cc.Camera))):(_=T.getChildByName("Main Camera"),S.camera=_.getComponent(cc.Camera))}},0),S},removeComponent(L){cc.isValid(this.node)&&this.node.removeComponent(L)},updatePreview(){if(this.ctx==null||this.disableUpdatePreview==!0)return;this.ctx.clear();let L=cc.director.getScene().getChildByName("Canvas").getChildByName("Main Camera"),S=1;L!=null&&(S=L.getComponent(cc.Camera).zoomRatio),this.ctx.lineWidth=4*(1/this.scaleX)*(1/cc.view.getScaleX())*(1/S),console.log("绘制了preview "+this.nodeName,this.scaleX),this.ctx.strokeColor=cc.Color.BLUE.fromHEX("#3F42EA"),this.ctx.rect(-this.width*this.anchorX,-this.height*this.anchorY,this.width,this.height),this.ctx.stroke()},getComponent(L){return this.node.getComponent(L)},getChildByName(L){return this.node.getChildByName(L)},on(L,S,T){cc.isValid(this.node)&&(T!=null?this.node.on(L,S,T):this.node.on(L,S,this))},targetOff(L){cc.isValid(this.node)&&(L!=null?this.node.targetOff(L):(this.node.targetOff(this),this.node.off(cc.Node.EventType.TOUCH_START),this.node.off(cc.Node.EventType.TOUCH_MOVE),this.node.off(cc.Node.EventType.TOUCH_END),this.node.off(cc.Node.EventType.TOUCH_CANCEL)))},destroyNode(){cc.isValid(this.node)&&this.node.destroy(),this.robotListener={}},onDestroy(){this.spineCom&&this.spineCom.skeletonData!=null&&(this.spineCom.skeletonData=null),this.sprite&&this.sprite.spriteFrame!=null&&(this.sprite.spriteFrame=null),this.graph=null,cc.Tween.stopAllByTarget(this.codeNode)},addRobotListener(L,S,T){this.robotListener==null&&(this.robotListener={}),this.robotListener[L]==null&&(this.robotListener[L]={}),this.robotListener[L][S]=T},removeRobotListener(L,S){this.robotListener==null&&(this.robotListener={}),this.robotListener[L]!=null&&delete this.robotListener[L][S]},dispatchListener(L,S){if(this.robotListener!=null&&this.robotListener[L]!=null)for(var T in this.robotListener[L])this.robotListener[L][T](S)},onCollisionEnter(L,S){var T=L.node.getComponent("CodeNodeLg");this.dispatchListener("contact",T)},onCollisionExit(L,S){var T=L.node.getComponent("CodeNodeLg");this.dispatchListener("uncontact",T)},getWorldPos(){return this.node.parent.convertToWorldSpaceAR(this.node.position)},setSkin(L){if(cc.isValid(this.node)!=!1&&(this.spineCom==null&&(this.spineCom=this.node.getComponent(sp.Skeleton)),this.spineCom!=null))try{this.spineCom.setSkin(L)}catch(S){}},playAnimation(L,S,T,_,w){cc.isValid(this.node)!=!1&&(this.spineCom==null&&(this.spineCom=this.node.getComponent(sp.Skeleton)),this.spineCom!=null&&(L==""&&console.warn("输入了无效的aniName"),this.spineCom.paused=!1,_!=null&&this.spineCom.setEventListener(_),w!=null&&this.spineCom.setCompleteListener(B=>{B.animation.name==L&&w!=null&&w()}),T==!0?(this.spineCom.loop=!1,this.spineCom.addAnimation(0,L,S)):this.spineCom.setAnimation(0,L,S)))},pauseAnimation(L){cc.isValid(this.node)!=!1&&(this.spineCom==null&&(this.spineCom=this.node.getComponent(sp.Skeleton)),this.spineCom!=null&&(L==null&&(L=!0),this.spineCom.paused=L))},setAnimationProb(L,S){cc.isValid(this.node)!=!1&&(this.spineCom==null&&(this.spineCom=this.node.getComponent(sp.Skeleton)),this.spineCom!=null&&(this.spineCom[L]=S))}}),ScaleObj$1=cc.Class({extends:cc.Component,properties:{scaleMin:.5,scaleMax:2,dynimicCenter:0},onLoad(){this.addTouchEvent()},addTouchEvent:function(){this.node.targetOff(this),this.touchIds={},this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.moveFun,this),this.node.on(cc.Node.EventType.TOUCH_END,this.cancelFun,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.cancelFun,this),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this.mouseWheel,this),console.log("我开启了缩放监听")},mouseWheel:function(L){this.dynimicCenter==1&&(this.startScale=this.node.scale,this.startPos=this.node.convertToNodeSpaceAR(cc.v2(this.node.width*.5,this.node.height*.5)));var S=L.getScrollY()/2e3;this.node.scale+=S,this.node.scale>this.scaleMax&&(this.node.scale=this.scaleMax),this.node.scale<this.scaleMin&&(this.node.scale=this.scaleMin),this.dynimicCenter==1&&(this.node.x+=this.startPos.x*this.startScale-this.node.scale*this.startPos.x,this.node.y+=this.startPos.y*this.startScale-this.node.scale*this.startPos.y),this.outputHandle!=null&&this.outputHandle("onScale",this.node.scale)},inputHandle:function(L){L.data==0?(this.touchIds={},this.node.targetOff(this)):this.addTouchEvent()},touchStart:function(L){var S=L.getID();Object.keys(this.touchIds).length>=2||(this.touchIds[S]={start:L.getLocation(),move:L.getLocation()},Object.keys(this.touchIds).length==2&&(this.scaleNow=this.node.scale))},moveFun:function(L){var S=L.getID(),T=Object.keys(this.touchIds);if(T.length<2){this.touchIds[S].start=L.getLocation(),this.touchIds[S].move=L.getLocation();return}this.dynimicCenter==1&&(this.startScale=this.node.scale,this.startPos=this.node.convertToNodeSpaceAR(cc.v2(this.node.width*.5,this.node.height*.5))),this.touchIds[S].move=L.getLocation();var _=T[0],w=T[1],B=this.touchIds[_].start.sub(this.touchIds[w].start).mag(),A=this.touchIds[_].move.sub(this.touchIds[w].move).mag(),O=A/B;this.node.scale=this.scaleNow*O,this.node.scale>this.scaleMax&&(this.node.scale=this.scaleMax),this.node.scale<this.scaleMin&&(this.node.scale=this.scaleMin),this.dynimicCenter==1&&this.startPos!=null&&(this.node.x+=this.startPos.x*this.startScale-this.node.scale*this.startPos.x,this.node.y+=this.startPos.y*this.startScale-this.node.scale*this.startPos.y),this.outputHandle!=null&&this.outputHandle("onScale",this.node.scale)},cancelFun:function(L){var S=L.getID();delete this.touchIds[S];var T=this;T.startTouch=!1,T.canMove!=!1&&T.touchEndHandle!=null&&T.touchEndHandle()},onDestroy(){cc.isValid(this.node)&&this.node.targetOff(this)},robotRelease(){this.touchIds={},cc.isValid(this.node)&&this.node.targetOff(this)}});let MotionText$1=class extends cc.Component{constructor(){super(...arguments),this.autoRun=!1,this.pause=!1,this.curTime=0,this.isActive=!1,this.position="0,0.6,1",this.positionTime="0,1.4,2",this.hideBaseLabel=!1,this.hideBeforRun=!1,this.hideAfterRun=!1,this.positionTimeArr=[],this.positionArr=[],this.dotIndex=1,this.delay=0,this.maskColor="88BF3D",this.stopIsPlayEnd=!1,this.dir=0,this.oriOpacity=255,this.hasInit=!1}onLoad(){this.node.getComponent("CodeNode")==null&&this.node.getComponent("CodeNodeLg")==null&&(this.init(),this.addEventListener())}init(){if(this.hasInit!=!0){this.oriOpacity=this.node.opacity,this.node.anchorX=0;var S=new cc.Node,T=S.addComponent(cc.Label),_=this.node.getComponent(cc.Label);T.font=_.font,T.fontSize=_.fontSize,T.string=_.string,T.lineHeight=_.lineHeight,T.overflow=_.overflow,T.enableBold=_.enableBold,T.enableItalic=_.enableItalic,T.enableUnderline=_.enableUnderline,T.horizontalAlign=_.horizontalAlign,T.verticalAlign=_.verticalAlign,this.hideBaseLabel==!0&&this.scheduleOnce(()=>{_.enabled=!1},0);var w=this.node.getComponent(cc.LabelOutline);if(w!=null){var B=S.addComponent(cc.LabelOutline);B.width=w.width,B.color=w.color}var A=new cc.Node;this.dir==0?(A.anchorX=0,A.anchorY=.5):(A.anchorX=.5,A.anchorY=1),A.addComponent(cc.Mask),A.parent=this.node,S.parent=A,A.width=this.node.width,A.height=this.node.height,this.scheduleOnce(()=>{S.width=this.node.width,S.height=this.node.height,this.dir==0?(A.width=0,A.height=this.node.height,A.x=-1*this.node.width*this.node.anchorX,A.y=this.node.height*(.5-this.node.anchorY)):(A.y=this.node.height*(1-this.node.anchorY),A.x=0,A.width=this.node.width,A.height=0)},0),S.anchorX=A.anchorX,S.anchorY=A.anchorY,S.y=0,S.x=0,this.positionTimeArr=this.positionTime.split(","),this.positionArr=this.position.split(","),this.dir==0?this.node.children[0].width=Number(this.positionArr[0]):this.node.children[0].height=Number(this.positionArr[0]),this.hideBeforRun==!0&&(this.node.opacity=1),S.color=cc.Color.WHITE.fromHEX(this.maskColor),this.autoRun==!0&&this.inputHandle({data:1}),this.hasInit=!0}}inputHandle(S){if(S.targetSolt=="hide"){this.hide();return}if(S.data==0){this.isActive=!1,this.stopRun();return}this.isActive=!0,this.curTime=0,this.dotIndex=1,this.dir==0?this.node.children[0].width=Number(this.positionArr[0]):this.node.children[0].height=Number(this.positionArr[0]),cc.Tween.stopAllByTarget(this.node),this.hideBeforRun==!0&&(this.node.opacity=1,cc.tween(this.node).to(.4,{opacity:this.oriOpacity}).start()),this.scheduleOnce(()=>{this.startRun()},0)}stopRun(){this.hasInit!=!1&&(cc.Tween.stopAllByTarget(this.node.children[0]),this.dir==0?this.node.children[0].width=Number(this.positionArr[0]):this.node.children[0].height=Number(this.positionArr[0]),this.stopIsPlayEnd==!0&&(this.node.oriColor==null&&(this.node.oriColor=this.node.color.toHEX("#rrggbb")),this.node.color=cc.Color.WHITE.fromHEX(this.maskColor)),this.hideBeforRun==!0&&(cc.Tween.stopAllByTarget(this.node),this.node.opacity=1))}hide(){cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.4,{opacity:0}).start()}startRun(){this.node.oriColor!=null&&(this.node.color=cc.Color.WHITE.fromHEX(this.node.oriColor));var S=this.positionArr[this.dotIndex],T={};this.dir==0?T={width:S*this.node.width}:T={height:S*this.node.height};var _=this.positionTimeArr[this.dotIndex]-this.positionTimeArr[this.dotIndex-1];console.log("motionText startRun",this.dotIndex,this.node.width,this.delay,this.positionArr.join(","),T),_<0&&(_=.1,console.warn("时间点错误，后面的时间点小于前面的，自动设置为0.1",_)),cc.Tween.stopAllByTarget(this.node.children[0]),cc.tween(this.node.children[0]).delay(this.delay).to(_,T).call(()=>{this.positionArr[this.dotIndex+1]!=null?(this.dotIndex+=1,this.startRun()):(this.outputHandle!=null&&this.outputHandle("onend",1),this.hideAfterRun==!0&&cc.tween(this.node).to(.4,{opacity:0}).start())}).start()}addEventListener(){cc.game.targetOff(this),cc.game.on("replayPage",()=>{this.dir==0?this.node.children[0].width=Number(this.positionArr[0]):this.node.children[0].height=Number(this.positionArr[0]),this.hideBeforRun==!0?this.node.opacity=1:this.node.opacity=this.oriOpacity,this.autoRun==!0&&this.inputHandle({data:1})},this),cc.game.on("pause",()=>{this.robotPause()},this),cc.game.on("resume",()=>{this.robotResume()},this)}robotStart(){if(this.node==null){console.warn("当前没有node",this);return}this.node.children[0]==null?this.init():(this.stopRun(),this.autoRun==!0&&this.inputHandle({data:1})),this.addEventListener()}robotRelease(){this.pause=!1,cc.game.targetOff(this),cc.isValid(this.node)&&(cc.Tween.stopAllByTarget(this.node.children[0]),cc.Tween.stopAllByTarget(this.node))}robotPause(){this.pause=!0,cc.director.getActionManager().pauseTarget(this.node.children[0])}robotResume(){this.pause=!1,cc.director.getActionManager().resumeTarget(this.node.children[0])}onDestroy(){cc.game.targetOff(this)}};class AutoTips extends cc.Component{constructor(){super(...arguments),this.quesionYuyin="",this.waitTime=10,this.yuyinTime=0,this.curWaitTime=0,this.isActive=!1,this.pause=!1,this.curPlayAudioId=-1,this.inputHandle=S=>{if(S.targetSolt=="resetTime")S.data==1&&(console.log("重置提示"),this.curWaitTime=this.waitTime,cc.audioEngine.stop(this.curPlayAudioId));else{if(S.data==0){console.log("关闭提示"),this.curWaitTime=-1,this.isActive=!1,this.curPlayAudioId!=-1&&this.curPlayAudioId!=null&&cc.audioEngine.stop(this.curPlayAudioId);return}console.log("开启提示"),this.waitTime<1&&(this.waitTime=1),this.isActive=!0,this.curWaitTime=this.waitTime}}}onLoad(){}start(){}addEventListener(){cc.game.targetOff(this),cc.game.on("clickCaidan",this.robotPause,this)}async playTips(){this.codeProgress.playSounds([this.quesionYuyin],()=>{},2),this.curWaitTime=this.waitTime}robotStart(){this.curWaitTime=-1,this.isActive=!1,this.pause=!1}robotRelease(){this.curWaitTime=-1,this.isActive=!1,this.pause=!1,cc.game.targetOff(this)}robotPause(){this.pause=!0}robotResume(){this.pause=!1}update(S){this.pause!=!0&&this.isActive!=!1&&this.curWaitTime>0&&(this.curWaitTime-=S,this.curWaitTime<0&&this.playTips())}onDestroy(){cc.game.targetOff(this)}}let AngleCompoment$1=class extends cc.Component{constructor(){super(...arguments),this.pointA={X:0,Y:0},this.pointB={X:0,Y:0},this.pointC={X:0,Y:0},this.typeMouse=!1,this.allA=0,this.inputHandle=S=>{console.log("进入了开启监听"),S.targetSolt=="number1"?S.data==0?(console.log("关闭了监听"),this.node.targetOff(this)):this.kaiqijiantin():S.targetSolt=="reset"&&(console.log("进入了重置"),this.allA=0)},this.outputHandle=(S,T)=>{}}onLoad(){}start(){}kaiqijiantin(){this.node.on(cc.Node.EventType.TOUCH_START,S=>{var T=this.node.convertToNodeSpaceAR(S.getLocation());this.pointB.X=T.x,this.pointB.Y=T.y,this.typeMouse=!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,S=>{if(this.typeMouse){var T=this.node.convertToNodeSpaceAR(S.getLocation());this.pointC.X=T.x,this.pointC.Y=T.y;var _={},w={};_.X=this.pointB.X-this.pointA.X,_.Y=this.pointB.Y-this.pointA.Y,w.X=this.pointC.X-this.pointA.X,w.Y=this.pointC.Y-this.pointA.Y;var B=_.X*w.Y-_.Y*w.X,A=Math.sqrt(Math.pow(this.pointA.X-this.pointB.X,2)+Math.pow(this.pointA.Y-this.pointB.Y,2)),O=Math.sqrt(Math.pow(this.pointA.X-this.pointC.X,2)+Math.pow(this.pointA.Y-this.pointC.Y,2)),R=Math.sqrt(Math.pow(this.pointB.X-this.pointC.X,2)+Math.pow(this.pointB.Y-this.pointC.Y,2)),P=(Math.pow(A,2)+Math.pow(O,2)-Math.pow(R,2))/(2*A*O),E=Math.round(Math.acos(P)*180/Math.PI);B<0?this.allA-=E:this.allA+=E,this.pointB.X=this.pointC.X,this.pointB.Y=this.pointC.Y,this.outputHandle("number1",this.allA)}},this),this.node.on(cc.Node.EventType.TOUCH_END,S=>{this.typeMouse=!1},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,S=>{this.typeMouse=!1},this)}};class SpinePlusComponent extends cc.Component{constructor(){super(...arguments),this.customCollider=!1,this.actions="",this.camera=null,this.clickEvent=[],this.completeEvent=[],this.polygonColliderArr=[],this.isDynamic=!1}get spine(){return this._spine}set spine(S){this._spine=S}onLoad(){this._spine=this.node.getComponent(sp.Skeleton),this._spine!=null?this._colliderSlot=this._spine.findSlot("Collider"):this.customCollider=!0}update(){if(!(!this._polygonCollider||!this._colliderSlot||!this.isDynamic)){this._polygonCollider.offset.x=this._colliderSlot.bone.worldX,this._polygonCollider.offset.y=this._colliderSlot.bone.worldY,this._polygonCollider.points=[];for(let S=0;S<this._colliderSlot.deform.length/2;S++)this._polygonCollider.points[S]||this._polygonCollider.points.push(cc.v2()),this._polygonCollider.points[S].x=this._colliderSlot.deform[S*2],this._polygonCollider.points[S].y=this._colliderSlot.deform[S*2+1]}}refreshCollider(){this._colliderSlot=this._spine.findSlot("Collider"),this._colliderSlot.getAttachment()}start(){if(this.customCollider==!0){this.polygonColliderArr=this.node.getComponents(cc.PolygonCollider),this.polygonColliderArr.length>0&&(this.node._hitTest=this.hitTest.bind(this)),this.addTouchEvent();return}if(this._attachment=this._spine.getAttachment("Collider","Collider"),!!this._attachment){this._polygonCollider=this.node.addComponent(cc.PolygonCollider);for(let S=0;S<this._attachment.vertices.length/2;S++)this._polygonCollider.points[S]||this._polygonCollider.points.push(cc.v2()),this._polygonCollider.points[S].x=this._attachment.vertices[S*2],this._polygonCollider.points[S].y=this._attachment.vertices[S*2+1];this.node._hitTest=this.hitTest.bind(this),this.addTouchEvent(),this.actions.length>0&&(this.actionList=this.actions.split(","))}}get actionList(){return this._actionList}set actionList(S){this._actionList=S}addTouchEvent(){this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,this.spineClick.bind(this),this)}removeTouchEvent(){this.actionList=[],this.clickEvent=[],this.node.off(cc.Node.EventType.TOUCH_END,this.spineClick.bind(this),this)}playSpineAnimation(){if(!this._actionList)return;this.node.pauseSystemEvents(!0);let S=this._actionList.concat(),T=this._endActName=S.shift(),_=S.pop();this._spine.setAnimation(0,T,!1);for(let w=0;w<S.length;w++){const B=this._endActName=S[w];this._spine.addAnimation(0,B,!1)}this._spine.addAnimation(0,_,!0),this._spine.setCompleteListener((w,B)=>{w.animation.name==this._endActName&&(this.node.resumeSystemEvents(!0),this._spine.setCompleteListener(null),cc.Component.EventHandler.emitEvents(this.completeEvent,this._spine))})}spineClick(){this.playSpineAnimation(),cc.Component.EventHandler.emitEvents(this.clickEvent,this._spine)}hitTest(S){let T;if(this.camera){let B=this.camera.getScreenToWorldPoint(S);T=this.node.convertToNodeSpaceAR(B)}else T=this.node.convertToNodeSpaceAR(S);if(this.polygonColliderArr!=null&&this.polygonColliderArr.length>0){for(var _=!1,w=0;w<this.polygonColliderArr.length&&(_=cc.Intersection.pointInPolygon(cc.v2(T),this.polygonColliderArr[w].points),_!=!0);w++);return _}else if(this._polygonCollider)return cc.Intersection.pointInPolygon(cc.v2(T),this._polygonCollider.points)}}cc.js.setClassName("SpinePlusComponent",SpinePlusComponent);cc.js.setClassName("ScaleObj",ScaleObj$1);cc.js.setClassName("MotionText",MotionText$1);cc.js.setClassName("AutoTips",AutoTips);cc.js.setClassName("AngleCompoment",AngleCompoment$1);cc.js.setClassName("CodeNodeLg",CodeNodeLg);var hasInit=!1,hasLoadScene=!1,selectedNode=null,treeData=[],rootHost="https://xxxx",isPreviewMode=!0,isInApp=!1,isInImport=!1,isSinglePreview=!1,designViewWidth=2560,designViewHeight=1500;function changeRunInmportState(L){isInImport=L}function setRootHost(L){rootHost=L}var ObjectTypeEnum={empty:"空物体",sprite:"图片",graph:"绘制",spine:"spine",text:"文本"},objectTypes=[ObjectTypeEnum.empty,ObjectTypeEnum.sprite,ObjectTypeEnum.graph,ObjectTypeEnum.spine,ObjectTypeEnum.text],robotNodeEnum={value:"input/value",valueString:"input/valueString",boolean:"input/boolean",gameStart:"input/gameStart",customButton:"input/button/customButton",controll:"input/button/controll",touchStart:"input/screen/touchStart",touchMove:"input/screen/touchMove",touchEnd:"input/screen/touchEnd",leftOrRightAct:"input/leftOrRightAct",customData:"input/getData/customData",systemData:"input/getData/systemData",screenSize:"input/screenSize",showTextTip:"output/tips/showTextTip",showConfirm:"output/tips/showConfirm",showHandTip:"output/tips/showHandTip",blockTouch:"output/blockTouch",consoleInfo:"output/tips/consoleInfo",restartGame:"output/game/restartGame",changeGame:"output/game/changeGame",endGame:"output/game/endGame",sound:"output/sound",vibrate:"output/vibrate",stopTime:"output/time/stopTime",timeScale:"output/time/timeScale",createObject:"objects/createObject",animate:"objects/animates/animate",tween:"objects/animates/tween",bezierCurve:"objects/animates/bezierCurve",camera:"objects/camera",MotionText:"output/customComponent/MotionText",CaiDanComponent:"output/customComponent/CaiDanComponent",CaiDanComponent2:"output/customComponent/CaiDanComponent2",ChatComponent:"output/customComponent/ChatComponent",VoiceCheck:"output/customComponent/VoiceCheck",AngleCompoment:"output/customComponent/AngleCompoment",ScaleObj:"output/customComponent/ScaleObj",ProgressCompoment:"output/customComponent/ProgressCompoment","cc.Mask":"output/customComponent/ccMask",angleConvertVector:"middle/angleCalculate/angleConvertVector",angleDifference:"middle/angleCalculate/angleDifference",vectorToAngel:"middle/angleCalculate/vectorToAngel",add:"middle/calculate/add",chu:"middle/calculate/chu",del:"middle/calculate/del",length:"middle/calculate/length",x:"middle/calculate/x",checkTag:"middle/change/checkTag",dataObject:"middle/change/dataObject",getArrayValue:"middle/change/getArrayValue",getKeyValue:"middle/change/getKeyValue",randomNum:"middle/change/randomNum",timeDown:"middle/change/timeDown",timeDownCycle:"middle/change/timeDownCycle",upCount:"middle/change/upCount",bigger:"middle/compare/bigger",equire:"middle/compare/equire",inRange:"middle/compare/inRange",litter:"middle/compare/litter",abs:"middle/covert/abs",revertNegative:"middle/covert/revertNegative",squareRoot:"middle/covert/squareRoot",toint:"middle/covert/toint",input:"middle/graph/input",output:"middle/graph/output",subgraph:"middle/graph/subgraph",allRight:"middle/logic/allRight",allToggle:"middle/logic/allToggle",notRight:"middle/logic/notRight",orRight:"middle/logic/orRight",orToggle:"middle/logic/orToggle",acceptData:"middle/tool/acceptData",lighting:"middle/tool/lighting",lightingOut:"middle/tool/lightingOut",outputLine:"middle/tool/outputLine",sendData:"middle/tool/sendData",textCode:"middle/tool/textCode",contact:"objects/objectSensor/contact",position:"objects/objectSensor/position",speed:"objects/objectSensor/publicListen",connection:"objects/group/connection"},typeColorEnum={input:"green",middle:"cyan",output:"pink",objects:"orange"};async function realBoot(){return new Promise((L,S)=>{var T=window._CCSettings,_=null,w=cc.AssetManager.BuiltinBundleName.RESOURCES,B=cc.AssetManager.BuiltinBundleName.INTERNAL,A=cc.AssetManager.BuiltinBundleName.MAIN;function O(){var k=document.getElementById("splash");if(k!=null){var F=k.querySelector(".progress-bar span");_=function(G,V){var j=100*G/V;F&&(F.style.width=j.toFixed(2)+"%")},k.style.display="block",F.style.width="0%",cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){k.style.display="none"})}}var R=function(){cc.view.enableRetina(!0),cc.sys.isBrowser&&O(),cc.sys.isBrowser&&cc.sys.os===cc.sys.OS_ANDROID&&(cc.assetManager.downloader.maxConcurrency=2,cc.assetManager.downloader.maxRequestsPerFrame=2);var k=T.launchScene,F=cc.assetManager.bundles.find(function(G){return G.getSceneInfo(k)});F.loadScene(k,null,_,function(G,V){if(G)S(G);else{cc.director.runSceneImmediate(V),cc.sys.isBrowser&&console.log("Success to load scene: "+k),cc.Canvas.instance.designResolution=cc.size(designViewWidth,designViewHeight),hasLoadScene=!0;var j=cc.director.getCollisionManager();j.enabled=!0,clearScene(),L(!0)}})},P=document.getElementById("GameCanvas");if(P==null){console.warn("没有找到GameCanvas"),S("没有找到渲染画布GameCanvas");return}var E={id:"GameCanvas",debugMode:T.debug?cc.debug.DebugMode.INFO:cc.debug.DebugMode.ERROR,showFPS:T.debug,frameRate:60,groupList:T.groupList,collisionMatrix:T.collisionMatrix};cc.assetManager.init({bundleVers:T.bundleVers,remoteBundles:T.remoteBundles,server:T.server});var D=[B];T.hasResourcesBundle&&D.push(w);var I=0;function M(k){if(k)return console.error(k.message,k.stack);I++,I===D.length+1&&cc.assetManager.loadBundle(A,function(F){F?S(F):cc.game.run(E,R)})}console.log("需要加载的settings.jsList",T.jsList),cc.assetManager.loadScript(T.jsList.map(function(k){return"src/"+k}),M),console.log("需要加载的bundleRoot",D);for(var N=0;N<D.length;N++)cc.assetManager.loadBundle(D[N],M)})}function initConsoleUtil(){cc.tree||(cc.tree=function(L){let S=L||0,T=function(_){let w="color: ".concat(_.parent===null||_.activeInHierarchy?"green":"grey","; font-size: 14px;font-weight:bold"),B="color: black; background: lightgrey;margin-left: 5px;border-radius:3px;padding: 0 3px;font-size: 10px;font-weight:bold",A="color: orange; background: black;margin-left: 5px;border-radius:3px;padding:0 3px;fonrt-size: 10px;font-weight:bold;",O="%c".concat(_.name),R="%c".concat(_.x.toFixed(0)+","+_.y.toFixed(0)+","+_.width.toFixed(0)+","+_.height.toFixed(0)+","+_.scale.toFixed(1)),P="%c".concat(S++);if(_.childrenCount>0){console.groupCollapsed(O+R+P,w,B,A);for(let E=0;E<_.childrenCount;E++)T(_.children[E]);console.groupEnd()}else console.log(O+R+P,w,B,A)};if(L){let _=cc.cat(L);S=_.tempIndex,T(_)}else{let _=cc.director.getScene();T(_)}return"属性依次为x,y,width,height,scale.使用cc.cat(id)查看详细属性."},cc.cat=function(L){let S=0,T,_=function(B){if(!T){if(cc.js.isNumber(L)){if(L===S++){T=B;return}}else if(L.toLowerCase()===B.name.toLowerCase()){T=B;return}else S++;if(B.childrenCount>0)for(let A=0;A<B.childrenCount;A++)_(B.children[A])}},w=cc.director.getScene();return _(w),T.tempIndex=cc.js.isNumber(L)?L:S,T},cc.list=function(L){let S=[],T=function(w){if(w.name.toLowerCase().indexOf(L.toLowerCase())>-1&&S.push(w),w.childrenCount>0)for(let B=0;B<w.childrenCount;B++)T(w.children[B])},_=cc.director.getScene();return T(_),S.length===1?S[0]:S},cc.where=function(L){let S=L.name?L:cc.cat(L);if(!S)return null;let T=S.getBoundingBoxToWorld(),_=new cc.Node,w=_.addComponent(cc.Graphics);return cc.director.getScene().addChild(_),_.position=T.center,_.group=S.group,_.zIndex=cc.macro.MAX_ZINDEX,T.width===0||T.height===0?(w.circle(0,0,100),w.fillColor=cc.Color.GREEN,w.fill()):(_.width=T.width,_.height=T.height,w.rect(-_.width/2,-_.height/2,_.width,_.height),w.fillColor=new cc.Color().fromHEX("#E91E6390"),w.fill()),setTimeout(()=>{cc.isValid(_)&&_.destroy()},2e3),S},cc.cache=function(){let L=cc.assetManager.assets._map,S=[],T=0;for(let w in L){let B=L[w];if(B.type!=="js"&&B.type!=="json"){let A="_",O="",R=B.__classname__,P=-1;if(B.type==="png"||B.type==="jpg"){let E=L[w.replace("."+B.type,".json")];E&&E._owner&&E._owner._name&&(A=E._owner._name,O=E.content.url)}else if(B.name?A=B.name:B._owner&&(A=B._owner&&B._owner.name||"_"),R==="cc.Texture2D"){O=B.nativeUrl;let E=B.width*B.height*((B._native===".jpg"?3:4)/1024/1024);T+=E,P=Math.round(E*1e3)/1e3}else R==="cc.SpriteFrame"&&(O=B._texture.nativeUrl);S.push({queueId:B.queueId,type:R,name:A,preview:O,id:B._uuid,size:P})}}let _="缓存 [文件总数:".concat(S.length,"][纹理缓存:").concat(T.toFixed(2)+"M","]");return[S,_]},cc.loopAllNode=function(L,S){var T=function(w){if(cc.isValid(w)){L(w);for(var B=0;B<w.children.length;B++)T(w.children[B])}};if(S==null){if(S=cc.director.getScene(),cc.isValid(S)==!0)for(var _=0;_<S.children.length;_++)T(S.children[_])}else T(S)})}async function waitCocosInit(){return new Promise((L,S)=>{var T=0,_=()=>{T+=1,hasLoadScene==!0?L(!0):T>100?S("等待cocos加载场景超时"):setTimeout(_,100)};_()})}async function init(){if(hasInit==!0)return console.log("CocosMgr已经初始化了"),!0;if(hasInit=!0,typeof VConsole<"u"&&(window.vConsole=new VConsole),console.log("window._CCSettings.debug",window._CCSettings),console.log("window.vConsole",window.vConsole),window.cc!=null)console.log("cocos加载成功ENGINE_VERSION",window.cc.ENGINE_VERSION),await realBoot(),initConsoleUtil();else return console.warn("cocos引擎没有被加载"),!1;hasInit=!0}function updateCanvasSize(L,S){if(hasLoadScene!=!1){if(L==null||S==null){let T=document.getElementById("GameCanvas");L=T.clientWidth,S=T.clientHeight,console.log("自动获取了canvas尺寸并更新",L,S)}cc.view.setCanvasSize(L,S)}}function showOrHideFPS(){var L=!cc.debug.isDisplayStats();return cc.debug.setDisplayStats(L),L}function showOrHideColiderBox(){var L=cc.director.getCollisionManager();if(L==null){console.warn("getCollisionManager == null");return}return L.enabledDebugDraw=!L.enabledDebugDraw,L._debugDrawer!=null&&(L._debugDrawer.lineWidth=3*(1/cc.view.getScaleX())),L.enabledDebugDraw}function clearScene(){if(hasLoadScene==!1)return;const L=cc.director.getScene();for(var S=0;S<L.children.length;S++){var T=L.children[S];if(T.name!="Canvas")T.destroy();else for(var _=0;_<T.children.length;_++){var w=T.children[_];w.name!="Main Camera"&&w.destroy()}}}function getNodeById(L){let S;const T=function(w){if(w._id===L){S=w;return}if(w.childrenCount)for(let B=0;B<w.childrenCount;B++)S||T(w.children[B])},_=cc.director.getScene();return T(_),S}function getChildren(L){return L.children.map(S=>{let T=S.children&&S.children.length>0?getChildren(S):[];return{id:S._id,name:S.name,active:S.activeInHierarchy,children:T}})}function getHasChildrenNodeId(){if(hasLoadScene==!1)return[];var L=[];return cc.loopAllNode(S=>{S.children.length>0&&L.push(S._id)},cc.director.getScene()),L}function refreshTree(){treeData=getChildren(cc.director.getScene())}function changePreviewMode(){isPreviewMode=!isPreviewMode}function drawNodeRect(L){L!=null?(selectedNode=L,cc.where(L)):cc.where(selectedNode)}function getFileType(L){return L=="png"||L=="jpg"||L=="jpeg"?"图片":L=="mp3"||L=="wav"?"音频":L=="json"?"json":L=="atlas"?"图集":L=="spine"?"spine":"空物体"}function getExName(L,S){var T="";return L.indexOf(".")!=-1&&(L=L.split("."),T=L[L.length-1]),S==!0?"."+T:T}function getName(L){return L.indexOf("/")!=-1&&(L=L.split("/"),L=L[L.length-1]),L}function getBaseName(L){return L=getName(L),L.split(".")[0]}function setValueByKey(L,S,T){S[T]!=null&&(L[T]=S[T])}function syncConfigToCodeNode(L,S){setValueByKey(L,S,"modal"),setValueByKey(L,S,"customeName"),setValueByKey(L,S,"anchorX"),setValueByKey(L,S,"anchorY"),setValueByKey(L,S,"x"),setValueByKey(L,S,"y"),L.useCenterMode&&S.x!=null&&S.y!=null&&(L.center=[S.x,S.y]),setValueByKey(L,S,"angle"),setValueByKey(L,S,"color"),setValueByKey(L,S,"zIndex"),setValueByKey(L,S,"dynamiczIndex"),setValueByKey(L,S,"group"),setValueByKey(L,S,"overflow"),setValueByKey(L,S,"height"),setValueByKey(L,S,"width"),setValueByKey(L,S,"opacity"),setValueByKey(L,S,"fontSize"),setValueByKey(L,S,"outLineColor"),setValueByKey(L,S,"outLineWidth"),setValueByKey(L,S,"premulAlpha"),setValueByKey(L,S,"scaleX"),setValueByKey(L,S,"scaleY"),setValueByKey(L,S,"string"),setValueByKey(L,S,"zoomRatio"),setValueByKey(L,S,"colliderValue")}function xorConfig(L,S){for(var T in S)(L[T]==S[T]||S[T]==null)&&delete S[T]}function xorConfigZeroValue(L){for(var S in L)(L[S]==0||L[S]==null)&&delete L[S]}function blockTouch$1(L){if(hasLoadScene==!1){console.warn("调用createObj时场景还未加载成功");return}let S=cc.director.getScene();var T=S.getChildByName("blockNode");T==null&&(T=new cc.Node,T.name="blockNode",T.parent=S,T.width=cc.winSize.width,T.height=cc.winSize.height,T.addComponent(cc.BlockInputEvents),T.x=cc.winSize.width*.5,T.y=cc.winSize.height*.5),T.active=L}function createObj(L,S){if(hasLoadScene==!1){console.warn("调用createObj时场景还未加载成功");return}let T=null;if(L.parent!=null?T=L.parent:T=cc.director.getScene().getChildByName("Canvas"),T!=null&&cc.isValid(T)!=!1){var _=new cc.Node;_.parent=T;var w=_.addComponent(CodeNodeLg);return w.onAssstLoadCb=S,syncConfigToCodeNode(w,L),w}}async function showConfirm$1(L,S){{let T=confirm(L);S(T)}}async function showAlert(L){window.antAleart!=null&&window.antAleart(L)}function loadNetSpine(L,S){let T=rootHost+"/"+L+".png",_=rootHost+"/"+L+".json",w=rootHost+"/"+L+".atlas",B=T.split("/"),A=B[B.length-1];cc.assetManager.loadAny([{url:w,ext:".atlas"},{url:_,ext:".json"}],(O,R)=>{cc.assetManager.loadRemote(T,(P,E)=>{let D=new sp.SkeletonData;D.skeletonJson=R[1],D.atlasText=R[0],D.textures=[E],D.textureNames=[A],S&&S(D)})})}function vibrate$1(L){console.log("震动长短",L)}function changeGraph(L,S){window.onChangeGraph!=null&&window.onChangeGraph(L,S,!0)}class valueRobot extends LGraphNode{constructor(){super();St(this,"title","value");St(this,"desc","定义一个数");St(this,"name","数值");this.addOutput("输出","number"),this.addProperty("value",1),this.widget=this.addWidget("number","值",1,"value"),this.widgets_up=!0}onExecute(){this.setOutputData(0,parseFloat(this.properties.value))}getTitle(){return this.flags.collapsed?this.properties.value:this.title}setValue(T){this.setProperty("value",T)}onDrawBackground(T){this.outputs[0].label=this.properties.value.toFixed(3)}}valueRobot.title="数值";LiteGraph.registerNodeType("input/value",valueRobot);class valueStringRobot extends LGraphNode{constructor(){super();St(this,"title","文字");St(this,"desc","定义文字值");this.addOutput("输出","string"),this.addProperty("value",""),this.widget=this.addWidget("text","value","","value"),this.widgets_up=!0}onExecute(){this.setOutputData(0,this.properties.value)}getTitle(){return this.flags.collapsed?this.properties.value:this.title}setValue(T){this.setProperty("value",T)}}valueStringRobot.title="文字";LiteGraph.registerNodeType("input/valueString",valueStringRobot);class BooleanRobot extends LGraphNode{constructor(){super();St(this,"title","布尔值");St(this,"desc","定义一个数");this.addOutput("bool","boolean"),this.addProperty("value",!0),this.widget=this.addWidget("toggle","value",!0,"value")}onExecute(){this.setOutputData(0,parseFloat(this.properties.value))}getTitle(){return this.flags.collapsed?this.properties.value:this.title}setValue(T){this.setProperty("value",T)}onDrawBackground(T){this.outputs[0].label=this.properties.value?"真":"假"}}BooleanRobot.title="布尔值";LiteGraph.registerNodeType("input/boolean",BooleanRobot);class gameStartRobot extends LGraphNode{constructor(){super();St(this,"title","开始时");St(this,"desc","但游戏开始时执行一次");this.addOutput("游戏开始",LiteGraph.EVENT),this.addProperty("modal","开始时","enum"),this.addWidget("combo","输出时机",this.properties.modal,{property:"modal",values:["开始前","开始时","开始后"]}),this.widgets_up=!0,this.size=[180,30]}onStartBeforeLoad(){this.properties.modal=="开始前"&&this.triggerSlot(0,1)}onStart(){this.properties.modal=="开始时"&&this.triggerSlot(0,1)}onStartAfter(){this.properties.modal=="开始后"&&this.triggerSlot(0,1)}getTitle(){return this.flags.collapsed?this.properties.modal:this.title}setValue(T){this.setProperty("value",T)}}gameStartRobot.title="开始时";LiteGraph.registerNodeType("input/gameStart",gameStartRobot);class customButtonRobot extends LGraphNode{constructor(){super();St(this,"title","按钮");St(this,"desc","一个可以点击的按钮");St(this,"font","Arial");this.addOutput("",LiteGraph.EVENT),this.addOutput("","boolean"),this.addProperty("font_size",30),this.addProperty("text","按钮"),this.addProperty("message",""),this.size=[164,84],this.clicked=!1}onMouseDown(T,_){if(_[0]>1&&_[1]>1&&_[0]<this.size[0]-2&&_[1]<this.size[1]-2)return this.clicked=!0,this.setOutputData(1,this.clicked),this.triggerSlot(0,this.properties.message),this.clicked=!1,this.setOutputData(1,this.clicked),!0}onExecute(){this.setOutputData(1,this.clicked)}onDrawForeground(T){if(!this.flags.collapsed){var _=10;if(T.fillStyle="black",T.fillRect(_+1,_+1,this.size[0]-_*2,this.size[1]-_*2),T.fillStyle="#AAF",T.fillRect(_-1,_-1,this.size[0]-_*2,this.size[1]-_*2),T.fillStyle=this.clicked?"white":this.mouseOver?"#668":"#334",T.fillRect(_,_,this.size[0]-_*2,this.size[1]-_*2),this.properties.text||this.properties.text===0){var w=this.properties.font_size||30;T.textAlign="center",T.fillStyle=this.clicked?"black":"white",T.font=w+"px Arial",T.fillText(this.properties.text,this.size[0]*.5,this.size[1]*.5+w*.3),T.textAlign="left"}}}}customButtonRobot.title="按钮";LiteGraph.registerNodeType("input/button/customButton",customButtonRobot);class controllRobot extends LGraphNode{constructor(){super();St(this,"title","摇杆");St(this,"desc","操作杆的x和y的范围：[-1, 1]，当拖动操控杆时\n仅改变时：操控杆移发生位移变化时输出当前操作杆范围\n持续：一直输出操控杆当前值*这一帧的时长");St(this,"font","Arial");this.addOutput("左右","number"),this.addOutput("上下","number"),this.addOutput("按下时",LiteGraph.EVENT),this.addProperty("controllType",0),this.addProperty("modal",0),this.addProperty("outputScale",250),this.size=[164,164],this.clicked=!1}freshHandlePos(T){var _=Math.min(this.size[0],this.size[1]);let w=_*.5,B=T[0]-w,A=T[1]-w,O=Math.min(Math.sqrt(B*B+A*A),w),R=Math.atan2(A,B),P=O*Math.cos(R),E=O*Math.sin(R);if(T[0]>0&&T[1]>0&&T[0]<_&&T[1]<_)return this.setOutputData(0,P/w),this.setOutputData(1,E/w),!0}onMouseDown(T,_){this.clicked=!0,this.freshHandlePos(_),this.triggerSlot(2)}onMouseMove(T,_){this.clicked==!0&&this.freshHandlePos(_)}onMouseUp(T){this.clicked=!1,this.setOutputData(0,0),this.setOutputData(1,0)}onExecute(){this.setOutputData(1,this.clicked)}onDrawBackground(T){if(!this.flags.collapsed){var _=this.getOutputData(0),w=this.getOutputData(1);_!=null&&_.toFixed!=null&&(this.outputs[0].label="左右："+_.toFixed(3)),w!=null&&w.toFixed!=null&&(this.outputs[1].label="上下："+w.toFixed(3))}}onDrawForeground(T){if(!this.flags.collapsed){var _=Math.min(this.size[0],this.size[1]),w={width:_,height:_},B={width:_*.25,height:_*.25};this.size[0];var A=T.createRadialGradient(w.width/2,w.height/2,0,w.width/2,w.height/2,w.width/2);A.addColorStop(0,"#666"),A.addColorStop(1,"#222"),T.beginPath(),T.arc(w.width/2,w.height/2,w.width/2,0,Math.PI*2),T.fillStyle=A,T.fill(),T.strokeStyle="rgba(255,255,255,0.2)",T.lineWidth=2,T.beginPath(),T.moveTo(w.width/2,0),T.lineTo(w.width/2,w.height),T.moveTo(0,w.height/2),T.lineTo(w.width,w.height/2),T.stroke();for(let D=1;D<=3;D++)T.beginPath(),T.arc(w.width/2,w.height/2,D*w.width/6,0,Math.PI*2),T.stroke();var A=T.createRadialGradient(B.width/2,B.height/2,0,B.width/2,B.height/2,B.width/2);A.addColorStop(0,"#fff"),A.addColorStop(1,"#aaa");var O=this.getOutputData(0)||0,R=this.getOutputData(1)||0,P=w.width*.5+(0+O)*w.width*.5,E=w.height*.5+(0+R)*w.height*.5;T.beginPath(),T.arc(P,E,B.width/2,0,Math.PI*2),T.fillStyle=A,T.fill(),T.beginPath(),T.arc(P,E,B.width/3,0,Math.PI*2),T.fillStyle="rgba(255,255,255,0.3)",T.fill()}}}controllRobot.title="摇杆";LiteGraph.registerNodeType("input/button/controll",controllRobot);class touchStart extends LGraphNode{constructor(){super();St(this,"title","触摸开始");St(this,"desc","检测物体触摸开始");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addInput("监听",LiteGraph.ACTION),this.addInput("取消监听",LiteGraph.ACTION),this.addOutput("开始X","number"),this.addOutput("开始Y","number"),this.addOutput("点击",LiteGraph.EVENT),this.addProperty("controllObj",!1,"boolean"),this.addWidget("toggle","控制物体位置",this.properties.controllObj,"controllObj"),this.useCanvas=!1,this.lastBindCodeNode=null}onStop(){if(this.touchIds={},this.useCanvas==!0){this.useCanvas=!1;let T=this.graph.config.rootccNode;T==null&&(T=cc.director.getScene().getChildByName("Canvas")),T.targetOff(this)}else this.lastBindCodeNode!=null&&(this.lastBindCodeNode.targetOff(this),this.lastBindCodeNode=null)}realRun(T,_){if(_!=0)if(this.lastBindCodeNode!=null&&this.lastBindCodeNode.node.targetOff(this),T!=null)this.useCanvas=!1,this.lastBindCodeNode=T,T.checkAddComponent("SpinePlusComponent"),T.targetOff(this),T.on(cc.Node.EventType.TOUCH_START,w=>{if(this.graph.config.pause!=1){var B=T.node.parent.convertToNodeSpaceAR(w.getLocation());this.properties.controllObj==!0&&(T.x=B.x,T.y=B.y),this.setOutputData(0,B.x),this.setOutputData(1,B.y),this.triggerSlot(2,1)}},this);else{this.useCanvas=!0;let w=this.graph.config.rootccNode;w==null&&(w=cc.director.getScene().getChildByName("Canvas")),w.targetOff(this),w.on(cc.Node.EventType.TOUCH_START,B=>{if(this.graph.config.pause!=1){var A=w.convertToNodeSpaceAR(B.getLocation());this.setOutputData(0,A.x),this.setOutputData(1,A.y),this.triggerSlot(2,1)}},this)}else if(this.useCanvas==!0){let w=this.graph.config.rootccNode;if(w==null){w=cc.director.getScene().getChildByName("Canvas");return}w.targetOff(this)}else this.lastBindCodeNode!=null&&this.lastBindCodeNode.targetOff(this)}onAction(T,_){if(T=="监听"){var w=this.getInputData(0);this.realRun(w)}else if(T=="取消监听"){var w=this.getInputData(0);this.realRun(w,!1)}}setValue(T){this.setProperty("value",T)}}touchStart.title="触摸开始";LiteGraph.registerNodeType("input/screen/touchStart",touchStart);class touchMove extends LGraphNode{constructor(){super();St(this,"title","触摸移动");St(this,"desc","检测物体触摸开始");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addInput("监听",LiteGraph.ACTION),this.addInput("取消监听",LiteGraph.ACTION),this.addOutput("X轴移动","number"),this.addOutput("Y轴移动","number"),this.addOutput("移动",LiteGraph.EVENT),this.addProperty("controllObj",!1,"boolean"),this.addWidget("toggle","控制物体位置",this.properties.controllObj,"controllObj"),this.addProperty("needCheckIn",!1,"boolean"),this.addWidget("toggle","碰撞框检测",this.properties.needCheckIn,"needCheckIn"),this.addProperty("mutplayTouch",!1,"boolean"),this.addWidget("toggle","忽略多点触摸",this.properties.mutplayTouch,"mutplayTouch"),this.useCanvas=!1,this.lastBindCodeNode=null,this.touchIds={}}onStop(){if(this.touchIds={},this.useCanvas==!0){this.useCanvas=!1;let T=this.graph.config.rootccNode;T==null&&(T=cc.director.getScene().getChildByName("Canvas")),T.targetOff(this)}else console.log("停止运行了 lastBindCodeNode",this.lastBindCodeNode),this.lastBindCodeNode!=null&&(this.lastBindCodeNode.targetOff(this),this.lastBindCodeNode=null)}realRun(T,_){if(_!=0)if(this.lastBindCodeNode!=null&&this.lastBindCodeNode.targetOff(this),T!=null){this.useCanvas=!1,this.lastBindCodeNode=T,T.node!=null||console.log("realRun lastBindCodeNode 节点已经被销毁"),T.checkAddComponent("SpinePlusComponent");var w=null,B=5,A=null;T.targetOff(this),T.on(cc.Node.EventType.TOUCH_START,O=>{w=null,A=O.getID();var R=O.getID();this.touchIds[R]=1},this),T.on(cc.Node.EventType.TOUCH_MOVE,O=>{if(!(Object.keys(this.touchIds).length>1&&this.properties.mutplayTouch==!0)&&A==O.getID()&&this.graph.config.pause!=1){if(this.instance!=null&&B<5){B+=1;return}if(B=0,w==null){w=T.parent.convertToNodeSpaceAR(O.getLocation());return}var R=T.parent.convertToNodeSpaceAR(O.getLocation()),P=!0;if(this.properties.needCheckIn.default==1){var E=T.getComponent(cc.PolygonCollider);if(E!=null)var D=T.node.convertToNodeSpaceAR(O.getLocation()),P=cc.Intersection.pointInPolygon(D,E.points)}var I=R.sub(w);P==!0&&(this.setOutputData(0,I.x),this.setOutputData(1,I.y),this.triggerSlot(2,1),this.properties.controllObj==!0&&(T.x+=I.x,T.y+=I.y)),w=R}},this),T.on(cc.Node.EventType.TOUCH_END,O=>{var R=O.getID();delete this.touchIds[R]},this),T.on(cc.Node.EventType.TOUCH_CANCEL,O=>{var R=O.getID();delete this.touchIds[R]},this)}else{this.useCanvas=!0;let O=this.graph.config.rootccNode;O==null&&(O=cc.director.getScene().getChildByName("Canvas")),O.targetOff(this);var w=null,B=5;O.on(cc.Node.EventType.TOUCH_START,E=>{w=null;var D=E.getID();this.touchIds[D]=1},this),O.on(cc.Node.EventType.TOUCH_MOVE,E=>{if(!(Object.keys(this.touchIds).length>1&&this.properties.mutplayTouch==!0)&&this.graph.config.pause!=1){if(B<5){B+=1;return}if(B=0,w==null){w=O.parent.convertToNodeSpaceAR(E.getLocation());return}var D=O.parent.convertToNodeSpaceAR(E.getLocation()),I=D.sub(w);this.setOutputData(0,I.x),this.setOutputData(1,I.y),w=D}},this),O.on(cc.Node.EventType.TOUCH_END,E=>{var D=E.getID();delete this.touchIds[D]},this),O.on(cc.Node.EventType.TOUCH_CANCEL,E=>{var D=E.getID();delete this.touchIds[D]},this)}else if(this.useCanvas==!0){let O=this.graph.config.rootccNode;O==null&&(O=cc.director.getScene().getChildByName("Canvas")),O.targetOff(this),this.useCanvas=!1}else this.lastBindCodeNode!=null&&this.lastBindCodeNode.targetOff(this)}onAction(T,_){if(T=="监听"){var w=this.getInputData(0);console.log("我开始监听移动",w),this.realRun(w)}else if(T=="取消监听"){var w=this.getInputData(0);this.realRun(w,!1)}}setValue(T){this.setProperty("value",T)}}touchMove.title="触摸移动";LiteGraph.registerNodeType("input/screen/touchMove",touchMove);class touchEnd extends LGraphNode{constructor(){super();St(this,"title","触摸结束");St(this,"desc","检测物体触摸开始");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addInput("监听",LiteGraph.ACTION),this.addInput("取消监听",LiteGraph.ACTION),this.addOutput("结束X","number"),this.addOutput("结束Y","number"),this.addOutput("结束",LiteGraph.EVENT),this.addOutput("点击结束",LiteGraph.EVENT),this.addOutput("移动结束",LiteGraph.EVENT),this.addProperty("controllObj",!1,"boolean"),this.addWidget("toggle","控制物体位置",this.properties.controllObj,"controllObj"),this.addProperty("listernTouchCancel",!1,"boolean"),this.addWidget("toggle","响应触摸取消",this.properties.listernTouchCancel,"listernTouchCancel"),this.touchIds={}}onStart(){}onStop(){if(this.touchIds={},this.useCanvas==!0){let T=this.graph.config.rootccNode;T==null&&(T=cc.director.getScene().getChildByName("Canvas")),T.targetOff(this)}else this.lastBindCodeNode!=null&&(this.lastBindCodeNode.targetOff(this),this.lastBindCodeNode=null)}realRun(T,_){if(_!=0)if(this.lastBindCodeNode!=null&&this.lastBindCodeNode.node.targetOff(this),T!=null){this.useCanvas=!1,this.lastBindCodeNode=T,T.checkAddComponent("SpinePlusComponent"),T.targetOff(this);var w=null;T.on(cc.Node.EventType.TOUCH_START,A=>{w=T.node.parent.convertToNodeSpaceAR(A.getLocation())},this);var B=A=>{if(this.graph.config.pause!=1){var O=T.node.parent.convertToNodeSpaceAR(A.getLocation());this.setOutputData(0,O.x),this.setOutputData(1,O.y),this.properties.controllObj==!0&&(T.x=O.x,T.y=O.y),w&&O.sub(w).mag()<10?(this.trigger("结束"),this.trigger("点击结束")):(this.trigger("结束"),this.trigger("移动结束"))}};T.on(cc.Node.EventType.TOUCH_END,A=>{B(A)},this),T.on(cc.Node.EventType.TOUCH_CANCEL,A=>{this.properties.listernTouchCancel==!0&&B(A)},this)}else{this.useCanvas=!0;let A=this.graph.config.rootccNode;A==null&&(A=cc.director.getScene().getChildByName("Canvas")),A.targetOff(this);var w=null;A.on(cc.Node.EventType.TOUCH_START,P=>{w=A.convertToNodeSpaceAR(P.getLocation())},this);var B=P=>{if(this.graph.config.pause!=1){var E=A.convertToNodeSpaceAR(P.getLocation());this.setOutputData(0,E.x),this.setOutputData(1,E.y),E.sub(w).mag()<10?(this.trigger("结束"),this.trigger("点击结束")):(this.trigger("结束"),this.trigger("移动结束"))}};A.on(cc.Node.EventType.TOUCH_END,P=>{B(P)},this),A.on(cc.Node.EventType.TOUCH_CANCEL,P=>{this.properties.listernTouchCancel==!0&&B(P)},this)}else if(this.useCanvas==!0){let A=this.graph.config.rootccNode;A==null&&(A=cc.director.getScene().getChildByName("Canvas")),A.targetOff(this)}else this.lastBindCodeNode!=null&&this.lastBindCodeNode.targetOff(this)}onAction(T,_){if(T=="监听"){var w=this.getInputData(0);this.realRun(w)}else if(T=="取消监听"){var w=this.getInputData(0);this.realRun(w,!1)}}setValue(T){this.setProperty("value",T)}}touchEnd.title="触摸结束";LiteGraph.registerNodeType("input/screen/touchEnd",touchEnd);class leftOrRightAct extends LGraphNode{constructor(){super();St(this,"title","重力感应");St(this,"desc","检测设备的陀螺仪");this.addOutput("x轴","number"),this.addOutput("y轴","number"),this.addOutput("z轴","number")}onChangeEvent(T){this.x=T.acc.x,this.y=T.acc.y,this.z=T.acc.z,this.setOutputData(0,this.x),this.setOutputData(1,this.y),this.setOutputData(2,this.z)}onStart(){cc.systemEvent.setAccelerometerEnabled(!0),this.curState=0,this.x=0,this.y=0,this.z=0,this.setOutputData(0,this.x),this.setOutputData(1,this.y),this.setOutputData(2,this.z),cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION,this.onChangeEvent,this)}onStop(){cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION,this.onChangeEvent,this)}}leftOrRightAct.title="重力感应";LiteGraph.registerNodeType("input/leftOrRightAct",leftOrRightAct);class AddRobot extends LGraphNode{constructor(){super();St(this,"title","加");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("A + B","number")}onExecute(){var T=this.getInputData(0);T===void 0&&(T=0);var _=this.getInputData(1);_===void 0&&(_=0),this.setOutputData(0,T+_)}}AddRobot.title="加";LiteGraph.registerNodeType("middle/calculate/add",AddRobot);class delRobot extends LGraphNode{constructor(){super();St(this,"title","减");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("A - B","number")}onExecute(){var T=this.getInputData(0);T===void 0&&(T=0);var _=this.getInputData(1);_===void 0&&(_=0),this.setOutputData(0,T-_)}}delRobot.title="减";LiteGraph.registerNodeType("middle/calculate/del",delRobot);class xRobot extends LGraphNode{constructor(){super();St(this,"title","乘");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("A x B","number")}onExecute(){var T=this.getInputData(0);T===void 0&&(T=0);var _=this.getInputData(1);_===void 0&&(_=0),this.setOutputData(0,T*_)}}xRobot.title="乘";LiteGraph.registerNodeType("middle/calculate/x",xRobot);class chuRobot extends LGraphNode{constructor(){super();St(this,"title","除");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("A ÷ B","number")}onExecute(){var T=this.getInputData(0);T===void 0&&(T=0);var _=this.getInputData(1);_===void 0&&(_=0),this.setOutputData(0,T/_)}}chuRobot.title="除";LiteGraph.registerNodeType("middle/calculate/chu",chuRobot);class lengthRobot extends LGraphNode{constructor(){super();St(this,"title","向量长度");this.addInput("x","number"),this.addInput("y","number"),this.addOutput("长度","number")}onExecute(){var T=this.getInputData(0);T===void 0&&(T=0);var _=this.getInputData(1);_===void 0&&(_=0);var w=Math.sqrt(T*T+_*_);this.setOutputData(0,w)}}lengthRobot.title="长度";LiteGraph.registerNodeType("middle/calculate/length",lengthRobot);class tointRobot extends LGraphNode{constructor(){super();St(this,"title","取整数");this.addInput("向下取整","number"),this.addInput("向上取整","number"),this.addInput("四舍五入","number"),this.addOutput("输出","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1),w=this.getInputData(2);T!==void 0?this.setOutputData(0,Math.floor(T)):_!==void 0?this.setOutputData(0,Math.ceil(_)):w!==void 0&&this.setOutputData(0,Math.round(w))}}tointRobot.title="取整数";LiteGraph.registerNodeType("middle/covert/toint",tointRobot);class squareRootRobot extends LGraphNode{constructor(){super();St(this,"title","平方根");this.addInput("输入","number"),this.addOutput("开平方","number")}onExecute(){var T=this.getInputData(0);T!==void 0&&this.setOutputData(0,Math.sqrt(T))}}squareRootRobot.title="平方根";LiteGraph.registerNodeType("middle/covert/squareRoot",squareRootRobot);class absRobot extends LGraphNode{constructor(){super();St(this,"title","绝对值");this.addInput("输入","number"),this.addOutput("绝对值","number")}onExecute(){var T=this.getInputData(0);T!==void 0&&this.setOutputData(0,Math.abs(T))}}absRobot.title="绝对值";LiteGraph.registerNodeType("middle/covert/abs",absRobot);class revertNegativeRobot extends LGraphNode{constructor(){super();St(this,"title","正负反转");this.addInput("输入","number"),this.addOutput("输出","number")}onExecute(){var T=this.getInputData(0);T!==void 0&&this.setOutputData(0,T*-1)}}revertNegativeRobot.title="正负反转";LiteGraph.registerNodeType("middle/covert/revertNegative",revertNegativeRobot);class angleDifferenceRobot extends LGraphNode{constructor(){super();St(this,"title","角度差");this.addInput("角度A","number"),this.addInput("角度B","number"),this.addOutput("输出","number"),this.addProperty("inputType","角度","enum",{values:["角度","向量"]}),this.addWidget("combo","输入的类型",this.properties.inputType,{property:"inputType",values:["角度","向量"]})}onExecute(){var T=this.getInputData(0),_=this.getInputData(1);if(T!==void 0&&_!==void 0){var w=0;if(this.properties.inputType==0||this.properties.inputType=="角度"){var B=Math.max(T,_)-Math.min(T,_);w=Math.min(360-B,B)}else{var A=T.x,O=T.y,R=_.x,P=_.y;let E=(Math.pow(A,2)+Math.pow(O,2)+Math.pow(R,2)+Math.pow(P,2)-(Math.pow(R-A,2)+Math.pow(P-O,2)))/(2*Math.sqrt(Math.pow(A,2)+Math.pow(O,2))*Math.sqrt(Math.pow(R,2)+Math.pow(P,2)));w=Math.acos(E)*(180/Math.PI)}this.setOutputData(0,w)}}}angleDifferenceRobot.title="角度差";LiteGraph.registerNodeType("middle/angleCalculate/angleDifference",angleDifferenceRobot);class vectorToAngelRobot extends LGraphNode{constructor(){super();St(this,"title","将位置转换为角度");this.addInput("x坐标","number"),this.addInput("y坐标","number"),this.addOutput("角度","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1);if(T!==void 0&&_!==void 0){var w=Math.atan2(this.number2,this.number1)*(180/Math.PI);this.setOutputData(0,w)}}}vectorToAngelRobot.title="将位置转换为角度";LiteGraph.registerNodeType("middle/angleCalculate/vectorToAngel",vectorToAngelRobot);class angleConvertVectorRobot extends LGraphNode{constructor(){super();St(this,"title","将角度转换为位置");this.addInput("角度","number"),this.addInput("斜边长","number"),this.addOutput("x长","number"),this.addOutput("y长","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1);if(T!==void 0&&_!==void 0){var w=180/Math.PI*T,B=Math.cos(w)*_,A=Math.sin(w)*_;this.setOutputData(0,B),this.setOutputData(1,A)}}}angleConvertVectorRobot.title="将角度转换为位置";LiteGraph.registerNodeType("middle/angleCalculate/angleConvertVector",angleConvertVectorRobot);class equireRobot extends LGraphNode{constructor(){super();St(this,"title","等于");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("A == B?","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1),w=0;T==_&&(w=1),this.setOutputData(0,w)}}equireRobot.title="等于";LiteGraph.registerNodeType("middle/compare/equire",equireRobot);class litterRobot extends LGraphNode{constructor(){super();St(this,"title","小于");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("A < B?","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1),w=0;T<_&&(w=1),this.setOutputData(0,w)}}litterRobot.title="小于";LiteGraph.registerNodeType("middle/compare/litter",litterRobot);class biggerRobot extends LGraphNode{constructor(){super();St(this,"title","大于");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("A > B?","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1),w=0;T>_&&(w=1),this.setOutputData(0,w)}}biggerRobot.title="大于";LiteGraph.registerNodeType("middle/compare/bigger",biggerRobot);class inRangeRobot extends LGraphNode{constructor(){super();St(this,"title","范围内");this.addInput("A","number"),this.addInput("B","number"),this.addInput("C","number"),this.addOutput("结果","number"),this.addProperty("A",0,"number"),this.addProperty("C",10,"number"),this.addProperty("firstCompire","<","enum",{values:["<","<="]}),this.addProperty("secCompire","<","enum",{values:["<","<="]}),this.addWidget("number","最小值A",0,"A",{precision:0}),this.addWidget("number","最大值C",10,"C",{precision:0}),this.addWidget("combo","A和B比较",this.properties.firstCompire,{property:"firstCompire",values:inRangeRobot.compireType}),this.addWidget("combo","B和C比较",this.properties.secCompire,{property:"secCompire",values:inRangeRobot.compireType})}getTitle(){var T=this.properties.firstCompire,_=this.properties.secCompire;return"A"+T+"B"+_+"C"}onExecute(){var T=this.getInputOrProperty("A"),_=this.getInputData(1),w=this.getInputOrProperty("C"),B=0,A=this.properties.firstCompire,O=this.properties.secCompire;A=="<"&&(B=T<_),A=="<="&&(B=T<=_),O=="<"&&(B=_<w),O=="<="&&(B=_<=w),B==!0&&(B=1),this.setOutputData(0,B)}}inRangeRobot.title="范围内";inRangeRobot.compireType=["<","<="];LiteGraph.registerNodeType("middle/compare/inRange",inRangeRobot);class allRightRobot extends LGraphNode{constructor(){super();St(this,"title","全部正确");this.addInput("A","number"),this.addInput("B","number"),this.addOutput("结果","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1),w=0;(T==0||T===void 0)&&(w=0),(_==0||_===void 0)&&(w=0),this.setOutputData(0,w)}}allRightRobot.title="全部正确";LiteGraph.registerNodeType("middle/logic/allRight",allRightRobot);class orRightRobot extends LGraphNode{constructor(){super();St(this,"title","任意一个正确");this.addInput("A","number"),this.addInput("B","number"),this.addInput("C","number"),this.addOutput("结果","number")}onExecute(){var T=this.getInputData(0),_=this.getInputData(1),w=this.getInputData(2),B=0;T!==void 0&&T!=0&&(B=1),_!==void 0&&_!=0&&(B=1),w!==void 0&&w!=0&&(B=1),this.setOutputData(0,B)}}orRightRobot.title="任意一个正确";LiteGraph.registerNodeType("middle/logic/orRight",orRightRobot);class allToggle extends LGraphNode{constructor(){super();St(this,"title","全部触发");this.mode=LiteGraph.ON_EVENT,this.addInput("触发_0",LiteGraph.ACTION),this.addInput("触发_1",LiteGraph.ACTION),this.addOutput("触发",LiteGraph.EVENT),this.addProperty("resetWhenToggle",!1,"boolean"),this.addWidget("toggle","触发后重置",this.properties.resetWhenToggle,"resetWhenToggle"),this.toggleFlag={}}onStop(){this.toggleFlag={}}onGetInputs(){return[["触发_"+this.inputs.length,LiteGraph.ACTION]]}onAction(T,_,w){this.toggleFlag[T]=1,Object.keys(this.toggleFlag).length==this.inputs.length&&(this.triggerSlot(0),this.properties.resetWhenToggle==!0&&(this.toggleFlag={}))}}allToggle.title="全部触发";LiteGraph.registerNodeType("middle/logic/allToggle",allToggle);class orToggle extends LGraphNode{constructor(){super();St(this,"title","任意触发");this.mode=LiteGraph.ON_EVENT,this.addInput("触发_0",LiteGraph.ACTION),this.addInput("触发_1",LiteGraph.ACTION),this.addOutput("触发",LiteGraph.EVENT)}getFreeSoltIndex(){let T=this.findSlotByType(!0,LiteGraph.ACTION,!1,!0,!0);return T==-1&&(this.addInput("触发_"+this.inputs.length,LiteGraph.ACTION),T=this.inputs.length-1),T}checkHasConnectMyInput(T){let _=!1;for(var w=0;w<this.inputs.length;w++){let B=this.getInputNode(w);if(B!=null&&B.id==T.id){_=!0;break}}return _}findConnectSoltIndex(T){let _=-1;for(var w=0;w<this.inputs.length;w++){let B=this.getInputNode(w);if(B!=null&&B.id==T){_=w;break}}return _}onGetInputs(){return[["触发_"+this.inputs.length,LiteGraph.ACTION]]}onAction(T,_,w){this.triggerSlot(0)}}orToggle.title="任意触发";LiteGraph.registerNodeType("middle/logic/orToggle",orToggle);class notRightRobot extends LGraphNode{constructor(){super();St(this,"title","反转结果");this.addInput("A","number"),this.addOutput("结果","number")}onExecute(){var T=this.getInputData(0),_=T?0:1;this.setOutputData(0,_)}}notRightRobot.title="反转结果";LiteGraph.registerNodeType("middle/logic/notRight",notRightRobot);class randomNumRobot extends LGraphNode{constructor(){super();St(this,"title","随机整数");St(this,"des","如果没有输入值，返回一个大于0的随机整数");this.addInput("随机范围","number"),this.addOutput("结果","number"),this.addProperty("modal","每次随机","enum",{values:["仅一次","每次随机"]}),this.addWidget("combo","",this.properties.modal,{property:"modal",values:["仅一次","每次随机"]})}onExecute(){var T=this.getInputData(0);if(T===void 0&&(T=1e7),this.properties.modal=="每次随机"){var _=Math.floor(Math.random()*T);this.setOutputData(0,_)}else this.random==null&&(this.random=Math.floor(Math.random()*T),this.setOutputData(0,this.random))}}randomNumRobot.title="随机整数";LiteGraph.registerNodeType("middle/change/randomNum",randomNumRobot);class timeDownRobot extends LGraphNode{constructor(){super();St(this,"title","延迟触发");St(this,"desc","等待时间如果为0的话表示等待1帧。输入的值不为0时即执行倒计时，输入值为0时停止倒计时，输出的值为当前输出帧和上一帧的时间差");this.addProperty("time_in_s",1),this.widget=this.addWidget("number","秒",1,"time_in_s",{precision:2,min:0,step:.1}),this.addInput("开始",LiteGraph.ACTION),this.addOutput("结束时",LiteGraph.EVENT),this._pending=[]}onAction(T,_,w){var B=this.properties.time_in_s;B<=0?this.triggerSlot(0):this._pending.push([B,_])}onExecute(){var T=this.graph.elapsed_time;this.isInputConnected(1)&&(this.properties.time_in_s=this.getInputData(1));for(var _=0;_<this._pending.length;++_){var w=this._pending[_];w[0]-=T,!(w[0]>0)&&(this._pending.splice(_,1),--_,this.triggerSlot(0))}}onGetInputs(){return[["time_in_s","number"]]}onStop(){this._pending=[]}}timeDownRobot.title="延迟触发";LiteGraph.registerNodeType("middle/change/timeDown",timeDownRobot);class timerRobot extends LGraphNode{constructor(){super();St(this,"title","间隔触发");St(this,"desc","等待时间如果为0的话表示等待1帧。输入的值不为0时即执行倒计时，输入值为0时停止倒计时，输出的值为当前输出帧和上一帧的时间差");this.addProperty("interval",1e3),this.addProperty("event","tick"),this.widget=this.addWidget("number","毫秒",1e3,"interval",{precision:0}),this.addOutput("触发",LiteGraph.EVENT),this.time=0,this.last_interval=1e3,this.triggered=!1}getTitle(){return this.graph.state==LGraph.STATUS_RUNNING?"每隔"+this.last_interval.toString()+"ms":timerRobot.title}onStart(){this.time=0}onAction(T,_,w){var B=this.properties.interval;B<=0?this.trigger(null,_,w):this._pending.push([B,_])}onExecute(){var T=this.graph.elapsed_time*1e3,_=this.time==0;if(this.time+=T,this.last_interval=Math.max(1,this.getInputOrProperty("interval")|0),!_&&(this.time<this.last_interval||isNaN(this.last_interval))){this.inputs&&this.inputs.length>1&&this.inputs[1]&&this.setOutputData(1,!1);return}this.triggered=!0,this.time=this.time%this.last_interval,this.triggerSlot(0,this.properties.event),this.inputs&&this.inputs.length>1&&this.inputs[1]&&this.setOutputData(1,!0)}onDrawBackground(){this.boxcolor=this.triggered?timerRobot.on_color:timerRobot.off_color,this.triggered=!1}onGetInputs(){return[["interval","number"]]}}timerRobot.on_color="#AAA";timerRobot.off_color="#222";timerRobot.title="间隔触发";LiteGraph.registerNodeType("middle/change/timeDownCycle",timerRobot);class upCountRobot extends LGraphNode{constructor(){super();St(this,"title","计数");St(this,"desc","等待时间如果为0的话表示等待1帧。输入的值不为0时即执行倒计时，输入值为0时停止倒计时，输出的值为当前输出帧和上一帧的时间差");this.mode=LiteGraph.ON_EVENT,this.addInput("开始值","number"),this.addInput("增加",LiteGraph.ACTION),this.addInput("减少",LiteGraph.ACTION),this.addInput("重置",LiteGraph.ACTION),this.addOutput("数值","number"),this.addOutput("变化",LiteGraph.EVENT),this.addProperty("开始值",0,"number"),this.addWidget("number","开始值",0,"开始值",{precision:0}),this.addProperty("modal","无限制","enum",{values:["无限制","范围限制","循环","来回"]}),this.addWidget("combo","模式",this.properties.modal,{property:"modal",values:["无限制","范围限制","循环","来回"]}),this.addProperty("min",1,"number"),this.addWidget("number","最小值",1,"min",{precision:0}),this.addProperty("max",10,"number"),this.addWidget("number","最大值",10,"max",{precision:0}),this.addProperty("upStepmodal","不乘以时间","enum",{values:["乘以时间","不乘以时间"]}),this.addWidget("combo","步进模式",this.properties.upStepmodal,{property:"upStepmodal",values:["乘以时间","不乘以时间"]}),this.addProperty("stepValue",1,"number"),this.addWidget("number","步进数值",1,"stepValue",{precision:0}),this.updateWidght()}onStart(){this.repetDir=1,this.value=this.getInputOrProperty("开始值")|0}updateWidght(){var T=this.properties.modal;T!="无限制"?this.widgets.map(_=>{(_.name=="最大值"||_.name=="最小值")&&(_.disabled=!1)}):this.widgets.map(_=>{(_.name=="最大值"||_.name=="最小值")&&(_.disabled=!0)})}onWidgetChanged(T,_,w,B){T=="模式"&&this.updateWidght()}onAction(T,_,w){var B=this.getInputOrProperty("开始值")||0;this.value==null&&(this.value=B),T=="增加"?this.upCount(1):T=="减少"?this.upCount(-1):T=="重置"&&(this.value=B,this.setOutputData(0,this.value))}upCount(T){var _=this.properties.stepValue,w=this.properties.min,B=this.properties.max,A=this.properties.upStepmodal=="不乘以时间"?1:this.graph.elapsed_time*1e3,O=this.properties.modal;this.value+=this.repetDir*A*_*T,O=="范围限制"?this.value>B&&(this.value=B):O=="循环"?this.value>B&&(this.value=w):O=="来回"&&(this.number>=B?this.repetDir=-1:this.number<=w&&(this.repetDir=1)),this.setOutputData(0,this.value),this.triggerSlot(1)}onExecute(){this.upCount(1)}}upCountRobot.title="计数";LiteGraph.registerNodeType("middle/change/upCount",upCountRobot);class checkTagRobot extends LGraphNode{constructor(){super();St(this,"title","标记状态");St(this,"des","用于标记一个执行中的状态");this.addInput("值","number"),this.addInput("修改",LiteGraph.ACTION),this.addOutput("输出","number"),this.addProperty("customeName","","string"),this.addWidget("text","状态名称","","customeName"),this.addProperty("customeValue","","string"),this.addWidget("text","初始值","","customeValue"),this.addProperty("container",checkTagRobot.GRAPH,"enum",{values:checkTagRobot.containerEnum}),this.addWidget("combo","状态权限",this.properties.container,{property:"container",values:checkTagRobot.containerEnum}),this.addProperty("modal","自定义","enum",{values:checkTagRobot.modalEnum}),this.addWidget("combo","",this.properties.modal,{property:"modal",values:checkTagRobot.modalEnum}),this.addProperty("initWithValue",!1,"boolean"),this.addWidget("toggle","初始化时将自定义状态值赋值",this.properties.initWithValue,"initWithValue"),this.updateWidght()}updateWidght(){var T=this.properties.modal;T=="自定义"?this.widgets.map(_=>{_.name=="状态名称"&&(_.disabled=!1)}):this.widgets.map(_=>{_.name=="状态名称"&&(_.disabled=!0)})}onWidgetChanged(T,_,w,B){console.log("onWidgetChanged",T,_,w),T==""&&this.updateWidght()}getContainer(){switch(this.properties.container){case checkTagRobot.GRAPH:return this.graph?this.graph.vars:{};case checkTagRobot.GLOBALSCOPE:return window;case checkTagRobot.LITEGRAPH:default:return LiteGraph.Globals}}getVarName(){return this.properties.modal!="自定义"?this.properties.modal:this.properties.customeName}getTitle(){return this.getVarName()}onStart(){var T=this.getContainer(),_=this.getVarName();this.properties.customeValue!=""&&(this.value=this.properties.customeValue,T[_]=this.value,this.setOutputData(0,this.value))}onAction(T,_,w){if(T=="修改"){var B=this.getContainer(),A=this.getVarName();this.isInputConnected(0)?this.value=this.getInputData(0):this.value=this.properties.customeValue,B[A]=this.value,this.setOutputData(0,this.value)}}onExecute(){var T=this.getContainer(),_=this.getVarName();this.setOutputData(0,T[_])}}checkTagRobot.modalEnum=["自定义","动画是否播放中","是否不可交互","游戏是否开始","游戏是否结束","引导是否显示","当前执行逻辑","逻辑A是否触发","逻辑B是否触发","逻辑C是否触发","逻辑D是否触发"];checkTagRobot.LITEGRAPH="所有分镜";checkTagRobot.GRAPH="仅当前分镜";checkTagRobot.GLOBALSCOPE="Window";checkTagRobot.containerEnum=[checkTagRobot.GRAPH,checkTagRobot.LITEGRAPH,checkTagRobot.GLOBALSCOPE];checkTagRobot.title="标记状态";LiteGraph.registerNodeType("middle/change/checkTag",checkTagRobot);class dataObjectRobot extends LGraphNode{constructor(){super();St(this,"title","数据结构");St(this,"desc","输出对象的key和values，如果挂载的是对象，循环对象中每个key，如果是数组，循环数组每个i，每每次循环都会触发toggle事件");this.addInput("挂载","object"),this.addOutput("key",0),this.addOutput("value",0),this.addOutput("触发",LiteGraph.EVENT)}onGetOutputs(){return console.log("我调用了onGetOutputs"),[["number","string"],["被引用","lgraphNode"]]}onStart(){}onExecute(){var T=this.getInputData(0);if(T!==void 0){if(T instanceof Array)for(var _=0;_<T.length;_++)this.setOutputData(0,_),this.setOutputData(1,T[_]),this.triggerSlot(2);else if(T instanceof Object)for(var w in T)this.setOutputData(0,w),this.setOutputData(1,T[w]),this.triggerSlot(2)}}}dataObjectRobot.title="数据结构";LiteGraph.registerNodeType("middle/change/dataObject",dataObjectRobot);class getKeyValueRobot extends LGraphNode{constructor(){super();St(this,"title","对象取值");St(this,"desc","和数据结构不同的是，这里取出特定的某个值");this.addInput("obj","object"),this.addOutput("property",0),this.addProperty("value",0),this.addWidget("text","输入key","","value"),this.widgets_up=!0,this.size=[140,30],this._value=null}getTitle(){return this.flags.collapsed?"获取."+this.properties.value:this.title}onGetOutputs(){return console.log("我调用了onGetOutputs"),[["number","string"],["被引用","lgraphNode"]]}onExecute(){var T=this.getInputData(0);T!=null&&this.setOutputData(0,T[this.properties.value])}}getKeyValueRobot.title="对象取值";LiteGraph.registerNodeType("middle/change/getKeyValue",getKeyValueRobot);class getArrayValueRobot extends LGraphNode{constructor(){super();St(this,"title","数组取值");St(this,"desc","和数据结构不同的是，这里取出特定的某个值");this.addInput("array","array,table,string"),this.addInput("index","number"),this.addOutput("value",""),this.addProperty("index",0),this.addWidget("number","index",0,"index",{precision:0})}getTitle(){return this.flags.collapsed?"获取."+this.properties.index:this.title}onGetOutputs(){return console.log("我调用了onGetOutputs"),[["number","string"],["被引用","lgraphNode"]]}onExecute(){var T=this.getInputData(0),_=this.getInputData(1);_==null&&(_=this.properties.index),!(T==null||_==null)&&this.setOutputData(0,T[Math.floor(Number(_))])}}getArrayValueRobot.title="数组取值";LiteGraph.registerNodeType("middle/change/getArrayValue",getArrayValueRobot);class sendData extends LGraphNode{constructor(){super();St(this,"title","无线传送发射");St(this,"desc","用于无线连接节点");this.addInput("附带值",0),this.addInput("发送",LiteGraph.ACTION),this.addProperty("customeName","A","string"),this.addWidget("string","发送事件",this.properties.customeName,"customeName")}getTitle(){return this.flags.collapsed?"发送事件."+this.properties.customeName:this.title}onAction(T,_){let w=this.getInputData(0);this.graph.sendEventToAllNodes(this.properties.customeName,w)}}sendData.title="无线传送发射";LiteGraph.registerNodeType("middle/tool/sendData",sendData);class acceptData extends LGraphNode{constructor(){super();St(this,"title","无线传送接收");St(this,"desc","用于无线连接节点");this.size=[140,30],this.addOutput("接收值",0),this.addOutput("接收",LiteGraph.EVENT),this.addProperty("customeName","A","string"),this.addWidget("string","接收事件",this.properties.customeName,"customeName")}onStart(){this[this.properties.customeName]=this.onEvent}getTitle(){return this.flags.collapsed?"接收事件."+this.properties.customeName:this.title}onEvent(T){console.log("我接收到了事件",T),this.setOutputData(0,T),this.triggerSlot(1,T)}}acceptData.title="无线传送接收";LiteGraph.registerNodeType("middle/tool/acceptData",acceptData);class outputLine extends LGraphNode{constructor(){super();St(this,"title","输出逻辑线");St(this,"desc","根据输入值，触发不同的输出");this.addInput("输入值","number"),this.addInput("触发",LiteGraph.ACTION),this.addOutput("output_0",LiteGraph.EVENT),this.addOutput("output_1",LiteGraph.EVENT)}onGetOutputs(){return[["output_"+this.outputs.length,LiteGraph.EVENT],["被引用","lgraphNode"]]}onAction(T,_){let w=Number(this.getInputData(0));console.log("当前outputLine输入的值",w),this.outputs[w]!=null&&this.triggerSlot(w)}}outputLine.title="输出逻辑线";LiteGraph.registerNodeType("middle/tool/outputLine",outputLine);class lightingOut extends LGraphNode{constructor(){super();St(this,"title","动态取值");St(this,"desc","动态输出需要的值");this.addInput("引用节点","lgraphNode")}onGetOutputs(){let T=this.getInputNode(0);if(T==null)return[];{let B={};for(var _=0;_<this.outputs.length;_++){let O=this.outputs[_];B[O.name]=1}let A=[];for(var w in T.properties)B[w]==null&&A.push([w,0]);return A}}onExecute(){let T=this.getInputNode(0);for(var _=0;_<this.outputs.length;_++){let w=this.outputs[_];this.setOutputData(_,T.properties[w.name])}}}lightingOut.title="动态取值";LiteGraph.registerNodeType("middle/tool/lightingOut",lightingOut);class lighting extends LGraphNode{constructor(){super();St(this,"title","动态赋值");St(this,"desc","动态设置引用节点的值");this.addInput("引用节点","lgraphNode"),this.addInput("触发赋值",LiteGraph.ACTION)}onGetInputs(){let T=this.getInputNode(0);if(T==null)return[];{let B={};for(var _=0;_<this.inputs.length;_++){let O=this.inputs[_];B[O.name]=1}let A=[];for(var w in T.properties)B[w]==null&&A.push([w,0]);return A}}onAction(T,_){let w=this.getInputNode(0);if(w!=null&&!(this.inputs.length<2))for(var B=2;B<this.inputs.length;B++){let A=this.inputs[B],O=this.getInputData(B);w.properties[A.name]!=null&&O!=null&&w.setProperty(A.name,O)}}}lighting.title="动态赋值";LiteGraph.registerNodeType("middle/tool/lighting",lighting);class textCode extends LGraphNode{constructor(){super();St(this,"title","js文本");St(this,"desc","直接运行代码片段");this.mode=LiteGraph.ON_TRIGGER,this.addInput("输入参数",0),this.addOutput("输出结果",0),this.addProperty("codeString","","string"),this.addWidget("text","执行代码片段",this.properties.codeString,"codeString",{multiline:!0})}onExecute(){this.getInputData(0);var valueB=0;let codeString=this.properties.codeString;try{eval(codeString)}catch(S){console.warn("文本代码执行失败",S)}this.setOutputData(0,valueB)}}textCode.title="js文本";LiteGraph.registerNodeType("middle/tool/textCode",textCode);const Constants={APP_ID:"145d2560",API_KEY:"4c75d2411acf143f4145ba8b72a03bdc",API_SECRET:"MTM3ZWQ2Y2Y4ZmEyMTEwYWVmMDg3NmRk"},config={hostUrl:"wss://cbm01.cn-huabei-1.xf-yun.com/v1/private/mcd9m97e6",host:"cbm01.cn-huabei-1.xf-yun.com",apiSecret:"MTM3ZWQ2Y2Y4ZmEyMTEwYWVmMDg3NmRk",apiKey:"4c75d2411acf143f4145ba8b72a03bdc"};function base64ToBlob(L,S){S=S||"";const T=L,_=T.length,w=new Uint8Array(_);for(let B=0;B<_;B++)w[B]=T.charCodeAt(B);return new Blob([w],{type:S})}function getAuthUrl(){var L=config.hostUrl,S=config.host,T=config.apiKey,_=config.apiSecret,w=new Date().toGMTString(),B="hmac-sha256",A="host date request-line",O="host: ".concat(S,"\ndate: ").concat(w,"\nGET /v1/private/mcd9m97e6 HTTP/1.1"),R=cryptoJsExports.HmacSHA256(O,_),P=cryptoJsExports.enc.Base64.stringify(R),E='api_key="'.concat(T,'", algorithm="').concat(B,'", headers="').concat(A,'", signature="').concat(P,'"'),D=btoa(E);return L="".concat(L,"?authorization=").concat(D,"&date=").concat(w,"&host=").concat(S),L}class VoiceGen{static async genSound(S){return new Promise((T,_)=>{try{const w=getAuthUrl(),B=new WebSocket(w),A={header:{app_id:Constants.APP_ID,status:2},parameter:{oral:{spark_assist:1,oral_level:"mid"},tts:{vcn:S.vcn,speed:S.speed,volume:S.volume,pitch:S.pitch,bgs:S.bgs,reg:0,rdn:0,rhy:0,audio:{encoding:"lame",sample_rate:24e3,channels:1,bit_depth:16,frame_size:0}}},payload:{text:{encoding:"utf8",compress:"raw",format:"json",status:2,seq:0,text:window.btoa(unescape(encodeURIComponent(S.text)))}}};console.log(A);let O="";B.onopen=R=>{B.send(JSON.stringify(A))},B.onclose=R=>{},B.onmessage=R=>{let P=JSON.parse(R.data);if(P.payload!=null&&P.payload.audio.audio!=null&&(O+=window.atob(P.payload.audio.audio),P.payload.audio.status==2)){let E=base64ToBlob(O,"audio/mp3");T(E),B.close()}},B.onerror=R=>{console.error(R),T(null)}}catch(w){console.error(w),T(null)}})}}class showTextTip extends LGraphNode{constructor(){super();St(this,"title","文字提示");St(this,"desc","弹出文字提示信息");St(this,"color","#510");this.mode=LiteGraph.ON_EVENT,this.addProperty("msg",""),this.addInput("",LiteGraph.EVENT),this.widget=this.addWidget("text","Text","","msg"),this.widgets_up=!0,this.size=[200,30]}onExecute(){}setValue(T){this.setProperty("value",T)}onAction(T,_){var w=this.properties.msg;showAlert(w)}}showTextTip.title="文字提示";LiteGraph.registerNodeType("output/tips/showTextTip",showTextTip);class showConfirm extends LGraphNode{constructor(){super();St(this,"title","确认框");St(this,"desc","弹出文字提示确认框，用户可点击确认或取消");St(this,"color","#510");this.mode=LiteGraph.ON_EVENT,this.addProperty("msg",""),this.addInput("",LiteGraph.EVENT),this.widget=this.addWidget("text","Text","","msg"),this.addOutput("确认",LiteGraph.EVENT),this.addOutput("取消",LiteGraph.EVENT)}onAction(T,_){var w=this.properties.msg;showConfirm$1(w,B=>{B==!0?this.trigger("确认"):this.trigger("取消")})}}showConfirm.title="确认框";LiteGraph.registerNodeType("output/tips/showConfirm",showConfirm);class showHandTip extends LGraphNode{constructor(){super();St(this,"title","触摸提示");St(this,"desc","播放一个触摸提示的动画");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addInput("显示",LiteGraph.ACTION),this.addInput("关闭",LiteGraph.ACTION),this.addOutput("结束",LiteGraph.EVENT),this.properties.modal=showHandTip.modalEnum[0],this.addWidget("combo","类型",this.properties.modal,{property:"modal",values:showHandTip.modalEnum}),this.properties.scale=1,this.addWidget("number","大小",this.properties.scale,"scale",{precision:1}),this.properties.x=0,this.addWidget("number","拖拽终点-x",this.properties.x,"x",{precision:0}),this.properties.y=0,this.addWidget("number","拖拽终点-y",this.properties.y,"y",{precision:0}),this.properties.length=100,this.addWidget("number","长度或半径",this.properties.length,"length",{precision:0}),this.properties.speed=400,this.addWidget("number","速度",this.properties.length,"speed",{precision:0}),this.updateWidght(),this.addWidget("button","预览效果","",()=>{this.showTips()}),this.addWidget("button","创建触摸动画","",()=>{this.createLinkNode()})}createLinkNode(){if(this.getInputNode(0)==null){let T=LiteGraph.createNode("objects/createObject");T.pos=[this.pos[0]-this.width-3,this.pos[1]],T.setProperty("x",0),T.setProperty("y",0),T.setProperty("modal",ObjectTypeEnum.spine),T.setProperty("customeName","P0_Common_Finger"),T.properties.nodeConfig.x=0,T.properties.nodeConfig.y=0,this.graph.add(T),T.connect(0,this,0)}}updateWidght(){var T=this.properties.modal;this.widgets.map(_=>{_.name=="拖拽终点-x"||_.name=="拖拽终点-y"?_.disabled=T!="拖拽":_.name=="长度或半径"?_.disabled=T=="拖拽"||T=="单次点击"||T=="快速点击"||T=="长按":_.name=="速度"&&(_.disabled=T=="单次点击"||T=="快速点击"||T=="长按")})}onWidgetChanged(T){T=="类型"&&this.updateWidght()}onSelected(){this.showTips()}upDateOriPos(){var T=this.getInputLink(0);if(T==null)return;var _=this.graph.getNodeById(T.origin_id);if(_==null)return;let w=this.getInputData(0);_.properties.x!=null&&w!=null&&(w.x=_.properties.x,w.y=_.properties.y)}onDeselected(){this.hideTips();let T=this.getInputData(0);this.oriX!=null&&T!=null&&(T.x=this.oriX,T.y=this.oriY)}onPause(){this.inShowTips==!0&&this.hideTips()}onResume(){this.inShowTips==!0&&this.showTips()}onStop(){}showTips(){let T=this.getInputData(0);if(T==null){console.warn("showTips 当前没有关联codeNode");return}T.useCenterMode=!1,cc.Tween.stopAllByTarget(this),cc.Tween.stopAllByTag(this.getIdWithGraph()),this.upDateOriPos(),T.center=[T.x,T.y],T.active=!0,T.scale=this.properties.scale;var _=showHandTip.modalEnum.indexOf(this.properties.modal),w=T.spineCom;if(w!=null)if(_==0)w.setAnimation(0,"act1",!0),w.setCompleteListener(I=>{this.outputHandle()});else if(_==1)w.setAnimation(0,"act2",!0),w.setCompleteListener(I=>{this.outputHandle()});else if(_==2){w.setAnimation(0,"act3_1",!1),w.addAnimation(0,"act3_2",!0);var B=this.properties.x,A=this.properties.y,O=T.x-B,R=T.y-A;if(this.properties.speed==0)return;var P=Math.sqrt(R*R+O*O)/this.properties.speed;if(P==0)return;cc.tween(T).tag(this.getIdWithGraph()).delay(.3).to(P,{x:B,y:A}).call(()=>{w.loop=!1,w.addAnimation(0,"act3_3",!1),cc.tween(this).delay(1).call(()=>{this.outputHandle(),this.showTips()}).start()}).start()}else if(_==3){var E=this.properties.length;if(this.properties.speed==0)return;var P=E/this.properties.speed;if(w.setAnimation(0,"act3_2",!0),P==0)return;cc.tween(T).tag(this.getIdWithGraph()).to(P,{y:T.y-E}).to(P*2,{y:T.y+E}).to(P,{y:T.y}).call(()=>{this.outputHandle(),this.showTips()}).start()}else if(_==4){var E=this.properties.length;if(this.properties.speed==0)return;var P=Math.abs(E/this.properties.speed);if(w.setAnimation(0,"act3_2",!0),P==0)return;cc.tween(T).tag(this.getIdWithGraph()).to(P,{x:T.x-E}).to(P*2,{x:T.x+E}).to(P,{x:T.x}).call(()=>{this.outputHandle(),this.showTips()}).start()}else if(_==5){if(T.radius=this.properties.length,T.useCenterMode=!0,this.properties.speed==0)return;var P=Math.abs(Math.PI*2/(this.properties.speed*.01));if(P==0)return;w.setAnimation(0,"act3_2",!0);var D=this.properties.speed>0?360:-360;cc.tween(T).tag(this.getIdWithGraph()).by(P,{angleToPos:D}).call(()=>{this.outputHandle(),this.showTips()}).start()}else _==6&&(w.setAnimation(0,"act3_1",!1),w.addAnimation(0,"act3_2",!0),cc.tween(this).delay(2).call(()=>{w.loop=!1,w.addAnimation(0,"act3_3",!1),cc.tween(this).delay(.8).call(()=>{this.outputHandle(),this.showTips()}).start()}).start());else console.warn("showTip 目标没有spine")}outputHandle(){this.triggerSlot(0)}hideTips(){cc.Tween.stopAllByTarget(this);let T=this.getInputData(0);if(T==null){console.warn("showTips 当前没有关联codeNode");return}T!=null&&(T.useCenterMode=!1,cc.Tween.stopAllByTag(this.getIdWithGraph()),T.spineCom!=null&&T.spineCom.clearTrack(0),T.active=!1)}onStart(){this.onAction("关闭")}onAction(T,_){T=="显示"?(this.inShowTips=!0,this.showTips()):T=="关闭"&&(this.inShowTips=!1,this.hideTips())}}showHandTip.title="触摸提示";showHandTip.modalEnum=["单次点击","快速点击","拖拽","上下滑动","左右滑动","转圈","长按"];LiteGraph.registerNodeType("output/tips/showHandTip",showHandTip);class blockTouch extends LGraphNode{constructor(){super();St(this,"title","屏蔽触摸");St(this,"desc","屏蔽触摸事件，简化流程");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("开启",LiteGraph.ACTION),this.addInput("关闭",LiteGraph.ACTION)}onStop(){blockTouch$1(!1)}onAction(T,_){T=="开启"?blockTouch$1(!0):T=="关闭"&&blockTouch$1(!1)}}blockTouch.title="屏蔽触摸";LiteGraph.registerNodeType("output/blockTouch",blockTouch);class consoleInfo extends LGraphNode{constructor(){super();St(this,"title","输出控制台");St(this,"desc","打印内容到控制台");this.mode=LiteGraph.ON_EVENT,this.addInput("msg",0),this.addInput("log",LiteGraph.ACTION),this.addInput("warn",LiteGraph.ACTION),this.addInput("error",LiteGraph.ACTION),this.addProperty("msg",""),this.addWidget("string","msg",this.properties.msg,"msg"),this.widgets_up=!0}onExecute(){var T=this.getInputOrProperty("msg");console.log("consoleInfo:",T)}setValue(T){this.setProperty("value",T)}onGetInputs(){return[["log",LiteGraph.ACTION],["warn",LiteGraph.ACTION],["error",LiteGraph.ACTION]]}onAction(T,_){var w=this.getInputOrProperty("msg");T=="log"?console.log("consoleInfo",w):T=="warn"?console.warn("consoleInfo",w):T=="error"&&console.error("consoleInfo",w)}onDrawBackground(T){this.getInputData(0)!=null?this.inputs[0].label="msg:"+this.getInputData(0):this.inputs[0].label="msg"}}consoleInfo.title="输出控制台";LiteGraph.registerNodeType("output/tips/consoleInfo",consoleInfo);class restartGame extends LGraphNode{constructor(){super();St(this,"title","重新开始");St(this,"desc","重新开始游戏流程");this.mode=LiteGraph.ON_EVENT,this.size=[80,20],this.addInput("重启",LiteGraph.ACTION)}onAction(T,_){T=="重启"&&(this.graph.stop(),this.graph.start())}}restartGame.title="重新开始";LiteGraph.registerNodeType("output/game/restartGame",restartGame);class changeGame extends LGraphNode{constructor(){super();St(this,"title","切换页面");St(this,"desc","切换到新的页面");this.mode=LiteGraph.ON_EVENT,this.size=[80,20],this.addProperty("pageIndex",0,"number"),this.addWidget("number","页码",this.properties.pageIndex,"pageIndex",{precision:0,min:1}),this.addProperty("gamePath","","string"),this.addWidget("string","页面名称",this.properties.gamePath,"gamePath"),this.addInput("切换",LiteGraph.ACTION)}onAction(T,_){T=="切换"&&(this.graph.stop(),changeGraph(this.properties.gamePath,this.properties.pageIndex-1))}}changeGame.title="切换页面";LiteGraph.registerNodeType("output/game/changeGame",changeGame);class endGame extends LGraphNode{constructor(){super();St(this,"title","页面结束");St(this,"desc","这一页阅读结束了");this.mode=LiteGraph.ON_EVENT,this.size=[80,20],this.addInput("结束",LiteGraph.ACTION)}onAction(T,_){}}endGame.title="页面结束";LiteGraph.registerNodeType("output/game/endGame",endGame);class sendEventToBook extends LGraphNode{constructor(){super();St(this,"title","通知绘本操作");St(this,"desc","操作绘本相关事件");this.mode=LiteGraph.ON_EVENT,this.addInput("触发",LiteGraph.ACTION),this.addInput("param",0),this.addProperty("modal","隐藏底部字幕","string"),this.addWidget("combo","事件",this.properties.modal,{property:"modal",values:sendEventToBook.modalEnum}),this.addProperty("param","","string"),this.addWidget("string","附加信息",this.properties.param,"param"),this.widgets_up=!0,this.setSize(this.computeSize())}onAction(T,_){}}sendEventToBook.title="通知绘本操作";sendEventToBook.modalEnum=["隐藏底部字幕"];sendEventToBook.modalEnumDit={隐藏底部字幕:"OnHideReadText"};LiteGraph.registerNodeType("output/game/sendEventToBook",sendEventToBook);class sound extends LGraphNode{constructor(){super();St(this,"title","播放音频");St(this,"desc","播放一段音频");this.mode=LiteGraph.ALWAYS,this.addInput("播放",LiteGraph.ACTION),this.addInput("停止",LiteGraph.ACTION),this.addInput("字幕","array"),this.addOutput("结束",LiteGraph.EVENT),this.addOutput("是否结束","boolean"),this.addProperty("modal","自定义","string"),this.addWidget("combo","选择音频",this.properties.modal,{property:"modal",values:sound.modalEnum}),this.addProperty("customeName","","string"),this.addWidget("string","资源",this.properties.customeName,"customeName"),this.addProperty("yinggui","无","enum"),this.addWidget("combo","选择音轨",this.properties.yinggui,{property:"yinggui",values:["无","A","B","C","D","E","F","G"]}),this.addProperty("loop",!1,"boolean"),this.addWidget("toggle","是否循环",this.properties.loop,"loop"),this.addProperty("volume",.5,"number"),this.addWidget("slider","音量",this.properties.volume,"volume",{min:0,max:1,precision:2,step2:.01}),this.addProperty("autoRun",!1,"boolean"),this.addWidget("toggle","是否自动播放",this.properties.autoRun,"autoRun"),this.addProperty("delayTime",0,"number"),this.addWidget("number","延迟几秒播放",this.properties.delayTime,"delayTime"),this.addProperty("duration",0,"number");let T=this.addWidget("number","音频时长",this.properties.duration,"duration");T.disabled=!0,this.addWidget("button","","",_=>{console.log("btnWidget",_.clickeName),_.clickeName!=""&&this.onAction(_.clickeName)},{buttons:["播放","停止"]}),this.addProperty("motionTextData",[],"array"),this.addWidget("button","编辑字幕","",()=>{window.onGraphMenuClick!=null&&window.onGraphMenuClick("editSoundText",{customeName:this.properties.customeName,motionTextData:this.properties.motionTextData,id:this.getIdWithGraph(),onValueChange:_=>{if(console.log("返回的data",_),this.getInputNode(2)==null){let B=LiteGraph.createNode("objects/createObject");B.pos=[this.pos[0]-30,this.pos[1]],B.setProperty("zIndex",996),B.setProperty("x",0),B.setProperty("y",0),this.graph.add(B);let A=LiteGraph.createNode("objects/textGroup");A.pos=[this.pos[0]-10,this.pos[1]],this.graph.add(A);for(var w=0;w<_.length;w++)A.addLine(),A.setProperty("text"+(w+1),_[w].text);B.connect(0,A,0),A.connect(0,this,2),A.freshTexts(_),window.onGraphMenuClick!=null&&(this.graph.setDirtyCanvas(!0,!0),window.onGraphMenuClick("layoutNodesJustX"))}else{let B=this.getInputNode(2);for(;B.properties.linesNum!=0;)B.removeLine();for(var w=0;w<_.length;w++)B.addLine(),B.setProperty("text"+(w+1),_[w].text);B.freshTexts(_)}}})})}onPropertyChanged(T,_){if(T=="customeName"){var w=_;this.clip=null,cc.assetManager.loadRemote(rootHost+"/"+w,(B,A)=>{if(B!=null){console.warn("加载音频失败",B);return}this.clip=A,this.setProperty("duration",A.duration)})}else T=="modal"&&_!="自定义"&&this.setProperty("customeName",sound.modalDit[_])}onStart(){if(this.properties.motionTextData!=null&&this.properties.motionTextData.length>0){let T=this.getInputNode(2);T!=null&&T.freshTexts(this.properties.motionTextData)}this.properties.autoRun&&this.onAction("播放")}onPause(){this.audioID!=null&&cc.audioEngine.pause(this.audioID)}onResume(){this.audioID!=null&&cc.audioEngine.resume(this.audioID)}getTitle(){return this.flags.collapsed?"播放音频."+this.properties.customeName.split(".")[0]:this.title}onConfigure(){this.updateWidght()}updateWidght(){var T=this.properties.modal;this.widgets.map(_=>{_.name=="资源"&&(_.disabled=T!="自定义")})}onWidgetChanged(T){T=="选择音频"&&this.updateWidght()}onStop(){this.onAction("停止")}realPlayAudio(){let T=this.properties.yinggui,_=this.graph.config.audioArray,w=this.properties.volume;this.graph.config.mute==!0&&(w=0);var B=this.properties.customeName;if(console.log("准备播放音频",B),this.clip==null)cc.assetManager.loadRemote(rootHost+"/"+B,(O,R)=>{if(O!=null){console.warn("加载音频失败",O);return}if(!(T!="无"&&_[T]!=this.getIdWithGraph())){R.addRef(),this.clip=R;var P=cc.audioEngine.play(R,this.properties.loop,w);this.audioID!=null&&cc.audioEngine.stop(this.audioID),this.audioID=P,cc.audioEngine.setFinishCallback(this.audioID,()=>{this.triggerSlot(0),this.setOutputData(1,!0),this.playEndCb!=null&&this.playEndCb()})}});else{if(T!="无"&&_[T]!=this.getIdWithGraph())return;var A=cc.audioEngine.play(this.clip,this.properties.loop,w);this.audioID!=null&&cc.audioEngine.stop(this.audioID),this.audioID=A,cc.audioEngine.setFinishCallback(this.audioID,()=>{this.triggerSlot(0),this.setOutputData(1,!0),this.playEndCb!=null&&this.playEndCb()})}}onAction(T,_){let w=this.properties.yinggui,B=this.graph.config.audioArray;if(B==null&&(this.graph.config.audioArray={},B=this.graph.config.audioArray),T=="播放"){this.onAction("停止");let O=this.getInputNode(2);if(O!=null&&(O.properties.showInPageBottom==!0||O.onAction("播放")),w!="无"){var A=B[w];A!=null&&(A=this.graph.getNodeById(A),A!=null&&A.onAction("停止")),B[w]=this.getIdWithGraph(),console.log("设置音轨播放的id",w,this.getIdWithGraph())}this.setOutputData(1,!1),this.properties.delayTime>0?(this.curWaitTime=this.properties.delayTime,this.mode=LiteGraph.ALWAYS):this.realPlayAudio()}else if(T=="停止"){let O=this.getInputNode(2);O!=null&&(O.properties.showInPageBottom==!0||O.onAction("停止")),B[w]==this.getIdWithGraph()&&(B[w]=null),this.audioID!=null&&cc.audioEngine.stop(this.audioID),this.clip!=null&&(this.clip.decRef(),this.clip=null),this.audioID=null,this.curWaitTime=null}}onExecute(){if(this.curWaitTime!=null){var T=this.graph.elapsed_time;this.curWaitTime-=T,this.curWaitTime<=0&&(this.curWaitTime=null,this.realPlayAudio())}}}sound.title="播放音频";sound.modalEnum=["自定义","胜利","开始","正确","错误"];sound.modalDit={胜利:"WIN.d434ffea.mp3",错误:"错误.4893a3c2.mp3",开始:"readygo.a873eb49.mp3",正确:"dinlin.1ac6169b.mp3"};LiteGraph.registerNodeType("output/sound",sound);class textToSound extends LGraphNode{constructor(){super();St(this,"title","文本转音频");St(this,"desc","接入文本生成音频接口实现文本生成配音");this.mode=LiteGraph.ON_EVENT,this.addProperty("text","今天天气真不错"),this.addWidget("text","文本",this.properties.text,"text"),this.addProperty("soundName","xunfei"),this.addWidget("text","命名",this.properties.soundName,"soundName"),this.addProperty("peopleSound",textToSound.peopleSounds[1],"enum"),this.widget=this.addWidget("combo","音色",this.properties.peopleSound,{property:"peopleSound",values:textToSound.peopleSounds}),this.addProperty("speed",50,"number"),this.addWidget("slider","语速",this.properties.speed,"speed",{precision:0,min:0,max:100}),this.addProperty("volume",50,"number"),this.addWidget("slider","音量",this.properties.volume,"volume",{precision:0,min:0,max:100}),this.addProperty("pitch",50,"number"),this.addWidget("slider","语调",this.properties.pitch,"pitch",{precision:0,min:0,max:100}),this.addProperty("bgs",!1,"boolean"),this.addWidget("toggle","背景音",this.properties.bgs,"bgs"),this.btnWidget=this.addWidget("button","生成音频","",async()=>{let T=textToSound.peopleSoundDit[this.properties.peopleSound];this.btnWidget.disabled=!0;let _=await VoiceGen.genSound({text:this.properties.text,vcn:T,speed:this.properties.speed,volume:this.properties.volume,pitch:this.properties.pitch,bgs:this.properties.bgs==!0?1:0});this.btnWidget.disabled=!1,window.uploadGroupFile!=null&&window.uploadGroupFile([{files:[_],type:"mp3",name:this.properties.soundName,x:this.pos[0]+this.width+3,y:this.pos[1]}])}),this.setSize(this.computeSize())}onAction(T,_){}}textToSound.title="文本转音频";textToSound.peopleSounds=["聆飞逸","聆小璇","聆小玥","聆玉昭","聆玉言","动漫少女"];textToSound.peopleSoundDit={聆飞逸:"x5_lingfeiyi_flow",聆小璇:"x5_lingxiaoxuan_flow",聆小玥:"x5_lingxiaoyue_flow",聆玉昭:"x5_lingyuzhao_flow",聆玉言:"x5_lingyuyan_flow",动漫少女:"x6_dongmanshaonv_pro"};LiteGraph.registerNodeType("output/textToSound",textToSound);class vibrate extends LGraphNode{constructor(){super();St(this,"title","震动");St(this,"desc","调用设备振动");this.mode=LiteGraph.ON_EVENT,this.size=[80,20],this.addInput("震动",LiteGraph.ACTION),this.addProperty("modal",0,"number"),this.addWidget("slider","振动强度",this.properties.modal,"modal",{min:0,max:1,precision:0})}onAction(T,_){T=="震动"&&(this.properties.modal<.5?vibrate$1(!1):vibrate$1(!0))}}vibrate.title="震动";LiteGraph.registerNodeType("output/vibrate",vibrate);class stopTime extends LGraphNode{constructor(){super();St(this,"title","停止时间");St(this,"desc","暂停游戏时间");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("停止",LiteGraph.ACTION),this.addInput("恢复",LiteGraph.ACTION)}onAction(T,_){T=="停止"?this.graph.pause():T=="恢复"&&this.graph.resume()}}stopTime.title="停止时间";LiteGraph.registerNodeType("output/time/stopTime",stopTime);class timeScale extends LGraphNode{constructor(){super();St(this,"title","时间缩放");St(this,"desc","加速或减慢时间效果");this.mode=LiteGraph.ON_EVENT,this.size=[80,20],this.addInput("scale","number"),this.addProperty("scale",1,"number"),this.addWidget("number","缩放倍数",this.properties.scale,"scale",{precision:1,min:0}),this.addInput("修改",LiteGraph.ACTION),this.widgets_up=!0}onAction(T,_){if(T=="修改"){let w=this.properties.scale||1;w<0&&(w=1),this.graph.config.timeScale=w,this.graph.sendEventToAllNodes("onChangeTimeScale")}}}timeScale.title="时间缩放";LiteGraph.registerNodeType("output/time/timeScale",timeScale);class autoRunRecordTouch extends LGraphNode{constructor(){super();St(this,"title","自动点击");St(this,"desc","自动执行点击事件");this.size=[80,20],this.addProperty("active",!1,"boolean"),this.addWidget("toggle","是否激活",this.properties.active,"active"),this.addProperty("recordTouch",[],"array"),this.widgets_up=!0}onStart(){this.curRunStepIndex=-1}onExecute(){if(this.properties.active==!1||this.properties.recordTouch==null)return;let T=this.graph.getTime();if(this.properties.recordTouch[this.curRunStepIndex+1]!=null&&T>this.properties.recordTouch[this.curRunStepIndex+1].time){this.curRunStepIndex+=1;let _=this.properties.recordTouch[this.curRunStepIndex],w=this.graph.getNodeById(_.nodeId);w!=null&&w[_.funcName]!=null&&w[_.funcName]()}}}autoRunRecordTouch.title="自动点击";LiteGraph.registerNodeType("output/autoRunRecordTouch",autoRunRecordTouch);const SpineRuntime={cache:{},async get(L,S){const T=SpineRuntime.cache;S==null&&(S="webgl");var _=L+"_"+S;if(T[_]==null){const B="../assets/spine-runtimes/".concat(L,"/spine-").concat(S,".js");var{spine:w}=await import(B);T[_]=w,T[_].version=L}return T[_]}};class SpineToImg{constructor(S){St(this,"assets",{dir:null,json:null,skel:null,atlas:null,png:null});St(this,"viewScale",1);St(this,"skin","");St(this,"animation","");St(this,"timeScale",1);St(this,"loop",!0);St(this,"autoSetAni",!1);St(this,"premultipliedAlpha",!1);St(this,"drawBones",!1);St(this,"drawBoundingBoxes",!1);St(this,"drawMeshTriangles",!1);St(this,"drawPaths",!1);St(this,"version","unknown");St(this,"canvasColor","#be4c4c");St(this,"clearColor",[.3,.3,.3]);St(this,"assetManager",null);St(this,"skeletonData",null);St(this,"animationState",null);St(this,"dragOffset",[0,0]);St(this,"renderWidth",130);St(this,"canvas",null);St(this,"gl",null);St(this,"spine",null);St(this,"_eventDit",null);St(this,"mode","webgl");St(this,"canRender",!1);S!=null&&(this.mode=S)}events(){if(!this.skeletonData||!this.skeletonData.animations)return{};if(this._eventDit!=null)return this._eventDit;let S={};for(var T=0;T<this.skeletonData.animations.length;T++){let _=this.skeletonData.animations[T];if(_.timelines!=null)for(let w=0;w<_.timelines.length;w++){let B=_.timelines[w],A=_.name;if(B.events!=null)for(let O=0;O<B.events.length;O++){let R={time:B.events[O].time,name:B.events[O].data.name};S[A]==null&&(S[A]=[]),S[A].push(R)}}}return this._eventDit=S,S}skins(){if(!this.skeletonData||!this.skeletonData.skins)return[];let S=this.skeletonData.skins.map(T=>T.name);if(S.length>1){let T=S.indexOf("default");S.splice(T,1)}return S}animations(){return!this.skeletonData||!this.skeletonData.animations?[]:this.skeletonData.animations.map(S=>S.name)}debug(){return this.drawBones||this.drawBoundingBoxes||this.drawMeshTriangles||this.drawPaths}duration(){return this.animationState?this.animationState.getCurrent(0).animation.duration:0}assetsInfo(){if(!this.assetManager)return"no assetManager";let S="",T="",_="";for(const B in this.assetManager.assets){var w=B.split(".");switch(w="."+w[w.length-1],w){case".json":case".skel":{S=B;break}case".png":{T=B;break}case".atlas":{_=B;break}}}return"💀 [Skeleton]\n· ".concat(S,"\n\n🖼 [Texture]\n· ").concat(T,"\n\n🗺 [Atlas]\n· ").concat(_)}offset(){return"(".concat(this.dragOffset[0],", ").concat(-this.dragOffset[1],")")}reset(){this.assets=null,this.viewScale=1,this.skin="",this.animation="",this.timeScale=1,this.loop=!0,this.premultipliedAlpha=!1,this.drawBones=!1,this.drawBoundingBoxes=!1,this.drawMeshTriangles=!1,this.drawPaths=!1,this.version="unknown",this.canvasColor="#7a5050",this.skeleton=null,this.bounds=null,this.skeletonData=null,this.animationState=null,this.gl&&this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.shader=null,this.batcher=null,this.mvp=null,this.skeletonRenderer=null,this.assetManager=null,this.debugRenderer=null,this.debugShader=null,this.shapeRenderer=null,this.lastFrameTime=null,this.dragOffset=[0,0],this.image=null,this.canRender=!1,this.oriImg=null,this._eventDit=null}async getRuntime(){let S=this.getAssetSpineVersion(this.assets.json||this.assets.skel);S||(console.warn("Unable to identify Spine version of asset!"),S="3.8"),console.log("Skeleton spine version",S),S=S.split(".").slice(0,2).map(_=>parseInt(_)).join(".");let T=await SpineRuntime.get(S,this.mode);if(!T){let _="noSpineRuntime | version: ".concat(S);return console.warn(_),!1}return this.spine=T,this.version=T.version,!0}getAssetSpineVersion(S){return"3.7"}initRuntime(){this.canvas==null&&(this.canvas=document.getElementById("spinetoimg"),this.canvas==null&&(this.canvas=document.createElement("canvas"),this.canvas.id="spinetoimg",this.canvas.style.position="fixed",this.canvas.style.top=0,this.canvas.style.left=0,this.canvas.style.opacity=0,this.canvas.style.zIndex=-1999,this.canvas.width=130,this.canvas.height=130,document.body.append(this.canvas)));let S=this.canvas;if(!this.gl){const _={alpha:!1};if(this.gl=S.getContext("webgl",_),!this.gl){console.warn("没有webgl");return}const w=this.clearColor;this.gl.clearColor(w[0],w[1],w[2],1)}this.spine==null&&console.warn("没有spine");var T=this.spine;this.shader=T.webgl.Shader.newTwoColoredTextured(this.gl),this.batcher=new T.webgl.PolygonBatcher(this.gl),this.mvp=new T.webgl.Matrix4,this.mvp.ortho2d(0,0,S.width-1,S.height-1),this.skeletonRenderer=new T.webgl.SkeletonRenderer(this.gl),this.debugRenderer=new T.webgl.SkeletonDebugRenderer(this.gl),this.debugShader=T.webgl.Shader.newColored(this.gl),this.shapeRenderer=new T.webgl.ShapeRenderer(this.gl),this.assetManager=new T.webgl.AssetManager(this.gl)}loadAssets(){const S=this.assetManager;if(!S)return;const T=this.assets;if(T.dir&&(S.pathPrefix=T.dir),T.json)S.loadText(T.json);else if(T.skel)S.loadBinary(T.skel);else{console.warn("noSkeletonData");return}S.loadTextureAtlas?S.loadTextureAtlas(T.atlas):(S.loadText(T.atlas),S.loadTexture(T.png)),requestAnimationFrame(this.loading.bind(this))}isLoadingComplete(){return this.assetManager==null?!1:this.assetManager.isLoadingComplete()}isLoadIngError(){return this.assetManager==null?!1:this.assetManager.hasErrors()}loading(){if(this.assetManager!=null)if(this.assetManager.isLoadingComplete()){if(!this.loadSkeleton()){this.reset();return}var S=this.skins();if(S[0]!=null&&this.setSkin(S[0]),this.autoSetAni==!0){var T=this.animations();T[0]!=null&&this.playAnimation(T[0])}this.lastFrameTime=Date.now()/1e3,this.render(),this.genPreviewImg()}else requestAnimationFrame(this.loading.bind(this))}loadSkeleton(){const S=this.assetManager,T=this.assets;let _=S.get(T.atlas),w=this.spine;if(w==null){console.log("spine == null");return}w.version==="3.5"&&(_=new w.TextureAtlas(_));const B=new w.AtlasAttachmentLoader(_);try{if(T.json){const O=new w.SkeletonJson(B);this.skeletonData=O.readSkeletonData(S.get(T.json))}else if(T.skel){const O=new w.SkeletonBinary(B);this.skeletonData=O.readSkeletonData(S.get(T.skel))}}catch(O){return console.error(O),!1}this.skeleton=new w.Skeleton(this.skeletonData),this.bounds=this.calculateBounds();const A=new w.AnimationStateData(this.skeleton.data);return this.animationState=new w.AnimationState(A),!0}setSkin(S){if(this.skeleton){this.skin=S;try{this.skeleton.setSkinByName(S)}catch(T){}this.skeleton.setSlotsToSetupPose()}}playAnimation(S){this.skeleton&&(this.animation=S,this.skeleton.setToSetupPose(),this.animationState.setAnimation(0,S,this.loop))}setTimeScale(S){this.skeleton&&(this.animationState.timeScale=S)}calculateBounds(){this.skeleton.setToSetupPose(),this.skeleton.updateWorldTransform();const S=new spine.Vector2,T=new spine.Vector2;return this.skeleton.getBounds(S,T,[]),T.x>0||(T.x=this.skeletonData.width,T.y=this.skeletonData.height,S.x=this.skeletonData.width*-.5,S.y=this.skeletonData.height*-.5),{offset:S,size:T}}render(){if(!this.skeleton)return;const S=Date.now()/1e3,T=S-this.lastFrameTime;if(this.lastFrameTime=S,this.resizeView(),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.animationState.update(T),this.animationState.apply(this.skeleton),this.skeleton.updateWorldTransform(),this.shader.bind(),this.shader.setUniformi(this.spine.webgl.Shader.SAMPLER,0),this.shader.setUniform4x4f(this.spine.webgl.Shader.MVP_MATRIX,this.mvp.values),this.batcher.begin(this.shader),this.skeletonRenderer.premultipliedAlpha=this.premultipliedAlpha,this.skeletonRenderer.draw(this.batcher,this.skeleton),this.batcher.end(),this.shader.unbind(),this.debug()){let _=this.debugShader,w=this.debugRenderer;_.bind(),_.setUniform4x4f(this.spine.webgl.Shader.MVP_MATRIX,this.mvp.values),w.premultipliedAlpha=this.premultipliedAlpha,w.drawBones=this.drawBones,w.drawBoundingBoxes=this.drawBoundingBoxes,w.drawRegionAttachments=this.drawBoundingBoxes,w.drawMeshHull=this.drawMeshTriangles,w.drawMeshTriangles=this.drawMeshTriangles,w.drawPaths=this.drawPaths,w.drawSkeletonXY=this.drawBones,this.shapeRenderer.begin(_),w.draw(this.shapeRenderer,this.skeleton),this.shapeRenderer.end(),_.unbind()}}genPreviewImg(){if(this.canvas!=null){this.renderWidth=130,this.canvas.height=130,this.render();var S=this.canvas.toDataURL("image/png"),T=new Image;T.src=S,this.image=T,this.canRender=!0}}getImgUrlOri(S,T){if(this.canRender==!0){if(this.oriImg!=null)return this.oriImg;S==null?this.renderWidth=null:this.renderWidth=S,T!=null&&(this.canvas.height=T),this.render();var _=this.canvas.toDataURL("image/png");return this.oriImg=_,_}}resizeView(){let S=this.canvas;if(S==null)return;let T=this.bounds;var _=T.size.x/T.size.y;this.renderWidth!=null?S.width=this.renderWidth*_:(S.width=T.size.x,S.height=T.size.y);const w=S.width,B=S.height,A=T.offset.x+T.size.x/2||0,O=T.offset.y+T.size.y/2||0,R=T.size.x/w,P=T.size.y/B;let E=Math.max(R,P);E<1&&(E=1),E/=this.viewScale;const D=w*E,I=B*E,M=A-D/2-this.dragOffset[0]*E,N=O-I/2+this.dragOffset[1]*E;this.mvp.ortho2d(M,N,D,I),this.gl.viewport(0,0,w,B)}async setAssets(S){if(this.assets&&this.reset(),!S)return;this.assets=S;let T=await this.getRuntime();this.processAssetPaths(),T&&(this.initRuntime(),this.loadAssets())}processAssetPaths(){const S=this.assets,{dir:T,json:_,skel:w,png:B,atlas:A}=S;console.log("当前版本",this.version),this.version=="3.7"?(this.assets.json="/"+_,this.assets.atlas="/"+A):this.version=="3.8"&&(this.assets.dir+="/")}onLayoutResize(){const S=layout.style,T=this.$refs.properties.style;layout.clientWidth>=800||layout.clientHeight<330?layout.clientWidth>=350?(S.flexDirection="row",T.width="265px",T.marginTop="0",T.marginLeft="5px",T.display="flex"):T.display="none":(S.flexDirection="column",T.width="100%",T.marginTop="5px",T.marginLeft="0",T.display="flex")}}class BaseYWNode extends LGraphNode{constructor(){super();St(this,"title","自定义LGraphNode基础类");St(this,"desc","其余LGraphNode继承于此")}onAdded(){this.sendAddEvent()}onRemoved(){this.sendRemoveEvent()}onSelected(){this.sendOtherEvent("onSelected")}onDeselected(){this.sendOtherEvent("onDeselected")}onConnectInput(T,_,w,B,A){this.sendConnectEvent(T,B,A)}disconnectInput(T,_){this.sendDisConnectEvent(T,_),super.disconnectInput(T,_)}onPropertyChanged(T,_,w){this.sendPropertyChangeEvent(T,_,w)}sendPropertyChangeEvent(T,_,w){if(this.graph!=null&&window.channel!=null){let B=JSON.parse(JSON.stringify({id:this.id,property:T,value:_}));window.channel.postMessage({type:"nodeEvent",func:"onPropertyChanged",datas:B})}}sendBtnWidgetClickEvent(T){if(this.graph!=null&&window.channel!=null){let _=JSON.parse(JSON.stringify({id:this.id,buttonName:T}));window.channel.postMessage({type:"nodeEvent",func:"onBtnWidgetClick",datas:_})}}sendRemoveEvent(){if(this.graph!=null&&window.channel!=null){let T=JSON.parse(JSON.stringify({id:this.id}));window.channel.postMessage({type:"nodeEvent",func:"onRemove",datas:T})}}sendConnectEvent(T,_,w){if(this.graph!=null&&window.channel!=null){let B=JSON.parse(JSON.stringify({id:this.id,inputIndex:T,linkedNodeId:_.id,outputIndex:w}));window.channel.postMessage({type:"nodeEvent",func:"onConnect",datas:B})}}sendDisConnectEvent(T,_){if(this.graph!=null&&window.channel!=null){let w=JSON.parse(JSON.stringify({id:this.id,slot:T,keepReroutes:_}));window.channel.postMessage({type:"nodeEvent",func:"onDisConnect",datas:w})}}sendAddEvent(){if(this.graph!=null&&window.channel!=null){let T=JSON.parse(JSON.stringify({id:this.id,type:this.type,params:this.properties}));window.channel.postMessage({type:"nodeEvent",func:"onAdd",datas:T})}}sendOtherEvent(T,_){if(this.graph!=null&&window.channel!=null){let w=JSON.parse(JSON.stringify({id:this.id,funcName:T,params:_}));window.channel.postMessage({type:"nodeEvent",func:"justRunFunc",datas:w})}}onStart(){this._hasShowTips=!1}oneClickCreateTouchTip(){let T=LiteGraph.createNode("objects/createObject");T.setProperty("modal","spine"),T.setProperty("customeName","c7007391/Common_Click"),T.setProperty("x",0),T.setProperty("y",0),T.setProperty("zIndex",99),T.setProperty("premulAlpha",!1),T.onWidgetChanged("物体类型"),T.pos=[this.pos[0],this.pos[1]+this.height+130],this.graph.add(T);let _=T.onGetOutputs(),w=_.findIndex(A=>A[1]=="lgraphNode");w!=-1&&T.addOutput(_[w][0],_[w][1]),T.connect(T.outputs.length-1,this,2);let B=LiteGraph.createNode("objects/animates/animate");B.pos=[T.pos[0]+T.width+3,T.pos[1]],B.setProperty("loop",!0),B.setProperty("autoRun",!0),this.graph.add(B),T.connect(0,B,0),setTimeout(()=>{B.getEnums()},1e3)}showClickTip(){if(this._hasShowTips==!0)return;if(this.properties.tipsJustOnce==!0&&(this._hasShowTips=!0),this.properties.canClickOutLine==!0){let w=this.getInputData(0);w!=null&&(w.outLineWidth=5)}let T=this.findInputSlot("触摸提示");if(console.log("showClickTip",T),T==-1)return;let _=this.getInputNode(T);_!=null&&_.codeNode!=null&&_.codeNode.playAnimation("1Open",!0)}hideClickTip(){if(this.properties.canClickOutLine==!0){let w=this.getInputData(0);w!=null&&(w.outLineWidth=0)}let T=this.findInputSlot("触摸提示");if(T==-1)return;let _=this.getInputNode(T);_!=null&&_.codeNode!=null&&_.codeNode.playAnimation("2Close",!1)}playLinkSound(){let T=this.findInputSlot("关联音频");if(T==-1)return;let _=this.getInputNode(T);_!=null&&_.onAction!=null&&_.onAction("播放")}hasLinkSound(){let T=this.findInputSlot("关联音频");return T==-1?!1:this.getInputLink(T)!=null}hasLinkIsCanClick(){let T=this.findInputSlot("isCanClick");return T==-1?!1:this.getInputLink(T)!=null}removeProperty(T){this.properties_info==null&&(this.properties_info=[]);let _=this.properties_info.findIndex(w=>w.name==T);this.properties_info.splice(_,1),this.properties==null&&(this.properties={}),delete this.properties[T]}}const soundFxs=["无","popOut.mp3"];class createObject extends BaseYWNode{constructor(){super();St(this,"title","物体");St(this,"desc","在界面中创建一个物体");this.mode=LiteGraph.ON_EVENT,this.addInput("创建",LiteGraph.ACTION),this.addOutput("物体","codeNode"),this.addProperty("group",!1,"boolean"),this.addWidget("toggle","是否作为UI",this.properties.group,"group"),this.addProperty("modal","空物体","enum"),this.addWidget("combo","物体类型",this.properties.modal,{property:"modal",values:objectTypes}),this.addProperty("customeName","","string"),this.addWidget("string","资源",this.properties.customeName,"customeName"),this.addProperty("showTime",0,"number"),this.addWidget("combo","加载时机",this.properties.showTime,{property:"showTime",values:{0:"初始化时",1:"输入时"}}),this.addProperty("premulAlpha",!1,"boolean"),this.addWidget("toggle","是否预乘",this.properties.premulAlpha,"premulAlpha"),this.addProperty("zIndex",1,"number"),this.addWidget("number","层级",this.properties.zIndex,"zIndex",{precision:0}),this.addProperty("dynamiczIndex",!1,"boolean"),this.addWidget("toggle","以y轴动态计算层级",this.properties.dynamiczIndex,"dynamiczIndex"),this.addProperty("x",-1280,"number"),this.addWidget("number","坐标-x",this.properties.x,"x",{precision:2}),this.addProperty("y",-750,"number"),this.addWidget("number","坐标-y",this.properties.y,"y",{precision:2}),this.addProperty("scaleX",1,"number"),this.addWidget("number","缩放-x",this.properties.scaleX,"scaleX",{precision:2}),this.addProperty("scaleY",1,"number"),this.addWidget("number","缩放-y",this.properties.scaleY,"scaleY",{precision:2}),this.addProperty("opacity",255,"number"),this.addWidget("slider","透明度",this.properties.opacity,"opacity",{min:0,max:255,precision:0}),this.addProperty("angle",0,"number"),this.addWidget("number","角度",this.properties.angle,"angle",{min:-360,max:360,precision:0}),this.addProperty("anchorX",.5,"number"),this.addWidget("number","锚点x",this.properties.anchorX,"anchorX",{min:-1,max:1,precision:1,step2:.1}),this.addProperty("anchorY",.5,"number"),this.addWidget("number","锚点y",this.properties.anchorY,"anchorY",{min:-1,max:1,precision:1,step2:.1}),this.addProperty("width",50,"number"),this.widthWidget=this.addWidget("number","宽度",this.properties.width,"width",{precision:0,min:0,max:9999}),this.addProperty("height",50,"number"),this.heightWidget=this.addWidget("number","高度",this.properties.height,"height",{precision:0,min:0,max:9999}),this.addWidget("button","重置为资源尺寸","",()=>{console.log("点击了重置按钮"),this.resetSizeConfig()}),this.addProperty("color","#ffffff","string"),this.addWidget("string","物体颜色",this.properties.color,"color"),this._hasToggleAssestLoad=!1,this.addProperty("nodeConfig",{x:this.properties.x,y:this.properties.y,width:this.properties.width,height:this.properties.height,anchorX:this.properties.anchorX,anchorY:this.properties.anchorY,scaleX:this.properties.scaleX,scaleY:this.properties.scaleY,color:this.properties.color,angle:this.properties.angle},"object"),this.nodeConfigWidget=this.addWidget("ccnode","节点操控",this.properties.nodeConfig,"nodeConfig",{viewWidth:designViewWidth,viewHeight:designViewHeight}),this.addProperty("string","","string"),this.addWidget("string","文本",this.properties.string,"string"),this.addProperty("outLineWidth",0,"number"),this.addWidget("slider","描边宽度",this.properties.outLineWidth,"outLineWidth",{precision:0,min:0,max:100}),this.addProperty("outLineColor","#ffffff","string"),this.addWidget("string","描边颜色",this.properties.outLineColor,"outLineColor"),this.addProperty("colliderValue",{},"object")}getExtraMenuOptions(T){return[{content:"编辑碰撞框",callback:()=>{window.onGraphMenuClick!=null&&(Array.isArray(this.properties.colliderValue)==!0&&(this.properties.colliderValue={}),window.onGraphMenuClick("editColider",{img:this.getPreviewImg(),scale:this.properties.colliderValue.scale||1,pointArr:this.properties.colliderValue.pointArr||[],onValueChange:(_,w)=>{console.log("pointArr",_,w),this.properties.colliderValue.pointArr=_,this.properties.colliderValue.baseWidth=this.properties.width,this.properties.colliderValue.baseHeight=this.properties.height,this.properties.colliderValue.scale=w;let B=0,A=0;this._renderSpine!=null&&this._renderSpine.canRender&&(B=this._renderSpine.bounds.offset.x+.5*this.properties.width,A=this._renderSpine.bounds.offset.y+.5*this.properties.height),this.properties.colliderValue.offsetX=B,this.properties.colliderValue.offsetY=A,this.codeNode!=null&&(this.codeNode.destroyNode(),this.codeNode=null,this.setOutputData(0,null),this.createObj())}}))}}]}onAdded(){console.log("节点添加到蓝图中了",this.properties.customeName,this.properties.modal),this.updateWidght(),this.updateRenderAssest(),this.setSize(this.computeSize()),this.sendAddEvent()}onRemoved(){this.codeNode!=null&&(this.codeNode.destroyNode(),this.codeNode=null,this.setOutputData(0,null)),this._image=null,this._renderSpine=null,this.sendRemoveEvent(),this.checkAssestTimeOut!=null&&(clearInterval(this.checkAssestTimeOut),this.checkAssestTimeOut=null)}onConfigure(){isInImport!=!0&&(this.updateWidght(),this.updateRenderAssest(),this.graph&&isSinglePreview==!0||this.graph&&this.graph.list_of_graphcanvas!=null&&this.graph.list_of_graphcanvas.length>0&&this.createObj(()=>{this.properties.modal=="spine"&&setTimeout(()=>{try{let T=this.getOutputNodes(0);if(T!=null&&(T=T.filter(_=>_.type=="objects/animates/animate"&&_.properties.autoRun==!0),T[0]!=null)){let _=T[0];_.onSelected();let w=_.properties.skin;this.codeNode.setSkin(w),this.codeNode.playAnimation(_.properties.playAniName,_.properties.loop)}}catch(T){}},1e3)}))}onStartBeforeLoad(){console.log("createObject onStart",this.properties.showTime);var T=this.properties.showTime;T==0&&(this.graph.config.assestTotal+=1,this.createObj(()=>{this.graph.config.assestLoaded+=1,this.graph.checkAssestLoadComplete!=null&&this.graph.checkAssestLoadComplete()}))}createObj(T){if(this.codeNode!=null){if(cc.isValid(this.codeNode.node)==!0){var _={...this.properties};syncConfigToCodeNode(this.codeNode,_),T!=null&&T(),this.setOutputData(0,this.codeNode);return}this.codeNode=null,this.setOutputData(0,null)}var _={...this.properties},w=this.graph.vars.rootccNode;return w!=null&&(_.parent=w),this.codeNode=createObj(_,T),this.codeNode.graph=this.graph,console.log("我创建了的codeNode",this.codeNode.node._id),this.setOutputData(0,this.codeNode),this.codeNode}updateOutputData(T){console.log("我收到了更新物体的事件",T),this.setOutputData(T,this.codeNode)}onAction(T,_){T=="创建"&&this.createObj()}getTitle(){var T=this.properties.modal;if(T=="文本"){let _=this.properties.string.length<9?this.properties.string:this.properties.string.substring(0,8)+"..";T+=":"+_}return this.inputs,T}updateWidght(){var T=this.properties.modal;this.widgets.map(_=>{(_.name=="文本"||_.name=="描边颜色")&&(_.hidden=T!="文本"),(_.name=="锚点x"||_.name=="锚点y"||_.name=="宽度"||_.name=="高度")&&(_.disabled=T=="spine")})}onPause(){this.codeNode!=null&&(this.codeNode.spineCom!=null&&(this.codeNode.spineCom.paused=!0),cc.director.getActionManager().pauseTarget(this.codeNode))}onChangeTimeScale(){this.codeNode!=null&&this.codeNode.spineCom!=null&&this.graph.config.timeScale!=null&&(this.codeNode.spineCom.timeScale=this.graph.config.timeScale)}onResume(){this.codeNode!=null&&(this.codeNode.spineCom!=null&&(this.codeNode.spineCom.paused=!1),cc.director.getActionManager().resumeTarget(this.codeNode))}onStop(){if(this.codeNode.targetOff(),this.codeNode!=null&&isInApp==!1){var T={...this.properties.nodeConfig};syncConfigToCodeNode(this.codeNode,T)}}onPropertyChanged(T,_,w){if(T!="nodeConfig"&&typeof this.nodeConfigWidget.value=="object"&&this.nodeConfigWidget.value[T]!=null&&(this.nodeConfigWidget.value[T]=_,this.properties.nodeConfig[T]=_),this.codeNode!=null){if(cc.isValid(this.codeNode.node)==!1){this.codeNode=null;return}var B={};T=="nodeConfig"?B={..._}:B[T]=this.properties[T],syncConfigToCodeNode(this.codeNode,B),T=="string"&&this.resetSizeConfig()}this.sendPropertyChangeEvent(T,_,w)}onWidgetChanged(T,_,w,B){T=="物体类型"?(this.updateWidght(),this.updateRenderAssest()):T=="资源"&&this.updateRenderAssest(),this.sendOtherEvent("onWidgetChanged",[T])}updateRenderAssest(){if(isInImport!=!0){var T=this.properties.modal,_=this.properties.customeName;if(console.log("updateRenderAssest",T,_),T!="spine"&&(this._renderSpine=null),T!="图片"&&this._image!=null&&(this._image.src=null,this._image=null),T=="图片"){this._image==null&&(this._image=new Image);var w=rootHost+"/"+_;this._image.src!=w&&(this._image.src=w,this._hasToggleAssestLoad=!1,this.checkAssestTimeOut!=null&&(clearInterval(this.checkAssestTimeOut),this.checkAssestTimeOut=null),this.checkAssestTimeOut=setInterval(()=>{this.checkAssestLoaded()},500))}else if(T=="spine"){this._renderSpine==null&&(this._renderSpine=new SpineToImg);var B=_+".json";(this._renderSpine.assets==null||this._renderSpine.assets.json!=B)&&(this._hasToggleAssestLoad=!1,this.checkAssestTimeOut!=null&&(clearInterval(this.checkAssestTimeOut),this.checkAssestTimeOut=null),this.checkAssestTimeOut=setInterval(()=>{this.checkAssestLoaded()},500),this._renderSpine.setAssets({dir:rootHost,json:_+".json",atlas:_+".atlas"}))}else T=="文本"?(this.createObj(),this.resetSizeConfig()):T=="空物体"&&this.createObj()}}updateSpinePreview(T){this._renderSpine!=null&&(this._renderSpine.setSkin(T),this._renderSpine.genPreviewImg())}resetSizeConfig(){var T=this.properties.width,_=this.properties.height;this._image!=null?this._image.naturalWidth>0&&this._image.naturalHeight>0&&(T=this._image.width,_=this._image.height):this._renderSpine!=null?this._renderSpine.canRender&&(T=this._renderSpine.bounds.size.x,_=this._renderSpine.bounds.size.y):this.properties.modal=="文本"&&(console.log("当前是否有text节点",this.codeNode),this.codeNode!=null&&(T=this.codeNode.width,_=this.codeNode.height)),console.log("width",T,_),this.widthWidget.setValue(T,{e:null,node:this,canvas:null}),this.heightWidget.setValue(_,{e:null,node:this,canvas:null});var w=this.properties.nodeConfig;w.width=T,w.height=_,this.properties.modal!="文本"&&this.createObj()}getPreviewImg(){if(this._image!=null)return this._image.complete==!1||!(this._image.naturalWidth>0&&this._image.naturalHeight>0)?void 0:this._image.src;if(this._renderSpine!=null&&this._renderSpine.canRender)return this._renderSpine.getImgUrlOri()}checkAssestLoaded(T){var _=this.properties.modal;if(_=="图片"){if(this._image!=null){if(this._image.complete==!1)return;if(!(this._image.naturalWidth>0&&this._image.naturalHeight>0)){T!=null&&this.drawErrorTips(T);return}if(this._hasToggleAssestLoad==!1&&(this.resetSizeConfig(),this._hasToggleAssestLoad=!0,this.checkAssestTimeOut!=null&&(clearInterval(this.checkAssestTimeOut),this.checkAssestTimeOut=null)),T!=null){var w=this.drawAssestBox(T,this._image.width,this._image.height);T.drawImage(this._image,w.x,w.y,w.width,w.height)}}}else if(_=="spine"&&this._renderSpine!=null)if(this._renderSpine.canRender){if(T!=null&&this._renderSpine.image!=null&&this._renderSpine.image.naturalWidth>0&&this._renderSpine.image.naturalHeight>0){let B=this.getOutputNodes(0);if(B!=null&&(B=B.filter(O=>O.type=="objects/animates/animate"&&O.properties.autoRun==!0),B[0]!=null)){let R=B[0].properties.skin;this.updateSpinePreview(R)}var w=this.drawAssestBox(T,this._renderSpine.image.width,this._renderSpine.image.height);T.drawImage(this._renderSpine.image,w.x,w.y,w.width,w.height)}this._hasToggleAssestLoad==!1&&(this.resetSizeConfig(),this._hasToggleAssestLoad=!0,this.checkAssestTimeOut!=null&&(clearInterval(this.checkAssestTimeOut),this.checkAssestTimeOut=null))}else T!=null&&this.drawErrorTips(T)}onDrawForeground(T,_,w){this.checkAssestLoaded(T)}}createObject.title="物体";createObject.showTypes=["初始化时","输入时"];LiteGraph.registerNodeType("objects/createObject",createObject);class textGroup extends BaseYWNode{constructor(){super();St(this,"title","字幕组");St(this,"desc","用于快速创建一个绘本中浮动的字幕");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addOutput("列表","array"),this.addProperty("showInPageBottom",!1,"boolean"),this.addWidget("toggle","用作底部字幕",this.properties.showInPageBottom,"showInPageBottom"),this.addProperty("vertical",!1,"boolean"),this.addWidget("toggle","竖向文本",this.properties.vertical,"vertical"),this.addProperty("layout","居左/下","enum"),this.addWidget("combo","排列",this.properties.layout,{property:"layout",values:textGroup.layoutEnum}),this.addProperty("firstLineOffset",0,"number"),this.addWidget("number","首行缩进",this.properties.firstLineOffset,"firstLineOffset",{precision:0}),this.addProperty("lineSpace",0,"number"),this.addWidget("number","行距",this.properties.lineSpace,"lineSpace",{precision:0}),this.addProperty("fontSize",45,"number"),this.addWidget("number","字号",this.properties.fontSize,"fontSize",{precision:0}),this.addProperty("color","#000000","string"),this.addWidget("string","颜色",this.properties.color,"color"),this.addProperty("outLineWidth",4,"number"),this.addWidget("slider","描边宽度",this.properties.outLineWidth,"outLineWidth",{precision:0,min:0,max:100}),this.addProperty("outLineColor","#ffffff","string"),this.addWidget("string","描边颜色",this.properties.outLineColor,"outLineColor"),this.addProperty("hideBeforRun",!1,"boolean"),this.addWidget("toggle","运行前隐藏",this.properties.hideBeforRun,"hideBeforRun"),this.addProperty("hideAfterRun",!1,"boolean"),this.addWidget("toggle","运行结束隐藏",this.properties.hideAfterRun,"hideAfterRun"),this.addProperty("hideBaseLabel",!1,"boolean"),this.addWidget("toggle","隐藏底层文字",this.properties.hideBaseLabel,"hideBaseLabel"),this.addProperty("needColorAni",!1,"boolean"),this.addWidget("toggle","是否颜色过渡",this.properties.needColorAni,"needColorAni"),this.addProperty("maskColor","#88BF3D","string"),this.addWidget("string","过渡颜色",this.properties.maskColor,"maskColor"),this.addProperty("linesNum",0,"number"),this.addWidget("button","添加一行","",()=>{this.addLine()}),this.addWidget("button","删除一行","",()=>{this.removeLine()})}updateWidght(){var T=this.properties.showInPageBottom;this.widgets.map(_=>{_.name!="用作底部字幕"&&(_.hidden=T)}),this.setSize(this.computeSize())}onConfigure(){console.log("当前的配置信息",this.properties);for(var T=0;T<this.properties.linesNum;T++){let _="text"+(T+1);this.addWidget("string","文本",this.properties[_],_)}this.freshTexts()}addLine(){this.properties.linesNum+=1;let T="text"+this.properties.linesNum;this.addProperty(T,"","string"),this.addWidget("string","文本","",T),this.freshTexts()}removeLine(){if(this.properties.linesNum==0)return;let T="text"+this.properties.linesNum;this.properties.linesNum-=1,this.removeProperty(T),this.widgets.pop(),this.setSize(this.computeSize()),this.freshTexts()}onPropertyChanged(T,_,w){var B=this.getInputData(0,!0);if(B!=null&&B.node!=null){if(T=="showInPageBottom"){if(this.updateWidght(),_==!1)this.freshTexts();else{var B=this.getInputData(0,!0);B!=null&&B.clearChildren()}return}if(T=="layout")for(var A=0;A<B.node.children.length;A++){let O=B.node.children[A].getComponent("CodeNodeLg");this.properties.vertical==!0?(A==0?O.y=this.properties.firstLineOffset:O.y=0,O.anchorY=textGroup.anchorXDit[_],O.anchorX=.5):(A==0?O.x=this.properties.firstLineOffset:O.x=0,O.anchorY=.5,O.anchorX=textGroup.anchorXDit[_])}else if(T=="vertical"){let O=B.checkAddComponent(cc.Layout);_==!1?(O.type=cc.Layout.Type.VERTICAL,O.resizeMode=cc.Layout.ResizeMode.CONTAINER,O.spacingY=this.properties.lineSpace,O.verticalDirection=cc.Layout.VerticalDirection.TOP_TO_BOTTOM):(O.type=cc.Layout.Type.HORIZONTAL,O.resizeMode=cc.Layout.ResizeMode.CONTAINER,O.spacingX=this.properties.lineSpace,O.horizontalDirection=cc.Layout.HorizontalDirection.RIGHT_TO_LEFT);for(var A=0;A<B.node.children.length;A++){let P=B.node.children[A].getComponent("CodeNodeLg");P.overflow=_?cc.Label.Overflow.RESIZE_HEIGHT:cc.Label.Overflow.NONE,_==!0?A==0?P.y=this.properties.firstLineOffset:P.y=0:A==0?P.x=this.properties.firstLineOffset:P.x=0,_==!1?(P.anchorX=textGroup.anchorXDit[this.properties.layout],P.anchorY=.5):(P.anchorX=.5,P.anchorY=textGroup.anchorXDit[this.properties.layout],P.width=this.properties.fontSize+10)}}else if(T=="lineSpace"){let O=B.checkAddComponent(cc.Layout);this.properties.vertical?O.spacingX=this.properties.lineSpace:O.spacingY=this.properties.lineSpace}else if(T=="firstLineOffset"){let O=B.node.children[0];O!=null&&(this.properties.vertical?O.getComponent("CodeNodeLg").y=this.properties.firstLineOffset:O.getComponent("CodeNodeLg").x=this.properties.firstLineOffset)}else if(T=="outLineColor")for(var A=0;A<B.node.children.length;A++){let R=B.node.children[A];R.getComponent("CodeNodeLg").outLineColor=this.properties.outLineColor}else if(T=="outLineWidth")for(var A=0;A<B.node.children.length;A++){let R=B.node.children[A];R.getComponent("CodeNodeLg").outLineWidth=this.properties.outLineWidth}else if(T=="fontSize")for(var A=0;A<B.node.children.length;A++){let R=B.node.children[A];R.getComponent("CodeNodeLg").fontSize=this.properties.fontSize,this.properties.vertical&&(R.getComponent("CodeNodeLg").width=this.properties.fontSize+10)}else if(T=="color")for(var A=0;A<B.node.children.length;A++){let R=B.node.children[A];R.getComponent("CodeNodeLg").color=this.properties.color}else{let O=B.getChildByName(T);O!=null&&(O.getComponent("CodeNodeLg").string=_)}}}freshTexts(T){var _=this.getInputData(0,!0);if(this.properties.showInPageBottom==!0){_!=null&&_.clearChildren();return}if(_==null){console.log("当前没有物体");{let A=this.getRealLinkNode();if(A==null){console.log("当前没有关联节点");return}if(_=A.codeNode,_==null){console.log("当前关联节点没有codeNode");return}}}let w=_.checkAddComponent(cc.Layout);this.properties.vertical==!1?(w.type=cc.Layout.Type.VERTICAL,w.resizeMode=cc.Layout.ResizeMode.CONTAINER,w.spacingY=this.properties.lineSpace,w.verticalDirection=cc.Layout.VerticalDirection.TOP_TO_BOTTOM):(w.type=cc.Layout.Type.HORIZONTAL,w.resizeMode=cc.Layout.ResizeMode.CONTAINER,w.spacingX=this.properties.lineSpace,w.horizontalDirection=cc.Layout.HorizontalDirection.RIGHT_TO_LEFT),_.clearChildren(),this.motionTextArr=[];for(var B=1;B<=this.properties.linesNum;B++){let A={parent:_.node,modal:ObjectTypeEnum.text,customeName:"text"+B,string:this.properties["text"+B],outLineWidth:this.properties.outLineWidth,outLineColor:this.properties.outLineColor,fontSize:this.properties.fontSize,color:this.properties.color,overflow:this.properties.vertical?cc.Label.Overflow.RESIZE_HEIGHT:cc.Label.Overflow.NONE,width:this.properties.fontSize+10},O=createObj(A);if(O!=null&&T!=null){console.log("生成字幕",this.properties["text"+B],O.node._id,T);let R=O.checkAddComponent("MotionText");R.hideBeforRun=this.properties.hideBeforRun,R.hideAfterRun=this.properties.hideAfterRun,R.hideBaseLabel=this.properties.hideBaseLabel,R.dir=this.properties.vertical?1:0,R.maskColor=this.properties.maskColor,this.motionTextArr.push(R);let P=B-1;T[P]!=null&&(R.position=T[P].position.map(E=>this.properties.needColorAni!=!0?0:E*.01).join(","),R.positionTime=T[P].times.join(","),console.log("设置了motionText hideAfterRun",R.position,R.positionTime)),R.init()}this.onPropertyChanged("layout",this.properties.layout)}}onAction(T){var _=this.getInputData(0,!0);if(_==null){console.log("当前没有物体");return}if(console.log("textGroup onAction",T),T=="播放"){var w=0,B=()=>{let O=this.motionTextArr;if(O[w]==null)return;let R=O[w];console.log("textGroup 当前执行的motionText",w,O[w].node._id,R),R!=null&&(R.dir=this.properties.vertical?1:0,R.inputHandle({data:1}),R.outputHandle=()=>{w+=1,O[w]!=null&&O[w].node.active==!0&&B()})};B()}else if(T=="停止"){let O=this.motionTextArr;for(var A=0;A<O.length;A++){let R=O[A];R!=null&&R.inputHandle({data:0})}}}}textGroup.layoutEnum=["居左/下","居中","居右/上"];textGroup.anchorXDit={"居左/下":0,居中:.5,"居右/上":1};textGroup.title="字幕组";LiteGraph.registerNodeType("objects/textGroup",textGroup);class animate extends BaseYWNode{constructor(){super();St(this,"title","骨骼动画");St(this,"desc","用于控制动画播放");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addInput("播放",LiteGraph.ACTION),this.addOutput("结束",LiteGraph.EVENT),this.addOutput("点击",LiteGraph.EVENT),this._skins=[],this._animations=[],this.addProperty("modal","全设置","enum"),this.addWidget("combo","更新模式",this.properties.modal,{property:"modal",values:animate.modalEnum}),this.addProperty("skin","","enum"),this.addWidget("combo","选择皮肤",this.properties.skin,{property:"skin",values:this._skins}),this.addProperty("playAniName","","enum"),this.addWidget("combo","选择动画",this.properties.playAniName,{property:"playAniName",values:this._animations}),this.addProperty("loop",!1,"boolean"),this.addWidget("toggle","是否循环",this.properties.loop,"loop"),this.addProperty("timeScale",1,"number"),this.addWidget("slider","播放速率",this.properties.timeScale,"timeScale",{precision:1,min:0,max:10}),this.addProperty("autoRun",!1,"boolean"),this.addWidget("toggle","是否自动播放",this.properties.autoRun,"autoRun"),this.addProperty("clickWait",!1,"boolean"),this.addWidget("toggle","点击等待动画结束",this.properties.clickWait,"clickWait"),this.addProperty("softChange",!1,"boolean"),this.addWidget("toggle","柔和过度",this.properties.softChange,"softChange"),this.addProperty("cancelEvent",!1,"boolean"),this.addWidget("toggle","取消其他触摸事件",this.properties.cancelEvent,"cancelEvent"),this.addProperty("aniEndCanClick",!1,"boolean"),this.addWidget("toggle","动画结束后响应点击",this.properties.aniEndCanClick,"aniEndCanClick"),this.addProperty("toggleCount",1,"number"),this.addWidget("number","结束触发次数",this.properties.toggleCount,"toggleCount",{precision:0,min:0}),this.addProperty("aniClickReplay",!1,"boolean"),this.addWidget("toggle","点击重播动画",this.properties.aniClickReplay,"aniClickReplay"),this.addProperty("aniClickTimeSpace",0,"number"),this.addWidget("number","点击时间间隔",this.properties.aniClickTimeSpace,"aniClickTimeSpace"),this.addProperty("canClickOutLine",!1,"boolean"),this.addWidget("toggle","可点击时显示描边",this.properties.canClickOutLine,"canClickOutLine"),this.addProperty("isCanClick",!0,"boolean");let T=this.addWidget("toggle","是否可点击",this.properties.isCanClick,"isCanClick"),_=this.addInput("触摸提示","lgraphNode");this.addProperty("linkClickTip","","string");let w=this.addWidget("linknode","添加触摸提示",this.properties.linkClickTip,()=>{this.oneClickCreateTouchTip()});this.addProperty("tipsJustOnce",!0,"boolean"),this.addWidget("toggle","触摸提示只出现一次",this.properties.tipsJustOnce,"tipsJustOnce"),_.widget=w,this.createCaidanBtn=this.addWidget("button","创建点击彩蛋交互","",()=>{this.createClickToNextAni()}),this.createCaidanBtn.disabled=!0,this.addWidget("button","预览动画","",()=>{this.previewAni(),this.sendBtnWidgetClickEvent("预览动画")}),this.addProperty("listenAniEvent",!0,"boolean");let B=this.addInput("关联音频","lgraphNode"),A=this.addWidget("toggle","关联动画音频",this.properties.listenAniEvent,"listenAniEvent");B.widget=A;let O=this.addInput("isCanClick","boolean");O.widget=T,this.addProperty("soundFx","无","enum"),this.addWidget("combo","音效",this.properties.soundFx,{property:"soundFx",values:soundFxs})}onConnectInput(T,_,w,B,A){_=="codeNode"&&B._renderSpine!=null&&(this._skins.splice(0,this._skins.length,...B._renderSpine.skins()),this._animations.splice(0,this._animations.length,...B._renderSpine.animations())),this.sendConnectEvent(T,B,A)}onSelected(){this.getEnums(),this.onAction("播放"),this.sendOtherEvent("onSelected")}onDeselected(){this.onAction("停止"),this.sendOtherEvent("onDeselected")}onStart(){super.onStart(),console.log("animate onStart",this.properties.autoRun);var T=this.properties.autoRun;T==!0&&this.onAction("播放")}onStop(){this.onAction("停止")}getEnums(T){var _=this.getRealLinkNode();if(_!=null&&_._renderSpine!=null){let B=_._renderSpine.events();if(this._skins.splice(0,this._skins.length,..._._renderSpine.skins()),this._animations.splice(0,this._animations.length,..._._renderSpine.animations()),this._skins.length==1)this.setProperty("skin",this._skins[0]);else if(Number(this.properties.skin)>=0){let A=this._skins[Number(this.properties.skin)];A!=null&&this.setProperty("skin",A)}if(this._animations.length==1)this.setProperty("playAniName",this._animations[0]),T==!0&&(this.setProperty("loop",!0),this.setProperty("autoRun",!0),this.collapse()),this.createCaidanBtn.disabled=!0;else{if(Number(this.properties.playAniName)>=0){let A=this._animations[Number(this.properties.playAniName)];A!=null?this.setProperty("playAniName",A):console.log("我还是没有找到自己的动画",_.properties.customeName,this.properties.playAniName,this._animations)}this.createCaidanBtn.disabled=!1}console.log("skeletonData eventssss",B[this.properties.playAniName]);for(let A=0;A<this.widgets.length;A++)this.widgets[A].name.indexOf("音频")==0&&(this.widgets.splice(A,1),A--);if(B[this.properties.playAniName]!=null){let A=B[this.properties.playAniName];for(var w=0;w<A.length;w++)this.addWidget("button","音频："+A[w].name,"")}}}createClickToNextAni(){let T=LiteGraph.createNode("objects/animates/animate");T.pos=[this.pos[0]+this.width+3,this.pos[1]],this.graph.add(T),this.connect(1,T,1),T.connect(0,this,1),T.setProperty("skin",this.properties.skin),this.setProperty("playAniName","std"),this.setProperty("loop",!0),this.setProperty("autoRun",!0);var _=this._animations.indexOf(this.properties.playAniName);_+=1,this._animations[_]==null&&(_=0);var w=this._animations[_];T.setProperty("playAniName",w);var B=this.getRealLinkNode();B!=null&&B.connect(0,T,0)}previewAni(){if(this.graph!=null){var T=this.getRealLinkNode();T!=null&&this.properties.playAniName!=""&&T.codeNode!=null&&T.codeNode.playAnimation(this.properties.playAniName,this.properties.loop)}}onPropertyChanged(T,_,w){if(this.graph!=null){var B=this.getRealLinkNode();B!=null&&(T=="skin"?(B.updateSpinePreview!=null&&B.updateSpinePreview(_),B.codeNode!=null&&(console.log("修改了皮肤",_),B.codeNode.setSkin(_))):T=="playAniName"?B.codeNode!=null&&B.codeNode.playAnimation(_,this.properties.loop):T=="loop"?B.codeNode!=null&&B.codeNode.playAnimation(this.properties.playAniName,_):T=="timeScale"&&B.codeNode!=null&&B.codeNode.setAnimationProb("timeScale",_),this.sendPropertyChangeEvent(T,_,w))}}onWidgetChanged(T,_,w,B){}getTitle(){return this.title+" "+this.properties.skin+"-"+this.properties.playAniName}setValue(T){this.setProperty("value",T)}onAction(T,_){if(T=="播放"){this.mode=LiteGraph.ALWAYS;var w=this.getInputData(0,!0);if(w!=null){this.playLinkSound(),this.properties.soundFx!="无"&&this.properties.soundFx!=""&&cc.assetManager.loadRemote(rootHost+"/"+this.properties.soundFx,(P,E)=>{P==null&&cc.audioEngine.play(E,!1,1)});var B=this.properties.modal,A=this.properties.loop;let O=this.properties.softChange,R=this.properties.aniEndCanClick;this.properties.clickWait,this.waitCanClick=!1,this.hideClickTip(),(B=="全设置"||B=="仅设置皮肤")&&w.setSkin(this.properties.skin),this._toggleCount=0,(B=="全设置"||B=="仅设置动画")&&(this.properties.cancelEvent==!0&&w.targetOff(),this.clickWaitOutPut=!1,this.aniEnd=!1,w.setAnimationProb("timeScale",this.properties.timeScale),w.playAnimation(this.properties.playAniName,A,O,(P,E)=>{if(console.log("我收到spine音频事件",E.data.name,E.intValue,this.properties.listenAniEvent,this.isInputConnected(3),this.graph.status),this.properties.listenAniEvent==!1||this.isInputConnected(3)==!0||this.graph.status!=2)return;let D=this.graph.findNodesByType("output/sound"),I="";E.data&&(I=E.data.name);let M=D.find(N=>N.properties.customeName.split(".")[0]==I);M!=null?M.onAction("播放"):showAlert(w.node.name+":"+P.animation.name+"动画没有相应音频节点:"+I)},()=>{this._toggleCount+=1,this._toggleCount<=this.properties.toggleCount&&this.triggerSlot(0),this.aniEnd!=!0&&(this.isOutputConnected(1)||this.properties.aniClickReplay)&&R==!0&&(this.getInputOrProperty("isCanClick")==!0?this.showClickTip():this.hasLinkIsCanClick()==!0&&(this.waitCanClick=!0)),this.aniEnd=!0,this.clickWaitOutPut==!0&&this.triggerSlot(1,w)}),(this.isOutputConnected(1)||this.properties.aniClickReplay)&&(w.checkAddComponent("SpinePlusComponent"),R==!1&&(console.log(this.getRealLinkNode().properties.customeName,"当前是否需要等待显示点击",this.getInputOrProperty("isCanClick"),this.hasLinkIsCanClick()),this.getInputOrProperty("isCanClick")==!0?this.showClickTip():this.hasLinkIsCanClick()==!0&&(this.waitCanClick=!0)),w.on(cc.Node.EventType.TOUCH_END,this.onClick.bind(this))))}else console.warn("当前没有关联codeNode")}else if(T="停止"){this.mode=LiteGraph.ON_EVENT;var w=this.getInputData(0,!0);this.waitCanClick=!1,w!=null&&w.pauseAnimation()}}onClick(){window.onGraphNodeClick!=null&&window.onGraphNodeClick({nodeId:this.getIdWithGraph(),time:this.graph.getTime(),funcName:"onClick"});var T=this.getInputData(0,!0);if(T==null){console.warn("点击的时候codeNode为空了");return}if(this.graph.config.pause==1)return;if(this.properties.aniEndCanClick!=!1){if(this.aniEnd!=!0){console.log("点击了但动画没有播放结束");return}}if(this.getInputOrProperty("isCanClick")==!0){if(this.curWaitTime!=null){console.log("当前需等待点击间隔",this.curWaitTime);return}this.properties.aniClickTimeSpace>0&&(this.curWaitTime=this.properties.aniClickTimeSpace),T.targetOff(),this.properties.clickWait==!0?this.clickWaitOutPut=!0:(this.triggerSlot(1,T),this.hideClickTip()),this.properties.aniClickReplay==!0&&this.onAction("播放")}}onExecute(){if(this.curWaitTime!=null){var T=this.graph.elapsed_time;this.curWaitTime-=T,this.curWaitTime<=0&&(this.curWaitTime=null)}this.waitCanClick==!0&&this.getInputOrProperty("isCanClick")==!0&&(this.showClickTip(),this.waitCanClick=!1)}}animate.title="骨骼动画";animate.modalEnum=["全设置","仅设置皮肤","仅设置动画"];LiteGraph.registerNodeType("objects/animates/animate",animate);class tween extends BaseYWNode{constructor(){super();St(this,"title","数值动画");St(this,"desc","用于控制节点属性变化");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addInput("播放",LiteGraph.ACTION),this.addOutput("结束",LiteGraph.EVENT),this.addOutput("点击",LiteGraph.EVENT),this.addProperty("duration",1,"number"),this.addWidget("number","动画时长",this.properties.duration,"duration",{precision:1,min:0,max:60}),this.addProperty("delay",0,"number"),this.addWidget("number","延迟播放时间",this.properties.delay,"delay",{precision:1,min:0,max:60}),this.addProperty("easing","无","enum"),this.addWidget("combo","缓动效果",this.properties.easing,{property:"easing",values:tween.easingEnum}),this.addProperty("tweenMode","变化目标值","enum"),this.addWidget("combo","动画模式",this.properties.tweenMode,{property:"tweenMode",values:tween.tweenModeEnum}),this.addProperty("dontTween",!1,"boolean"),this.addWidget("toggle","无动画直接修改值",this.properties.dontTween,"dontTween"),this.addProperty("cancelEvent",!1,"boolean"),this.addWidget("toggle","取消其他触摸事件",this.properties.cancelEvent,"cancelEvent"),this.addProperty("cancelOtherTween",!1,"boolean"),this.addWidget("toggle","打断其它数值动画",this.properties.cancelOtherTween,"cancelOtherTween"),this.addProperty("autoRun",!1,"boolean"),this.addWidget("toggle","是否自动播放",this.properties.autoRun,"autoRun"),this.addProperty("x",0,"number"),this.addWidget("number","坐标-x",this.properties.x,"x",{precision:1}),this.addProperty("y",0,"number"),this.addWidget("number","坐标-y",this.properties.y,"y",{precision:1}),this.addProperty("scaleX",1,"number"),this.scaleXWidget=this.addWidget("number","缩放-x",this.properties.scaleX,"scaleX",{precision:1}),this.addProperty("scaleY",1,"number"),this.scaleYWidget=this.addWidget("number","缩放-y",this.properties.scaleY,"scaleY",{precision:1}),this.addProperty("opacity",255,"number"),this.addWidget("number","透明度",this.properties.opacity,"opacity",{precision:0,min:-255,max:255}),this.addProperty("angle",0,"number"),this.addWidget("number","角度",this.properties.angle,"angle",{min:-360,max:360,precision:0}),this.addProperty("anchorX",.5,"number"),this.addWidget("number","锚点x",this.properties.anchorX,"anchorX",{min:-1,max:1,precision:1,step2:.1}),this.addProperty("anchorY",.5,"number"),this.addWidget("number","锚点y",this.properties.anchorY,"anchorY",{min:-1,max:1,precision:1,step2:.1}),this.addProperty("width",50,"number"),this.widthWidget=this.addWidget("number","宽度",this.properties.width,"width",{precision:0,min:0,max:9999}),this.addProperty("height",50,"number"),this.heightWidget=this.addWidget("number","高度",this.properties.height,"height",{precision:0,min:0,max:9999}),this.addProperty("color","#ffffff","string"),this.addWidget("string","物体颜色",this.properties.color,"color"),this.addProperty("zoomRatio",1,"number"),this.addWidget("number","镜头缩放",this.properties.zoomRatio,"zoomRatio",{precision:1,min:1,max:10,step2:.01}),this.addProperty("nodeConfig",{x:this.properties.x,y:this.properties.y,width:this.properties.width,height:this.properties.height,anchorX:this.properties.anchorX,anchorY:this.properties.anchorY,scaleX:this.properties.scaleX,scaleY:this.properties.scaleY,color:this.properties.color,angle:this.properties.angle},"object"),this.nodeConfigWidget=this.addWidget("ccnode","节点操控",this.properties.nodeConfig,"nodeConfig",{viewWidth:designViewWidth,viewHeight:designViewHeight}),this.addWidget("button","同步目标物体属性","",()=>{this.syncTargetValue(),this.sendBtnWidgetClickEvent("同步目标物体属性")}),this.addWidget("button","重置变化多少值","",()=>{this.setProperty("x",0),this.setProperty("y",0),this.setProperty("width",0),this.setProperty("height",0),this.setProperty("anchorX",0),this.setProperty("anchorY",0),this.setProperty("scaleX",0),this.setProperty("scaleY",0),this.setProperty("opacity",0),this.setProperty("color","#000000"),this.setProperty("angle",0),this.setProperty("zoomRatio",0)}),this.addWidget("button","预览动画","",()=>{this.previewTween!=null&&(this.syncTargetValue(this.previewTween),this.realRun(this.previewTween,"播放"))})}onConnectInput(T,_,w,B,A){console.log("onConnectInput",T,_,w,B,A),_=="codeNode"&&B.type=="objects/camera"&&B.codeNode!=null&&setTimeout(()=>{this.syncTargetValue()},100),this.sendConnectEvent(T,B,A)}onSelected(){if(this.previewTween==null){let _=this.getRealLinkNode();if(_==null)return;if(_.codeNode!=null&&cc.isValid(_.codeNode.node)){var T=cc.instantiate(_.codeNode.node);T.isClone=!0,T.zIndex=9999,this.previewTween=T.getComponent("CodeNodeLg"),this.previewTween!=null?(this.previewTween.init(),this.previewTween.parent=_.codeNode.parent,this.previewTween.nodeName+="_preview",syncConfigToCodeNode(this.previewTween,this.properties.nodeConfig),this.previewTween.updatePreview()):console.warn("获取到了无效节点",T)}}this.sendOtherEvent("onSelected")}onDeselected(){this.previewTween!=null&&(this.previewTween.destroyNode(),this.previewTween=null)}onStart(){console.log("animate onStart",this.properties.autoRun);var T=this.properties.autoRun;T==!0&&this.onAction("播放"),super.onStart()}onStop(){this.onAction("停止")}syncTargetValue(T){let _=this.getRealLinkNode();if(_!=null&&_.widgets)for(var w=0;w<_.widgets.length;w++){var B=_.widgets[w];if(B.type=="ccnode"){for(var A in B.value){let R=this.widgets.findIndex(P=>P.options.property==A);R!=-1&&(T!=null?T[this.widgets[R].options.property]=B.value[A]:this.widgets[R].setValue(B.value[A],{e:null,node:this,canvas:null}))}continue}var O=this.widgets.findIndex(R=>R.name==B.name);O!=-1&&(T!=null?T[this.widgets[O].options.property]=B.value:this.widgets[O].setValue(B.value,{e:null,node:this,canvas:null}))}}onPropertyChanged(T,_,w){if(T!="nodeConfig"&&typeof this.nodeConfigWidget.value=="object"&&(this.nodeConfigWidget.value[T]!=null&&(this.nodeConfigWidget.value[T]=_,this.properties.nodeConfig[T]=_),T=="zoomRatio"&&_!=0&&(this.nodeConfigWidget.value.scaleX!=null&&(this.nodeConfigWidget.value.scaleX=1/_,this.properties.nodeConfig.scaleX=1/_,this.nodeConfigWidget.value.scaleY=1/_,this.properties.nodeConfig.scaleY=1/_),this.scaleXWidget.value=1/_,this.scaleYWidget.value=1/_,this.properties.scaleX=1/_,this.properties.scaleY=1/_)),this.previewTween!=null){var B={};T=="nodeConfig"?B={..._}:B[T]=this.properties[T],syncConfigToCodeNode(this.previewTween,B)}this.sendPropertyChangeEvent(T,_,w)}onWidgetChanged(T,_,w,B){}setValue(T){this.setProperty("value",T)}realRun(T){let _=this.properties.delay,w=this.properties.duration,B=this.properties.easing,A=this.properties.dontTween,O=this.properties.cancelOtherTween,R=this.properties.cancelEvent,P=this.properties.tweenMode,E={...this.properties.nodeConfig};var D=cc.Color.WHITE.fromHEX(E.color);if(E.r=D.getR(),E.g=D.getG(),E.b=D.getB(),E.opacity=this.properties.opacity,delete E.color,B!="无"){var I=tween.easingEnum.indexOf(B);I!=-1?B={easing:tween.easingConfig[I]}:B={}}else B={};this.aniEnd=!1,this.inRun=!0,O==!0&&(cc.Tween.stopAllByTarget(T),cc.Tween.stopAllByTarget(T.node)),R==!0&&T.targetOff(),A==!0?(this.aniEnd=!0,this.inRun=!1,syncConfigToCodeNode(T,E)):(console.log("开始播放动画",w,JSON.parse(JSON.stringify(E)),B),this.tweenTag="tween_"+this.getIdWithGraph(),console.log("当前graphid tweenTag",this.graph.id,this.tweenTag),cc.Tween.stopAllByTag(this.tweenTag),T.camera!=null&&(E.zoomRatio=this.properties.zoomRatio),P=="变化目标值"?(console.log("目标值"),xorConfig(T,E),console.log("剔除掉之后的值",E),this.tween=cc.tween(T).tag(this.tweenTag).delay(_).to(w,E,B).call(()=>{this.triggerSlot(0,T),this.aniEnd=!0,this.inRun=!1}).start()):P=="变化多少值"&&(xorConfigZeroValue(E),console.log("剔除掉0值之后的值",E),this.tween=cc.tween(T).tag(this.tweenTag).delay(_).by(w,E,B).call(()=>{this.triggerSlot(0,T),this.aniEnd=!0,this.inRun=!1}).start())),this.isOutputConnected(1)&&(T.checkAddComponent("SpinePlusComponent"),T.on(cc.Node.EventType.TOUCH_END,this.onClick.bind(this)))}onAction(T,_){if(T=="播放"){var w=this.getInputData(0,!0);w!=null?this.realRun(w):console.warn("当前没有关联codeNode")}else T=="停止"&&(this.tweenTag="tween_"+this.getIdWithGraph(),cc.Tween.stopAllByTag(this.tweenTag))}onClick(){window.onGraphNodeClick!=null&&window.onGraphNodeClick({nodeId:this.getIdWithGraph(),time:this.graph.getTime(),funcName:"onClick"});var T=this.getInputData(0,!0);if(T==null){console.warn("点击时codeNode == null");return}this.graph.config.pause!=1&&this.aniEnd==!0&&(T.targetOff(),this.triggerSlot(1,T))}}tween.title="数值动画";tween.easingEnum=["无","淡入","淡出","淡入淡出","回弹","弹跳"];tween.easingConfig=["none","quadIn","quadOut","quadInOut","backOut","bounceOut"];tween.tweenModeEnum=["变化目标值","变化多少值"];LiteGraph.registerNodeType("objects/animates/tween",tween);class bezierCurve extends BaseYWNode{constructor(){super();St(this,"title","路径动画");St(this,"desc","用于控制节点进行曲线移动");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addInput("长度","number"),this.addInput("播放",LiteGraph.ACTION),this.addInput("重置位置",LiteGraph.ACTION),this.addOutput("结束",LiteGraph.EVENT),this.addProperty("points",[0,0,200,200,400,0],"array"),this.curveWidget=this.addWidget("curve","曲线控制点",this.properties.points,"points",{viewWidth:designViewWidth,viewHeight:designViewHeight}),this.selectCtrl=this.addWidget("number","选择控制点",-1,T=>{this.properties.selectPoint=T,this.curveWidget.selectPoint=T},{precision:0,min:-1,max:this.properties.points.length/2-1}),this.addWidget("button","","",T=>{T.clickeName=="删除控制点"?(this.curveWidget.remonveCtrlPoint(this),this.selectCtrl.options.max=this.properties.points.length/2-1):T.clickeName=="添加控制点"&&(this.curveWidget.addCtrlPoint(this),this.selectCtrl.options.max=this.properties.points.length/2-1)},{buttons:["删除控制点","添加控制点"]}),this.addProperty("startT",0,"number"),this.addWidget("slider","起始位置",this.properties.startT,"startT",{precision:2,min:0,max:1,step2:.01}),this.addProperty("endT",1,"number"),this.addWidget("slider","终点位置",this.properties.endT,"endT",{precision:2,min:0,max:1,step2:.01}),this.addProperty("aniType","随步长","enum"),this.addWidget("combo","动画模式",this.properties.aniType,{property:"aniType",values:bezierCurve.tweenModeEnum}),this.addProperty("duration",1,"number"),this.durationWidget=this.addWidget("slider","动画时长",this.properties.duration,"duration",{precision:1,min:0,max:60,step2:.1}),this.addProperty("oneStep",.01,"number"),this.oneStepWidget=this.addWidget("slider","动画步长",this.properties.oneStep,"oneStep",{precision:2,min:0,max:1,step2:.01}),this.addProperty("lookUp",!1,"boolean"),this.addWidget("toggle","角度跟随路径",this.properties.lookUp,"lookUp"),this.addProperty("startResetT",!1,"boolean"),this.addWidget("toggle","开始运行时重置",this.properties.startResetT,"startResetT"),this.addProperty("autoRun",!1,"boolean"),this.addWidget("toggle","是否自动播放",this.properties.autoRun,"autoRun"),this.addWidget("button","预览动画","",()=>{this.previewTween!=null&&this.realRun(this.previewTween,"播放")})}onConnectInput(T,_,w,B,A){console.log("onConnectInput",T,_,w,B,A),this.sendConnectEvent(T,B,A)}onAdded(){this.updateWidght(),this.sendAddEvent()}onConfigure(){this.updateWidght()}onSelected(){if(this.previewTween==null){var T=this.getRealLinkNode();if(T==null)return;if(T.codeNode!=null&&cc.isValid(T.codeNode.node)){var _=cc.instantiate(T.codeNode.node);_.isClone=!0,_.zIndex=9999,this.previewTween=_.getComponent("CodeNodeLg"),this.previewTween.init(),this.previewTween.parent=T.codeNode.parent,this.previewTween.curve=new Bezier(this.properties.points),this.length=this.previewTween.curve.length(),this.previewTween.t=this.properties.startT}}this.sendOtherEvent("onSelected")}onDeselected(){this.previewTween!=null&&(this.previewTween.destroyNode(),this.previewTween=null)}onStart(){console.log("animate onStart",this.properties.autoRun),this.length=new Bezier(this.properties.points).length()*2,this.t=0;var T=this.properties.autoRun;T==!0&&this.onAction("播放"),super.onStart()}onStop(){this.onAction("停止")}updateWidght(){let T=this.properties.aniType;this.durationWidget.disabled=!1,this.oneStepWidget.disabled=!1,T=="随长度"?(this.durationWidget.disabled=!0,this.oneStepWidget.disabled=!0):T=="随时间"?this.oneStepWidget.disabled=!0:T=="随步长"&&(this.durationWidget.disabled=!0)}onWidgetChanged(T,_,w,B){B.options.property,T=="动画模式"&&this.updateWidght(),T=="曲线控制点"&&(this.properties.points=_,this.selectCtrl.value=this.curveWidget.selectPoint,this.previewTween!=null?(this.previewTween.curve=new Bezier(this.properties.points),this.length=this.previewTween.curve.length(),this.previewTween.t=this.properties.startT):console.log("当前没有previewTween")),(T=="起始位置"||T=="终点位置")&&this.previewTween!=null&&(this.previewTween.t=this.properties.startT)}setValue(T){this.setProperty("value",T)}realRun(T,_){if(_=="播放"){let A=this.properties.duration,O=this.properties.lookUp,R=this.properties.aniType,P=this.properties.startResetT,E=this.properties.endT;if(T.lookUp=O,T.curve==null){var w=new Bezier(this.properties.points);this.length=w.length(),T.curve=w}if(R=="随长度"){var B=this.getInputData(1)||0;let D=B/this.length;console.log("输入的value / lenght",B,this.length,D),T.t+=D}else if(R=="随步长"){let D=this.properties.oneStep;T.t+=D*.01}else R=="随时间"&&(P==!0&&(T.t=this.properties.startT),cc.Tween.stopAllByTag(this.tweenTag),this.tweenTag="curve_"+T.node._id,cc.tween(T).tag(this.tweenTag).to(A,{t:E}).call(()=>{this.triggerSlot(0,T)}).start());this.t=T.t,T.t==1&&this.triggerSlot(0,T)}else if(_=="重置位置"){this.end=!1;var w=new Bezier(this.properties.points);this.length=w.length(),T.curve=w,T.t=this.properties.startT*.01}else _=="停止"&&cc.Tween.stopAllByTag(this.tweenTag)}onAction(T,_){let w=this.getInputData(0,!0);if(w==null){console.warn("当前没有关联codeNode");return}this.realRun(w,T)}}bezierCurve.title="路径动画";bezierCurve.tweenModeEnum=["随步长","随时间","随长度"];LiteGraph.registerNodeType("objects/animates/bezierCurve",bezierCurve);class camera extends BaseYWNode{constructor(){super();St(this,"title","镜头");St(this,"desc","在绘本中使用镜头位移效果");St(this,"color","#3F42EA");this.priority=-999,this.widgets_up=!0,this.addOutput("物体","codeNode"),this.addProperty("x",0,"number"),this.addWidget("number","坐标-x",this.properties.x,"x",{precision:1}),this.addProperty("y",0,"number"),this.addWidget("number","坐标-y",this.properties.y,"y",{precision:1}),this.addProperty("zoomRatio",1,"number"),this.addWidget("number","镜头缩放",this.properties.zoomRatio,"zoomRatio",{precision:1,min:1,max:10,step2:.01}),this.addProperty("nodeConfig",{x:0,y:0,width:designViewWidth,height:designViewHeight,anchorX:.5,anchorY:.5,scaleX:1,scaleY:1,color:"#3F42EA",angle:0},"object"),this.nodeConfigWidget=this.addWidget("ccnode","节点操控",this.properties.nodeConfig,"nodeConfig",{viewWidth:designViewWidth,viewHeight:designViewHeight,justDrawBorder:!0,borderColor:"#3F42EA"}),this.addWidget("button","重置到默认状态","",()=>{this.setProperty("x",0),this.setProperty("y",0),this.setProperty("zoomRatio",1)})}createObj(T){if(this.codeNode!=null&&(this.codeNode.destroyNode(),this.codeNode=null,this.setOutputData(0,null),this.cameraUi!=null&&cc.isValid(this.cameraUi)&&(this.cameraUi.destroy(),this.cameraUi=null)),this.codeNode!=null){if(cc.isValid(this.codeNode.node)==!0){var _={...this.properties.nodeConfig};_.zoomRatio=this.properties.zoomRatio,syncConfigToCodeNode(this.codeNode,_),T!=null&&T(),this.setOutputData(0,this.codeNode);return}this.codeNode=null,this.setOutputData(0,null)}var _={...this.properties.nodeConfig},w=this.graph.vars.rootccNode;if(w!=null&&(_.parent=w),this.codeNode=createObj(_,T),this.codeNode.nodeName="Camera",isPreviewMode==!0){var B=this.codeNode.checkAddComponent(cc.Graphics);this.codeNode.ctx=B,this.codeNode.zIndex=99999,this.codeNode.updatePreview()}else{let A=this.codeNode.checkAddComponent(cc.Camera);A.cullingMask=-31,A.clearFlags=6,this.codeNode.camera=A,this.codeNode.zoomRatio=this.properties.zoomRatio}return this.setOutputData(0,this.codeNode),this.codeNode}onAdded(){this.codeNode==null&&isInApp==!1&&this.createObj(),this.sendAddEvent()}onSelected(){this.codeNode==null&&isInApp==!1&&this.createObj(),this.sendOtherEvent("onSelected")}updateOutputData(T){this.codeNode==null&&isInApp==!1&&this.createObj(),this.setOutputData(T,this.codeNode)}onStartBeforeLoad(){}onStart(){this.createObj()}onPause(){this.codeNode!=null&&cc.director.getActionManager().pauseTarget(this.codeNode)}onResume(){this.codeNode!=null&&cc.director.getActionManager().resumeTarget(this.codeNode)}onStop(){if(this.codeNode!=null&&isInApp==!1){var T={...this.properties.nodeConfig};T.zoomRatio=this.properties.zoomRatio,syncConfigToCodeNode(this.codeNode,T)}}onRemoved(){this.codeNode!=null&&(this.codeNode.destroyNode(),this.codeNode=null,this.setOutputData(0,null)),this.cameraUi!=null&&cc.isValid(this.cameraUi)&&(this.cameraUi.destroy(),this.cameraUi=null),this.sendRemoveEvent()}onPropertyChanged(T,_,w){if(T!="nodeConfig"&&typeof this.nodeConfigWidget.value=="object"&&(this.nodeConfigWidget.value[T]!=null&&(this.nodeConfigWidget.value[T]=_,this.properties.nodeConfig[T]=_),T=="zoomRatio"&&this.nodeConfigWidget.value.scaleX!=null&&(this.nodeConfigWidget.value.scaleX=1/_,this.properties.nodeConfig.scaleX=1/_,this.nodeConfigWidget.value.scaleY=1/_,this.properties.nodeConfig.scaleY=1/_)),this.codeNode!=null){var B={};T=="nodeConfig"?B={..._}:B[T]=this.properties[T],syncConfigToCodeNode(this.codeNode,B)}this.sendPropertyChangeEvent(T,_,w)}}camera.title="镜头";LiteGraph.registerNodeType("objects/camera",camera);class connection extends BaseYWNode{constructor(){super();St(this,"title","连接零件");St(this,"desc","将一个物体设置为另一个物体的子物体");this.mode=LiteGraph.ON_EVENT,this.addInput("关联父物体","codeNode"),this.addInput("关联子物体","codeNode")}onGetInputs(){return[["关联子物体","codeNode"]]}onStart(){this.onAction(),super.onStart()}onSelected(){this.onAction(),this.sendOtherEvent("onSelected")}disconnectInput(T,_){if(T>=1){let w=this.getInputData(T,!0);if(w!=null){let B=this.graph.vars.rootccNode;B==null&&(B=cc.director.getScene().getChildByName("Canvas")),B!=null&&(w.parent=B)}}super.disconnectInput(T,_)}onAction(){var T=this.getInputData(0,!0);if(T==null)return;let _=T.node;if(_!=null)for(var w=1;w<this.inputs.length;w++){let B=this.getInputData(w,!0);B!=null&&(B.parent=_)}}}connection.title="连接零件";LiteGraph.registerNodeType("objects/group/connection",connection);class groupMove extends BaseYWNode{constructor(){super();St(this,"title","整体移动");St(this,"desc","用于在开发时整体移动所有物体");this.mode=LiteGraph.ON_EVENT,this.addProperty("x",0,"number"),this.addWidget("number","坐标-x",this.properties.x,"x",{precision:2}),this.addProperty("y",0,"number"),this.addWidget("number","坐标-y",this.properties.y,"y",{precision:2})}onPropertyChanged(T,_,w){console.log("当前变量切换",T,_,w,_-w);let B=this.graph.findNodesByType("objects/createObject"),A=_-w;B.forEach(O=>{O.setProperty(T,O.properties[T]+A)}),this.sendPropertyChangeEvent(T,_,w)}}groupMove.title="整体移动";LiteGraph.registerNodeType("objects/groupMove",groupMove);class dynimicWidget extends BaseYWNode{constructor(){super();St(this,"title","动态位置");St(this,"desc","自动根据当前屏幕尺寸设置物体位置");this.mode=LiteGraph.ON_EVENT}onPropertyChanged(T,_,w){}}dynimicWidget.title="动态位置";dynimicWidget.posEnum=["屏幕右下","屏幕右上","屏幕左下","屏幕左上"];LiteGraph.registerNodeType("objects/dynimicWidget",dynimicWidget);class groupScale extends BaseYWNode{constructor(){super();St(this,"title","分镜预览缩放");St(this,"desc","用于在开发时分镜预览缩放，以便看清超出屏幕范围的物体");St(this,"color","#FFC082");this.mode=LiteGraph.ON_EVENT,this.addProperty("x",0,"number"),this.addWidget("number","位移x",this.properties.x,"x",{precision:2}),this.addProperty("y",0,"number"),this.addWidget("number","位移y",this.properties.y,"y",{precision:2}),this.addProperty("zoomRatio",1,"number"),this.addWidget("slider","缩放",this.properties.zoomRatio,"zoomRatio",{precision:2,min:.25,max:1}),this.addProperty("nodeConfig",{x:0,y:0,width:designViewWidth,height:designViewHeight,anchorX:.5,anchorY:.5,scaleX:1,scaleY:1,color:"#FFC082",angle:0},"object"),this.nodeConfigWidget=this.addWidget("ccnode","节点操控",this.properties.nodeConfig,"nodeConfig",{viewWidth:designViewWidth,viewHeight:designViewHeight,justDrawBorder:!1,borderColor:"#FFC082"}),this.addWidget("button","重置到默认状态","",()=>{console.log("点击了重置属性"),this.setProperty("x",0),this.setProperty("y",0),this.setProperty("zoomRatio",1)})}onPropertyChanged(T,_,w){{let B=cc.director.getScene().getChildByName("Canvas").getChildByName("Main Camera");T=="x"?B.x=_*-1/this.properties.zoomRatio:T=="y"?B.y=_*-1/this.properties.zoomRatio:T=="zoomRatio"&&(B.getComponent(cc.Camera).zoomRatio=_),T!="nodeConfig"&&typeof this.nodeConfigWidget.value=="object"&&(this.nodeConfigWidget.value[T]!=null&&(this.nodeConfigWidget.value[T]=_,this.properties.nodeConfig[T]=_),T=="zoomRatio"&&this.nodeConfigWidget.value.scaleX!=null&&(this.nodeConfigWidget.value.scaleX=_,this.properties.nodeConfig.scaleX=_,this.nodeConfigWidget.value.scaleY=_,this.properties.nodeConfig.scaleY=_))}this.sendPropertyChangeEvent(T,_,w)}onStop(){}onAttachCanvas(){}onConfigure(){{let T=cc.director.getScene().getChildByName("Canvas").getChildByName("Main Camera");T.x=this.properties.x*-1/this.properties.zoomRatio,T.y=this.properties.y*-1/this.properties.zoomRatio,T.getComponent(cc.Camera).zoomRatio=this.properties.zoomRatio}}onRemoved(){this.onAction("重置"),this.sendRemoveEvent()}onAction(T){if(T=="重置"){let _=cc.director.getScene().getChildByName("Canvas").getChildByName("Main Camera");_.x=0,_.y=0,_.getComponent(cc.Camera).zoomRatio=1}}}groupScale.title="分镜预览缩放";LiteGraph.registerNodeType("objects/groupScale",groupScale);class systemData extends LGraphNode{constructor(){super();St(this,"title","系统数据");St(this,"desc","获取系统数据");this.addOutput("值","number,string,boolean,object,array"),this.addProperty("modal","时间戳-秒","enum"),this.addWidget("combo","类型",this.properties.modal,{property:"modal",values:systemData.valueTypes}),this.addProperty("fileName",""),this.addWidget("string","表名称",this.properties.fileName,"fileName"),this.widgets_up=!0,this.size=[180,40]}getTitle(){return this.flags.collapsed?this.properties.modal=="配置表"?this.properties.modal+":"+this.properties.fileName:this.properties.modal:this.title}onAdded(){this.updateWidght()}onConfigure(){this.updateWidght()}updateWidght(){var T=this.properties.modal;this.widgets.map(_=>{_.name=="表名称"&&(_.disabled=T!="配置表")})}onWidgetChanged(T,_,w,B){T=="类型"&&this.updateWidght()}onStart(){this.onExecute()}getLinkData(){let T=null;var _=systemData.valueTypes.indexOf(this.properties.modal);if(_==0)T=Math.floor(new Date().getTime()/1e3);else if(_==1){var w=new Date,B=w.getMonth()+1;B<10&&(B="0"+B);var A=w.getDate();A<10&&(A="0"+A),T=w.getFullYear()+"/"+B+"/"+A}else if(_==2){var w=new Date,O=w.getHours(),R=w.getMinutes(),P=w.getSeconds();O<10&&(O="0"+O),R<10&&(R="0"+R),P<10&&(P="0"+P),T=O+":"+R+":"+P}else if(_==3){var w=new Date,O=w.getHours(),R=w.getMinutes(),P=w.getSeconds();O<10&&(O="0"+O),R<10&&(R="0"+R),T=O+":"+R}else _==4?T=cc.sys.os:_==5?T=1:_==6||(_==7?T={}:_==8?T=[]:_==9?T=cc.winSize.width:_==10?T=cc.winSize.height:_==11?(T=cc.winSize.width*.5,T=[-T,T]):_==12&&(T=cc.winSize.height*.5,T=[-T,T]));return T}onExecute(){let T=this.getLinkData();this.setOutputData(0,T)}}systemData.title="系统数据";systemData.valueTypes=["时间戳-秒","年:月:日","时:分:秒","时:分","系统","版本","配置表","Object","Array","空间宽度","空间高度","空间X轴范围","空间Y轴范围"];LiteGraph.registerNodeType("input/getData/systemData",systemData);class customData extends LGraphNode{constructor(){super();St(this,"title","自定义数据");St(this,"desc","获取自定义数据");this.mode=LiteGraph.ON_EVENT,this.addOutput("值","number,string,boolean,object,array"),this.addProperty("saveKey","","string"),this.addWidget("string","数据key",this.properties.saveKey,"saveKey"),this.addProperty("ifEmpty","","enum"),this.addWidget("combo","默认类型",this.properties.ifEmpty,{property:"ifEmpty",values:customData.valueTypes}),this.addProperty("defaultValue","","string"),this.addWidget("text","默认值",this.properties.defaultValue,"defaultValue"),this.widgets_up=!0,this.size=[180,30]}getTitle(){return this.flags.collapsed?this.title+":"+this.properties.saveKey:this.title}onAdded(){}onConfigure(){}updateWidght(){this.properties.modal,this.widgets.map(T=>{})}onStart(){this.onExecute()}onExecute(){let T=cc.sys.localStorage.getItem("codeJsonData");T==null||T==""?T={}:T=JSON.parse(T);let _=T[this.properties.saveKey];if(_==null){let w=this.properties.ifEmpty;if(w=="数值")_=Number(this.properties.defaultValue),isNaN(_)&&(_=0);else if(w=="文字")_=this.properties.defaultValue;else try{_=JSON.parse(this.properties.defaultValue)}catch(B){_=w=="字典"?{}:[]}}this.setOutputData(0,_)}}customData.title="自定义数据";customData.valueTypes=["数值","文字","字典","数组"];LiteGraph.registerNodeType("input/getData/customData",customData);class screenSize extends LGraphNode{constructor(){super();St(this,"title","屏幕适配");St(this,"desc","获取屏幕适配数据");this.mode=LiteGraph.ON_EVENT,this.addOutput("4:3",LiteGraph.EVENT),this.addOutput("16:9",LiteGraph.EVENT),this.addOutput("18:9",LiteGraph.EVENT)}onAdded(){}onConfigure(){}updateWidght(){this.properties.modal,this.widgets.map(T=>{})}onStart(){this.onExecute()}onExecute(){let T=Math.max(cc.winSize.width,cc.winSize.height)/Math.min(cc.winSize.width,cc.winSize.height);T<1.6?this.triggerSlot(0):T<1.9?this.triggerSlot(1):this.triggerSlot(2)}}screenSize.title="屏幕适配";LiteGraph.registerNodeType("input/screenSize",screenSize);class setData extends LGraphNode{constructor(){super();St(this,"title","保存自定义数据");St(this,"desc","保存自定义数据");this.mode=LiteGraph.ON_EVENT,this.addInput("值","number,string,boolean,object,array"),this.addInput("保存",LiteGraph.ACTION),this.addProperty("saveKey","","string"),this.addWidget("string","数据key",this.properties.saveKey,"saveKey")}getTitle(){return this.flags.collapsed?this.title+":"+this.properties.saveKey:this.title}onAdded(){}onConfigure(){}updateWidght(){this.properties.modal,this.widgets.map(T=>{})}onAction(T){let _=this.getInputData(0);if(_==null)return;let w=cc.sys.localStorage.getItem("codeJsonData");w==null||w==""?w={}:w=JSON.parse(w),w[this.properties.saveKey]=_,cc.sys.localStorage.setItem("codeJsonData",JSON.stringify(w))}}setData.title="保存自定义数据";LiteGraph.registerNodeType("output/setData",setData);class Subgraph extends LGraphNode{constructor(){super();St(this,"title","分支蓝图");St(this,"desc","Graph inside a node");St(this,"color","#334");St(this,"onResize",function(T){T[1]+=20});St(this,"serialize",function(){var T=LiteGraph.LGraphNode.prototype.serialize.call(this);return T.subgraph=this.subgraph.serialize(),T});this.addProperty("enabled",!0,"boolean"),this.enabled=!0,this.subgraph=new LiteGraph.LGraph,this.subgraph._subgraph_node=this,this.subgraph._is_subgraph=!0,this.subgraph.onTrigger=this.onSubgraphTrigger.bind(this),this.subgraph.onInputAdded=this.onSubgraphNewInput.bind(this),this.subgraph.onInputRenamed=this.onSubgraphRenamedInput.bind(this),this.subgraph.onInputTypeChanged=this.onSubgraphTypeChangeInput.bind(this),this.subgraph.onInputRemoved=this.onSubgraphRemovedInput.bind(this),this.subgraph.onOutputAdded=this.onSubgraphNewOutput.bind(this),this.subgraph.onOutputRenamed=this.onSubgraphRenamedOutput.bind(this),this.subgraph.onOutputTypeChanged=this.onSubgraphTypeChangeOutput.bind(this),this.subgraph.onOutputRemoved=this.onSubgraphRemovedOutput.bind(this)}onGetInputs(){return[["enabled","boolean"],["触发",LiteGraph.ACTION]]}onGetOutputs(){return[["结束",LiteGraph.EVENT],["被引用","lgraphNode"]]}onDblClick(T,_,w){var B=this;setTimeout(function(){w.openSubgraph(B.subgraph)},10)}onDrawTitle(T,_){let w=this;if(!w.flags.collapsed&&w.subgraph&&!w.skip_subgraph_button){var B=LiteGraph.NODE_TITLE_HEIGHT,A=w.size[0]-B,O=LiteGraph.isInsideRectangle(_[0]-w.pos[0],_[1]-w.pos[1],A+2,-B+2,B-4,B-4);T.fillStyle=O?"#888":"#555",this.renderingShape==LiteGraph.BOX_SHAPE?T.fillRect(A+2,-B+2,B-4,B-4):(T.beginPath(),T.roundRect(A+2,-B+2,B-4,B-4,[4]),T.fill()),T.fillStyle="#333",T.beginPath(),T.moveTo(A+B*.2,-B*.6),T.lineTo(A+B*.8,-B*.6),T.lineTo(A+B*.5,-B*.3),T.fill()}}onAction(T,_){this.subgraph.onAction(T,_)}onExecute(){if(this.enabled=this.getInputOrProperty("enabled"),!!this.enabled){if(this.inputs)for(var T=0;T<this.inputs.length;T++){var _=this.inputs[T],w=this.getInputData(T);this.subgraph.setInputData(_.name,w)}if(this.subgraph.runStep(),this.outputs)for(var T=0;T<this.outputs.length;T++){var B=this.outputs[T],w=this.subgraph.getOutputData(B.name);this.setOutputData(T,w)}}}sendEventToAllNodes(T,_,w){console.log("sendEventToAllNodes",T,_,w),this.enabled&&this.subgraph.sendEventToAllNodes(T,_,w)}onDrawBackground(T,_,w,B){if(this.flags.collapsed)return;var A=this.size[1]-LiteGraph.NODE_TITLE_HEIGHT+.5,O=LiteGraph.isInsideRectangle(B[0],B[1],this.pos[0],this.pos[1]+A,this.size[0],LiteGraph.NODE_TITLE_HEIGHT);let R=LiteGraph.isInsideRectangle(B[0],B[1],this.pos[0],this.pos[1]+A,this.size[0]/2,LiteGraph.NODE_TITLE_HEIGHT);T.fillStyle=O?"#555":"#222",T.beginPath(),this._shape==LiteGraph.BOX_SHAPE?R?T.rect(0,A,this.size[0]/2+1,LiteGraph.NODE_TITLE_HEIGHT):T.rect(this.size[0]/2,A,this.size[0]/2+1,LiteGraph.NODE_TITLE_HEIGHT):R?T.roundRect(0,A,this.size[0]/2+1,LiteGraph.NODE_TITLE_HEIGHT,[0,0,8,8]):T.roundRect(this.size[0]/2,A,this.size[0]/2+1,LiteGraph.NODE_TITLE_HEIGHT,[0,0,8,8]),O?T.fill():T.fillRect(0,A,this.size[0]+1,LiteGraph.NODE_TITLE_HEIGHT),T.textAlign="center",T.font="24px Arial",T.fillStyle=O?"#DDD":"#999",T.fillText("+",this.size[0]*.25,A+24),T.fillText("+",this.size[0]*.75,A+24)}onMouseDown(T,_,w){if(!this.flags.collapsed&&_[0]>this.size[0]-LiteGraph.NODE_TITLE_HEIGHT&&_[1]<0){var B=this;setTimeout(function(){w.openSubgraph(B.subgraph)},10)}var A=this.size[1]-LiteGraph.NODE_TITLE_HEIGHT+.5;console.log(0),_[1]>A&&(_[0]<this.size[0]/2?(console.log(1),w.showSubgraphPropertiesDialog(this)):(console.log(2),w.showSubgraphPropertiesDialogRight(this)))}computeSize(){var T=this.inputs?this.inputs.length:0,_=this.outputs?this.outputs.length:0;return[200,Math.max(T,_)*LiteGraph.NODE_SLOT_HEIGHT+LiteGraph.NODE_TITLE_HEIGHT]}onSubgraphTrigger(T,_){console.log("onSubgraphTrigger",T,_);var w=this.findOutputSlot(T);w!=-1&&this.triggerSlot(w)}onSubgraphNewInput(T,_){var w=this.findInputSlot(T);w==-1&&this.addInput(T,_)}onSubgraphRenamedInput(T,_){var w=this.findInputSlot(T);if(w!=-1){var B=this.getInputInfo(w);B.name=_}}onSubgraphTypeChangeInput(T,_){var w=this.findInputSlot(T);if(w!=-1){var B=this.getInputInfo(w);B.type=_}}onSubgraphRemovedInput(T){var _=this.findInputSlot(T);_!=-1&&this.removeInput(_)}onSubgraphNewOutput(T,_){var w=this.findOutputSlot(T);w==-1&&this.addOutput(T,_)}onSubgraphRenamedOutput(T,_){var w=this.findOutputSlot(T);if(w!=-1){var B=this.getOutputInfo(w);B.name=_}}onSubgraphTypeChangeOutput(T,_){var w=this.findOutputSlot(T);if(w!=-1){var B=this.getOutputInfo(w);B.type=_}}onSubgraphRemovedOutput(T){var _=this.findOutputSlot(T);_!=-1&&this.removeOutput(_)}getExtraMenuOptions(T){var _=this;return[{content:"Open",callback:function(){T.openSubgraph(_.subgraph)}}]}reassignSubgraphUUIDs(T){const _={nodeIDs:{},linkIDs:{}};for(const w of T.nodes){const B=w.id,A=LiteGraph.uuidv4();if(w.id=A,_.nodeIDs[B]||_.nodeIDs[A])throw new Error("New/old node UUID wasn't unique in changed map! ".concat(B," ").concat(A));_.nodeIDs[B]=A,_.nodeIDs[A]=B}for(const w of T.links){const B=w[0],A=LiteGraph.uuidv4();if(w[0]=A,_.linkIDs[B]||_.linkIDs[A])throw new Error("New/old link UUID wasn't unique in changed map! ".concat(B," ").concat(A));_.linkIDs[B]=A,_.linkIDs[A]=B;const O=w[1],R=w[3];if(!_.nodeIDs[O])throw new Error("Old node UUID not found in mapping! ".concat(O));if(w[1]=_.nodeIDs[O],!_.nodeIDs[R])throw new Error("Old node UUID not found in mapping! ".concat(R));w[3]=_.nodeIDs[R]}for(const w of T.nodes){if(w.inputs)for(const B of w.inputs)B.link&&(B.link=_.linkIDs[B.link]);if(w.outputs)for(const B of w.outputs)B.links&&(B.links=B.links.map(A=>_.linkIDs[A]))}for(const w of T.nodes)if(w.type==="middle/graph/subgraph"){const B=reassignGraphUUIDs(w.subgraph);_.nodeIDs.assign(B.nodeIDs),_.linkIDs.assign(B.linkIDs)}}clone(){var T=LiteGraph.createNode(this.type),_=this.serialize();if(LiteGraph.use_uuids){const w=LiteGraph.cloneObject(_.subgraph);this.reassignSubgraphUUIDs(w),_.subgraph=w}return delete _.id,delete _.inputs,delete _.outputs,T.configure(_),T}buildFromNodes(T){for(var _={},w=0,B=0;B<T.length;++B){var A=T[B];_[A.id]=A,w=Math.min(A.pos[0],w),Math.max(A.pos[0],w)}for(var B=0;B<T.length;++B){var A=T[B];if(A.inputs)for(var O=0;O<A.inputs.length;++O){var R=A.inputs[O];if(!(!R||!R.link)){var P=A.graph.links[R.link];P&&(_[P.origin_id]||this.subgraph.addInput(R.name,P.type))}}if(A.outputs)for(var O=0;O<A.outputs.length;++O){var E=A.outputs[O];if(!(!E||!E.links||!E.links.length))for(var D=!1,I=0;I<E.links.length;++I){var P=A.graph.links[E.links[I]];if(P&&!_[P.target_id]){D=!0;break}}}}}}Subgraph.title="分支蓝图";Subgraph.input_node_type="middle/graph/input";Subgraph.output_node_type="middle/graph/output";LiteGraph.Subgraph=Subgraph;LiteGraph.registerNodeType("middle/graph/subgraph",Subgraph);class GraphInput extends LGraphNode{constructor(){super();St(this,"title","输入");St(this,"desc","用于对子蓝图输入参数");this.addOutput("","number"),this.name_in_graph="",this.properties={name:"",type:"number",value:0};var T=this;this.name_widget=this.addWidget("text","Name",this.properties.name,function(_){_&&T.setProperty("name",_)}),this.type_widget=this.addWidget("text","Type",this.properties.type,function(_){T.setProperty("type",_)}),this.value_widget=this.addWidget("number","Value",this.properties.value,function(_){T.setProperty("value",_)}),this.widgets_up=!0,this.size=[180,90]}onConfigure(){this.updateType()}updateType(){var T=this.properties.type;this.type_widget.value=T,this.outputs[0].type!=T&&(LiteGraph.isValidConnection(this.outputs[0].type,T)||this.disconnectOutput(0),this.outputs[0].type=T),T=="number"?(this.value_widget.type="number",this.value_widget.value=0):T=="boolean"?(this.value_widget.type="toggle",this.value_widget.value=!0):T=="string"?(this.value_widget.type="text",this.value_widget.value=""):(this.value_widget.type=null,this.value_widget.value=null),this.properties.value=this.value_widget.value,this.graph&&this.name_in_graph&&this.graph.changeInputType(this.name_in_graph,T)}onPropertyChanged(T,_){if(T=="name"){if(_==""||_==this.name_in_graph||_=="enabled")return!1;this.graph&&(this.name_in_graph?this.graph.renameInput(this.name_in_graph,_):this.graph.addInput(_,this.properties.type)),this.name_widget.value=_,this.name_in_graph=_}else T=="type"&&this.updateType()}getTitle(){return this.flags.collapsed?this.properties.name:this.title}onAction(T,_){console.log("graph input 收到了action",T,_),this.properties.type==LiteGraph.EVENT&&this.triggerSlot(0,_)}onExecute(){var T=this.properties.name,_=this.graph.inputs[T];if(!_){this.setOutputData(0,this.properties.value);return}this.setOutputData(0,_.value!==void 0?_.value:this.properties.value)}onRemoved(){this.name_in_graph&&this.graph.removeInput(this.name_in_graph)}}GraphInput.title="输入";LiteGraph.GraphInput=GraphInput;LiteGraph.registerNodeType("middle/graph/input",GraphInput);class GraphOutput extends LGraphNode{constructor(){super();St(this,"title","输出");St(this,"desc","用于对子蓝图输出参数");this.addInput("",""),this.name_in_graph="",this.properties={name:"",type:""},this.name_widget=this.addWidget("text","Name",this.properties.name,"name"),this.type_widget=this.addWidget("text","Type",this.properties.type,"type"),this.widgets_up=!0,this.size=[180,60]}onPropertyChanged(T,_){if(T=="name"){if(_==""||_==this.name_in_graph||_=="enabled")return!1;this.graph&&(this.name_in_graph?this.graph.renameOutput(this.name_in_graph,_):this.graph.addOutput(_,this.properties.type)),this.name_widget.value=_,this.name_in_graph=_}else T=="type"&&this.updateType()}updateType(){var T=this.properties.type;this.type_widget&&(this.type_widget.value=T),this.inputs[0].type!=T&&((T=="action"||T=="event")&&(T=LiteGraph.EVENT),LiteGraph.isValidConnection(this.inputs[0].type,T)||this.disconnectInput(0),this.inputs[0].type=T),this.graph&&this.name_in_graph&&this.graph.changeOutputType(this.name_in_graph,T)}onExecute(){this._value=this.getInputData(0),this.graph.setOutputData(this.properties.name,this._value)}onAction(T,_){this.properties.type==LiteGraph.ACTION&&this.graph.trigger(this.properties.name,_)}onRemoved(){this.name_in_graph&&this.graph.removeOutput(this.name_in_graph)}getTitle(){return this.flags.collapsed?this.properties.name:this.title}}GraphOutput.title="输出";LiteGraph.GraphOutput=GraphOutput;LiteGraph.registerNodeType("middle/graph/output",GraphOutput);class BaseScriptRobot extends LGraphNode{constructor(){super();St(this,"title","自定义脚本基础类");St(this,"desc","直接挂载游戏中的脚本的指令继承于此")}getCom(){let T=this.properties.configKey;if(T.indexOf("cc.")!=-1)return new cc[T.split(".")[1]];let _=cc.js.getClassByName(T);return _==null?(console.warn("找不到脚本组件"+T+"请在App中测试真实运行效果"),null):new _}onStart(){var T=this.getInputNode(0);if(T!=null&&T.codeNode!=null)this.hasRunRobotStart=!0,this.component&&this.component.robotStart!=null&&this.component.robotStart(this);else{let B=null;if(this.properties.isSingleClass==!0)B=this.getCom();else{let A=this.graph.vars.rootccNode;if(A==null){let O=cc.director.getScene().getChildByName("Canvas");A=O.getChildByName("_componentsNode"),A==null&&(A=new cc.Node,A.name="_componentsNode",A.parent=O)}B=this.getCom(),A.addComponent(B)}if(B==null)return;for(var _ in this.properties){var w=null;this.getPropertyInfo(_).type=="robot"?w=this.graph.getNodeById(this.properties[_]):w=this.properties[_],B[_]!=w&&(B[_]=w)}this.component=B,this.component.outputHandle=this.outputHandle,this.component.codeProgress=this.graph,this.component&&this.component.robotStart!=null&&this.component.robotStart(this)}this.getInputDataType(0)=="codeNode"&&this.getInputData(0)!=null&&this.onBindCodeNode(this.getInputData(0))}onBindCodeNode(T){if(cc.js.getClassByName(this.properties.configKey)==null){console.warn("找不到脚本组件"+this.properties.configKey+"请在App中测试真实运行效果");return}var w=T.getComponent(this.properties.configKey);if(w==null&&(w=T.addComponent(this.properties.configKey)),this.properties.configKey=="cc.Mask")if(this.properties.radius!=0){var B=T.getComponent("RoundRectMask");B==null&&(B=T.addComponent("RoundRectMask")),B._radius=this.properties.radius}else T.removeComponent("RoundRectMask");var A=R=>{var P=null;let E=this.getPropertyInfo(R);E.type=="robot"?P=this.graph.getNodeById(this.properties[R]):E.type=="spriteFrame"?this.codeProgress.codeRobotConfig.loadResHandle(this.properties[R],cc.SpriteFrame,D=>{P=D,w[R]!=P&&P!=null&&(w[R]=P)}):P=this.properties[R],w[R]!=P&&P!=null&&(w[R]=P)};for(var O in this.properties)A(O);this.component=w,this.component.outputHandle=this.outputHandle.bind(this),this.component.codeProgress=this.graph,this.hasRunRobotStart==!0&&this.component.robotStart!=null&&this.component.robotStart(this)}inputHandle(T){this.component==null?showAlert(this.properties.configKey+"还未初始化就输入了"):this.component.inputHandle!=null&&this.component.inputHandle(T)}outputHandle(T,_){let w=this.findOutputSlot(T);w!=-1&&(this.getOutputInfo(w).type==LiteGraph.EVENT?this.triggerSlot(w,_):this.setOutputData(w,_))}onPause(){this.component&&this.component.robotPause!=null&&this.component.robotPause()}onResume(){this.component&&this.component.robotResume!=null&&this.component.robotResume()}inRunFreshConfig(T){this.component!=null&&(this.component[T]=this.properties.otherConfig[T],this.component.inRunFreshConfig!=null&&this.component.inRunFreshConfig(T))}onStop(){this.hasRunRobotStart=!1,this.component&&this.component.robotRelease!=null&&this.component.robotRelease()}}class MotionText extends BaseScriptRobot{constructor(){super();St(this,"title","字幕");St(this,"desc","在绘本中添加字幕");this.mode=LiteGraph.ON_EVENT,this.size=[80,20],this.addInput("物体","codeNode"),this.addInput("启用",LiteGraph.ACTION),this.addInput("隐藏",LiteGraph.ACTION),this.addOutput("onend",LiteGraph.EVENT),this.addProperty("autoRun",!1,"boolean"),this.addWidget("toggle","自动播放",this.properties.autoRun,"autoRun"),this.addProperty("dir",!1,"boolean"),this.addWidget("toggle","文本竖向排列",this.properties.dir,"dir"),this.addProperty("hideBeforRun",!0,"boolean"),this.addWidget("toggle","运行前隐藏",this.properties.hideBeforRun,"hideBeforRun"),this.addProperty("hideAfterRun",!1,"boolean"),this.addWidget("toggle","运行结束隐藏",this.properties.hideAfterRun,"hideAfterRun"),this.addProperty("hideBaseLabel",!1,"boolean"),this.addWidget("toggle","隐藏底层文字",this.properties.hideBaseLabel,"hideBaseLabel"),this.addProperty("position","0,1","string"),this.addWidget("string","分段位置",this.properties.position,"position"),this.addProperty("positionTime","0,2","string"),this.addWidget("string","分段时间",this.properties.positionTime,"positionTime"),this.addProperty("maskColor","#88BF3D","string"),this.addWidget("string","过渡颜色",this.properties.maskColor,"maskColor"),this.addProperty("configKey","MotionText","string")}onConnectInput(T,_,w,B,A){console.log("MotionText onConnectInput",T,_),T==0&&_=="codeNode"&&B.setProperty("anchorX",0)}onAction(T,_){if(this.component!=null){if(this.component.inputHandle==null){console.warn("inputHandle == null");return}T=="启用"?this.component.inputHandle({targetSolt:"show"}):T=="隐藏"&&this.component.inputHandle({targetSolt:"hide"})}}}MotionText.title="字幕";LiteGraph.registerNodeType("output/customComponent/MotionText",MotionText);class CaiDanComponent extends BaseScriptRobot{constructor(){super();St(this,"title","桃桃彩蛋");St(this,"desc","在绘本中添加桃桃彩蛋");this.mode=LiteGraph.ON_EVENT,this.size=[80,20],this.addInput("物体","codeNode"),this.addOutput("onclick",LiteGraph.EVENT),this.addProperty("caidanYuyin","","string"),this.addWidget("string","彩蛋语音",this.properties.caidanYuyin,"caidanYuyin"),this.addProperty("startSound","","string"),this.addWidget("string","出现语音",this.properties.startSound,"startSound"),this.addProperty("caidanId",0,"number"),this.addWidget("slider","彩蛋Id",this.properties.caidanId,"caidanId",{min:0,max:10,precision:0}),this.addProperty("caidanPosX",0,"number"),this.addWidget("number","桃桃动画位置X",this.properties.caidanPosX,"caidanPosX",{precision:1}),this.addProperty("caidanPosY",0,"number"),this.addWidget("number","桃桃动画位置Y",this.properties.caidanPosY,"caidanPosY",{precision:1}),this.addProperty("playSound",!0,"boolean"),this.addWidget("toggle","播放声音",this.properties.playSound,"playSound"),this.addProperty("configKey","CaiDanComponent","string")}}CaiDanComponent.title="桃桃彩蛋";LiteGraph.registerNodeType("output/customComponent/CaiDanComponent",CaiDanComponent);class CaiDanComponent2 extends BaseScriptRobot{constructor(){super();St(this,"title","收藏品彩蛋");St(this,"desc","在绘本中添加收藏品彩蛋");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("物体","codeNode"),this.addProperty("caidanId",0,"number"),this.addWidget("slider","彩蛋Id",this.properties.caidanId,"caidanId",{min:0,max:10,precision:0}),this.addProperty("configKey","CaiDanComponent2","string")}}CaiDanComponent2.title="收藏品彩蛋";LiteGraph.registerNodeType("output/customComponent/CaiDanComponent2",CaiDanComponent2);class ChatComponent extends BaseScriptRobot{constructor(){super();St(this,"title","对话提示气泡");St(this,"desc","在绘本中添加对话提示气泡");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("物体","codeNode"),this.addInput("输入",LiteGraph.ACTION),this.addInput("更新",LiteGraph.ACTION),this.addOutput("点击",LiteGraph.EVENT),this.addProperty("key","","string"),this.addWidget("string","点击标记",this.properties.key,"key"),this.addProperty("configKey","ChatComponent","string"),this.addProperty("dirType","左下","enum"),this.addWidget("combo","气泡箭头方向",this.properties.dirType,{property:"dirType",values:["左下","右下","右上","左上"]})}}ChatComponent.title="对话提示气泡";LiteGraph.registerNodeType("output/customComponent/ChatComponent",ChatComponent);class VoiceCheck extends BaseScriptRobot{constructor(){super();St(this,"title","声音检测");St(this,"desc","在绘本中添加声音检测");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("开始",LiteGraph.ACTION),this.addInput("停止",LiteGraph.ACTION),this.addOutput("输出",LiteGraph.EVENT),this.addProperty("testStr","","string"),this.addWidget("string","检测的字符",this.properties.testStr,"testStr"),this.addProperty("testStrGroup","","string"),this.addWidget("string","检测的词组（用,分割）",this.properties.testStrGroup,"testStrGroup"),this.addProperty("checkType","左下","enum"),this.addWidget("combo","检测模式",this.properties.checkType,{property:"checkType",values:["跟读","关键字模式"]}),this.addProperty("configKey","VoiceCheck","string"),this.addProperty("isSingleClass",!0,"boolean")}}VoiceCheck.title="声音检测";LiteGraph.registerNodeType("output/customComponent/VoiceCheck",VoiceCheck);class AngleCompoment extends BaseScriptRobot{constructor(){super();St(this,"title","角度定位");St(this,"desc","在绘本中添加物让其根据输入的角度定位");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("物体","codeNode"),this.addInput("开启监听",LiteGraph.ACTION),this.addInput("重置",LiteGraph.ACTION),this.addOutput("number1","number"),this.addProperty("configKey","AngleCompoment","string")}}AngleCompoment.title="角度定位";LiteGraph.registerNodeType("output/customComponent/AngleCompoment",AngleCompoment);class ScaleObj extends BaseScriptRobot{constructor(){super();St(this,"title","双指缩放");St(this,"desc","在绘本中添加双指缩放手势");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("物体","codeNode"),this.addInput("启用",LiteGraph.ACTION),this.addInput("关闭",LiteGraph.ACTION),this.addOutput("onScale",LiteGraph.EVENT),this.addProperty("configKey","AngleCompoment","string"),this.addProperty("scaleMin",.5,"number"),this.addWidget("number","最小缩放",this.properties.scaleMin,"scaleMin",{precision:1}),this.addProperty("scaleMax",2,"number"),this.addWidget("number","最大缩放",this.properties.scaleMax,"scaleMax",{precision:1}),this.addProperty("dynimicCenter",!1,"boolean"),this.addWidget("toggle","是否以当前中心缩放",this.properties.dynimicCenter,"dynimicCenter")}}ScaleObj.title="双指缩放";LiteGraph.registerNodeType("output/customComponent/ScaleObj",ScaleObj);class ProgressCompoment extends BaseScriptRobot{constructor(){super();St(this,"title","进度条");St(this,"desc","发送绘本页面进度事件，关联图片类型的物体使用");this.mode=LiteGraph.ON_EVENT,this.size=[80,30],this.addInput("物体","codeNode"),this.addInput("进度","number"),this.addInput("更新",LiteGraph.ACTION),this.addProperty("configKey","ProgressCompoment","string")}}ProgressCompoment.title="进度条";LiteGraph.registerNodeType("output/customComponent/ProgressCompoment",ProgressCompoment);class ccMask extends BaseScriptRobot{constructor(){super();St(this,"title","蒙版");St(this,"desc","给节点添加蒙版效果");this.mode=LiteGraph.ON_EVENT,this.addInput("物体","codeNode"),this.addProperty("configKey","cc.Mask","string"),this.addProperty("type",0,"number"),this.addWidget("combo","遮罩类型",this.properties.type,{property:"type",values:{0:"矩形",1:"圆形",2:"图片"}}),this.addProperty("inverted",!1,"boolean"),this.addWidget("toggle","反向遮罩",this.properties.inverted,"inverted"),this.addProperty("alphaThreshold",.5,"number"),this.addWidget("number","透明度阀值",this.properties.alphaThreshold,"alphaThreshold",{precision:2,min:0,max:1}),this.addProperty("segements",50,"number"),this.addWidget("number","椭圆遮罩曲线数",this.properties.segements,"segements",{precision:2,min:1,max:100}),this.addProperty("radius",0,"number"),this.addWidget("number","矩形圆角曲线数",this.properties.radius,"radius",{precision:1,min:0,max:100}),this.addProperty("spriteFrame","","string"),this.addWidget("string","图片路径",this.properties.spriteFrame,"spriteFrame")}updateWidght(){var T=this.properties.type;this.widgets.map(_=>{_.name=="矩形圆角曲线数"?_.disabled=T!=0:_.name=="椭圆遮罩曲线数"&&(_.disabled=T!=1)})}onWidgetChanged(T){console.log("当前这招类型",this.properties.type),T=="遮罩类型"&&this.updateWidght()}}ccMask.title="蒙版";LiteGraph.registerNodeType("output/customComponent/ccMask",ccMask);class contact extends LGraphNode{constructor(){super();St(this,"title","接触感应器");St(this,"desc","检测物体相互接触");this.size=[250,50],this.addInput("检测目标物体","codeNode"),this.addInput("其它可接触物体","codeNode"),this.getOutputNodes(),this.addOutput("接触数量","number"),this.addOutput("最后接触物体","codeNode"),this.addOutput("接触时",LiteGraph.EVENT),this.addOutput("离开时",LiteGraph.EVENT),this.curContactNum=0,this.bindTrackCodeNode=[]}onGetInputs(){return console.log("我调用了onGetOutputs"),[["其它可接触物体","codeNode"]]}onStart(){this.bindTrackCodeNode=[];let T=[];for(var _=1;_<this.inputs.length;_++)T.push(this.getInputData(_)),this.getInputData(_)!=null&&this.bindTrackCodeNode.push(this.getInputData(_));console.log("当前链接的solts",T),this.onBindCodeNode(this.getInputData(0))}onBindCodeNode(T){console.log("开始监听接触对象",T),this.codeNode!=null&&(this.codeNode.removeRobotListener("contact",this.getIdWithGraph()),this.codeNode.removeRobotListener("uncontact",this.getIdWithGraph())),this.curContactNum=0,this.setOutputData(0,this.curContactNum),this.codeNode=T,T!=null&&(this.codeNode.addRobotListener("contact",this.getIdWithGraph(),_=>{this.bindTrackCodeNode.indexOf(_)!=-1&&(this.curContactNum+=1,this.setOutputData(0,this.curContactNum),this.setOutputData(1,_),this.triggerSlot(2))}),this.codeNode.addRobotListener("uncontact",this.getIdWithGraph(),_=>{this.bindTrackCodeNode.indexOf(_)!=-1&&(this.curContactNum-=1,this.setOutputData(0,this.curContactNum),this.setOutputData(1,_),this.curContactNum<=0&&(this.curContactNum=0,this.triggerSlot(3)))}))}onStop(){console.log("移除监听事件",this.codeNode,this.getIdWithGraph()),this.codeNode!=null&&(this.codeNode.removeRobotListener("contact",this.getIdWithGraph()),this.codeNode.removeRobotListener("uncontact",this.getIdWithGraph()))}}contact.title="接触感应器";LiteGraph.registerNodeType("objects/objectSensor/contact",contact);class position extends LGraphNode{constructor(){super();St(this,"title","位置感应器");St(this,"desc","检测物体位置变化");this.size=[250,50],this.mode=LiteGraph.ON_EVENT,this.addInput("目标物体","codeNode"),this.addInput("修改x","number"),this.addInput("修改y","number"),this.addInput("触发",LiteGraph.ACTION),this.addOutput("x","number"),this.addOutput("y","number"),this.addOutput("变化",LiteGraph.EVENT),this.addProperty("xRange","[-999999, 999999]","text"),this.xRangeWidget=this.addWidget("text","x范围",this.properties.xRange,"xRange"),this.addProperty("yRange","[-999999, 999999]","text"),this.yRangeWidget=this.addWidget("text","y范围",this.properties.yRange,"yRange"),this.addProperty("modal","直接修改","enum",{values:["直接修改","增量修改"]}),this.addWidget("combo","修改方式",this.properties.modal,{property:"modal",values:["直接修改","增量修改"]}),this.addProperty("rangeWithSize",!1,"boolean"),this.addWidget("toggle","范围包含节点尺寸",this.properties.rangeWithSize,"resetWhenToggle")}onPropertyChanged(T,_){if(T=="xRange"||T=="yRange")try{this["_"+T]=JSON.parse(_),this.boxcolor="#AEA"}catch(w){this.boxcolor="red"}}onStart(){this._xRange=JSON.parse(this.properties.xRange),this._yRange=JSON.parse(this.properties.yRange),this.onBindCodeNode(this.getInputData(0))}onBindCodeNode(T){this.codeNode!=null&&(this.codeNode.removeRobotListener("x",this.getIdWithGraph()),this.codeNode.removeRobotListener("y",this.getIdWithGraph())),this.codeNode=T,T!=null&&(this.codeNode.addRobotListener("x",this.getIdWithGraph(),_=>{this.setOutputData(0,_),this.triggerSlot(2)}),this.codeNode.addRobotListener("y",this.getIdWithGraph(),_=>{this.setOutputData(1,_),this.triggerSlot(2)}))}onStop(){this.codeNode=null}onAction(){if(this.codeNode==null)return;let T=this.getInputData(1),_=this.getInputData(2),w=this._xRange,B=this._yRange;if(T!=null){if(this.properties.rangeWithSize==!0){var A=this.codeNode.anchorX*this.codeNode.width*Math.abs(this.codeNode.scaleX);w=[w[0]+A,w[1]-A],w[1]<w[0]&&(w[1]=w[1]+w[0],w[0]=w[1]-w[0],w[1]=w[1]-w[0])}this.properties.modal=="增量修改"?(this.codeNode.realX+T>=w[1]?T=w[1]-this.codeNode.realX:this.codeNode.realX+T<=w[0]&&(T=w[0]-this.codeNode.realX),this.codeNode.realX=this.codeNode.realX+T):(T>w[1]&&(T=w[1]),T<w[0]&&(T=w[0]),this.codeNode.realX=T)}if(_!=null){if(this.properties.rangeWithSize==!0){var O=this.codeNode.anchorY*this.codeNode.height*Math.abs(this.codeNode.scaleY);B=[B[0]+O,B[1]-O],B[1]<B[0]&&(B[1]=B[1]+B[0],B[0]=B[1]-B[0],B[1]=B[1]-B[0])}this.properties.modal=="增量修改"?(this.codeNode.realY+_>=B[1]?_=B[1]-this.codeNode.realY:this.codeNode.realY+_<=B[0]&&(_=B[0]-this.codeNode.realY),this.codeNode.realY=this.codeNode.realY+_):(_>B[1]&&(_=B[1]),_<B[0]&&(_=B[0]),this.codeNode.realY=_)}}}position.title="位置感应器";LiteGraph.registerNodeType("objects/objectSensor/position",position);class publicListen extends LGraphNode{constructor(){super();St(this,"title","属性感应器");St(this,"desc","检测物体各种属性变化");this.mode=LiteGraph.ON_EVENT,this.addInput("目标物体","codeNode"),this.addInput("修改值","number"),this.addInput("触发",LiteGraph.ACTION),this.addOutput("数值","number"),this.addOutput("变化",LiteGraph.EVENT),this.addProperty("range","[-999999, 999999]","text"),this.rangeWidget=this.addWidget("text","范围",this.properties.range,"range"),this.addProperty("customKey","透明度","enum",{values:publicListen.selectEnums}),this.addWidget("combo","监听信息",this.properties.customKey,{property:"customKey",values:publicListen.selectEnums}),this.addProperty("modal","直接修改","enum",{values:["直接修改","增量修改"]}),this.addWidget("combo","修改方式",this.properties.modal,{property:"modal",values:["直接修改","增量修改"]})}onPropertyChanged(T,_){if(T=="range")try{this["_"+T]=JSON.parse(_),this.boxcolor="#AEA"}catch(w){this.boxcolor="red"}}onStart(){this._range=JSON.parse(this.properties.range),this.onBindCodeNode(this.getInputData(0))}onBindCodeNode(T){let _=publicListen.selectEnums.indexOf(this.properties.customKey);if(_==-1){console.warn("没有对应的可监听事件",this.properties.customKey);return}let w=publicListen.chooseKey[_];this.codeNode!=null&&this.codeNode.removeRobotListener(w,this.getIdWithGraph()),this.codeNode=T,T!=null&&this.codeNode.addRobotListener(w,this.getIdWithGraph(),B=>{this.setOutputData(0,B),this.triggerSlot(1)})}onStop(){this.codeNode=null}onAction(){if(this.codeNode==null)return;let T=this.getInputData(1),_=publicListen.selectEnums.indexOf(this.properties.customKey);if(_==-1){console.warn("没有对应的可监听事件",this.properties.customKey);return}let w=publicListen.chooseKey[_];if(w!=null){var B=this._range;this.properties.modal=="增量修改"?(this.codeNode[w]+T>=B[1]&&(T=B[1]-this.codeNode[w]),this.codeNode[w]+T<=B[0]&&(T=B[0]-this.codeNode[w]),this.codeNode[w]=this.codeNode[w]+T):(T>B[1]&&(T=B[1]),T<B[0]&&(T=B[0]),this.codeNode[w]=T)}else this.codeNode[w]=T}}publicListen.title="属性感应器";publicListen.selectEnums=["透明度","层级","缩放X","缩放Y","长度","高度","显隐","角度"];publicListen.chooseKey=["opacity","zIndex","scaleX","scaleY","width","height","active","angle"];LiteGraph.registerNodeType("objects/objectSensor/publicListen",publicListen);class dragNumGame extends BaseYWNode{constructor(){super();St(this,"title","value");St(this,"desc","这是一个拖拽数数游戏的模型");St(this,"name","拖拽数数游戏控制器");this.addInput("物体","codeNode"),this.addOutput("播放问题",LiteGraph.EVENT),this.addOutput("当前正确数量","number"),this.addOutput("输出正确反馈",LiteGraph.EVENT),this.addOutput("输出错误反馈",LiteGraph.EVENT),this.addOutput("输出结束反馈",LiteGraph.EVENT),this.addProperty("rightCount",5),this.widget=this.addWidget("number","正确选项数量",5,"rightCount",{precision:0,step2:1})}onStart(){this.trigger("播放问题"),this.curRightCount=0}onAction(T){T=="right"?(this.curRightCount+=1,this.setOutputData(1,this.curRightCount),this.trigger("输出正确反馈"),this.curRightCount==this.properties.rightCount&&this.trigger("输出结束反馈")):T=="error"&&this.trigger("输出错误反馈")}}dragNumGame.title="拖拽数数游戏控制器";dragNumGame.nodeType="output/tatagame/dragGame/dragGameControl";LiteGraph.registerNodeType(dragNumGame.nodeType,dragNumGame);class dragNumObj extends BaseYWNode{constructor(){super();St(this,"title","value");St(this,"desc","这是一个拖拽数数游戏的选项，关联到选项上");St(this,"name","拖拽数数游戏选项");this.addInput("物体","codeNode"),this.addProperty("isRight",!0),this.widget=this.addWidget("toggle","是否为正确选项",!0,"isRight"),this.widgets_up=!0}onExecute(){}onStart(){super.onStart();let T=this.getInputData(0);if(this.touchIds={},T!=null){this.startPos==null&&(this.startPos=cc.v2(T.x,T.y),this.startZIndex=T.zIndex);var _=null,w=5,B=null;T.targetOff(this),T.on(cc.Node.EventType.TOUCH_START,A=>{if(this.inAni!=!0){_=null,B=A.getID();var O=A.getID();this.touchIds[O]=1,T.zIndex=1999}},this),T.on(cc.Node.EventType.TOUCH_MOVE,A=>{if(!(Object.keys(this.touchIds).length>1)&&B==A.getID()&&this.graph.config.pause!=1&&this.inAni!=!0){if(this.instance!=null&&w<5){w+=1;return}if(w=0,_==null){_=T.parent.convertToNodeSpaceAR(A.getLocation());return}var O=T.parent.convertToNodeSpaceAR(A.getLocation()),R=O.sub(_);T.x+=R.x,T.y+=R.y,_=O}},this),T.on(cc.Node.EventType.TOUCH_END,A=>{if(this.inAni!=!0){var O=A.getID();delete this.touchIds[O],this.checkIsInTarget(T,A)}},this),T.on(cc.Node.EventType.TOUCH_CANCEL,A=>{if(this.inAni!=!0){var O=A.getID();delete this.touchIds[O],this.checkIsInTarget(T,A)}},this)}}checkIsInTarget(T,_){let w=!1,B=this.graph.findNodesByType(dragNumGame.nodeType)[0];if(B==null)return;let A=B.getInputData(0,!0);if(A!=null){var O=A.getComponent(cc.PolygonCollider);if(O!=null){var R=A.node.convertToNodeSpaceAR(_.getLocation());w=cc.Intersection.pointInPolygon(R,O.points),console.log("判断是否处于碰撞框内",w)}else console.warn("目标对象没有添加碰撞框"),window.antAleart!=null&&window.antAleart("目标对象没有添加碰撞框")}w==!1?(this.inAni=!0,cc.tween(T).to(.5,{x:this.startPos.x,y:this.startPos.y}).call(()=>{T.zIndex=this.startZIndex,this.inAni=!1}).start()):this.properties.isRight==!0?(B.onAction("right"),T.targetOff(this),cc.tween(T).to(.5,{opacity:0}).start()):(B.onAction("error"),this.inAni=!0,cc.tween(T).to(.5,{x:this.startPos.x,y:this.startPos.y}).call(()=>{T.zIndex=this.startZIndex,this.inAni=!1}).start())}}dragNumObj.title="拖拽数数游戏选项";dragNumObj.nodeType="output/tatagame/dragGame/dragNumObj";LiteGraph.registerNodeType(dragNumObj.nodeType,dragNumObj);console.log("定义了nodetypes");var sparkMd5={exports:{}},hasRequiredSparkMd5;function requireSparkMd5(){return hasRequiredSparkMd5||(hasRequiredSparkMd5=1,function(L,S){(function(T){L.exports=T()})(function(T){var _=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function w(G,V){var j=G[0],H=G[1],U=G[2],X=G[3];j+=(H&U|~H&X)+V[0]-680876936|0,j=(j<<7|j>>>25)+H|0,X+=(j&H|~j&U)+V[1]-389564586|0,X=(X<<12|X>>>20)+j|0,U+=(X&j|~X&H)+V[2]+606105819|0,U=(U<<17|U>>>15)+X|0,H+=(U&X|~U&j)+V[3]-1044525330|0,H=(H<<22|H>>>10)+U|0,j+=(H&U|~H&X)+V[4]-176418897|0,j=(j<<7|j>>>25)+H|0,X+=(j&H|~j&U)+V[5]+1200080426|0,X=(X<<12|X>>>20)+j|0,U+=(X&j|~X&H)+V[6]-1473231341|0,U=(U<<17|U>>>15)+X|0,H+=(U&X|~U&j)+V[7]-45705983|0,H=(H<<22|H>>>10)+U|0,j+=(H&U|~H&X)+V[8]+1770035416|0,j=(j<<7|j>>>25)+H|0,X+=(j&H|~j&U)+V[9]-1958414417|0,X=(X<<12|X>>>20)+j|0,U+=(X&j|~X&H)+V[10]-42063|0,U=(U<<17|U>>>15)+X|0,H+=(U&X|~U&j)+V[11]-1990404162|0,H=(H<<22|H>>>10)+U|0,j+=(H&U|~H&X)+V[12]+1804603682|0,j=(j<<7|j>>>25)+H|0,X+=(j&H|~j&U)+V[13]-40341101|0,X=(X<<12|X>>>20)+j|0,U+=(X&j|~X&H)+V[14]-1502002290|0,U=(U<<17|U>>>15)+X|0,H+=(U&X|~U&j)+V[15]+1236535329|0,H=(H<<22|H>>>10)+U|0,j+=(H&X|U&~X)+V[1]-165796510|0,j=(j<<5|j>>>27)+H|0,X+=(j&U|H&~U)+V[6]-1069501632|0,X=(X<<9|X>>>23)+j|0,U+=(X&H|j&~H)+V[11]+643717713|0,U=(U<<14|U>>>18)+X|0,H+=(U&j|X&~j)+V[0]-373897302|0,H=(H<<20|H>>>12)+U|0,j+=(H&X|U&~X)+V[5]-701558691|0,j=(j<<5|j>>>27)+H|0,X+=(j&U|H&~U)+V[10]+38016083|0,X=(X<<9|X>>>23)+j|0,U+=(X&H|j&~H)+V[15]-660478335|0,U=(U<<14|U>>>18)+X|0,H+=(U&j|X&~j)+V[4]-405537848|0,H=(H<<20|H>>>12)+U|0,j+=(H&X|U&~X)+V[9]+568446438|0,j=(j<<5|j>>>27)+H|0,X+=(j&U|H&~U)+V[14]-1019803690|0,X=(X<<9|X>>>23)+j|0,U+=(X&H|j&~H)+V[3]-187363961|0,U=(U<<14|U>>>18)+X|0,H+=(U&j|X&~j)+V[8]+1163531501|0,H=(H<<20|H>>>12)+U|0,j+=(H&X|U&~X)+V[13]-1444681467|0,j=(j<<5|j>>>27)+H|0,X+=(j&U|H&~U)+V[2]-51403784|0,X=(X<<9|X>>>23)+j|0,U+=(X&H|j&~H)+V[7]+1735328473|0,U=(U<<14|U>>>18)+X|0,H+=(U&j|X&~j)+V[12]-1926607734|0,H=(H<<20|H>>>12)+U|0,j+=(H^U^X)+V[5]-378558|0,j=(j<<4|j>>>28)+H|0,X+=(j^H^U)+V[8]-2022574463|0,X=(X<<11|X>>>21)+j|0,U+=(X^j^H)+V[11]+1839030562|0,U=(U<<16|U>>>16)+X|0,H+=(U^X^j)+V[14]-35309556|0,H=(H<<23|H>>>9)+U|0,j+=(H^U^X)+V[1]-1530992060|0,j=(j<<4|j>>>28)+H|0,X+=(j^H^U)+V[4]+1272893353|0,X=(X<<11|X>>>21)+j|0,U+=(X^j^H)+V[7]-155497632|0,U=(U<<16|U>>>16)+X|0,H+=(U^X^j)+V[10]-1094730640|0,H=(H<<23|H>>>9)+U|0,j+=(H^U^X)+V[13]+681279174|0,j=(j<<4|j>>>28)+H|0,X+=(j^H^U)+V[0]-358537222|0,X=(X<<11|X>>>21)+j|0,U+=(X^j^H)+V[3]-722521979|0,U=(U<<16|U>>>16)+X|0,H+=(U^X^j)+V[6]+76029189|0,H=(H<<23|H>>>9)+U|0,j+=(H^U^X)+V[9]-640364487|0,j=(j<<4|j>>>28)+H|0,X+=(j^H^U)+V[12]-421815835|0,X=(X<<11|X>>>21)+j|0,U+=(X^j^H)+V[15]+530742520|0,U=(U<<16|U>>>16)+X|0,H+=(U^X^j)+V[2]-995338651|0,H=(H<<23|H>>>9)+U|0,j+=(U^(H|~X))+V[0]-198630844|0,j=(j<<6|j>>>26)+H|0,X+=(H^(j|~U))+V[7]+1126891415|0,X=(X<<10|X>>>22)+j|0,U+=(j^(X|~H))+V[14]-1416354905|0,U=(U<<15|U>>>17)+X|0,H+=(X^(U|~j))+V[5]-57434055|0,H=(H<<21|H>>>11)+U|0,j+=(U^(H|~X))+V[12]+1700485571|0,j=(j<<6|j>>>26)+H|0,X+=(H^(j|~U))+V[3]-1894986606|0,X=(X<<10|X>>>22)+j|0,U+=(j^(X|~H))+V[10]-1051523|0,U=(U<<15|U>>>17)+X|0,H+=(X^(U|~j))+V[1]-2054922799|0,H=(H<<21|H>>>11)+U|0,j+=(U^(H|~X))+V[8]+1873313359|0,j=(j<<6|j>>>26)+H|0,X+=(H^(j|~U))+V[15]-30611744|0,X=(X<<10|X>>>22)+j|0,U+=(j^(X|~H))+V[6]-1560198380|0,U=(U<<15|U>>>17)+X|0,H+=(X^(U|~j))+V[13]+1309151649|0,H=(H<<21|H>>>11)+U|0,j+=(U^(H|~X))+V[4]-145523070|0,j=(j<<6|j>>>26)+H|0,X+=(H^(j|~U))+V[11]-1120210379|0,X=(X<<10|X>>>22)+j|0,U+=(j^(X|~H))+V[2]+718787259|0,U=(U<<15|U>>>17)+X|0,H+=(X^(U|~j))+V[9]-343485551|0,H=(H<<21|H>>>11)+U|0,G[0]=j+G[0]|0,G[1]=H+G[1]|0,G[2]=U+G[2]|0,G[3]=X+G[3]|0}function B(G){var V=[],j;for(j=0;j<64;j+=4)V[j>>2]=G.charCodeAt(j)+(G.charCodeAt(j+1)<<8)+(G.charCodeAt(j+2)<<16)+(G.charCodeAt(j+3)<<24);return V}function A(G){var V=[],j;for(j=0;j<64;j+=4)V[j>>2]=G[j]+(G[j+1]<<8)+(G[j+2]<<16)+(G[j+3]<<24);return V}function O(G){var V=G.length,j=[1732584193,-271733879,-1732584194,271733878],H,U,X,Y,z,W;for(H=64;H<=V;H+=64)w(j,B(G.substring(H-64,H)));for(G=G.substring(H-64),U=G.length,X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=0;H<U;H+=1)X[H>>2]|=G.charCodeAt(H)<<(H%4<<3);if(X[H>>2]|=128<<(H%4<<3),H>55)for(w(j,X),H=0;H<16;H+=1)X[H]=0;return Y=V*8,Y=Y.toString(16).match(/(.*?)(.{0,8})$/),z=parseInt(Y[2],16),W=parseInt(Y[1],16)||0,X[14]=z,X[15]=W,w(j,X),j}function R(G){var V=G.length,j=[1732584193,-271733879,-1732584194,271733878],H,U,X,Y,z,W;for(H=64;H<=V;H+=64)w(j,A(G.subarray(H-64,H)));for(G=H-64<V?G.subarray(H-64):new Uint8Array(0),U=G.length,X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=0;H<U;H+=1)X[H>>2]|=G[H]<<(H%4<<3);if(X[H>>2]|=128<<(H%4<<3),H>55)for(w(j,X),H=0;H<16;H+=1)X[H]=0;return Y=V*8,Y=Y.toString(16).match(/(.*?)(.{0,8})$/),z=parseInt(Y[2],16),W=parseInt(Y[1],16)||0,X[14]=z,X[15]=W,w(j,X),j}function P(G){var V="",j;for(j=0;j<4;j+=1)V+=_[G>>j*8+4&15]+_[G>>j*8&15];return V}function E(G){var V;for(V=0;V<G.length;V+=1)G[V]=P(G[V]);return G.join("")}E(O("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function G(V,j){return V=V|0||0,V<0?Math.max(V+j,0):Math.min(V,j)}ArrayBuffer.prototype.slice=function(V,j){var H=this.byteLength,U=G(V,H),X=H,Y,z,W,Z;return j!==T&&(X=G(j,H)),U>X?new ArrayBuffer(0):(Y=X-U,z=new ArrayBuffer(Y),W=new Uint8Array(z),Z=new Uint8Array(this,U,Y),W.set(Z),z)}}();function D(G){return/[\u0080-\uFFFF]/.test(G)&&(G=unescape(encodeURIComponent(G))),G}function I(G,V){var j=G.length,H=new ArrayBuffer(j),U=new Uint8Array(H),X;for(X=0;X<j;X+=1)U[X]=G.charCodeAt(X);return V?U:H}function M(G){return String.fromCharCode.apply(null,new Uint8Array(G))}function N(G,V,j){var H=new Uint8Array(G.byteLength+V.byteLength);return H.set(new Uint8Array(G)),H.set(new Uint8Array(V),G.byteLength),H}function k(G){var V=[],j=G.length,H;for(H=0;H<j-1;H+=2)V.push(parseInt(G.substr(H,2),16));return String.fromCharCode.apply(String,V)}function F(){this.reset()}return F.prototype.append=function(G){return this.appendBinary(D(G)),this},F.prototype.appendBinary=function(G){this._buff+=G,this._length+=G.length;var V=this._buff.length,j;for(j=64;j<=V;j+=64)w(this._hash,B(this._buff.substring(j-64,j)));return this._buff=this._buff.substring(j-64),this},F.prototype.end=function(G){var V=this._buff,j=V.length,H,U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X;for(H=0;H<j;H+=1)U[H>>2]|=V.charCodeAt(H)<<(H%4<<3);return this._finish(U,j),X=E(this._hash),G&&(X=k(X)),this.reset(),X},F.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},F.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},F.prototype.setState=function(G){return this._buff=G.buff,this._length=G.length,this._hash=G.hash,this},F.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},F.prototype._finish=function(G,V){var j=V,H,U,X;if(G[j>>2]|=128<<(j%4<<3),j>55)for(w(this._hash,G),j=0;j<16;j+=1)G[j]=0;H=this._length*8,H=H.toString(16).match(/(.*?)(.{0,8})$/),U=parseInt(H[2],16),X=parseInt(H[1],16)||0,G[14]=U,G[15]=X,w(this._hash,G)},F.hash=function(G,V){return F.hashBinary(D(G),V)},F.hashBinary=function(G,V){var j=O(G),H=E(j);return V?k(H):H},F.ArrayBuffer=function(){this.reset()},F.ArrayBuffer.prototype.append=function(G){var V=N(this._buff.buffer,G),j=V.length,H;for(this._length+=G.byteLength,H=64;H<=j;H+=64)w(this._hash,A(V.subarray(H-64,H)));return this._buff=H-64<j?new Uint8Array(V.buffer.slice(H-64)):new Uint8Array(0),this},F.ArrayBuffer.prototype.end=function(G){var V=this._buff,j=V.length,H=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],U,X;for(U=0;U<j;U+=1)H[U>>2]|=V[U]<<(U%4<<3);return this._finish(H,j),X=E(this._hash),G&&(X=k(X)),this.reset(),X},F.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},F.ArrayBuffer.prototype.getState=function(){var G=F.prototype.getState.call(this);return G.buff=M(G.buff),G},F.ArrayBuffer.prototype.setState=function(G){return G.buff=I(G.buff,!0),F.prototype.setState.call(this,G)},F.ArrayBuffer.prototype.destroy=F.prototype.destroy,F.ArrayBuffer.prototype._finish=F.prototype._finish,F.ArrayBuffer.hash=function(G,V){var j=R(new Uint8Array(G)),H=E(j);return V?k(H):H},F})}(sparkMd5)),sparkMd5.exports}var sparkMd5Exports=requireSparkMd5();const SparkMD5=getDefaultExportFromCjs(sparkMd5Exports);var aliyunOssSdk$1={exports:{}},hasRequiredAliyunOssSdk;function requireAliyunOssSdk(){return hasRequiredAliyunOssSdk||(hasRequiredAliyunOssSdk=1,function(L,S){(function(T){(function(_){L.exports=_()})(function(){return function(){function _(w,B,A){function O(E,D){if(!B[E]){if(!w[E]){var I=typeof commonjsRequire=="function"&&commonjsRequire;if(!D&&I)return I(E,!0);if(R)return R(E,!0);var M=new Error("Cannot find module '"+E+"'");throw M.code="MODULE_NOT_FOUND",M}var N=B[E]={exports:{}};w[E][0].call(N.exports,function(k){var F=w[E][1][k];return O(F||k)},N,N.exports,_,w,B,A)}return B[E].exports}for(var R=typeof commonjsRequire=="function"&&commonjsRequire,P=0;P<A.length;P++)O(A[P]);return O}return _}()({1:[function(_,w,B){var A=_("./browser/client");A.Buffer=_("buffer").Buffer,A.urllib=_("../shims/xhr"),A.version=_("./browser/version").version,w.exports=A},{"../shims/xhr":546,"./browser/client":3,"./browser/version":6,buffer:103}],2:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator"));_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.array.slice.js");var P=_("assert"),E=_("../common/utils/checkBucketName"),D=E.checkBucketName,I=B;function M(k){return Array.isArray?Array.isArray(k):Object.prototype.toString.call(k)==="[object Array]"}function N(k){return k?M(k)?k:[k]:[]}I.useBucket=function(F){return D(F),this.options.bucket=F,this},I.setBucket=function(F){return D(F),this.options.bucket=F,this},I.getBucket=function(){return this.options.bucket},I.deleteBucket=function(){var k=(0,R.default)(O.default.mark(function G(V,j){var H,U;return O.default.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return H=this._bucketRequestParams("DELETE",V,"",j),Y.next=3,this.request(H);case 3:if(U=Y.sent,!(U.status===200||U.status===204)){Y.next=6;break}return Y.abrupt("return",{res:U.res});case 6:return Y.next=8,this.requestError(U);case 8:throw Y.sent;case 9:case"end":return Y.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I.putBucketACL=function(){var k=(0,R.default)(O.default.mark(function G(V,j,H){var U,X;return O.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return U=this._bucketRequestParams("PUT",V,"acl",H),U.headers={"x-oss-acl":j},U.successStatuses=[200],z.next=5,this.request(U);case 5:return X=z.sent,z.abrupt("return",{bucket:X.headers.location&&X.headers.location.substring(1)||null,res:X.res});case 7:case"end":return z.stop()}},G,this)}));function F(G,V,j){return k.apply(this,arguments)}return F}(),I.getBucketACL=function(){var k=(0,R.default)(O.default.mark(function G(V,j){var H,U;return O.default.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return H=this._bucketRequestParams("GET",V,"acl",j),H.successStatuses=[200],H.xmlResponse=!0,Y.next=5,this.request(H);case 5:return U=Y.sent,Y.abrupt("return",{acl:U.data.AccessControlList.Grant,owner:{id:U.data.Owner.ID,displayName:U.data.Owner.DisplayName},res:U.res});case 7:case"end":return Y.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I.putBucketLogging=function(){var k=(0,R.default)(O.default.mark(function G(V,j,H){var U,X,Y;return O.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return U=this._bucketRequestParams("PUT",V,"logging",H),X='<?xml version="1.0" encoding="UTF-8"?>\n<BucketLoggingStatus>\n<LoggingEnabled>\n<TargetBucket>'.concat(V,"</TargetBucket>\n"),j&&(X+="<TargetPrefix>".concat(j,"</TargetPrefix>\n")),X+="</LoggingEnabled>\n</BucketLoggingStatus>",U.content=X,U.mime="xml",U.successStatuses=[200],W.next=9,this.request(U);case 9:return Y=W.sent,W.abrupt("return",{res:Y.res});case 11:case"end":return W.stop()}},G,this)}));function F(G,V,j){return k.apply(this,arguments)}return F}(),I.getBucketLogging=function(){var k=(0,R.default)(O.default.mark(function G(V,j){var H,U,X;return O.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return H=this._bucketRequestParams("GET",V,"logging",j),H.successStatuses=[200],H.xmlResponse=!0,z.next=5,this.request(H);case 5:return U=z.sent,X=U.data.LoggingEnabled,z.abrupt("return",{enable:!!X,prefix:X&&X.TargetPrefix||null,res:U.res});case 8:case"end":return z.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I.deleteBucketLogging=function(){var k=(0,R.default)(O.default.mark(function G(V,j){var H,U;return O.default.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return H=this._bucketRequestParams("DELETE",V,"logging",j),H.successStatuses=[204,200],Y.next=4,this.request(H);case 4:return U=Y.sent,Y.abrupt("return",{res:U.res});case 6:case"end":return Y.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I.putBucketCORS=function(){var k=(0,R.default)(O.default.mark(function G(V,j,H){var U,X,Y,z,W,Z,Q,ee,te,re;return O.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:for(j=j||[],P(j.length,"rules is required"),j.forEach(function(he){P(he.allowedOrigin,"allowedOrigin is required"),P(he.allowedMethod,"allowedMethod is required")}),U=this._bucketRequestParams("PUT",V,"cors",H),X='<?xml version="1.0" encoding="UTF-8"?>\n<CORSConfiguration>',Y=function(pe){X+="<AllowedOrigin>".concat(pe,"</AllowedOrigin>")},z=function(pe){X+="<AllowedMethod>".concat(pe,"</AllowedMethod>")},W=function(pe){X+="<AllowedHeader>".concat(pe,"</AllowedHeader>")},Z=function(pe){X+="<ExposeHeader>".concat(pe,"</ExposeHeader>")},Q=0,ee=j.length;Q<ee;Q++)te=j[Q],X+="<CORSRule>",N(te.allowedOrigin).forEach(Y),N(te.allowedMethod).forEach(z),N(te.allowedHeader).forEach(W),N(te.exposeHeader).forEach(Z),te.maxAgeSeconds&&(X+="<MaxAgeSeconds>".concat(te.maxAgeSeconds,"</MaxAgeSeconds>")),X+="</CORSRule>";return X+="</CORSConfiguration>",U.content=X,U.mime="xml",U.successStatuses=[200],ne.next=16,this.request(U);case 16:return re=ne.sent,ne.abrupt("return",{res:re.res});case 18:case"end":return ne.stop()}},G,this)}));function F(G,V,j){return k.apply(this,arguments)}return F}(),I.getBucketCORS=function(){var k=(0,R.default)(O.default.mark(function G(V,j){var H,U,X,Y;return O.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return H=this._bucketRequestParams("GET",V,"cors",j),H.successStatuses=[200],H.xmlResponse=!0,W.next=5,this.request(H);case 5:return U=W.sent,X=[],U.data&&U.data.CORSRule&&(Y=U.data.CORSRule,M(Y)||(Y=[Y]),Y.forEach(function(Z){var Q={};Object.keys(Z).forEach(function(ee){Q[ee.slice(0,1).toLowerCase()+ee.slice(1,ee.length)]=Z[ee]}),X.push(Q)})),W.abrupt("return",{rules:X,res:U.res});case 9:case"end":return W.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I.deleteBucketCORS=function(){var k=(0,R.default)(O.default.mark(function G(V,j){var H,U;return O.default.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return H=this._bucketRequestParams("DELETE",V,"cors",j),H.successStatuses=[204],Y.next=4,this.request(H);case 4:return U=Y.sent,Y.abrupt("return",{res:U.res});case 6:case"end":return Y.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I.putBucketReferer=function(){var k=(0,R.default)(O.default.mark(function G(V,j,H,U){var X,Y,z,W;return O.default.wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(X=this._bucketRequestParams("PUT",V,"referer",U),Y='<?xml version="1.0" encoding="UTF-8"?>\n<RefererConfiguration>\n',Y+="  <AllowEmptyReferer>".concat(j?"true":"false","</AllowEmptyReferer>\n"),H&&H.length>0){for(Y+="  <RefererList>\n",z=0;z<H.length;z++)Y+="    <Referer>".concat(H[z],"</Referer>\n");Y+="  </RefererList>\n"}else Y+="  <RefererList />\n";return Y+="</RefererConfiguration>",X.content=Y,X.mime="xml",X.successStatuses=[200],Q.next=10,this.request(X);case 10:return W=Q.sent,Q.abrupt("return",{res:W.res});case 12:case"end":return Q.stop()}},G,this)}));function F(G,V,j,H){return k.apply(this,arguments)}return F}(),I.getBucketReferer=function(){var k=(0,R.default)(O.default.mark(function G(V,j){var H,U,X;return O.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return H=this._bucketRequestParams("GET",V,"referer",j),H.successStatuses=[200],H.xmlResponse=!0,z.next=5,this.request(H);case 5:return U=z.sent,X=U.data.RefererList.Referer||null,X&&(M(X)||(X=[X])),z.abrupt("return",{allowEmpty:U.data.AllowEmptyReferer==="true",referers:X,res:U.res});case 9:case"end":return z.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I.deleteBucketReferer=function(){var k=(0,R.default)(O.default.mark(function G(V,j){return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,this.putBucketReferer(V,!0,null,j);case 2:return U.abrupt("return",U.sent);case 3:case"end":return U.stop()}},G,this)}));function F(G,V){return k.apply(this,arguments)}return F}(),I._bucketRequestParams=function(F,G,V,j){return{method:F,bucket:G,subres:V,additionalHeaders:j&&j.additionalHeaders,timeout:j&&j.timeout,ctx:j&&j.ctx}}},{"../common/utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,assert:95,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/web.dom-collections.for-each.js":380}],3:[function(_,w,B){(function(A,O){(function(){var R=_("@babel/runtime/helpers/interopRequireDefault"),P=R(_("@babel/runtime/regenerator")),E=R(_("@babel/runtime/helpers/asyncToGenerator"));_("core-js/modules/es.function.name.js"),_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.array.includes.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.symbol.js"),_("core-js/modules/es.symbol.description.js"),_("core-js/modules/es.array.slice.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.promise.js"),_("core-js/modules/es.regexp.to-string.js");var D=_("debug")("ali-oss"),I=_("xml2js"),M=_("agentkeepalive"),N=_("merge-descriptors"),k=_("platform"),F=_("utility"),G=_("urllib"),V=_("./version"),j=_("bowser"),H=_("../common/signUtils"),U=_("../common/client/initOptions"),X=_("../common/utils/createRequest"),Y=X.createRequest,z=_("../common/utils/encoder"),W=z.encoder,Z=_("../common/client/getReqUrl"),Q=Z.getReqUrl,ee=_("../common/utils/setSTSToken"),te=ee.setSTSToken,re=_("../common/utils/retry"),ie=re.retry,ne=_("../common/utils/isFunction"),he=ne.isFunction,pe=_("../common/utils/getStandardRegion"),K=pe.getStandardRegion,ue=new M;function le(){var ye=k.name,ge=k.version;ye&&ye.toLowerCase&&ye.toLowerCase()==="ie"&&ge.split(".")[0]<10&&console.warn("ali-oss does not support the current browser")}function ce(){return location&&location.protocol==="https:"}function _e(ye,ge){if(le(),!(this instanceof _e))return new _e(ye,ge);ye&&ye.inited?this.options=ye:this.options=_e.initOptions(ye),this.options.cancelFlag=!1,this.options.urllib?this.urllib=this.options.urllib:(this.urllib=G,this.agent=this.options.agent||ue),this.ctx=ge,this.userAgent=this._getUserAgent(),this.stsTokenFreshTime=new Date,this.options.amendTimeSkewed=0}w.exports=_e,_e.initOptions=function(ge){ge.stsToken||console.warn("Please use STS Token for safety, see more details at https://help.aliyun.com/document_detail/32077.html");var we=Object.assign({secure:ce(),useFetch:!1},ge);return U(we)};var oe=_e.prototype;oe.debug=D,N(oe,_("./object")),N(oe,_("./bucket")),N(oe,_("../common/bucket/getBucketWebsite")),N(oe,_("../common/bucket/putBucketWebsite")),N(oe,_("../common/bucket/deleteBucketWebsite")),N(oe,_("../common/bucket/getBucketLifecycle")),N(oe,_("../common/bucket/putBucketLifecycle")),N(oe,_("../common/bucket/deleteBucketLifecycle")),N(oe,_("../common/bucket/putBucketVersioning")),N(oe,_("../common/bucket/getBucketVersioning")),N(oe,_("../common/bucket/getBucketInventory")),N(oe,_("../common/bucket/deleteBucketInventory")),N(oe,_("../common/bucket/listBucketInventory")),N(oe,_("../common/bucket/putBucketInventory")),N(oe,_("../common/bucket/abortBucketWorm")),N(oe,_("../common/bucket/completeBucketWorm")),N(oe,_("../common/bucket/extendBucketWorm")),N(oe,_("../common/bucket/getBucketWorm")),N(oe,_("../common/bucket/initiateBucketWorm")),N(oe,_("./managed-upload")),N(oe,_("../common/multipart-copy")),N(oe,_("../common/multipart")),N(oe,_("../common/parallel")),oe.signature=function(ge){return this.debug("authorization stringToSign: %s",ge,"info"),H.computeSignature(this.options.accessKeySecret,ge,this.options.headerEncoding)},oe._getReqUrl=Q,oe.authorization=function(ge,we,Te,Ee){var De=H.buildCanonicalString(ge.toUpperCase(),we,{headers:Ee,parameters:Te});return H.authorization(this.options.accessKeyId,this.options.accessKeySecret,De,this.options.headerEncoding)},oe.authorizationV4=function(ge,we,Te,Ee,De){return H.authorizationV4(this.options.accessKeyId,this.options.accessKeySecret,K(this.options.region),ge,we,Te,Ee,De,this.options.headerEncoding)},oe.request=function(){var ye=(0,E.default)(P.default.mark(function ge(we){var Te=this;return P.default.wrap(function(De){for(;;)switch(De.prev=De.next){case 0:if(!this.options.retryMax){De.next=6;break}return De.next=3,ie(de.bind(this),this.options.retryMax,{errorHandler:function(Ce){var Se=function(Re){if(we.stream)return!1;var Ve=[-1,-2].includes(Re.status),Pe=Te.options.requestErrorRetryHandle||function(){return!0};return Ve&&Pe(Re)};return!!Se(Ce)}})(we);case 3:return De.abrupt("return",De.sent);case 6:return De.abrupt("return",de.call(this,we));case 7:case"end":return De.stop()}},ge,this)}));return function(ge){return ye.apply(this,arguments)}}();function de(ye){return me.apply(this,arguments)}function me(){return me=(0,E.default)(P.default.mark(function ye(ge){var we,Te,Ee,De,fe,Ce;return P.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(!(this.options.stsToken&&he(this.options.refreshSTSToken))){be.next=3;break}return be.next=3,te.call(this);case 3:return we=Y.call(this,ge),this.options.useFetch||(we.params.mode="disable-fetch"),De=!!ge.stream,be.prev=6,be.next=9,this.urllib.request(we.url,we.params);case 9:Te=be.sent,this.debug("response %s %s, got %s, headers: %j",ge.method,we.url,Te.status,Te.headers,"info"),be.next=16;break;case 13:be.prev=13,be.t0=be.catch(6),Ee=be.t0;case 16:if(!(Te&&ge.successStatuses&&ge.successStatuses.indexOf(Te.status)===-1)){be.next=28;break}return be.next=19,this.requestError(Te);case 19:if(fe=be.sent,!(fe.code==="RequestTimeTooSkewed"&&!De)){be.next=25;break}return this.options.amendTimeSkewed=+new Date(fe.serverTime)-new Date,be.next=24,this.request(ge);case 24:return be.abrupt("return",be.sent);case 25:fe.params=ge,be.next=32;break;case 28:if(!Ee){be.next=32;break}return be.next=31,this.requestError(Ee);case 31:fe=be.sent;case 32:if(!fe){be.next=34;break}throw fe;case 34:if(!ge.xmlResponse){be.next=39;break}return be.next=37,this.parseXML(Te.data);case 37:Ce=be.sent,Te.data=Ce;case 39:return be.abrupt("return",Te);case 40:case"end":return be.stop()}},ye,this,[[6,13]])})),me.apply(this,arguments)}oe._getResource=function(ge){var we="/";return ge.bucket&&(we+="".concat(ge.bucket,"/")),ge.object&&(we+=W(ge.object,this.options.headerEncoding)),we},oe._escape=function(ge){return F.encodeURIComponent(ge).replace(/%2F/g,"/")},oe._getUserAgent=function(){var ge=O&&O.browser?"js":"nodejs",we="aliyun-sdk-".concat(ge,"/").concat(V.version),Te=k.description;return!Te&&O&&(Te="Node.js ".concat(O.version.slice(1)," on ").concat(O.platform," ").concat(O.arch)),this._checkUserAgent("".concat(we," ").concat(Te))},oe._checkUserAgent=function(ge){var we=ge.replace(/\u03b1/,"alpha").replace(/\u03b2/,"beta");return we},oe.checkBrowserAndVersion=function(ge,we){return j.name===ge&&j.version.split(".")[0]===we},oe.parseXML=function(ge){return new Promise(function(we,Te){A.isBuffer(ge)&&(ge=ge.toString()),I.parseString(ge,{explicitRoot:!1,explicitArray:!1},function(Ee,De){Ee?Te(Ee):we(De)})})},oe.requestError=function(){var ye=(0,E.default)(P.default.mark(function we(Te){var Ee=this,De,fe,Ce,Se,be;return P.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(De=null,fe=function(){var Pe=(0,E.default)(P.default.mark(function ke(Ne){var Ae,Oe;return P.default.wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:return nt.prev=0,nt.next=3,Ee.parseXML(Ne);case 3:if(nt.t0=nt.sent,nt.t0){nt.next=6;break}nt.t0={};case 6:Ae=nt.t0,nt.next=16;break;case 9:return nt.prev=9,nt.t1=nt.catch(0),Ee.debug(Ne,"error"),nt.t1.message+="\nraw xml: ".concat(Ne),nt.t1.status=Te.status,nt.t1.requestId=Te.headers&&Te.headers["x-oss-request-id"],nt.abrupt("return",nt.t1);case 16:return Oe=Ae.Message||"unknow request error, status: ".concat(Te.status),Ae.Condition&&(Oe+=" (condition: ".concat(Ae.Condition,")")),De=new Error(Oe),De.name=Ae.Code?"".concat(Ae.Code,"Error"):"UnknownError",De.status=Te.status,De.code=Ae.Code,De.ecCode=Ae.EC,De.requestId=Ae.RequestId,De.hostId=Ae.HostId,De.serverTime=Ae.ServerTime,nt.abrupt("return",De);case 27:case"end":return nt.stop()}},ke,null,[[0,9]])}));return function(Ne){return Pe.apply(this,arguments)}}(),!(!Te.data||!Te.data.length)){Ve.next=38;break}if(!(Te.status===-1||Te.status===-2)){Ve.next=10;break}De=new Error(Te.message),De.name=Te.name,De.status=Te.status,De.code=Te.name,Ve.next=36;break;case 10:if(Te.status!==404){Ve.next=17;break}De=new Error("Object not exists"),De.name="NoSuchKeyError",De.status=404,De.code="NoSuchKey",Ve.next=34;break;case 17:if(Te.status!==412){Ve.next=24;break}De=new Error("Pre condition failed"),De.name="PreconditionFailedError",De.status=412,De.code="PreconditionFailed",Ve.next=34;break;case 24:if(De=new Error("Unknow error, status: ".concat(Te.status)),De.name="UnknownError",De.status=Te.status,De.res=Te,Ce=Te.headers&&Te.headers["x-oss-err"],!Ce){Ve.next=34;break}return Se=atob(Ce),Ve.next=33,fe(Se);case 33:De=Ve.sent;case 34:De.requestId=Te.headers&&Te.headers["x-oss-request-id"],De.host="";case 36:Ve.next=43;break;case 38:return be=String(Te.data),this.debug("request response error data: %s",be,"error"),Ve.next=42,fe(be);case 42:De=Ve.sent;case 43:return this.debug("generate error %j",De,"error"),Ve.abrupt("return",De);case 45:case"end":return Ve.stop()}},we,this)}));function ge(we){return ye.apply(this,arguments)}return ge}()}).call(this)}).call(this,{isBuffer:_("../../node_modules/is-buffer/index.js")},_("_process"))},{"../../node_modules/is-buffer/index.js":409,"../common/bucket/abortBucketWorm":7,"../common/bucket/completeBucketWorm":8,"../common/bucket/deleteBucketInventory":9,"../common/bucket/deleteBucketLifecycle":10,"../common/bucket/deleteBucketWebsite":11,"../common/bucket/extendBucketWorm":12,"../common/bucket/getBucketInventory":13,"../common/bucket/getBucketLifecycle":14,"../common/bucket/getBucketVersioning":15,"../common/bucket/getBucketWebsite":16,"../common/bucket/getBucketWorm":17,"../common/bucket/initiateBucketWorm":18,"../common/bucket/listBucketInventory":19,"../common/bucket/putBucketInventory":20,"../common/bucket/putBucketLifecycle":21,"../common/bucket/putBucketVersioning":22,"../common/bucket/putBucketWebsite":23,"../common/client/getReqUrl":25,"../common/client/initOptions":26,"../common/multipart":30,"../common/multipart-copy":29,"../common/parallel":51,"../common/signUtils":52,"../common/utils/createRequest":58,"../common/utils/encoder":62,"../common/utils/getStandardRegion":65,"../common/utils/isFunction":72,"../common/utils/retry":80,"../common/utils/setSTSToken":82,"./bucket":2,"./managed-upload":4,"./object":5,"./version":6,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,_process:538,agentkeepalive:94,bowser:101,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.includes.js":315,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.function.name.js":322,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.replace.js":345,"core-js/modules/es.symbol.description.js":351,"core-js/modules/es.symbol.js":354,debug:536,"merge-descriptors":428,platform:440,urllib:546,utility:545,xml2js:496}],4:[function(_,w,B){(function(A){(function(){var O=_("@babel/runtime/helpers/interopRequireDefault"),R=O(_("@babel/runtime/regenerator"));_("core-js/modules/es.function.name.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.promise.js"),_("core-js/modules/es.array.from.js"),_("core-js/modules/es.string.iterator.js"),_("core-js/modules/es.array.map.js"),_("core-js/modules/es.array.filter.js"),_("core-js/modules/es.array.find.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/es.array.slice.js"),_("core-js/modules/es.array.iterator.js"),_("core-js/modules/es.array-buffer.slice.js"),_("core-js/modules/es.typed-array.uint8-array.js"),_("core-js/modules/es.typed-array.copy-within.js"),_("core-js/modules/es.typed-array.every.js"),_("core-js/modules/es.typed-array.fill.js"),_("core-js/modules/es.typed-array.filter.js"),_("core-js/modules/es.typed-array.find.js"),_("core-js/modules/es.typed-array.find-index.js"),_("core-js/modules/es.typed-array.for-each.js"),_("core-js/modules/es.typed-array.includes.js"),_("core-js/modules/es.typed-array.index-of.js"),_("core-js/modules/es.typed-array.iterator.js"),_("core-js/modules/es.typed-array.join.js"),_("core-js/modules/es.typed-array.last-index-of.js"),_("core-js/modules/es.typed-array.map.js"),_("core-js/modules/es.typed-array.reduce.js"),_("core-js/modules/es.typed-array.reduce-right.js"),_("core-js/modules/es.typed-array.reverse.js"),_("core-js/modules/es.typed-array.set.js"),_("core-js/modules/es.typed-array.slice.js"),_("core-js/modules/es.typed-array.some.js"),_("core-js/modules/es.typed-array.sort.js"),_("core-js/modules/es.typed-array.subarray.js"),_("core-js/modules/es.typed-array.to-locale-string.js"),_("core-js/modules/es.typed-array.to-string.js");var P=O(_("@babel/runtime/helpers/asyncToGenerator")),E=_("util"),D=_("path"),I=_("mime"),M=_("copy-to"),N=_("../common/utils/isBlob"),k=N.isBlob,F=_("../common/utils/isFile"),G=F.isFile,V=_("../common/utils/isBuffer"),j=V.isBuffer,H=B;H.multipartUpload=function(){var W=(0,P.default)(R.default.mark(function Q(ee,te){var re,ie,ne,he,pe,K,ue,le,ce,_e=arguments;return R.default.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(re=_e.length>2&&_e[2]!==void 0?_e[2]:{},this.resetCancelFlag(),re.disabledMD5=re.disabledMD5===void 0?!0:!!re.disabledMD5,!(re.checkpoint&&re.checkpoint.uploadId)){de.next=8;break}return te&&G(te)&&(re.checkpoint.file=te),de.next=7,this._resumeMultipart(re.checkpoint,re);case 7:return de.abrupt("return",de.sent);case 8:return ie=102400,re.mime||(G(te)?re.mime=I.getType(D.extname(te.name)):k(te)?re.mime=te.type:j(te)?re.mime="":re.mime=I.getType(D.extname(te))),re.headers=re.headers||{},this._convertMetaToHeaders(re.meta,re.headers),de.next=14,this._getFileSize(te);case 14:if(ne=de.sent,!(ne<ie)){de.next=26;break}return re.contentLength=ne,de.next=19,this.put(ee,te,re);case 19:if(he=de.sent,!(re&&re.progress)){de.next=23;break}return de.next=23,re.progress(1);case 23:return pe={res:he.res,bucket:this.options.bucket,name:ee,etag:he.res.headers.etag},(re.headers&&re.headers["x-oss-callback"]||re.callback)&&(pe.data=he.data),de.abrupt("return",pe);case 26:if(!(re.partSize&&parseInt(re.partSize,10)!==re.partSize)){de.next=28;break}throw new Error("partSize must be int number");case 28:if(!(re.partSize&&re.partSize<ie)){de.next=30;break}throw new Error("partSize must not be smaller than ".concat(ie));case 30:return de.next=32,this.initMultipartUpload(ee,re);case 32:if(K=de.sent,ue=K.uploadId,le=this._getPartSize(ne,re.partSize),ce={file:te,name:ee,fileSize:ne,partSize:le,uploadId:ue,doneParts:[]},!(re&&re.progress)){de.next=39;break}return de.next=39,re.progress(0,ce,K.res);case 39:return de.next=41,this._resumeMultipart(ce,re);case 41:return de.abrupt("return",de.sent);case 42:case"end":return de.stop()}},Q,this)}));function Z(Q,ee){return W.apply(this,arguments)}return Z}(),H._resumeMultipart=function(){var W=(0,P.default)(R.default.mark(function Q(ee,te){var re,ie,ne,he,pe,K,ue,le,ce,_e,oe,de,me,ye,ge,we,Te,Ee,De;return R.default.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(re=this,!this.isCancel()){Ce.next=3;break}throw this._makeCancelEvent();case 3:return ie=ee.file,ne=ee.fileSize,he=ee.partSize,pe=ee.uploadId,K=ee.doneParts,ue=ee.name,le=[],K.length>0&&M(K).to(le),ce=this._divideParts(ne,he),_e=ce.length,oe=!1,de=function(be,Re){return new Promise(function(){var Ve=(0,P.default)(R.default.mark(function Pe(ke,Ne){var Ae,Oe,Fe,nt,Ze;return R.default.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:if($e.prev=0,be.isCancel()){$e.next=29;break}return Ae=ce[Re-1],$e.next=5,be._createBuffer(ie,Ae.start,Ae.end);case 5:return Oe=$e.sent,Fe={content:Oe,size:Ae.end-Ae.start},$e.prev=7,$e.next=10,be._uploadPart(ue,pe,Re,Fe,te);case 10:nt=$e.sent,$e.next=18;break;case 13:if($e.prev=13,$e.t0=$e.catch(7),$e.t0.status!==404){$e.next=17;break}throw be._makeAbortEvent();case 17:throw $e.t0;case 18:if(!(!be.isCancel()&&!oe)){$e.next=26;break}if(ee.doneParts.push({number:Re,etag:nt.res.headers.etag}),!te.progress){$e.next=23;break}return $e.next=23,te.progress(K.length/(_e+1),ee,nt.res);case 23:ke({number:Re,etag:nt.res.headers.etag}),$e.next=27;break;case 26:ke();case 27:$e.next=30;break;case 29:ke();case 30:$e.next=41;break;case 32:$e.prev=32,$e.t1=$e.catch(0),Ze=new Error,Ze.name=$e.t1.name,Ze.message=$e.t1.message,Ze.stack=$e.t1.stack,Ze.partNum=Re,M($e.t1).to(Ze),Ne(Ze);case 41:case"end":return $e.stop()}},Pe,null,[[0,32],[7,13]])}));return function(Pe,ke){return Ve.apply(this,arguments)}}())},me=Array.from(new Array(_e),function(Se,be){return be+1}),ye=le.map(function(Se){return Se.number}),ge=me.filter(function(Se){return ye.indexOf(Se)<0}),we=5,Te=te.parallel||we,Ce.next=17,this._parallel(ge,Te,function(Se){return new Promise(function(be,Re){de(re,Se).then(function(Ve){Ve&&le.push(Ve),be()}).catch(function(Ve){Re(Ve)})})});case 17:if(Ee=Ce.sent,oe=!0,De=Ee.find(function(Se){return Se.name==="abort"}),!De){Ce.next=22;break}throw De;case 22:if(!this.isCancel()){Ce.next=25;break}throw de=null,this._makeCancelEvent();case 25:if(!(Ee&&Ee.length>0)){Ce.next=28;break}throw Ee[0].message="Failed to upload some parts with error: ".concat(Ee[0].toString()," part_num: ").concat(Ee[0].partNum),Ee[0];case 28:return Ce.next=30,this.completeMultipartUpload(ue,pe,le,te);case 30:return Ce.abrupt("return",Ce.sent);case 31:case"end":return Ce.stop()}},Q,this)}));function Z(Q,ee){return W.apply(this,arguments)}return Z}(),H._getFileSize=function(){var W=(0,P.default)(R.default.mark(function Q(ee){return R.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(!j(ee)){re.next=4;break}return re.abrupt("return",ee.length);case 4:if(!(k(ee)||G(ee))){re.next=6;break}return re.abrupt("return",ee.size);case 6:throw new Error("_getFileSize requires Buffer/File/Blob.");case 7:case"end":return re.stop()}},Q)}));function Z(Q){return W.apply(this,arguments)}return Z}();var U=_("stream"),X=U.Readable;function Y(W,Z){if(!(this instanceof Y))return new Y(W,Z);X.call(this,Z),this.file=W,this.reader=new FileReader,this.start=0,this.finish=!1,this.fileBuffer=null}E.inherits(Y,X),Y.prototype.readFileAndPush=function(Z){if(this.fileBuffer)for(var Q=!0;Q&&this.fileBuffer&&this.start<this.fileBuffer.length;){var ee=this.start,te=ee+Z;te=te>this.fileBuffer.length?this.fileBuffer.length:te,this.start=te,Q=this.push(this.fileBuffer.slice(ee,te))}},Y.prototype._read=function(Z){if(this.file&&this.start>=this.file.size||this.fileBuffer&&this.start>=this.fileBuffer.length||this.finish||this.start===0&&!this.file){this.finish||(this.fileBuffer=null,this.finish=!0),this.push(null);return}var Q=16*1024;Z=Z||Q;var ee=this;this.reader.onload=function(re){ee.fileBuffer=A.from(new Uint8Array(re.target.result)),ee.file=null,ee.readFileAndPush(Z)},this.start===0?this.reader.readAsArrayBuffer(this.file):this.readFileAndPush(Z)};function z(W){return W.arrayBuffer?W.arrayBuffer():new Promise(function(Z,Q){var ee=new FileReader;ee.onload=function(te){Z(te.target.result)},ee.onerror=function(te){Q(te)},ee.readAsArrayBuffer(W)})}H._createBuffer=function(){var W=(0,P.default)(R.default.mark(function Q(ee,te,re){var ie,ne;return R.default.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(!(k(ee)||G(ee))){pe.next=8;break}return ie=ee.slice(te,re),pe.next=4,z(ie);case 4:return ne=pe.sent,pe.abrupt("return",A.from(ne));case 8:if(!j(ee)){pe.next=12;break}return pe.abrupt("return",ee.subarray(te,re));case 12:throw new Error("_createBuffer requires File/Blob/Buffer.");case 13:case"end":return pe.stop()}},Q)}));function Z(Q,ee,te){return W.apply(this,arguments)}return Z}(),H._getPartSize=function(Z,Q){var ee=1e4,te=1*1024*1024;Q||(Q=te);var re=Math.ceil(Z/ee);return Q<re&&(Q=re,console.warn("partSize has been set to ".concat(Q,", because the partSize you provided causes partNumber to be greater than 10,000"))),Q},H._divideParts=function(Z,Q){for(var ee=Math.ceil(Z/Q),te=[],re=0;re<ee;re++){var ie=Q*re,ne=Math.min(ie+Q,Z);te.push({start:ie,end:ne})}return te}}).call(this)}).call(this,_("buffer").Buffer)},{"../common/utils/isBlob":68,"../common/utils/isBuffer":69,"../common/utils/isFile":71,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,buffer:103,"copy-to":107,"core-js/modules/es.array-buffer.slice.js":309,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.filter.js":312,"core-js/modules/es.array.find.js":313,"core-js/modules/es.array.from.js":314,"core-js/modules/es.array.iterator.js":316,"core-js/modules/es.array.map.js":318,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.function.name.js":322,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.iterator.js":343,"core-js/modules/es.typed-array.copy-within.js":356,"core-js/modules/es.typed-array.every.js":357,"core-js/modules/es.typed-array.fill.js":358,"core-js/modules/es.typed-array.filter.js":359,"core-js/modules/es.typed-array.find-index.js":360,"core-js/modules/es.typed-array.find.js":361,"core-js/modules/es.typed-array.for-each.js":362,"core-js/modules/es.typed-array.includes.js":363,"core-js/modules/es.typed-array.index-of.js":364,"core-js/modules/es.typed-array.iterator.js":365,"core-js/modules/es.typed-array.join.js":366,"core-js/modules/es.typed-array.last-index-of.js":367,"core-js/modules/es.typed-array.map.js":368,"core-js/modules/es.typed-array.reduce-right.js":369,"core-js/modules/es.typed-array.reduce.js":370,"core-js/modules/es.typed-array.reverse.js":371,"core-js/modules/es.typed-array.set.js":372,"core-js/modules/es.typed-array.slice.js":373,"core-js/modules/es.typed-array.some.js":374,"core-js/modules/es.typed-array.sort.js":375,"core-js/modules/es.typed-array.subarray.js":376,"core-js/modules/es.typed-array.to-locale-string.js":377,"core-js/modules/es.typed-array.to-string.js":378,"core-js/modules/es.typed-array.uint8-array.js":379,mime:430,path:439,stream:468,util:489}],5:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault");_("core-js/modules/es.function.name.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/es.array.map.js"),_("core-js/modules/es.number.constructor.js"),_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.promise.js");var O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("fs"),E=_("copy-to"),D=_("path"),I=_("mime"),M=_("../common/callback"),N=_("merge-descriptors"),k=_("../common/utils/isBlob"),F=k.isBlob,G=_("../common/utils/isFile"),V=G.isFile,j=_("../common/utils/isBuffer"),H=j.isBuffer,U=_("../common/utils/obj2xml"),X=U.obj2xml,Y=_("../common/utils/parseRestoreInfo"),z=Y.parseRestoreInfo,W=B;W.append=function(){var Z=(0,R.default)(O.default.mark(function ee(te,re,ie){var ne;return O.default.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return ie=ie||{},ie.position===void 0&&(ie.position="0"),ie.subres={append:"",position:ie.position},ie.method="POST",pe.next=6,this.put(te,re,ie);case 6:return ne=pe.sent,ne.nextAppendPosition=ne.res.headers["x-oss-next-append-position"],pe.abrupt("return",ne);case 9:case"end":return pe.stop()}},ee,this)}));function Q(ee,te,re){return Z.apply(this,arguments)}return Q}(),W.put=function(){var Z=(0,R.default)(O.default.mark(function ee(te,re,ie){var ne,he,pe,K,ue;return O.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(ie=ie||{},ie.disabledMD5=ie.disabledMD5===void 0?!0:!!ie.disabledMD5,ie.headers=ie.headers||{},te=this._objectName(te),!H(re)){ce.next=8;break}ne=re,ce.next=19;break;case 8:if(!(F(re)||V(re))){ce.next=18;break}return ie.mime||(V(re)?ie.mime=I.getType(D.extname(re.name)):ie.mime=re.type),ce.next=12,this._createBuffer(re,0,re.size);case 12:return ne=ce.sent,ce.next=15,this._getFileSize(re);case 15:ie.contentLength=ce.sent,ce.next=19;break;case 18:throw new TypeError("Must provide Buffer/Blob/File for put.");case 19:return this._convertMetaToHeaders(ie.meta,ie.headers),he=ie.method||"PUT",pe=this._objectRequestParams(he,te,ie),M.encodeCallback(pe,ie),pe.mime=ie.mime,pe.disabledMD5=ie.disabledMD5,pe.content=ne,pe.successStatuses=[200],ce.next=29,this.request(pe);case 29:return K=ce.sent,ue={name:te,url:this._objectUrl(te),res:K.res},pe.headers&&pe.headers["x-oss-callback"]&&(ue.data=JSON.parse(K.data.toString())),ce.abrupt("return",ue);case 33:case"end":return ce.stop()}},ee,this)}));function Q(ee,te,re){return Z.apply(this,arguments)}return Q}(),W.putStream=function(){var Z=(0,R.default)(O.default.mark(function ee(te,re,ie){var ne,he,pe,K;return O.default.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ie=ie||{},ie.headers=ie.headers||{},te=this._objectName(te),ie.contentLength?ie.headers["Content-Length"]=ie.contentLength:ie.headers["Transfer-Encoding"]="chunked",this._convertMetaToHeaders(ie.meta,ie.headers),ne=ie.method||"PUT",he=this._objectRequestParams(ne,te,ie),M.encodeCallback(he,ie),he.mime=ie.mime,he.stream=re,he.successStatuses=[200],le.next=13,this.request(he);case 13:return pe=le.sent,K={name:te,url:this._objectUrl(te),res:pe.res},he.headers&&he.headers["x-oss-callback"]&&(K.data=JSON.parse(pe.data.toString())),le.abrupt("return",K);case 17:case"end":return le.stop()}},ee,this)}));function Q(ee,te,re){return Z.apply(this,arguments)}return Q}(),N(W,_("../common/object/copyObject")),N(W,_("../common/object/getObjectTagging")),N(W,_("../common/object/putObjectTagging")),N(W,_("../common/object/deleteObjectTagging")),N(W,_("../common/image")),N(W,_("../common/object/getBucketVersions")),N(W,_("../common/object/getACL")),N(W,_("../common/object/putACL")),N(W,_("../common/object/head")),N(W,_("../common/object/delete")),N(W,_("../common/object/get")),N(W,_("../common/object/putSymlink")),N(W,_("../common/object/getSymlink")),N(W,_("../common/object/deleteMulti")),N(W,_("../common/object/getObjectMeta")),N(W,_("../common/object/getObjectUrl")),N(W,_("../common/object/generateObjectUrl")),N(W,_("../common/object/signatureUrl")),N(W,_("../common/object/asyncSignatureUrl")),N(W,_("../common/object/signatureUrlV4")),N(W,_("../common/object/signPostObjectPolicyV4")),W.putMeta=function(){var Z=(0,R.default)(O.default.mark(function ee(te,re,ie){var ne;return O.default.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,this.copy(te,te,{meta:re||{},timeout:ie&&ie.timeout,ctx:ie&&ie.ctx});case 2:return ne=pe.sent,pe.abrupt("return",ne);case 4:case"end":return pe.stop()}},ee,this)}));function Q(ee,te,re){return Z.apply(this,arguments)}return Q}(),W.list=function(){var Z=(0,R.default)(O.default.mark(function ee(te,re){var ie,ne,he,pe,K;return O.default.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ie=this._objectRequestParams("GET","",re),ie.query=te,ie.xmlResponse=!0,ie.successStatuses=[200],le.next=6,this.request(ie);case 6:return ne=le.sent,he=ne.data.Contents||[],pe=this,he&&(Array.isArray(he)||(he=[he]),he=he.map(function(ce){return{name:ce.Key,url:pe._objectUrl(ce.Key),lastModified:ce.LastModified,etag:ce.ETag,type:ce.Type,size:Number(ce.Size),storageClass:ce.StorageClass,owner:{id:ce.Owner.ID,displayName:ce.Owner.DisplayName},restoreInfo:z(ce.RestoreInfo)}})),K=ne.data.CommonPrefixes||null,K&&(Array.isArray(K)||(K=[K]),K=K.map(function(ce){return ce.Prefix})),le.abrupt("return",{res:ne.res,objects:he,prefixes:K,nextMarker:ne.data.NextMarker||null,isTruncated:ne.data.IsTruncated==="true"});case 13:case"end":return le.stop()}},ee,this)}));function Q(ee,te){return Z.apply(this,arguments)}return Q}(),W.listV2=function(){var Z=(0,R.default)(O.default.mark(function ee(te){var re,ie,ne,he,pe,K,ue,le=arguments;return O.default.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return re=le.length>1&&le[1]!==void 0?le[1]:{},ie=te["continuation-token"]||te.continuationToken,ie&&(re.subres=Object.assign({"continuation-token":ie},re.subres)),ne=this._objectRequestParams("GET","",re),ne.query=Object.assign({"list-type":2},te),delete ne.query["continuation-token"],delete ne.query.continuationToken,ne.xmlResponse=!0,ne.successStatuses=[200],_e.next=11,this.request(ne);case 11:return he=_e.sent,pe=he.data.Contents||[],K=this,pe&&(Array.isArray(pe)||(pe=[pe]),pe=pe.map(function(oe){var de=null;return oe.Owner&&(de={id:oe.Owner.ID,displayName:oe.Owner.DisplayName}),{name:oe.Key,url:K._objectUrl(oe.Key),lastModified:oe.LastModified,etag:oe.ETag,type:oe.Type,size:Number(oe.Size),storageClass:oe.StorageClass,owner:de,restoreInfo:z(oe.RestoreInfo)}})),ue=he.data.CommonPrefixes||null,ue&&(Array.isArray(ue)||(ue=[ue]),ue=ue.map(function(oe){return oe.Prefix})),_e.abrupt("return",{res:he.res,objects:pe,prefixes:ue,isTruncated:he.data.IsTruncated==="true",keyCount:+he.data.KeyCount,continuationToken:he.data.ContinuationToken||null,nextContinuationToken:he.data.NextContinuationToken||null});case 18:case"end":return _e.stop()}},ee,this)}));function Q(ee){return Z.apply(this,arguments)}return Q}(),W.restore=function(){var Z=(0,R.default)(O.default.mark(function ee(te){var re,ie,ne,he,pe=arguments;return O.default.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return re=pe.length>1&&pe[1]!==void 0?pe[1]:{type:"Archive"},re=re||{},re.subres=Object.assign({restore:""},re.subres),re.versionId&&(re.subres.versionId=re.versionId),ie=this._objectRequestParams("POST",te,re),ne={RestoreRequest:{Days:re.Days?re.Days:2}},(re.type==="ColdArchive"||re.type==="DeepColdArchive")&&(ne.RestoreRequest.JobParameters={Tier:re.JobParameters?re.JobParameters:"Standard"}),ie.content=X(ne,{headers:!0}),ie.mime="xml",ie.successStatuses=[202],ue.next=12,this.request(ie);case 12:return he=ue.sent,ue.abrupt("return",{res:he.res});case 14:case"end":return ue.stop()}},ee,this)}));function Q(ee){return Z.apply(this,arguments)}return Q}(),W._objectUrl=function(Q){return this._getReqUrl({bucket:this.options.bucket,object:Q})},W._objectRequestParams=function(Q,ee,te){if(!this.options.bucket&&!this.options.cname)throw new Error("Please create a bucket first");te=te||{},ee=this._objectName(ee);var re={object:ee,bucket:this.options.bucket,method:Q,subres:te&&te.subres,additionalHeaders:te&&te.additionalHeaders,timeout:te&&te.timeout,ctx:te&&te.ctx};return te.headers&&(re.headers={},E(te.headers).to(re.headers)),re},W._objectName=function(Q){return Q.replace(/^\/+/,"")},W._convertMetaToHeaders=function(Q,ee){Q&&Object.keys(Q).forEach(function(te){ee["x-oss-meta-".concat(te)]=Q[te]})},W._deleteFileSafe=function(Q){var ee=this;return new Promise(function(te){P.exists(Q,function(re){re?P.unlink(Q,function(ie){ie&&ee.debug("unlink %j error: %s",Q,ie,"error"),te()}):te()})})}},{"../common/callback":24,"../common/image":27,"../common/object/asyncSignatureUrl":31,"../common/object/copyObject":32,"../common/object/delete":33,"../common/object/deleteMulti":34,"../common/object/deleteObjectTagging":35,"../common/object/generateObjectUrl":36,"../common/object/get":37,"../common/object/getACL":38,"../common/object/getBucketVersions":39,"../common/object/getObjectMeta":40,"../common/object/getObjectTagging":41,"../common/object/getObjectUrl":42,"../common/object/getSymlink":43,"../common/object/head":44,"../common/object/putACL":45,"../common/object/putObjectTagging":46,"../common/object/putSymlink":47,"../common/object/signPostObjectPolicyV4":48,"../common/object/signatureUrl":49,"../common/object/signatureUrlV4":50,"../common/utils/isBlob":68,"../common/utils/isBuffer":69,"../common/utils/isFile":71,"../common/utils/obj2xml":76,"../common/utils/parseRestoreInfo":78,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"copy-to":107,"core-js/modules/es.array.map.js":318,"core-js/modules/es.function.name.js":322,"core-js/modules/es.number.constructor.js":324,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.replace.js":345,"core-js/modules/web.dom-collections.for-each.js":380,fs:102,"merge-descriptors":428,mime:430,path:439}],6:[function(_,w,B){B.version="6.23.0"},{}],7:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.abortBucketWorm=void 0;var P=_("../utils/checkBucketName");function E(I,M){return D.apply(this,arguments)}function D(){return D=(0,R.default)(O.default.mark(function I(M,N){var k,F;return O.default.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return P.checkBucketName(M),k=this._bucketRequestParams("DELETE",M,"worm",N),V.next=4,this.request(k);case 4:return F=V.sent,V.abrupt("return",{res:F.res,status:F.status});case 6:case"end":return V.stop()}},I,this)})),D.apply(this,arguments)}B.abortBucketWorm=E},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],8:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.completeBucketWorm=void 0;var P=_("../utils/checkBucketName");function E(I,M,N){return D.apply(this,arguments)}function D(){return D=(0,R.default)(O.default.mark(function I(M,N,k){var F,G;return O.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return P.checkBucketName(M),F=this._bucketRequestParams("POST",M,{wormId:N},k),j.next=4,this.request(F);case 4:return G=j.sent,j.abrupt("return",{res:G.res,status:G.status});case 6:case"end":return j.stop()}},I,this)})),D.apply(this,arguments)}B.completeBucketWorm=E},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],9:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.deleteBucketInventory=void 0;var P=_("../utils/checkBucketName");function E(I,M){return D.apply(this,arguments)}function D(){return D=(0,R.default)(O.default.mark(function I(M,N){var k,F,G,V,j=arguments;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return k=j.length>2&&j[2]!==void 0?j[2]:{},F=Object.assign({inventory:"",inventoryId:N},k.subres),P.checkBucketName(M),G=this._bucketRequestParams("DELETE",M,F,k),G.successStatuses=[204],U.next=7,this.request(G);case 7:return V=U.sent,U.abrupt("return",{status:V.status,res:V.res});case 9:case"end":return U.stop()}},I,this)})),D.apply(this,arguments)}B.deleteBucketInventory=E},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],10:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=B;D.deleteBucketLifecycle=function(){var I=(0,R.default)(O.default.mark(function N(k,F){var G,V;return O.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return E(k),G=this._bucketRequestParams("DELETE",k,"lifecycle",F),G.successStatuses=[204],H.next=5,this.request(G);case 5:return V=H.sent,H.abrupt("return",{res:V.res});case 7:case"end":return H.stop()}},N,this)}));function M(N,k){return I.apply(this,arguments)}return M}()},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],11:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=B;D.deleteBucketWebsite=function(){var I=(0,R.default)(O.default.mark(function N(k,F){var G,V;return O.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return E(k),G=this._bucketRequestParams("DELETE",k,"website",F),G.successStatuses=[204],H.next=5,this.request(G);case 5:return V=H.sent,H.abrupt("return",{res:V.res});case 7:case"end":return H.stop()}},N,this)}));function M(N,k){return I.apply(this,arguments)}return M}()},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],12:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.extendBucketWorm=void 0;var P=_("../utils/checkBucketName"),E=_("../utils/obj2xml");function D(M,N,k,F){return I.apply(this,arguments)}function I(){return I=(0,R.default)(O.default.mark(function M(N,k,F,G){var V,j,H;return O.default.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return P.checkBucketName(N),V=this._bucketRequestParams("POST",N,{wormExtend:"",wormId:k},G),j={ExtendWormConfiguration:{RetentionPeriodInDays:F}},V.mime="xml",V.content=E.obj2xml(j,{headers:!0}),V.successStatuses=[200],X.next=8,this.request(V);case 8:return H=X.sent,X.abrupt("return",{res:H.res,status:H.status});case 10:case"end":return X.stop()}},M,this)})),I.apply(this,arguments)}B.extendBucketWorm=D},{"../utils/checkBucketName":53,"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],13:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.getBucketInventory=void 0;var P=_("../utils/checkBucketName"),E=_("../utils/formatInventoryConfig");function D(M,N){return I.apply(this,arguments)}function I(){return I=(0,R.default)(O.default.mark(function M(N,k){var F,G,V,j,H=arguments;return O.default.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return F=H.length>2&&H[2]!==void 0?H[2]:{},G=Object.assign({inventory:"",inventoryId:k},F.subres),P.checkBucketName(N),V=this._bucketRequestParams("GET",N,G,F),V.successStatuses=[200],V.xmlResponse=!0,X.next=8,this.request(V);case 8:return j=X.sent,X.abrupt("return",{status:j.status,res:j.res,inventory:E.formatInventoryConfig(j.data)});case 10:case"end":return X.stop()}},M,this)})),I.apply(this,arguments)}B.getBucketInventory=D},{"../utils/checkBucketName":53,"../utils/formatInventoryConfig":63,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],14:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.array.map.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=_("../utils/isArray"),I=D.isArray,M=_("../utils/formatObjKey"),N=M.formatObjKey,k=B;k.getBucketLifecycle=function(){var F=(0,R.default)(O.default.mark(function V(j,H){var U,X,Y;return O.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return E(j),U=this._bucketRequestParams("GET",j,"lifecycle",H),U.successStatuses=[200],U.xmlResponse=!0,W.next=6,this.request(U);case 6:return X=W.sent,Y=X.data.Rule||null,Y&&(I(Y)||(Y=[Y]),Y=Y.map(function(Z){return Z.ID&&(Z.id=Z.ID,delete Z.ID),Z.Tag&&!I(Z.Tag)&&(Z.Tag=[Z.Tag]),N(Z,"firstLowerCase")})),W.abrupt("return",{rules:Y,res:X.res});case 10:case"end":return W.stop()}},V,this)}));function G(V,j){return F.apply(this,arguments)}return G}()},{"../utils/checkBucketName":53,"../utils/formatObjKey":64,"../utils/isArray":67,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.map.js":318}],15:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=B;D.getBucketVersioning=function(){var I=(0,R.default)(O.default.mark(function N(k,F){var G,V,j;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return E(k),G=this._bucketRequestParams("GET",k,"versioning",F),G.xmlResponse=!0,G.successStatuses=[200],U.next=6,this.request(G);case 6:return V=U.sent,j=V.data.Status,U.abrupt("return",{status:V.status,versionStatus:j,res:V.res});case 9:case"end":return U.stop()}},N,this)}));function M(N,k){return I.apply(this,arguments)}return M}()},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],16:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=_("../utils/isObject"),I=D.isObject,M=B;M.getBucketWebsite=function(){var N=(0,R.default)(O.default.mark(function F(G,V){var j,H,U;return O.default.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return E(G),j=this._bucketRequestParams("GET",G,"website",V),j.successStatuses=[200],j.xmlResponse=!0,Y.next=6,this.request(j);case 6:return H=Y.sent,U=[],H.data.RoutingRules&&H.data.RoutingRules.RoutingRule&&(I(H.data.RoutingRules.RoutingRule)?U=[H.data.RoutingRules.RoutingRule]:U=H.data.RoutingRules.RoutingRule),Y.abrupt("return",{index:H.data.IndexDocument&&H.data.IndexDocument.Suffix||"",supportSubDir:H.data.IndexDocument&&H.data.IndexDocument.SupportSubDir||"false",type:H.data.IndexDocument&&H.data.IndexDocument.Type,routingRules:U,error:H.data.ErrorDocument&&H.data.ErrorDocument.Key||null,res:H.res});case 10:case"end":return Y.stop()}},F,this)}));function k(F,G){return N.apply(this,arguments)}return k}()},{"../utils/checkBucketName":53,"../utils/isObject":74,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],17:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.getBucketWorm=void 0;var P=_("../utils/checkBucketName"),E=_("../utils/dataFix");function D(M,N){return I.apply(this,arguments)}function I(){return I=(0,R.default)(O.default.mark(function M(N,k){var F,G;return O.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return P.checkBucketName(N),F=this._bucketRequestParams("GET",N,"worm",k),F.successStatuses=[200],F.xmlResponse=!0,j.next=6,this.request(F);case 6:return G=j.sent,E.dataFix(G.data,{lowerFirst:!0,rename:{RetentionPeriodInDays:"days"}}),j.abrupt("return",Object.assign(Object.assign({},G.data),{res:G.res,status:G.status}));case 9:case"end":return j.stop()}},M,this)})),I.apply(this,arguments)}B.getBucketWorm=D},{"../utils/checkBucketName":53,"../utils/dataFix":59,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],18:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.initiateBucketWorm=void 0;var P=_("../utils/obj2xml"),E=_("../utils/checkBucketName");function D(M,N,k){return I.apply(this,arguments)}function I(){return I=(0,R.default)(O.default.mark(function M(N,k,F){var G,V,j;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return E.checkBucketName(N),G=this._bucketRequestParams("POST",N,"worm",F),V={InitiateWormConfiguration:{RetentionPeriodInDays:k}},G.mime="xml",G.content=P.obj2xml(V,{headers:!0}),G.successStatuses=[200],U.next=8,this.request(G);case 8:return j=U.sent,U.abrupt("return",{res:j.res,wormId:j.res.headers["x-oss-worm-id"],status:j.status});case 10:case"end":return U.stop()}},M,this)})),I.apply(this,arguments)}B.initiateBucketWorm=D},{"../utils/checkBucketName":53,"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],19:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.listBucketInventory=void 0;var P=_("../utils/checkBucketName"),E=_("../utils/formatInventoryConfig");function D(M){return I.apply(this,arguments)}function I(){return I=(0,R.default)(O.default.mark(function M(N){var k,F,G,V,j,H,U,X,Y=arguments;return O.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return k=Y.length>1&&Y[1]!==void 0?Y[1]:{},F=k.continuationToken,G=Object.assign({inventory:""},F&&{"continuation-token":F},k.subres),P.checkBucketName(N),V=this._bucketRequestParams("GET",N,G,k),V.successStatuses=[200],V.xmlResponse=!0,W.next=9,this.request(V);case 9:return j=W.sent,H=j.data,U=j.res,X=j.status,W.abrupt("return",{isTruncated:H.IsTruncated==="true",nextContinuationToken:H.NextContinuationToken,inventoryList:E.formatInventoryConfig(H.InventoryConfiguration,!0),status:X,res:U});case 12:case"end":return W.stop()}},M,this)})),I.apply(this,arguments)}B.listBucketInventory=D},{"../utils/checkBucketName":53,"../utils/formatInventoryConfig":63,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],20:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.array.concat.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.putBucketInventory=void 0;var P=_("../utils/checkBucketName"),E=_("../utils/obj2xml");function D(M,N){return I.apply(this,arguments)}function I(){return I=(0,R.default)(O.default.mark(function M(N,k){var F,G,V,j,H,U,X,Y,z,W,Z,Q=arguments;return O.default.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return F=Q.length>2&&Q[2]!==void 0?Q[2]:{},G=Object.assign({inventory:"",inventoryId:k.id},F.subres),P.checkBucketName(N),V=k.OSSBucketDestination,j=k.optionalFields,H=k.includedObjectVersions,U="acs:oss:::",X="acs:ram::".concat(V.accountId,":role/"),Y={InventoryConfiguration:{Id:k.id,IsEnabled:k.isEnabled,Filter:{Prefix:k.prefix||""},Destination:{OSSBucketDestination:{Format:V.format,AccountId:V.accountId,RoleArn:"".concat(X).concat(V.rolename),Bucket:"".concat(U).concat(V.bucket),Prefix:V.prefix||"",Encryption:V.encryption||""}},Schedule:{Frequency:k.frequency},IncludedObjectVersions:H,OptionalFields:{Field:(j==null?void 0:j.field)||[]}}},z=E.obj2xml(Y,{headers:!0,firstUpperCase:!0}),W=this._bucketRequestParams("PUT",N,G,F),W.successStatuses=[200],W.mime="xml",W.content=z,te.next=14,this.request(W);case 14:return Z=te.sent,te.abrupt("return",{status:Z.status,res:Z.res});case 16:case"end":return te.stop()}},M,this)})),I.apply(this,arguments)}B.putBucketInventory=D},{"../utils/checkBucketName":53,"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.object.assign.js":325}],21:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.array.includes.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=_("../utils/isArray"),I=D.isArray,M=_("../utils/deepCopy"),N=M.deepCopy,k=_("../utils/isObject"),F=k.isObject,G=_("../utils/obj2xml"),V=G.obj2xml,j=_("../utils/checkObjectTag"),H=j.checkObjectTag,U=_("../utils/getStrBytesCount"),X=U.getStrBytesCount,Y=B;Y.putBucketLifecycle=function(){var re=(0,R.default)(O.default.mark(function ne(he,pe,K){var ue,le,ce,_e,oe;return O.default.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(E(he),I(pe)){me.next=3;break}throw new Error("rules must be Array");case 3:return ue=this._bucketRequestParams("PUT",he,"lifecycle",K),le=[],ce={LifecycleConfiguration:{Rule:le}},pe.forEach(function(ye){z(ye),te(ye),ye.id&&(ye.ID=ye.id,delete ye.id),le.push(ye)}),_e=V(ce,{headers:!0,firstUpperCase:!0}),ue.content=_e,ue.mime="xml",ue.successStatuses=[200],me.next=13,this.request(ue);case 13:return oe=me.sent,me.abrupt("return",{res:oe.res});case 15:case"end":return me.stop()}},ne,this)}));function ie(ne,he,pe){return re.apply(this,arguments)}return ie}();function z(re){re.days&&(re.expiration={days:re.days}),re.date&&(re.expiration={createdBeforeDate:re.date})}function W(re,ie){var ne=re.days,he=re.createdBeforeDate;if(!ne&&!he)throw new Error("".concat(ie," must includes days or createdBeforeDate"));if(ne&&(I(ne)||!/^[1-9][0-9]*$/.test(ne)))throw new Error("days must be a positive integer");if(he&&!/\d{4}-\d{2}-\d{2}T00:00:00.000Z/.test(he))throw new Error("createdBeforeDate must be date and conform to iso8601 format")}function Z(re,ie){var ne=re.noncurrentDays;if(ne){if(ne&&(I(ne)||!/^[1-9][0-9]*$/.test(ne)))throw new Error("noncurrentDays must be a positive integer")}else throw new Error("".concat(ie," must includes noncurrentDays"))}function Q(re){if(!I(re)&&!F(re))throw new Error("tag must be Object or Array");re=F(re)?[re]:re;var ie={},ne=N(re);ne.forEach(function(he){ie[he.key]=he.value}),H(ie)}function ee(re){if(!["IA","Archive","ColdArchive","DeepColdArchive"].includes(re))throw new Error("StorageClass must be IA or Archive or ColdArchive or DeepColdArchive")}function te(re){if(re.id&&X(re.id)>255)throw new Error("ID is composed of 255 bytes at most");if(re.prefix===void 0)throw new Error("Rule must includes prefix");if(!["Enabled","Disabled"].includes(re.status))throw new Error("Status must be Enabled or Disabled");if(!re.expiration&&!re.noncurrentVersionExpiration&&!re.abortMultipartUpload&&!re.transition&&!re.noncurrentVersionTransition)throw new Error("Rule must includes expiration or noncurrentVersionExpiration or abortMultipartUpload or transition or noncurrentVersionTransition");if(re.transition&&(ee(re.transition.storageClass),W(re.transition,"Transition")),re.expiration){if(!re.expiration.expiredObjectDeleteMarker)W(re.expiration,"Expiration");else if(re.expiration.days||re.expiration.createdBeforeDate)throw new Error("expiredObjectDeleteMarker cannot be used with days or createdBeforeDate")}if(re.abortMultipartUpload&&W(re.abortMultipartUpload,"AbortMultipartUpload"),re.noncurrentVersionTransition&&(ee(re.noncurrentVersionTransition.storageClass),Z(re.noncurrentVersionTransition,"NoncurrentVersionTransition")),re.noncurrentVersionExpiration&&Z(re.noncurrentVersionExpiration,"NoncurrentVersionExpiration"),re.tag){if(re.abortMultipartUpload)throw new Error("Tag cannot be used with abortMultipartUpload");Q(re.tag)}}},{"../utils/checkBucketName":53,"../utils/checkObjectTag":56,"../utils/deepCopy":60,"../utils/getStrBytesCount":66,"../utils/isArray":67,"../utils/isObject":74,"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.includes.js":315,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/web.dom-collections.for-each.js":380}],22:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.array.includes.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=_("../utils/obj2xml"),I=D.obj2xml,M=B;M.putBucketVersioning=function(){var N=(0,R.default)(O.default.mark(function F(G,V){var j,H,U,X,Y=arguments;return O.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(j=Y.length>2&&Y[2]!==void 0?Y[2]:{},E(G),["Enabled","Suspended"].includes(V)){W.next=4;break}throw new Error("status must be Enabled or Suspended");case 4:return H=this._bucketRequestParams("PUT",G,"versioning",j),U={VersioningConfiguration:{Status:V}},H.mime="xml",H.content=I(U,{headers:!0}),W.next=10,this.request(H);case 10:return X=W.sent,W.abrupt("return",{res:X.res,status:X.status});case 12:case"end":return W.stop()}},F,this)}));function k(F,G){return N.apply(this,arguments)}return k}()},{"../utils/checkBucketName":53,"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.includes.js":315}],23:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator")),R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=_("../utils/obj2xml"),I=D.obj2xml,M=_("../utils/isArray"),N=M.isArray,k=B;k.putBucketWebsite=function(){var F=(0,R.default)(O.default.mark(function V(j){var H,U,X,Y,z,W,Z,Q=arguments;return O.default.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(H=Q.length>1&&Q[1]!==void 0?Q[1]:{},U=Q.length>2?Q[2]:void 0,E(j),X=this._bucketRequestParams("PUT",j,"website",U),Y={Suffix:H.index||"index.html"},z={IndexDocument:Y},W={WebsiteConfiguration:z},H.supportSubDir&&(Y.SupportSubDir=H.supportSubDir),H.type&&(Y.Type=H.type),H.error&&(z.ErrorDocument={Key:H.error}),H.routingRules===void 0){te.next=14;break}if(N(H.routingRules)){te.next=13;break}throw new Error("RoutingRules must be Array");case 13:z.RoutingRules={RoutingRule:H.routingRules};case 14:return W=I(W),X.content=W,X.mime="xml",X.successStatuses=[200],te.next=20,this.request(X);case 20:return Z=te.sent,te.abrupt("return",{res:Z.res});case 22:case"end":return te.stop()}},V,this)}));function G(V){return F.apply(this,arguments)}return G}()},{"../utils/checkBucketName":53,"../utils/isArray":67,"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93}],24:[function(_,w,B){(function(A){(function(){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),B.encodeCallback=function(R,P){if(R.headers=R.headers||{},!Object.prototype.hasOwnProperty.call(R.headers,"x-oss-callback")&&P.callback){var E={callbackUrl:encodeURI(P.callback.url),callbackBody:P.callback.body};P.callback.host&&(E.callbackHost=P.callback.host),P.callback.contentType&&(E.callbackBodyType=P.callback.contentType),P.callback.callbackSNI&&(E.callbackSNI=P.callback.callbackSNI);var D=A.from(JSON.stringify(E)).toString("base64");if(R.headers["x-oss-callback"]=D,P.callback.customValue){var I={};Object.keys(P.callback.customValue).forEach(function(M){I["x:".concat(M)]=P.callback.customValue[M].toString()}),R.headers["x-oss-callback-var"]=A.from(JSON.stringify(I)).toString("base64")}}}}).call(this)}).call(this,_("buffer").Buffer)},{buffer:103,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/web.dom-collections.for-each.js":380}],25:[function(_,w,B){_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js");var A=function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(B,"__esModule",{value:!0}),B.getReqUrl=void 0;var O=A(_("copy-to")),R=A(_("url")),P=A(_("merge-descriptors")),E=A(_("is-type-of")),D=_("../utils/isIP"),I=_("../utils/checkConfigValid");function M(N){var k={},F=this.options.cname;I.checkConfigValid(this.options.endpoint,"endpoint"),O.default(this.options.endpoint,!1).to(k),N.bucket&&!F&&!D.isIP(k.hostname)&&!this.options.sldEnable&&(k.host="".concat(N.bucket,".").concat(k.host));var G="/";N.bucket&&this.options.sldEnable&&(G+="".concat(N.bucket,"/")),N.object&&(G+=this._escape(N.object).replace(/\+/g,"%2B")),k.pathname=G;var V={};if(N.query&&P.default(V,N.query),N.subres){var j={};E.default.string(N.subres)?j[N.subres]="":E.default.array(N.subres)?N.subres.forEach(function(H){j[H]=""}):j=N.subres,P.default(V,j)}return k.query=V,R.default.format(k)}B.getReqUrl=M},{"../utils/checkConfigValid":54,"../utils/isIP":73,"copy-to":107,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.replace.js":345,"core-js/modules/web.dom-collections.for-each.js":380,"is-type-of":537,"merge-descriptors":428,url:543}],26:[function(_,w,B){_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.string.trim.js");var A=_("humanize-ms"),O=_("url"),R=_("../utils/checkBucketName"),P=R.checkBucketName,E=_("../utils/setRegion"),D=E.setRegion,I=_("../utils/checkConfigValid"),M=I.checkConfigValid;function N(k,F){M(k,"endpoint");var G=O.parse(k);if(G.protocol||(G=O.parse("http".concat(F?"s":"","://").concat(k))),G.protocol!=="http:"&&G.protocol!=="https:")throw new Error("Endpoint protocol must be http or https.");return G}w.exports=function(k){if(!k||!k.accessKeyId||!k.accessKeySecret)throw new Error("require accessKeyId, accessKeySecret");k.stsToken&&!k.refreshSTSToken&&!k.refreshSTSTokenInterval&&console.warn("It's recommended to set 'refreshSTSToken' and 'refreshSTSTokenInterval' to refresh stsToken、accessKeyId、accessKeySecret automatically when sts token has expired"),k.bucket&&P(k.bucket);var F=Object.assign({region:"oss-cn-hangzhou",internal:!1,secure:!1,timeout:6e4,bucket:null,endpoint:null,cname:!1,isRequestPay:!1,sldEnable:!1,headerEncoding:"utf-8",refreshSTSToken:null,refreshSTSTokenInterval:6e4*5,retryMax:0,authorizationV4:!1},k);if(F.accessKeyId=F.accessKeyId.trim(),F.accessKeySecret=F.accessKeySecret.trim(),F.timeout&&(F.timeout=A(F.timeout)),F.endpoint)F.endpoint=N(F.endpoint,F.secure);else if(F.region)F.endpoint=D(F.region,F.internal,F.secure);else throw new Error("require options.endpoint or options.region");return F.inited=!0,F}},{"../utils/checkBucketName":53,"../utils/checkConfigValid":54,"../utils/setRegion":81,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.string.trim.js":349,"humanize-ms":399,url:543}],27:[function(_,w,B){var A=_("merge-descriptors"),O=B;A(O,_("./processObjectSave"))},{"./processObjectSave":28,"merge-descriptors":428}],28:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.array.concat.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkBucketName"),E=P.checkBucketName,D=_("querystring"),I=_("js-base64"),M=I.Base64.encode,N=B;N.processObjectSave=function(){var F=(0,R.default)(O.default.mark(function V(j,H,U,X){var Y,z,W,Z;return O.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return k(j,"sourceObject"),k(H,"targetObject"),k(U,"process"),H=this._objectName(H),X&&E(X),Y=this._objectRequestParams("POST",j,{subres:"x-oss-process"}),z=X?",b_".concat(M(X)):"",H=M(H),W={"x-oss-process":"".concat(U,"|sys/saveas,o_").concat(H).concat(z)},Y.content=D.stringify(W),ee.next=12,this.request(Y);case 12:return Z=ee.sent,ee.abrupt("return",{res:Z.res,status:Z.res.status});case 14:case"end":return ee.stop()}},V,this)}));function G(V,j,H,U){return F.apply(this,arguments)}return G}();function k(F,G){if(!F)throw new Error("".concat(G," is required"));if(typeof F!="string")throw new Error("".concat(G," must be String"))}},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.concat.js":310,"js-base64":413,querystring:451}],29:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.function.name.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.promise.js"),_("core-js/modules/es.array.from.js"),_("core-js/modules/es.string.iterator.js"),_("core-js/modules/es.array.map.js"),_("core-js/modules/es.array.filter.js"),_("core-js/modules/es.array.find.js"),_("core-js/modules/es.regexp.to-string.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("debug")("ali-oss:multipart-copy"),E=_("copy-to"),D=B;D.uploadPartCopy=function(){var I=(0,R.default)(O.default.mark(function N(k,F,G,V,j){var H,U,X,Y,z,W=arguments;return O.default.wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return H=W.length>5&&W[5]!==void 0?W[5]:{},H.headers=H.headers||{},U=H.versionId||H.subres&&H.subres.versionId||null,U?X="/".concat(j.sourceBucketName,"/").concat(encodeURIComponent(j.sourceKey),"?versionId=").concat(U):X="/".concat(j.sourceBucketName,"/").concat(encodeURIComponent(j.sourceKey)),H.headers["x-oss-copy-source"]=X,V&&(H.headers["x-oss-copy-source-range"]="bytes=".concat(V)),H.subres={partNumber:G,uploadId:F},Y=this._objectRequestParams("PUT",k,H),Y.mime=H.mime,Y.successStatuses=[200],Q.next=12,this.request(Y);case 12:return z=Q.sent,Q.abrupt("return",{name:k,etag:z.res.headers.etag,res:z.res});case 14:case"end":return Q.stop()}},N,this)}));function M(N,k,F,G,V){return I.apply(this,arguments)}return M}(),D.multipartUploadCopy=function(){var I=(0,R.default)(O.default.mark(function N(k,F){var G,V,j,H,U,X,Y,z,W,Z,Q,ee,te=arguments;return O.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return G=te.length>2&&te[2]!==void 0?te[2]:{},this.resetCancelFlag(),V=G.versionId,j=V===void 0?null:V,H={versionId:j},ie.next=6,this._getObjectMeta(F.sourceBucketName,F.sourceKey,H);case 6:if(U=ie.sent,X=U.res.headers["content-length"],F.startOffset=F.startOffset||0,F.endOffset=F.endOffset||X,!(G.checkpoint&&G.checkpoint.uploadId)){ie.next=14;break}return ie.next=13,this._resumeMultipartCopy(G.checkpoint,F,G);case 13:return ie.abrupt("return",ie.sent);case 14:if(Y=102400,z=F.endOffset-F.startOffset,!(z<Y)){ie.next=18;break}throw new Error("copySize must not be smaller than ".concat(Y));case 18:if(!(G.partSize&&G.partSize<Y)){ie.next=20;break}throw new Error("partSize must not be smaller than ".concat(Y));case 20:return ie.next=22,this.initMultipartUpload(k,G);case 22:if(W=ie.sent,Z=W.uploadId,Q=this._getPartSize(z,G.partSize),ee={name:k,copySize:z,partSize:Q,uploadId:Z,doneParts:[]},!(G&&G.progress)){ie.next=29;break}return ie.next=29,G.progress(0,ee,W.res);case 29:return ie.next=31,this._resumeMultipartCopy(ee,F,G);case 31:return ie.abrupt("return",ie.sent);case 32:case"end":return ie.stop()}},N,this)}));function M(N,k){return I.apply(this,arguments)}return M}(),D._resumeMultipartCopy=function(){var I=(0,R.default)(O.default.mark(function N(k,F,G){var V,j,H,U,X,Y,z,W,Z,Q,ee,te,re,ie,ne,he,pe,K,ue,le,ce;return O.default.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(!this.isCancel()){oe.next=2;break}throw this._makeCancelEvent();case 2:if(V=G.versionId,j=V===void 0?null:V,H={versionId:j},U=k.copySize,X=k.partSize,Y=k.uploadId,z=k.doneParts,W=k.name,Z=this._divideMultipartCopyParts(U,X,F.startOffset),Q=Z.length,ee={headers:{}},G.copyheaders&&E(G.copyheaders).to(ee.headers),j&&E(H).to(ee),te=function(me,ye,ge){return new Promise(function(){var we=(0,R.default)(O.default.mark(function Te(Ee,De){var fe,Ce,Se;return O.default.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(Re.prev=0,me.isCancel()){Re.next=22;break}return fe=Z[ye-1],Ce="".concat(fe.start,"-").concat(fe.end-1),Re.prev=4,Re.next=7,me.uploadPartCopy(W,Y,ye,Ce,ge,ee);case 7:Se=Re.sent,Re.next=15;break;case 10:if(Re.prev=10,Re.t0=Re.catch(4),Re.t0.status!==404){Re.next=14;break}throw me._makeAbortEvent();case 14:throw Re.t0;case 15:if(me.isCancel()){Re.next=22;break}if(P("content-range ".concat(Se.res.headers["content-range"])),z.push({number:ye,etag:Se.res.headers.etag}),k.doneParts=z,!(G&&G.progress)){Re.next=22;break}return Re.next=22,G.progress(z.length/Q,k,Se.res);case 22:Ee(),Re.next=29;break;case 25:Re.prev=25,Re.t1=Re.catch(0),Re.t1.partNum=ye,De(Re.t1);case 29:case"end":return Re.stop()}},Te,null,[[0,25],[4,10]])}));return function(Te,Ee){return we.apply(this,arguments)}}())},re=Array.from(new Array(Q),function(de,me){return me+1}),ie=z.map(function(de){return de.number}),ne=re.filter(function(de){return ie.indexOf(de)<0}),he=5,pe=G.parallel||he,!(this.checkBrowserAndVersion("Internet Explorer","10")||pe===1)){oe.next=28;break}K=0;case 18:if(!(K<ne.length)){oe.next=26;break}if(!this.isCancel()){oe.next=21;break}throw this._makeCancelEvent();case 21:return oe.next=23,te(this,ne[K],F);case 23:K++,oe.next=18;break;case 26:oe.next=40;break;case 28:return oe.next=30,this._parallelNode(ne,pe,te,F);case 30:if(ue=oe.sent,le=ue.find(function(de){return de.name==="abort"}),!le){oe.next=34;break}throw le;case 34:if(!this.isCancel()){oe.next=36;break}throw this._makeCancelEvent();case 36:if(!(ue&&ue.length>0)){oe.next=40;break}throw ce=ue[0],ce.message="Failed to copy some parts with error: ".concat(ce.toString()," part_num: ").concat(ce.partNum),ce;case 40:return oe.next=42,this.completeMultipartUpload(W,Y,z,G);case 42:return oe.abrupt("return",oe.sent);case 43:case"end":return oe.stop()}},N,this)}));function M(N,k,F){return I.apply(this,arguments)}return M}(),D._divideMultipartCopyParts=function(M,N,k){for(var F=Math.ceil(M/N),G=[],V=0;V<F;V++){var j=N*V+k,H=Math.min(j+N,M+k);G.push({start:j,end:H})}return G},D._getObjectMeta=function(){var I=(0,R.default)(O.default.mark(function N(k,F,G){var V,j;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return V=this.getBucket(),this.setBucket(k),U.next=4,this.head(F,G);case 4:return j=U.sent,this.setBucket(V),U.abrupt("return",j);case 7:case"end":return U.stop()}},N,this)}));function M(N,k,F){return I.apply(this,arguments)}return M}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"copy-to":107,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.filter.js":312,"core-js/modules/es.array.find.js":313,"core-js/modules/es.array.from.js":314,"core-js/modules/es.array.map.js":318,"core-js/modules/es.function.name.js":322,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.iterator.js":343,debug:536}],30:[function(_,w,B){(function(A){(function(){var O=_("@babel/runtime/helpers/interopRequireDefault"),R=O(_("@babel/runtime/regenerator"));_("core-js/modules/es.array.map.js"),_("core-js/modules/es.array.filter.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.array.sort.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.regexp.to-string.js");var P=O(_("@babel/runtime/helpers/asyncToGenerator")),E=_("copy-to"),D=_("./callback"),I=_("./utils/deepCopy"),M=I.deepCopyWith,N=_("./utils/isBuffer"),k=N.isBuffer,F=_("./utils/omit"),G=F.omit,V=B;V.listUploads=function(){var j=(0,P.default)(R.default.mark(function U(X,Y){var z,W,Z,Q;return R.default.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return Y=Y||{},z={},E(Y).to(z),z.subres="uploads",W=this._objectRequestParams("GET","",z),W.query=X,W.xmlResponse=!0,W.successStatuses=[200],te.next=10,this.request(W);case 10:return Z=te.sent,Q=Z.data.Upload||[],Array.isArray(Q)||(Q=[Q]),Q=Q.map(function(re){return{name:re.Key,uploadId:re.UploadId,initiated:re.Initiated}}),te.abrupt("return",{res:Z.res,uploads:Q,bucket:Z.data.Bucket,nextKeyMarker:Z.data.NextKeyMarker,nextUploadIdMarker:Z.data.NextUploadIdMarker,isTruncated:Z.data.IsTruncated==="true"});case 15:case"end":return te.stop()}},U,this)}));function H(U,X){return j.apply(this,arguments)}return H}(),V.listParts=function(){var j=(0,P.default)(R.default.mark(function U(X,Y,z,W){var Z,Q,ee;return R.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return W=W||{},Z={},E(W).to(Z),Z.subres={uploadId:Y},Q=this._objectRequestParams("GET",X,Z),Q.query=z,Q.xmlResponse=!0,Q.successStatuses=[200],re.next=10,this.request(Q);case 10:return ee=re.sent,re.abrupt("return",{res:ee.res,uploadId:ee.data.UploadId,bucket:ee.data.Bucket,name:ee.data.Key,partNumberMarker:ee.data.PartNumberMarker,nextPartNumberMarker:ee.data.NextPartNumberMarker,maxParts:ee.data.MaxParts,isTruncated:ee.data.IsTruncated,parts:ee.data.Part||[]});case 12:case"end":return re.stop()}},U,this)}));function H(U,X,Y,z){return j.apply(this,arguments)}return H}(),V.abortMultipartUpload=function(){var j=(0,P.default)(R.default.mark(function U(X,Y,z){var W,Z,Q;return R.default.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return this._stop(),z=z||{},W={},E(z).to(W),W.subres={uploadId:Y},Z=this._objectRequestParams("DELETE",X,W),Z.successStatuses=[204],te.next=9,this.request(Z);case 9:return Q=te.sent,te.abrupt("return",{res:Q.res});case 11:case"end":return te.stop()}},U,this)}));function H(U,X,Y){return j.apply(this,arguments)}return H}(),V.initMultipartUpload=function(){var j=(0,P.default)(R.default.mark(function U(X,Y){var z,W,Z;return R.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return Y=Y||{},z={},E(Y).to(z),z.headers=z.headers||{},this._convertMetaToHeaders(Y.meta,z.headers),z.subres="uploads",W=this._objectRequestParams("POST",X,z),W.mime=Y.mime,W.xmlResponse=!0,W.successStatuses=[200],ee.next=12,this.request(W);case 12:return Z=ee.sent,ee.abrupt("return",{res:Z.res,bucket:Z.data.Bucket,name:Z.data.Key,uploadId:Z.data.UploadId});case 14:case"end":return ee.stop()}},U,this)}));function H(U,X){return j.apply(this,arguments)}return H}(),V.uploadPart=function(){var j=(0,P.default)(R.default.mark(function U(X,Y,z,W,Z,Q,ee){var te,re;return R.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(te={size:Q-Z},re=A&&A.browser,!re){ne.next=8;break}return ne.next=5,this._createBuffer(W,Z,Q);case 5:te.content=ne.sent,ne.next=11;break;case 8:return ne.next=10,this._createStream(W,Z,Q);case 10:te.stream=ne.sent;case 11:return ne.next=13,this._uploadPart(X,Y,z,te,ee);case 13:return ne.abrupt("return",ne.sent);case 14:case"end":return ne.stop()}},U,this)}));function H(U,X,Y,z,W,Z,Q){return j.apply(this,arguments)}return H}(),V.completeMultipartUpload=function(){var j=(0,P.default)(R.default.mark(function U(X,Y,z,W){var Z,Q,ee,te,re,ie,ne,he;return R.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:for(Z=z.concat().sort(function(ue,le){return ue.number-le.number}).filter(function(ue,le,ce){return!le||ue.number!==ce[le-1].number}),Q='<?xml version="1.0" encoding="UTF-8"?>\n<CompleteMultipartUpload>\n',ee=0;ee<Z.length;ee++)te=Z[ee],Q+="<Part>\n",Q+="<PartNumber>".concat(te.number,"</PartNumber>\n"),Q+="<ETag>".concat(te.etag,"</ETag>\n"),Q+="</Part>\n";return Q+="</CompleteMultipartUpload>",W=W||{},re={},re=M(W,function(ue){if(k(ue))return null}),re.subres={uploadId:Y},re.headers=G(re.headers,["x-oss-server-side-encryption","x-oss-storage-class"]),ie=this._objectRequestParams("POST",X,re),D.encodeCallback(ie,re),ie.mime="xml",ie.content=Q,ie.headers&&ie.headers["x-oss-callback"]||(ie.xmlResponse=!0),ie.successStatuses=[200],K.next=17,this.request(ie);case 17:if(ne=K.sent,!W.progress){K.next=21;break}return K.next=21,W.progress(1,null,ne.res);case 21:return he={res:ne.res,bucket:ie.bucket,name:X,etag:ne.res.headers.etag},ie.headers&&ie.headers["x-oss-callback"]&&(he.data=JSON.parse(ne.data.toString())),K.abrupt("return",he);case 24:case"end":return K.stop()}},U,this)}));function H(U,X,Y,z){return j.apply(this,arguments)}return H}(),V._uploadPart=function(){var j=(0,P.default)(R.default.mark(function U(X,Y,z,W,Z){var Q,ee,te,re;return R.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return Z=Z||{},Q={},E(Z).to(Q),Q.headers=Q.headers||{},Q.headers["Content-Length"]=W.size,Q.headers=G(Q.headers,["x-oss-server-side-encryption","x-oss-storage-class"]),Q.subres={partNumber:z,uploadId:Y},ee=this._objectRequestParams("PUT",X,Q),ee.mime=Q.mime,te=A&&A.browser,te?ee.content=W.content:ee.stream=W.stream,ee.successStatuses=[200],ee.disabledMD5=Z.disabledMD5,ne.next=15,this.request(ee);case 15:if(re=ne.sent,re.res.headers.etag){ne.next=18;break}throw new Error("Please set the etag of expose-headers in OSS \n https://help.aliyun.com/document_detail/32069.html");case 18:return W.stream&&(W.stream=null,ee.stream=null),ne.abrupt("return",{name:X,etag:re.res.headers.etag,res:re.res});case 20:case"end":return ne.stop()}},U,this)}));function H(U,X,Y,z,W){return j.apply(this,arguments)}return H}()}).call(this)}).call(this,_("_process"))},{"./callback":24,"./utils/deepCopy":60,"./utils/isBuffer":69,"./utils/omit":77,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,_process:538,"copy-to":107,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.filter.js":312,"core-js/modules/es.array.map.js":318,"core-js/modules/es.array.sort.js":320,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339}],31:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.regexp.exec.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("url"),E=_("utility"),D=_("copy-to"),I=_("../../common/signUtils"),M=_("../utils/isIP"),N=M.isIP,k=_("../utils/setSTSToken"),F=k.setSTSToken,G=_("../utils/isFunction"),V=G.isFunction,j=B;j.asyncSignatureUrl=function(){var H=(0,R.default)(O.default.mark(function X(Y,z){var W,Z,Q,ee,te,re,ie=arguments;return O.default.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:if(W=ie.length>2&&ie[2]!==void 0?ie[2]:!0,!N(this.options.endpoint.hostname)){he.next=3;break}throw new Error("can not get the object URL when endpoint is IP");case 3:if(!(W&&/^\?/.test(Y))){he.next=5;break}throw new Error("Invalid object name ".concat(Y));case 5:if(z=z||{},Y=this._objectName(Y),z.method=z.method||"GET",Z=E.timestamp()+(z.expires||1800),Q={bucket:this.options.bucket,object:Y},ee=this._getResource(Q),!(this.options.stsToken&&V(this.options.refreshSTSToken))){he.next=14;break}return he.next=14,F.call(this);case 14:return this.options.stsToken&&(z["security-token"]=this.options.stsToken),te=I._signatureForURL(this.options.accessKeySecret,z,ee,Z),re=P.parse(this._getReqUrl(Q)),re.query={OSSAccessKeyId:this.options.accessKeyId,Expires:Z,Signature:te.Signature},D(te.subResource).to(re.query),he.abrupt("return",re.format());case 20:case"end":return he.stop()}},X,this)}));function U(X,Y){return H.apply(this,arguments)}return U}()},{"../../common/signUtils":52,"../utils/isFunction":72,"../utils/isIP":73,"../utils/setSTSToken":82,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"copy-to":107,"core-js/modules/es.regexp.exec.js":338,url:543,utility:545}],32:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.array.find.js"),_("core-js/modules/es.array.includes.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js");var R=A(_("@babel/runtime/helpers/typeof")),P=A(_("@babel/runtime/helpers/asyncToGenerator")),E=_("../utils/checkBucketName"),D=E.checkBucketName,I=B,M=["content-type","content-encoding","content-language","content-disposition","cache-control","expires"];I.copy=function(){var N=(0,P.default)(O.default.mark(function F(G,V,j,H){var U,X,Y;return O.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return(0,R.default)(j)==="object"&&(H=j),H=H||{},H.headers=H.headers||{},Object.keys(H.headers).forEach(function(Z){H.headers["x-oss-copy-source-".concat(Z.toLowerCase())]=H.headers[Z]}),(H.meta||Object.keys(H.headers).find(function(Z){return M.includes(Z.toLowerCase())}))&&(H.headers["x-oss-metadata-directive"]="REPLACE"),this._convertMetaToHeaders(H.meta,H.headers),V=this._getSourceName(V,j),H.versionId&&(V="".concat(V,"?versionId=").concat(H.versionId)),H.headers["x-oss-copy-source"]=V,U=this._objectRequestParams("PUT",G,H),U.xmlResponse=!0,U.successStatuses=[200,304],W.next=14,this.request(U);case 14:return X=W.sent,Y=X.data,Y&&(Y={etag:Y.ETag,lastModified:Y.LastModified}),W.abrupt("return",{data:Y,res:X.res});case 18:case"end":return W.stop()}},F,this)}));function k(F,G,V,j){return N.apply(this,arguments)}return k}(),I._getSourceName=function(k,F){return typeof F=="string"?k=this._objectName(k):k[0]!=="/"?F=this.options.bucket:(F=k.replace(/\/(.+?)(\/.*)/,"$1"),k=k.replace(/(\/.+?\/)(.*)/,"$2")),D(F),k=encodeURIComponent(k),k="/".concat(F,"/").concat(k),k}},{"../utils/checkBucketName":53,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/typeof":91,"@babel/runtime/regenerator":93,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.find.js":313,"core-js/modules/es.array.includes.js":315,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.replace.js":345,"core-js/modules/web.dom-collections.for-each.js":380}],33:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B;P.delete=function(){var E=(0,R.default)(O.default.mark(function I(M){var N,k,F,G=arguments;return O.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return N=G.length>1&&G[1]!==void 0?G[1]:{},N.subres=Object.assign({},N.subres),N.versionId&&(N.subres.versionId=N.versionId),k=this._objectRequestParams("DELETE",M,N),k.successStatuses=[204],j.next=7,this.request(k);case 7:return F=j.sent,j.abrupt("return",{res:F.res});case 9:case"end":return j.stop()}},I,this)}));function D(I){return E.apply(this,arguments)}return D}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],34:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("utility"),E=_("../utils/obj2xml"),D=E.obj2xml,I=B;I.deleteMulti=function(){var M=(0,R.default)(O.default.mark(function k(F){var G,V,j,H,U,X,Y,z,W,Z,Q,ee,te,re=arguments;return O.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(G=re.length>1&&re[1]!==void 0?re[1]:{},V=[],!(!F||!F.length)){ne.next=4;break}throw new Error("names is required");case 4:for(j=0;j<F.length;j++)H={},typeof F[j]=="string"?H.Key=P.escape(this._objectName(F[j])):(U=F[j],X=U.key,Y=U.versionId,H.Key=P.escape(this._objectName(X)),H.VersionId=Y),V.push(H);return z={Delete:{Quiet:!!G.quiet,Object:V}},W=D(z,{headers:!0}),G.subres=Object.assign({delete:""},G.subres),G.versionId&&(G.subres.versionId=G.versionId),Z=this._objectRequestParams("POST","",G),Z.mime="xml",Z.content=W,Z.xmlResponse=!0,Z.successStatuses=[200],ne.next=16,this.request(Z);case 16:return Q=ne.sent,ee=Q.data,te=ee&&ee.Deleted||null,te&&(Array.isArray(te)||(te=[te])),ne.abrupt("return",{res:Q.res,deleted:te||[]});case 21:case"end":return ne.stop()}},k,this)}));function N(k){return M.apply(this,arguments)}return N}()},{"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325,utility:545}],35:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B;P.deleteObjectTagging=function(){var E=(0,R.default)(O.default.mark(function I(M){var N,k,F,G=arguments;return O.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return N=G.length>1&&G[1]!==void 0?G[1]:{},N.subres=Object.assign({tagging:""},N.subres),N.versionId&&(N.subres.versionId=N.versionId),M=this._objectName(M),k=this._objectRequestParams("DELETE",M,N),k.successStatuses=[204],j.next=8,this.request(k);case 8:return F=j.sent,j.abrupt("return",{status:F.status,res:F.res});case 10:case"end":return j.stop()}},I,this)}));function D(I){return E.apply(this,arguments)}return D}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],36:[function(_,w,B){_("core-js/modules/es.array.concat.js");var A=_("url"),O=_("../utils/isIP"),R=O.isIP,P=B;P.generateObjectUrl=function(D,I){if(R(this.options.endpoint.hostname))throw new Error("can not get the object URL when endpoint is IP");if(I)I[I.length-1]!=="/"&&(I+="/");else{I=this.options.endpoint.format();var M=A.parse(I),N=this.options.bucket;M.hostname="".concat(N,".").concat(M.hostname),M.host="".concat(N,".").concat(M.host),I=M.format()}return I+this._escape(this._objectName(D))}},{"../utils/isIP":73,"core-js/modules/es.array.concat.js":310,url:543}],37:[function(_,w,B){(function(A){(function(){var O=_("@babel/runtime/helpers/interopRequireDefault"),R=O(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var P=O(_("@babel/runtime/helpers/asyncToGenerator")),E=_("fs"),D=_("is-type-of"),I=_("../utils/isObject"),M=I.isObject,N=B;N.get=function(){var k=(0,P.default)(R.default.mark(function G(V,j){var H,U,X,Y,z,W,Z,Q,ee=arguments;return R.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return H=ee.length>2&&ee[2]!==void 0?ee[2]:{},U=null,X=!1,D.writableStream(j)?U=j:D.string(j)?(U=E.createWriteStream(j),X=!0):M(j)&&(H=j),H=H||{},Y=A&&A.browser,z=H.responseCacheControl===null?"":"no-cache",W=Y&&z?{"response-cache-control":z}:{},H.subres=Object.assign(W,H.subres),H.versionId&&(H.subres.versionId=H.versionId),H.process&&(H.subres["x-oss-process"]=H.process),re.prev=11,Q=this._objectRequestParams("GET",V,H),Q.writeStream=U,Q.successStatuses=[200,206,304],re.next=17,this.request(Q);case 17:Z=re.sent,X&&U.destroy(),re.next=28;break;case 21:if(re.prev=21,re.t0=re.catch(11),!X){re.next=27;break}return U.destroy(),re.next=27,this._deleteFileSafe(j);case 27:throw re.t0;case 28:return re.abrupt("return",{res:Z.res,content:Z.data});case 29:case"end":return re.stop()}},G,this,[[11,21]])}));function F(G,V){return k.apply(this,arguments)}return F}()}).call(this)}).call(this,_("_process"))},{"../utils/isObject":74,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,_process:538,"core-js/modules/es.object.assign.js":325,fs:102,"is-type-of":537}],38:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B;P.getACL=function(){var E=(0,R.default)(O.default.mark(function I(M){var N,k,F,G=arguments;return O.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return N=G.length>1&&G[1]!==void 0?G[1]:{},N.subres=Object.assign({acl:""},N.subres),N.versionId&&(N.subres.versionId=N.versionId),M=this._objectName(M),k=this._objectRequestParams("GET",M,N),k.successStatuses=[200],k.xmlResponse=!0,j.next=9,this.request(k);case 9:return F=j.sent,j.abrupt("return",{acl:F.data.AccessControlList.Grant,owner:{id:F.data.Owner.ID,displayName:F.data.Owner.DisplayName},res:F.res});case 11:case"end":return j.stop()}},I,this)}));function D(I){return E.apply(this,arguments)}return D}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],39:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.array.map.js"),_("core-js/modules/es.number.constructor.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B,E=_("../utils/isObject"),D=E.isObject,I=_("../utils/isArray"),M=I.isArray,N=_("../utils/parseRestoreInfo"),k=N.parseRestoreInfo;P.getBucketVersions=F,P.listObjectVersions=F;function F(){return G.apply(this,arguments)}function G(){return G=(0,R.default)(O.default.mark(function H(){var U,X,Y,z,W,Z,Q,ee,te=arguments;return O.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(U=te.length>0&&te[0]!==void 0?te[0]:{},X=te.length>1&&te[1]!==void 0?te[1]:{},!(U.versionIdMarker&&U.keyMarker===void 0)){ie.next=4;break}throw new Error("A version-id marker cannot be specified without a key marker");case 4:return X.subres=Object.assign({versions:""},X.subres),X.versionId&&(X.subres.versionId=X.versionId),Y=this._objectRequestParams("GET","",X),Y.xmlResponse=!0,Y.successStatuses=[200],Y.query=j(U),ie.next=12,this.request(Y);case 12:return z=ie.sent,W=z.data.Version||[],Z=z.data.DeleteMarker||[],Q=this,W&&(Array.isArray(W)||(W=[W]),W=W.map(function(ne){return{name:ne.Key,url:Q._objectUrl(ne.Key),lastModified:ne.LastModified,isLatest:ne.IsLatest==="true",versionId:ne.VersionId,etag:ne.ETag,type:ne.Type,size:Number(ne.Size),storageClass:ne.StorageClass,owner:{id:ne.Owner.ID,displayName:ne.Owner.DisplayName},restoreInfo:k(ne.RestoreInfo)}})),Z&&(M(Z)||(Z=[Z]),Z=Z.map(function(ne){return{name:ne.Key,lastModified:ne.LastModified,versionId:ne.VersionId,owner:{id:ne.Owner.ID,displayName:ne.Owner.DisplayName}}})),ee=z.data.CommonPrefixes||null,ee&&(M(ee)||(ee=[ee]),ee=ee.map(function(ne){return ne.Prefix})),ie.abrupt("return",{res:z.res,objects:W,deleteMarker:Z,prefixes:ee,nextMarker:z.data.NextKeyMarker||null,NextVersionIdMarker:z.data.NextVersionIdMarker||null,nextKeyMarker:z.data.NextKeyMarker||null,nextVersionIdMarker:z.data.NextVersionIdMarker||null,isTruncated:z.data.IsTruncated==="true"});case 21:case"end":return ie.stop()}},H,this)})),G.apply(this,arguments)}function V(H){return H.replace(/([A-Z])/g,"-$1").toLowerCase()}function j(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},U={};return D(H)&&Object.keys(H).forEach(function(X){U[V(X)]=H[X]}),U}},{"../utils/isArray":67,"../utils/isObject":74,"../utils/parseRestoreInfo":78,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.map.js":318,"core-js/modules/es.number.constructor.js":324,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.replace.js":345,"core-js/modules/web.dom-collections.for-each.js":380}],40:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B;P.getObjectMeta=function(){var E=(0,R.default)(O.default.mark(function I(M,N){var k,F;return O.default.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return N=N||{},M=this._objectName(M),N.subres=Object.assign({objectMeta:""},N.subres),N.versionId&&(N.subres.versionId=N.versionId),k=this._objectRequestParams("HEAD",M,N),k.successStatuses=[200],V.next=8,this.request(k);case 8:return F=V.sent,V.abrupt("return",{status:F.status,res:F.res});case 10:case"end":return V.stop()}},I,this)}));function D(I,M){return E.apply(this,arguments)}return D}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],41:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B,E=_("../utils/isObject"),D=E.isObject;P.getObjectTagging=function(){var I=(0,R.default)(O.default.mark(function N(k){var F,G,V,j,H,U,X=arguments;return O.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return F=X.length>1&&X[1]!==void 0?X[1]:{},F.subres=Object.assign({tagging:""},F.subres),F.versionId&&(F.subres.versionId=F.versionId),k=this._objectName(k),G=this._objectRequestParams("GET",k,F),G.successStatuses=[200],z.next=8,this.request(G);case 8:return V=z.sent,z.next=11,this.parseXML(V.data);case 11:return j=z.sent,H=j.TagSet.Tag,H=H&&D(H)?[H]:H||[],U={},H.forEach(function(W){U[W.Key]=W.Value}),z.abrupt("return",{status:V.status,res:V.res,tag:U});case 17:case"end":return z.stop()}},N,this)}));function M(N){return I.apply(this,arguments)}return M}()},{"../utils/isObject":74,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.to-string.js":329,"core-js/modules/web.dom-collections.for-each.js":380}],42:[function(_,w,B){var A=_("../utils/isIP"),O=A.isIP,R=B;R.getObjectUrl=function(E,D){if(O(this.options.endpoint.hostname))throw new Error("can not get the object URL when endpoint is IP");return D?D[D.length-1]!=="/"&&(D+="/"):D=this.options.endpoint.format(),D+this._escape(this._objectName(E))}},{"../utils/isIP":73}],43:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B;P.getSymlink=function(){var E=(0,R.default)(O.default.mark(function I(M){var N,k,F,G,V=arguments;return O.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return N=V.length>1&&V[1]!==void 0?V[1]:{},N.subres=Object.assign({symlink:""},N.subres),N.versionId&&(N.subres.versionId=N.versionId),M=this._objectName(M),k=this._objectRequestParams("GET",M,N),k.successStatuses=[200],H.next=8,this.request(k);case 8:return F=H.sent,G=F.res.headers["x-oss-symlink-target"],H.abrupt("return",{targetName:decodeURIComponent(G),res:F.res});case 11:case"end":return H.stop()}},I,this)}));function D(I){return E.apply(this,arguments)}return D}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],44:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/checkEnv"),E=P.checkEnv,D=B;D.head=function(){var I=(0,R.default)(O.default.mark(function N(k){var F,G,V,j,H=arguments;return O.default.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return F=H.length>1&&H[1]!==void 0?H[1]:{},E("Because HeadObject has gzip enabled, head cannot get the file size correctly. If you need to get the file size, please use getObjectMeta"),F.subres=Object.assign({},F.subres),F.versionId&&(F.subres.versionId=F.versionId),G=this._objectRequestParams("HEAD",k,F),G.successStatuses=[200,304],X.next=8,this.request(G);case 8:return V=X.sent,j={meta:null,res:V.res,status:V.status},V.status===200&&Object.keys(V.headers).forEach(function(Y){Y.indexOf("x-oss-meta-")===0&&(j.meta||(j.meta={}),j.meta[Y.substring(11)]=V.headers[Y])}),X.abrupt("return",j);case 12:case"end":return X.stop()}},N,this)}));function M(N){return I.apply(this,arguments)}return M}()},{"../utils/checkEnv":55,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/web.dom-collections.for-each.js":380}],45:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B;P.putACL=function(){var E=(0,R.default)(O.default.mark(function I(M,N,k){var F,G;return O.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return k=k||{},k.subres=Object.assign({acl:""},k.subres),k.versionId&&(k.subres.versionId=k.versionId),k.headers=k.headers||{},k.headers["x-oss-object-acl"]=N,M=this._objectName(M),F=this._objectRequestParams("PUT",M,k),F.successStatuses=[200],j.next=10,this.request(F);case 10:return G=j.sent,j.abrupt("return",{res:G.res});case 12:case"end":return j.stop()}},I,this)}));function D(I,M,N){return E.apply(this,arguments)}return D}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],46:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.array.map.js"),_("core-js/modules/es.object.keys.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("../utils/obj2xml"),E=P.obj2xml,D=_("../utils/checkObjectTag"),I=D.checkObjectTag,M=B;M.putObjectTagging=function(){var N=(0,R.default)(O.default.mark(function F(G,V){var j,H,U,X,Y=arguments;return O.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return j=Y.length>2&&Y[2]!==void 0?Y[2]:{},I(V),j.subres=Object.assign({tagging:""},j.subres),j.versionId&&(j.subres.versionId=j.versionId),G=this._objectName(G),H=this._objectRequestParams("PUT",G,j),H.successStatuses=[200],V=Object.keys(V).map(function(Z){return{Key:Z,Value:V[Z]}}),U={Tagging:{TagSet:{Tag:V}}},H.mime="xml",H.content=E(U),W.next=13,this.request(H);case 13:return X=W.sent,W.abrupt("return",{res:X.res,status:X.status});case 15:case"end":return W.stop()}},F,this)}));function k(F,G){return N.apply(this,arguments)}return k}()},{"../utils/checkObjectTag":56,"../utils/obj2xml":76,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.map.js":318,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.keys.js":328}],47:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=B;P.putSymlink=function(){var E=(0,R.default)(O.default.mark(function I(M,N,k){var F,G;return O.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return k=k||{},k.headers=k.headers||{},N=this._escape(this._objectName(N)),this._convertMetaToHeaders(k.meta,k.headers),k.headers["x-oss-symlink-target"]=N,k.subres=Object.assign({symlink:""},k.subres),k.versionId&&(k.subres.versionId=k.versionId),k.storageClass&&(k.headers["x-oss-storage-class"]=k.storageClass),M=this._objectName(M),F=this._objectRequestParams("PUT",M,k),F.successStatuses=[200],j.next=13,this.request(F);case 13:return G=j.sent,j.abrupt("return",{res:G.res});case 15:case"end":return j.stop()}},I,this)}));function D(I,M,N){return E.apply(this,arguments)}return D}()},{"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.object.assign.js":325}],48:[function(_,w,B){(function(A){(function(){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js");var O=function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(B,"__esModule",{value:!0}),B.signPostObjectPolicyV4=void 0;var R=O(_("dateformat")),P=_("../utils/getStandardRegion"),E=_("../utils/policy2Str"),D=_("../signUtils");function I(M,N){var k=A.from(E.policy2Str(M),"utf8").toString("base64"),F=R.default(N,"UTC:yyyymmdd'T'HHMMss'Z'"),G=F.split("T")[0],V=D.getSignatureV4(this.options.accessKeySecret,G,P.getStandardRegion(this.options.region),k);return V}B.signPostObjectPolicyV4=I}).call(this)}).call(this,_("buffer").Buffer)},{"../signUtils":52,"../utils/getStandardRegion":65,"../utils/policy2Str":79,buffer:103,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339,dateformat:383}],49:[function(_,w,B){_("core-js/modules/es.regexp.exec.js");var A=_("url"),O=_("utility"),R=_("copy-to"),P=_("../../common/signUtils"),E=_("../utils/isIP"),D=E.isIP,I=B;I.signatureUrl=function(N,k){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(D(this.options.endpoint.hostname))throw new Error("can not get the object URL when endpoint is IP");if(F&&/^\?/.test(N))throw new Error("Invalid object name ".concat(N));k=k||{},N=this._objectName(N),k.method=k.method||"GET";var G=O.timestamp()+(k.expires||1800),V={bucket:this.options.bucket,object:N},j=this._getResource(V);this.options.stsToken&&(k["security-token"]=this.options.stsToken);var H=P._signatureForURL(this.options.accessKeySecret,k,j,G),U=A.parse(this._getReqUrl(V));return U.query={OSSAccessKeyId:this.options.accessKeyId,Expires:G,Signature:H.Signature},R(H.subResource).to(U.query),U.format()}},{"../../common/signUtils":52,"../utils/isIP":73,"copy-to":107,"core-js/modules/es.regexp.exec.js":338,url:543,utility:545}],50:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.array.join.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("dateformat"),E=_("url"),D=_("../../common/signUtils"),I=_("../utils/setSTSToken"),M=I.setSTSToken,N=_("../utils/isFunction"),k=N.isFunction,F=_("../utils/getStandardRegion"),G=F.getStandardRegion,V=B;V.signatureUrlV4=function(){var j=(0,R.default)(O.default.mark(function U(X,Y,z,W,Z){var Q,ee,te,re,ie,ne,he,pe,K,ue,le,ce;return O.default.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(Q=this.options.cloudBoxId,ee=D.getProduct(Q),te=D.getSignRegion(G(this.options.region),Q),re=z&&z.headers||{},ie=Object.assign({},z&&z.queries||{}),ne=new Date,he=P(ne,"UTC:yyyymmdd'T'HHMMss'Z'"),pe=he.split("T")[0],K=D.fixAdditionalHeaders(Z),K.length>0&&(ie["x-oss-additional-headers"]=K.join(";")),ie["x-oss-credential"]=D.getCredential(pe,te,this.options.accessKeyId,ee),ie["x-oss-date"]=he,ie["x-oss-expires"]=Y,ie["x-oss-signature-version"]="OSS4-HMAC-SHA256",!(this.options.stsToken&&k(this.options.refreshSTSToken))){oe.next=17;break}return oe.next=17,M.call(this);case 17:return this.options.stsToken&&(ie["x-oss-security-token"]=this.options.stsToken),ue=D.getCanonicalRequest(X,{headers:re,queries:ie},this.options.bucket,W,K),le=D.getStringToSign(te,he,ue,ee),ie["x-oss-signature"]=D.getSignatureV4(this.options.accessKeySecret,pe,te,le,ee),ce=E.parse(this._getReqUrl({bucket:this.options.bucket,object:W})),ce.query=Object.assign({},ie),oe.abrupt("return",ce.format());case 24:case"end":return oe.stop()}},U,this)}));function H(U,X,Y,z,W){return j.apply(this,arguments)}return H}()},{"../../common/signUtils":52,"../utils/getStandardRegion":65,"../utils/isFunction":72,"../utils/setSTSToken":82,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.join.js":317,"core-js/modules/es.object.assign.js":325,dateformat:383,url:543}],51:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.array.iterator.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.promise.js"),_("core-js/modules/es.string.iterator.js"),_("core-js/modules/web.dom-collections.iterator.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.function.name.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator")),P=_("./utils/isArray"),E=P.isArray,D=B;D._parallelNode=function(){var I=(0,R.default)(O.default.mark(function N(k,F,G,V){var j,H,U,X,Y,z,W,Z;return O.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:j=this,H=[],U=[],X=k.length/F,Y=k.length%F,z=Y===0?X:(k.length-Y)/F+1,W=1,Z=0;case 8:if(!(Z<k.length)){ee.next=26;break}if(!j.isCancel()){ee.next=11;break}return ee.abrupt("break",26);case 11:if(V?U.push(G(j,k[Z],V)):U.push(G(j,k[Z])),!(U.length===F||W===z&&Z===k.length-1)){ee.next=23;break}return ee.prev=13,W+=1,ee.next=17,Promise.all(U);case 17:ee.next=22;break;case 19:ee.prev=19,ee.t0=ee.catch(13),H.push(ee.t0);case 22:U=[];case 23:Z++,ee.next=8;break;case 26:return ee.abrupt("return",H);case 27:case"end":return ee.stop()}},N,this,[[13,19]])}));function M(N,k,F,G){return I.apply(this,arguments)}return M}(),D._parallel=function(M,N,k){var F=this;return new Promise(function(G){var V=[];if(N<=0||!M){G(V);return}function j(ee){return function(){if(ee===null)throw new Error("Callback was already called.");var te=ee;ee=null;for(var re=arguments.length,ie=new Array(re),ne=0;ne<re;ne++)ie[ne]=arguments[ne];te.apply(this,ie)}}function H(ee){var te=-1,re=ee.length;return function(){return++te<re&&!F.isCancel()?{value:ee[te],key:te}:null}}var U=H(M),X=!1,Y=0,z=!1;function W(ee){Y-=1,ee?(X=!0,V.push(ee),G(V)):X&&Y<=0?(X=!0,G(V)):z||(F.isCancel()?G(V):Q())}function Z(ee,te){k(ee).then(function(re){te(null,re)}).catch(function(re){te(re)})}function Q(){for(z=!0;Y<N&&!X&&!F.isCancel();){var ee=U();if(ee===null||V.length>0){X=!0,Y<=0&&G(V);return}Y+=1,Z(ee.value,j(W))}z=!1}Q()})},D.cancel=function(M){this.options.cancelFlag=!0,E(this.multipartUploadStreams)&&this.multipartUploadStreams.forEach(function(N){if(N.destroyed===!1){var k={name:"cancel",message:"cancel"};N.destroy(k)}}),this.multipartUploadStreams=[],M&&this.abortMultipartUpload(M.name,M.uploadId,M.options)},D.isCancel=function(){return this.options.cancelFlag},D.resetCancelFlag=function(){this.options.cancelFlag=!1},D._stop=function(){this.options.cancelFlag=!0},D._makeCancelEvent=function(){var M={status:0,name:"cancel"};return M},D._makeAbortEvent=function(){var M={status:0,name:"abort",message:"upload task has been abort"};return M}},{"./utils/isArray":67,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.iterator.js":316,"core-js/modules/es.function.name.js":322,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.string.iterator.js":343,"core-js/modules/web.dom-collections.for-each.js":380,"core-js/modules/web.dom-collections.iterator.js":381}],52:[function(_,w,B){(function(A){(function(){var O=_("@babel/runtime/helpers/interopRequireDefault"),R=O(_("@babel/runtime/helpers/toConsumableArray"));_("core-js/modules/es.string.trim.js"),_("core-js/modules/es.array.sort.js"),_("core-js/modules/es.array.join.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.array.filter.js"),_("core-js/modules/es.array.iterator.js"),_("core-js/modules/es.set.js"),_("core-js/modules/es.string.iterator.js"),_("core-js/modules/web.dom-collections.iterator.js"),_("core-js/modules/es.array.map.js"),_("core-js/modules/es.string.starts-with.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.object.entries.js"),_("core-js/modules/es.regexp.to-string.js");var P=_("./../../shims/crypto/crypto.js"),E=_("is-type-of"),D=_("qs"),I=_("./utils/lowercaseKeyHeader"),M=I.lowercaseKeyHeader,N=_("./utils/encodeString"),k=N.encodeString;B.getProduct=function(G){return G===void 0?"oss":"oss-cloudbox"},B.getSignRegion=function(G,V){return V===void 0?G:V},B.buildCanonicalizedResource=function(G,V){var j="".concat(G),H="?";if(E.string(V)&&V.trim()!=="")j+=H+V;else if(E.array(V))V.sort(),j+=H+V.join("&");else if(V){var U=function(Y){j+=H+Y,(V[Y]||V[Y]===0)&&(j+="=".concat(V[Y])),H="&"};Object.keys(V).sort().forEach(U)}return j},B.buildCanonicalString=function(G,V,j,H){j=j||{};var U=M(j.headers),X="x-oss-",Y=[],z={},W=[G.toUpperCase(),U["content-md5"]||"",U["content-type"],H||U["x-oss-date"]];return Object.keys(U).forEach(function(Z){var Q=Z.toLowerCase();Q.indexOf(X)===0&&(z[Q]=String(U[Z]).trim())}),Object.keys(z).sort().forEach(function(Z){Y.push("".concat(Z,":").concat(z[Z]))}),W=W.concat(Y),W.push(this.buildCanonicalizedResource(V,j.parameters)),W.join("\n")},B.computeSignature=function(G,V){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"utf-8",H=P.createHmac("sha1",G);return H.update(A.from(V,j)).digest("base64")},B.authorization=function(G,V,j,H){return"OSS ".concat(G,":").concat(this.computeSignature(V,j,H))},B.fixAdditionalHeaders=function(F){if(!F)return[];var G="x-oss-";return(0,R.default)(new Set(F.map(function(V){return V.toLowerCase()}))).filter(function(V){return V!=="content-type"&&V!=="content-md5"&&!V.startsWith(G)}).sort()},B.getCanonicalRequest=function(G,V,j,H,U){var X=M(V.headers),Y=V.queries||{},z="x-oss-";if(H&&!j)throw Error("Please ensure that bucketName is passed into getCanonicalRequest.");var W=[G.toUpperCase(),k("/".concat(j?"".concat(j,"/"):"").concat(H||"")).replace(/%2F/g,"/")];W.push(D.stringify(Y,{encoder:k,sort:function(te,re){return te.localeCompare(re)},strictNullHandling:!0})),U&&U.forEach(function(ee){if(!Object.prototype.hasOwnProperty.call(X,ee))throw Error("Can't find additional header ".concat(ee," in request headers."))});var Z=new Set(U);Object.keys(X).forEach(function(ee){(ee==="content-type"||ee==="content-md5"||ee.startsWith(z))&&Z.add(ee)});var Q="".concat((0,R.default)(Z).sort().map(function(ee){return"".concat(ee,":").concat(E.string(X[ee])?X[ee].trim():X[ee],"\n")}).join(""));return W.push(Q),U&&U.length>0?W.push(U.join(";")):W.push(""),W.push(X["x-oss-content-sha256"]||"UNSIGNED-PAYLOAD"),W.join("\n")},B.getCredential=function(G,V,j){var H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"oss",U="".concat(G,"/").concat(V,"/").concat(H,"/aliyun_v4_request");return j?"".concat(j,"/").concat(U):U},B.getStringToSign=function(G,V,j){var H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"oss",U=["OSS4-HMAC-SHA256",V,this.getCredential(V.split("T")[0],G,void 0,H),P.createHash("sha256").update(j).digest("hex")];return U.join("\n")},B.getSignatureV4=function(G,V,j,H){var U=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"oss",X=P.createHmac("sha256","aliyun_v4".concat(G)).update(V).digest(),Y=P.createHmac("sha256",X).update(j).digest(),z=P.createHmac("sha256",Y).update(U).digest(),W=P.createHmac("sha256",z).update("aliyun_v4_request").digest(),Z=P.createHmac("sha256",W).update(H).digest("hex");return Z},B.authorizationV4=function(G,V,j,H,U,X,Y,z){var W=arguments.length>8&&arguments[8]!==void 0?arguments[8]:"utf-8",Z=arguments.length>9?arguments[9]:void 0,Q=this.getProduct(Z),ee=this.fixAdditionalHeaders(z),te={};Object.entries(U.headers).forEach(function(ue){te[ue[0]]=E.string(ue[1])?A.from(ue[1],W).toString():ue[1]});var re=te["x-oss-date"]||U.queries&&U.queries["x-oss-date"],ie=this.getCanonicalRequest(H,{headers:te,queries:U.queries},X,Y,ee),ne=this.getStringToSign(j,re,ie,Q),he=re.split("T")[0],pe=this.getSignatureV4(V,he,j,ne,Q),K=ee.length>0?"AdditionalHeaders=".concat(ee.join(";"),","):"";return"OSS4-HMAC-SHA256 Credential=".concat(this.getCredential(he,j,G,Q),",").concat(K,"Signature=").concat(pe)},B._signatureForURL=function(G){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},j=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0,X={},Y=V.subResource,z=Y===void 0?{}:Y;if(V.process){var W="x-oss-process";z[W]=V.process}if(V.trafficLimit){var Z="x-oss-traffic-limit";z[Z]=V.trafficLimit}if(V.response&&Object.keys(V.response).forEach(function(re){var ie="response-".concat(re.toLowerCase());z[ie]=V.response[re]}),Object.keys(V).forEach(function(re){var ie=re.toLowerCase(),ne=V[re];ie.indexOf("x-oss-")===0?X[ie]=ne:(ie.indexOf("content-md5")===0||ie.indexOf("content-type")===0)&&(X[re]=ne)}),Object.prototype.hasOwnProperty.call(V,"security-token")&&(z["security-token"]=V["security-token"]),Object.prototype.hasOwnProperty.call(V,"callback")){var Q={callbackUrl:encodeURI(V.callback.url),callbackBody:V.callback.body};if(V.callback.host&&(Q.callbackHost=V.callback.host),V.callback.contentType&&(Q.callbackBodyType=V.callback.contentType),V.callback.callbackSNI&&(Q.callbackSNI=V.callback.callbackSNI),z.callback=A.from(JSON.stringify(Q)).toString("base64"),V.callback.customValue){var ee={};Object.keys(V.callback.customValue).forEach(function(re){ee["x:".concat(re)]=V.callback.customValue[re]}),z["callback-var"]=A.from(JSON.stringify(ee)).toString("base64")}}var te=this.buildCanonicalString(V.method,j,{headers:X,parameters:z},H.toString());return{Signature:this.computeSignature(G,te,U),subResource:z}}}).call(this)}).call(this,_("buffer").Buffer)},{"./../../shims/crypto/crypto.js":531,"./utils/encodeString":61,"./utils/lowercaseKeyHeader":75,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/toConsumableArray":90,buffer:103,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.filter.js":312,"core-js/modules/es.array.iterator.js":316,"core-js/modules/es.array.join.js":317,"core-js/modules/es.array.map.js":318,"core-js/modules/es.array.sort.js":320,"core-js/modules/es.object.entries.js":326,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.set.js":341,"core-js/modules/es.string.iterator.js":343,"core-js/modules/es.string.replace.js":345,"core-js/modules/es.string.starts-with.js":348,"core-js/modules/es.string.trim.js":349,"core-js/modules/web.dom-collections.for-each.js":380,"core-js/modules/web.dom-collections.iterator.js":381,"is-type-of":537,qs:445}],53:[function(_,w,B){_("core-js/modules/es.regexp.exec.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.checkBucketName=void 0,B.checkBucketName=function(A){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=O?/^[a-z0-9][a-z0-9-]{1,61}[a-z0-9]$/:/^[a-z0-9_][a-z0-9-_]{1,61}[a-z0-9_]$/;if(!R.test(A))throw new Error("The bucket must be conform to the specifications")}},{"core-js/modules/es.regexp.exec.js":338}],54:[function(_,w,B){_("core-js/modules/es.regexp.exec.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.checkConfigValid=void 0;var A={endpoint:O,region:/^[a-zA-Z0-9\-_]+$/};function O(R){return typeof R=="string"?/^[a-zA-Z0-9._:/-]+$/.test(R):R.host?/^[a-zA-Z0-9._:/-]+$/.test(R.host):!1}B.checkConfigValid=function(R,P){if(A[P]){var E=!0;if(A[P]instanceof Function?E=A[P](R):E=A[P].test(R),!E)throw new Error("The ".concat(P," must be conform to the specifications"))}}},{"core-js/modules/es.regexp.exec.js":338}],55:[function(_,w,B){(function(A){(function(){Object.defineProperty(B,"__esModule",{value:!0}),B.checkEnv=void 0;function O(R){A.browser&&console.warn(R)}B.checkEnv=O}).call(this)}).call(this,_("_process"))},{_process:538}],56:[function(_,w,B){_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.object.entries.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.checkObjectTag=void 0;var A=_("./checkValid"),O=A.checkValid,R=_("./isObject"),P=R.isObject,E=[{validator:function(N){if(typeof N!="string")throw new Error("the key and value of the tag must be String")}},{pattern:/^[a-zA-Z0-9 +-=._:/]+$/,msg:"tag can contain letters, numbers, spaces, and the following symbols: plus sign (+), hyphen (-), equal sign (=), period (.), underscore (_), colon (:), and forward slash (/)"}],D={key:[].concat(E,[{pattern:/^.{1,128}$/,msg:"tag key can be a maximum of 128 bytes in length"}]),value:[].concat(E,[{pattern:/^.{0,256}$/,msg:"tag value can be a maximum of 256 bytes in length"}])};function I(M){if(!P(M))throw new Error("tag must be Object");var N=Object.entries(M);if(N.length>10)throw new Error("maximum of 10 tags for a object");var k=["key","value"];N.forEach(function(F){F.forEach(function(G,V){O(G,D[k[V]])})})}B.checkObjectTag=I},{"./checkValid":57,"./isObject":74,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.object.entries.js":326,"core-js/modules/es.object.to-string.js":329,"core-js/modules/web.dom-collections.for-each.js":380}],57:[function(_,w,B){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.regexp.exec.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.checkValid=void 0;function A(O,R){R.forEach(function(P){if(P.validator)P.validator(O);else if(P.pattern&&!P.pattern.test(O))throw new Error(P.msg)})}B.checkValid=A},{"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/web.dom-collections.for-each.js":380}],58:[function(_,w,B){(function(A){(function(){_("core-js/modules/es.array.includes.js"),_("core-js/modules/es.string.includes.js"),_("core-js/modules/es.object.assign.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.entries.js"),_("core-js/modules/es.array.concat.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.createRequest=void 0;var O=_("./../../../shims/crypto/crypto.js"),R=_("debug")("ali-oss"),P=_("lodash/isString"),E=_("lodash/isArray"),D=_("lodash/isObject"),I=_("mime"),M=_("dateformat"),N=_("copy-to"),k=_("path"),F=_("./encoder"),G=F.encoder,V=_("./isIP"),j=V.isIP,H=_("./setRegion"),U=H.setRegion,X=_("../client/getReqUrl"),Y=X.getReqUrl,z=_("./isDingTalk"),W=z.isDingTalk;function Z(te,re){return te[re]||te[re.toLowerCase()]}function Q(te,re){delete te[re],delete te[re.toLowerCase()]}function ee(te){var re=new Date;this.options.amendTimeSkewed&&(re=+new Date+this.options.amendTimeSkewed);var ie={"x-oss-date":M(re,this.options.authorizationV4?"UTC:yyyymmdd'T'HHMMss'Z'":"UTC:ddd, dd mmm yyyy HH:MM:ss 'GMT'")};this.options.authorizationV4&&(ie["x-oss-content-sha256"]="UNSIGNED-PAYLOAD"),typeof window<"u"&&(ie["x-oss-user-agent"]=this.userAgent),this.userAgent.includes("nodejs")&&(ie["User-Agent"]=this.userAgent),this.options.isRequestPay&&Object.assign(ie,{"x-oss-request-payer":"requester"}),this.options.stsToken&&(ie["x-oss-security-token"]=this.options.stsToken),N(te.headers).to(ie),Z(ie,"Content-Type")||(te.mime&&te.mime.indexOf("/")>0?ie["Content-Type"]=te.mime:W()?ie["Content-Type"]="application/octet-stream":ie["Content-Type"]=I.getType(te.mime||k.extname(te.object||""))),Z(ie,"Content-Type")||Q(ie,"Content-Type"),te.content&&(te.disabledMD5||(!te.headers||!te.headers["Content-MD5"]?ie["Content-MD5"]=O.createHash("md5").update(A.from(te.content,"utf8")).digest("base64"):ie["Content-MD5"]=te.headers["Content-MD5"]),ie["Content-Length"]||(ie["Content-Length"]=te.content.length));var ne=Object.prototype.hasOwnProperty;for(var he in ie)ie[he]&&ne.call(ie,he)&&(ie[he]=G(String(ie[he]),this.options.headerEncoding));var pe={};if(P(te.subres)?pe[te.subres]=null:E(te.subres)?te.subres.forEach(function(ye){pe[ye]=null}):D(te.subres)&&Object.entries(te.subres).forEach(function(ye){pe[ye[0]]=ye[1]===""?null:ye[1]}),D(te.query)&&Object.entries(te.query).forEach(function(ye){pe[ye[0]]=ye[1]}),ie.authorization=this.options.authorizationV4?this.authorizationV4(te.method,{headers:ie,queries:pe},te.bucket,te.object,te.additionalHeaders):this.authorization(te.method,this._getResource(te),te.subres,ie,this.options.headerEncoding),j(this.options.endpoint.hostname)){var K=this.options,ue=K.region,le=K.internal,ce=K.secure,_e=U(ue,le,ce);ie.host="".concat(te.bucket,".").concat(_e.host)}var oe=Y.bind(this)(te);R("request %s %s, with headers %j, !!stream: %s",te.method,oe,ie,!!te.stream);var de=te.timeout||this.options.timeout,me={method:te.method,content:te.content,stream:te.stream,headers:ie,timeout:de,writeStream:te.writeStream,customResponse:te.customResponse,ctx:te.ctx||this.ctx};return this.agent&&(me.agent=this.agent),this.httpsAgent&&(me.httpsAgent=this.httpsAgent),me.enableProxy=!!this.options.enableProxy,me.proxy=this.options.proxy?this.options.proxy:null,{url:oe,params:me}}B.createRequest=ee}).call(this)}).call(this,_("buffer").Buffer)},{"../client/getReqUrl":25,"./../../../shims/crypto/crypto.js":531,"./encoder":62,"./isDingTalk":70,"./isIP":73,"./setRegion":81,buffer:103,"copy-to":107,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.includes.js":315,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.entries.js":326,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.string.includes.js":342,"core-js/modules/web.dom-collections.for-each.js":380,dateformat:383,debug:536,"lodash/isArray":422,"lodash/isObject":423,"lodash/isString":425,mime:430,path:439}],59:[function(_,w,B){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.entries.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.array.includes.js"),_("core-js/modules/es.object.keys.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.dataFix=void 0;var A=_("./isObject"),O=["true","TRUE","1",1],R=["false","FALSE","0",0];function P(I,M,N){if(A.isObject(I)){var k=M.remove,F=k===void 0?[]:k,G=M.rename,V=G===void 0?{}:G,j=M.camel,H=j===void 0?[]:j,U=M.bool,X=U===void 0?[]:U,Y=M.lowerFirst,z=Y===void 0?!1:Y;return F.forEach(function(W){return delete I[W]}),Object.entries(V).forEach(function(W){I[W[0]]&&(I[W[1]]||(I[W[1]]=I[W[0]],delete I[W[0]]))}),H.forEach(function(W){if(I[W]){var Z=W.replace(/^(.)/,function(Q){return Q.toLowerCase()}).replace(/-(\w)/g,function(Q,ee){return ee.toUpperCase()});I[Z]||(I[Z]=I[W])}}),X.forEach(function(W){I[W]=E(I[W])}),typeof N=="function"&&N(I),D(I,z),P}}B.dataFix=P;function E(I){return I?O.includes(I)?!0:R.includes(I)?!1:I:!1}function D(I,M){M&&Object.keys(I).forEach(function(N){var k=N.replace(/^\w/,function(F){return F.toLowerCase()});typeof I[k]>"u"&&(I[k]=I[N],delete I[N])})}},{"./isObject":74,"core-js/modules/es.array.includes.js":315,"core-js/modules/es.object.entries.js":326,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.replace.js":345,"core-js/modules/web.dom-collections.for-each.js":380}],60:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault");_("core-js/modules/es.array.slice.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js");var O=A(_("@babel/runtime/helpers/typeof"));Object.defineProperty(B,"__esModule",{value:!0}),B.deepCopyWith=B.deepCopy=void 0;var R=_("./isBuffer");B.deepCopy=function(P){if(P===null||(0,O.default)(P)!=="object")return P;if(R.isBuffer(P))return P.slice();var E=Array.isArray(P)?[]:{};return Object.keys(P).forEach(function(D){E[D]=B.deepCopy(P[D])}),E},B.deepCopyWith=function(P,E){function D(I,M,N){var k=E(I,M,N);if(k!==void 0)return k;if(I===null||(0,O.default)(I)!=="object")return I;if(R.isBuffer(I))return I.slice();var F=Array.isArray(I)?[]:{};return Object.keys(I).forEach(function(G){F[G]=D(I[G],G,I)}),F}return E?D(P,"",null):B.deepCopy(P)}},{"./isBuffer":69,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/typeof":91,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/web.dom-collections.for-each.js":380}],61:[function(_,w,B){_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js");var A=function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(B,"__esModule",{value:!0}),B.encodeString=void 0;var O=A(_("lodash/toString"));function R(P){var E=O.default(P);return encodeURIComponent(E).replace(/[!'()*]/g,function(D){return"%".concat(D.charCodeAt(0).toString(16).toUpperCase())})}B.encodeString=R},{"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.replace.js":345,"lodash/toString":427}],62:[function(_,w,B){(function(A){(function(){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.encoder=void 0;function O(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"utf-8";return P==="utf-8"?R:A.from(R).toString("latin1")}B.encoder=O}).call(this)}).call(this,_("buffer").Buffer)},{buffer:103,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339}],63:[function(_,w,B){_("core-js/modules/es.array.map.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.formatInventoryConfig=void 0;var A=_("../utils/dataFix"),O=_("../utils/isObject"),R=_("../utils/isArray"),P=_("../utils/formatObjKey");function E(I){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return M&&O.isObject(I)&&(I=[I]),R.isArray(I)?I=I.map(D):I=D(I),I}B.formatInventoryConfig=E;function D(I){return A.dataFix(I,{bool:["IsEnabled"]},function(M){var N,k;M.prefix=M.Filter.Prefix,delete M.Filter,M.OSSBucketDestination=M.Destination.OSSBucketDestination,M.OSSBucketDestination.rolename=M.OSSBucketDestination.RoleArn.replace(/.*\//,""),delete M.OSSBucketDestination.RoleArn,M.OSSBucketDestination.bucket=M.OSSBucketDestination.Bucket.replace(/.*:::/,""),delete M.OSSBucketDestination.Bucket,delete M.Destination,M.frequency=M.Schedule.Frequency,delete M.Schedule.Frequency,!((N=M==null?void 0:M.OptionalFields)===null||N===void 0)&&N.Field&&!R.isArray((k=M.OptionalFields)===null||k===void 0?void 0:k.Field)&&(M.OptionalFields.Field=[M.OptionalFields.Field])}),I=P.formatObjKey(I,"firstLowerCase",{exclude:["OSSBucketDestination","SSE-OSS","SSE-KMS"]}),I}},{"../utils/dataFix":59,"../utils/formatObjKey":64,"../utils/isArray":67,"../utils/isObject":74,"core-js/modules/es.array.map.js":318,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.replace.js":345}],64:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault");_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.array.includes.js"),_("core-js/modules/es.string.includes.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js");var O=A(_("@babel/runtime/helpers/typeof"));Object.defineProperty(B,"__esModule",{value:!0}),B.formatObjKey=void 0;function R(E,D,I){if(E===null||(0,O.default)(E)!=="object")return E;var M;if(Array.isArray(E)){M=[];for(var N=0;N<E.length;N++)M.push(R(E[N],D,I))}else M={},Object.keys(E).forEach(function(k){M[P(k,D,I)]=R(E[k],D,I)});return M}B.formatObjKey=R;function P(E,D,I){return I&&I.exclude&&I.exclude.includes(E)||(D==="firstUpperCase"?E=E.replace(/^./,function(M){return M.toUpperCase()}):D==="firstLowerCase"&&(E=E.replace(/^./,function(M){return M.toLowerCase()}))),E}},{"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/typeof":91,"core-js/modules/es.array.includes.js":315,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.includes.js":342,"core-js/modules/es.string.replace.js":345,"core-js/modules/web.dom-collections.for-each.js":380}],65:[function(_,w,B){_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.getStandardRegion=void 0;function A(O){return O.replace(/^oss-/g,"")}B.getStandardRegion=A},{"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.replace.js":345}],66:[function(_,w,B){_("core-js/modules/es.regexp.exec.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.getStrBytesCount=void 0;function A(O){for(var R=0,P=0;P<O.length;P++){var E=O.charAt(P);/^[\u00-\uff]$/.test(E)?R+=1:R+=2}return R}B.getStrBytesCount=A},{"core-js/modules/es.regexp.exec.js":338}],67:[function(_,w,B){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.isArray=void 0,B.isArray=function(A){return Object.prototype.toString.call(A)==="[object Array]"}},{"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339}],68:[function(_,w,B){Object.defineProperty(B,"__esModule",{value:!0}),B.isBlob=void 0;function A(O){return typeof Blob<"u"&&O instanceof Blob}B.isBlob=A},{}],69:[function(_,w,B){(function(A){(function(){Object.defineProperty(B,"__esModule",{value:!0}),B.isBuffer=void 0;function O(R){return A.isBuffer(R)}B.isBuffer=O}).call(this)}).call(this,{isBuffer:_("../../../node_modules/is-buffer/index.js")})},{"../../../node_modules/is-buffer/index.js":409}],70:[function(_,w,B){(function(A){(function(){_("core-js/modules/es.array.includes.js"),_("core-js/modules/es.string.includes.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.isDingTalk=void 0;function O(){return!!(A.browser&&window.navigator.userAgent.toLowerCase().includes("aliapp(dingtalk"))}B.isDingTalk=O}).call(this)}).call(this,_("_process"))},{_process:538,"core-js/modules/es.array.includes.js":315,"core-js/modules/es.string.includes.js":342}],71:[function(_,w,B){Object.defineProperty(B,"__esModule",{value:!0}),B.isFile=void 0,B.isFile=function(A){return typeof File<"u"&&A instanceof File}},{}],72:[function(_,w,B){Object.defineProperty(B,"__esModule",{value:!0}),B.isFunction=void 0,B.isFunction=function(A){return typeof A=="function"}},{}],73:[function(_,w,B){_("core-js/modules/es.regexp.exec.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.isIP=void 0,B.isIP=function(A){var O=/^(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}$/,R=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;return O.test(A)||R.test(A)}},{"core-js/modules/es.regexp.exec.js":338}],74:[function(_,w,B){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.isObject=void 0,B.isObject=function(A){return Object.prototype.toString.call(A)==="[object Object]"}},{"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339}],75:[function(_,w,B){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.lowercaseKeyHeader=void 0;var A=_("./isObject");function O(R){var P={};return A.isObject(R)&&Object.keys(R).forEach(function(E){P[E.toLowerCase()]=R[E]}),P}B.lowercaseKeyHeader=O},{"./isObject":74,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/web.dom-collections.for-each.js":380}],76:[function(_,w,B){_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.array.join.js"),_("core-js/modules/es.array.map.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.obj2xml=void 0;var A=_("./formatObjKey");function O(P){return Object.prototype.toString.call(P).replace(/(.*? |])/g,"").toLowerCase()}function R(P,E){var D="";return E&&E.headers&&(D='<?xml version="1.0" encoding="UTF-8"?>\n'),E&&E.firstUpperCase&&(P=A.formatObjKey(P,"firstUpperCase")),O(P)==="object"?Object.keys(P).forEach(function(I){O(P[I])!=="undefined"&&O(P[I])!=="null"&&(O(P[I])==="string"||O(P[I])==="number"?D+="<".concat(I,">").concat(P[I],"</").concat(I,">"):O(P[I])==="object"?D+="<".concat(I,">").concat(R(P[I]),"</").concat(I,">"):O(P[I])==="array"?D+=P[I].map(function(M){return"<".concat(I,">").concat(R(M),"</").concat(I,">")}).join(""):D+="<".concat(I,">").concat(P[I].toString(),"</").concat(I,">"))}):D+=P.toString(),D}B.obj2xml=R},{"./formatObjKey":64,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.join.js":317,"core-js/modules/es.array.map.js":318,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.replace.js":345,"core-js/modules/web.dom-collections.for-each.js":380}],77:[function(_,w,B){_("core-js/modules/es.array.slice.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/es.function.name.js"),_("core-js/modules/es.array.from.js"),_("core-js/modules/es.string.iterator.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.symbol.js"),_("core-js/modules/es.symbol.description.js"),_("core-js/modules/es.symbol.iterator.js"),_("core-js/modules/es.array.iterator.js"),_("core-js/modules/web.dom-collections.iterator.js"),_("core-js/modules/es.object.assign.js");function A(E,D){var I=typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if(!I){if(Array.isArray(E)||(I=O(E))||D){I&&(E=I);var M=0,N=function(){};return{s:N,n:function(){return M>=E.length?{done:!0}:{done:!1,value:E[M++]}},e:function(j){throw j},f:N}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var k=!0,F=!1,G;return{s:function(){I=I.call(E)},n:function(){var j=I.next();return k=j.done,j},e:function(j){F=!0,G=j},f:function(){try{!k&&I.return!=null&&I.return()}finally{if(F)throw G}}}}function O(E,D){if(E){if(typeof E=="string")return R(E,D);var I=Object.prototype.toString.call(E).slice(8,-1);if(I==="Object"&&E.constructor&&(I=E.constructor.name),I==="Map"||I==="Set")return Array.from(E);if(I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I))return R(E,D)}}function R(E,D){(D==null||D>E.length)&&(D=E.length);for(var I=0,M=new Array(D);I<D;I++)M[I]=E[I];return M}Object.defineProperty(B,"__esModule",{value:!0}),B.omit=void 0;function P(E,D){var I=Object.assign({},E),M=A(D),N;try{for(M.s();!(N=M.n()).done;){var k=N.value;delete I[k]}}catch(F){M.e(F)}finally{M.f()}return I}B.omit=P},{"core-js/modules/es.array.from.js":314,"core-js/modules/es.array.iterator.js":316,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.function.name.js":322,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.iterator.js":343,"core-js/modules/es.symbol.description.js":351,"core-js/modules/es.symbol.iterator.js":353,"core-js/modules/es.symbol.js":354,"core-js/modules/web.dom-collections.iterator.js":381}],78:[function(_,w,B){_("core-js/modules/es.array.includes.js"),_("core-js/modules/es.string.includes.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.match.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.parseRestoreInfo=void 0,B.parseRestoreInfo=function(A){var O;if(A&&(O={ongoingRequest:A.includes("true")},!O.ongoingRequest)){var R=A.match(/expiry-date="(.*)"/);R&&R[1]&&(O.expiryDate=new Date(R[1]))}return O}},{"core-js/modules/es.array.includes.js":315,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.includes.js":342,"core-js/modules/es.string.match.js":344}],79:[function(_,w,B){_("core-js/modules/es.object.keys.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.policy2Str=void 0;function A(O){var R;if(O)if(typeof O=="string")try{R=JSON.stringify(JSON.parse(O))}catch(P){throw new Error("Policy string is not a valid JSON: ".concat(P.message))}else R=JSON.stringify(O);return R}B.policy2Str=A},{"core-js/modules/es.object.keys.js":328}],80:[function(_,w,B){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.promise.js"),Object.defineProperty(B,"__esModule",{value:!0}),B.retry=void 0;function A(O,R){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=0,D=P.retryDelay,I=D===void 0?500:D,M=P.errorHandler,N=M===void 0?function(){return!0}:M,k=function F(){for(var G=arguments.length,V=new Array(G),j=0;j<G;j++)V[j]=arguments[j];return new Promise(function(H,U){O.apply(void 0,V).then(function(X){E=0,H(X)}).catch(function(X){E<R&&N(X)?(E++,setTimeout(function(){H(F.apply(void 0,V))},I)):(E=0,U(X))})})};return k}B.retry=A},{"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333}],81:[function(_,w,B){var A=function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(B,"__esModule",{value:!0}),B.setRegion=void 0;var O=A(_("url")),R=_("./checkConfigValid");function P(E){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;R.checkConfigValid(E,"region");var M=I?"https://":"http://",N=D?"-internal.aliyuncs.com":".aliyuncs.com",k="vpc100-oss-cn-";return E.substr(0,k.length)===k&&(N=".aliyuncs.com"),O.default.parse(M+E+N)}B.setRegion=P},{"./checkConfigValid":54,url:543}],82:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/regenerator"));_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.array.find.js"),_("core-js/modules/es.object.assign.js");var R=A(_("@babel/runtime/helpers/asyncToGenerator"));Object.defineProperty(B,"__esModule",{value:!0}),B.checkCredentials=B.setSTSToken=void 0;var P=_("./formatObjKey");function E(){return D.apply(this,arguments)}function D(){return D=(0,R.default)(O.default.mark(function M(){var N,k;return O.default.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(this.options||(this.options={}),N=new Date,!this.stsTokenFreshTime){G.next=14;break}if(!(+N-this.stsTokenFreshTime>=this.options.refreshSTSTokenInterval)){G.next=12;break}return this.stsTokenFreshTime=N,G.next=7,this.options.refreshSTSToken();case 7:k=G.sent,k=P.formatObjKey(k,"firstLowerCase"),k.securityToken&&(k.stsToken=k.securityToken),I(k),Object.assign(this.options,k);case 12:G.next=15;break;case 14:this.stsTokenFreshTime=N;case 15:return G.abrupt("return",null);case 16:case"end":return G.stop()}},M,this)})),D.apply(this,arguments)}B.setSTSToken=E;function I(M){var N=["accessKeySecret","accessKeyId","stsToken"],k=Object.keys(M);N.forEach(function(F){if(!k.find(function(G){return G===F}))throw Error("refreshSTSToken must return contains ".concat(F))})}B.checkCredentials=I},{"./formatObjKey":64,"@babel/runtime/helpers/asyncToGenerator":85,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/regenerator":93,"core-js/modules/es.array.find.js":313,"core-js/modules/es.object.assign.js":325,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329}],83:[function(_,w,B){function A(O,R){(R==null||R>O.length)&&(R=O.length);for(var P=0,E=new Array(R);P<R;P++)E[P]=O[P];return E}w.exports=A,w.exports.__esModule=!0,w.exports.default=w.exports},{}],84:[function(_,w,B){var A=_("./arrayLikeToArray.js");function O(R){if(Array.isArray(R))return A(R)}w.exports=O,w.exports.__esModule=!0,w.exports.default=w.exports},{"./arrayLikeToArray.js":83}],85:[function(_,w,B){function A(R,P,E,D,I,M,N){try{var k=R[M](N),F=k.value}catch(G){E(G);return}k.done?P(F):Promise.resolve(F).then(D,I)}function O(R){return function(){var P=this,E=arguments;return new Promise(function(D,I){var M=R.apply(P,E);function N(F){A(M,D,I,N,k,"next",F)}function k(F){A(M,D,I,N,k,"throw",F)}N(void 0)})}}w.exports=O,w.exports.__esModule=!0,w.exports.default=w.exports},{}],86:[function(_,w,B){function A(O){return O&&O.__esModule?O:{default:O}}w.exports=A,w.exports.__esModule=!0,w.exports.default=w.exports},{}],87:[function(_,w,B){function A(O){if(typeof Symbol<"u"&&O[Symbol.iterator]!=null||O["@@iterator"]!=null)return Array.from(O)}w.exports=A,w.exports.__esModule=!0,w.exports.default=w.exports},{}],88:[function(_,w,B){function A(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}w.exports=A,w.exports.__esModule=!0,w.exports.default=w.exports},{}],89:[function(_,w,B){var A=_("./typeof.js").default;function O(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */w.exports=O=function(){return P},w.exports.__esModule=!0,w.exports.default=w.exports;var R,P={},E=Object.prototype,D=E.hasOwnProperty,I=Object.defineProperty||function(oe,de,me){oe[de]=me.value},M=typeof Symbol=="function"?Symbol:{},N=M.iterator||"@@iterator",k=M.asyncIterator||"@@asyncIterator",F=M.toStringTag||"@@toStringTag";function G(oe,de,me){return Object.defineProperty(oe,de,{value:me,enumerable:!0,configurable:!0,writable:!0}),oe[de]}try{G({},"")}catch(oe){G=function(me,ye,ge){return me[ye]=ge}}function V(oe,de,me,ye){var ge=de&&de.prototype instanceof W?de:W,we=Object.create(ge.prototype),Te=new ce(ye||[]);return I(we,"_invoke",{value:pe(oe,me,Te)}),we}function j(oe,de,me){try{return{type:"normal",arg:oe.call(de,me)}}catch(ye){return{type:"throw",arg:ye}}}P.wrap=V;var H="suspendedStart",U="suspendedYield",X="executing",Y="completed",z={};function W(){}function Z(){}function Q(){}var ee={};G(ee,N,function(){return this});var te=Object.getPrototypeOf,re=te&&te(te(_e([])));re&&re!==E&&D.call(re,N)&&(ee=re);var ie=Q.prototype=W.prototype=Object.create(ee);function ne(oe){["next","throw","return"].forEach(function(de){G(oe,de,function(me){return this._invoke(de,me)})})}function he(oe,de){function me(ge,we,Te,Ee){var De=j(oe[ge],oe,we);if(De.type!=="throw"){var fe=De.arg,Ce=fe.value;return Ce&&A(Ce)=="object"&&D.call(Ce,"__await")?de.resolve(Ce.__await).then(function(Se){me("next",Se,Te,Ee)},function(Se){me("throw",Se,Te,Ee)}):de.resolve(Ce).then(function(Se){fe.value=Se,Te(fe)},function(Se){return me("throw",Se,Te,Ee)})}Ee(De.arg)}var ye;I(this,"_invoke",{value:function(we,Te){function Ee(){return new de(function(De,fe){me(we,Te,De,fe)})}return ye=ye?ye.then(Ee,Ee):Ee()}})}function pe(oe,de,me){var ye=H;return function(ge,we){if(ye===X)throw new Error("Generator is already running");if(ye===Y){if(ge==="throw")throw we;return{value:R,done:!0}}for(me.method=ge,me.arg=we;;){var Te=me.delegate;if(Te){var Ee=K(Te,me);if(Ee){if(Ee===z)continue;return Ee}}if(me.method==="next")me.sent=me._sent=me.arg;else if(me.method==="throw"){if(ye===H)throw ye=Y,me.arg;me.dispatchException(me.arg)}else me.method==="return"&&me.abrupt("return",me.arg);ye=X;var De=j(oe,de,me);if(De.type==="normal"){if(ye=me.done?Y:U,De.arg===z)continue;return{value:De.arg,done:me.done}}De.type==="throw"&&(ye=Y,me.method="throw",me.arg=De.arg)}}}function K(oe,de){var me=de.method,ye=oe.iterator[me];if(ye===R)return de.delegate=null,me==="throw"&&oe.iterator.return&&(de.method="return",de.arg=R,K(oe,de),de.method==="throw")||me!=="return"&&(de.method="throw",de.arg=new TypeError("The iterator does not provide a '"+me+"' method")),z;var ge=j(ye,oe.iterator,de.arg);if(ge.type==="throw")return de.method="throw",de.arg=ge.arg,de.delegate=null,z;var we=ge.arg;return we?we.done?(de[oe.resultName]=we.value,de.next=oe.nextLoc,de.method!=="return"&&(de.method="next",de.arg=R),de.delegate=null,z):we:(de.method="throw",de.arg=new TypeError("iterator result is not an object"),de.delegate=null,z)}function ue(oe){var de={tryLoc:oe[0]};1 in oe&&(de.catchLoc=oe[1]),2 in oe&&(de.finallyLoc=oe[2],de.afterLoc=oe[3]),this.tryEntries.push(de)}function le(oe){var de=oe.completion||{};de.type="normal",delete de.arg,oe.completion=de}function ce(oe){this.tryEntries=[{tryLoc:"root"}],oe.forEach(ue,this),this.reset(!0)}function _e(oe){if(oe||oe===""){var de=oe[N];if(de)return de.call(oe);if(typeof oe.next=="function")return oe;if(!isNaN(oe.length)){var me=-1,ye=function ge(){for(;++me<oe.length;)if(D.call(oe,me))return ge.value=oe[me],ge.done=!1,ge;return ge.value=R,ge.done=!0,ge};return ye.next=ye}}throw new TypeError(A(oe)+" is not iterable")}return Z.prototype=Q,I(ie,"constructor",{value:Q,configurable:!0}),I(Q,"constructor",{value:Z,configurable:!0}),Z.displayName=G(Q,F,"GeneratorFunction"),P.isGeneratorFunction=function(oe){var de=typeof oe=="function"&&oe.constructor;return!!de&&(de===Z||(de.displayName||de.name)==="GeneratorFunction")},P.mark=function(oe){return Object.setPrototypeOf?Object.setPrototypeOf(oe,Q):(oe.__proto__=Q,G(oe,F,"GeneratorFunction")),oe.prototype=Object.create(ie),oe},P.awrap=function(oe){return{__await:oe}},ne(he.prototype),G(he.prototype,k,function(){return this}),P.AsyncIterator=he,P.async=function(oe,de,me,ye,ge){ge===void 0&&(ge=Promise);var we=new he(V(oe,de,me,ye),ge);return P.isGeneratorFunction(de)?we:we.next().then(function(Te){return Te.done?Te.value:we.next()})},ne(ie),G(ie,F,"Generator"),G(ie,N,function(){return this}),G(ie,"toString",function(){return"[object Generator]"}),P.keys=function(oe){var de=Object(oe),me=[];for(var ye in de)me.push(ye);return me.reverse(),function ge(){for(;me.length;){var we=me.pop();if(we in de)return ge.value=we,ge.done=!1,ge}return ge.done=!0,ge}},P.values=_e,ce.prototype={constructor:ce,reset:function(de){if(this.prev=0,this.next=0,this.sent=this._sent=R,this.done=!1,this.delegate=null,this.method="next",this.arg=R,this.tryEntries.forEach(le),!de)for(var me in this)me.charAt(0)==="t"&&D.call(this,me)&&!isNaN(+me.slice(1))&&(this[me]=R)},stop:function(){this.done=!0;var de=this.tryEntries[0].completion;if(de.type==="throw")throw de.arg;return this.rval},dispatchException:function(de){if(this.done)throw de;var me=this;function ye(fe,Ce){return Te.type="throw",Te.arg=de,me.next=fe,Ce&&(me.method="next",me.arg=R),!!Ce}for(var ge=this.tryEntries.length-1;ge>=0;--ge){var we=this.tryEntries[ge],Te=we.completion;if(we.tryLoc==="root")return ye("end");if(we.tryLoc<=this.prev){var Ee=D.call(we,"catchLoc"),De=D.call(we,"finallyLoc");if(Ee&&De){if(this.prev<we.catchLoc)return ye(we.catchLoc,!0);if(this.prev<we.finallyLoc)return ye(we.finallyLoc)}else if(Ee){if(this.prev<we.catchLoc)return ye(we.catchLoc,!0)}else{if(!De)throw new Error("try statement without catch or finally");if(this.prev<we.finallyLoc)return ye(we.finallyLoc)}}}},abrupt:function(de,me){for(var ye=this.tryEntries.length-1;ye>=0;--ye){var ge=this.tryEntries[ye];if(ge.tryLoc<=this.prev&&D.call(ge,"finallyLoc")&&this.prev<ge.finallyLoc){var we=ge;break}}we&&(de==="break"||de==="continue")&&we.tryLoc<=me&&me<=we.finallyLoc&&(we=null);var Te=we?we.completion:{};return Te.type=de,Te.arg=me,we?(this.method="next",this.next=we.finallyLoc,z):this.complete(Te)},complete:function(de,me){if(de.type==="throw")throw de.arg;return de.type==="break"||de.type==="continue"?this.next=de.arg:de.type==="return"?(this.rval=this.arg=de.arg,this.method="return",this.next="end"):de.type==="normal"&&me&&(this.next=me),z},finish:function(de){for(var me=this.tryEntries.length-1;me>=0;--me){var ye=this.tryEntries[me];if(ye.finallyLoc===de)return this.complete(ye.completion,ye.afterLoc),le(ye),z}},catch:function(de){for(var me=this.tryEntries.length-1;me>=0;--me){var ye=this.tryEntries[me];if(ye.tryLoc===de){var ge=ye.completion;if(ge.type==="throw"){var we=ge.arg;le(ye)}return we}}throw new Error("illegal catch attempt")},delegateYield:function(de,me,ye){return this.delegate={iterator:_e(de),resultName:me,nextLoc:ye},this.method==="next"&&(this.arg=R),z}},P}w.exports=O,w.exports.__esModule=!0,w.exports.default=w.exports},{"./typeof.js":91}],90:[function(_,w,B){var A=_("./arrayWithoutHoles.js"),O=_("./iterableToArray.js"),R=_("./unsupportedIterableToArray.js"),P=_("./nonIterableSpread.js");function E(D){return A(D)||O(D)||R(D)||P()}w.exports=E,w.exports.__esModule=!0,w.exports.default=w.exports},{"./arrayWithoutHoles.js":84,"./iterableToArray.js":87,"./nonIterableSpread.js":88,"./unsupportedIterableToArray.js":92}],91:[function(_,w,B){function A(O){"@babel/helpers - typeof";return w.exports=A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},w.exports.__esModule=!0,w.exports.default=w.exports,A(O)}w.exports=A,w.exports.__esModule=!0,w.exports.default=w.exports},{}],92:[function(_,w,B){var A=_("./arrayLikeToArray.js");function O(R,P){if(R){if(typeof R=="string")return A(R,P);var E=Object.prototype.toString.call(R).slice(8,-1);if(E==="Object"&&R.constructor&&(E=R.constructor.name),E==="Map"||E==="Set")return Array.from(R);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return A(R,P)}}w.exports=O,w.exports.__esModule=!0,w.exports.default=w.exports},{"./arrayLikeToArray.js":83}],93:[function(_,w,B){var A=_("../helpers/regeneratorRuntime")();w.exports=A;try{regeneratorRuntime=A}catch(O){typeof globalThis=="object"?globalThis.regeneratorRuntime=A:Function("r","regeneratorRuntime = r")(A)}},{"../helpers/regeneratorRuntime":89}],94:[function(_,w,B){w.exports=A,w.exports.HttpsAgent=A;function A(){}},{}],95:[function(_,w,B){(function(A){(function(){var O=_("object.assign/polyfill")();/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function R(he,pe){if(he===pe)return 0;for(var K=he.length,ue=pe.length,le=0,ce=Math.min(K,ue);le<ce;++le)if(he[le]!==pe[le]){K=he[le],ue=pe[le];break}return K<ue?-1:ue<K?1:0}function P(he){return A.Buffer&&typeof A.Buffer.isBuffer=="function"?A.Buffer.isBuffer(he):!!(he!=null&&he._isBuffer)}var E=_("util/"),D=Object.prototype.hasOwnProperty,I=Array.prototype.slice,M=function(){return(function(){}).name==="foo"}();function N(he){return Object.prototype.toString.call(he)}function k(he){return P(he)||typeof A.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(he):he?!!(he instanceof DataView||he.buffer&&he.buffer instanceof ArrayBuffer):!1}var F=w.exports=Y,G=/\s*function\s+([^\(\s]*)\s*/;function V(he){if(E.isFunction(he)){if(M)return he.name;var pe=he.toString(),K=pe.match(G);return K&&K[1]}}F.AssertionError=function(pe){this.name="AssertionError",this.actual=pe.actual,this.expected=pe.expected,this.operator=pe.operator,pe.message?(this.message=pe.message,this.generatedMessage=!1):(this.message=U(this),this.generatedMessage=!0);var K=pe.stackStartFunction||X;if(Error.captureStackTrace)Error.captureStackTrace(this,K);else{var ue=new Error;if(ue.stack){var le=ue.stack,ce=V(K),_e=le.indexOf("\n"+ce);if(_e>=0){var oe=le.indexOf("\n",_e+1);le=le.substring(oe+1)}this.stack=le}}},E.inherits(F.AssertionError,Error);function j(he,pe){return typeof he=="string"?he.length<pe?he:he.slice(0,pe):he}function H(he){if(M||!E.isFunction(he))return E.inspect(he);var pe=V(he),K=pe?": "+pe:"";return"[Function"+K+"]"}function U(he){return j(H(he.actual),128)+" "+he.operator+" "+j(H(he.expected),128)}function X(he,pe,K,ue,le){throw new F.AssertionError({message:K,actual:he,expected:pe,operator:ue,stackStartFunction:le})}F.fail=X;function Y(he,pe){he||X(he,!0,pe,"==",F.ok)}F.ok=Y,F.equal=function(pe,K,ue){pe!=K&&X(pe,K,ue,"==",F.equal)},F.notEqual=function(pe,K,ue){pe==K&&X(pe,K,ue,"!=",F.notEqual)},F.deepEqual=function(pe,K,ue){z(pe,K,!1)||X(pe,K,ue,"deepEqual",F.deepEqual)},F.deepStrictEqual=function(pe,K,ue){z(pe,K,!0)||X(pe,K,ue,"deepStrictEqual",F.deepStrictEqual)};function z(he,pe,K,ue){if(he===pe)return!0;if(P(he)&&P(pe))return R(he,pe)===0;if(E.isDate(he)&&E.isDate(pe))return he.getTime()===pe.getTime();if(E.isRegExp(he)&&E.isRegExp(pe))return he.source===pe.source&&he.global===pe.global&&he.multiline===pe.multiline&&he.lastIndex===pe.lastIndex&&he.ignoreCase===pe.ignoreCase;if((he===null||typeof he!="object")&&(pe===null||typeof pe!="object"))return K?he===pe:he==pe;if(k(he)&&k(pe)&&N(he)===N(pe)&&!(he instanceof Float32Array||he instanceof Float64Array))return R(new Uint8Array(he.buffer),new Uint8Array(pe.buffer))===0;if(P(he)!==P(pe))return!1;ue=ue||{actual:[],expected:[]};var le=ue.actual.indexOf(he);return le!==-1&&le===ue.expected.indexOf(pe)?!0:(ue.actual.push(he),ue.expected.push(pe),Z(he,pe,K,ue))}function W(he){return Object.prototype.toString.call(he)=="[object Arguments]"}function Z(he,pe,K,ue){if(he==null||pe===null||pe===void 0)return!1;if(E.isPrimitive(he)||E.isPrimitive(pe))return he===pe;if(K&&Object.getPrototypeOf(he)!==Object.getPrototypeOf(pe))return!1;var le=W(he),ce=W(pe);if(le&&!ce||!le&&ce)return!1;if(le)return he=I.call(he),pe=I.call(pe),z(he,pe,K);var _e=ne(he),oe=ne(pe),de,me;if(_e.length!==oe.length)return!1;for(_e.sort(),oe.sort(),me=_e.length-1;me>=0;me--)if(_e[me]!==oe[me])return!1;for(me=_e.length-1;me>=0;me--)if(de=_e[me],!z(he[de],pe[de],K,ue))return!1;return!0}F.notDeepEqual=function(pe,K,ue){z(pe,K,!1)&&X(pe,K,ue,"notDeepEqual",F.notDeepEqual)},F.notDeepStrictEqual=Q;function Q(he,pe,K){z(he,pe,!0)&&X(he,pe,K,"notDeepStrictEqual",Q)}F.strictEqual=function(pe,K,ue){pe!==K&&X(pe,K,ue,"===",F.strictEqual)},F.notStrictEqual=function(pe,K,ue){pe===K&&X(pe,K,ue,"!==",F.notStrictEqual)};function ee(he,pe){if(!he||!pe)return!1;if(Object.prototype.toString.call(pe)=="[object RegExp]")return pe.test(he);try{if(he instanceof pe)return!0}catch(K){}return Error.isPrototypeOf(pe)?!1:pe.call({},he)===!0}function te(he){var pe;try{he()}catch(K){pe=K}return pe}function re(he,pe,K,ue){var le;if(typeof pe!="function")throw new TypeError('"block" argument must be a function');typeof K=="string"&&(ue=K,K=null),le=te(pe),ue=(K&&K.name?" ("+K.name+").":".")+(ue?" "+ue:"."),he&&!le&&X(le,K,"Missing expected exception"+ue);var ce=typeof ue=="string",_e=!he&&E.isError(le),oe=!he&&le&&!K;if((_e&&ce&&ee(le,K)||oe)&&X(le,K,"Got unwanted exception"+ue),he&&le&&K&&!ee(le,K)||!he&&le)throw le}F.throws=function(he,pe,K){re(!0,he,pe,K)},F.doesNotThrow=function(he,pe,K){re(!1,he,pe,K)},F.ifError=function(he){if(he)throw he};function ie(he,pe){he||X(he,!0,pe,"==",ie)}F.strict=O(ie,F,{equal:F.strictEqual,deepEqual:F.deepStrictEqual,notEqual:F.notStrictEqual,notDeepEqual:F.notDeepStrictEqual}),F.strict.strict=F.strict;var ne=Object.keys||function(he){var pe=[];for(var K in he)D.call(he,K)&&pe.push(K);return pe}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"object.assign/polyfill":438,"util/":98}],96:[function(_,w,B){typeof Object.create=="function"?w.exports=function(O,R){O.super_=R,O.prototype=Object.create(R.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}})}:w.exports=function(O,R){O.super_=R;var P=function(){};P.prototype=R.prototype,O.prototype=new P,O.prototype.constructor=O}},{}],97:[function(_,w,B){w.exports=function(O){return O&&typeof O=="object"&&typeof O.copy=="function"&&typeof O.fill=="function"&&typeof O.readUInt8=="function"}},{}],98:[function(_,w,B){(function(A,O){(function(){var R=/%[sdj%]/g;B.format=function(oe){if(!Z(oe)){for(var de=[],me=0;me<arguments.length;me++)de.push(D(arguments[me]));return de.join(" ")}for(var me=1,ye=arguments,ge=ye.length,we=String(oe).replace(R,function(Ee){if(Ee==="%%")return"%";if(me>=ge)return Ee;switch(Ee){case"%s":return String(ye[me++]);case"%d":return Number(ye[me++]);case"%j":try{return JSON.stringify(ye[me++])}catch(De){return"[Circular]"}default:return Ee}}),Te=ye[me];me<ge;Te=ye[++me])Y(Te)||!re(Te)?we+=" "+Te:we+=" "+D(Te);return we},B.deprecate=function(oe,de){if(ee(O.process))return function(){return B.deprecate(oe,de).apply(this,arguments)};if(A.noDeprecation===!0)return oe;var me=!1;function ye(){if(!me){if(A.throwDeprecation)throw new Error(de);A.traceDeprecation?console.trace(de):console.error(de),me=!0}return oe.apply(this,arguments)}return ye};var P={},E;B.debuglog=function(oe){if(ee(E)&&(E=A.env.NODE_DEBUG||""),oe=oe.toUpperCase(),!P[oe])if(new RegExp("\\b"+oe+"\\b","i").test(E)){var de=A.pid;P[oe]=function(){var me=B.format.apply(B,arguments);console.error("%s %d: %s",oe,de,me)}}else P[oe]=function(){};return P[oe]};function D(oe,de){var me={seen:[],stylize:M};return arguments.length>=3&&(me.depth=arguments[2]),arguments.length>=4&&(me.colors=arguments[3]),X(de)?me.showHidden=de:de&&B._extend(me,de),ee(me.showHidden)&&(me.showHidden=!1),ee(me.depth)&&(me.depth=2),ee(me.colors)&&(me.colors=!1),ee(me.customInspect)&&(me.customInspect=!0),me.colors&&(me.stylize=I),k(me,oe,me.depth)}B.inspect=D,D.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},D.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function I(oe,de){var me=D.styles[de];return me?"\x1B["+D.colors[me][0]+"m"+oe+"\x1B["+D.colors[me][1]+"m":oe}function M(oe,de){return oe}function N(oe){var de={};return oe.forEach(function(me,ye){de[me]=!0}),de}function k(oe,de,me){if(oe.customInspect&&de&&he(de.inspect)&&de.inspect!==B.inspect&&!(de.constructor&&de.constructor.prototype===de)){var ye=de.inspect(me,oe);return Z(ye)||(ye=k(oe,ye,me)),ye}var ge=F(oe,de);if(ge)return ge;var we=Object.keys(de),Te=N(we);if(oe.showHidden&&(we=Object.getOwnPropertyNames(de)),ne(de)&&(we.indexOf("message")>=0||we.indexOf("description")>=0))return G(de);if(we.length===0){if(he(de)){var Ee=de.name?": "+de.name:"";return oe.stylize("[Function"+Ee+"]","special")}if(te(de))return oe.stylize(RegExp.prototype.toString.call(de),"regexp");if(ie(de))return oe.stylize(Date.prototype.toString.call(de),"date");if(ne(de))return G(de)}var De="",fe=!1,Ce=["{","}"];if(U(de)&&(fe=!0,Ce=["[","]"]),he(de)){var Se=de.name?": "+de.name:"";De=" [Function"+Se+"]"}if(te(de)&&(De=" "+RegExp.prototype.toString.call(de)),ie(de)&&(De=" "+Date.prototype.toUTCString.call(de)),ne(de)&&(De=" "+G(de)),we.length===0&&(!fe||de.length==0))return Ce[0]+De+Ce[1];if(me<0)return te(de)?oe.stylize(RegExp.prototype.toString.call(de),"regexp"):oe.stylize("[Object]","special");oe.seen.push(de);var be;return fe?be=V(oe,de,me,Te,we):be=we.map(function(Re){return j(oe,de,me,Te,Re,fe)}),oe.seen.pop(),H(be,De,Ce)}function F(oe,de){if(ee(de))return oe.stylize("undefined","undefined");if(Z(de)){var me="'"+JSON.stringify(de).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return oe.stylize(me,"string")}if(W(de))return oe.stylize(""+de,"number");if(X(de))return oe.stylize(""+de,"boolean");if(Y(de))return oe.stylize("null","null")}function G(oe){return"["+Error.prototype.toString.call(oe)+"]"}function V(oe,de,me,ye,ge){for(var we=[],Te=0,Ee=de.length;Te<Ee;++Te)_e(de,String(Te))?we.push(j(oe,de,me,ye,String(Te),!0)):we.push("");return ge.forEach(function(De){De.match(/^\d+$/)||we.push(j(oe,de,me,ye,De,!0))}),we}function j(oe,de,me,ye,ge,we){var Te,Ee,De;if(De=Object.getOwnPropertyDescriptor(de,ge)||{value:de[ge]},De.get?De.set?Ee=oe.stylize("[Getter/Setter]","special"):Ee=oe.stylize("[Getter]","special"):De.set&&(Ee=oe.stylize("[Setter]","special")),_e(ye,ge)||(Te="["+ge+"]"),Ee||(oe.seen.indexOf(De.value)<0?(Y(me)?Ee=k(oe,De.value,null):Ee=k(oe,De.value,me-1),Ee.indexOf("\n")>-1&&(we?Ee=Ee.split("\n").map(function(fe){return"  "+fe}).join("\n").substr(2):Ee="\n"+Ee.split("\n").map(function(fe){return"   "+fe}).join("\n"))):Ee=oe.stylize("[Circular]","special")),ee(Te)){if(we&&ge.match(/^\d+$/))return Ee;Te=JSON.stringify(""+ge),Te.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Te=Te.substr(1,Te.length-2),Te=oe.stylize(Te,"name")):(Te=Te.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Te=oe.stylize(Te,"string"))}return Te+": "+Ee}function H(oe,de,me){var ye=oe.reduce(function(ge,we){return we.indexOf("\n")>=0,ge+we.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ye>60?me[0]+(de===""?"":de+"\n ")+" "+oe.join(",\n  ")+" "+me[1]:me[0]+de+" "+oe.join(", ")+" "+me[1]}function U(oe){return Array.isArray(oe)}B.isArray=U;function X(oe){return typeof oe=="boolean"}B.isBoolean=X;function Y(oe){return oe===null}B.isNull=Y;function z(oe){return oe==null}B.isNullOrUndefined=z;function W(oe){return typeof oe=="number"}B.isNumber=W;function Z(oe){return typeof oe=="string"}B.isString=Z;function Q(oe){return typeof oe=="symbol"}B.isSymbol=Q;function ee(oe){return oe===void 0}B.isUndefined=ee;function te(oe){return re(oe)&&K(oe)==="[object RegExp]"}B.isRegExp=te;function re(oe){return typeof oe=="object"&&oe!==null}B.isObject=re;function ie(oe){return re(oe)&&K(oe)==="[object Date]"}B.isDate=ie;function ne(oe){return re(oe)&&(K(oe)==="[object Error]"||oe instanceof Error)}B.isError=ne;function he(oe){return typeof oe=="function"}B.isFunction=he;function pe(oe){return oe===null||typeof oe=="boolean"||typeof oe=="number"||typeof oe=="string"||typeof oe=="symbol"||typeof oe>"u"}B.isPrimitive=pe,B.isBuffer=_("./support/isBuffer");function K(oe){return Object.prototype.toString.call(oe)}function ue(oe){return oe<10?"0"+oe.toString(10):oe.toString(10)}var le=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ce(){var oe=new Date,de=[ue(oe.getHours()),ue(oe.getMinutes()),ue(oe.getSeconds())].join(":");return[oe.getDate(),le[oe.getMonth()],de].join(" ")}B.log=function(){console.log("%s - %s",ce(),B.format.apply(B,arguments))},B.inherits=_("inherits"),B._extend=function(oe,de){if(!de||!re(de))return oe;for(var me=Object.keys(de),ye=me.length;ye--;)oe[me[ye]]=de[me[ye]];return oe};function _e(oe,de){return Object.prototype.hasOwnProperty.call(oe,de)}}).call(this)}).call(this,_("_process"),typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":97,_process:538,inherits:96}],99:[function(_,w,B){(function(A){(function(){var O=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],R=typeof globalThis>"u"?A:globalThis;w.exports=function(){for(var E=[],D=0;D<O.length;D++)typeof R[O[D]]=="function"&&(E[E.length]=O[D]);return E}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],100:[function(_,w,B){B.byteLength=M,B.toByteArray=k,B.fromByteArray=V;for(var A=[],O=[],R=typeof Uint8Array<"u"?Uint8Array:Array,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E=0,D=P.length;E<D;++E)A[E]=P[E],O[P.charCodeAt(E)]=E;O[45]=62,O[95]=63;function I(j){var H=j.length;if(H%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var U=j.indexOf("=");U===-1&&(U=H);var X=U===H?0:4-U%4;return[U,X]}function M(j){var H=I(j),U=H[0],X=H[1];return(U+X)*3/4-X}function N(j,H,U){return(H+U)*3/4-U}function k(j){var H,U=I(j),X=U[0],Y=U[1],z=new R(N(j,X,Y)),W=0,Z=Y>0?X-4:X,Q;for(Q=0;Q<Z;Q+=4)H=O[j.charCodeAt(Q)]<<18|O[j.charCodeAt(Q+1)]<<12|O[j.charCodeAt(Q+2)]<<6|O[j.charCodeAt(Q+3)],z[W++]=H>>16&255,z[W++]=H>>8&255,z[W++]=H&255;return Y===2&&(H=O[j.charCodeAt(Q)]<<2|O[j.charCodeAt(Q+1)]>>4,z[W++]=H&255),Y===1&&(H=O[j.charCodeAt(Q)]<<10|O[j.charCodeAt(Q+1)]<<4|O[j.charCodeAt(Q+2)]>>2,z[W++]=H>>8&255,z[W++]=H&255),z}function F(j){return A[j>>18&63]+A[j>>12&63]+A[j>>6&63]+A[j&63]}function G(j,H,U){for(var X,Y=[],z=H;z<U;z+=3)X=(j[z]<<16&16711680)+(j[z+1]<<8&65280)+(j[z+2]&255),Y.push(F(X));return Y.join("")}function V(j){for(var H,U=j.length,X=U%3,Y=[],z=16383,W=0,Z=U-X;W<Z;W+=z)Y.push(G(j,W,W+z>Z?Z:W+z));return X===1?(H=j[U-1],Y.push(A[H>>2]+A[H<<4&63]+"==")):X===2&&(H=(j[U-2]<<8)+j[U-1],Y.push(A[H>>10]+A[H>>4&63]+A[H<<2&63]+"=")),Y.join("")}},{}],101:[function(_,w,B){/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */(function(A,O,R){typeof w<"u"&&w.exports?w.exports=R():A[O]=R()})(this,"bowser",function(){var A=!0;function O(N){function k(oe){var de=N.match(oe);return de&&de.length>1&&de[1]||""}function F(oe){var de=N.match(oe);return de&&de.length>1&&de[2]||""}var G=k(/(ipod|iphone|ipad)/i).toLowerCase(),V=/like android/i.test(N),j=!V&&/android/i.test(N),H=/nexus\s*[0-6]\s*/i.test(N),U=!H&&/nexus\s*[0-9]+/i.test(N),X=/CrOS/.test(N),Y=/silk/i.test(N),z=/sailfish/i.test(N),W=/tizen/i.test(N),Z=/(web|hpw)(o|0)s/i.test(N),Q=/windows phone/i.test(N),ee=!Q&&/windows/i.test(N),te=!G&&!Y&&/macintosh/i.test(N),re=!j&&!z&&!W&&!Z&&/linux/i.test(N),ie=F(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),ne=k(/version\/(\d+(\.\d+)?)/i),he=/tablet/i.test(N)&&!/tablet pc/i.test(N),pe=!he&&/[^-]mobi/i.test(N),K=/xbox/i.test(N),ue;/opera/i.test(N)?ue={name:"Opera",opera:A,version:ne||k(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(N)?ue={name:"Opera",opera:A,version:k(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||ne}:/SamsungBrowser/i.test(N)?ue={name:"Samsung Internet for Android",samsungBrowser:A,version:ne||k(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(N)?ue={name:"NAVER Whale browser",whale:A,version:k(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(N)?ue={name:"MZ Browser",mzbrowser:A,version:k(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(N)?ue={name:"Opera Coast",coast:A,version:ne||k(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(N)?ue={name:"Focus",focus:A,version:k(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(N)?ue={name:"Yandex Browser",yandexbrowser:A,version:ne||k(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(N)?ue={name:"UC Browser",ucbrowser:A,version:k(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(N)?ue={name:"Maxthon",maxthon:A,version:k(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(N)?ue={name:"Epiphany",epiphany:A,version:k(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(N)?ue={name:"Puffin",puffin:A,version:k(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(N)?ue={name:"Sleipnir",sleipnir:A,version:k(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(N)?ue={name:"K-Meleon",kMeleon:A,version:k(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:Q?(ue={name:"Windows Phone",osname:"Windows Phone",windowsphone:A},ie?(ue.msedge=A,ue.version=ie):(ue.msie=A,ue.version=k(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(N)?ue={name:"Internet Explorer",msie:A,version:k(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:X?ue={name:"Chrome",osname:"Chrome OS",chromeos:A,chromeBook:A,chrome:A,version:k(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(N)?ue={name:"Microsoft Edge",msedge:A,version:ie}:/vivaldi/i.test(N)?ue={name:"Vivaldi",vivaldi:A,version:k(/vivaldi\/(\d+(\.\d+)?)/i)||ne}:z?ue={name:"Sailfish",osname:"Sailfish OS",sailfish:A,version:k(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(N)?ue={name:"SeaMonkey",seamonkey:A,version:k(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(N)?(ue={name:"Firefox",firefox:A,version:k(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(N)&&(ue.firefoxos=A,ue.osname="Firefox OS")):Y?ue={name:"Amazon Silk",silk:A,version:k(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(N)?ue={name:"PhantomJS",phantom:A,version:k(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(N)?ue={name:"SlimerJS",slimer:A,version:k(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(N)||/rim\stablet/i.test(N)?ue={name:"BlackBerry",osname:"BlackBerry OS",blackberry:A,version:ne||k(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:Z?(ue={name:"WebOS",osname:"WebOS",webos:A,version:ne||k(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(N)&&(ue.touchpad=A)):/bada/i.test(N)?ue={name:"Bada",osname:"Bada",bada:A,version:k(/dolfin\/(\d+(\.\d+)?)/i)}:W?ue={name:"Tizen",osname:"Tizen",tizen:A,version:k(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||ne}:/qupzilla/i.test(N)?ue={name:"QupZilla",qupzilla:A,version:k(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||ne}:/chromium/i.test(N)?ue={name:"Chromium",chromium:A,version:k(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||ne}:/chrome|crios|crmo/i.test(N)?ue={name:"Chrome",chrome:A,version:k(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:j?ue={name:"Android",version:ne}:/safari|applewebkit/i.test(N)?(ue={name:"Safari",safari:A},ne&&(ue.version=ne)):G?(ue={name:G=="iphone"?"iPhone":G=="ipad"?"iPad":"iPod"},ne&&(ue.version=ne)):/googlebot/i.test(N)?ue={name:"Googlebot",googlebot:A,version:k(/googlebot\/(\d+(\.\d+))/i)||ne}:ue={name:k(/^(.*)\/(.*) /),version:F(/^(.*)\/(.*) /)},!ue.msedge&&/(apple)?webkit/i.test(N)?(/(apple)?webkit\/537\.36/i.test(N)?(ue.name=ue.name||"Blink",ue.blink=A):(ue.name=ue.name||"Webkit",ue.webkit=A),!ue.version&&ne&&(ue.version=ne)):!ue.opera&&/gecko\//i.test(N)&&(ue.name=ue.name||"Gecko",ue.gecko=A,ue.version=ue.version||k(/gecko\/(\d+(\.\d+)?)/i)),!ue.windowsphone&&(j||ue.silk)?(ue.android=A,ue.osname="Android"):!ue.windowsphone&&G?(ue[G]=A,ue.ios=A,ue.osname="iOS"):te?(ue.mac=A,ue.osname="macOS"):K?(ue.xbox=A,ue.osname="Xbox"):ee?(ue.windows=A,ue.osname="Windows"):re&&(ue.linux=A,ue.osname="Linux");function le(oe){switch(oe){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}var ce="";ue.windows?ce=le(k(/Windows ((NT|XP)( \d\d?.\d)?)/i)):ue.windowsphone?ce=k(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):ue.mac?(ce=k(/Mac OS X (\d+([_\.\s]\d+)*)/i),ce=ce.replace(/[_\s]/g,".")):G?(ce=k(/os (\d+([_\s]\d+)*) like mac os x/i),ce=ce.replace(/[_\s]/g,".")):j?ce=k(/android[ \/-](\d+(\.\d+)*)/i):ue.webos?ce=k(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):ue.blackberry?ce=k(/rim\stablet\sos\s(\d+(\.\d+)*)/i):ue.bada?ce=k(/bada\/(\d+(\.\d+)*)/i):ue.tizen&&(ce=k(/tizen[\/\s](\d+(\.\d+)*)/i)),ce&&(ue.osversion=ce);var _e=!ue.windows&&ce.split(".")[0];return he||U||G=="ipad"||j&&(_e==3||_e>=4&&!pe)||ue.silk?ue.tablet=A:(pe||G=="iphone"||G=="ipod"||j||H||ue.blackberry||ue.webos||ue.bada)&&(ue.mobile=A),ue.msedge||ue.msie&&ue.version>=10||ue.yandexbrowser&&ue.version>=15||ue.vivaldi&&ue.version>=1||ue.chrome&&ue.version>=20||ue.samsungBrowser&&ue.version>=4||ue.whale&&D([ue.version,"1.0"])===1||ue.mzbrowser&&D([ue.version,"6.0"])===1||ue.focus&&D([ue.version,"1.0"])===1||ue.firefox&&ue.version>=20||ue.safari&&ue.version>=6||ue.opera&&ue.version>=10||ue.ios&&ue.osversion&&ue.osversion.split(".")[0]>=6||ue.blackberry&&ue.version>=10.1||ue.chromium&&ue.version>=20?ue.a=A:ue.msie&&ue.version<10||ue.chrome&&ue.version<20||ue.firefox&&ue.version<20||ue.safari&&ue.version<6||ue.opera&&ue.version<10||ue.ios&&ue.osversion&&ue.osversion.split(".")[0]<6||ue.chromium&&ue.version<20?ue.c=A:ue.x=A,ue}var R=O(typeof navigator<"u"&&navigator.userAgent||"");R.test=function(N){for(var k=0;k<N.length;++k){var F=N[k];if(typeof F=="string"&&F in R)return!0}return!1};function P(N){return N.split(".").length}function E(N,k){var F=[],G;if(Array.prototype.map)return Array.prototype.map.call(N,k);for(G=0;G<N.length;G++)F.push(k(N[G]));return F}function D(N){for(var k=Math.max(P(N[0]),P(N[1])),F=E(N,function(G){var V=k-P(G);return G=G+new Array(V+1).join(".0"),E(G.split("."),function(j){return new Array(20-j.length).join("0")+j}).reverse()});--k>=0;){if(F[0][k]>F[1][k])return 1;if(F[0][k]===F[1][k]){if(k===0)return 0}else return-1}}function I(N,k,F){var G=R;typeof k=="string"&&(F=k,k=void 0),k===void 0&&(k=!1),F&&(G=O(F));var V=""+G.version;for(var j in N)if(N.hasOwnProperty(j)&&G[j]){if(typeof N[j]!="string")throw new Error("Browser version in the minVersion map should be a string: "+j+": "+String(N));return D([V,N[j]])<0}return k}function M(N,k,F){return!I(N,k,F)}return R.isUnsupportedBrowser=I,R.compareVersions=D,R.check=M,R._detect=O,R.detect=O,R})},{}],102:[function(_,w,B){},{}],103:[function(_,w,B){(function(A){(function(){var O=_("base64-js"),R=_("ieee754");B.Buffer=I,B.SlowBuffer=X,B.INSPECT_MAX_BYTES=50;var P=2147483647;B.kMaxLength=P,I.TYPED_ARRAY_SUPPORT=E(),!I.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function E(){try{var Ne=new Uint8Array(1);return Ne.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},Ne.foo()===42}catch(Ae){return!1}}Object.defineProperty(I.prototype,"parent",{enumerable:!0,get:function(){if(I.isBuffer(this))return this.buffer}}),Object.defineProperty(I.prototype,"offset",{enumerable:!0,get:function(){if(I.isBuffer(this))return this.byteOffset}});function D(Ne){if(Ne>P)throw new RangeError('The value "'+Ne+'" is invalid for option "size"');var Ae=new Uint8Array(Ne);return Ae.__proto__=I.prototype,Ae}function I(Ne,Ae,Oe){if(typeof Ne=="number"){if(typeof Ae=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return F(Ne)}return M(Ne,Ae,Oe)}typeof Symbol<"u"&&Symbol.species!=null&&I[Symbol.species]===I&&Object.defineProperty(I,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),I.poolSize=8192;function M(Ne,Ae,Oe){if(typeof Ne=="string")return G(Ne,Ae);if(ArrayBuffer.isView(Ne))return V(Ne);if(Ne==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ne);if(Pe(Ne,ArrayBuffer)||Ne&&Pe(Ne.buffer,ArrayBuffer))return j(Ne,Ae,Oe);if(typeof Ne=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Fe=Ne.valueOf&&Ne.valueOf();if(Fe!=null&&Fe!==Ne)return I.from(Fe,Ae,Oe);var nt=H(Ne);if(nt)return nt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Ne[Symbol.toPrimitive]=="function")return I.from(Ne[Symbol.toPrimitive]("string"),Ae,Oe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ne)}I.from=function(Ne,Ae,Oe){return M(Ne,Ae,Oe)},I.prototype.__proto__=Uint8Array.prototype,I.__proto__=Uint8Array;function N(Ne){if(typeof Ne!="number")throw new TypeError('"size" argument must be of type number');if(Ne<0)throw new RangeError('The value "'+Ne+'" is invalid for option "size"')}function k(Ne,Ae,Oe){return N(Ne),Ne<=0?D(Ne):Ae!==void 0?typeof Oe=="string"?D(Ne).fill(Ae,Oe):D(Ne).fill(Ae):D(Ne)}I.alloc=function(Ne,Ae,Oe){return k(Ne,Ae,Oe)};function F(Ne){return N(Ne),D(Ne<0?0:U(Ne)|0)}I.allocUnsafe=function(Ne){return F(Ne)},I.allocUnsafeSlow=function(Ne){return F(Ne)};function G(Ne,Ae){if((typeof Ae!="string"||Ae==="")&&(Ae="utf8"),!I.isEncoding(Ae))throw new TypeError("Unknown encoding: "+Ae);var Oe=Y(Ne,Ae)|0,Fe=D(Oe),nt=Fe.write(Ne,Ae);return nt!==Oe&&(Fe=Fe.slice(0,nt)),Fe}function V(Ne){for(var Ae=Ne.length<0?0:U(Ne.length)|0,Oe=D(Ae),Fe=0;Fe<Ae;Fe+=1)Oe[Fe]=Ne[Fe]&255;return Oe}function j(Ne,Ae,Oe){if(Ae<0||Ne.byteLength<Ae)throw new RangeError('"offset" is outside of buffer bounds');if(Ne.byteLength<Ae+(Oe||0))throw new RangeError('"length" is outside of buffer bounds');var Fe;return Ae===void 0&&Oe===void 0?Fe=new Uint8Array(Ne):Oe===void 0?Fe=new Uint8Array(Ne,Ae):Fe=new Uint8Array(Ne,Ae,Oe),Fe.__proto__=I.prototype,Fe}function H(Ne){if(I.isBuffer(Ne)){var Ae=U(Ne.length)|0,Oe=D(Ae);return Oe.length===0||Ne.copy(Oe,0,0,Ae),Oe}if(Ne.length!==void 0)return typeof Ne.length!="number"||ke(Ne.length)?D(0):V(Ne);if(Ne.type==="Buffer"&&Array.isArray(Ne.data))return V(Ne.data)}function U(Ne){if(Ne>=P)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+P.toString(16)+" bytes");return Ne|0}function X(Ne){return+Ne!=Ne&&(Ne=0),I.alloc(+Ne)}I.isBuffer=function(Ae){return Ae!=null&&Ae._isBuffer===!0&&Ae!==I.prototype},I.compare=function(Ae,Oe){if(Pe(Ae,Uint8Array)&&(Ae=I.from(Ae,Ae.offset,Ae.byteLength)),Pe(Oe,Uint8Array)&&(Oe=I.from(Oe,Oe.offset,Oe.byteLength)),!I.isBuffer(Ae)||!I.isBuffer(Oe))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Ae===Oe)return 0;for(var Fe=Ae.length,nt=Oe.length,Ze=0,Xe=Math.min(Fe,nt);Ze<Xe;++Ze)if(Ae[Ze]!==Oe[Ze]){Fe=Ae[Ze],nt=Oe[Ze];break}return Fe<nt?-1:nt<Fe?1:0},I.isEncoding=function(Ae){switch(String(Ae).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},I.concat=function(Ae,Oe){if(!Array.isArray(Ae))throw new TypeError('"list" argument must be an Array of Buffers');if(Ae.length===0)return I.alloc(0);var Fe;if(Oe===void 0)for(Oe=0,Fe=0;Fe<Ae.length;++Fe)Oe+=Ae[Fe].length;var nt=I.allocUnsafe(Oe),Ze=0;for(Fe=0;Fe<Ae.length;++Fe){var Xe=Ae[Fe];if(Pe(Xe,Uint8Array)&&(Xe=I.from(Xe)),!I.isBuffer(Xe))throw new TypeError('"list" argument must be an Array of Buffers');Xe.copy(nt,Ze),Ze+=Xe.length}return nt};function Y(Ne,Ae){if(I.isBuffer(Ne))return Ne.length;if(ArrayBuffer.isView(Ne)||Pe(Ne,ArrayBuffer))return Ne.byteLength;if(typeof Ne!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ne);var Oe=Ne.length,Fe=arguments.length>2&&arguments[2]===!0;if(!Fe&&Oe===0)return 0;for(var nt=!1;;)switch(Ae){case"ascii":case"latin1":case"binary":return Oe;case"utf8":case"utf-8":return Ce(Ne).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe*2;case"hex":return Oe>>>1;case"base64":return Re(Ne).length;default:if(nt)return Fe?-1:Ce(Ne).length;Ae=(""+Ae).toLowerCase(),nt=!0}}I.byteLength=Y;function z(Ne,Ae,Oe){var Fe=!1;if((Ae===void 0||Ae<0)&&(Ae=0),Ae>this.length||((Oe===void 0||Oe>this.length)&&(Oe=this.length),Oe<=0)||(Oe>>>=0,Ae>>>=0,Oe<=Ae))return"";for(Ne||(Ne="utf8");;)switch(Ne){case"hex":return oe(this,Ae,Oe);case"utf8":case"utf-8":return K(this,Ae,Oe);case"ascii":return ce(this,Ae,Oe);case"latin1":case"binary":return _e(this,Ae,Oe);case"base64":return pe(this,Ae,Oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return de(this,Ae,Oe);default:if(Fe)throw new TypeError("Unknown encoding: "+Ne);Ne=(Ne+"").toLowerCase(),Fe=!0}}I.prototype._isBuffer=!0;function W(Ne,Ae,Oe){var Fe=Ne[Ae];Ne[Ae]=Ne[Oe],Ne[Oe]=Fe}I.prototype.swap16=function(){var Ae=this.length;if(Ae%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Oe=0;Oe<Ae;Oe+=2)W(this,Oe,Oe+1);return this},I.prototype.swap32=function(){var Ae=this.length;if(Ae%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Oe=0;Oe<Ae;Oe+=4)W(this,Oe,Oe+3),W(this,Oe+1,Oe+2);return this},I.prototype.swap64=function(){var Ae=this.length;if(Ae%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Oe=0;Oe<Ae;Oe+=8)W(this,Oe,Oe+7),W(this,Oe+1,Oe+6),W(this,Oe+2,Oe+5),W(this,Oe+3,Oe+4);return this},I.prototype.toString=function(){var Ae=this.length;return Ae===0?"":arguments.length===0?K(this,0,Ae):z.apply(this,arguments)},I.prototype.toLocaleString=I.prototype.toString,I.prototype.equals=function(Ae){if(!I.isBuffer(Ae))throw new TypeError("Argument must be a Buffer");return this===Ae?!0:I.compare(this,Ae)===0},I.prototype.inspect=function(){var Ae="",Oe=B.INSPECT_MAX_BYTES;return Ae=this.toString("hex",0,Oe).replace(/(.{2})/g,"$1 ").trim(),this.length>Oe&&(Ae+=" ... "),"<Buffer "+Ae+">"},I.prototype.compare=function(Ae,Oe,Fe,nt,Ze){if(Pe(Ae,Uint8Array)&&(Ae=I.from(Ae,Ae.offset,Ae.byteLength)),!I.isBuffer(Ae))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Ae);if(Oe===void 0&&(Oe=0),Fe===void 0&&(Fe=Ae?Ae.length:0),nt===void 0&&(nt=0),Ze===void 0&&(Ze=this.length),Oe<0||Fe>Ae.length||nt<0||Ze>this.length)throw new RangeError("out of range index");if(nt>=Ze&&Oe>=Fe)return 0;if(nt>=Ze)return-1;if(Oe>=Fe)return 1;if(Oe>>>=0,Fe>>>=0,nt>>>=0,Ze>>>=0,this===Ae)return 0;for(var Xe=Ze-nt,$e=Fe-Oe,ot=Math.min(Xe,$e),ut=this.slice(nt,Ze),gt=Ae.slice(Oe,Fe),Ue=0;Ue<ot;++Ue)if(ut[Ue]!==gt[Ue]){Xe=ut[Ue],$e=gt[Ue];break}return Xe<$e?-1:$e<Xe?1:0};function Z(Ne,Ae,Oe,Fe,nt){if(Ne.length===0)return-1;if(typeof Oe=="string"?(Fe=Oe,Oe=0):Oe>2147483647?Oe=2147483647:Oe<-2147483648&&(Oe=-2147483648),Oe=+Oe,ke(Oe)&&(Oe=nt?0:Ne.length-1),Oe<0&&(Oe=Ne.length+Oe),Oe>=Ne.length){if(nt)return-1;Oe=Ne.length-1}else if(Oe<0)if(nt)Oe=0;else return-1;if(typeof Ae=="string"&&(Ae=I.from(Ae,Fe)),I.isBuffer(Ae))return Ae.length===0?-1:Q(Ne,Ae,Oe,Fe,nt);if(typeof Ae=="number")return Ae=Ae&255,typeof Uint8Array.prototype.indexOf=="function"?nt?Uint8Array.prototype.indexOf.call(Ne,Ae,Oe):Uint8Array.prototype.lastIndexOf.call(Ne,Ae,Oe):Q(Ne,[Ae],Oe,Fe,nt);throw new TypeError("val must be string, number or Buffer")}function Q(Ne,Ae,Oe,Fe,nt){var Ze=1,Xe=Ne.length,$e=Ae.length;if(Fe!==void 0&&(Fe=String(Fe).toLowerCase(),Fe==="ucs2"||Fe==="ucs-2"||Fe==="utf16le"||Fe==="utf-16le")){if(Ne.length<2||Ae.length<2)return-1;Ze=2,Xe/=2,$e/=2,Oe/=2}function ot(ht,Be){return Ze===1?ht[Be]:ht.readUInt16BE(Be*Ze)}var ut;if(nt){var gt=-1;for(ut=Oe;ut<Xe;ut++)if(ot(Ne,ut)===ot(Ae,gt===-1?0:ut-gt)){if(gt===-1&&(gt=ut),ut-gt+1===$e)return gt*Ze}else gt!==-1&&(ut-=ut-gt),gt=-1}else for(Oe+$e>Xe&&(Oe=Xe-$e),ut=Oe;ut>=0;ut--){for(var Ue=!0,We=0;We<$e;We++)if(ot(Ne,ut+We)!==ot(Ae,We)){Ue=!1;break}if(Ue)return ut}return-1}I.prototype.includes=function(Ae,Oe,Fe){return this.indexOf(Ae,Oe,Fe)!==-1},I.prototype.indexOf=function(Ae,Oe,Fe){return Z(this,Ae,Oe,Fe,!0)},I.prototype.lastIndexOf=function(Ae,Oe,Fe){return Z(this,Ae,Oe,Fe,!1)};function ee(Ne,Ae,Oe,Fe){Oe=Number(Oe)||0;var nt=Ne.length-Oe;Fe?(Fe=Number(Fe),Fe>nt&&(Fe=nt)):Fe=nt;var Ze=Ae.length;Fe>Ze/2&&(Fe=Ze/2);for(var Xe=0;Xe<Fe;++Xe){var $e=parseInt(Ae.substr(Xe*2,2),16);if(ke($e))return Xe;Ne[Oe+Xe]=$e}return Xe}function te(Ne,Ae,Oe,Fe){return Ve(Ce(Ae,Ne.length-Oe),Ne,Oe,Fe)}function re(Ne,Ae,Oe,Fe){return Ve(Se(Ae),Ne,Oe,Fe)}function ie(Ne,Ae,Oe,Fe){return re(Ne,Ae,Oe,Fe)}function ne(Ne,Ae,Oe,Fe){return Ve(Re(Ae),Ne,Oe,Fe)}function he(Ne,Ae,Oe,Fe){return Ve(be(Ae,Ne.length-Oe),Ne,Oe,Fe)}I.prototype.write=function(Ae,Oe,Fe,nt){if(Oe===void 0)nt="utf8",Fe=this.length,Oe=0;else if(Fe===void 0&&typeof Oe=="string")nt=Oe,Fe=this.length,Oe=0;else if(isFinite(Oe))Oe=Oe>>>0,isFinite(Fe)?(Fe=Fe>>>0,nt===void 0&&(nt="utf8")):(nt=Fe,Fe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Ze=this.length-Oe;if((Fe===void 0||Fe>Ze)&&(Fe=Ze),Ae.length>0&&(Fe<0||Oe<0)||Oe>this.length)throw new RangeError("Attempt to write outside buffer bounds");nt||(nt="utf8");for(var Xe=!1;;)switch(nt){case"hex":return ee(this,Ae,Oe,Fe);case"utf8":case"utf-8":return te(this,Ae,Oe,Fe);case"ascii":return re(this,Ae,Oe,Fe);case"latin1":case"binary":return ie(this,Ae,Oe,Fe);case"base64":return ne(this,Ae,Oe,Fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return he(this,Ae,Oe,Fe);default:if(Xe)throw new TypeError("Unknown encoding: "+nt);nt=(""+nt).toLowerCase(),Xe=!0}},I.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function pe(Ne,Ae,Oe){return Ae===0&&Oe===Ne.length?O.fromByteArray(Ne):O.fromByteArray(Ne.slice(Ae,Oe))}function K(Ne,Ae,Oe){Oe=Math.min(Ne.length,Oe);for(var Fe=[],nt=Ae;nt<Oe;){var Ze=Ne[nt],Xe=null,$e=Ze>239?4:Ze>223?3:Ze>191?2:1;if(nt+$e<=Oe){var ot,ut,gt,Ue;switch($e){case 1:Ze<128&&(Xe=Ze);break;case 2:ot=Ne[nt+1],(ot&192)===128&&(Ue=(Ze&31)<<6|ot&63,Ue>127&&(Xe=Ue));break;case 3:ot=Ne[nt+1],ut=Ne[nt+2],(ot&192)===128&&(ut&192)===128&&(Ue=(Ze&15)<<12|(ot&63)<<6|ut&63,Ue>2047&&(Ue<55296||Ue>57343)&&(Xe=Ue));break;case 4:ot=Ne[nt+1],ut=Ne[nt+2],gt=Ne[nt+3],(ot&192)===128&&(ut&192)===128&&(gt&192)===128&&(Ue=(Ze&15)<<18|(ot&63)<<12|(ut&63)<<6|gt&63,Ue>65535&&Ue<1114112&&(Xe=Ue))}}Xe===null?(Xe=65533,$e=1):Xe>65535&&(Xe-=65536,Fe.push(Xe>>>10&1023|55296),Xe=56320|Xe&1023),Fe.push(Xe),nt+=$e}return le(Fe)}var ue=4096;function le(Ne){var Ae=Ne.length;if(Ae<=ue)return String.fromCharCode.apply(String,Ne);for(var Oe="",Fe=0;Fe<Ae;)Oe+=String.fromCharCode.apply(String,Ne.slice(Fe,Fe+=ue));return Oe}function ce(Ne,Ae,Oe){var Fe="";Oe=Math.min(Ne.length,Oe);for(var nt=Ae;nt<Oe;++nt)Fe+=String.fromCharCode(Ne[nt]&127);return Fe}function _e(Ne,Ae,Oe){var Fe="";Oe=Math.min(Ne.length,Oe);for(var nt=Ae;nt<Oe;++nt)Fe+=String.fromCharCode(Ne[nt]);return Fe}function oe(Ne,Ae,Oe){var Fe=Ne.length;(!Ae||Ae<0)&&(Ae=0),(!Oe||Oe<0||Oe>Fe)&&(Oe=Fe);for(var nt="",Ze=Ae;Ze<Oe;++Ze)nt+=fe(Ne[Ze]);return nt}function de(Ne,Ae,Oe){for(var Fe=Ne.slice(Ae,Oe),nt="",Ze=0;Ze<Fe.length;Ze+=2)nt+=String.fromCharCode(Fe[Ze]+Fe[Ze+1]*256);return nt}I.prototype.slice=function(Ae,Oe){var Fe=this.length;Ae=~~Ae,Oe=Oe===void 0?Fe:~~Oe,Ae<0?(Ae+=Fe,Ae<0&&(Ae=0)):Ae>Fe&&(Ae=Fe),Oe<0?(Oe+=Fe,Oe<0&&(Oe=0)):Oe>Fe&&(Oe=Fe),Oe<Ae&&(Oe=Ae);var nt=this.subarray(Ae,Oe);return nt.__proto__=I.prototype,nt};function me(Ne,Ae,Oe){if(Ne%1!==0||Ne<0)throw new RangeError("offset is not uint");if(Ne+Ae>Oe)throw new RangeError("Trying to access beyond buffer length")}I.prototype.readUIntLE=function(Ae,Oe,Fe){Ae=Ae>>>0,Oe=Oe>>>0,Fe||me(Ae,Oe,this.length);for(var nt=this[Ae],Ze=1,Xe=0;++Xe<Oe&&(Ze*=256);)nt+=this[Ae+Xe]*Ze;return nt},I.prototype.readUIntBE=function(Ae,Oe,Fe){Ae=Ae>>>0,Oe=Oe>>>0,Fe||me(Ae,Oe,this.length);for(var nt=this[Ae+--Oe],Ze=1;Oe>0&&(Ze*=256);)nt+=this[Ae+--Oe]*Ze;return nt},I.prototype.readUInt8=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,1,this.length),this[Ae]},I.prototype.readUInt16LE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,2,this.length),this[Ae]|this[Ae+1]<<8},I.prototype.readUInt16BE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,2,this.length),this[Ae]<<8|this[Ae+1]},I.prototype.readUInt32LE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,4,this.length),(this[Ae]|this[Ae+1]<<8|this[Ae+2]<<16)+this[Ae+3]*16777216},I.prototype.readUInt32BE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,4,this.length),this[Ae]*16777216+(this[Ae+1]<<16|this[Ae+2]<<8|this[Ae+3])},I.prototype.readIntLE=function(Ae,Oe,Fe){Ae=Ae>>>0,Oe=Oe>>>0,Fe||me(Ae,Oe,this.length);for(var nt=this[Ae],Ze=1,Xe=0;++Xe<Oe&&(Ze*=256);)nt+=this[Ae+Xe]*Ze;return Ze*=128,nt>=Ze&&(nt-=Math.pow(2,8*Oe)),nt},I.prototype.readIntBE=function(Ae,Oe,Fe){Ae=Ae>>>0,Oe=Oe>>>0,Fe||me(Ae,Oe,this.length);for(var nt=Oe,Ze=1,Xe=this[Ae+--nt];nt>0&&(Ze*=256);)Xe+=this[Ae+--nt]*Ze;return Ze*=128,Xe>=Ze&&(Xe-=Math.pow(2,8*Oe)),Xe},I.prototype.readInt8=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,1,this.length),this[Ae]&128?(255-this[Ae]+1)*-1:this[Ae]},I.prototype.readInt16LE=function(Ae,Oe){Ae=Ae>>>0,Oe||me(Ae,2,this.length);var Fe=this[Ae]|this[Ae+1]<<8;return Fe&32768?Fe|4294901760:Fe},I.prototype.readInt16BE=function(Ae,Oe){Ae=Ae>>>0,Oe||me(Ae,2,this.length);var Fe=this[Ae+1]|this[Ae]<<8;return Fe&32768?Fe|4294901760:Fe},I.prototype.readInt32LE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,4,this.length),this[Ae]|this[Ae+1]<<8|this[Ae+2]<<16|this[Ae+3]<<24},I.prototype.readInt32BE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,4,this.length),this[Ae]<<24|this[Ae+1]<<16|this[Ae+2]<<8|this[Ae+3]},I.prototype.readFloatLE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,4,this.length),R.read(this,Ae,!0,23,4)},I.prototype.readFloatBE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,4,this.length),R.read(this,Ae,!1,23,4)},I.prototype.readDoubleLE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,8,this.length),R.read(this,Ae,!0,52,8)},I.prototype.readDoubleBE=function(Ae,Oe){return Ae=Ae>>>0,Oe||me(Ae,8,this.length),R.read(this,Ae,!1,52,8)};function ye(Ne,Ae,Oe,Fe,nt,Ze){if(!I.isBuffer(Ne))throw new TypeError('"buffer" argument must be a Buffer instance');if(Ae>nt||Ae<Ze)throw new RangeError('"value" argument is out of bounds');if(Oe+Fe>Ne.length)throw new RangeError("Index out of range")}I.prototype.writeUIntLE=function(Ae,Oe,Fe,nt){if(Ae=+Ae,Oe=Oe>>>0,Fe=Fe>>>0,!nt){var Ze=Math.pow(2,8*Fe)-1;ye(this,Ae,Oe,Fe,Ze,0)}var Xe=1,$e=0;for(this[Oe]=Ae&255;++$e<Fe&&(Xe*=256);)this[Oe+$e]=Ae/Xe&255;return Oe+Fe},I.prototype.writeUIntBE=function(Ae,Oe,Fe,nt){if(Ae=+Ae,Oe=Oe>>>0,Fe=Fe>>>0,!nt){var Ze=Math.pow(2,8*Fe)-1;ye(this,Ae,Oe,Fe,Ze,0)}var Xe=Fe-1,$e=1;for(this[Oe+Xe]=Ae&255;--Xe>=0&&($e*=256);)this[Oe+Xe]=Ae/$e&255;return Oe+Fe},I.prototype.writeUInt8=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,1,255,0),this[Oe]=Ae&255,Oe+1},I.prototype.writeUInt16LE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,2,65535,0),this[Oe]=Ae&255,this[Oe+1]=Ae>>>8,Oe+2},I.prototype.writeUInt16BE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,2,65535,0),this[Oe]=Ae>>>8,this[Oe+1]=Ae&255,Oe+2},I.prototype.writeUInt32LE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,4,4294967295,0),this[Oe+3]=Ae>>>24,this[Oe+2]=Ae>>>16,this[Oe+1]=Ae>>>8,this[Oe]=Ae&255,Oe+4},I.prototype.writeUInt32BE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,4,4294967295,0),this[Oe]=Ae>>>24,this[Oe+1]=Ae>>>16,this[Oe+2]=Ae>>>8,this[Oe+3]=Ae&255,Oe+4},I.prototype.writeIntLE=function(Ae,Oe,Fe,nt){if(Ae=+Ae,Oe=Oe>>>0,!nt){var Ze=Math.pow(2,8*Fe-1);ye(this,Ae,Oe,Fe,Ze-1,-Ze)}var Xe=0,$e=1,ot=0;for(this[Oe]=Ae&255;++Xe<Fe&&($e*=256);)Ae<0&&ot===0&&this[Oe+Xe-1]!==0&&(ot=1),this[Oe+Xe]=(Ae/$e>>0)-ot&255;return Oe+Fe},I.prototype.writeIntBE=function(Ae,Oe,Fe,nt){if(Ae=+Ae,Oe=Oe>>>0,!nt){var Ze=Math.pow(2,8*Fe-1);ye(this,Ae,Oe,Fe,Ze-1,-Ze)}var Xe=Fe-1,$e=1,ot=0;for(this[Oe+Xe]=Ae&255;--Xe>=0&&($e*=256);)Ae<0&&ot===0&&this[Oe+Xe+1]!==0&&(ot=1),this[Oe+Xe]=(Ae/$e>>0)-ot&255;return Oe+Fe},I.prototype.writeInt8=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,1,127,-128),Ae<0&&(Ae=255+Ae+1),this[Oe]=Ae&255,Oe+1},I.prototype.writeInt16LE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,2,32767,-32768),this[Oe]=Ae&255,this[Oe+1]=Ae>>>8,Oe+2},I.prototype.writeInt16BE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,2,32767,-32768),this[Oe]=Ae>>>8,this[Oe+1]=Ae&255,Oe+2},I.prototype.writeInt32LE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,4,2147483647,-2147483648),this[Oe]=Ae&255,this[Oe+1]=Ae>>>8,this[Oe+2]=Ae>>>16,this[Oe+3]=Ae>>>24,Oe+4},I.prototype.writeInt32BE=function(Ae,Oe,Fe){return Ae=+Ae,Oe=Oe>>>0,Fe||ye(this,Ae,Oe,4,2147483647,-2147483648),Ae<0&&(Ae=4294967295+Ae+1),this[Oe]=Ae>>>24,this[Oe+1]=Ae>>>16,this[Oe+2]=Ae>>>8,this[Oe+3]=Ae&255,Oe+4};function ge(Ne,Ae,Oe,Fe,nt,Ze){if(Oe+Fe>Ne.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("Index out of range")}function we(Ne,Ae,Oe,Fe,nt){return Ae=+Ae,Oe=Oe>>>0,nt||ge(Ne,Ae,Oe,4),R.write(Ne,Ae,Oe,Fe,23,4),Oe+4}I.prototype.writeFloatLE=function(Ae,Oe,Fe){return we(this,Ae,Oe,!0,Fe)},I.prototype.writeFloatBE=function(Ae,Oe,Fe){return we(this,Ae,Oe,!1,Fe)};function Te(Ne,Ae,Oe,Fe,nt){return Ae=+Ae,Oe=Oe>>>0,nt||ge(Ne,Ae,Oe,8),R.write(Ne,Ae,Oe,Fe,52,8),Oe+8}I.prototype.writeDoubleLE=function(Ae,Oe,Fe){return Te(this,Ae,Oe,!0,Fe)},I.prototype.writeDoubleBE=function(Ae,Oe,Fe){return Te(this,Ae,Oe,!1,Fe)},I.prototype.copy=function(Ae,Oe,Fe,nt){if(!I.isBuffer(Ae))throw new TypeError("argument should be a Buffer");if(Fe||(Fe=0),!nt&&nt!==0&&(nt=this.length),Oe>=Ae.length&&(Oe=Ae.length),Oe||(Oe=0),nt>0&&nt<Fe&&(nt=Fe),nt===Fe||Ae.length===0||this.length===0)return 0;if(Oe<0)throw new RangeError("targetStart out of bounds");if(Fe<0||Fe>=this.length)throw new RangeError("Index out of range");if(nt<0)throw new RangeError("sourceEnd out of bounds");nt>this.length&&(nt=this.length),Ae.length-Oe<nt-Fe&&(nt=Ae.length-Oe+Fe);var Ze=nt-Fe;if(this===Ae&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(Oe,Fe,nt);else if(this===Ae&&Fe<Oe&&Oe<nt)for(var Xe=Ze-1;Xe>=0;--Xe)Ae[Xe+Oe]=this[Xe+Fe];else Uint8Array.prototype.set.call(Ae,this.subarray(Fe,nt),Oe);return Ze},I.prototype.fill=function(Ae,Oe,Fe,nt){if(typeof Ae=="string"){if(typeof Oe=="string"?(nt=Oe,Oe=0,Fe=this.length):typeof Fe=="string"&&(nt=Fe,Fe=this.length),nt!==void 0&&typeof nt!="string")throw new TypeError("encoding must be a string");if(typeof nt=="string"&&!I.isEncoding(nt))throw new TypeError("Unknown encoding: "+nt);if(Ae.length===1){var Ze=Ae.charCodeAt(0);(nt==="utf8"&&Ze<128||nt==="latin1")&&(Ae=Ze)}}else typeof Ae=="number"&&(Ae=Ae&255);if(Oe<0||this.length<Oe||this.length<Fe)throw new RangeError("Out of range index");if(Fe<=Oe)return this;Oe=Oe>>>0,Fe=Fe===void 0?this.length:Fe>>>0,Ae||(Ae=0);var Xe;if(typeof Ae=="number")for(Xe=Oe;Xe<Fe;++Xe)this[Xe]=Ae;else{var $e=I.isBuffer(Ae)?Ae:I.from(Ae,nt),ot=$e.length;if(ot===0)throw new TypeError('The value "'+Ae+'" is invalid for argument "value"');for(Xe=0;Xe<Fe-Oe;++Xe)this[Xe+Oe]=$e[Xe%ot]}return this};var Ee=/[^+/0-9A-Za-z-_]/g;function De(Ne){if(Ne=Ne.split("=")[0],Ne=Ne.trim().replace(Ee,""),Ne.length<2)return"";for(;Ne.length%4!==0;)Ne=Ne+"=";return Ne}function fe(Ne){return Ne<16?"0"+Ne.toString(16):Ne.toString(16)}function Ce(Ne,Ae){Ae=Ae||1/0;for(var Oe,Fe=Ne.length,nt=null,Ze=[],Xe=0;Xe<Fe;++Xe){if(Oe=Ne.charCodeAt(Xe),Oe>55295&&Oe<57344){if(!nt){if(Oe>56319){(Ae-=3)>-1&&Ze.push(239,191,189);continue}else if(Xe+1===Fe){(Ae-=3)>-1&&Ze.push(239,191,189);continue}nt=Oe;continue}if(Oe<56320){(Ae-=3)>-1&&Ze.push(239,191,189),nt=Oe;continue}Oe=(nt-55296<<10|Oe-56320)+65536}else nt&&(Ae-=3)>-1&&Ze.push(239,191,189);if(nt=null,Oe<128){if((Ae-=1)<0)break;Ze.push(Oe)}else if(Oe<2048){if((Ae-=2)<0)break;Ze.push(Oe>>6|192,Oe&63|128)}else if(Oe<65536){if((Ae-=3)<0)break;Ze.push(Oe>>12|224,Oe>>6&63|128,Oe&63|128)}else if(Oe<1114112){if((Ae-=4)<0)break;Ze.push(Oe>>18|240,Oe>>12&63|128,Oe>>6&63|128,Oe&63|128)}else throw new Error("Invalid code point")}return Ze}function Se(Ne){for(var Ae=[],Oe=0;Oe<Ne.length;++Oe)Ae.push(Ne.charCodeAt(Oe)&255);return Ae}function be(Ne,Ae){for(var Oe,Fe,nt,Ze=[],Xe=0;Xe<Ne.length&&!((Ae-=2)<0);++Xe)Oe=Ne.charCodeAt(Xe),Fe=Oe>>8,nt=Oe%256,Ze.push(nt),Ze.push(Fe);return Ze}function Re(Ne){return O.toByteArray(De(Ne))}function Ve(Ne,Ae,Oe,Fe){for(var nt=0;nt<Fe&&!(nt+Oe>=Ae.length||nt>=Ne.length);++nt)Ae[nt+Oe]=Ne[nt];return nt}function Pe(Ne,Ae){return Ne instanceof Ae||Ne!=null&&Ne.constructor!=null&&Ne.constructor.name!=null&&Ne.constructor.name===Ae.name}function ke(Ne){return Ne!==Ne}}).call(this)}).call(this,_("buffer").Buffer)},{"base64-js":100,buffer:103,ieee754:400}],104:[function(_,w,B){w.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],105:[function(_,w,B){var A=_("get-intrinsic"),O=_("./"),R=O(A("String.prototype.indexOf"));w.exports=function(E,D){var I=A(E,!!D);return typeof I=="function"&&R(E,".prototype.")>-1?O(I):I}},{"./":106,"get-intrinsic":390}],106:[function(_,w,B){var A=_("function-bind"),O=_("get-intrinsic"),R=_("set-function-length"),P=O("%TypeError%"),E=O("%Function.prototype.apply%"),D=O("%Function.prototype.call%"),I=O("%Reflect.apply%",!0)||A.call(D,E),M=O("%Object.defineProperty%",!0),N=O("%Math.max%");if(M)try{M({},"a",{value:1})}catch(F){M=null}w.exports=function(G){if(typeof G!="function")throw new P("a function is required");var V=I(A,D,arguments);return R(V,1+N(0,G.length-(arguments.length-1)),!0)};var k=function(){return I(A,E,arguments)};M?M(w.exports,"apply",{value:k}):w.exports.apply=k},{"function-bind":389,"get-intrinsic":390,"set-function-length":466}],107:[function(_,w,B){var A=Array.prototype.slice;w.exports=O;function O(P,E){if(!(this instanceof O))return new O(P,E);this.src=P,this._withAccess=E}O.prototype.withAccess=function(P){return this._withAccess=P!==!1,this},O.prototype.pick=function(P){return Array.isArray(P)||(P=A.call(arguments)),P.length&&(this.keys=P),this},O.prototype.to=function(P){if(P=P||{},!this.src)return P;var E=this.keys||Object.keys(this.src);if(!this._withAccess){for(var D=0;D<E.length;D++)I=E[D],P[I]===void 0&&(P[I]=this.src[I]);return P}for(var D=0;D<E.length;D++){var I=E[D];if(R(P,I)){var M=this.src.__lookupGetter__(I),N=this.src.__lookupSetter__(I);M&&P.__defineGetter__(I,M),N&&P.__defineSetter__(I,N),!M&&!N&&(P[I]=this.src[I])}}return P},O.prototype.toCover=function(P){for(var E=this.keys||Object.keys(this.src),D=0;D<E.length;D++){var I=E[D];delete P[I];var M=this.src.__lookupGetter__(I),N=this.src.__lookupSetter__(I);M&&P.__defineGetter__(I,M),N&&P.__defineSetter__(I,N),!M&&!N&&(P[I]=this.src[I])}},O.prototype.override=O.prototype.toCover,O.prototype.and=function(P){var E={};return this.to(E),this.src=P,this.to(E),this.src=E,this};function R(P,E){return P[E]===void 0&&P.__lookupGetter__(E)===void 0&&P.__lookupSetter__(E)===void 0}},{}],108:[function(_,w,B){var A=_("../internals/is-callable"),O=_("../internals/try-to-string"),R=TypeError;w.exports=function(P){if(A(P))return P;throw new R(O(P)+" is not a function")}},{"../internals/is-callable":203,"../internals/try-to-string":293}],109:[function(_,w,B){var A=_("../internals/is-constructor"),O=_("../internals/try-to-string"),R=TypeError;w.exports=function(P){if(A(P))return P;throw new R(O(P)+" is not a constructor")}},{"../internals/is-constructor":204,"../internals/try-to-string":293}],110:[function(_,w,B){var A=_("../internals/is-possible-prototype"),O=String,R=TypeError;w.exports=function(P){if(A(P))return P;throw new R("Can't set "+O(P)+" as a prototype")}},{"../internals/is-possible-prototype":209}],111:[function(_,w,B){var A=_("../internals/well-known-symbol"),O=_("../internals/object-create"),R=_("../internals/object-define-property").f,P=A("unscopables"),E=Array.prototype;E[P]===void 0&&R(E,P,{configurable:!0,value:O(null)}),w.exports=function(D){E[P][D]=!0}},{"../internals/object-create":229,"../internals/object-define-property":231,"../internals/well-known-symbol":306}],112:[function(_,w,B){var A=_("../internals/string-multibyte").charAt;w.exports=function(O,R,P){return R+(P?A(O,R).length:1)}},{"../internals/string-multibyte":271}],113:[function(_,w,B){var A=_("../internals/object-is-prototype-of"),O=TypeError;w.exports=function(R,P){if(A(P,R))return R;throw new O("Incorrect invocation")}},{"../internals/object-is-prototype-of":238}],114:[function(_,w,B){var A=_("../internals/is-object"),O=String,R=TypeError;w.exports=function(P){if(A(P))return P;throw new R(O(P)+" is not an object")}},{"../internals/is-object":208}],115:[function(_,w,B){w.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},{}],116:[function(_,w,B){var A=_("../internals/fails");w.exports=A(function(){if(typeof ArrayBuffer=="function"){var O=new ArrayBuffer(8);Object.isExtensible(O)&&Object.defineProperty(O,"a",{value:8})}})},{"../internals/fails":171}],117:[function(_,w,B){var A=_("../internals/array-buffer-basic-detection"),O=_("../internals/descriptors"),R=_("../internals/global"),P=_("../internals/is-callable"),E=_("../internals/is-object"),D=_("../internals/has-own-property"),I=_("../internals/classof"),M=_("../internals/try-to-string"),N=_("../internals/create-non-enumerable-property"),k=_("../internals/define-built-in"),F=_("../internals/define-built-in-accessor"),G=_("../internals/object-is-prototype-of"),V=_("../internals/object-get-prototype-of"),j=_("../internals/object-set-prototype-of"),H=_("../internals/well-known-symbol"),U=_("../internals/uid"),X=_("../internals/internal-state"),Y=X.enforce,z=X.get,W=R.Int8Array,Z=W&&W.prototype,Q=R.Uint8ClampedArray,ee=Q&&Q.prototype,te=W&&V(W),re=Z&&V(Z),ie=Object.prototype,ne=R.TypeError,he=H("toStringTag"),pe=U("TYPED_ARRAY_TAG"),K="TypedArrayConstructor",ue=A&&!!j&&I(R.opera)!=="Opera",le=!1,ce,_e,oe,de={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},me={BigInt64Array:8,BigUint64Array:8},ye=function(Se){if(!E(Se))return!1;var be=I(Se);return be==="DataView"||D(de,be)||D(me,be)},ge=function(Ce){var Se=V(Ce);if(E(Se)){var be=z(Se);return be&&D(be,K)?be[K]:ge(Se)}},we=function(Ce){if(!E(Ce))return!1;var Se=I(Ce);return D(de,Se)||D(me,Se)},Te=function(Ce){if(we(Ce))return Ce;throw new ne("Target is not a typed array")},Ee=function(Ce){if(P(Ce)&&(!j||G(te,Ce)))return Ce;throw new ne(M(Ce)+" is not a typed array constructor")},De=function(Ce,Se,be,Re){if(O){if(be)for(var Ve in de){var Pe=R[Ve];if(Pe&&D(Pe.prototype,Ce))try{delete Pe.prototype[Ce]}catch(ke){try{Pe.prototype[Ce]=Se}catch(Ne){}}}(!re[Ce]||be)&&k(re,Ce,be?Se:ue&&Z[Ce]||Se,Re)}},fe=function(Ce,Se,be){var Re,Ve;if(O){if(j){if(be){for(Re in de)if(Ve=R[Re],Ve&&D(Ve,Ce))try{delete Ve[Ce]}catch(Pe){}}if(!te[Ce]||be)try{return k(te,Ce,be?Se:ue&&te[Ce]||Se)}catch(Pe){}else return}for(Re in de)Ve=R[Re],Ve&&(!Ve[Ce]||be)&&k(Ve,Ce,Se)}};for(ce in de)_e=R[ce],oe=_e&&_e.prototype,oe?Y(oe)[K]=_e:ue=!1;for(ce in me)_e=R[ce],oe=_e&&_e.prototype,oe&&(Y(oe)[K]=_e);if((!ue||!P(te)||te===Function.prototype)&&(te=function(){throw new ne("Incorrect invocation")},ue))for(ce in de)R[ce]&&j(R[ce],te);if((!ue||!re||re===ie)&&(re=te.prototype,ue))for(ce in de)R[ce]&&j(R[ce].prototype,re);if(ue&&V(ee)!==re&&j(ee,re),O&&!D(re,he)){le=!0,F(re,he,{configurable:!0,get:function(){return E(this)?this[pe]:void 0}});for(ce in de)R[ce]&&N(R[ce],pe,ce)}w.exports={NATIVE_ARRAY_BUFFER_VIEWS:ue,TYPED_ARRAY_TAG:le&&pe,aTypedArray:Te,aTypedArrayConstructor:Ee,exportTypedArrayMethod:De,exportTypedArrayStaticMethod:fe,getTypedArrayConstructor:ge,isView:ye,isTypedArray:we,TypedArray:te,TypedArrayPrototype:re}},{"../internals/array-buffer-basic-detection":115,"../internals/classof":138,"../internals/create-non-enumerable-property":145,"../internals/define-built-in":149,"../internals/define-built-in-accessor":148,"../internals/descriptors":153,"../internals/global":188,"../internals/has-own-property":189,"../internals/internal-state":199,"../internals/is-callable":203,"../internals/is-object":208,"../internals/object-get-prototype-of":236,"../internals/object-is-prototype-of":238,"../internals/object-set-prototype-of":242,"../internals/try-to-string":293,"../internals/uid":299,"../internals/well-known-symbol":306}],118:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/function-uncurry-this"),R=_("../internals/descriptors"),P=_("../internals/array-buffer-basic-detection"),E=_("../internals/function-name"),D=_("../internals/create-non-enumerable-property"),I=_("../internals/define-built-in-accessor"),M=_("../internals/define-built-ins"),N=_("../internals/fails"),k=_("../internals/an-instance"),F=_("../internals/to-integer-or-infinity"),G=_("../internals/to-length"),V=_("../internals/to-index"),j=_("../internals/math-fround"),H=_("../internals/ieee754"),U=_("../internals/object-get-prototype-of"),X=_("../internals/object-set-prototype-of"),Y=_("../internals/array-fill"),z=_("../internals/array-slice"),W=_("../internals/inherit-if-required"),Z=_("../internals/copy-constructor-properties"),Q=_("../internals/set-to-string-tag"),ee=_("../internals/internal-state"),te=E.PROPER,re=E.CONFIGURABLE,ie="ArrayBuffer",ne="DataView",he="prototype",pe="Wrong length",K="Wrong index",ue=ee.getterFor(ie),le=ee.getterFor(ne),ce=ee.set,_e=A[ie],oe=_e,de=oe&&oe[he],me=A[ne],ye=me&&me[he],ge=Object.prototype,we=A.Array,Te=A.RangeError,Ee=O(Y),De=O([].reverse),fe=H.pack,Ce=H.unpack,Se=function(Xe){return[Xe&255]},be=function(Xe){return[Xe&255,Xe>>8&255]},Re=function(Xe){return[Xe&255,Xe>>8&255,Xe>>16&255,Xe>>24&255]},Ve=function(Xe){return Xe[3]<<24|Xe[2]<<16|Xe[1]<<8|Xe[0]},Pe=function(Xe){return fe(j(Xe),23,4)},ke=function(Xe){return fe(Xe,52,8)},Ne=function(Xe,$e,ot){I(Xe[he],$e,{configurable:!0,get:function(){return ot(this)[$e]}})},Ae=function(Xe,$e,ot,ut){var gt=le(Xe),Ue=V(ot),We=!!ut;if(Ue+$e>gt.byteLength)throw new Te(K);var ht=gt.bytes,Be=Ue+gt.byteOffset,je=z(ht,Be,Be+$e);return We?je:De(je)},Oe=function(Xe,$e,ot,ut,gt,Ue){var We=le(Xe),ht=V(ot),Be=ut(+gt),je=!!Ue;if(ht+$e>We.byteLength)throw new Te(K);for(var Qe=We.bytes,st=ht+We.byteOffset,pt=0;pt<$e;pt++)Qe[st+pt]=Be[je?pt:$e-pt-1]};if(!P)oe=function($e){k(this,de);var ot=V($e);ce(this,{type:ie,bytes:Ee(we(ot),0),byteLength:ot}),R||(this.byteLength=ot,this.detached=!1)},de=oe[he],me=function($e,ot,ut){k(this,ye),k($e,de);var gt=ue($e),Ue=gt.byteLength,We=F(ot);if(We<0||We>Ue)throw new Te("Wrong offset");if(ut=ut===void 0?Ue-We:G(ut),We+ut>Ue)throw new Te(pe);ce(this,{type:ne,buffer:$e,byteLength:ut,byteOffset:We,bytes:gt.bytes}),R||(this.buffer=$e,this.byteLength=ut,this.byteOffset=We)},ye=me[he],R&&(Ne(oe,"byteLength",ue),Ne(me,"buffer",le),Ne(me,"byteLength",le),Ne(me,"byteOffset",le)),M(ye,{getInt8:function($e){return Ae(this,1,$e)[0]<<24>>24},getUint8:function($e){return Ae(this,1,$e)[0]},getInt16:function($e){var ot=Ae(this,2,$e,arguments.length>1?arguments[1]:!1);return(ot[1]<<8|ot[0])<<16>>16},getUint16:function($e){var ot=Ae(this,2,$e,arguments.length>1?arguments[1]:!1);return ot[1]<<8|ot[0]},getInt32:function($e){return Ve(Ae(this,4,$e,arguments.length>1?arguments[1]:!1))},getUint32:function($e){return Ve(Ae(this,4,$e,arguments.length>1?arguments[1]:!1))>>>0},getFloat32:function($e){return Ce(Ae(this,4,$e,arguments.length>1?arguments[1]:!1),23)},getFloat64:function($e){return Ce(Ae(this,8,$e,arguments.length>1?arguments[1]:!1),52)},setInt8:function($e,ot){Oe(this,1,$e,Se,ot)},setUint8:function($e,ot){Oe(this,1,$e,Se,ot)},setInt16:function($e,ot){Oe(this,2,$e,be,ot,arguments.length>2?arguments[2]:!1)},setUint16:function($e,ot){Oe(this,2,$e,be,ot,arguments.length>2?arguments[2]:!1)},setInt32:function($e,ot){Oe(this,4,$e,Re,ot,arguments.length>2?arguments[2]:!1)},setUint32:function($e,ot){Oe(this,4,$e,Re,ot,arguments.length>2?arguments[2]:!1)},setFloat32:function($e,ot){Oe(this,4,$e,Pe,ot,arguments.length>2?arguments[2]:!1)},setFloat64:function($e,ot){Oe(this,8,$e,ke,ot,arguments.length>2?arguments[2]:!1)}});else{var Fe=te&&_e.name!==ie;!N(function(){_e(1)})||!N(function(){new _e(-1)})||N(function(){return new _e,new _e(1.5),new _e(NaN),_e.length!==1||Fe&&!re})?(oe=function($e){return k(this,de),W(new _e(V($e)),this,oe)},oe[he]=de,de.constructor=oe,Z(oe,_e)):Fe&&re&&D(_e,"name",ie),X&&U(ye)!==ge&&X(ye,ge);var nt=new me(new oe(2)),Ze=O(ye.setInt8);nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),(nt.getInt8(0)||!nt.getInt8(1))&&M(ye,{setInt8:function($e,ot){Ze(this,$e,ot<<24>>24)},setUint8:function($e,ot){Ze(this,$e,ot<<24>>24)}},{unsafe:!0})}Q(oe,ie),Q(me,ne),w.exports={ArrayBuffer:oe,DataView:me}},{"../internals/an-instance":113,"../internals/array-buffer-basic-detection":115,"../internals/array-fill":120,"../internals/array-slice":131,"../internals/copy-constructor-properties":141,"../internals/create-non-enumerable-property":145,"../internals/define-built-in-accessor":148,"../internals/define-built-ins":150,"../internals/descriptors":153,"../internals/fails":171,"../internals/function-name":178,"../internals/function-uncurry-this":181,"../internals/global":188,"../internals/ieee754":194,"../internals/inherit-if-required":196,"../internals/internal-state":199,"../internals/math-fround":222,"../internals/object-get-prototype-of":236,"../internals/object-set-prototype-of":242,"../internals/set-to-string-tag":266,"../internals/to-index":281,"../internals/to-integer-or-infinity":283,"../internals/to-length":284}],119:[function(_,w,B){var A=_("../internals/to-object"),O=_("../internals/to-absolute-index"),R=_("../internals/length-of-array-like"),P=_("../internals/delete-property-or-throw"),E=Math.min;w.exports=[].copyWithin||function(I,M){var N=A(this),k=R(N),F=O(I,k),G=O(M,k),V=arguments.length>2?arguments[2]:void 0,j=E((V===void 0?k:O(V,k))-G,k-F),H=1;for(G<F&&F<G+j&&(H=-1,G+=j-1,F+=j-1);j-- >0;)G in N?N[F]=N[G]:P(N,F),F+=H,G+=H;return N}},{"../internals/delete-property-or-throw":152,"../internals/length-of-array-like":219,"../internals/to-absolute-index":279,"../internals/to-object":285}],120:[function(_,w,B){var A=_("../internals/to-object"),O=_("../internals/to-absolute-index"),R=_("../internals/length-of-array-like");w.exports=function(E){for(var D=A(this),I=R(D),M=arguments.length,N=O(M>1?arguments[1]:void 0,I),k=M>2?arguments[2]:void 0,F=k===void 0?I:O(k,I);F>N;)D[N++]=E;return D}},{"../internals/length-of-array-like":219,"../internals/to-absolute-index":279,"../internals/to-object":285}],121:[function(_,w,B){var A=_("../internals/array-iteration").forEach,O=_("../internals/array-method-is-strict"),R=O("forEach");w.exports=R?[].forEach:function(E){return A(this,E,arguments.length>1?arguments[1]:void 0)}},{"../internals/array-iteration":125,"../internals/array-method-is-strict":128}],122:[function(_,w,B){var A=_("../internals/length-of-array-like");w.exports=function(O,R,P){for(var E=0,D=arguments.length>2?P:A(R),I=new O(D);D>E;)I[E]=R[E++];return I}},{"../internals/length-of-array-like":219}],123:[function(_,w,B){var A=_("../internals/function-bind-context"),O=_("../internals/function-call"),R=_("../internals/to-object"),P=_("../internals/call-with-safe-iteration-closing"),E=_("../internals/is-array-iterator-method"),D=_("../internals/is-constructor"),I=_("../internals/length-of-array-like"),M=_("../internals/create-property"),N=_("../internals/get-iterator"),k=_("../internals/get-iterator-method"),F=Array;w.exports=function(V){var j=R(V),H=D(this),U=arguments.length,X=U>1?arguments[1]:void 0,Y=X!==void 0;Y&&(X=A(X,U>2?arguments[2]:void 0));var z=k(j),W=0,Z,Q,ee,te,re,ie;if(z&&!(this===F&&E(z)))for(te=N(j,z),re=te.next,Q=H?new this:[];!(ee=O(re,te)).done;W++)ie=Y?P(te,X,[ee.value,W],!0):ee.value,M(Q,W,ie);else for(Z=I(j),Q=H?new this(Z):F(Z);Z>W;W++)ie=Y?X(j[W],W):j[W],M(Q,W,ie);return Q.length=W,Q}},{"../internals/call-with-safe-iteration-closing":135,"../internals/create-property":147,"../internals/function-bind-context":175,"../internals/function-call":177,"../internals/get-iterator":184,"../internals/get-iterator-method":183,"../internals/is-array-iterator-method":200,"../internals/is-constructor":204,"../internals/length-of-array-like":219,"../internals/to-object":285}],124:[function(_,w,B){var A=_("../internals/to-indexed-object"),O=_("../internals/to-absolute-index"),R=_("../internals/length-of-array-like"),P=function(E){return function(D,I,M){var N=A(D),k=R(N),F=O(M,k),G;if(E&&I!==I){for(;k>F;)if(G=N[F++],G!==G)return!0}else for(;k>F;F++)if((E||F in N)&&N[F]===I)return E||F||0;return!E&&-1}};w.exports={includes:P(!0),indexOf:P(!1)}},{"../internals/length-of-array-like":219,"../internals/to-absolute-index":279,"../internals/to-indexed-object":282}],125:[function(_,w,B){var A=_("../internals/function-bind-context"),O=_("../internals/function-uncurry-this"),R=_("../internals/indexed-object"),P=_("../internals/to-object"),E=_("../internals/length-of-array-like"),D=_("../internals/array-species-create"),I=O([].push),M=function(N){var k=N===1,F=N===2,G=N===3,V=N===4,j=N===6,H=N===7,U=N===5||j;return function(X,Y,z,W){for(var Z=P(X),Q=R(Z),ee=E(Q),te=A(Y,z),re=0,ie=W||D,ne=k?ie(X,ee):F||H?ie(X,0):void 0,he,pe;ee>re;re++)if((U||re in Q)&&(he=Q[re],pe=te(he,re,Z),N))if(k)ne[re]=pe;else if(pe)switch(N){case 3:return!0;case 5:return he;case 6:return re;case 2:I(ne,he)}else switch(N){case 4:return!1;case 7:I(ne,he)}return j?-1:G||V?V:ne}};w.exports={forEach:M(0),map:M(1),filter:M(2),some:M(3),every:M(4),find:M(5),findIndex:M(6),filterReject:M(7)}},{"../internals/array-species-create":134,"../internals/function-bind-context":175,"../internals/function-uncurry-this":181,"../internals/indexed-object":195,"../internals/length-of-array-like":219,"../internals/to-object":285}],126:[function(_,w,B){var A=_("../internals/function-apply"),O=_("../internals/to-indexed-object"),R=_("../internals/to-integer-or-infinity"),P=_("../internals/length-of-array-like"),E=_("../internals/array-method-is-strict"),D=Math.min,I=[].lastIndexOf,M=!!I&&1/[1].lastIndexOf(1,-0)<0,N=E("lastIndexOf"),k=M||!N;w.exports=k?function(G){if(M)return A(I,this,arguments)||0;var V=O(this),j=P(V),H=j-1;for(arguments.length>1&&(H=D(H,R(arguments[1]))),H<0&&(H=j+H);H>=0;H--)if(H in V&&V[H]===G)return H||0;return-1}:I},{"../internals/array-method-is-strict":128,"../internals/function-apply":174,"../internals/length-of-array-like":219,"../internals/to-indexed-object":282,"../internals/to-integer-or-infinity":283}],127:[function(_,w,B){var A=_("../internals/fails"),O=_("../internals/well-known-symbol"),R=_("../internals/engine-v8-version"),P=O("species");w.exports=function(E){return R>=51||!A(function(){var D=[],I=D.constructor={};return I[P]=function(){return{foo:1}},D[E](Boolean).foo!==1})}},{"../internals/engine-v8-version":167,"../internals/fails":171,"../internals/well-known-symbol":306}],128:[function(_,w,B){var A=_("../internals/fails");w.exports=function(O,R){var P=[][O];return!!P&&A(function(){P.call(null,R||function(){return 1},1)})}},{"../internals/fails":171}],129:[function(_,w,B){var A=_("../internals/a-callable"),O=_("../internals/to-object"),R=_("../internals/indexed-object"),P=_("../internals/length-of-array-like"),E=TypeError,D=function(I){return function(M,N,k,F){var G=O(M),V=R(G),j=P(G);A(N);var H=I?j-1:0,U=I?-1:1;if(k<2)for(;;){if(H in V){F=V[H],H+=U;break}if(H+=U,I?H<0:j<=H)throw new E("Reduce of empty array with no initial value")}for(;I?H>=0:j>H;H+=U)H in V&&(F=N(F,V[H],H,G));return F}};w.exports={left:D(!1),right:D(!0)}},{"../internals/a-callable":108,"../internals/indexed-object":195,"../internals/length-of-array-like":219,"../internals/to-object":285}],130:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/is-array"),R=TypeError,P=Object.getOwnPropertyDescriptor,E=A&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(D){return D instanceof TypeError}}();w.exports=E?function(D,I){if(O(D)&&!P(D,"length").writable)throw new R("Cannot set read only .length");return D.length=I}:function(D,I){return D.length=I}},{"../internals/descriptors":153,"../internals/is-array":201}],131:[function(_,w,B){var A=_("../internals/function-uncurry-this");w.exports=A([].slice)},{"../internals/function-uncurry-this":181}],132:[function(_,w,B){var A=_("../internals/array-slice"),O=Math.floor,R=function(P,E){var D=P.length;if(D<8)for(var I=1,M,N;I<D;){for(N=I,M=P[I];N&&E(P[N-1],M)>0;)P[N]=P[--N];N!==I++&&(P[N]=M)}else for(var k=O(D/2),F=R(A(P,0,k),E),G=R(A(P,k),E),V=F.length,j=G.length,H=0,U=0;H<V||U<j;)P[H+U]=H<V&&U<j?E(F[H],G[U])<=0?F[H++]:G[U++]:H<V?F[H++]:G[U++];return P};w.exports=R},{"../internals/array-slice":131}],133:[function(_,w,B){var A=_("../internals/is-array"),O=_("../internals/is-constructor"),R=_("../internals/is-object"),P=_("../internals/well-known-symbol"),E=P("species"),D=Array;w.exports=function(I){var M;return A(I)&&(M=I.constructor,O(M)&&(M===D||A(M.prototype))?M=void 0:R(M)&&(M=M[E],M===null&&(M=void 0))),M===void 0?D:M}},{"../internals/is-array":201,"../internals/is-constructor":204,"../internals/is-object":208,"../internals/well-known-symbol":306}],134:[function(_,w,B){var A=_("../internals/array-species-constructor");w.exports=function(O,R){return new(A(O))(R===0?0:R)}},{"../internals/array-species-constructor":133}],135:[function(_,w,B){var A=_("../internals/an-object"),O=_("../internals/iterator-close");w.exports=function(R,P,E,D){try{return D?P(A(E)[0],E[1]):P(E)}catch(I){O(R,"throw",I)}}},{"../internals/an-object":114,"../internals/iterator-close":214}],136:[function(_,w,B){var A=_("../internals/well-known-symbol"),O=A("iterator"),R=!1;try{var P=0,E={next:function(){return{done:!!P++}},return:function(){R=!0}};E[O]=function(){return this},Array.from(E,function(){throw 2})}catch(D){}w.exports=function(D,I){try{if(!I&&!R)return!1}catch(k){return!1}var M=!1;try{var N={};N[O]=function(){return{next:function(){return{done:M=!0}}}},D(N)}catch(k){}return M}},{"../internals/well-known-symbol":306}],137:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=A({}.toString),R=A("".slice);w.exports=function(P){return R(O(P),8,-1)}},{"../internals/function-uncurry-this":181}],138:[function(_,w,B){var A=_("../internals/to-string-tag-support"),O=_("../internals/is-callable"),R=_("../internals/classof-raw"),P=_("../internals/well-known-symbol"),E=P("toStringTag"),D=Object,I=R(function(){return arguments}())==="Arguments",M=function(N,k){try{return N[k]}catch(F){}};w.exports=A?R:function(N){var k,F,G;return N===void 0?"Undefined":N===null?"Null":typeof(F=M(k=D(N),E))=="string"?F:I?R(k):(G=R(k))==="Object"&&O(k.callee)?"Arguments":G}},{"../internals/classof-raw":137,"../internals/is-callable":203,"../internals/to-string-tag-support":290,"../internals/well-known-symbol":306}],139:[function(_,w,B){var A=_("../internals/object-create"),O=_("../internals/define-built-in-accessor"),R=_("../internals/define-built-ins"),P=_("../internals/function-bind-context"),E=_("../internals/an-instance"),D=_("../internals/is-null-or-undefined"),I=_("../internals/iterate"),M=_("../internals/iterator-define"),N=_("../internals/create-iter-result-object"),k=_("../internals/set-species"),F=_("../internals/descriptors"),G=_("../internals/internal-metadata").fastKey,V=_("../internals/internal-state"),j=V.set,H=V.getterFor;w.exports={getConstructor:function(U,X,Y,z){var W=U(function(re,ie){E(re,Z),j(re,{type:X,index:A(null),first:void 0,last:void 0,size:0}),F||(re.size=0),D(ie)||I(ie,re[z],{that:re,AS_ENTRIES:Y})}),Z=W.prototype,Q=H(X),ee=function(re,ie,ne){var he=Q(re),pe=te(re,ie),K,ue;return pe?pe.value=ne:(he.last=pe={index:ue=G(ie,!0),key:ie,value:ne,previous:K=he.last,next:void 0,removed:!1},he.first||(he.first=pe),K&&(K.next=pe),F?he.size++:re.size++,ue!=="F"&&(he.index[ue]=pe)),re},te=function(re,ie){var ne=Q(re),he=G(ie),pe;if(he!=="F")return ne.index[he];for(pe=ne.first;pe;pe=pe.next)if(pe.key===ie)return pe};return R(Z,{clear:function(){for(var ie=this,ne=Q(ie),he=ne.first;he;)he.removed=!0,he.previous&&(he.previous=he.previous.next=void 0),he=he.next;ne.first=ne.last=void 0,ne.index=A(null),F?ne.size=0:ie.size=0},delete:function(re){var ie=this,ne=Q(ie),he=te(ie,re);if(he){var pe=he.next,K=he.previous;delete ne.index[he.index],he.removed=!0,K&&(K.next=pe),pe&&(pe.previous=K),ne.first===he&&(ne.first=pe),ne.last===he&&(ne.last=K),F?ne.size--:ie.size--}return!!he},forEach:function(ie){for(var ne=Q(this),he=P(ie,arguments.length>1?arguments[1]:void 0),pe;pe=pe?pe.next:ne.first;)for(he(pe.value,pe.key,this);pe&&pe.removed;)pe=pe.previous},has:function(ie){return!!te(this,ie)}}),R(Z,Y?{get:function(ie){var ne=te(this,ie);return ne&&ne.value},set:function(ie,ne){return ee(this,ie===0?0:ie,ne)}}:{add:function(ie){return ee(this,ie=ie===0?0:ie,ie)}}),F&&O(Z,"size",{configurable:!0,get:function(){return Q(this).size}}),W},setStrong:function(U,X,Y){var z=X+" Iterator",W=H(X),Z=H(z);M(U,X,function(Q,ee){j(this,{type:z,target:Q,state:W(Q),kind:ee,last:void 0})},function(){for(var Q=Z(this),ee=Q.kind,te=Q.last;te&&te.removed;)te=te.previous;return!Q.target||!(Q.last=te=te?te.next:Q.state.first)?(Q.target=void 0,N(void 0,!0)):N(ee==="keys"?te.key:ee==="values"?te.value:[te.key,te.value],!1)},Y?"entries":"values",!Y,!0),k(X)}}},{"../internals/an-instance":113,"../internals/create-iter-result-object":144,"../internals/define-built-in-accessor":148,"../internals/define-built-ins":150,"../internals/descriptors":153,"../internals/function-bind-context":175,"../internals/internal-metadata":198,"../internals/internal-state":199,"../internals/is-null-or-undefined":207,"../internals/iterate":213,"../internals/iterator-define":216,"../internals/object-create":229,"../internals/set-species":265}],140:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/global"),R=_("../internals/function-uncurry-this"),P=_("../internals/is-forced"),E=_("../internals/define-built-in"),D=_("../internals/internal-metadata"),I=_("../internals/iterate"),M=_("../internals/an-instance"),N=_("../internals/is-callable"),k=_("../internals/is-null-or-undefined"),F=_("../internals/is-object"),G=_("../internals/fails"),V=_("../internals/check-correctness-of-iteration"),j=_("../internals/set-to-string-tag"),H=_("../internals/inherit-if-required");w.exports=function(U,X,Y){var z=U.indexOf("Map")!==-1,W=U.indexOf("Weak")!==-1,Z=z?"set":"add",Q=O[U],ee=Q&&Q.prototype,te=Q,re={},ie=function(ce){var _e=R(ee[ce]);E(ee,ce,ce==="add"?function(de){return _e(this,de===0?0:de),this}:ce==="delete"?function(oe){return W&&!F(oe)?!1:_e(this,oe===0?0:oe)}:ce==="get"?function(de){return W&&!F(de)?void 0:_e(this,de===0?0:de)}:ce==="has"?function(de){return W&&!F(de)?!1:_e(this,de===0?0:de)}:function(de,me){return _e(this,de===0?0:de,me),this})},ne=P(U,!N(Q)||!(W||ee.forEach&&!G(function(){new Q().entries().next()})));if(ne)te=Y.getConstructor(X,U,z,Z),D.enable();else if(P(U,!0)){var he=new te,pe=he[Z](W?{}:-0,1)!==he,K=G(function(){he.has(1)}),ue=V(function(ce){new Q(ce)}),le=!W&&G(function(){for(var ce=new Q,_e=5;_e--;)ce[Z](_e,_e);return!ce.has(-0)});ue||(te=X(function(ce,_e){M(ce,ee);var oe=H(new Q,ce,te);return k(_e)||I(_e,oe[Z],{that:oe,AS_ENTRIES:z}),oe}),te.prototype=ee,ee.constructor=te),(K||le)&&(ie("delete"),ie("has"),z&&ie("get")),(le||pe)&&ie(Z),W&&ee.clear&&delete ee.clear}return re[U]=te,A({global:!0,constructor:!0,forced:te!==Q},re),j(te,U),W||Y.setStrong(te,U,z),te}},{"../internals/an-instance":113,"../internals/check-correctness-of-iteration":136,"../internals/define-built-in":149,"../internals/export":170,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/global":188,"../internals/inherit-if-required":196,"../internals/internal-metadata":198,"../internals/is-callable":203,"../internals/is-forced":205,"../internals/is-null-or-undefined":207,"../internals/is-object":208,"../internals/iterate":213,"../internals/set-to-string-tag":266}],141:[function(_,w,B){var A=_("../internals/has-own-property"),O=_("../internals/own-keys"),R=_("../internals/object-get-own-property-descriptor"),P=_("../internals/object-define-property");w.exports=function(E,D,I){for(var M=O(D),N=P.f,k=R.f,F=0;F<M.length;F++){var G=M[F];!A(E,G)&&!(I&&A(I,G))&&N(E,G,k(D,G))}}},{"../internals/has-own-property":189,"../internals/object-define-property":231,"../internals/object-get-own-property-descriptor":232,"../internals/own-keys":246}],142:[function(_,w,B){var A=_("../internals/well-known-symbol"),O=A("match");w.exports=function(R){var P=/./;try{"/./"[R](P)}catch(E){try{return P[O]=!1,"/./"[R](P)}catch(D){}}return!1}},{"../internals/well-known-symbol":306}],143:[function(_,w,B){var A=_("../internals/fails");w.exports=!A(function(){function O(){}return O.prototype.constructor=null,Object.getPrototypeOf(new O)!==O.prototype})},{"../internals/fails":171}],144:[function(_,w,B){w.exports=function(A,O){return{value:A,done:O}}},{}],145:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/object-define-property"),R=_("../internals/create-property-descriptor");w.exports=A?function(P,E,D){return O.f(P,E,R(1,D))}:function(P,E,D){return P[E]=D,P}},{"../internals/create-property-descriptor":146,"../internals/descriptors":153,"../internals/object-define-property":231}],146:[function(_,w,B){w.exports=function(A,O){return{enumerable:!(A&1),configurable:!(A&2),writable:!(A&4),value:O}}},{}],147:[function(_,w,B){var A=_("../internals/to-property-key"),O=_("../internals/object-define-property"),R=_("../internals/create-property-descriptor");w.exports=function(P,E,D){var I=A(E);I in P?O.f(P,I,R(0,D)):P[I]=D}},{"../internals/create-property-descriptor":146,"../internals/object-define-property":231,"../internals/to-property-key":289}],148:[function(_,w,B){var A=_("../internals/make-built-in"),O=_("../internals/object-define-property");w.exports=function(R,P,E){return E.get&&A(E.get,P,{getter:!0}),E.set&&A(E.set,P,{setter:!0}),O.f(R,P,E)}},{"../internals/make-built-in":220,"../internals/object-define-property":231}],149:[function(_,w,B){var A=_("../internals/is-callable"),O=_("../internals/object-define-property"),R=_("../internals/make-built-in"),P=_("../internals/define-global-property");w.exports=function(E,D,I,M){M||(M={});var N=M.enumerable,k=M.name!==void 0?M.name:D;if(A(I)&&R(I,k,M),M.global)N?E[D]=I:P(D,I);else{try{M.unsafe?E[D]&&(N=!0):delete E[D]}catch(F){}N?E[D]=I:O.f(E,D,{value:I,enumerable:!1,configurable:!M.nonConfigurable,writable:!M.nonWritable})}return E}},{"../internals/define-global-property":151,"../internals/is-callable":203,"../internals/make-built-in":220,"../internals/object-define-property":231}],150:[function(_,w,B){var A=_("../internals/define-built-in");w.exports=function(O,R,P){for(var E in R)A(O,E,R[E],P);return O}},{"../internals/define-built-in":149}],151:[function(_,w,B){var A=_("../internals/global"),O=Object.defineProperty;w.exports=function(R,P){try{O(A,R,{value:P,configurable:!0,writable:!0})}catch(E){A[R]=P}return P}},{"../internals/global":188}],152:[function(_,w,B){var A=_("../internals/try-to-string"),O=TypeError;w.exports=function(R,P){if(!delete R[P])throw new O("Cannot delete property "+A(P)+" of "+A(R))}},{"../internals/try-to-string":293}],153:[function(_,w,B){var A=_("../internals/fails");w.exports=!A(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":171}],154:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/is-object"),R=A.document,P=O(R)&&O(R.createElement);w.exports=function(E){return P?R.createElement(E):{}}},{"../internals/global":188,"../internals/is-object":208}],155:[function(_,w,B){var A=TypeError,O=9007199254740991;w.exports=function(R){if(R>O)throw A("Maximum allowed index exceeded");return R}},{}],156:[function(_,w,B){w.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},{}],157:[function(_,w,B){var A=_("../internals/document-create-element"),O=A("span").classList,R=O&&O.constructor&&O.constructor.prototype;w.exports=R===Object.prototype?void 0:R},{"../internals/document-create-element":154}],158:[function(_,w,B){var A=_("../internals/engine-user-agent"),O=A.match(/firefox\/(\d+)/i);w.exports=!!O&&+O[1]},{"../internals/engine-user-agent":166}],159:[function(_,w,B){var A=_("../internals/engine-is-deno"),O=_("../internals/engine-is-node");w.exports=!A&&!O&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":160,"../internals/engine-is-node":164}],160:[function(_,w,B){w.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],161:[function(_,w,B){var A=_("../internals/engine-user-agent");w.exports=/MSIE|Trident/.test(A)},{"../internals/engine-user-agent":166}],162:[function(_,w,B){var A=_("../internals/engine-user-agent");w.exports=/ipad|iphone|ipod/i.test(A)&&typeof Pebble<"u"},{"../internals/engine-user-agent":166}],163:[function(_,w,B){var A=_("../internals/engine-user-agent");w.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(A)},{"../internals/engine-user-agent":166}],164:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/classof-raw");w.exports=O(A.process)==="process"},{"../internals/classof-raw":137,"../internals/global":188}],165:[function(_,w,B){var A=_("../internals/engine-user-agent");w.exports=/web0s(?!.*chrome)/i.test(A)},{"../internals/engine-user-agent":166}],166:[function(_,w,B){w.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],167:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/engine-user-agent"),R=A.process,P=A.Deno,E=R&&R.versions||P&&P.version,D=E&&E.v8,I,M;D&&(I=D.split("."),M=I[0]>0&&I[0]<4?1:+(I[0]+I[1])),!M&&O&&(I=O.match(/Edge\/(\d+)/),(!I||I[1]>=74)&&(I=O.match(/Chrome\/(\d+)/),I&&(M=+I[1]))),w.exports=M},{"../internals/engine-user-agent":166,"../internals/global":188}],168:[function(_,w,B){var A=_("../internals/engine-user-agent"),O=A.match(/AppleWebKit\/(\d+)\./);w.exports=!!O&&+O[1]},{"../internals/engine-user-agent":166}],169:[function(_,w,B){w.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],170:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/object-get-own-property-descriptor").f,R=_("../internals/create-non-enumerable-property"),P=_("../internals/define-built-in"),E=_("../internals/define-global-property"),D=_("../internals/copy-constructor-properties"),I=_("../internals/is-forced");w.exports=function(M,N){var k=M.target,F=M.global,G=M.stat,V,j,H,U,X,Y;if(F?j=A:G?j=A[k]||E(k,{}):j=(A[k]||{}).prototype,j)for(H in N){if(X=N[H],M.dontCallGetSet?(Y=O(j,H),U=Y&&Y.value):U=j[H],V=I(F?H:k+(G?".":"#")+H,M.forced),!V&&U!==void 0){if(typeof X==typeof U)continue;D(X,U)}(M.sham||U&&U.sham)&&R(X,"sham",!0),P(j,H,X,M)}}},{"../internals/copy-constructor-properties":141,"../internals/create-non-enumerable-property":145,"../internals/define-built-in":149,"../internals/define-global-property":151,"../internals/global":188,"../internals/is-forced":205,"../internals/object-get-own-property-descriptor":232}],171:[function(_,w,B){w.exports=function(A){try{return!!A()}catch(O){return!0}}},{}],172:[function(_,w,B){_("../modules/es.regexp.exec");var A=_("../internals/function-uncurry-this-clause"),O=_("../internals/define-built-in"),R=_("../internals/regexp-exec"),P=_("../internals/fails"),E=_("../internals/well-known-symbol"),D=_("../internals/create-non-enumerable-property"),I=E("species"),M=RegExp.prototype;w.exports=function(N,k,F,G){var V=E(N),j=!P(function(){var Y={};return Y[V]=function(){return 7},""[N](Y)!==7}),H=j&&!P(function(){var Y=!1,z=/a/;return N==="split"&&(z={},z.constructor={},z.constructor[I]=function(){return z},z.flags="",z[V]=/./[V]),z.exec=function(){return Y=!0,null},z[V](""),!Y});if(!j||!H||F){var U=A(/./[V]),X=k(V,""[N],function(Y,z,W,Z,Q){var ee=A(Y),te=z.exec;return te===R||te===M.exec?j&&!Q?{done:!0,value:U(z,W,Z)}:{done:!0,value:ee(W,z,Z)}:{done:!1}});O(String.prototype,N,X[0]),O(M,V,X[1])}G&&D(M[V],"sham",!0)}},{"../internals/create-non-enumerable-property":145,"../internals/define-built-in":149,"../internals/fails":171,"../internals/function-uncurry-this-clause":180,"../internals/regexp-exec":256,"../internals/well-known-symbol":306,"../modules/es.regexp.exec":338}],173:[function(_,w,B){var A=_("../internals/fails");w.exports=!A(function(){return Object.isExtensible(Object.preventExtensions({}))})},{"../internals/fails":171}],174:[function(_,w,B){var A=_("../internals/function-bind-native"),O=Function.prototype,R=O.apply,P=O.call;w.exports=typeof Reflect=="object"&&Reflect.apply||(A?P.bind(R):function(){return P.apply(R,arguments)})},{"../internals/function-bind-native":176}],175:[function(_,w,B){var A=_("../internals/function-uncurry-this-clause"),O=_("../internals/a-callable"),R=_("../internals/function-bind-native"),P=A(A.bind);w.exports=function(E,D){return O(E),D===void 0?E:R?P(E,D):function(){return E.apply(D,arguments)}}},{"../internals/a-callable":108,"../internals/function-bind-native":176,"../internals/function-uncurry-this-clause":180}],176:[function(_,w,B){var A=_("../internals/fails");w.exports=!A(function(){var O=(function(){}).bind();return typeof O!="function"||O.hasOwnProperty("prototype")})},{"../internals/fails":171}],177:[function(_,w,B){var A=_("../internals/function-bind-native"),O=Function.prototype.call;w.exports=A?O.bind(O):function(){return O.apply(O,arguments)}},{"../internals/function-bind-native":176}],178:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/has-own-property"),R=Function.prototype,P=A&&Object.getOwnPropertyDescriptor,E=O(R,"name"),D=E&&(function(){}).name==="something",I=E&&(!A||A&&P(R,"name").configurable);w.exports={EXISTS:E,PROPER:D,CONFIGURABLE:I}},{"../internals/descriptors":153,"../internals/has-own-property":189}],179:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/a-callable");w.exports=function(R,P,E){try{return A(O(Object.getOwnPropertyDescriptor(R,P)[E]))}catch(D){}}},{"../internals/a-callable":108,"../internals/function-uncurry-this":181}],180:[function(_,w,B){var A=_("../internals/classof-raw"),O=_("../internals/function-uncurry-this");w.exports=function(R){if(A(R)==="Function")return O(R)}},{"../internals/classof-raw":137,"../internals/function-uncurry-this":181}],181:[function(_,w,B){var A=_("../internals/function-bind-native"),O=Function.prototype,R=O.call,P=A&&O.bind.bind(R,R);w.exports=A?P:function(E){return function(){return R.apply(E,arguments)}}},{"../internals/function-bind-native":176}],182:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/is-callable"),R=function(P){return O(P)?P:void 0};w.exports=function(P,E){return arguments.length<2?R(A[P]):A[P]&&A[P][E]}},{"../internals/global":188,"../internals/is-callable":203}],183:[function(_,w,B){var A=_("../internals/classof"),O=_("../internals/get-method"),R=_("../internals/is-null-or-undefined"),P=_("../internals/iterators"),E=_("../internals/well-known-symbol"),D=E("iterator");w.exports=function(I){if(!R(I))return O(I,D)||O(I,"@@iterator")||P[A(I)]}},{"../internals/classof":138,"../internals/get-method":186,"../internals/is-null-or-undefined":207,"../internals/iterators":218,"../internals/well-known-symbol":306}],184:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/a-callable"),R=_("../internals/an-object"),P=_("../internals/try-to-string"),E=_("../internals/get-iterator-method"),D=TypeError;w.exports=function(I,M){var N=arguments.length<2?E(I):M;if(O(N))return R(A(N,I));throw new D(P(I)+" is not iterable")}},{"../internals/a-callable":108,"../internals/an-object":114,"../internals/function-call":177,"../internals/get-iterator-method":183,"../internals/try-to-string":293}],185:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/is-array"),R=_("../internals/is-callable"),P=_("../internals/classof-raw"),E=_("../internals/to-string"),D=A([].push);w.exports=function(I){if(R(I))return I;if(O(I)){for(var M=I.length,N=[],k=0;k<M;k++){var F=I[k];typeof F=="string"?D(N,F):(typeof F=="number"||P(F)==="Number"||P(F)==="String")&&D(N,E(F))}var G=N.length,V=!0;return function(j,H){if(V)return V=!1,H;if(O(this))return H;for(var U=0;U<G;U++)if(N[U]===j)return H}}}},{"../internals/classof-raw":137,"../internals/function-uncurry-this":181,"../internals/is-array":201,"../internals/is-callable":203,"../internals/to-string":291}],186:[function(_,w,B){var A=_("../internals/a-callable"),O=_("../internals/is-null-or-undefined");w.exports=function(R,P){var E=R[P];return O(E)?void 0:A(E)}},{"../internals/a-callable":108,"../internals/is-null-or-undefined":207}],187:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/to-object"),R=Math.floor,P=A("".charAt),E=A("".replace),D=A("".slice),I=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,M=/\$([$&'`]|\d{1,2})/g;w.exports=function(N,k,F,G,V,j){var H=F+N.length,U=G.length,X=M;return V!==void 0&&(V=O(V),X=I),E(j,X,function(Y,z){var W;switch(P(z,0)){case"$":return"$";case"&":return N;case"`":return D(k,0,F);case"'":return D(k,H);case"<":W=V[D(z,1,-1)];break;default:var Z=+z;if(Z===0)return Y;if(Z>U){var Q=R(Z/10);return Q===0?Y:Q<=U?G[Q-1]===void 0?P(z,1):G[Q-1]+P(z,1):Y}W=G[Z-1]}return W===void 0?"":W})}},{"../internals/function-uncurry-this":181,"../internals/to-object":285}],188:[function(_,w,B){(function(A){(function(){var O=function(R){return R&&R.Math===Math&&R};w.exports=O(typeof globalThis=="object"&&globalThis)||O(typeof window=="object"&&window)||O(typeof self=="object"&&self)||O(typeof A=="object"&&A)||O(typeof this=="object"&&this)||function(){return this}()||Function("return this")()}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],189:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/to-object"),R=A({}.hasOwnProperty);w.exports=Object.hasOwn||function(E,D){return R(O(E),D)}},{"../internals/function-uncurry-this":181,"../internals/to-object":285}],190:[function(_,w,B){w.exports={}},{}],191:[function(_,w,B){w.exports=function(A,O){try{arguments.length===1?console.error(A):console.error(A,O)}catch(R){}}},{}],192:[function(_,w,B){var A=_("../internals/get-built-in");w.exports=A("document","documentElement")},{"../internals/get-built-in":182}],193:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/fails"),R=_("../internals/document-create-element");w.exports=!A&&!O(function(){return Object.defineProperty(R("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":153,"../internals/document-create-element":154,"../internals/fails":171}],194:[function(_,w,B){var A=Array,O=Math.abs,R=Math.pow,P=Math.floor,E=Math.log,D=Math.LN2,I=function(N,k,F){var G=A(F),V=F*8-k-1,j=(1<<V)-1,H=j>>1,U=k===23?R(2,-24)-R(2,-77):0,X=N<0||N===0&&1/N<0?1:0,Y=0,z,W,Z;for(N=O(N),N!==N||N===1/0?(W=N!==N?1:0,z=j):(z=P(E(N)/D),Z=R(2,-z),N*Z<1&&(z--,Z*=2),z+H>=1?N+=U/Z:N+=U*R(2,1-H),N*Z>=2&&(z++,Z/=2),z+H>=j?(W=0,z=j):z+H>=1?(W=(N*Z-1)*R(2,k),z+=H):(W=N*R(2,H-1)*R(2,k),z=0));k>=8;)G[Y++]=W&255,W/=256,k-=8;for(z=z<<k|W,V+=k;V>0;)G[Y++]=z&255,z/=256,V-=8;return G[--Y]|=X*128,G},M=function(N,k){var F=N.length,G=F*8-k-1,V=(1<<G)-1,j=V>>1,H=G-7,U=F-1,X=N[U--],Y=X&127,z;for(X>>=7;H>0;)Y=Y*256+N[U--],H-=8;for(z=Y&(1<<-H)-1,Y>>=-H,H+=k;H>0;)z=z*256+N[U--],H-=8;if(Y===0)Y=1-j;else{if(Y===V)return z?NaN:X?-1/0:1/0;z+=R(2,k),Y-=j}return(X?-1:1)*z*R(2,Y-k)};w.exports={pack:I,unpack:M}},{}],195:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/fails"),R=_("../internals/classof-raw"),P=Object,E=A("".split);w.exports=O(function(){return!P("z").propertyIsEnumerable(0)})?function(D){return R(D)==="String"?E(D,""):P(D)}:P},{"../internals/classof-raw":137,"../internals/fails":171,"../internals/function-uncurry-this":181}],196:[function(_,w,B){var A=_("../internals/is-callable"),O=_("../internals/is-object"),R=_("../internals/object-set-prototype-of");w.exports=function(P,E,D){var I,M;return R&&A(I=E.constructor)&&I!==D&&O(M=I.prototype)&&M!==D.prototype&&R(P,M),P}},{"../internals/is-callable":203,"../internals/is-object":208,"../internals/object-set-prototype-of":242}],197:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/is-callable"),R=_("../internals/shared-store"),P=A(Function.toString);O(R.inspectSource)||(R.inspectSource=function(E){return P(E)}),w.exports=R.inspectSource},{"../internals/function-uncurry-this":181,"../internals/is-callable":203,"../internals/shared-store":268}],198:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-uncurry-this"),R=_("../internals/hidden-keys"),P=_("../internals/is-object"),E=_("../internals/has-own-property"),D=_("../internals/object-define-property").f,I=_("../internals/object-get-own-property-names"),M=_("../internals/object-get-own-property-names-external"),N=_("../internals/object-is-extensible"),k=_("../internals/uid"),F=_("../internals/freezing"),G=!1,V=k("meta"),j=0,H=function(Z){D(Z,V,{value:{objectID:"O"+j++,weakData:{}}})},U=function(Z,Q){if(!P(Z))return typeof Z=="symbol"?Z:(typeof Z=="string"?"S":"P")+Z;if(!E(Z,V)){if(!N(Z))return"F";if(!Q)return"E";H(Z)}return Z[V].objectID},X=function(Z,Q){if(!E(Z,V)){if(!N(Z))return!0;if(!Q)return!1;H(Z)}return Z[V].weakData},Y=function(Z){return F&&G&&N(Z)&&!E(Z,V)&&H(Z),Z},z=function(){W.enable=function(){},G=!0;var Z=I.f,Q=O([].splice),ee={};ee[V]=1,Z(ee).length&&(I.f=function(te){for(var re=Z(te),ie=0,ne=re.length;ie<ne;ie++)if(re[ie]===V){Q(re,ie,1);break}return re},A({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:M.f}))},W=w.exports={enable:z,fastKey:U,getWeakData:X,onFreeze:Y};R[V]=!0},{"../internals/export":170,"../internals/freezing":173,"../internals/function-uncurry-this":181,"../internals/has-own-property":189,"../internals/hidden-keys":190,"../internals/is-object":208,"../internals/object-define-property":231,"../internals/object-get-own-property-names":234,"../internals/object-get-own-property-names-external":233,"../internals/object-is-extensible":237,"../internals/uid":299}],199:[function(_,w,B){var A=_("../internals/weak-map-basic-detection"),O=_("../internals/global"),R=_("../internals/is-object"),P=_("../internals/create-non-enumerable-property"),E=_("../internals/has-own-property"),D=_("../internals/shared-store"),I=_("../internals/shared-key"),M=_("../internals/hidden-keys"),N="Object already initialized",k=O.TypeError,F=O.WeakMap,G,V,j,H=function(z){return j(z)?V(z):G(z,{})},U=function(z){return function(W){var Z;if(!R(W)||(Z=V(W)).type!==z)throw new k("Incompatible receiver, "+z+" required");return Z}};if(A||D.state){var X=D.state||(D.state=new F);X.get=X.get,X.has=X.has,X.set=X.set,G=function(z,W){if(X.has(z))throw new k(N);return W.facade=z,X.set(z,W),W},V=function(z){return X.get(z)||{}},j=function(z){return X.has(z)}}else{var Y=I("state");M[Y]=!0,G=function(z,W){if(E(z,Y))throw new k(N);return W.facade=z,P(z,Y,W),W},V=function(z){return E(z,Y)?z[Y]:{}},j=function(z){return E(z,Y)}}w.exports={set:G,get:V,has:j,enforce:H,getterFor:U}},{"../internals/create-non-enumerable-property":145,"../internals/global":188,"../internals/has-own-property":189,"../internals/hidden-keys":190,"../internals/is-object":208,"../internals/shared-key":267,"../internals/shared-store":268,"../internals/weak-map-basic-detection":303}],200:[function(_,w,B){var A=_("../internals/well-known-symbol"),O=_("../internals/iterators"),R=A("iterator"),P=Array.prototype;w.exports=function(E){return E!==void 0&&(O.Array===E||P[R]===E)}},{"../internals/iterators":218,"../internals/well-known-symbol":306}],201:[function(_,w,B){var A=_("../internals/classof-raw");w.exports=Array.isArray||function(R){return A(R)==="Array"}},{"../internals/classof-raw":137}],202:[function(_,w,B){var A=_("../internals/classof");w.exports=function(O){var R=A(O);return R==="BigInt64Array"||R==="BigUint64Array"}},{"../internals/classof":138}],203:[function(_,w,B){var A=typeof document=="object"&&document.all;w.exports=typeof A>"u"&&A!==void 0?function(O){return typeof O=="function"||O===A}:function(O){return typeof O=="function"}},{}],204:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/fails"),R=_("../internals/is-callable"),P=_("../internals/classof"),E=_("../internals/get-built-in"),D=_("../internals/inspect-source"),I=function(){},M=[],N=E("Reflect","construct"),k=/^\s*(?:class|function)\b/,F=A(k.exec),G=!k.test(I),V=function(U){if(!R(U))return!1;try{return N(I,M,U),!0}catch(X){return!1}},j=function(U){if(!R(U))return!1;switch(P(U)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return G||!!F(k,D(U))}catch(X){return!0}};j.sham=!0,w.exports=!N||O(function(){var H;return V(V.call)||!V(Object)||!V(function(){H=!0})||H})?j:V},{"../internals/classof":138,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/get-built-in":182,"../internals/inspect-source":197,"../internals/is-callable":203}],205:[function(_,w,B){var A=_("../internals/fails"),O=_("../internals/is-callable"),R=/#|\.prototype\./,P=function(N,k){var F=D[E(N)];return F===M?!0:F===I?!1:O(k)?A(k):!!k},E=P.normalize=function(N){return String(N).replace(R,".").toLowerCase()},D=P.data={},I=P.NATIVE="N",M=P.POLYFILL="P";w.exports=P},{"../internals/fails":171,"../internals/is-callable":203}],206:[function(_,w,B){var A=_("../internals/is-object"),O=Math.floor;w.exports=Number.isInteger||function(P){return!A(P)&&isFinite(P)&&O(P)===P}},{"../internals/is-object":208}],207:[function(_,w,B){w.exports=function(A){return A==null}},{}],208:[function(_,w,B){var A=_("../internals/is-callable");w.exports=function(O){return typeof O=="object"?O!==null:A(O)}},{"../internals/is-callable":203}],209:[function(_,w,B){var A=_("../internals/is-object");w.exports=function(O){return A(O)||O===null}},{"../internals/is-object":208}],210:[function(_,w,B){w.exports=!1},{}],211:[function(_,w,B){var A=_("../internals/is-object"),O=_("../internals/classof-raw"),R=_("../internals/well-known-symbol"),P=R("match");w.exports=function(E){var D;return A(E)&&((D=E[P])!==void 0?!!D:O(E)==="RegExp")}},{"../internals/classof-raw":137,"../internals/is-object":208,"../internals/well-known-symbol":306}],212:[function(_,w,B){var A=_("../internals/get-built-in"),O=_("../internals/is-callable"),R=_("../internals/object-is-prototype-of"),P=_("../internals/use-symbol-as-uid"),E=Object;w.exports=P?function(D){return typeof D=="symbol"}:function(D){var I=A("Symbol");return O(I)&&R(I.prototype,E(D))}},{"../internals/get-built-in":182,"../internals/is-callable":203,"../internals/object-is-prototype-of":238,"../internals/use-symbol-as-uid":300}],213:[function(_,w,B){var A=_("../internals/function-bind-context"),O=_("../internals/function-call"),R=_("../internals/an-object"),P=_("../internals/try-to-string"),E=_("../internals/is-array-iterator-method"),D=_("../internals/length-of-array-like"),I=_("../internals/object-is-prototype-of"),M=_("../internals/get-iterator"),N=_("../internals/get-iterator-method"),k=_("../internals/iterator-close"),F=TypeError,G=function(j,H){this.stopped=j,this.result=H},V=G.prototype;w.exports=function(j,H,U){var X=U&&U.that,Y=!!(U&&U.AS_ENTRIES),z=!!(U&&U.IS_RECORD),W=!!(U&&U.IS_ITERATOR),Z=!!(U&&U.INTERRUPTED),Q=A(H,X),ee,te,re,ie,ne,he,pe,K=function(le){return ee&&k(ee,"normal",le),new G(!0,le)},ue=function(le){return Y?(R(le),Z?Q(le[0],le[1],K):Q(le[0],le[1])):Z?Q(le,K):Q(le)};if(z)ee=j.iterator;else if(W)ee=j;else{if(te=N(j),!te)throw new F(P(j)+" is not iterable");if(E(te)){for(re=0,ie=D(j);ie>re;re++)if(ne=ue(j[re]),ne&&I(V,ne))return ne;return new G(!1)}ee=M(j,te)}for(he=z?j.next:ee.next;!(pe=O(he,ee)).done;){try{ne=ue(pe.value)}catch(le){k(ee,"throw",le)}if(typeof ne=="object"&&ne&&I(V,ne))return ne}return new G(!1)}},{"../internals/an-object":114,"../internals/function-bind-context":175,"../internals/function-call":177,"../internals/get-iterator":184,"../internals/get-iterator-method":183,"../internals/is-array-iterator-method":200,"../internals/iterator-close":214,"../internals/length-of-array-like":219,"../internals/object-is-prototype-of":238,"../internals/try-to-string":293}],214:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/an-object"),R=_("../internals/get-method");w.exports=function(P,E,D){var I,M;O(P);try{if(I=R(P,"return"),!I){if(E==="throw")throw D;return D}I=A(I,P)}catch(N){M=!0,I=N}if(E==="throw")throw D;if(M)throw I;return O(I),D}},{"../internals/an-object":114,"../internals/function-call":177,"../internals/get-method":186}],215:[function(_,w,B){var A=_("../internals/iterators-core").IteratorPrototype,O=_("../internals/object-create"),R=_("../internals/create-property-descriptor"),P=_("../internals/set-to-string-tag"),E=_("../internals/iterators"),D=function(){return this};w.exports=function(I,M,N,k){var F=M+" Iterator";return I.prototype=O(A,{next:R(+!k,N)}),P(I,F,!1,!0),E[F]=D,I}},{"../internals/create-property-descriptor":146,"../internals/iterators":218,"../internals/iterators-core":217,"../internals/object-create":229,"../internals/set-to-string-tag":266}],216:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-call"),R=_("../internals/is-pure"),P=_("../internals/function-name"),E=_("../internals/is-callable"),D=_("../internals/iterator-create-constructor"),I=_("../internals/object-get-prototype-of"),M=_("../internals/object-set-prototype-of"),N=_("../internals/set-to-string-tag"),k=_("../internals/create-non-enumerable-property"),F=_("../internals/define-built-in"),G=_("../internals/well-known-symbol"),V=_("../internals/iterators"),j=_("../internals/iterators-core"),H=P.PROPER,U=P.CONFIGURABLE,X=j.IteratorPrototype,Y=j.BUGGY_SAFARI_ITERATORS,z=G("iterator"),W="keys",Z="values",Q="entries",ee=function(){return this};w.exports=function(te,re,ie,ne,he,pe,K){D(ie,re,ne);var ue=function(Te){if(Te===he&&de)return de;if(!Y&&Te&&Te in _e)return _e[Te];switch(Te){case W:return function(){return new ie(this,Te)};case Z:return function(){return new ie(this,Te)};case Q:return function(){return new ie(this,Te)}}return function(){return new ie(this)}},le=re+" Iterator",ce=!1,_e=te.prototype,oe=_e[z]||_e["@@iterator"]||he&&_e[he],de=!Y&&oe||ue(he),me=re==="Array"&&_e.entries||oe,ye,ge,we;if(me&&(ye=I(me.call(new te)),ye!==Object.prototype&&ye.next&&(!R&&I(ye)!==X&&(M?M(ye,X):E(ye[z])||F(ye,z,ee)),N(ye,le,!0,!0),R&&(V[le]=ee))),H&&he===Z&&oe&&oe.name!==Z&&(!R&&U?k(_e,"name",Z):(ce=!0,de=function(){return O(oe,this)})),he)if(ge={values:ue(Z),keys:pe?de:ue(W),entries:ue(Q)},K)for(we in ge)(Y||ce||!(we in _e))&&F(_e,we,ge[we]);else A({target:re,proto:!0,forced:Y||ce},ge);return(!R||K)&&_e[z]!==de&&F(_e,z,de,{name:he}),V[re]=de,ge}},{"../internals/create-non-enumerable-property":145,"../internals/define-built-in":149,"../internals/export":170,"../internals/function-call":177,"../internals/function-name":178,"../internals/is-callable":203,"../internals/is-pure":210,"../internals/iterator-create-constructor":215,"../internals/iterators":218,"../internals/iterators-core":217,"../internals/object-get-prototype-of":236,"../internals/object-set-prototype-of":242,"../internals/set-to-string-tag":266,"../internals/well-known-symbol":306}],217:[function(_,w,B){var A=_("../internals/fails"),O=_("../internals/is-callable"),R=_("../internals/is-object"),P=_("../internals/object-create"),E=_("../internals/object-get-prototype-of"),D=_("../internals/define-built-in"),I=_("../internals/well-known-symbol"),M=_("../internals/is-pure"),N=I("iterator"),k=!1,F,G,V;[].keys&&(V=[].keys(),"next"in V?(G=E(E(V)),G!==Object.prototype&&(F=G)):k=!0);var j=!R(F)||A(function(){var H={};return F[N].call(H)!==H});j?F={}:M&&(F=P(F)),O(F[N])||D(F,N,function(){return this}),w.exports={IteratorPrototype:F,BUGGY_SAFARI_ITERATORS:k}},{"../internals/define-built-in":149,"../internals/fails":171,"../internals/is-callable":203,"../internals/is-object":208,"../internals/is-pure":210,"../internals/object-create":229,"../internals/object-get-prototype-of":236,"../internals/well-known-symbol":306}],218:[function(_,w,B){arguments[4][190][0].apply(B,arguments)},{dup:190}],219:[function(_,w,B){var A=_("../internals/to-length");w.exports=function(O){return A(O.length)}},{"../internals/to-length":284}],220:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/fails"),R=_("../internals/is-callable"),P=_("../internals/has-own-property"),E=_("../internals/descriptors"),D=_("../internals/function-name").CONFIGURABLE,I=_("../internals/inspect-source"),M=_("../internals/internal-state"),N=M.enforce,k=M.get,F=String,G=Object.defineProperty,V=A("".slice),j=A("".replace),H=A([].join),U=E&&!O(function(){return G(function(){},"length",{value:8}).length!==8}),X=String(String).split("String"),Y=w.exports=function(z,W,Z){V(F(W),0,7)==="Symbol("&&(W="["+j(F(W),/^Symbol\(([^)]*)\)/,"$1")+"]"),Z&&Z.getter&&(W="get "+W),Z&&Z.setter&&(W="set "+W),(!P(z,"name")||D&&z.name!==W)&&(E?G(z,"name",{value:W,configurable:!0}):z.name=W),U&&Z&&P(Z,"arity")&&z.length!==Z.arity&&G(z,"length",{value:Z.arity});try{Z&&P(Z,"constructor")&&Z.constructor?E&&G(z,"prototype",{writable:!1}):z.prototype&&(z.prototype=void 0)}catch(ee){}var Q=N(z);return P(Q,"source")||(Q.source=H(X,typeof W=="string"?W:"")),z};Function.prototype.toString=Y(function(){return R(this)&&k(this).source||I(this)},"toString")},{"../internals/descriptors":153,"../internals/fails":171,"../internals/function-name":178,"../internals/function-uncurry-this":181,"../internals/has-own-property":189,"../internals/inspect-source":197,"../internals/internal-state":199,"../internals/is-callable":203}],221:[function(_,w,B){var A=_("../internals/math-sign"),O=Math.abs,R=2220446049250313e-31,P=1/R,E=function(D){return D+P-P};w.exports=function(D,I,M,N){var k=+D,F=O(k),G=A(k);if(F<N)return G*E(F/N/I)*N*I;var V=(1+I/R)*F,j=V-(V-F);return j>M||j!==j?G*(1/0):G*j}},{"../internals/math-sign":223}],222:[function(_,w,B){var A=_("../internals/math-float-round"),O=11920928955078125e-23,R=34028234663852886e22,P=11754943508222875e-54;w.exports=Math.fround||function(D){return A(D,O,R,P)}},{"../internals/math-float-round":221}],223:[function(_,w,B){w.exports=Math.sign||function(O){var R=+O;return R===0||R!==R?R:R<0?-1:1}},{}],224:[function(_,w,B){var A=Math.ceil,O=Math.floor;w.exports=Math.trunc||function(P){var E=+P;return(E>0?O:A)(E)}},{}],225:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/safe-get-built-in"),R=_("../internals/function-bind-context"),P=_("../internals/task").set,E=_("../internals/queue"),D=_("../internals/engine-is-ios"),I=_("../internals/engine-is-ios-pebble"),M=_("../internals/engine-is-webos-webkit"),N=_("../internals/engine-is-node"),k=A.MutationObserver||A.WebKitMutationObserver,F=A.document,G=A.process,V=A.Promise,j=O("queueMicrotask"),H,U,X,Y,z;if(!j){var W=new E,Z=function(){var Q,ee;for(N&&(Q=G.domain)&&Q.exit();ee=W.get();)try{ee()}catch(te){throw W.head&&H(),te}Q&&Q.enter()};!D&&!N&&!M&&k&&F?(U=!0,X=F.createTextNode(""),new k(Z).observe(X,{characterData:!0}),H=function(){X.data=U=!U}):!I&&V&&V.resolve?(Y=V.resolve(void 0),Y.constructor=V,z=R(Y.then,Y),H=function(){z(Z)}):N?H=function(){G.nextTick(Z)}:(P=R(P,A),H=function(){P(Z)}),j=function(Q){W.head||H(),W.add(Q)}}w.exports=j},{"../internals/engine-is-ios":163,"../internals/engine-is-ios-pebble":162,"../internals/engine-is-node":164,"../internals/engine-is-webos-webkit":165,"../internals/function-bind-context":175,"../internals/global":188,"../internals/queue":254,"../internals/safe-get-built-in":263,"../internals/task":277}],226:[function(_,w,B){var A=_("../internals/a-callable"),O=TypeError,R=function(P){var E,D;this.promise=new P(function(I,M){if(E!==void 0||D!==void 0)throw new O("Bad Promise constructor");E=I,D=M}),this.resolve=A(E),this.reject=A(D)};w.exports.f=function(P){return new R(P)}},{"../internals/a-callable":108}],227:[function(_,w,B){var A=_("../internals/is-regexp"),O=TypeError;w.exports=function(R){if(A(R))throw new O("The method doesn't accept regular expressions");return R}},{"../internals/is-regexp":211}],228:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/function-uncurry-this"),R=_("../internals/function-call"),P=_("../internals/fails"),E=_("../internals/object-keys"),D=_("../internals/object-get-own-property-symbols"),I=_("../internals/object-property-is-enumerable"),M=_("../internals/to-object"),N=_("../internals/indexed-object"),k=Object.assign,F=Object.defineProperty,G=O([].concat);w.exports=!k||P(function(){if(A&&k({b:1},k(F({},"a",{enumerable:!0,get:function(){F(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var V={},j={},H=Symbol("assign detection"),U="abcdefghijklmnopqrst";return V[H]=7,U.split("").forEach(function(X){j[X]=X}),k({},V)[H]!==7||E(k({},j)).join("")!==U})?function(j,H){for(var U=M(j),X=arguments.length,Y=1,z=D.f,W=I.f;X>Y;)for(var Z=N(arguments[Y++]),Q=z?G(E(Z),z(Z)):E(Z),ee=Q.length,te=0,re;ee>te;)re=Q[te++],(!A||R(W,Z,re))&&(U[re]=Z[re]);return U}:k},{"../internals/descriptors":153,"../internals/fails":171,"../internals/function-call":177,"../internals/function-uncurry-this":181,"../internals/indexed-object":195,"../internals/object-get-own-property-symbols":235,"../internals/object-keys":240,"../internals/object-property-is-enumerable":241,"../internals/to-object":285}],229:[function(_,w,B){var A=_("../internals/an-object"),O=_("../internals/object-define-properties"),R=_("../internals/enum-bug-keys"),P=_("../internals/hidden-keys"),E=_("../internals/html"),D=_("../internals/document-create-element"),I=_("../internals/shared-key"),M=">",N="<",k="prototype",F="script",G=I("IE_PROTO"),V=function(){},j=function(z){return N+F+M+z+N+"/"+F+M},H=function(z){z.write(j("")),z.close();var W=z.parentWindow.Object;return z=null,W},U=function(){var z=D("iframe"),W="java"+F+":",Z;return z.style.display="none",E.appendChild(z),z.src=String(W),Z=z.contentWindow.document,Z.open(),Z.write(j("document.F=Object")),Z.close(),Z.F},X,Y=function(){try{X=new ActiveXObject("htmlfile")}catch(W){}Y=typeof document<"u"?document.domain&&X?H(X):U():H(X);for(var z=R.length;z--;)delete Y[k][R[z]];return Y()};P[G]=!0,w.exports=Object.create||function(W,Z){var Q;return W!==null?(V[k]=A(W),Q=new V,V[k]=null,Q[G]=W):Q=Y(),Z===void 0?Q:O.f(Q,Z)}},{"../internals/an-object":114,"../internals/document-create-element":154,"../internals/enum-bug-keys":169,"../internals/hidden-keys":190,"../internals/html":192,"../internals/object-define-properties":230,"../internals/shared-key":267}],230:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/v8-prototype-define-bug"),R=_("../internals/object-define-property"),P=_("../internals/an-object"),E=_("../internals/to-indexed-object"),D=_("../internals/object-keys");B.f=A&&!O?Object.defineProperties:function(M,N){P(M);for(var k=E(N),F=D(N),G=F.length,V=0,j;G>V;)R.f(M,j=F[V++],k[j]);return M}},{"../internals/an-object":114,"../internals/descriptors":153,"../internals/object-define-property":231,"../internals/object-keys":240,"../internals/to-indexed-object":282,"../internals/v8-prototype-define-bug":301}],231:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/ie8-dom-define"),R=_("../internals/v8-prototype-define-bug"),P=_("../internals/an-object"),E=_("../internals/to-property-key"),D=TypeError,I=Object.defineProperty,M=Object.getOwnPropertyDescriptor,N="enumerable",k="configurable",F="writable";B.f=A?R?function(V,j,H){if(P(V),j=E(j),P(H),typeof V=="function"&&j==="prototype"&&"value"in H&&F in H&&!H[F]){var U=M(V,j);U&&U[F]&&(V[j]=H.value,H={configurable:k in H?H[k]:U[k],enumerable:N in H?H[N]:U[N],writable:!1})}return I(V,j,H)}:I:function(V,j,H){if(P(V),j=E(j),P(H),O)try{return I(V,j,H)}catch(U){}if("get"in H||"set"in H)throw new D("Accessors not supported");return"value"in H&&(V[j]=H.value),V}},{"../internals/an-object":114,"../internals/descriptors":153,"../internals/ie8-dom-define":193,"../internals/to-property-key":289,"../internals/v8-prototype-define-bug":301}],232:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/function-call"),R=_("../internals/object-property-is-enumerable"),P=_("../internals/create-property-descriptor"),E=_("../internals/to-indexed-object"),D=_("../internals/to-property-key"),I=_("../internals/has-own-property"),M=_("../internals/ie8-dom-define"),N=Object.getOwnPropertyDescriptor;B.f=A?N:function(F,G){if(F=E(F),G=D(G),M)try{return N(F,G)}catch(V){}if(I(F,G))return P(!O(R.f,F,G),F[G])}},{"../internals/create-property-descriptor":146,"../internals/descriptors":153,"../internals/function-call":177,"../internals/has-own-property":189,"../internals/ie8-dom-define":193,"../internals/object-property-is-enumerable":241,"../internals/to-indexed-object":282,"../internals/to-property-key":289}],233:[function(_,w,B){var A=_("../internals/classof-raw"),O=_("../internals/to-indexed-object"),R=_("../internals/object-get-own-property-names").f,P=_("../internals/array-slice"),E=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],D=function(I){try{return R(I)}catch(M){return P(E)}};w.exports.f=function(M){return E&&A(M)==="Window"?D(M):R(O(M))}},{"../internals/array-slice":131,"../internals/classof-raw":137,"../internals/object-get-own-property-names":234,"../internals/to-indexed-object":282}],234:[function(_,w,B){var A=_("../internals/object-keys-internal"),O=_("../internals/enum-bug-keys"),R=O.concat("length","prototype");B.f=Object.getOwnPropertyNames||function(E){return A(E,R)}},{"../internals/enum-bug-keys":169,"../internals/object-keys-internal":239}],235:[function(_,w,B){B.f=Object.getOwnPropertySymbols},{}],236:[function(_,w,B){var A=_("../internals/has-own-property"),O=_("../internals/is-callable"),R=_("../internals/to-object"),P=_("../internals/shared-key"),E=_("../internals/correct-prototype-getter"),D=P("IE_PROTO"),I=Object,M=I.prototype;w.exports=E?I.getPrototypeOf:function(N){var k=R(N);if(A(k,D))return k[D];var F=k.constructor;return O(F)&&k instanceof F?F.prototype:k instanceof I?M:null}},{"../internals/correct-prototype-getter":143,"../internals/has-own-property":189,"../internals/is-callable":203,"../internals/shared-key":267,"../internals/to-object":285}],237:[function(_,w,B){var A=_("../internals/fails"),O=_("../internals/is-object"),R=_("../internals/classof-raw"),P=_("../internals/array-buffer-non-extensible"),E=Object.isExtensible,D=A(function(){});w.exports=D||P?function(M){return!O(M)||P&&R(M)==="ArrayBuffer"?!1:E?E(M):!0}:E},{"../internals/array-buffer-non-extensible":116,"../internals/classof-raw":137,"../internals/fails":171,"../internals/is-object":208}],238:[function(_,w,B){var A=_("../internals/function-uncurry-this");w.exports=A({}.isPrototypeOf)},{"../internals/function-uncurry-this":181}],239:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/has-own-property"),R=_("../internals/to-indexed-object"),P=_("../internals/array-includes").indexOf,E=_("../internals/hidden-keys"),D=A([].push);w.exports=function(I,M){var N=R(I),k=0,F=[],G;for(G in N)!O(E,G)&&O(N,G)&&D(F,G);for(;M.length>k;)O(N,G=M[k++])&&(~P(F,G)||D(F,G));return F}},{"../internals/array-includes":124,"../internals/function-uncurry-this":181,"../internals/has-own-property":189,"../internals/hidden-keys":190,"../internals/to-indexed-object":282}],240:[function(_,w,B){var A=_("../internals/object-keys-internal"),O=_("../internals/enum-bug-keys");w.exports=Object.keys||function(P){return A(P,O)}},{"../internals/enum-bug-keys":169,"../internals/object-keys-internal":239}],241:[function(_,w,B){var A={}.propertyIsEnumerable,O=Object.getOwnPropertyDescriptor,R=O&&!A.call({1:2},1);B.f=R?function(E){var D=O(this,E);return!!D&&D.enumerable}:A},{}],242:[function(_,w,B){var A=_("../internals/function-uncurry-this-accessor"),O=_("../internals/an-object"),R=_("../internals/a-possible-prototype");w.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var P=!1,E={},D;try{D=A(Object.prototype,"__proto__","set"),D(E,[]),P=E instanceof Array}catch(I){}return function(M,N){return O(M),R(N),P?D(M,N):M.__proto__=N,M}}():void 0)},{"../internals/a-possible-prototype":110,"../internals/an-object":114,"../internals/function-uncurry-this-accessor":179}],243:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/fails"),R=_("../internals/function-uncurry-this"),P=_("../internals/object-get-prototype-of"),E=_("../internals/object-keys"),D=_("../internals/to-indexed-object"),I=_("../internals/object-property-is-enumerable").f,M=R(I),N=R([].push),k=A&&O(function(){var G=Object.create(null);return G[2]=2,!M(G,2)}),F=function(G){return function(V){for(var j=D(V),H=E(j),U=k&&P(j)===null,X=H.length,Y=0,z=[],W;X>Y;)W=H[Y++],(!A||(U?W in j:M(j,W)))&&N(z,G?[W,j[W]]:j[W]);return z}};w.exports={entries:F(!0),values:F(!1)}},{"../internals/descriptors":153,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/object-get-prototype-of":236,"../internals/object-keys":240,"../internals/object-property-is-enumerable":241,"../internals/to-indexed-object":282}],244:[function(_,w,B){var A=_("../internals/to-string-tag-support"),O=_("../internals/classof");w.exports=A?{}.toString:function(){return"[object "+O(this)+"]"}},{"../internals/classof":138,"../internals/to-string-tag-support":290}],245:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/is-callable"),R=_("../internals/is-object"),P=TypeError;w.exports=function(E,D){var I,M;if(D==="string"&&O(I=E.toString)&&!R(M=A(I,E))||O(I=E.valueOf)&&!R(M=A(I,E))||D!=="string"&&O(I=E.toString)&&!R(M=A(I,E)))return M;throw new P("Can't convert object to primitive value")}},{"../internals/function-call":177,"../internals/is-callable":203,"../internals/is-object":208}],246:[function(_,w,B){var A=_("../internals/get-built-in"),O=_("../internals/function-uncurry-this"),R=_("../internals/object-get-own-property-names"),P=_("../internals/object-get-own-property-symbols"),E=_("../internals/an-object"),D=O([].concat);w.exports=A("Reflect","ownKeys")||function(M){var N=R.f(E(M)),k=P.f;return k?D(N,k(M)):N}},{"../internals/an-object":114,"../internals/function-uncurry-this":181,"../internals/get-built-in":182,"../internals/object-get-own-property-names":234,"../internals/object-get-own-property-symbols":235}],247:[function(_,w,B){var A=_("../internals/global");w.exports=A},{"../internals/global":188}],248:[function(_,w,B){w.exports=function(A){try{return{error:!1,value:A()}}catch(O){return{error:!0,value:O}}}},{}],249:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/promise-native-constructor"),R=_("../internals/is-callable"),P=_("../internals/is-forced"),E=_("../internals/inspect-source"),D=_("../internals/well-known-symbol"),I=_("../internals/engine-is-browser"),M=_("../internals/engine-is-deno"),N=_("../internals/is-pure"),k=_("../internals/engine-v8-version"),F=O&&O.prototype,G=D("species"),V=!1,j=R(A.PromiseRejectionEvent),H=P("Promise",function(){var U=E(O),X=U!==String(O);if(!X&&k===66||N&&!(F.catch&&F.finally))return!0;if(!k||k<51||!/native code/.test(U)){var Y=new O(function(Z){Z(1)}),z=function(Z){Z(function(){},function(){})},W=Y.constructor={};if(W[G]=z,V=Y.then(function(){})instanceof z,!V)return!0}return!X&&(I||M)&&!j});w.exports={CONSTRUCTOR:H,REJECTION_EVENT:j,SUBCLASSING:V}},{"../internals/engine-is-browser":159,"../internals/engine-is-deno":160,"../internals/engine-v8-version":167,"../internals/global":188,"../internals/inspect-source":197,"../internals/is-callable":203,"../internals/is-forced":205,"../internals/is-pure":210,"../internals/promise-native-constructor":250,"../internals/well-known-symbol":306}],250:[function(_,w,B){var A=_("../internals/global");w.exports=A.Promise},{"../internals/global":188}],251:[function(_,w,B){var A=_("../internals/an-object"),O=_("../internals/is-object"),R=_("../internals/new-promise-capability");w.exports=function(P,E){if(A(P),O(E)&&E.constructor===P)return E;var D=R.f(P),I=D.resolve;return I(E),D.promise}},{"../internals/an-object":114,"../internals/is-object":208,"../internals/new-promise-capability":226}],252:[function(_,w,B){var A=_("../internals/promise-native-constructor"),O=_("../internals/check-correctness-of-iteration"),R=_("../internals/promise-constructor-detection").CONSTRUCTOR;w.exports=R||!O(function(P){A.all(P).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":136,"../internals/promise-constructor-detection":249,"../internals/promise-native-constructor":250}],253:[function(_,w,B){var A=_("../internals/object-define-property").f;w.exports=function(O,R,P){P in O||A(O,P,{configurable:!0,get:function(){return R[P]},set:function(E){R[P]=E}})}},{"../internals/object-define-property":231}],254:[function(_,w,B){var A=function(){this.head=null,this.tail=null};A.prototype={add:function(O){var R={item:O,next:null},P=this.tail;P?P.next=R:this.head=R,this.tail=R},get:function(){var O=this.head;if(O){var R=this.head=O.next;return R===null&&(this.tail=null),O.item}}},w.exports=A},{}],255:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/an-object"),R=_("../internals/is-callable"),P=_("../internals/classof-raw"),E=_("../internals/regexp-exec"),D=TypeError;w.exports=function(I,M){var N=I.exec;if(R(N)){var k=A(N,I,M);return k!==null&&O(k),k}if(P(I)==="RegExp")return A(E,I,M);throw new D("RegExp#exec called on incompatible receiver")}},{"../internals/an-object":114,"../internals/classof-raw":137,"../internals/function-call":177,"../internals/is-callable":203,"../internals/regexp-exec":256}],256:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/function-uncurry-this"),R=_("../internals/to-string"),P=_("../internals/regexp-flags"),E=_("../internals/regexp-sticky-helpers"),D=_("../internals/shared"),I=_("../internals/object-create"),M=_("../internals/internal-state").get,N=_("../internals/regexp-unsupported-dot-all"),k=_("../internals/regexp-unsupported-ncg"),F=D("native-string-replace",String.prototype.replace),G=RegExp.prototype.exec,V=G,j=O("".charAt),H=O("".indexOf),U=O("".replace),X=O("".slice),Y=function(){var Q=/a/,ee=/b*/g;return A(G,Q,"a"),A(G,ee,"a"),Q.lastIndex!==0||ee.lastIndex!==0}(),z=E.BROKEN_CARET,W=/()??/.exec("")[1]!==void 0,Z=Y||W||z||N||k;Z&&(V=function(ee){var te=this,re=M(te),ie=R(ee),ne=re.raw,he,pe,K,ue,le,ce,_e;if(ne)return ne.lastIndex=te.lastIndex,he=A(V,ne,ie),te.lastIndex=ne.lastIndex,he;var oe=re.groups,de=z&&te.sticky,me=A(P,te),ye=te.source,ge=0,we=ie;if(de&&(me=U(me,"y",""),H(me,"g")===-1&&(me+="g"),we=X(ie,te.lastIndex),te.lastIndex>0&&(!te.multiline||te.multiline&&j(ie,te.lastIndex-1)!=="\n")&&(ye="(?: "+ye+")",we=" "+we,ge++),pe=new RegExp("^(?:"+ye+")",me)),W&&(pe=new RegExp("^"+ye+"$(?!\\s)",me)),Y&&(K=te.lastIndex),ue=A(G,de?pe:te,we),de?ue?(ue.input=X(ue.input,ge),ue[0]=X(ue[0],ge),ue.index=te.lastIndex,te.lastIndex+=ue[0].length):te.lastIndex=0:Y&&ue&&(te.lastIndex=te.global?ue.index+ue[0].length:K),W&&ue&&ue.length>1&&A(F,ue[0],pe,function(){for(le=1;le<arguments.length-2;le++)arguments[le]===void 0&&(ue[le]=void 0)}),ue&&oe)for(ue.groups=ce=I(null),le=0;le<oe.length;le++)_e=oe[le],ce[_e[0]]=ue[_e[1]];return ue}),w.exports=V},{"../internals/function-call":177,"../internals/function-uncurry-this":181,"../internals/internal-state":199,"../internals/object-create":229,"../internals/regexp-flags":257,"../internals/regexp-sticky-helpers":259,"../internals/regexp-unsupported-dot-all":260,"../internals/regexp-unsupported-ncg":261,"../internals/shared":269,"../internals/to-string":291}],257:[function(_,w,B){var A=_("../internals/an-object");w.exports=function(){var O=A(this),R="";return O.hasIndices&&(R+="d"),O.global&&(R+="g"),O.ignoreCase&&(R+="i"),O.multiline&&(R+="m"),O.dotAll&&(R+="s"),O.unicode&&(R+="u"),O.unicodeSets&&(R+="v"),O.sticky&&(R+="y"),R}},{"../internals/an-object":114}],258:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/has-own-property"),R=_("../internals/object-is-prototype-of"),P=_("../internals/regexp-flags"),E=RegExp.prototype;w.exports=function(D){var I=D.flags;return I===void 0&&!("flags"in E)&&!O(D,"flags")&&R(E,D)?A(P,D):I}},{"../internals/function-call":177,"../internals/has-own-property":189,"../internals/object-is-prototype-of":238,"../internals/regexp-flags":257}],259:[function(_,w,B){var A=_("../internals/fails"),O=_("../internals/global"),R=O.RegExp,P=A(function(){var I=R("a","y");return I.lastIndex=2,I.exec("abcd")!==null}),E=P||A(function(){return!R("a","y").sticky}),D=P||A(function(){var I=R("^r","gy");return I.lastIndex=2,I.exec("str")!==null});w.exports={BROKEN_CARET:D,MISSED_STICKY:E,UNSUPPORTED_Y:P}},{"../internals/fails":171,"../internals/global":188}],260:[function(_,w,B){var A=_("../internals/fails"),O=_("../internals/global"),R=O.RegExp;w.exports=A(function(){var P=R(".","s");return!(P.dotAll&&P.test("\n")&&P.flags==="s")})},{"../internals/fails":171,"../internals/global":188}],261:[function(_,w,B){var A=_("../internals/fails"),O=_("../internals/global"),R=O.RegExp;w.exports=A(function(){var P=R("(?<a>b)","g");return P.exec("b").groups.a!=="b"||"b".replace(P,"$<a>c")!=="bc"})},{"../internals/fails":171,"../internals/global":188}],262:[function(_,w,B){var A=_("../internals/is-null-or-undefined"),O=TypeError;w.exports=function(R){if(A(R))throw new O("Can't call method on "+R);return R}},{"../internals/is-null-or-undefined":207}],263:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/descriptors"),R=Object.getOwnPropertyDescriptor;w.exports=function(P){if(!O)return A[P];var E=R(A,P);return E&&E.value}},{"../internals/descriptors":153,"../internals/global":188}],264:[function(_,w,B){w.exports=Object.is||function(O,R){return O===R?O!==0||1/O===1/R:O!==O&&R!==R}},{}],265:[function(_,w,B){var A=_("../internals/get-built-in"),O=_("../internals/define-built-in-accessor"),R=_("../internals/well-known-symbol"),P=_("../internals/descriptors"),E=R("species");w.exports=function(D){var I=A(D);P&&I&&!I[E]&&O(I,E,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":148,"../internals/descriptors":153,"../internals/get-built-in":182,"../internals/well-known-symbol":306}],266:[function(_,w,B){var A=_("../internals/object-define-property").f,O=_("../internals/has-own-property"),R=_("../internals/well-known-symbol"),P=R("toStringTag");w.exports=function(E,D,I){E&&!I&&(E=E.prototype),E&&!O(E,P)&&A(E,P,{configurable:!0,value:D})}},{"../internals/has-own-property":189,"../internals/object-define-property":231,"../internals/well-known-symbol":306}],267:[function(_,w,B){var A=_("../internals/shared"),O=_("../internals/uid"),R=A("keys");w.exports=function(P){return R[P]||(R[P]=O(P))}},{"../internals/shared":269,"../internals/uid":299}],268:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/define-global-property"),R="__core-js_shared__",P=A[R]||O(R,{});w.exports=P},{"../internals/define-global-property":151,"../internals/global":188}],269:[function(_,w,B){var A=_("../internals/is-pure"),O=_("../internals/shared-store");(w.exports=function(R,P){return O[R]||(O[R]=P!==void 0?P:{})})("versions",[]).push({version:"3.35.0",mode:A?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":210,"../internals/shared-store":268}],270:[function(_,w,B){var A=_("../internals/an-object"),O=_("../internals/a-constructor"),R=_("../internals/is-null-or-undefined"),P=_("../internals/well-known-symbol"),E=P("species");w.exports=function(D,I){var M=A(D).constructor,N;return M===void 0||R(N=A(M)[E])?I:O(N)}},{"../internals/a-constructor":109,"../internals/an-object":114,"../internals/is-null-or-undefined":207,"../internals/well-known-symbol":306}],271:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/to-integer-or-infinity"),R=_("../internals/to-string"),P=_("../internals/require-object-coercible"),E=A("".charAt),D=A("".charCodeAt),I=A("".slice),M=function(N){return function(k,F){var G=R(P(k)),V=O(F),j=G.length,H,U;return V<0||V>=j?N?"":void 0:(H=D(G,V),H<55296||H>56319||V+1===j||(U=D(G,V+1))<56320||U>57343?N?E(G,V):H:N?I(G,V,V+2):(H-55296<<10)+(U-56320)+65536)}};w.exports={codeAt:M(!1),charAt:M(!0)}},{"../internals/function-uncurry-this":181,"../internals/require-object-coercible":262,"../internals/to-integer-or-infinity":283,"../internals/to-string":291}],272:[function(_,w,B){var A=_("../internals/function-name").PROPER,O=_("../internals/fails"),R=_("../internals/whitespaces"),P="​᠎";w.exports=function(E){return O(function(){return!!R[E]()||P[E]()!==P||A&&R[E].name!==E})}},{"../internals/fails":171,"../internals/function-name":178,"../internals/whitespaces":307}],273:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/require-object-coercible"),R=_("../internals/to-string"),P=_("../internals/whitespaces"),E=A("".replace),D=RegExp("^["+P+"]+"),I=RegExp("(^|[^"+P+"])["+P+"]+$"),M=function(N){return function(k){var F=R(O(k));return N&1&&(F=E(F,D,"")),N&2&&(F=E(F,I,"$1")),F}};w.exports={start:M(1),end:M(2),trim:M(3)}},{"../internals/function-uncurry-this":181,"../internals/require-object-coercible":262,"../internals/to-string":291,"../internals/whitespaces":307}],274:[function(_,w,B){var A=_("../internals/engine-v8-version"),O=_("../internals/fails"),R=_("../internals/global"),P=R.String;w.exports=!!Object.getOwnPropertySymbols&&!O(function(){var E=Symbol("symbol detection");return!P(E)||!(Object(E)instanceof Symbol)||!Symbol.sham&&A&&A<41})},{"../internals/engine-v8-version":167,"../internals/fails":171,"../internals/global":188}],275:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/get-built-in"),R=_("../internals/well-known-symbol"),P=_("../internals/define-built-in");w.exports=function(){var E=O("Symbol"),D=E&&E.prototype,I=D&&D.valueOf,M=R("toPrimitive");D&&!D[M]&&P(D,M,function(N){return A(I,this)},{arity:1})}},{"../internals/define-built-in":149,"../internals/function-call":177,"../internals/get-built-in":182,"../internals/well-known-symbol":306}],276:[function(_,w,B){var A=_("../internals/symbol-constructor-detection");w.exports=A&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":274}],277:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/function-apply"),R=_("../internals/function-bind-context"),P=_("../internals/is-callable"),E=_("../internals/has-own-property"),D=_("../internals/fails"),I=_("../internals/html"),M=_("../internals/array-slice"),N=_("../internals/document-create-element"),k=_("../internals/validate-arguments-length"),F=_("../internals/engine-is-ios"),G=_("../internals/engine-is-node"),V=A.setImmediate,j=A.clearImmediate,H=A.process,U=A.Dispatch,X=A.Function,Y=A.MessageChannel,z=A.String,W=0,Z={},Q="onreadystatechange",ee,te,re,ie;D(function(){ee=A.location});var ne=function(ue){if(E(Z,ue)){var le=Z[ue];delete Z[ue],le()}},he=function(ue){return function(){ne(ue)}},pe=function(ue){ne(ue.data)},K=function(ue){A.postMessage(z(ue),ee.protocol+"//"+ee.host)};(!V||!j)&&(V=function(le){k(arguments.length,1);var ce=P(le)?le:X(le),_e=M(arguments,1);return Z[++W]=function(){O(ce,void 0,_e)},te(W),W},j=function(le){delete Z[le]},G?te=function(ue){H.nextTick(he(ue))}:U&&U.now?te=function(ue){U.now(he(ue))}:Y&&!F?(re=new Y,ie=re.port2,re.port1.onmessage=pe,te=R(ie.postMessage,ie)):A.addEventListener&&P(A.postMessage)&&!A.importScripts&&ee&&ee.protocol!=="file:"&&!D(K)?(te=K,A.addEventListener("message",pe,!1)):Q in N("script")?te=function(ue){I.appendChild(N("script"))[Q]=function(){I.removeChild(this),ne(ue)}}:te=function(ue){setTimeout(he(ue),0)}),w.exports={set:V,clear:j}},{"../internals/array-slice":131,"../internals/document-create-element":154,"../internals/engine-is-ios":163,"../internals/engine-is-node":164,"../internals/fails":171,"../internals/function-apply":174,"../internals/function-bind-context":175,"../internals/global":188,"../internals/has-own-property":189,"../internals/html":192,"../internals/is-callable":203,"../internals/validate-arguments-length":302}],278:[function(_,w,B){var A=_("../internals/function-uncurry-this");w.exports=A(1 .valueOf)},{"../internals/function-uncurry-this":181}],279:[function(_,w,B){var A=_("../internals/to-integer-or-infinity"),O=Math.max,R=Math.min;w.exports=function(P,E){var D=A(P);return D<0?O(D+E,0):R(D,E)}},{"../internals/to-integer-or-infinity":283}],280:[function(_,w,B){var A=_("../internals/to-primitive"),O=TypeError;w.exports=function(R){var P=A(R,"number");if(typeof P=="number")throw new O("Can't convert number to bigint");return BigInt(P)}},{"../internals/to-primitive":288}],281:[function(_,w,B){var A=_("../internals/to-integer-or-infinity"),O=_("../internals/to-length"),R=RangeError;w.exports=function(P){if(P===void 0)return 0;var E=A(P),D=O(E);if(E!==D)throw new R("Wrong length or index");return D}},{"../internals/to-integer-or-infinity":283,"../internals/to-length":284}],282:[function(_,w,B){var A=_("../internals/indexed-object"),O=_("../internals/require-object-coercible");w.exports=function(R){return A(O(R))}},{"../internals/indexed-object":195,"../internals/require-object-coercible":262}],283:[function(_,w,B){var A=_("../internals/math-trunc");w.exports=function(O){var R=+O;return R!==R||R===0?0:A(R)}},{"../internals/math-trunc":224}],284:[function(_,w,B){var A=_("../internals/to-integer-or-infinity"),O=Math.min;w.exports=function(R){return R>0?O(A(R),9007199254740991):0}},{"../internals/to-integer-or-infinity":283}],285:[function(_,w,B){var A=_("../internals/require-object-coercible"),O=Object;w.exports=function(R){return O(A(R))}},{"../internals/require-object-coercible":262}],286:[function(_,w,B){var A=_("../internals/to-positive-integer"),O=RangeError;w.exports=function(R,P){var E=A(R);if(E%P)throw new O("Wrong offset");return E}},{"../internals/to-positive-integer":287}],287:[function(_,w,B){var A=_("../internals/to-integer-or-infinity"),O=RangeError;w.exports=function(R){var P=A(R);if(P<0)throw new O("The argument can't be less than 0");return P}},{"../internals/to-integer-or-infinity":283}],288:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/is-object"),R=_("../internals/is-symbol"),P=_("../internals/get-method"),E=_("../internals/ordinary-to-primitive"),D=_("../internals/well-known-symbol"),I=TypeError,M=D("toPrimitive");w.exports=function(N,k){if(!O(N)||R(N))return N;var F=P(N,M),G;if(F){if(k===void 0&&(k="default"),G=A(F,N,k),!O(G)||R(G))return G;throw new I("Can't convert object to primitive value")}return k===void 0&&(k="number"),E(N,k)}},{"../internals/function-call":177,"../internals/get-method":186,"../internals/is-object":208,"../internals/is-symbol":212,"../internals/ordinary-to-primitive":245,"../internals/well-known-symbol":306}],289:[function(_,w,B){var A=_("../internals/to-primitive"),O=_("../internals/is-symbol");w.exports=function(R){var P=A(R,"string");return O(P)?P:P+""}},{"../internals/is-symbol":212,"../internals/to-primitive":288}],290:[function(_,w,B){var A=_("../internals/well-known-symbol"),O=A("toStringTag"),R={};R[O]="z",w.exports=String(R)==="[object z]"},{"../internals/well-known-symbol":306}],291:[function(_,w,B){var A=_("../internals/classof"),O=String;w.exports=function(R){if(A(R)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return O(R)}},{"../internals/classof":138}],292:[function(_,w,B){var A=Math.round;w.exports=function(O){var R=A(O);return R<0?0:R>255?255:R&255}},{}],293:[function(_,w,B){var A=String;w.exports=function(O){try{return A(O)}catch(R){return"Object"}}},{}],294:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/global"),R=_("../internals/function-call"),P=_("../internals/descriptors"),E=_("../internals/typed-array-constructors-require-wrappers"),D=_("../internals/array-buffer-view-core"),I=_("../internals/array-buffer"),M=_("../internals/an-instance"),N=_("../internals/create-property-descriptor"),k=_("../internals/create-non-enumerable-property"),F=_("../internals/is-integral-number"),G=_("../internals/to-length"),V=_("../internals/to-index"),j=_("../internals/to-offset"),H=_("../internals/to-uint8-clamped"),U=_("../internals/to-property-key"),X=_("../internals/has-own-property"),Y=_("../internals/classof"),z=_("../internals/is-object"),W=_("../internals/is-symbol"),Z=_("../internals/object-create"),Q=_("../internals/object-is-prototype-of"),ee=_("../internals/object-set-prototype-of"),te=_("../internals/object-get-own-property-names").f,re=_("../internals/typed-array-from"),ie=_("../internals/array-iteration").forEach,ne=_("../internals/set-species"),he=_("../internals/define-built-in-accessor"),pe=_("../internals/object-define-property"),K=_("../internals/object-get-own-property-descriptor"),ue=_("../internals/array-from-constructor-and-list"),le=_("../internals/internal-state"),ce=_("../internals/inherit-if-required"),_e=le.get,oe=le.set,de=le.enforce,me=pe.f,ye=K.f,ge=O.RangeError,we=I.ArrayBuffer,Te=we.prototype,Ee=I.DataView,De=D.NATIVE_ARRAY_BUFFER_VIEWS,fe=D.TYPED_ARRAY_TAG,Ce=D.TypedArray,Se=D.TypedArrayPrototype,be=D.isTypedArray,Re="BYTES_PER_ELEMENT",Ve="Wrong length",Pe=function(Fe,nt){he(Fe,nt,{configurable:!0,get:function(){return _e(this)[nt]}})},ke=function(Fe){var nt;return Q(Te,Fe)||(nt=Y(Fe))==="ArrayBuffer"||nt==="SharedArrayBuffer"},Ne=function(Fe,nt){return be(Fe)&&!W(nt)&&nt in Fe&&F(+nt)&&nt>=0},Ae=function(nt,Ze){return Ze=U(Ze),Ne(nt,Ze)?N(2,nt[Ze]):ye(nt,Ze)},Oe=function(nt,Ze,Xe){return Ze=U(Ze),Ne(nt,Ze)&&z(Xe)&&X(Xe,"value")&&!X(Xe,"get")&&!X(Xe,"set")&&!Xe.configurable&&(!X(Xe,"writable")||Xe.writable)&&(!X(Xe,"enumerable")||Xe.enumerable)?(nt[Ze]=Xe.value,nt):me(nt,Ze,Xe)};P?(De||(K.f=Ae,pe.f=Oe,Pe(Se,"buffer"),Pe(Se,"byteOffset"),Pe(Se,"byteLength"),Pe(Se,"length")),A({target:"Object",stat:!0,forced:!De},{getOwnPropertyDescriptor:Ae,defineProperty:Oe}),w.exports=function(Fe,nt,Ze){var Xe=Fe.match(/\d+/)[0]/8,$e=Fe+(Ze?"Clamped":"")+"Array",ot="get"+Fe,ut="set"+Fe,gt=O[$e],Ue=gt,We=Ue&&Ue.prototype,ht={},Be=function(pt,qe){var rt=_e(pt);return rt.view[ot](qe*Xe+rt.byteOffset,!0)},je=function(pt,qe,rt){var bt=_e(pt);bt.view[ut](qe*Xe+bt.byteOffset,Ze?H(rt):rt,!0)},Qe=function(pt,qe){me(pt,qe,{get:function(){return Be(this,qe)},set:function(rt){return je(this,qe,rt)},enumerable:!0})};De?E&&(Ue=nt(function(pt,qe,rt,bt){return M(pt,We),ce(function(){return z(qe)?ke(qe)?bt!==void 0?new gt(qe,j(rt,Xe),bt):rt!==void 0?new gt(qe,j(rt,Xe)):new gt(qe):be(qe)?ue(Ue,qe):R(re,Ue,qe):new gt(V(qe))}(),pt,Ue)}),ee&&ee(Ue,Ce),ie(te(gt),function(pt){pt in Ue||k(Ue,pt,gt[pt])}),Ue.prototype=We):(Ue=nt(function(pt,qe,rt,bt){M(pt,We);var Dt=0,Et=0,Lt,Ot,Kt;if(!z(qe))Kt=V(qe),Ot=Kt*Xe,Lt=new we(Ot);else if(ke(qe)){Lt=qe,Et=j(rt,Xe);var Jt=qe.byteLength;if(bt===void 0){if(Jt%Xe)throw new ge(Ve);if(Ot=Jt-Et,Ot<0)throw new ge(Ve)}else if(Ot=G(bt)*Xe,Ot+Et>Jt)throw new ge(Ve);Kt=Ot/Xe}else return be(qe)?ue(Ue,qe):R(re,Ue,qe);for(oe(pt,{buffer:Lt,byteOffset:Et,byteLength:Ot,length:Kt,view:new Ee(Lt)});Dt<Kt;)Qe(pt,Dt++)}),ee&&ee(Ue,Ce),We=Ue.prototype=Z(Se)),We.constructor!==Ue&&k(We,"constructor",Ue),de(We).TypedArrayConstructor=Ue,fe&&k(We,fe,$e);var st=Ue!==gt;ht[$e]=Ue,A({global:!0,constructor:!0,forced:st,sham:!De},ht),Re in Ue||k(Ue,Re,Xe),Re in We||k(We,Re,Xe),ne($e)}):w.exports=function(){}},{"../internals/an-instance":113,"../internals/array-buffer":118,"../internals/array-buffer-view-core":117,"../internals/array-from-constructor-and-list":122,"../internals/array-iteration":125,"../internals/classof":138,"../internals/create-non-enumerable-property":145,"../internals/create-property-descriptor":146,"../internals/define-built-in-accessor":148,"../internals/descriptors":153,"../internals/export":170,"../internals/function-call":177,"../internals/global":188,"../internals/has-own-property":189,"../internals/inherit-if-required":196,"../internals/internal-state":199,"../internals/is-integral-number":206,"../internals/is-object":208,"../internals/is-symbol":212,"../internals/object-create":229,"../internals/object-define-property":231,"../internals/object-get-own-property-descriptor":232,"../internals/object-get-own-property-names":234,"../internals/object-is-prototype-of":238,"../internals/object-set-prototype-of":242,"../internals/set-species":265,"../internals/to-index":281,"../internals/to-length":284,"../internals/to-offset":286,"../internals/to-property-key":289,"../internals/to-uint8-clamped":292,"../internals/typed-array-constructors-require-wrappers":295,"../internals/typed-array-from":297}],295:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/fails"),R=_("../internals/check-correctness-of-iteration"),P=_("../internals/array-buffer-view-core").NATIVE_ARRAY_BUFFER_VIEWS,E=A.ArrayBuffer,D=A.Int8Array;w.exports=!P||!O(function(){D(1)})||!O(function(){new D(-1)})||!R(function(I){new D,new D(null),new D(1.5),new D(I)},!0)||O(function(){return new D(new E(2),1,void 0).length!==1})},{"../internals/array-buffer-view-core":117,"../internals/check-correctness-of-iteration":136,"../internals/fails":171,"../internals/global":188}],296:[function(_,w,B){var A=_("../internals/array-from-constructor-and-list"),O=_("../internals/typed-array-species-constructor");w.exports=function(R,P){return A(O(R),P)}},{"../internals/array-from-constructor-and-list":122,"../internals/typed-array-species-constructor":298}],297:[function(_,w,B){var A=_("../internals/function-bind-context"),O=_("../internals/function-call"),R=_("../internals/a-constructor"),P=_("../internals/to-object"),E=_("../internals/length-of-array-like"),D=_("../internals/get-iterator"),I=_("../internals/get-iterator-method"),M=_("../internals/is-array-iterator-method"),N=_("../internals/is-big-int-array"),k=_("../internals/array-buffer-view-core").aTypedArrayConstructor,F=_("../internals/to-big-int");w.exports=function(V){var j=R(this),H=P(V),U=arguments.length,X=U>1?arguments[1]:void 0,Y=X!==void 0,z=I(H),W,Z,Q,ee,te,re,ie,ne;if(z&&!M(z))for(ie=D(H,z),ne=ie.next,H=[];!(re=O(ne,ie)).done;)H.push(re.value);for(Y&&U>2&&(X=A(X,arguments[2])),Z=E(H),Q=new(k(j))(Z),ee=N(Q),W=0;Z>W;W++)te=Y?X(H[W],W):H[W],Q[W]=ee?F(te):+te;return Q}},{"../internals/a-constructor":109,"../internals/array-buffer-view-core":117,"../internals/function-bind-context":175,"../internals/function-call":177,"../internals/get-iterator":184,"../internals/get-iterator-method":183,"../internals/is-array-iterator-method":200,"../internals/is-big-int-array":202,"../internals/length-of-array-like":219,"../internals/to-big-int":280,"../internals/to-object":285}],298:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/species-constructor"),R=A.aTypedArrayConstructor,P=A.getTypedArrayConstructor;w.exports=function(E){return R(O(E,P(E)))}},{"../internals/array-buffer-view-core":117,"../internals/species-constructor":270}],299:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=0,R=Math.random(),P=A(1 .toString);w.exports=function(E){return"Symbol("+(E===void 0?"":E)+")_"+P(++O+R,36)}},{"../internals/function-uncurry-this":181}],300:[function(_,w,B){var A=_("../internals/symbol-constructor-detection");w.exports=A&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":274}],301:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/fails");w.exports=A&&O(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":153,"../internals/fails":171}],302:[function(_,w,B){var A=TypeError;w.exports=function(O,R){if(O<R)throw new A("Not enough arguments");return O}},{}],303:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/is-callable"),R=A.WeakMap;w.exports=O(R)&&/native code/.test(String(R))},{"../internals/global":188,"../internals/is-callable":203}],304:[function(_,w,B){var A=_("../internals/path"),O=_("../internals/has-own-property"),R=_("../internals/well-known-symbol-wrapped"),P=_("../internals/object-define-property").f;w.exports=function(E){var D=A.Symbol||(A.Symbol={});O(D,E)||P(D,E,{value:R.f(E)})}},{"../internals/has-own-property":189,"../internals/object-define-property":231,"../internals/path":247,"../internals/well-known-symbol-wrapped":305}],305:[function(_,w,B){var A=_("../internals/well-known-symbol");B.f=A},{"../internals/well-known-symbol":306}],306:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/shared"),R=_("../internals/has-own-property"),P=_("../internals/uid"),E=_("../internals/symbol-constructor-detection"),D=_("../internals/use-symbol-as-uid"),I=A.Symbol,M=O("wks"),N=D?I.for||I:I&&I.withoutSetter||P;w.exports=function(k){return R(M,k)||(M[k]=E&&R(I,k)?I[k]:N("Symbol."+k)),M[k]}},{"../internals/global":188,"../internals/has-own-property":189,"../internals/shared":269,"../internals/symbol-constructor-detection":274,"../internals/uid":299,"../internals/use-symbol-as-uid":300}],307:[function(_,w,B){w.exports="	\n\v\f\r                　\u2028\u2029\uFEFF"},{}],308:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/global"),R=_("../internals/array-buffer"),P=_("../internals/set-species"),E="ArrayBuffer",D=R[E],I=O[E];A({global:!0,constructor:!0,forced:I!==D},{ArrayBuffer:D}),P(E)},{"../internals/array-buffer":118,"../internals/export":170,"../internals/global":188,"../internals/set-species":265}],309:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-uncurry-this-clause"),R=_("../internals/fails"),P=_("../internals/array-buffer"),E=_("../internals/an-object"),D=_("../internals/to-absolute-index"),I=_("../internals/to-length"),M=_("../internals/species-constructor"),N=P.ArrayBuffer,k=P.DataView,F=k.prototype,G=O(N.prototype.slice),V=O(F.getUint8),j=O(F.setUint8),H=R(function(){return!new N(2).slice(1,void 0).byteLength});A({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:H},{slice:function(X,Y){if(G&&Y===void 0)return G(E(this),X);for(var z=E(this).byteLength,W=D(X,z),Z=D(Y===void 0?z:Y,z),Q=new(M(this,N))(I(Z-W)),ee=new k(this),te=new k(Q),re=0;W<Z;)j(te,re++,V(ee,W++));return Q}})},{"../internals/an-object":114,"../internals/array-buffer":118,"../internals/export":170,"../internals/fails":171,"../internals/function-uncurry-this-clause":180,"../internals/species-constructor":270,"../internals/to-absolute-index":279,"../internals/to-length":284}],310:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/fails"),R=_("../internals/is-array"),P=_("../internals/is-object"),E=_("../internals/to-object"),D=_("../internals/length-of-array-like"),I=_("../internals/does-not-exceed-safe-integer"),M=_("../internals/create-property"),N=_("../internals/array-species-create"),k=_("../internals/array-method-has-species-support"),F=_("../internals/well-known-symbol"),G=_("../internals/engine-v8-version"),V=F("isConcatSpreadable"),j=G>=51||!O(function(){var X=[];return X[V]=!1,X.concat()[0]!==X}),H=function(X){if(!P(X))return!1;var Y=X[V];return Y!==void 0?!!Y:R(X)},U=!j||!k("concat");A({target:"Array",proto:!0,arity:1,forced:U},{concat:function(Y){var z=E(this),W=N(z,0),Z=0,Q,ee,te,re,ie;for(Q=-1,te=arguments.length;Q<te;Q++)if(ie=Q===-1?z:arguments[Q],H(ie))for(re=D(ie),I(Z+re),ee=0;ee<re;ee++,Z++)ee in ie&&M(W,Z,ie[ee]);else I(Z+1),M(W,Z++,ie);return W.length=Z,W}})},{"../internals/array-method-has-species-support":127,"../internals/array-species-create":134,"../internals/create-property":147,"../internals/does-not-exceed-safe-integer":155,"../internals/engine-v8-version":167,"../internals/export":170,"../internals/fails":171,"../internals/is-array":201,"../internals/is-object":208,"../internals/length-of-array-like":219,"../internals/to-object":285,"../internals/well-known-symbol":306}],311:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/array-fill"),R=_("../internals/add-to-unscopables");A({target:"Array",proto:!0},{fill:O}),R("fill")},{"../internals/add-to-unscopables":111,"../internals/array-fill":120,"../internals/export":170}],312:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/array-iteration").filter,R=_("../internals/array-method-has-species-support"),P=R("filter");A({target:"Array",proto:!0,forced:!P},{filter:function(D){return O(this,D,arguments.length>1?arguments[1]:void 0)}})},{"../internals/array-iteration":125,"../internals/array-method-has-species-support":127,"../internals/export":170}],313:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/array-iteration").find,R=_("../internals/add-to-unscopables"),P="find",E=!0;P in[]&&Array(1)[P](function(){E=!1}),A({target:"Array",proto:!0,forced:E},{find:function(I){return O(this,I,arguments.length>1?arguments[1]:void 0)}}),R(P)},{"../internals/add-to-unscopables":111,"../internals/array-iteration":125,"../internals/export":170}],314:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/array-from"),R=_("../internals/check-correctness-of-iteration"),P=!R(function(E){Array.from(E)});A({target:"Array",stat:!0,forced:P},{from:O})},{"../internals/array-from":123,"../internals/check-correctness-of-iteration":136,"../internals/export":170}],315:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/array-includes").includes,R=_("../internals/fails"),P=_("../internals/add-to-unscopables"),E=R(function(){return!Array(1).includes()});A({target:"Array",proto:!0,forced:E},{includes:function(I){return O(this,I,arguments.length>1?arguments[1]:void 0)}}),P("includes")},{"../internals/add-to-unscopables":111,"../internals/array-includes":124,"../internals/export":170,"../internals/fails":171}],316:[function(_,w,B){var A=_("../internals/to-indexed-object"),O=_("../internals/add-to-unscopables"),R=_("../internals/iterators"),P=_("../internals/internal-state"),E=_("../internals/object-define-property").f,D=_("../internals/iterator-define"),I=_("../internals/create-iter-result-object"),M=_("../internals/is-pure"),N=_("../internals/descriptors"),k="Array Iterator",F=P.set,G=P.getterFor(k);w.exports=D(Array,"Array",function(j,H){F(this,{type:k,target:A(j),index:0,kind:H})},function(){var j=G(this),H=j.target,U=j.index++;if(!H||U>=H.length)return j.target=void 0,I(void 0,!0);switch(j.kind){case"keys":return I(U,!1);case"values":return I(H[U],!1)}return I([U,H[U]],!1)},"values");var V=R.Arguments=R.Array;if(O("keys"),O("values"),O("entries"),!M&&N&&V.name!=="values")try{E(V,"name",{value:"values"})}catch(j){}},{"../internals/add-to-unscopables":111,"../internals/create-iter-result-object":144,"../internals/descriptors":153,"../internals/internal-state":199,"../internals/is-pure":210,"../internals/iterator-define":216,"../internals/iterators":218,"../internals/object-define-property":231,"../internals/to-indexed-object":282}],317:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-uncurry-this"),R=_("../internals/indexed-object"),P=_("../internals/to-indexed-object"),E=_("../internals/array-method-is-strict"),D=O([].join),I=R!==Object,M=I||!E("join",",");A({target:"Array",proto:!0,forced:M},{join:function(k){return D(P(this),k===void 0?",":k)}})},{"../internals/array-method-is-strict":128,"../internals/export":170,"../internals/function-uncurry-this":181,"../internals/indexed-object":195,"../internals/to-indexed-object":282}],318:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/array-iteration").map,R=_("../internals/array-method-has-species-support"),P=R("map");A({target:"Array",proto:!0,forced:!P},{map:function(D){return O(this,D,arguments.length>1?arguments[1]:void 0)}})},{"../internals/array-iteration":125,"../internals/array-method-has-species-support":127,"../internals/export":170}],319:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/is-array"),R=_("../internals/is-constructor"),P=_("../internals/is-object"),E=_("../internals/to-absolute-index"),D=_("../internals/length-of-array-like"),I=_("../internals/to-indexed-object"),M=_("../internals/create-property"),N=_("../internals/well-known-symbol"),k=_("../internals/array-method-has-species-support"),F=_("../internals/array-slice"),G=k("slice"),V=N("species"),j=Array,H=Math.max;A({target:"Array",proto:!0,forced:!G},{slice:function(X,Y){var z=I(this),W=D(z),Z=E(X,W),Q=E(Y===void 0?W:Y,W),ee,te,re;if(O(z)&&(ee=z.constructor,R(ee)&&(ee===j||O(ee.prototype))?ee=void 0:P(ee)&&(ee=ee[V],ee===null&&(ee=void 0)),ee===j||ee===void 0))return F(z,Z,Q);for(te=new(ee===void 0?j:ee)(H(Q-Z,0)),re=0;Z<Q;Z++,re++)Z in z&&M(te,re,z[Z]);return te.length=re,te}})},{"../internals/array-method-has-species-support":127,"../internals/array-slice":131,"../internals/create-property":147,"../internals/export":170,"../internals/is-array":201,"../internals/is-constructor":204,"../internals/is-object":208,"../internals/length-of-array-like":219,"../internals/to-absolute-index":279,"../internals/to-indexed-object":282,"../internals/well-known-symbol":306}],320:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-uncurry-this"),R=_("../internals/a-callable"),P=_("../internals/to-object"),E=_("../internals/length-of-array-like"),D=_("../internals/delete-property-or-throw"),I=_("../internals/to-string"),M=_("../internals/fails"),N=_("../internals/array-sort"),k=_("../internals/array-method-is-strict"),F=_("../internals/engine-ff-version"),G=_("../internals/engine-is-ie-or-edge"),V=_("../internals/engine-v8-version"),j=_("../internals/engine-webkit-version"),H=[],U=O(H.sort),X=O(H.push),Y=M(function(){H.sort(void 0)}),z=M(function(){H.sort(null)}),W=k("sort"),Z=!M(function(){if(V)return V<70;if(!(F&&F>3)){if(G)return!0;if(j)return j<603;var te="",re,ie,ne,he;for(re=65;re<76;re++){switch(ie=String.fromCharCode(re),re){case 66:case 69:case 70:case 72:ne=3;break;case 68:case 71:ne=4;break;default:ne=2}for(he=0;he<47;he++)H.push({k:ie+he,v:ne})}for(H.sort(function(pe,K){return K.v-pe.v}),he=0;he<H.length;he++)ie=H[he].k.charAt(0),te.charAt(te.length-1)!==ie&&(te+=ie);return te!=="DGBEFHACIJK"}}),Q=Y||!z||!W||!Z,ee=function(te){return function(re,ie){return ie===void 0?-1:re===void 0?1:te!==void 0?+te(re,ie)||0:I(re)>I(ie)?1:-1}};A({target:"Array",proto:!0,forced:Q},{sort:function(re){re!==void 0&&R(re);var ie=P(this);if(Z)return re===void 0?U(ie):U(ie,re);var ne=[],he=E(ie),pe,K;for(K=0;K<he;K++)K in ie&&X(ne,ie[K]);for(N(ne,ee(re)),pe=E(ne),K=0;K<pe;)ie[K]=ne[K++];for(;K<he;)D(ie,K++);return ie}})},{"../internals/a-callable":108,"../internals/array-method-is-strict":128,"../internals/array-sort":132,"../internals/delete-property-or-throw":152,"../internals/engine-ff-version":158,"../internals/engine-is-ie-or-edge":161,"../internals/engine-v8-version":167,"../internals/engine-webkit-version":168,"../internals/export":170,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/length-of-array-like":219,"../internals/to-object":285,"../internals/to-string":291}],321:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/to-object"),R=_("../internals/to-absolute-index"),P=_("../internals/to-integer-or-infinity"),E=_("../internals/length-of-array-like"),D=_("../internals/array-set-length"),I=_("../internals/does-not-exceed-safe-integer"),M=_("../internals/array-species-create"),N=_("../internals/create-property"),k=_("../internals/delete-property-or-throw"),F=_("../internals/array-method-has-species-support"),G=F("splice"),V=Math.max,j=Math.min;A({target:"Array",proto:!0,forced:!G},{splice:function(U,X){var Y=O(this),z=E(Y),W=R(U,z),Z=arguments.length,Q,ee,te,re,ie,ne;for(Z===0?Q=ee=0:Z===1?(Q=0,ee=z-W):(Q=Z-2,ee=j(V(P(X),0),z-W)),I(z+Q-ee),te=M(Y,ee),re=0;re<ee;re++)ie=W+re,ie in Y&&N(te,re,Y[ie]);if(te.length=ee,Q<ee){for(re=W;re<z-ee;re++)ie=re+ee,ne=re+Q,ie in Y?Y[ne]=Y[ie]:k(Y,ne);for(re=z;re>z-ee+Q;re--)k(Y,re-1)}else if(Q>ee)for(re=z-ee;re>W;re--)ie=re+ee-1,ne=re+Q-1,ie in Y?Y[ne]=Y[ie]:k(Y,ne);for(re=0;re<Q;re++)Y[re+W]=arguments[re+2];return D(Y,z-ee+Q),te}})},{"../internals/array-method-has-species-support":127,"../internals/array-set-length":130,"../internals/array-species-create":134,"../internals/create-property":147,"../internals/delete-property-or-throw":152,"../internals/does-not-exceed-safe-integer":155,"../internals/export":170,"../internals/length-of-array-like":219,"../internals/to-absolute-index":279,"../internals/to-integer-or-infinity":283,"../internals/to-object":285}],322:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/function-name").EXISTS,R=_("../internals/function-uncurry-this"),P=_("../internals/define-built-in-accessor"),E=Function.prototype,D=R(E.toString),I=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,M=R(I.exec),N="name";A&&!O&&P(E,N,{configurable:!0,get:function(){try{return M(I,D(this))[1]}catch(k){return""}}})},{"../internals/define-built-in-accessor":148,"../internals/descriptors":153,"../internals/function-name":178,"../internals/function-uncurry-this":181}],323:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/get-built-in"),R=_("../internals/function-apply"),P=_("../internals/function-call"),E=_("../internals/function-uncurry-this"),D=_("../internals/fails"),I=_("../internals/is-callable"),M=_("../internals/is-symbol"),N=_("../internals/array-slice"),k=_("../internals/get-json-replacer-function"),F=_("../internals/symbol-constructor-detection"),G=String,V=O("JSON","stringify"),j=E(/./.exec),H=E("".charAt),U=E("".charCodeAt),X=E("".replace),Y=E(1 .toString),z=/[\uD800-\uDFFF]/g,W=/^[\uD800-\uDBFF]$/,Z=/^[\uDC00-\uDFFF]$/,Q=!F||D(function(){var ie=O("Symbol")("stringify detection");return V([ie])!=="[null]"||V({a:ie})!=="{}"||V(Object(ie))!=="{}"}),ee=D(function(){return V("\uDF06\uD834")!=='"\\udf06\\ud834"'||V("\uDEAD")!=='"\\udead"'}),te=function(ie,ne){var he=N(arguments),pe=k(ne);if(!(!I(pe)&&(ie===void 0||M(ie))))return he[1]=function(K,ue){if(I(pe)&&(ue=P(pe,this,G(K),ue)),!M(ue))return ue},R(V,null,he)},re=function(ie,ne,he){var pe=H(he,ne-1),K=H(he,ne+1);return j(W,ie)&&!j(Z,K)||j(Z,ie)&&!j(W,pe)?"\\u"+Y(U(ie,0),16):ie};V&&A({target:"JSON",stat:!0,arity:3,forced:Q||ee},{stringify:function(ne,he,pe){var K=N(arguments),ue=R(Q?te:V,null,K);return ee&&typeof ue=="string"?X(ue,z,re):ue}})},{"../internals/array-slice":131,"../internals/export":170,"../internals/fails":171,"../internals/function-apply":174,"../internals/function-call":177,"../internals/function-uncurry-this":181,"../internals/get-built-in":182,"../internals/get-json-replacer-function":185,"../internals/is-callable":203,"../internals/is-symbol":212,"../internals/symbol-constructor-detection":274}],324:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/is-pure"),R=_("../internals/descriptors"),P=_("../internals/global"),E=_("../internals/path"),D=_("../internals/function-uncurry-this"),I=_("../internals/is-forced"),M=_("../internals/has-own-property"),N=_("../internals/inherit-if-required"),k=_("../internals/object-is-prototype-of"),F=_("../internals/is-symbol"),G=_("../internals/to-primitive"),V=_("../internals/fails"),j=_("../internals/object-get-own-property-names").f,H=_("../internals/object-get-own-property-descriptor").f,U=_("../internals/object-define-property").f,X=_("../internals/this-number-value"),Y=_("../internals/string-trim").trim,z="Number",W=P[z],Z=E[z],Q=W.prototype,ee=P.TypeError,te=D("".slice),re=D("".charCodeAt),ie=function(le){var ce=G(le,"number");return typeof ce=="bigint"?ce:ne(ce)},ne=function(le){var ce=G(le,"number"),_e,oe,de,me,ye,ge,we,Te;if(F(ce))throw new ee("Cannot convert a Symbol value to a number");if(typeof ce=="string"&&ce.length>2){if(ce=Y(ce),_e=re(ce,0),_e===43||_e===45){if(oe=re(ce,2),oe===88||oe===120)return NaN}else if(_e===48){switch(re(ce,1)){case 66:case 98:de=2,me=49;break;case 79:case 111:de=8,me=55;break;default:return+ce}for(ye=te(ce,2),ge=ye.length,we=0;we<ge;we++)if(Te=re(ye,we),Te<48||Te>me)return NaN;return parseInt(ye,de)}}return+ce},he=I(z,!W(" 0o1")||!W("0b1")||W("+0x1")),pe=function(le){return k(Q,le)&&V(function(){X(le)})},K=function(ce){var _e=arguments.length<1?0:W(ie(ce));return pe(this)?N(Object(_e),this,K):_e};K.prototype=Q,he&&!O&&(Q.constructor=K),A({global:!0,constructor:!0,wrap:!0,forced:he},{Number:K});var ue=function(le,ce){for(var _e=R?j(ce):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),oe=0,de;_e.length>oe;oe++)M(ce,de=_e[oe])&&!M(le,de)&&U(le,de,H(ce,de))};O&&Z&&ue(E[z],Z),(he||O)&&ue(E[z],W)},{"../internals/descriptors":153,"../internals/export":170,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/global":188,"../internals/has-own-property":189,"../internals/inherit-if-required":196,"../internals/is-forced":205,"../internals/is-pure":210,"../internals/is-symbol":212,"../internals/object-define-property":231,"../internals/object-get-own-property-descriptor":232,"../internals/object-get-own-property-names":234,"../internals/object-is-prototype-of":238,"../internals/path":247,"../internals/string-trim":273,"../internals/this-number-value":278,"../internals/to-primitive":288}],325:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/object-assign");A({target:"Object",stat:!0,arity:2,forced:Object.assign!==O},{assign:O})},{"../internals/export":170,"../internals/object-assign":228}],326:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/object-to-array").entries;A({target:"Object",stat:!0},{entries:function(P){return O(P)}})},{"../internals/export":170,"../internals/object-to-array":243}],327:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/symbol-constructor-detection"),R=_("../internals/fails"),P=_("../internals/object-get-own-property-symbols"),E=_("../internals/to-object"),D=!O||R(function(){P.f(1)});A({target:"Object",stat:!0,forced:D},{getOwnPropertySymbols:function(M){var N=P.f;return N?N(E(M)):[]}})},{"../internals/export":170,"../internals/fails":171,"../internals/object-get-own-property-symbols":235,"../internals/symbol-constructor-detection":274,"../internals/to-object":285}],328:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/to-object"),R=_("../internals/object-keys"),P=_("../internals/fails"),E=P(function(){R(1)});A({target:"Object",stat:!0,forced:E},{keys:function(I){return R(O(I))}})},{"../internals/export":170,"../internals/fails":171,"../internals/object-keys":240,"../internals/to-object":285}],329:[function(_,w,B){var A=_("../internals/to-string-tag-support"),O=_("../internals/define-built-in"),R=_("../internals/object-to-string");A||O(Object.prototype,"toString",R,{unsafe:!0})},{"../internals/define-built-in":149,"../internals/object-to-string":244,"../internals/to-string-tag-support":290}],330:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-call"),R=_("../internals/a-callable"),P=_("../internals/new-promise-capability"),E=_("../internals/perform"),D=_("../internals/iterate"),I=_("../internals/promise-statics-incorrect-iteration");A({target:"Promise",stat:!0,forced:I},{all:function(N){var k=this,F=P.f(k),G=F.resolve,V=F.reject,j=E(function(){var H=R(k.resolve),U=[],X=0,Y=1;D(N,function(z){var W=X++,Z=!1;Y++,O(H,k,z).then(function(Q){Z||(Z=!0,U[W]=Q,--Y||G(U))},V)}),--Y||G(U)});return j.error&&V(j.value),F.promise}})},{"../internals/a-callable":108,"../internals/export":170,"../internals/function-call":177,"../internals/iterate":213,"../internals/new-promise-capability":226,"../internals/perform":248,"../internals/promise-statics-incorrect-iteration":252}],331:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/is-pure"),R=_("../internals/promise-constructor-detection").CONSTRUCTOR,P=_("../internals/promise-native-constructor"),E=_("../internals/get-built-in"),D=_("../internals/is-callable"),I=_("../internals/define-built-in"),M=P&&P.prototype;if(A({target:"Promise",proto:!0,forced:R,real:!0},{catch:function(k){return this.then(void 0,k)}}),!O&&D(P)){var N=E("Promise").prototype.catch;M.catch!==N&&I(M,"catch",N,{unsafe:!0})}},{"../internals/define-built-in":149,"../internals/export":170,"../internals/get-built-in":182,"../internals/is-callable":203,"../internals/is-pure":210,"../internals/promise-constructor-detection":249,"../internals/promise-native-constructor":250}],332:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/is-pure"),R=_("../internals/engine-is-node"),P=_("../internals/global"),E=_("../internals/function-call"),D=_("../internals/define-built-in"),I=_("../internals/object-set-prototype-of"),M=_("../internals/set-to-string-tag"),N=_("../internals/set-species"),k=_("../internals/a-callable"),F=_("../internals/is-callable"),G=_("../internals/is-object"),V=_("../internals/an-instance"),j=_("../internals/species-constructor"),H=_("../internals/task").set,U=_("../internals/microtask"),X=_("../internals/host-report-errors"),Y=_("../internals/perform"),z=_("../internals/queue"),W=_("../internals/internal-state"),Z=_("../internals/promise-native-constructor"),Q=_("../internals/promise-constructor-detection"),ee=_("../internals/new-promise-capability"),te="Promise",re=Q.CONSTRUCTOR,ie=Q.REJECTION_EVENT,ne=Q.SUBCLASSING,he=W.getterFor(te),pe=W.set,K=Z&&Z.prototype,ue=Z,le=K,ce=P.TypeError,_e=P.document,oe=P.process,de=ee.f,me=de,ye=!!(_e&&_e.createEvent&&P.dispatchEvent),ge="unhandledrejection",we="rejectionhandled",Te=0,Ee=1,De=2,fe=1,Ce=2,Se,be,Re,Ve,Pe=function(ot){var ut;return G(ot)&&F(ut=ot.then)?ut:!1},ke=function(ot,ut){var gt=ut.value,Ue=ut.state===Ee,We=Ue?ot.ok:ot.fail,ht=ot.resolve,Be=ot.reject,je=ot.domain,Qe,st,pt;try{We?(Ue||(ut.rejection===Ce&&nt(ut),ut.rejection=fe),We===!0?Qe=gt:(je&&je.enter(),Qe=We(gt),je&&(je.exit(),pt=!0)),Qe===ot.promise?Be(new ce("Promise-chain cycle")):(st=Pe(Qe))?E(st,Qe,ht,Be):ht(Qe)):Be(gt)}catch(qe){je&&!pt&&je.exit(),Be(qe)}},Ne=function(ot,ut){ot.notified||(ot.notified=!0,U(function(){for(var gt=ot.reactions,Ue;Ue=gt.get();)ke(Ue,ot);ot.notified=!1,ut&&!ot.rejection&&Oe(ot)}))},Ae=function(ot,ut,gt){var Ue,We;ye?(Ue=_e.createEvent("Event"),Ue.promise=ut,Ue.reason=gt,Ue.initEvent(ot,!1,!0),P.dispatchEvent(Ue)):Ue={promise:ut,reason:gt},!ie&&(We=P["on"+ot])?We(Ue):ot===ge&&X("Unhandled promise rejection",gt)},Oe=function(ot){E(H,P,function(){var ut=ot.facade,gt=ot.value,Ue=Fe(ot),We;if(Ue&&(We=Y(function(){R?oe.emit("unhandledRejection",gt,ut):Ae(ge,ut,gt)}),ot.rejection=R||Fe(ot)?Ce:fe,We.error))throw We.value})},Fe=function(ot){return ot.rejection!==fe&&!ot.parent},nt=function(ot){E(H,P,function(){var ut=ot.facade;R?oe.emit("rejectionHandled",ut):Ae(we,ut,ot.value)})},Ze=function(ot,ut,gt){return function(Ue){ot(ut,Ue,gt)}},Xe=function(ot,ut,gt){ot.done||(ot.done=!0,gt&&(ot=gt),ot.value=ut,ot.state=De,Ne(ot,!0))},$e=function(ot,ut,gt){if(!ot.done){ot.done=!0,gt&&(ot=gt);try{if(ot.facade===ut)throw new ce("Promise can't be resolved itself");var Ue=Pe(ut);Ue?U(function(){var We={done:!1};try{E(Ue,ut,Ze($e,We,ot),Ze(Xe,We,ot))}catch(ht){Xe(We,ht,ot)}}):(ot.value=ut,ot.state=Ee,Ne(ot,!1))}catch(We){Xe({done:!1},We,ot)}}};if(re&&(ue=function(ut){V(this,le),k(ut),E(Se,this);var gt=he(this);try{ut(Ze($e,gt),Ze(Xe,gt))}catch(Ue){Xe(gt,Ue)}},le=ue.prototype,Se=function(ut){pe(this,{type:te,done:!1,notified:!1,parent:!1,reactions:new z,rejection:!1,state:Te,value:void 0})},Se.prototype=D(le,"then",function(ut,gt){var Ue=he(this),We=de(j(this,ue));return Ue.parent=!0,We.ok=F(ut)?ut:!0,We.fail=F(gt)&&gt,We.domain=R?oe.domain:void 0,Ue.state===Te?Ue.reactions.add(We):U(function(){ke(We,Ue)}),We.promise}),be=function(){var ot=new Se,ut=he(ot);this.promise=ot,this.resolve=Ze($e,ut),this.reject=Ze(Xe,ut)},ee.f=de=function(ot){return ot===ue||ot===Re?new be(ot):me(ot)},!O&&F(Z)&&K!==Object.prototype)){Ve=K.then,ne||D(K,"then",function(ut,gt){var Ue=this;return new ue(function(We,ht){E(Ve,Ue,We,ht)}).then(ut,gt)},{unsafe:!0});try{delete K.constructor}catch(ot){}I&&I(K,le)}A({global:!0,constructor:!0,wrap:!0,forced:re},{Promise:ue}),M(ue,te,!1,!0),N(te)},{"../internals/a-callable":108,"../internals/an-instance":113,"../internals/define-built-in":149,"../internals/engine-is-node":164,"../internals/export":170,"../internals/function-call":177,"../internals/global":188,"../internals/host-report-errors":191,"../internals/internal-state":199,"../internals/is-callable":203,"../internals/is-object":208,"../internals/is-pure":210,"../internals/microtask":225,"../internals/new-promise-capability":226,"../internals/object-set-prototype-of":242,"../internals/perform":248,"../internals/promise-constructor-detection":249,"../internals/promise-native-constructor":250,"../internals/queue":254,"../internals/set-species":265,"../internals/set-to-string-tag":266,"../internals/species-constructor":270,"../internals/task":277}],333:[function(_,w,B){_("../modules/es.promise.constructor"),_("../modules/es.promise.all"),_("../modules/es.promise.catch"),_("../modules/es.promise.race"),_("../modules/es.promise.reject"),_("../modules/es.promise.resolve")},{"../modules/es.promise.all":330,"../modules/es.promise.catch":331,"../modules/es.promise.constructor":332,"../modules/es.promise.race":334,"../modules/es.promise.reject":335,"../modules/es.promise.resolve":336}],334:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-call"),R=_("../internals/a-callable"),P=_("../internals/new-promise-capability"),E=_("../internals/perform"),D=_("../internals/iterate"),I=_("../internals/promise-statics-incorrect-iteration");A({target:"Promise",stat:!0,forced:I},{race:function(N){var k=this,F=P.f(k),G=F.reject,V=E(function(){var j=R(k.resolve);D(N,function(H){O(j,k,H).then(F.resolve,G)})});return V.error&&G(V.value),F.promise}})},{"../internals/a-callable":108,"../internals/export":170,"../internals/function-call":177,"../internals/iterate":213,"../internals/new-promise-capability":226,"../internals/perform":248,"../internals/promise-statics-incorrect-iteration":252}],335:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/new-promise-capability"),R=_("../internals/promise-constructor-detection").CONSTRUCTOR;A({target:"Promise",stat:!0,forced:R},{reject:function(E){var D=O.f(this),I=D.reject;return I(E),D.promise}})},{"../internals/export":170,"../internals/new-promise-capability":226,"../internals/promise-constructor-detection":249}],336:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/get-built-in"),R=_("../internals/is-pure"),P=_("../internals/promise-native-constructor"),E=_("../internals/promise-constructor-detection").CONSTRUCTOR,D=_("../internals/promise-resolve"),I=O("Promise"),M=R&&!E;A({target:"Promise",stat:!0,forced:R||E},{resolve:function(k){return D(M&&this===I?P:this,k)}})},{"../internals/export":170,"../internals/get-built-in":182,"../internals/is-pure":210,"../internals/promise-constructor-detection":249,"../internals/promise-native-constructor":250,"../internals/promise-resolve":251}],337:[function(_,w,B){var A=_("../internals/descriptors"),O=_("../internals/global"),R=_("../internals/function-uncurry-this"),P=_("../internals/is-forced"),E=_("../internals/inherit-if-required"),D=_("../internals/create-non-enumerable-property"),I=_("../internals/object-create"),M=_("../internals/object-get-own-property-names").f,N=_("../internals/object-is-prototype-of"),k=_("../internals/is-regexp"),F=_("../internals/to-string"),G=_("../internals/regexp-get-flags"),V=_("../internals/regexp-sticky-helpers"),j=_("../internals/proxy-accessor"),H=_("../internals/define-built-in"),U=_("../internals/fails"),X=_("../internals/has-own-property"),Y=_("../internals/internal-state").enforce,z=_("../internals/set-species"),W=_("../internals/well-known-symbol"),Z=_("../internals/regexp-unsupported-dot-all"),Q=_("../internals/regexp-unsupported-ncg"),ee=W("match"),te=O.RegExp,re=te.prototype,ie=O.SyntaxError,ne=R(re.exec),he=R("".charAt),pe=R("".replace),K=R("".indexOf),ue=R("".slice),le=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,ce=/a/g,_e=/a/g,oe=new te(ce)!==ce,de=V.MISSED_STICKY,me=V.UNSUPPORTED_Y,ye=A&&(!oe||de||Z||Q||U(function(){return _e[ee]=!1,te(ce)!==ce||te(_e)===_e||String(te(ce,"i"))!=="/a/i"})),ge=function(fe){for(var Ce=fe.length,Se=0,be="",Re=!1,Ve;Se<=Ce;Se++){if(Ve=he(fe,Se),Ve==="\\"){be+=Ve+he(fe,++Se);continue}!Re&&Ve==="."?be+="[\\s\\S]":(Ve==="["?Re=!0:Ve==="]"&&(Re=!1),be+=Ve)}return be},we=function(fe){for(var Ce=fe.length,Se=0,be="",Re=[],Ve=I(null),Pe=!1,ke=!1,Ne=0,Ae="",Oe;Se<=Ce;Se++){if(Oe=he(fe,Se),Oe==="\\")Oe+=he(fe,++Se);else if(Oe==="]")Pe=!1;else if(!Pe)switch(!0){case Oe==="[":Pe=!0;break;case Oe==="(":ne(le,ue(fe,Se+1))&&(Se+=2,ke=!0),be+=Oe,Ne++;continue;case(Oe===">"&&ke):if(Ae===""||X(Ve,Ae))throw new ie("Invalid capture group name");Ve[Ae]=!0,Re[Re.length]=[Ae,Ne],ke=!1,Ae="";continue}ke?Ae+=Oe:be+=Oe}return[be,Re]};if(P("RegExp",ye)){for(var Te=function(Ce,Se){var be=N(re,this),Re=k(Ce),Ve=Se===void 0,Pe=[],ke=Ce,Ne,Ae,Oe,Fe,nt,Ze;if(!be&&Re&&Ve&&Ce.constructor===Te)return Ce;if((Re||N(re,Ce))&&(Ce=Ce.source,Ve&&(Se=G(ke))),Ce=Ce===void 0?"":F(Ce),Se=Se===void 0?"":F(Se),ke=Ce,Z&&"dotAll"in ce&&(Ae=!!Se&&K(Se,"s")>-1,Ae&&(Se=pe(Se,/s/g,""))),Ne=Se,de&&"sticky"in ce&&(Oe=!!Se&&K(Se,"y")>-1,Oe&&me&&(Se=pe(Se,/y/g,""))),Q&&(Fe=we(Ce),Ce=Fe[0],Pe=Fe[1]),nt=E(te(Ce,Se),be?this:re,Te),(Ae||Oe||Pe.length)&&(Ze=Y(nt),Ae&&(Ze.dotAll=!0,Ze.raw=Te(ge(Ce),Ne)),Oe&&(Ze.sticky=!0),Pe.length&&(Ze.groups=Pe)),Ce!==ke)try{D(nt,"source",ke===""?"(?:)":ke)}catch(Xe){}return nt},Ee=M(te),De=0;Ee.length>De;)j(Te,te,Ee[De++]);re.constructor=Te,Te.prototype=re,H(O,"RegExp",Te,{constructor:!0})}z("RegExp")},{"../internals/create-non-enumerable-property":145,"../internals/define-built-in":149,"../internals/descriptors":153,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/global":188,"../internals/has-own-property":189,"../internals/inherit-if-required":196,"../internals/internal-state":199,"../internals/is-forced":205,"../internals/is-regexp":211,"../internals/object-create":229,"../internals/object-get-own-property-names":234,"../internals/object-is-prototype-of":238,"../internals/proxy-accessor":253,"../internals/regexp-get-flags":258,"../internals/regexp-sticky-helpers":259,"../internals/regexp-unsupported-dot-all":260,"../internals/regexp-unsupported-ncg":261,"../internals/set-species":265,"../internals/to-string":291,"../internals/well-known-symbol":306}],338:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/regexp-exec");A({target:"RegExp",proto:!0,forced:/./.exec!==O},{exec:O})},{"../internals/export":170,"../internals/regexp-exec":256}],339:[function(_,w,B){var A=_("../internals/function-name").PROPER,O=_("../internals/define-built-in"),R=_("../internals/an-object"),P=_("../internals/to-string"),E=_("../internals/fails"),D=_("../internals/regexp-get-flags"),I="toString",M=RegExp.prototype,N=M[I],k=E(function(){return N.call({source:"a",flags:"b"})!=="/a/b"}),F=A&&N.name!==I;(k||F)&&O(M,I,function(){var V=R(this),j=P(V.source),H=P(D(V));return"/"+j+"/"+H},{unsafe:!0})},{"../internals/an-object":114,"../internals/define-built-in":149,"../internals/fails":171,"../internals/function-name":178,"../internals/regexp-get-flags":258,"../internals/to-string":291}],340:[function(_,w,B){var A=_("../internals/collection"),O=_("../internals/collection-strong");A("Set",function(R){return function(){return R(this,arguments.length?arguments[0]:void 0)}},O)},{"../internals/collection":140,"../internals/collection-strong":139}],341:[function(_,w,B){_("../modules/es.set.constructor")},{"../modules/es.set.constructor":340}],342:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-uncurry-this"),R=_("../internals/not-a-regexp"),P=_("../internals/require-object-coercible"),E=_("../internals/to-string"),D=_("../internals/correct-is-regexp-logic"),I=O("".indexOf);A({target:"String",proto:!0,forced:!D("includes")},{includes:function(N){return!!~I(E(P(this)),E(R(N)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":142,"../internals/export":170,"../internals/function-uncurry-this":181,"../internals/not-a-regexp":227,"../internals/require-object-coercible":262,"../internals/to-string":291}],343:[function(_,w,B){var A=_("../internals/string-multibyte").charAt,O=_("../internals/to-string"),R=_("../internals/internal-state"),P=_("../internals/iterator-define"),E=_("../internals/create-iter-result-object"),D="String Iterator",I=R.set,M=R.getterFor(D);P(String,"String",function(N){I(this,{type:D,string:O(N),index:0})},function(){var k=M(this),F=k.string,G=k.index,V;return G>=F.length?E(void 0,!0):(V=A(F,G),k.index+=V.length,E(V,!1))})},{"../internals/create-iter-result-object":144,"../internals/internal-state":199,"../internals/iterator-define":216,"../internals/string-multibyte":271,"../internals/to-string":291}],344:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/fix-regexp-well-known-symbol-logic"),R=_("../internals/an-object"),P=_("../internals/is-null-or-undefined"),E=_("../internals/to-length"),D=_("../internals/to-string"),I=_("../internals/require-object-coercible"),M=_("../internals/get-method"),N=_("../internals/advance-string-index"),k=_("../internals/regexp-exec-abstract");O("match",function(F,G,V){return[function(H){var U=I(this),X=P(H)?void 0:M(H,F);return X?A(X,H,U):new RegExp(H)[F](D(U))},function(j){var H=R(this),U=D(j),X=V(G,H,U);if(X.done)return X.value;if(!H.global)return k(H,U);var Y=H.unicode;H.lastIndex=0;for(var z=[],W=0,Z;(Z=k(H,U))!==null;){var Q=D(Z[0]);z[W]=Q,Q===""&&(H.lastIndex=N(U,E(H.lastIndex),Y)),W++}return W===0?null:z}]})},{"../internals/advance-string-index":112,"../internals/an-object":114,"../internals/fix-regexp-well-known-symbol-logic":172,"../internals/function-call":177,"../internals/get-method":186,"../internals/is-null-or-undefined":207,"../internals/regexp-exec-abstract":255,"../internals/require-object-coercible":262,"../internals/to-length":284,"../internals/to-string":291}],345:[function(_,w,B){var A=_("../internals/function-apply"),O=_("../internals/function-call"),R=_("../internals/function-uncurry-this"),P=_("../internals/fix-regexp-well-known-symbol-logic"),E=_("../internals/fails"),D=_("../internals/an-object"),I=_("../internals/is-callable"),M=_("../internals/is-null-or-undefined"),N=_("../internals/to-integer-or-infinity"),k=_("../internals/to-length"),F=_("../internals/to-string"),G=_("../internals/require-object-coercible"),V=_("../internals/advance-string-index"),j=_("../internals/get-method"),H=_("../internals/get-substitution"),U=_("../internals/regexp-exec-abstract"),X=_("../internals/well-known-symbol"),Y=X("replace"),z=Math.max,W=Math.min,Z=R([].concat),Q=R([].push),ee=R("".indexOf),te=R("".slice),re=function(pe){return pe===void 0?pe:String(pe)},ie=function(){return"a".replace(/./,"$0")==="$0"}(),ne=function(){return/./[Y]?/./[Y]("a","$0")==="":!1}(),he=!E(function(){var pe=/./;return pe.exec=function(){var K=[];return K.groups={a:"7"},K},"".replace(pe,"$<a>")!=="7"});P("replace",function(pe,K,ue){var le=ne?"$":"$0";return[function(_e,oe){var de=G(this),me=M(_e)?void 0:j(_e,Y);return me?O(me,_e,de,oe):O(K,F(de),_e,oe)},function(ce,_e){var oe=D(this),de=F(ce);if(typeof _e=="string"&&ee(_e,le)===-1&&ee(_e,"$<")===-1){var me=ue(K,oe,de,_e);if(me.done)return me.value}var ye=I(_e);ye||(_e=F(_e));var ge=oe.global,we;ge&&(we=oe.unicode,oe.lastIndex=0);for(var Te=[],Ee;Ee=U(oe,de),!(Ee===null||(Q(Te,Ee),!ge));){var De=F(Ee[0]);De===""&&(oe.lastIndex=V(de,k(oe.lastIndex),we))}for(var fe="",Ce=0,Se=0;Se<Te.length;Se++){Ee=Te[Se];for(var be=F(Ee[0]),Re=z(W(N(Ee.index),de.length),0),Ve=[],Pe,ke=1;ke<Ee.length;ke++)Q(Ve,re(Ee[ke]));var Ne=Ee.groups;if(ye){var Ae=Z([be],Ve,Re,de);Ne!==void 0&&Q(Ae,Ne),Pe=F(A(_e,void 0,Ae))}else Pe=H(be,de,Re,Ve,Ne,_e);Re>=Ce&&(fe+=te(de,Ce,Re)+Pe,Ce=Re+be.length)}return fe+te(de,Ce)}]},!he||!ie||ne)},{"../internals/advance-string-index":112,"../internals/an-object":114,"../internals/fails":171,"../internals/fix-regexp-well-known-symbol-logic":172,"../internals/function-apply":174,"../internals/function-call":177,"../internals/function-uncurry-this":181,"../internals/get-method":186,"../internals/get-substitution":187,"../internals/is-callable":203,"../internals/is-null-or-undefined":207,"../internals/regexp-exec-abstract":255,"../internals/require-object-coercible":262,"../internals/to-integer-or-infinity":283,"../internals/to-length":284,"../internals/to-string":291,"../internals/well-known-symbol":306}],346:[function(_,w,B){var A=_("../internals/function-call"),O=_("../internals/fix-regexp-well-known-symbol-logic"),R=_("../internals/an-object"),P=_("../internals/is-null-or-undefined"),E=_("../internals/require-object-coercible"),D=_("../internals/same-value"),I=_("../internals/to-string"),M=_("../internals/get-method"),N=_("../internals/regexp-exec-abstract");O("search",function(k,F,G){return[function(j){var H=E(this),U=P(j)?void 0:M(j,k);return U?A(U,j,H):new RegExp(j)[k](I(H))},function(V){var j=R(this),H=I(V),U=G(F,j,H);if(U.done)return U.value;var X=j.lastIndex;D(X,0)||(j.lastIndex=0);var Y=N(j,H);return D(j.lastIndex,X)||(j.lastIndex=X),Y===null?-1:Y.index}]})},{"../internals/an-object":114,"../internals/fix-regexp-well-known-symbol-logic":172,"../internals/function-call":177,"../internals/get-method":186,"../internals/is-null-or-undefined":207,"../internals/regexp-exec-abstract":255,"../internals/require-object-coercible":262,"../internals/same-value":264,"../internals/to-string":291}],347:[function(_,w,B){var A=_("../internals/function-apply"),O=_("../internals/function-call"),R=_("../internals/function-uncurry-this"),P=_("../internals/fix-regexp-well-known-symbol-logic"),E=_("../internals/an-object"),D=_("../internals/is-null-or-undefined"),I=_("../internals/is-regexp"),M=_("../internals/require-object-coercible"),N=_("../internals/species-constructor"),k=_("../internals/advance-string-index"),F=_("../internals/to-length"),G=_("../internals/to-string"),V=_("../internals/get-method"),j=_("../internals/array-slice"),H=_("../internals/regexp-exec-abstract"),U=_("../internals/regexp-exec"),X=_("../internals/regexp-sticky-helpers"),Y=_("../internals/fails"),z=X.UNSUPPORTED_Y,W=4294967295,Z=Math.min,Q=[].push,ee=R(/./.exec),te=R(Q),re=R("".slice),ie=!Y(function(){var ne=/(?:)/,he=ne.exec;ne.exec=function(){return he.apply(this,arguments)};var pe="ab".split(ne);return pe.length!==2||pe[0]!=="a"||pe[1]!=="b"});P("split",function(ne,he,pe){var K;return"abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length?K=function(ue,le){var ce=G(M(this)),_e=le===void 0?W:le>>>0;if(_e===0)return[];if(ue===void 0)return[ce];if(!I(ue))return O(he,ce,ue,_e);for(var oe=[],de=(ue.ignoreCase?"i":"")+(ue.multiline?"m":"")+(ue.unicode?"u":"")+(ue.sticky?"y":""),me=0,ye=new RegExp(ue.source,de+"g"),ge,we,Te;(ge=O(U,ye,ce))&&(we=ye.lastIndex,!(we>me&&(te(oe,re(ce,me,ge.index)),ge.length>1&&ge.index<ce.length&&A(Q,oe,j(ge,1)),Te=ge[0].length,me=we,oe.length>=_e)));)ye.lastIndex===ge.index&&ye.lastIndex++;return me===ce.length?(Te||!ee(ye,""))&&te(oe,""):te(oe,re(ce,me)),oe.length>_e?j(oe,0,_e):oe}:"0".split(void 0,0).length?K=function(ue,le){return ue===void 0&&le===0?[]:O(he,this,ue,le)}:K=he,[function(le,ce){var _e=M(this),oe=D(le)?void 0:V(le,ne);return oe?O(oe,le,_e,ce):O(K,G(_e),le,ce)},function(ue,le){var ce=E(this),_e=G(ue),oe=pe(K,ce,_e,le,K!==he);if(oe.done)return oe.value;var de=N(ce,RegExp),me=ce.unicode,ye=(ce.ignoreCase?"i":"")+(ce.multiline?"m":"")+(ce.unicode?"u":"")+(z?"g":"y"),ge=new de(z?"^(?:"+ce.source+")":ce,ye),we=le===void 0?W:le>>>0;if(we===0)return[];if(_e.length===0)return H(ge,_e)===null?[_e]:[];for(var Te=0,Ee=0,De=[];Ee<_e.length;){ge.lastIndex=z?0:Ee;var fe=H(ge,z?re(_e,Ee):_e),Ce;if(fe===null||(Ce=Z(F(ge.lastIndex+(z?Ee:0)),_e.length))===Te)Ee=k(_e,Ee,me);else{if(te(De,re(_e,Te,Ee)),De.length===we)return De;for(var Se=1;Se<=fe.length-1;Se++)if(te(De,fe[Se]),De.length===we)return De;Ee=Te=Ce}}return te(De,re(_e,Te)),De}]},!ie,z)},{"../internals/advance-string-index":112,"../internals/an-object":114,"../internals/array-slice":131,"../internals/fails":171,"../internals/fix-regexp-well-known-symbol-logic":172,"../internals/function-apply":174,"../internals/function-call":177,"../internals/function-uncurry-this":181,"../internals/get-method":186,"../internals/is-null-or-undefined":207,"../internals/is-regexp":211,"../internals/regexp-exec":256,"../internals/regexp-exec-abstract":255,"../internals/regexp-sticky-helpers":259,"../internals/require-object-coercible":262,"../internals/species-constructor":270,"../internals/to-length":284,"../internals/to-string":291}],348:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/function-uncurry-this-clause"),R=_("../internals/object-get-own-property-descriptor").f,P=_("../internals/to-length"),E=_("../internals/to-string"),D=_("../internals/not-a-regexp"),I=_("../internals/require-object-coercible"),M=_("../internals/correct-is-regexp-logic"),N=_("../internals/is-pure"),k=O("".slice),F=Math.min,G=M("startsWith"),V=!N&&!G&&!!function(){var j=R(String.prototype,"startsWith");return j&&!j.writable}();A({target:"String",proto:!0,forced:!V&&!G},{startsWith:function(H){var U=E(I(this));D(H);var X=P(F(arguments.length>1?arguments[1]:void 0,U.length)),Y=E(H);return k(U,X,X+Y.length)===Y}})},{"../internals/correct-is-regexp-logic":142,"../internals/export":170,"../internals/function-uncurry-this-clause":180,"../internals/is-pure":210,"../internals/not-a-regexp":227,"../internals/object-get-own-property-descriptor":232,"../internals/require-object-coercible":262,"../internals/to-length":284,"../internals/to-string":291}],349:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/string-trim").trim,R=_("../internals/string-trim-forced");A({target:"String",proto:!0,forced:R("trim")},{trim:function(){return O(this)}})},{"../internals/export":170,"../internals/string-trim":273,"../internals/string-trim-forced":272}],350:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/global"),R=_("../internals/function-call"),P=_("../internals/function-uncurry-this"),E=_("../internals/is-pure"),D=_("../internals/descriptors"),I=_("../internals/symbol-constructor-detection"),M=_("../internals/fails"),N=_("../internals/has-own-property"),k=_("../internals/object-is-prototype-of"),F=_("../internals/an-object"),G=_("../internals/to-indexed-object"),V=_("../internals/to-property-key"),j=_("../internals/to-string"),H=_("../internals/create-property-descriptor"),U=_("../internals/object-create"),X=_("../internals/object-keys"),Y=_("../internals/object-get-own-property-names"),z=_("../internals/object-get-own-property-names-external"),W=_("../internals/object-get-own-property-symbols"),Z=_("../internals/object-get-own-property-descriptor"),Q=_("../internals/object-define-property"),ee=_("../internals/object-define-properties"),te=_("../internals/object-property-is-enumerable"),re=_("../internals/define-built-in"),ie=_("../internals/define-built-in-accessor"),ne=_("../internals/shared"),he=_("../internals/shared-key"),pe=_("../internals/hidden-keys"),K=_("../internals/uid"),ue=_("../internals/well-known-symbol"),le=_("../internals/well-known-symbol-wrapped"),ce=_("../internals/well-known-symbol-define"),_e=_("../internals/symbol-define-to-primitive"),oe=_("../internals/set-to-string-tag"),de=_("../internals/internal-state"),me=_("../internals/array-iteration").forEach,ye=he("hidden"),ge="Symbol",we="prototype",Te=de.set,Ee=de.getterFor(ge),De=Object[we],fe=O.Symbol,Ce=fe&&fe[we],Se=O.RangeError,be=O.TypeError,Re=O.QObject,Ve=Z.f,Pe=Q.f,ke=z.f,Ne=te.f,Ae=P([].push),Oe=ne("symbols"),Fe=ne("op-symbols"),nt=ne("wks"),Ze=!Re||!Re[we]||!Re[we].findChild,Xe=function(Qe,st,pt){var qe=Ve(De,st);qe&&delete De[st],Pe(Qe,st,pt),qe&&Qe!==De&&Pe(De,st,qe)},$e=D&&M(function(){return U(Pe({},"a",{get:function(){return Pe(this,"a",{value:7}).a}})).a!==7})?Xe:Pe,ot=function(Qe,st){var pt=Oe[Qe]=U(Ce);return Te(pt,{type:ge,tag:Qe,description:st}),D||(pt.description=st),pt},ut=function(st,pt,qe){st===De&&ut(Fe,pt,qe),F(st);var rt=V(pt);return F(qe),N(Oe,rt)?(qe.enumerable?(N(st,ye)&&st[ye][rt]&&(st[ye][rt]=!1),qe=U(qe,{enumerable:H(0,!1)})):(N(st,ye)||Pe(st,ye,H(1,U(null))),st[ye][rt]=!0),$e(st,rt,qe)):Pe(st,rt,qe)},gt=function(st,pt){F(st);var qe=G(pt),rt=X(qe).concat(je(qe));return me(rt,function(bt){(!D||R(We,qe,bt))&&ut(st,bt,qe[bt])}),st},Ue=function(st,pt){return pt===void 0?U(st):gt(U(st),pt)},We=function(st){var pt=V(st),qe=R(Ne,this,pt);return this===De&&N(Oe,pt)&&!N(Fe,pt)?!1:qe||!N(this,pt)||!N(Oe,pt)||N(this,ye)&&this[ye][pt]?qe:!0},ht=function(st,pt){var qe=G(st),rt=V(pt);if(!(qe===De&&N(Oe,rt)&&!N(Fe,rt))){var bt=Ve(qe,rt);return bt&&N(Oe,rt)&&!(N(qe,ye)&&qe[ye][rt])&&(bt.enumerable=!0),bt}},Be=function(st){var pt=ke(G(st)),qe=[];return me(pt,function(rt){!N(Oe,rt)&&!N(pe,rt)&&Ae(qe,rt)}),qe},je=function(Qe){var st=Qe===De,pt=ke(st?Fe:G(Qe)),qe=[];return me(pt,function(rt){N(Oe,rt)&&(!st||N(De,rt))&&Ae(qe,Oe[rt])}),qe};I||(fe=function(){if(k(Ce,this))throw new be("Symbol is not a constructor");var st=!arguments.length||arguments[0]===void 0?void 0:j(arguments[0]),pt=K(st),qe=function(rt){var bt=this===void 0?O:this;bt===De&&R(qe,Fe,rt),N(bt,ye)&&N(bt[ye],pt)&&(bt[ye][pt]=!1);var Dt=H(1,rt);try{$e(bt,pt,Dt)}catch(Et){if(!(Et instanceof Se))throw Et;Xe(bt,pt,Dt)}};return D&&Ze&&$e(De,pt,{configurable:!0,set:qe}),ot(pt,st)},Ce=fe[we],re(Ce,"toString",function(){return Ee(this).tag}),re(fe,"withoutSetter",function(Qe){return ot(K(Qe),Qe)}),te.f=We,Q.f=ut,ee.f=gt,Z.f=ht,Y.f=z.f=Be,W.f=je,le.f=function(Qe){return ot(ue(Qe),Qe)},D&&(ie(Ce,"description",{configurable:!0,get:function(){return Ee(this).description}}),E||re(De,"propertyIsEnumerable",We,{unsafe:!0}))),A({global:!0,constructor:!0,wrap:!0,forced:!I,sham:!I},{Symbol:fe}),me(X(nt),function(Qe){ce(Qe)}),A({target:ge,stat:!0,forced:!I},{useSetter:function(){Ze=!0},useSimple:function(){Ze=!1}}),A({target:"Object",stat:!0,forced:!I,sham:!D},{create:Ue,defineProperty:ut,defineProperties:gt,getOwnPropertyDescriptor:ht}),A({target:"Object",stat:!0,forced:!I},{getOwnPropertyNames:Be}),_e(),oe(fe,ge),pe[ye]=!0},{"../internals/an-object":114,"../internals/array-iteration":125,"../internals/create-property-descriptor":146,"../internals/define-built-in":149,"../internals/define-built-in-accessor":148,"../internals/descriptors":153,"../internals/export":170,"../internals/fails":171,"../internals/function-call":177,"../internals/function-uncurry-this":181,"../internals/global":188,"../internals/has-own-property":189,"../internals/hidden-keys":190,"../internals/internal-state":199,"../internals/is-pure":210,"../internals/object-create":229,"../internals/object-define-properties":230,"../internals/object-define-property":231,"../internals/object-get-own-property-descriptor":232,"../internals/object-get-own-property-names":234,"../internals/object-get-own-property-names-external":233,"../internals/object-get-own-property-symbols":235,"../internals/object-is-prototype-of":238,"../internals/object-keys":240,"../internals/object-property-is-enumerable":241,"../internals/set-to-string-tag":266,"../internals/shared":269,"../internals/shared-key":267,"../internals/symbol-constructor-detection":274,"../internals/symbol-define-to-primitive":275,"../internals/to-indexed-object":282,"../internals/to-property-key":289,"../internals/to-string":291,"../internals/uid":299,"../internals/well-known-symbol":306,"../internals/well-known-symbol-define":304,"../internals/well-known-symbol-wrapped":305}],351:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/descriptors"),R=_("../internals/global"),P=_("../internals/function-uncurry-this"),E=_("../internals/has-own-property"),D=_("../internals/is-callable"),I=_("../internals/object-is-prototype-of"),M=_("../internals/to-string"),N=_("../internals/define-built-in-accessor"),k=_("../internals/copy-constructor-properties"),F=R.Symbol,G=F&&F.prototype;if(O&&D(F)&&(!("description"in G)||F().description!==void 0)){var V={},j=function(){var Q=arguments.length<1||arguments[0]===void 0?void 0:M(arguments[0]),ee=I(G,this)?new F(Q):Q===void 0?F():F(Q);return Q===""&&(V[ee]=!0),ee};k(j,F),j.prototype=G,G.constructor=j;var H=String(F("description detection"))==="Symbol(description detection)",U=P(G.valueOf),X=P(G.toString),Y=/^Symbol\((.*)\)[^)]+$/,z=P("".replace),W=P("".slice);N(G,"description",{configurable:!0,get:function(){var Q=U(this);if(E(V,Q))return"";var ee=X(Q),te=H?W(ee,7,-1):z(ee,Y,"$1");return te===""?void 0:te}}),A({global:!0,constructor:!0,forced:!0},{Symbol:j})}},{"../internals/copy-constructor-properties":141,"../internals/define-built-in-accessor":148,"../internals/descriptors":153,"../internals/export":170,"../internals/function-uncurry-this":181,"../internals/global":188,"../internals/has-own-property":189,"../internals/is-callable":203,"../internals/object-is-prototype-of":238,"../internals/to-string":291}],352:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/get-built-in"),R=_("../internals/has-own-property"),P=_("../internals/to-string"),E=_("../internals/shared"),D=_("../internals/symbol-registry-detection"),I=E("string-to-symbol-registry"),M=E("symbol-to-string-registry");A({target:"Symbol",stat:!0,forced:!D},{for:function(N){var k=P(N);if(R(I,k))return I[k];var F=O("Symbol")(k);return I[k]=F,M[F]=k,F}})},{"../internals/export":170,"../internals/get-built-in":182,"../internals/has-own-property":189,"../internals/shared":269,"../internals/symbol-registry-detection":276,"../internals/to-string":291}],353:[function(_,w,B){var A=_("../internals/well-known-symbol-define");A("iterator")},{"../internals/well-known-symbol-define":304}],354:[function(_,w,B){_("../modules/es.symbol.constructor"),_("../modules/es.symbol.for"),_("../modules/es.symbol.key-for"),_("../modules/es.json.stringify"),_("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":323,"../modules/es.object.get-own-property-symbols":327,"../modules/es.symbol.constructor":350,"../modules/es.symbol.for":352,"../modules/es.symbol.key-for":355}],355:[function(_,w,B){var A=_("../internals/export"),O=_("../internals/has-own-property"),R=_("../internals/is-symbol"),P=_("../internals/try-to-string"),E=_("../internals/shared"),D=_("../internals/symbol-registry-detection"),I=E("symbol-to-string-registry");A({target:"Symbol",stat:!0,forced:!D},{keyFor:function(N){if(!R(N))throw new TypeError(P(N)+" is not a symbol");if(O(I,N))return I[N]}})},{"../internals/export":170,"../internals/has-own-property":189,"../internals/is-symbol":212,"../internals/shared":269,"../internals/symbol-registry-detection":276,"../internals/try-to-string":293}],356:[function(_,w,B){var A=_("../internals/function-uncurry-this"),O=_("../internals/array-buffer-view-core"),R=_("../internals/array-copy-within"),P=A(R),E=O.aTypedArray,D=O.exportTypedArrayMethod;D("copyWithin",function(M,N){return P(E(this),M,N,arguments.length>2?arguments[2]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-copy-within":119,"../internals/function-uncurry-this":181}],357:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-iteration").every,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("every",function(D){return O(R(this),D,arguments.length>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-iteration":125}],358:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-fill"),R=_("../internals/to-big-int"),P=_("../internals/classof"),E=_("../internals/function-call"),D=_("../internals/function-uncurry-this"),I=_("../internals/fails"),M=A.aTypedArray,N=A.exportTypedArrayMethod,k=D("".slice),F=I(function(){var G=0;return new Int8Array(2).fill({valueOf:function(){return G++}}),G!==1});N("fill",function(V){var j=arguments.length;M(this);var H=k(P(this),0,3)==="Big"?R(V):+V;return E(O,this,H,j>1?arguments[1]:void 0,j>2?arguments[2]:void 0)},F)},{"../internals/array-buffer-view-core":117,"../internals/array-fill":120,"../internals/classof":138,"../internals/fails":171,"../internals/function-call":177,"../internals/function-uncurry-this":181,"../internals/to-big-int":280}],359:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-iteration").filter,R=_("../internals/typed-array-from-species-and-list"),P=A.aTypedArray,E=A.exportTypedArrayMethod;E("filter",function(I){var M=O(P(this),I,arguments.length>1?arguments[1]:void 0);return R(this,M)})},{"../internals/array-buffer-view-core":117,"../internals/array-iteration":125,"../internals/typed-array-from-species-and-list":296}],360:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-iteration").findIndex,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("findIndex",function(D){return O(R(this),D,arguments.length>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-iteration":125}],361:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-iteration").find,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("find",function(D){return O(R(this),D,arguments.length>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-iteration":125}],362:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-iteration").forEach,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("forEach",function(D){O(R(this),D,arguments.length>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-iteration":125}],363:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-includes").includes,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("includes",function(D){return O(R(this),D,arguments.length>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-includes":124}],364:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-includes").indexOf,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("indexOf",function(D){return O(R(this),D,arguments.length>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-includes":124}],365:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/fails"),R=_("../internals/function-uncurry-this"),P=_("../internals/array-buffer-view-core"),E=_("../modules/es.array.iterator"),D=_("../internals/well-known-symbol"),I=D("iterator"),M=A.Uint8Array,N=R(E.values),k=R(E.keys),F=R(E.entries),G=P.aTypedArray,V=P.exportTypedArrayMethod,j=M&&M.prototype,H=!O(function(){j[I].call([1])}),U=!!j&&j.values&&j[I]===j.values&&j.values.name==="values",X=function(){return N(G(this))};V("entries",function(){return F(G(this))},H),V("keys",function(){return k(G(this))},H),V("values",X,H||!U,{name:"values"}),V(I,X,H||!U,{name:"values"})},{"../internals/array-buffer-view-core":117,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/global":188,"../internals/well-known-symbol":306,"../modules/es.array.iterator":316}],366:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/function-uncurry-this"),R=A.aTypedArray,P=A.exportTypedArrayMethod,E=O([].join);P("join",function(I){return E(R(this),I)})},{"../internals/array-buffer-view-core":117,"../internals/function-uncurry-this":181}],367:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/function-apply"),R=_("../internals/array-last-index-of"),P=A.aTypedArray,E=A.exportTypedArrayMethod;E("lastIndexOf",function(I){var M=arguments.length;return O(R,P(this),M>1?[I,arguments[1]]:[I])})},{"../internals/array-buffer-view-core":117,"../internals/array-last-index-of":126,"../internals/function-apply":174}],368:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-iteration").map,R=_("../internals/typed-array-species-constructor"),P=A.aTypedArray,E=A.exportTypedArrayMethod;E("map",function(I){return O(P(this),I,arguments.length>1?arguments[1]:void 0,function(M,N){return new(R(M))(N)})})},{"../internals/array-buffer-view-core":117,"../internals/array-iteration":125,"../internals/typed-array-species-constructor":298}],369:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-reduce").right,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("reduceRight",function(D){var I=arguments.length;return O(R(this),D,I,I>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-reduce":129}],370:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-reduce").left,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("reduce",function(D){var I=arguments.length;return O(R(this),D,I,I>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-reduce":129}],371:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=A.aTypedArray,R=A.exportTypedArrayMethod,P=Math.floor;R("reverse",function(){for(var D=this,I=O(D).length,M=P(I/2),N=0,k;N<M;)k=D[N],D[N++]=D[--I],D[I]=k;return D})},{"../internals/array-buffer-view-core":117}],372:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/function-call"),R=_("../internals/array-buffer-view-core"),P=_("../internals/length-of-array-like"),E=_("../internals/to-offset"),D=_("../internals/to-object"),I=_("../internals/fails"),M=A.RangeError,N=A.Int8Array,k=N&&N.prototype,F=k&&k.set,G=R.aTypedArray,V=R.exportTypedArrayMethod,j=!I(function(){var U=new Uint8ClampedArray(2);return O(F,U,{length:1,0:3},1),U[1]!==3}),H=j&&R.NATIVE_ARRAY_BUFFER_VIEWS&&I(function(){var U=new N(2);return U.set(1),U.set("2",1),U[0]!==0||U[1]!==2});V("set",function(X){G(this);var Y=E(arguments.length>1?arguments[1]:void 0,1),z=D(X);if(j)return O(F,this,z,Y);var W=this.length,Z=P(z),Q=0;if(Z+Y>W)throw new M("Wrong length");for(;Q<Z;)this[Y+Q]=z[Q++]},!j||H)},{"../internals/array-buffer-view-core":117,"../internals/fails":171,"../internals/function-call":177,"../internals/global":188,"../internals/length-of-array-like":219,"../internals/to-object":285,"../internals/to-offset":286}],373:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/typed-array-species-constructor"),R=_("../internals/fails"),P=_("../internals/array-slice"),E=A.aTypedArray,D=A.exportTypedArrayMethod,I=R(function(){new Int8Array(1).slice()});D("slice",function(N,k){for(var F=P(E(this),N,k),G=O(this),V=0,j=F.length,H=new G(j);j>V;)H[V]=F[V++];return H},I)},{"../internals/array-buffer-view-core":117,"../internals/array-slice":131,"../internals/fails":171,"../internals/typed-array-species-constructor":298}],374:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/array-iteration").some,R=A.aTypedArray,P=A.exportTypedArrayMethod;P("some",function(D){return O(R(this),D,arguments.length>1?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":117,"../internals/array-iteration":125}],375:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/function-uncurry-this-clause"),R=_("../internals/fails"),P=_("../internals/a-callable"),E=_("../internals/array-sort"),D=_("../internals/array-buffer-view-core"),I=_("../internals/engine-ff-version"),M=_("../internals/engine-is-ie-or-edge"),N=_("../internals/engine-v8-version"),k=_("../internals/engine-webkit-version"),F=D.aTypedArray,G=D.exportTypedArrayMethod,V=A.Uint16Array,j=V&&O(V.prototype.sort),H=!!j&&!(R(function(){j(new V(2),null)})&&R(function(){j(new V(2),{})})),U=!!j&&!R(function(){if(N)return N<74;if(I)return I<67;if(M)return!0;if(k)return k<602;var Y=new V(516),z=Array(516),W,Z;for(W=0;W<516;W++)Z=W%4,Y[W]=515-W,z[W]=W-2*Z+3;for(j(Y,function(Q,ee){return(Q/4|0)-(ee/4|0)}),W=0;W<516;W++)if(Y[W]!==z[W])return!0}),X=function(Y){return function(z,W){return Y!==void 0?+Y(z,W)||0:W!==W?-1:z!==z?1:z===0&&W===0?1/z>0&&1/W<0?1:-1:z>W}};G("sort",function(z){return z!==void 0&&P(z),U?j(this,z):E(F(this),X(z))},!U||H)},{"../internals/a-callable":108,"../internals/array-buffer-view-core":117,"../internals/array-sort":132,"../internals/engine-ff-version":158,"../internals/engine-is-ie-or-edge":161,"../internals/engine-v8-version":167,"../internals/engine-webkit-version":168,"../internals/fails":171,"../internals/function-uncurry-this-clause":180,"../internals/global":188}],376:[function(_,w,B){var A=_("../internals/array-buffer-view-core"),O=_("../internals/to-length"),R=_("../internals/to-absolute-index"),P=_("../internals/typed-array-species-constructor"),E=A.aTypedArray,D=A.exportTypedArrayMethod;D("subarray",function(M,N){var k=E(this),F=k.length,G=R(M,F),V=P(k);return new V(k.buffer,k.byteOffset+G*k.BYTES_PER_ELEMENT,O((N===void 0?F:R(N,F))-G))})},{"../internals/array-buffer-view-core":117,"../internals/to-absolute-index":279,"../internals/to-length":284,"../internals/typed-array-species-constructor":298}],377:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/function-apply"),R=_("../internals/array-buffer-view-core"),P=_("../internals/fails"),E=_("../internals/array-slice"),D=A.Int8Array,I=R.aTypedArray,M=R.exportTypedArrayMethod,N=[].toLocaleString,k=!!D&&P(function(){N.call(new D(1))}),F=P(function(){return[1,2].toLocaleString()!==new D([1,2]).toLocaleString()})||!P(function(){D.prototype.toLocaleString.call([1,2])});M("toLocaleString",function(){return O(N,k?E(I(this)):I(this),E(arguments))},F)},{"../internals/array-buffer-view-core":117,"../internals/array-slice":131,"../internals/fails":171,"../internals/function-apply":174,"../internals/global":188}],378:[function(_,w,B){var A=_("../internals/array-buffer-view-core").exportTypedArrayMethod,O=_("../internals/fails"),R=_("../internals/global"),P=_("../internals/function-uncurry-this"),E=R.Uint8Array,D=E&&E.prototype||{},I=[].toString,M=P([].join);O(function(){I.call({})})&&(I=function(){return M(this)});var N=D.toString!==I;A("toString",I,N)},{"../internals/array-buffer-view-core":117,"../internals/fails":171,"../internals/function-uncurry-this":181,"../internals/global":188}],379:[function(_,w,B){var A=_("../internals/typed-array-constructor");A("Uint8",function(O){return function(P,E,D){return O(this,P,E,D)}})},{"../internals/typed-array-constructor":294}],380:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/dom-iterables"),R=_("../internals/dom-token-list-prototype"),P=_("../internals/array-for-each"),E=_("../internals/create-non-enumerable-property"),D=function(M){if(M&&M.forEach!==P)try{E(M,"forEach",P)}catch(N){M.forEach=P}};for(var I in O)O[I]&&D(A[I]&&A[I].prototype);D(R)},{"../internals/array-for-each":121,"../internals/create-non-enumerable-property":145,"../internals/dom-iterables":156,"../internals/dom-token-list-prototype":157,"../internals/global":188}],381:[function(_,w,B){var A=_("../internals/global"),O=_("../internals/dom-iterables"),R=_("../internals/dom-token-list-prototype"),P=_("../modules/es.array.iterator"),E=_("../internals/create-non-enumerable-property"),D=_("../internals/set-to-string-tag"),I=_("../internals/well-known-symbol"),M=I("iterator"),N=P.values,k=function(G,V){if(G){if(G[M]!==N)try{E(G,M,N)}catch(H){G[M]=N}if(D(G,V,!0),O[V]){for(var j in P)if(G[j]!==P[j])try{E(G,j,P[j])}catch(H){G[j]=P[j]}}}};for(var F in O)k(A[F]&&A[F].prototype,F);k(R,"DOMTokenList")},{"../internals/create-non-enumerable-property":145,"../internals/dom-iterables":156,"../internals/dom-token-list-prototype":157,"../internals/global":188,"../internals/set-to-string-tag":266,"../internals/well-known-symbol":306,"../modules/es.array.iterator":316}],382:[function(_,w,B){function A(U){return Array.isArray?Array.isArray(U):H(U)==="[object Array]"}B.isArray=A;function O(U){return typeof U=="boolean"}B.isBoolean=O;function R(U){return U===null}B.isNull=R;function P(U){return U==null}B.isNullOrUndefined=P;function E(U){return typeof U=="number"}B.isNumber=E;function D(U){return typeof U=="string"}B.isString=D;function I(U){return typeof U=="symbol"}B.isSymbol=I;function M(U){return U===void 0}B.isUndefined=M;function N(U){return H(U)==="[object RegExp]"}B.isRegExp=N;function k(U){return typeof U=="object"&&U!==null}B.isObject=k;function F(U){return H(U)==="[object Date]"}B.isDate=F;function G(U){return H(U)==="[object Error]"||U instanceof Error}B.isError=G;function V(U){return typeof U=="function"}B.isFunction=V;function j(U){return U===null||typeof U=="boolean"||typeof U=="number"||typeof U=="string"||typeof U=="symbol"||typeof U>"u"}B.isPrimitive=j,B.isBuffer=_("buffer").Buffer.isBuffer;function H(U){return Object.prototype.toString.call(U)}},{buffer:103}],383:[function(_,w,B){(function(A){var O=function(){var I=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|'[^']*'|'[^']*'/g,M=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,N=/[^-+\dA-Z]/g;return function(k,F,G,V){if(arguments.length===1&&D(k)==="string"&&!/\d/.test(k)&&(F=k,k=void 0),k=k||new Date,k instanceof Date||(k=new Date(k)),isNaN(k))throw TypeError("Invalid date");F=String(O.masks[F]||F||O.masks.default);var j=F.slice(0,4);(j==="UTC:"||j==="GMT:")&&(F=F.slice(4),G=!0,j==="GMT:"&&(V=!0));var H=G?"getUTC":"get",U=k[H+"Date"](),X=k[H+"Day"](),Y=k[H+"Month"](),z=k[H+"FullYear"](),W=k[H+"Hours"](),Z=k[H+"Minutes"](),Q=k[H+"Seconds"](),ee=k[H+"Milliseconds"](),te=G?0:k.getTimezoneOffset(),re=P(k),ie=E(k),ne={d:U,dd:R(U),ddd:O.i18n.dayNames[X],dddd:O.i18n.dayNames[X+7],m:Y+1,mm:R(Y+1),mmm:O.i18n.monthNames[Y],mmmm:O.i18n.monthNames[Y+12],yy:String(z).slice(2),yyyy:z,h:W%12||12,hh:R(W%12||12),H:W,HH:R(W),M:Z,MM:R(Z),s:Q,ss:R(Q),l:R(ee,3),L:R(Math.round(ee/10)),t:W<12?"a":"p",tt:W<12?"am":"pm",T:W<12?"A":"P",TT:W<12?"AM":"PM",Z:V?"GMT":G?"UTC":(String(k).match(M)||[""]).pop().replace(N,""),o:(te>0?"-":"+")+R(Math.floor(Math.abs(te)/60)*100+Math.abs(te)%60,4),S:["th","st","nd","rd"][U%10>3?0:(U%100-U%10!=10)*U%10],W:re,N:ie};return F.replace(I,function(he){return he in ne?ne[he]:he.slice(1,he.length-1)})}}();O.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},O.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};function R(I,M){for(I=String(I),M=M||2;I.length<M;)I="0"+I;return I}function P(I){var M=new Date(I.getFullYear(),I.getMonth(),I.getDate());M.setDate(M.getDate()-(M.getDay()+6)%7+3);var N=new Date(M.getFullYear(),0,4);N.setDate(N.getDate()-(N.getDay()+6)%7+3);var k=M.getTimezoneOffset()-N.getTimezoneOffset();M.setHours(M.getHours()-k);var F=(M-N)/(864e5*7);return 1+Math.floor(F)}function E(I){var M=I.getDay();return M===0&&(M=7),M}function D(I){return I===null?"null":I===void 0?"undefined":typeof I!="object"?typeof I:Array.isArray(I)?"array":{}.toString.call(I).slice(8,-1).toLowerCase()}typeof B=="object"?w.exports=O:A.dateFormat=O})(this)},{}],384:[function(_,w,B){var A=_("has-property-descriptors")(),O=_("get-intrinsic"),R=A&&O("%Object.defineProperty%",!0);if(R)try{R({},"a",{value:1})}catch(I){R=!1}var P=O("%SyntaxError%"),E=O("%TypeError%"),D=_("gopd");w.exports=function(M,N,k){if(!M||typeof M!="object"&&typeof M!="function")throw new E("`obj` must be an object or a function`");if(typeof N!="string"&&typeof N!="symbol")throw new E("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new E("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new E("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new E("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new E("`loose`, if provided, must be a boolean");var F=arguments.length>3?arguments[3]:null,G=arguments.length>4?arguments[4]:null,V=arguments.length>5?arguments[5]:null,j=arguments.length>6?arguments[6]:!1,H=!!D&&D(M,N);if(R)R(M,N,{configurable:V===null&&H?H.configurable:!V,enumerable:F===null&&H?H.enumerable:!F,value:k,writable:G===null&&H?H.writable:!G});else if(j||!F&&!G&&!V)M[N]=k;else throw new P("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}},{"get-intrinsic":390,gopd:391,"has-property-descriptors":392}],385:[function(_,w,B){var A=/["'&<>]/;w.exports=O;function O(R){var P=""+R,E=A.exec(P);if(!E)return P;var D,I="",M=0,N=0;for(M=E.index;M<P.length;M++){switch(P.charCodeAt(M)){case 34:D="&quot;";break;case 38:D="&amp;";break;case 39:D="&#39;";break;case 60:D="&lt;";break;case 62:D="&gt;";break;default:continue}N!==M&&(I+=P.substring(N,M)),N=M+1,I+=D}return N!==M?I+P.substring(N,M):I}},{}],386:[function(_,w,B){var A=typeof Reflect=="object"?Reflect:null,O=A&&typeof A.apply=="function"?A.apply:function(Q,ee,te){return Function.prototype.apply.call(Q,ee,te)},R;A&&typeof A.ownKeys=="function"?R=A.ownKeys:Object.getOwnPropertySymbols?R=function(Q){return Object.getOwnPropertyNames(Q).concat(Object.getOwnPropertySymbols(Q))}:R=function(Q){return Object.getOwnPropertyNames(Q)};function P(Z){console&&console.warn&&console.warn(Z)}var E=Number.isNaN||function(Q){return Q!==Q};function D(){D.init.call(this)}w.exports=D,w.exports.once=Y,D.EventEmitter=D,D.prototype._events=void 0,D.prototype._eventsCount=0,D.prototype._maxListeners=void 0;var I=10;function M(Z){if(typeof Z!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Z)}Object.defineProperty(D,"defaultMaxListeners",{enumerable:!0,get:function(){return I},set:function(Z){if(typeof Z!="number"||Z<0||E(Z))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Z+".");I=Z}}),D.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},D.prototype.setMaxListeners=function(Q){if(typeof Q!="number"||Q<0||E(Q))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Q+".");return this._maxListeners=Q,this};function N(Z){return Z._maxListeners===void 0?D.defaultMaxListeners:Z._maxListeners}D.prototype.getMaxListeners=function(){return N(this)},D.prototype.emit=function(Q){for(var ee=[],te=1;te<arguments.length;te++)ee.push(arguments[te]);var re=Q==="error",ie=this._events;if(ie!==void 0)re=re&&ie.error===void 0;else if(!re)return!1;if(re){var ne;if(ee.length>0&&(ne=ee[0]),ne instanceof Error)throw ne;var he=new Error("Unhandled error."+(ne?" ("+ne.message+")":""));throw he.context=ne,he}var pe=ie[Q];if(pe===void 0)return!1;if(typeof pe=="function")O(pe,this,ee);else for(var K=pe.length,ue=H(pe,K),te=0;te<K;++te)O(ue[te],this,ee);return!0};function k(Z,Q,ee,te){var re,ie,ne;if(M(ee),ie=Z._events,ie===void 0?(ie=Z._events=Object.create(null),Z._eventsCount=0):(ie.newListener!==void 0&&(Z.emit("newListener",Q,ee.listener?ee.listener:ee),ie=Z._events),ne=ie[Q]),ne===void 0)ne=ie[Q]=ee,++Z._eventsCount;else if(typeof ne=="function"?ne=ie[Q]=te?[ee,ne]:[ne,ee]:te?ne.unshift(ee):ne.push(ee),re=N(Z),re>0&&ne.length>re&&!ne.warned){ne.warned=!0;var he=new Error("Possible EventEmitter memory leak detected. "+ne.length+" "+String(Q)+" listeners added. Use emitter.setMaxListeners() to increase limit");he.name="MaxListenersExceededWarning",he.emitter=Z,he.type=Q,he.count=ne.length,P(he)}return Z}D.prototype.addListener=function(Q,ee){return k(this,Q,ee,!1)},D.prototype.on=D.prototype.addListener,D.prototype.prependListener=function(Q,ee){return k(this,Q,ee,!0)};function F(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G(Z,Q,ee){var te={fired:!1,wrapFn:void 0,target:Z,type:Q,listener:ee},re=F.bind(te);return re.listener=ee,te.wrapFn=re,re}D.prototype.once=function(Q,ee){return M(ee),this.on(Q,G(this,Q,ee)),this},D.prototype.prependOnceListener=function(Q,ee){return M(ee),this.prependListener(Q,G(this,Q,ee)),this},D.prototype.removeListener=function(Q,ee){var te,re,ie,ne,he;if(M(ee),re=this._events,re===void 0)return this;if(te=re[Q],te===void 0)return this;if(te===ee||te.listener===ee)--this._eventsCount===0?this._events=Object.create(null):(delete re[Q],re.removeListener&&this.emit("removeListener",Q,te.listener||ee));else if(typeof te!="function"){for(ie=-1,ne=te.length-1;ne>=0;ne--)if(te[ne]===ee||te[ne].listener===ee){he=te[ne].listener,ie=ne;break}if(ie<0)return this;ie===0?te.shift():U(te,ie),te.length===1&&(re[Q]=te[0]),re.removeListener!==void 0&&this.emit("removeListener",Q,he||ee)}return this},D.prototype.off=D.prototype.removeListener,D.prototype.removeAllListeners=function(Q){var ee,te,re;if(te=this._events,te===void 0)return this;if(te.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):te[Q]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete te[Q]),this;if(arguments.length===0){var ie=Object.keys(te),ne;for(re=0;re<ie.length;++re)ne=ie[re],ne!=="removeListener"&&this.removeAllListeners(ne);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(ee=te[Q],typeof ee=="function")this.removeListener(Q,ee);else if(ee!==void 0)for(re=ee.length-1;re>=0;re--)this.removeListener(Q,ee[re]);return this};function V(Z,Q,ee){var te=Z._events;if(te===void 0)return[];var re=te[Q];return re===void 0?[]:typeof re=="function"?ee?[re.listener||re]:[re]:ee?X(re):H(re,re.length)}D.prototype.listeners=function(Q){return V(this,Q,!0)},D.prototype.rawListeners=function(Q){return V(this,Q,!1)},D.listenerCount=function(Z,Q){return typeof Z.listenerCount=="function"?Z.listenerCount(Q):j.call(Z,Q)},D.prototype.listenerCount=j;function j(Z){var Q=this._events;if(Q!==void 0){var ee=Q[Z];if(typeof ee=="function")return 1;if(ee!==void 0)return ee.length}return 0}D.prototype.eventNames=function(){return this._eventsCount>0?R(this._events):[]};function H(Z,Q){for(var ee=new Array(Q),te=0;te<Q;++te)ee[te]=Z[te];return ee}function U(Z,Q){for(;Q+1<Z.length;Q++)Z[Q]=Z[Q+1];Z.pop()}function X(Z){for(var Q=new Array(Z.length),ee=0;ee<Q.length;++ee)Q[ee]=Z[ee].listener||Z[ee];return Q}function Y(Z,Q){return new Promise(function(ee,te){function re(ne){Z.removeListener(Q,ie),te(ne)}function ie(){typeof Z.removeListener=="function"&&Z.removeListener("error",re),ee([].slice.call(arguments))}W(Z,Q,ie,{once:!0}),Q!=="error"&&z(Z,re,{once:!0})})}function z(Z,Q,ee){typeof Z.on=="function"&&W(Z,"error",Q,ee)}function W(Z,Q,ee,te){if(typeof Z.on=="function")te.once?Z.once(Q,ee):Z.on(Q,ee);else if(typeof Z.addEventListener=="function")Z.addEventListener(Q,function re(ie){te.once&&Z.removeEventListener(Q,re),ee(ie)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Z)}},{}],387:[function(_,w,B){var A=_("is-callable"),O=Object.prototype.toString,R=Object.prototype.hasOwnProperty,P=function(N,k,F){for(var G=0,V=N.length;G<V;G++)R.call(N,G)&&(F==null?k(N[G],G,N):k.call(F,N[G],G,N))},E=function(N,k,F){for(var G=0,V=N.length;G<V;G++)F==null?k(N.charAt(G),G,N):k.call(F,N.charAt(G),G,N)},D=function(N,k,F){for(var G in N)R.call(N,G)&&(F==null?k(N[G],G,N):k.call(F,N[G],G,N))},I=function(N,k,F){if(!A(k))throw new TypeError("iterator must be a function");var G;arguments.length>=3&&(G=F),O.call(N)==="[object Array]"?P(N,k,G):typeof N=="string"?E(N,k,G):D(N,k,G)};w.exports=I},{"is-callable":410}],388:[function(_,w,B){var A="Function.prototype.bind called on incompatible ",O=Object.prototype.toString,R=Math.max,P="[object Function]",E=function(N,k){for(var F=[],G=0;G<N.length;G+=1)F[G]=N[G];for(var V=0;V<k.length;V+=1)F[V+N.length]=k[V];return F},D=function(N,k){for(var F=[],G=k,V=0;G<N.length;G+=1,V+=1)F[V]=N[G];return F},I=function(M,N){for(var k="",F=0;F<M.length;F+=1)k+=M[F],F+1<M.length&&(k+=N);return k};w.exports=function(N){var k=this;if(typeof k!="function"||O.apply(k)!==P)throw new TypeError(A+k);for(var F=D(arguments,1),G,V=function(){if(this instanceof G){var Y=k.apply(this,E(F,arguments));return Object(Y)===Y?Y:this}return k.apply(N,E(F,arguments))},j=R(0,k.length-F.length),H=[],U=0;U<j;U++)H[U]="$"+U;if(G=Function("binder","return function ("+I(H,",")+"){ return binder.apply(this,arguments); }")(V),k.prototype){var X=function(){};X.prototype=k.prototype,G.prototype=new X,X.prototype=null}return G}},{}],389:[function(_,w,B){var A=_("./implementation");w.exports=Function.prototype.bind||A},{"./implementation":388}],390:[function(_,w,B){var A,O=SyntaxError,R=Function,P=TypeError,E=function(pe){try{return R('"use strict"; return ('+pe+").constructor;")()}catch(K){}},D=Object.getOwnPropertyDescriptor;if(D)try{D({},"")}catch(pe){D=null}var I=function(){throw new P},M=D?function(){try{return arguments.callee,I}catch(pe){try{return D(arguments,"callee").get}catch(K){return I}}}():I,N=_("has-symbols")(),k=_("has-proto")(),F=Object.getPrototypeOf||(k?function(pe){return pe.__proto__}:null),G={},V=typeof Uint8Array>"u"||!F?A:F(Uint8Array),j={"%AggregateError%":typeof AggregateError>"u"?A:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?A:ArrayBuffer,"%ArrayIteratorPrototype%":N&&F?F([][Symbol.iterator]()):A,"%AsyncFromSyncIteratorPrototype%":A,"%AsyncFunction%":G,"%AsyncGenerator%":G,"%AsyncGeneratorFunction%":G,"%AsyncIteratorPrototype%":G,"%Atomics%":typeof Atomics>"u"?A:Atomics,"%BigInt%":typeof BigInt>"u"?A:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?A:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?A:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?A:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?A:Float32Array,"%Float64Array%":typeof Float64Array>"u"?A:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?A:FinalizationRegistry,"%Function%":R,"%GeneratorFunction%":G,"%Int8Array%":typeof Int8Array>"u"?A:Int8Array,"%Int16Array%":typeof Int16Array>"u"?A:Int16Array,"%Int32Array%":typeof Int32Array>"u"?A:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":N&&F?F(F([][Symbol.iterator]())):A,"%JSON%":typeof JSON=="object"?JSON:A,"%Map%":typeof Map>"u"?A:Map,"%MapIteratorPrototype%":typeof Map>"u"||!N||!F?A:F(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?A:Promise,"%Proxy%":typeof Proxy>"u"?A:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?A:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?A:Set,"%SetIteratorPrototype%":typeof Set>"u"||!N||!F?A:F(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?A:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":N&&F?F(""[Symbol.iterator]()):A,"%Symbol%":N?Symbol:A,"%SyntaxError%":O,"%ThrowTypeError%":M,"%TypedArray%":V,"%TypeError%":P,"%Uint8Array%":typeof Uint8Array>"u"?A:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?A:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?A:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?A:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?A:WeakMap,"%WeakRef%":typeof WeakRef>"u"?A:WeakRef,"%WeakSet%":typeof WeakSet>"u"?A:WeakSet};if(F)try{null.error}catch(pe){var H=F(F(pe));j["%Error.prototype%"]=H}var U=function pe(K){var ue;if(K==="%AsyncFunction%")ue=E("async function () {}");else if(K==="%GeneratorFunction%")ue=E("function* () {}");else if(K==="%AsyncGeneratorFunction%")ue=E("async function* () {}");else if(K==="%AsyncGenerator%"){var le=pe("%AsyncGeneratorFunction%");le&&(ue=le.prototype)}else if(K==="%AsyncIteratorPrototype%"){var ce=pe("%AsyncGenerator%");ce&&F&&(ue=F(ce.prototype))}return j[K]=ue,ue},X={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Y=_("function-bind"),z=_("hasown"),W=Y.call(Function.call,Array.prototype.concat),Z=Y.call(Function.apply,Array.prototype.splice),Q=Y.call(Function.call,String.prototype.replace),ee=Y.call(Function.call,String.prototype.slice),te=Y.call(Function.call,RegExp.prototype.exec),re=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ie=/\\(\\)?/g,ne=function(K){var ue=ee(K,0,1),le=ee(K,-1);if(ue==="%"&&le!=="%")throw new O("invalid intrinsic syntax, expected closing `%`");if(le==="%"&&ue!=="%")throw new O("invalid intrinsic syntax, expected opening `%`");var ce=[];return Q(K,re,function(_e,oe,de,me){ce[ce.length]=de?Q(me,ie,"$1"):oe||_e}),ce},he=function(K,ue){var le=K,ce;if(z(X,le)&&(ce=X[le],le="%"+ce[0]+"%"),z(j,le)){var _e=j[le];if(_e===G&&(_e=U(le)),typeof _e>"u"&&!ue)throw new P("intrinsic "+K+" exists, but is not available. Please file an issue!");return{alias:ce,name:le,value:_e}}throw new O("intrinsic "+K+" does not exist!")};w.exports=function(K,ue){if(typeof K!="string"||K.length===0)throw new P("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof ue!="boolean")throw new P('"allowMissing" argument must be a boolean');if(te(/^%?[^%]*%?$/,K)===null)throw new O("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var le=ne(K),ce=le.length>0?le[0]:"",_e=he("%"+ce+"%",ue),oe=_e.name,de=_e.value,me=!1,ye=_e.alias;ye&&(ce=ye[0],Z(le,W([0,1],ye)));for(var ge=1,we=!0;ge<le.length;ge+=1){var Te=le[ge],Ee=ee(Te,0,1),De=ee(Te,-1);if((Ee==='"'||Ee==="'"||Ee==="`"||De==='"'||De==="'"||De==="`")&&Ee!==De)throw new O("property names with quotes must have matching quotes");if((Te==="constructor"||!we)&&(me=!0),ce+="."+Te,oe="%"+ce+"%",z(j,oe))de=j[oe];else if(de!=null){if(!(Te in de)){if(!ue)throw new P("base intrinsic for "+K+" exists, but the property is not available.");return}if(D&&ge+1>=le.length){var fe=D(de,Te);we=!!fe,we&&"get"in fe&&!("originalValue"in fe.get)?de=fe.get:de=de[Te]}else we=z(de,Te),de=de[Te];we&&!me&&(j[oe]=de)}}return de}},{"function-bind":389,"has-proto":393,"has-symbols":394,hasown:397}],391:[function(_,w,B){var A=_("get-intrinsic"),O=A("%Object.getOwnPropertyDescriptor%",!0);if(O)try{O([],"length")}catch(R){O=null}w.exports=O},{"get-intrinsic":390}],392:[function(_,w,B){var A=_("get-intrinsic"),O=A("%Object.defineProperty%",!0),R=function(){if(O)try{return O({},"a",{value:1}),!0}catch(E){return!1}return!1};R.hasArrayLengthDefineBug=function(){if(!R())return null;try{return O([],"length",{value:1}).length!==1}catch(E){return!0}},w.exports=R},{"get-intrinsic":390}],393:[function(_,w,B){var A={foo:{}},O=Object;w.exports=function(){return{__proto__:A}.foo===A.foo&&!({__proto__:null}instanceof O)}},{}],394:[function(_,w,B){var A=typeof Symbol<"u"&&Symbol,O=_("./shams");w.exports=function(){return typeof A!="function"||typeof Symbol!="function"||typeof A("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:O()}},{"./shams":395}],395:[function(_,w,B){w.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var O={},R=Symbol("test"),P=Object(R);if(typeof R=="string"||Object.prototype.toString.call(R)!=="[object Symbol]"||Object.prototype.toString.call(P)!=="[object Symbol]")return!1;var E=42;O[R]=E;for(R in O)return!1;if(typeof Object.keys=="function"&&Object.keys(O).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(O).length!==0)return!1;var D=Object.getOwnPropertySymbols(O);if(D.length!==1||D[0]!==R||!Object.prototype.propertyIsEnumerable.call(O,R))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var I=Object.getOwnPropertyDescriptor(O,R);if(I.value!==E||I.enumerable!==!0)return!1}return!0}},{}],396:[function(_,w,B){var A=_("has-symbols/shams");w.exports=function(){return A()&&!!Symbol.toStringTag}},{"has-symbols/shams":395}],397:[function(_,w,B){var A=Function.prototype.call,O=Object.prototype.hasOwnProperty,R=_("function-bind");w.exports=R.call(A,O)},{"function-bind":389}],398:[function(_,w,B){var A=_("http"),O=_("url"),R=w.exports;for(var P in A)A.hasOwnProperty(P)&&(R[P]=A[P]);R.request=function(D,I){return D=E(D),A.request.call(this,D,I)},R.get=function(D,I){return D=E(D),A.get.call(this,D,I)};function E(D){if(typeof D=="string"&&(D=O.parse(D)),D.protocol||(D.protocol="https:"),D.protocol!=="https:")throw new Error('Protocol "'+D.protocol+'" not supported. Expected "https:"');return D}},{http:539,url:543}],399:[function(_,w,B){var A=_("util"),O=_("ms");w.exports=function(R){if(typeof R=="number")return R;var P=O(R);if(P===void 0){var E=new Error(A.format("humanize-ms(%j) result undefined",R));console.warn(E.stack)}return P}},{ms:432,util:489}],400:[function(_,w,B){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */B.read=function(A,O,R,P,E){var D,I,M=E*8-P-1,N=(1<<M)-1,k=N>>1,F=-7,G=R?E-1:0,V=R?-1:1,j=A[O+G];for(G+=V,D=j&(1<<-F)-1,j>>=-F,F+=M;F>0;D=D*256+A[O+G],G+=V,F-=8);for(I=D&(1<<-F)-1,D>>=-F,F+=P;F>0;I=I*256+A[O+G],G+=V,F-=8);if(D===0)D=1-k;else{if(D===N)return I?NaN:(j?-1:1)*(1/0);I=I+Math.pow(2,P),D=D-k}return(j?-1:1)*I*Math.pow(2,D-P)},B.write=function(A,O,R,P,E,D){var I,M,N,k=D*8-E-1,F=(1<<k)-1,G=F>>1,V=E===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=P?0:D-1,H=P?1:-1,U=O<0||O===0&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(M=isNaN(O)?1:0,I=F):(I=Math.floor(Math.log(O)/Math.LN2),O*(N=Math.pow(2,-I))<1&&(I--,N*=2),I+G>=1?O+=V/N:O+=V*Math.pow(2,1-G),O*N>=2&&(I++,N/=2),I+G>=F?(M=0,I=F):I+G>=1?(M=(O*N-1)*Math.pow(2,E),I=I+G):(M=O*Math.pow(2,G-1)*Math.pow(2,E),I=0));E>=8;A[R+j]=M&255,j+=H,M/=256,E-=8);for(I=I<<E|M,k+=E;k>0;A[R+j]=I&255,j+=H,I/=256,k-=8);A[R+j-H]|=U*128}},{}],401:[function(_,w,B){var A=[_("./nextTick"),_("./queueMicrotask"),_("./mutation.js"),_("./messageChannel"),_("./stateChange"),_("./timeout")],O,R,P=-1,E=[],D=!1;function I(){!O||!R||(O=!1,R.length?E=R.concat(E):P=-1,E.length&&M())}function M(){if(!O){D=!1,O=!0;for(var j=E.length,H=setTimeout(I);j;){for(R=E,E=[];R&&++P<j;)R[P].run();P=-1,j=E.length}R=null,P=-1,O=!1,clearTimeout(H)}}for(var N,k=-1,F=A.length;++k<F;)if(A[k]&&A[k].test&&A[k].test()){N=A[k].install(M);break}function G(j,H){this.fun=j,this.array=H}G.prototype.run=function(){var j=this.fun,H=this.array;switch(H.length){case 0:return j();case 1:return j(H[0]);case 2:return j(H[0],H[1]);case 3:return j(H[0],H[1],H[2]);default:return j.apply(null,H)}},w.exports=V;function V(j){var H=new Array(arguments.length-1);if(arguments.length>1)for(var U=1;U<arguments.length;U++)H[U-1]=arguments[U];E.push(new G(j,H)),!D&&!O&&(D=!0,N())}},{"./messageChannel":402,"./mutation.js":403,"./nextTick":102,"./queueMicrotask":404,"./stateChange":405,"./timeout":406}],402:[function(_,w,B){(function(A){(function(){B.test=function(){return A.setImmediate?!1:typeof A.MessageChannel<"u"},B.install=function(O){var R=new A.MessageChannel;return R.port1.onmessage=O,function(){R.port2.postMessage(0)}}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],403:[function(_,w,B){(function(A){(function(){var O=A.MutationObserver||A.WebKitMutationObserver;B.test=function(){return O},B.install=function(R){var P=0,E=new O(R),D=A.document.createTextNode("");return E.observe(D,{characterData:!0}),function(){D.data=P=++P%2}}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],404:[function(_,w,B){(function(A){(function(){B.test=function(){return typeof A.queueMicrotask=="function"},B.install=function(O){return function(){A.queueMicrotask(O)}}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],405:[function(_,w,B){(function(A){(function(){B.test=function(){return"document"in A&&"onreadystatechange"in A.document.createElement("script")},B.install=function(O){return function(){var R=A.document.createElement("script");return R.onreadystatechange=function(){O(),R.onreadystatechange=null,R.parentNode.removeChild(R),R=null},A.document.documentElement.appendChild(R),O}}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],406:[function(_,w,B){B.test=function(){return!0},B.install=function(A){return function(){setTimeout(A,0)}}},{}],407:[function(_,w,B){typeof Object.create=="function"?w.exports=function(O,R){R&&(O.super_=R,O.prototype=Object.create(R.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}))}:w.exports=function(O,R){if(R){O.super_=R;var P=function(){};P.prototype=R.prototype,O.prototype=new P,O.prototype.constructor=O}}},{}],408:[function(_,w,B){var A=_("has-tostringtag/shams")(),O=_("call-bind/callBound"),R=O("Object.prototype.toString"),P=function(M){return A&&M&&typeof M=="object"&&Symbol.toStringTag in M?!1:R(M)==="[object Arguments]"},E=function(M){return P(M)?!0:M!==null&&typeof M=="object"&&typeof M.length=="number"&&M.length>=0&&R(M)!=="[object Array]"&&R(M.callee)==="[object Function]"},D=function(){return P(arguments)}();P.isLegacyArguments=E,w.exports=D?P:E},{"call-bind/callBound":105,"has-tostringtag/shams":396}],409:[function(_,w,B){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */w.exports=function(R){return R!=null&&(A(R)||O(R)||!!R._isBuffer)};function A(R){return!!R.constructor&&typeof R.constructor.isBuffer=="function"&&R.constructor.isBuffer(R)}function O(R){return typeof R.readFloatLE=="function"&&typeof R.slice=="function"&&A(R.slice(0,0))}},{}],410:[function(_,w,B){var A=Function.prototype.toString,O=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,R,P;if(typeof O=="function"&&typeof Object.defineProperty=="function")try{R=Object.defineProperty({},"length",{get:function(){throw P}}),P={},O(function(){throw 42},null,R)}catch(z){z!==P&&(O=null)}else O=null;var E=/^\s*class\b/,D=function(W){try{var Z=A.call(W);return E.test(Z)}catch(Q){return!1}},I=function(W){try{return D(W)?!1:(A.call(W),!0)}catch(Z){return!1}},M=Object.prototype.toString,N="[object Object]",k="[object Function]",F="[object GeneratorFunction]",G="[object HTMLAllCollection]",V="[object HTML document.all class]",j="[object HTMLCollection]",H=typeof Symbol=="function"&&!!Symbol.toStringTag,U=!(0 in[,]),X=function(){return!1};if(typeof document=="object"){var Y=document.all;M.call(Y)===M.call(document.all)&&(X=function(W){if((U||!W)&&(typeof W>"u"||typeof W=="object"))try{var Z=M.call(W);return(Z===G||Z===V||Z===j||Z===N)&&W("")==null}catch(Q){}return!1})}w.exports=O?function(W){if(X(W))return!0;if(!W||typeof W!="function"&&typeof W!="object")return!1;try{O(W,null,R)}catch(Z){if(Z!==P)return!1}return!D(W)&&I(W)}:function(W){if(X(W))return!0;if(!W||typeof W!="function"&&typeof W!="object")return!1;if(H)return I(W);if(D(W))return!1;var Z=M.call(W);return Z!==k&&Z!==F&&!/^\[object HTML/.test(Z)?!1:I(W)}},{}],411:[function(_,w,B){var A=Object.prototype.toString,O=Function.prototype.toString,R=/^\s*(?:function)?\*/,P=_("has-tostringtag/shams")(),E=Object.getPrototypeOf,D=function(){if(!P)return!1;try{return Function("return function*() {}")()}catch(M){}},I;w.exports=function(N){if(typeof N!="function")return!1;if(R.test(O.call(N)))return!0;if(!P){var k=A.call(N);return k==="[object GeneratorFunction]"}if(!E)return!1;if(typeof I>"u"){var F=D();I=F?E(F):!1}return E(N)===I}},{"has-tostringtag/shams":396}],412:[function(_,w,B){var A=_("which-typed-array");w.exports=function(R){return!!A(R)}},{"which-typed-array":490}],413:[function(_,w,B){(function(A){(function(){(function(O,R){typeof B=="object"&&typeof w<"u"?w.exports=R(O):R(O)})(typeof self<"u"?self:typeof window<"u"?window:typeof A<"u"?A:this,function(O){O=O||{};var R=O.Base64,P="2.6.4",E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D=function(K){for(var ue={},le=0,ce=K.length;le<ce;le++)ue[K.charAt(le)]=le;return ue}(E),I=String.fromCharCode,M=function(K){if(K.length<2){var ue=K.charCodeAt(0);return ue<128?K:ue<2048?I(192|ue>>>6)+I(128|ue&63):I(224|ue>>>12&15)+I(128|ue>>>6&63)+I(128|ue&63)}else{var ue=65536+(K.charCodeAt(0)-55296)*1024+(K.charCodeAt(1)-56320);return I(240|ue>>>18&7)+I(128|ue>>>12&63)+I(128|ue>>>6&63)+I(128|ue&63)}},N=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,k=function(K){return K.replace(N,M)},F=function(K){var ue=[0,2,1][K.length%3],le=K.charCodeAt(0)<<16|(K.length>1?K.charCodeAt(1):0)<<8|(K.length>2?K.charCodeAt(2):0),ce=[E.charAt(le>>>18),E.charAt(le>>>12&63),ue>=2?"=":E.charAt(le>>>6&63),ue>=1?"=":E.charAt(le&63)];return ce.join("")},G=O.btoa&&typeof O.btoa=="function"?function(K){return O.btoa(K)}:function(K){if(K.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return K.replace(/[\s\S]{1,3}/g,F)},V=function(K){return G(k(String(K)))},j=function(K){return K.replace(/[+\/]/g,function(ue){return ue=="+"?"-":"_"}).replace(/=/g,"")},H=function(K,ue){return ue?j(V(K)):V(K)},U=function(K){return H(K,!0)},X;O.Uint8Array&&(X=function(K,ue){for(var le="",ce=0,_e=K.length;ce<_e;ce+=3){var oe=K[ce],de=K[ce+1],me=K[ce+2],ye=oe<<16|de<<8|me;le+=E.charAt(ye>>>18)+E.charAt(ye>>>12&63)+(typeof de<"u"?E.charAt(ye>>>6&63):"=")+(typeof me<"u"?E.charAt(ye&63):"=")}return ue?j(le):le});var Y=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,z=function(K){switch(K.length){case 4:var ue=(7&K.charCodeAt(0))<<18|(63&K.charCodeAt(1))<<12|(63&K.charCodeAt(2))<<6|63&K.charCodeAt(3),le=ue-65536;return I((le>>>10)+55296)+I((le&1023)+56320);case 3:return I((15&K.charCodeAt(0))<<12|(63&K.charCodeAt(1))<<6|63&K.charCodeAt(2));default:return I((31&K.charCodeAt(0))<<6|63&K.charCodeAt(1))}},W=function(K){return K.replace(Y,z)},Z=function(K){var ue=K.length,le=ue%4,ce=(ue>0?D[K.charAt(0)]<<18:0)|(ue>1?D[K.charAt(1)]<<12:0)|(ue>2?D[K.charAt(2)]<<6:0)|(ue>3?D[K.charAt(3)]:0),_e=[I(ce>>>16),I(ce>>>8&255),I(ce&255)];return _e.length-=[0,0,2,1][le],_e.join("")},Q=O.atob&&typeof O.atob=="function"?function(K){return O.atob(K)}:function(K){return K.replace(/\S{1,4}/g,Z)},ee=function(K){return Q(String(K).replace(/[^A-Za-z0-9\+\/]/g,""))},te=function(K){return W(Q(K))},re=function(K){return String(K).replace(/[-_]/g,function(ue){return ue=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")},ie=function(K){return te(re(K))},ne;O.Uint8Array&&(ne=function(K){return Uint8Array.from(ee(re(K)),function(ue){return ue.charCodeAt(0)})});var he=function(){var K=O.Base64;return O.Base64=R,K};if(O.Base64={VERSION:P,atob:ee,btoa:G,fromBase64:ie,toBase64:H,utob:k,encode:H,encodeURI:U,btou:W,decode:ie,noConflict:he,fromUint8Array:X,toUint8Array:ne},typeof Object.defineProperty=="function"){var pe=function(K){return{value:K,enumerable:!1,writable:!0,configurable:!0}};O.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",pe(function(){return ie(this)})),Object.defineProperty(String.prototype,"toBase64",pe(function(K){return H(this,K)})),Object.defineProperty(String.prototype,"toBase64URI",pe(function(){return H(this,!0)}))}}return O.Meteor&&(Base64=O.Base64),typeof w<"u"&&w.exports&&(w.exports.Base64=O.Base64),{Base64:O.Base64}})}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],414:[function(_,w,B){var A=_("./_root"),O=A.Symbol;w.exports=O},{"./_root":421}],415:[function(_,w,B){function A(O,R){for(var P=-1,E=O==null?0:O.length,D=Array(E);++P<E;)D[P]=R(O[P],P,O);return D}w.exports=A},{}],416:[function(_,w,B){var A=_("./_Symbol"),O=_("./_getRawTag"),R=_("./_objectToString"),P="[object Null]",E="[object Undefined]",D=A?A.toStringTag:void 0;function I(M){return M==null?M===void 0?E:P:D&&D in Object(M)?O(M):R(M)}w.exports=I},{"./_Symbol":414,"./_getRawTag":419,"./_objectToString":420}],417:[function(_,w,B){var A=_("./_Symbol"),O=_("./_arrayMap"),R=_("./isArray"),P=_("./isSymbol"),E=A?A.prototype:void 0,D=E?E.toString:void 0;function I(M){if(typeof M=="string")return M;if(R(M))return O(M,I)+"";if(P(M))return D?D.call(M):"";var N=M+"";return N=="0"&&1/M==-1/0?"-0":N}w.exports=I},{"./_Symbol":414,"./_arrayMap":415,"./isArray":422,"./isSymbol":426}],418:[function(_,w,B){(function(A){(function(){var O=typeof A=="object"&&A&&A.Object===Object&&A;w.exports=O}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],419:[function(_,w,B){var A=_("./_Symbol"),O=Object.prototype,R=O.hasOwnProperty,P=O.toString,E=A?A.toStringTag:void 0;function D(I){var M=R.call(I,E),N=I[E];try{I[E]=void 0;var k=!0}catch(G){}var F=P.call(I);return k&&(M?I[E]=N:delete I[E]),F}w.exports=D},{"./_Symbol":414}],420:[function(_,w,B){var A=Object.prototype,O=A.toString;function R(P){return O.call(P)}w.exports=R},{}],421:[function(_,w,B){var A=_("./_freeGlobal"),O=typeof self=="object"&&self&&self.Object===Object&&self,R=A||O||Function("return this")();w.exports=R},{"./_freeGlobal":418}],422:[function(_,w,B){var A=Array.isArray;w.exports=A},{}],423:[function(_,w,B){function A(O){var R=typeof O;return O!=null&&(R=="object"||R=="function")}w.exports=A},{}],424:[function(_,w,B){function A(O){return O!=null&&typeof O=="object"}w.exports=A},{}],425:[function(_,w,B){var A=_("./_baseGetTag"),O=_("./isArray"),R=_("./isObjectLike"),P="[object String]";function E(D){return typeof D=="string"||!O(D)&&R(D)&&A(D)==P}w.exports=E},{"./_baseGetTag":416,"./isArray":422,"./isObjectLike":424}],426:[function(_,w,B){var A=_("./_baseGetTag"),O=_("./isObjectLike"),R="[object Symbol]";function P(E){return typeof E=="symbol"||O(E)&&A(E)==R}w.exports=P},{"./_baseGetTag":416,"./isObjectLike":424}],427:[function(_,w,B){var A=_("./_baseToString");function O(R){return R==null?"":A(R)}w.exports=O},{"./_baseToString":417}],428:[function(_,w,B){w.exports=O;var A=Object.prototype.hasOwnProperty;function O(R,P,E){if(!R)throw new TypeError("argument dest is required");if(!P)throw new TypeError("argument src is required");return E===void 0&&(E=!0),Object.getOwnPropertyNames(P).forEach(function(I){if(!(!E&&A.call(R,I))){var M=Object.getOwnPropertyDescriptor(P,I);Object.defineProperty(R,I,M)}}),R}},{}],429:[function(_,w,B){_("core-js/modules/es.array.map.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.regexp.constructor.js"),_("core-js/modules/es.regexp.to-string.js");function A(){this._types=Object.create(null),this._extensions=Object.create(null);for(var O=0;O<arguments.length;O++)this.define(arguments[O]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}A.prototype.define=function(O,R){for(var P in O){var E=O[P].map(function(N){return N.toLowerCase()});P=P.toLowerCase();for(var D=0;D<E.length;D++){var I=E[D];if(I[0]!=="*"){if(!R&&I in this._types)throw new Error('Attempt to change mapping for "'+I+'" extension from "'+this._types[I]+'" to "'+P+'". Pass `force=true` to allow this, otherwise remove "'+I+'" from the list of extensions for "'+P+'".');this._types[I]=P}}if(R||!this._extensions[P]){var M=E[0];this._extensions[P]=M[0]!=="*"?M:M.substr(1)}}},A.prototype.getType=function(O){O=String(O);var R=O.replace(/^.*[/\\]/,"").toLowerCase(),P=R.replace(/^.*\./,"").toLowerCase(),E=R.length<O.length,D=P.length<R.length-1;return(D||!E)&&this._types[P]||null},A.prototype.getExtension=function(O){return O=/^\s*([^;\s]*)/.test(O)&&RegExp.$1,O&&this._extensions[O.toLowerCase()]||null},w.exports=A},{"core-js/modules/es.array.map.js":318,"core-js/modules/es.regexp.constructor.js":337,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/es.string.replace.js":345}],430:[function(_,w,B){var A=_("./Mime");w.exports=new A(_("./types/standard"))},{"./Mime":429,"./types/standard":431}],431:[function(_,w,B){w.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},{}],432:[function(_,w,B){var A=1e3,O=A*60,R=O*60,P=R*24,E=P*7,D=P*365.25;w.exports=function(F,G){G=G||{};var V=typeof F;if(V==="string"&&F.length>0)return I(F);if(V==="number"&&isFinite(F))return G.long?N(F):M(F);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(F))};function I(F){if(F=String(F),!(F.length>100)){var G=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(F);if(G){var V=parseFloat(G[1]),j=(G[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return V*D;case"weeks":case"week":case"w":return V*E;case"days":case"day":case"d":return V*P;case"hours":case"hour":case"hrs":case"hr":case"h":return V*R;case"minutes":case"minute":case"mins":case"min":case"m":return V*O;case"seconds":case"second":case"secs":case"sec":case"s":return V*A;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return V;default:return}}}}function M(F){var G=Math.abs(F);return G>=P?Math.round(F/P)+"d":G>=R?Math.round(F/R)+"h":G>=O?Math.round(F/O)+"m":G>=A?Math.round(F/A)+"s":F+"ms"}function N(F){var G=Math.abs(F);return G>=P?k(F,G,P,"day"):G>=R?k(F,G,R,"hour"):G>=O?k(F,G,O,"minute"):G>=A?k(F,G,A,"second"):F+" ms"}function k(F,G,V,j){var H=G>=V*1.5;return Math.round(F/V)+" "+j+(H?"s":"")}},{}],433:[function(_,w,B){(function(A){(function(){var O=typeof Map=="function"&&Map.prototype,R=Object.getOwnPropertyDescriptor&&O?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,P=O&&R&&typeof R.get=="function"?R.get:null,E=O&&Map.prototype.forEach,D=typeof Set=="function"&&Set.prototype,I=Object.getOwnPropertyDescriptor&&D?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,M=D&&I&&typeof I.get=="function"?I.get:null,N=D&&Set.prototype.forEach,k=typeof WeakMap=="function"&&WeakMap.prototype,F=k?WeakMap.prototype.has:null,G=typeof WeakSet=="function"&&WeakSet.prototype,V=G?WeakSet.prototype.has:null,j=typeof WeakRef=="function"&&WeakRef.prototype,H=j?WeakRef.prototype.deref:null,U=Boolean.prototype.valueOf,X=Object.prototype.toString,Y=Function.prototype.toString,z=String.prototype.match,W=String.prototype.slice,Z=String.prototype.replace,Q=String.prototype.toUpperCase,ee=String.prototype.toLowerCase,te=RegExp.prototype.test,re=Array.prototype.concat,ie=Array.prototype.join,ne=Array.prototype.slice,he=Math.floor,pe=typeof BigInt=="function"?BigInt.prototype.valueOf:null,K=Object.getOwnPropertySymbols,ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,le=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ce=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===le||!0)?Symbol.toStringTag:null,_e=Object.prototype.propertyIsEnumerable,oe=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(qe){return qe.__proto__}:null);function de(qe,rt){if(qe===1/0||qe===-1/0||qe!==qe||qe&&qe>-1e3&&qe<1e3||te.call(/e/,rt))return rt;var bt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof qe=="number"){var Dt=qe<0?-he(-qe):he(qe);if(Dt!==qe){var Et=String(Dt),Lt=W.call(rt,Et.length+1);return Z.call(Et,bt,"$&_")+"."+Z.call(Z.call(Lt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Z.call(rt,bt,"$&_")}var me=_("./util.inspect"),ye=me.custom,ge=Ve(ye)?ye:null;w.exports=function qe(rt,bt,Dt,Et){var Lt=bt||{};if(Ne(Lt,"quoteStyle")&&Lt.quoteStyle!=="single"&&Lt.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ne(Lt,"maxStringLength")&&(typeof Lt.maxStringLength=="number"?Lt.maxStringLength<0&&Lt.maxStringLength!==1/0:Lt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Ot=Ne(Lt,"customInspect")?Lt.customInspect:!0;if(typeof Ot!="boolean"&&Ot!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ne(Lt,"indent")&&Lt.indent!==null&&Lt.indent!=="	"&&!(parseInt(Lt.indent,10)===Lt.indent&&Lt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ne(Lt,"numericSeparator")&&typeof Lt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Kt=Lt.numericSeparator;if(typeof rt>"u")return"undefined";if(rt===null)return"null";if(typeof rt=="boolean")return rt?"true":"false";if(typeof rt=="string")return gt(rt,Lt);if(typeof rt=="number"){if(rt===0)return 1/0/rt>0?"0":"-0";var Jt=String(rt);return Kt?de(rt,Jt):Jt}if(typeof rt=="bigint"){var Yt=String(rt)+"n";return Kt?de(rt,Yt):Yt}var Wt=typeof Lt.depth>"u"?5:Lt.depth;if(typeof Dt>"u"&&(Dt=0),Dt>=Wt&&Wt>0&&typeof rt=="object")return Ee(rt)?"[Array]":"[Object]";var rr=Qe(Lt,Dt);if(typeof Et>"u")Et=[];else if(Fe(Et,rt)>=0)return"[Circular]";function Ft(Mt,Nt,kt){if(Nt&&(Et=ne.call(Et),Et.push(Nt)),kt){var er={depth:Lt.depth};return Ne(Lt,"quoteStyle")&&(er.quoteStyle=Lt.quoteStyle),qe(Mt,er,Dt+1,Et)}return qe(Mt,Lt,Dt+1,Et)}if(typeof rt=="function"&&!fe(rt)){var zt=Oe(rt),lr=pt(rt,Ft);return"[Function"+(zt?": "+zt:" (anonymous)")+"]"+(lr.length>0?" { "+ie.call(lr,", ")+" }":"")}if(Ve(rt)){var nr=le?Z.call(String(rt),/^(Symbol\(.*\))_[^)]*$/,"$1"):ue.call(rt);return typeof rt=="object"&&!le?We(nr):nr}if(ut(rt)){for(var tt="<"+ee.call(String(rt.nodeName)),ft=rt.attributes||[],lt=0;lt<ft.length;lt++)tt+=" "+ft[lt].name+"="+we(Te(ft[lt].value),"double",Lt);return tt+=">",rt.childNodes&&rt.childNodes.length&&(tt+="..."),tt+="</"+ee.call(String(rt.nodeName))+">",tt}if(Ee(rt)){if(rt.length===0)return"[]";var at=pt(rt,Ft);return rr&&!je(at)?"["+st(at,rr)+"]":"[ "+ie.call(at,", ")+" ]"}if(Ce(rt)){var dt=pt(rt,Ft);return!("cause"in Error.prototype)&&"cause"in rt&&!_e.call(rt,"cause")?"{ ["+String(rt)+"] "+ie.call(re.call("[cause]: "+Ft(rt.cause),dt),", ")+" }":dt.length===0?"["+String(rt)+"]":"{ ["+String(rt)+"] "+ie.call(dt,", ")+" }"}if(typeof rt=="object"&&Ot){if(ge&&typeof rt[ge]=="function"&&me)return me(rt,{depth:Wt-Dt});if(Ot!=="symbol"&&typeof rt.inspect=="function")return rt.inspect()}if(nt(rt)){var _t=[];return E&&E.call(rt,function(Mt,Nt){_t.push(Ft(Nt,rt,!0)+" => "+Ft(Mt,rt))}),Be("Map",P.call(rt),_t,rr)}if($e(rt)){var Ct=[];return N&&N.call(rt,function(Mt){Ct.push(Ft(Mt,rt))}),Be("Set",M.call(rt),Ct,rr)}if(Ze(rt))return ht("WeakMap");if(ot(rt))return ht("WeakSet");if(Xe(rt))return ht("WeakRef");if(be(rt))return We(Ft(Number(rt)));if(Pe(rt))return We(Ft(pe.call(rt)));if(Re(rt))return We(U.call(rt));if(Se(rt))return We(Ft(String(rt)));if(typeof window<"u"&&rt===window)return"{ [object Window] }";if(rt===A)return"{ [object globalThis] }";if(!De(rt)&&!fe(rt)){var It=pt(rt,Ft),xt=oe?oe(rt)===Object.prototype:rt instanceof Object||rt.constructor===Object,yt=rt instanceof Object?"":"null prototype",At=!xt&&ce&&Object(rt)===rt&&ce in rt?W.call(Ae(rt),8,-1):yt?"Object":"",Rt=xt||typeof rt.constructor!="function"?"":rt.constructor.name?rt.constructor.name+" ":"",Gt=Rt+(At||yt?"["+ie.call(re.call([],At||[],yt||[]),": ")+"] ":"");return It.length===0?Gt+"{}":rr?Gt+"{"+st(It,rr)+"}":Gt+"{ "+ie.call(It,", ")+" }"}return String(rt)};function we(qe,rt,bt){var Dt=(bt.quoteStyle||rt)==="double"?'"':"'";return Dt+qe+Dt}function Te(qe){return Z.call(String(qe),/"/g,"&quot;")}function Ee(qe){return Ae(qe)==="[object Array]"&&(!ce||!(typeof qe=="object"&&ce in qe))}function De(qe){return Ae(qe)==="[object Date]"&&(!ce||!(typeof qe=="object"&&ce in qe))}function fe(qe){return Ae(qe)==="[object RegExp]"&&(!ce||!(typeof qe=="object"&&ce in qe))}function Ce(qe){return Ae(qe)==="[object Error]"&&(!ce||!(typeof qe=="object"&&ce in qe))}function Se(qe){return Ae(qe)==="[object String]"&&(!ce||!(typeof qe=="object"&&ce in qe))}function be(qe){return Ae(qe)==="[object Number]"&&(!ce||!(typeof qe=="object"&&ce in qe))}function Re(qe){return Ae(qe)==="[object Boolean]"&&(!ce||!(typeof qe=="object"&&ce in qe))}function Ve(qe){if(le)return qe&&typeof qe=="object"&&qe instanceof Symbol;if(typeof qe=="symbol")return!0;if(!qe||typeof qe!="object"||!ue)return!1;try{return ue.call(qe),!0}catch(rt){}return!1}function Pe(qe){if(!qe||typeof qe!="object"||!pe)return!1;try{return pe.call(qe),!0}catch(rt){}return!1}var ke=Object.prototype.hasOwnProperty||function(qe){return qe in this};function Ne(qe,rt){return ke.call(qe,rt)}function Ae(qe){return X.call(qe)}function Oe(qe){if(qe.name)return qe.name;var rt=z.call(Y.call(qe),/^function\s*([\w$]+)/);return rt?rt[1]:null}function Fe(qe,rt){if(qe.indexOf)return qe.indexOf(rt);for(var bt=0,Dt=qe.length;bt<Dt;bt++)if(qe[bt]===rt)return bt;return-1}function nt(qe){if(!P||!qe||typeof qe!="object")return!1;try{P.call(qe);try{M.call(qe)}catch(rt){return!0}return qe instanceof Map}catch(rt){}return!1}function Ze(qe){if(!F||!qe||typeof qe!="object")return!1;try{F.call(qe,F);try{V.call(qe,V)}catch(rt){return!0}return qe instanceof WeakMap}catch(rt){}return!1}function Xe(qe){if(!H||!qe||typeof qe!="object")return!1;try{return H.call(qe),!0}catch(rt){}return!1}function $e(qe){if(!M||!qe||typeof qe!="object")return!1;try{M.call(qe);try{P.call(qe)}catch(rt){return!0}return qe instanceof Set}catch(rt){}return!1}function ot(qe){if(!V||!qe||typeof qe!="object")return!1;try{V.call(qe,V);try{F.call(qe,F)}catch(rt){return!0}return qe instanceof WeakSet}catch(rt){}return!1}function ut(qe){return!qe||typeof qe!="object"?!1:typeof HTMLElement<"u"&&qe instanceof HTMLElement?!0:typeof qe.nodeName=="string"&&typeof qe.getAttribute=="function"}function gt(qe,rt){if(qe.length>rt.maxStringLength){var bt=qe.length-rt.maxStringLength,Dt="... "+bt+" more character"+(bt>1?"s":"");return gt(W.call(qe,0,rt.maxStringLength),rt)+Dt}var Et=Z.call(Z.call(qe,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Ue);return we(Et,"single",rt)}function Ue(qe){var rt=qe.charCodeAt(0),bt={8:"b",9:"t",10:"n",12:"f",13:"r"}[rt];return bt?"\\"+bt:"\\x"+(rt<16?"0":"")+Q.call(rt.toString(16))}function We(qe){return"Object("+qe+")"}function ht(qe){return qe+" { ? }"}function Be(qe,rt,bt,Dt){var Et=Dt?st(bt,Dt):ie.call(bt,", ");return qe+" ("+rt+") {"+Et+"}"}function je(qe){for(var rt=0;rt<qe.length;rt++)if(Fe(qe[rt],"\n")>=0)return!1;return!0}function Qe(qe,rt){var bt;if(qe.indent==="	")bt="	";else if(typeof qe.indent=="number"&&qe.indent>0)bt=ie.call(Array(qe.indent+1)," ");else return null;return{base:bt,prev:ie.call(Array(rt+1),bt)}}function st(qe,rt){if(qe.length===0)return"";var bt="\n"+rt.prev+rt.base;return bt+ie.call(qe,","+bt)+"\n"+rt.prev}function pt(qe,rt){var bt=Ee(qe),Dt=[];if(bt){Dt.length=qe.length;for(var Et=0;Et<qe.length;Et++)Dt[Et]=Ne(qe,Et)?rt(qe[Et],qe):""}var Lt=typeof K=="function"?K(qe):[],Ot;if(le){Ot={};for(var Kt=0;Kt<Lt.length;Kt++)Ot["$"+Lt[Kt]]=Lt[Kt]}for(var Jt in qe)Ne(qe,Jt)&&(bt&&String(Number(Jt))===Jt&&Jt<qe.length||le&&Ot["$"+Jt]instanceof Symbol||(te.call(/[^\w$]/,Jt)?Dt.push(rt(Jt,qe)+": "+rt(qe[Jt],qe)):Dt.push(Jt+": "+rt(qe[Jt],qe))));if(typeof K=="function")for(var Yt=0;Yt<Lt.length;Yt++)_e.call(qe,Lt[Yt])&&Dt.push("["+rt(Lt[Yt])+"]: "+rt(qe[Lt[Yt]],qe));return Dt}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"./util.inspect":102}],434:[function(_,w,B){var A;if(!Object.keys){var O=Object.prototype.hasOwnProperty,R=Object.prototype.toString,P=_("./isArguments"),E=Object.prototype.propertyIsEnumerable,D=!E.call({toString:null},"toString"),I=E.call(function(){},"prototype"),M=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],N=function(V){var j=V.constructor;return j&&j.prototype===V},k={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},F=function(){if(typeof window>"u")return!1;for(var V in window)try{if(!k["$"+V]&&O.call(window,V)&&window[V]!==null&&typeof window[V]=="object")try{N(window[V])}catch(j){return!0}}catch(j){return!0}return!1}(),G=function(V){if(typeof window>"u"||!F)return N(V);try{return N(V)}catch(j){return!1}};A=function(j){var H=j!==null&&typeof j=="object",U=R.call(j)==="[object Function]",X=P(j),Y=H&&R.call(j)==="[object String]",z=[];if(!H&&!U&&!X)throw new TypeError("Object.keys called on a non-object");var W=I&&U;if(Y&&j.length>0&&!O.call(j,0))for(var Z=0;Z<j.length;++Z)z.push(String(Z));if(X&&j.length>0)for(var Q=0;Q<j.length;++Q)z.push(String(Q));else for(var ee in j)!(W&&ee==="prototype")&&O.call(j,ee)&&z.push(String(ee));if(D)for(var te=G(j),re=0;re<M.length;++re)!(te&&M[re]==="constructor")&&O.call(j,M[re])&&z.push(M[re]);return z}}w.exports=A},{"./isArguments":436}],435:[function(_,w,B){var A=Array.prototype.slice,O=_("./isArguments"),R=Object.keys,P=R?function(I){return R(I)}:_("./implementation"),E=Object.keys;P.shim=function(){if(Object.keys){var I=function(){var M=Object.keys(arguments);return M&&M.length===arguments.length}(1,2);I||(Object.keys=function(N){return O(N)?E(A.call(N)):E(N)})}else Object.keys=P;return Object.keys||P},w.exports=P},{"./implementation":434,"./isArguments":436}],436:[function(_,w,B){var A=Object.prototype.toString;w.exports=function(R){var P=A.call(R),E=P==="[object Arguments]";return E||(E=P!=="[object Array]"&&R!==null&&typeof R=="object"&&typeof R.length=="number"&&R.length>=0&&A.call(R.callee)==="[object Function]"),E}},{}],437:[function(_,w,B){var A=_("object-keys"),O=_("has-symbols/shams")(),R=_("call-bind/callBound"),P=Object,E=R("Array.prototype.push"),D=R("Object.prototype.propertyIsEnumerable"),I=O?Object.getOwnPropertySymbols:null;w.exports=function(N,k){if(N==null)throw new TypeError("target must be an object");var F=P(N);if(arguments.length===1)return F;for(var G=1;G<arguments.length;++G){var V=P(arguments[G]),j=A(V),H=O&&(Object.getOwnPropertySymbols||I);if(H)for(var U=H(V),X=0;X<U.length;++X){var Y=U[X];D(V,Y)&&E(j,Y)}for(var z=0;z<j.length;++z){var W=j[z];if(D(V,W)){var Z=V[W];F[W]=Z}}}return F}},{"call-bind/callBound":105,"has-symbols/shams":395,"object-keys":435}],438:[function(_,w,B){var A=_("./implementation"),O=function(){if(!Object.assign)return!1;for(var P="abcdefghijklmnopqrst",E=P.split(""),D={},I=0;I<E.length;++I)D[E[I]]=E[I];var M=Object.assign({},D),N="";for(var k in M)N+=k;return P!==N},R=function(){if(!Object.assign||!Object.preventExtensions)return!1;var P=Object.preventExtensions({1:2});try{Object.assign(P,"xy")}catch(E){return P[1]==="y"}return!1};w.exports=function(){return!Object.assign||O()||R()?A:Object.assign}},{"./implementation":437}],439:[function(_,w,B){(function(A){(function(){function O(D){if(typeof D!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(D))}function R(D,I){for(var M="",N=0,k=-1,F=0,G,V=0;V<=D.length;++V){if(V<D.length)G=D.charCodeAt(V);else{if(G===47)break;G=47}if(G===47){if(!(k===V-1||F===1))if(k!==V-1&&F===2){if(M.length<2||N!==2||M.charCodeAt(M.length-1)!==46||M.charCodeAt(M.length-2)!==46){if(M.length>2){var j=M.lastIndexOf("/");if(j!==M.length-1){j===-1?(M="",N=0):(M=M.slice(0,j),N=M.length-1-M.lastIndexOf("/")),k=V,F=0;continue}}else if(M.length===2||M.length===1){M="",N=0,k=V,F=0;continue}}I&&(M.length>0?M+="/..":M="..",N=2)}else M.length>0?M+="/"+D.slice(k+1,V):M=D.slice(k+1,V),N=V-k-1;k=V,F=0}else G===46&&F!==-1?++F:F=-1}return M}function P(D,I){var M=I.dir||I.root,N=I.base||(I.name||"")+(I.ext||"");return M?M===I.root?M+N:M+D+N:N}var E={resolve:function(){for(var I="",M=!1,N,k=arguments.length-1;k>=-1&&!M;k--){var F;k>=0?F=arguments[k]:(N===void 0&&(N=A.cwd()),F=N),O(F),F.length!==0&&(I=F+"/"+I,M=F.charCodeAt(0)===47)}return I=R(I,!M),M?I.length>0?"/"+I:"/":I.length>0?I:"."},normalize:function(I){if(O(I),I.length===0)return".";var M=I.charCodeAt(0)===47,N=I.charCodeAt(I.length-1)===47;return I=R(I,!M),I.length===0&&!M&&(I="."),I.length>0&&N&&(I+="/"),M?"/"+I:I},isAbsolute:function(I){return O(I),I.length>0&&I.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var I,M=0;M<arguments.length;++M){var N=arguments[M];O(N),N.length>0&&(I===void 0?I=N:I+="/"+N)}return I===void 0?".":E.normalize(I)},relative:function(I,M){if(O(I),O(M),I===M||(I=E.resolve(I),M=E.resolve(M),I===M))return"";for(var N=1;N<I.length&&I.charCodeAt(N)===47;++N);for(var k=I.length,F=k-N,G=1;G<M.length&&M.charCodeAt(G)===47;++G);for(var V=M.length,j=V-G,H=F<j?F:j,U=-1,X=0;X<=H;++X){if(X===H){if(j>H){if(M.charCodeAt(G+X)===47)return M.slice(G+X+1);if(X===0)return M.slice(G+X)}else F>H&&(I.charCodeAt(N+X)===47?U=X:X===0&&(U=0));break}var Y=I.charCodeAt(N+X),z=M.charCodeAt(G+X);if(Y!==z)break;Y===47&&(U=X)}var W="";for(X=N+U+1;X<=k;++X)(X===k||I.charCodeAt(X)===47)&&(W.length===0?W+="..":W+="/..");return W.length>0?W+M.slice(G+U):(G+=U,M.charCodeAt(G)===47&&++G,M.slice(G))},_makeLong:function(I){return I},dirname:function(I){if(O(I),I.length===0)return".";for(var M=I.charCodeAt(0),N=M===47,k=-1,F=!0,G=I.length-1;G>=1;--G)if(M=I.charCodeAt(G),M===47){if(!F){k=G;break}}else F=!1;return k===-1?N?"/":".":N&&k===1?"//":I.slice(0,k)},basename:function(I,M){if(M!==void 0&&typeof M!="string")throw new TypeError('"ext" argument must be a string');O(I);var N=0,k=-1,F=!0,G;if(M!==void 0&&M.length>0&&M.length<=I.length){if(M.length===I.length&&M===I)return"";var V=M.length-1,j=-1;for(G=I.length-1;G>=0;--G){var H=I.charCodeAt(G);if(H===47){if(!F){N=G+1;break}}else j===-1&&(F=!1,j=G+1),V>=0&&(H===M.charCodeAt(V)?--V===-1&&(k=G):(V=-1,k=j))}return N===k?k=j:k===-1&&(k=I.length),I.slice(N,k)}else{for(G=I.length-1;G>=0;--G)if(I.charCodeAt(G)===47){if(!F){N=G+1;break}}else k===-1&&(F=!1,k=G+1);return k===-1?"":I.slice(N,k)}},extname:function(I){O(I);for(var M=-1,N=0,k=-1,F=!0,G=0,V=I.length-1;V>=0;--V){var j=I.charCodeAt(V);if(j===47){if(!F){N=V+1;break}continue}k===-1&&(F=!1,k=V+1),j===46?M===-1?M=V:G!==1&&(G=1):M!==-1&&(G=-1)}return M===-1||k===-1||G===0||G===1&&M===k-1&&M===N+1?"":I.slice(M,k)},format:function(I){if(I===null||typeof I!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof I);return P("/",I)},parse:function(I){O(I);var M={root:"",dir:"",base:"",ext:"",name:""};if(I.length===0)return M;var N=I.charCodeAt(0),k=N===47,F;k?(M.root="/",F=1):F=0;for(var G=-1,V=0,j=-1,H=!0,U=I.length-1,X=0;U>=F;--U){if(N=I.charCodeAt(U),N===47){if(!H){V=U+1;break}continue}j===-1&&(H=!1,j=U+1),N===46?G===-1?G=U:X!==1&&(X=1):G!==-1&&(X=-1)}return G===-1||j===-1||X===0||X===1&&G===j-1&&G===V+1?j!==-1&&(V===0&&k?M.base=M.name=I.slice(1,j):M.base=M.name=I.slice(V,j)):(V===0&&k?(M.name=I.slice(1,G),M.base=I.slice(1,j)):(M.name=I.slice(V,G),M.base=I.slice(V,j)),M.ext=I.slice(G,j)),V>0?M.dir=I.slice(0,V-1):k&&(M.dir="/"),M},sep:"/",delimiter:":",win32:null,posix:null};E.posix=E,w.exports=E}).call(this)}).call(this,_("_process"))},{_process:538}],440:[function(_,w,B){(function(A){(function(){(function(){var O={function:!0,object:!0},R=O[typeof window]&&window||this,P=O[typeof B]&&B,E=O[typeof w]&&w&&!w.nodeType&&w,D=P&&E&&typeof A=="object"&&A;D&&(D.global===D||D.window===D||D.self===D)&&(R=D);var I=Math.pow(2,53)-1,M=/\bOpera/,N=Object.prototype,k=N.hasOwnProperty,F=N.toString;function G(te){return te=String(te),te.charAt(0).toUpperCase()+te.slice(1)}function V(te,re,ie){var ne={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return re&&ie&&/^Win/i.test(te)&&!/^Windows Phone /i.test(te)&&(ne=ne[/[\d.]+$/.exec(te)])&&(te="Windows "+ne),te=String(te),re&&ie&&(te=te.replace(RegExp(re,"i"),ie)),te=H(te.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),te}function j(te,re){var ie=-1,ne=te?te.length:0;if(typeof ne=="number"&&ne>-1&&ne<=I)for(;++ie<ne;)re(te[ie],ie,te);else U(te,re)}function H(te){return te=Z(te),/^(?:webOS|i(?:OS|P))/.test(te)?te:G(te)}function U(te,re){for(var ie in te)k.call(te,ie)&&re(te[ie],ie,te)}function X(te){return te==null?G(te):F.call(te).slice(8,-1)}function Y(te,re){var ie=te!=null?typeof te[re]:"number";return!/^(?:boolean|number|string|undefined)$/.test(ie)&&(ie=="object"?!!te[re]:!0)}function z(te){return String(te).replace(/([ -])(?!$)/g,"$1?")}function W(te,re){var ie=null;return j(te,function(ne,he){ie=re(ie,ne,he,te)}),ie}function Z(te){return String(te).replace(/^ +| +$/g,"")}function Q(te){var re=R,ie=te&&typeof te=="object"&&X(te)!="String";ie&&(re=te,te=null);var ne=re.navigator||{},he=ne.userAgent||"";te||(te=he);var pe=ie?!!ne.likeChrome:/\bChrome\b/.test(te)&&!/internal|\n/i.test(F.toString()),K="Object",ue=ie?K:"ScriptBridgingProxyObject",le=ie?K:"Environment",ce=ie&&re.java?"JavaPackage":X(re.java),_e=ie?K:"RuntimeObject",oe=/\bJava/.test(ce)&&re.java,de=oe&&X(re.environment)==le,me=oe?"a":"α",ye=oe?"b":"β",ge=re.document||{},we=re.operamini||re.opera,Te=M.test(Te=ie&&we?we["[[Class]]"]:X(we))?Te:we=null,Ee,De=te,fe=[],Ce=null,Se=te==he,be=Se&&we&&typeof we.version=="function"&&we.version(),Re,Ve=Oe([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Pe=nt(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),ke=Xe([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Ne=Fe({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Ae=Ze(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Oe(gt){return W(gt,function(Ue,We){return Ue||RegExp("\\b"+(We.pattern||z(We))+"\\b","i").exec(te)&&(We.label||We)})}function Fe(gt){return W(gt,function(Ue,We,ht){return Ue||(We[ke]||We[/^[a-z]+(?: +[a-z]+\b)*/i.exec(ke)]||RegExp("\\b"+z(ht)+"(?:\\b|\\w*\\d)","i").exec(te))&&ht})}function nt(gt){return W(gt,function(Ue,We){return Ue||RegExp("\\b"+(We.pattern||z(We))+"\\b","i").exec(te)&&(We.label||We)})}function Ze(gt){return W(gt,function(Ue,We){var ht=We.pattern||z(We);return!Ue&&(Ue=RegExp("\\b"+ht+"(?:/[\\d.]+|[ \\w.]*)","i").exec(te))&&(Ue=V(Ue,ht,We.label||We)),Ue})}function Xe(gt){return W(gt,function(Ue,We){var ht=We.pattern||z(We);return!Ue&&(Ue=RegExp("\\b"+ht+" *\\d+[.\\w_]*","i").exec(te)||RegExp("\\b"+ht+" *\\w+-[\\w]*","i").exec(te)||RegExp("\\b"+ht+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(te))&&((Ue=String(We.label&&!RegExp(ht,"i").test(We.label)?We.label:Ue).split("/"))[1]&&!/[\d.]+/.test(Ue[0])&&(Ue[0]+=" "+Ue[1]),We=We.label||We,Ue=H(Ue[0].replace(RegExp(ht,"i"),We).replace(RegExp("; *(?:"+We+"[_-])?","i")," ").replace(RegExp("("+We+")[-_.]?(\\w)","i"),"$1 $2"))),Ue})}function $e(gt){return W(gt,function(Ue,We){return Ue||(RegExp(We+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(te)||0)[1]||null})}function ot(){return this.description||""}if(Ve&&(Ve=[Ve]),/\bAndroid\b/.test(Ae)&&!ke&&(Ee=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(te))&&(ke=Z(Ee[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Ne&&!ke?ke=Xe([Ne]):Ne&&ke&&(ke=ke.replace(RegExp("^("+z(Ne)+")[-_.\\s]","i"),Ne+" ").replace(RegExp("^("+z(Ne)+")[-_.]?(\\w)","i"),Ne+" $2")),(Ee=/\bGoogle TV\b/.exec(ke))&&(ke=Ee[0]),/\bSimulator\b/i.test(te)&&(ke=(ke?ke+" ":"")+"Simulator"),Pe=="Opera Mini"&&/\bOPiOS\b/.test(te)&&fe.push("running in Turbo/Uncompressed mode"),Pe=="IE"&&/\blike iPhone OS\b/.test(te)?(Ee=Q(te.replace(/like iPhone OS/,"")),Ne=Ee.manufacturer,ke=Ee.product):/^iP/.test(ke)?(Pe||(Pe="Safari"),Ae="iOS"+((Ee=/ OS ([\d_]+)/i.exec(te))?" "+Ee[1].replace(/_/g,"."):"")):Pe=="Konqueror"&&/^Linux\b/i.test(Ae)?Ae="Kubuntu":Ne&&Ne!="Google"&&(/Chrome/.test(Pe)&&!/\bMobile Safari\b/i.test(te)||/\bVita\b/.test(ke))||/\bAndroid\b/.test(Ae)&&/^Chrome/.test(Pe)&&/\bVersion\//i.test(te)?(Pe="Android Browser",Ae=/\bAndroid\b/.test(Ae)?Ae:"Android"):Pe=="Silk"?(/\bMobi/i.test(te)||(Ae="Android",fe.unshift("desktop mode")),/Accelerated *= *true/i.test(te)&&fe.unshift("accelerated")):Pe=="UC Browser"&&/\bUCWEB\b/.test(te)?fe.push("speed mode"):Pe=="PaleMoon"&&(Ee=/\bFirefox\/([\d.]+)\b/.exec(te))?fe.push("identifying as Firefox "+Ee[1]):Pe=="Firefox"&&(Ee=/\b(Mobile|Tablet|TV)\b/i.exec(te))?(Ae||(Ae="Firefox OS"),ke||(ke=Ee[1])):!Pe||(Ee=!/\bMinefield\b/i.test(te)&&/\b(?:Firefox|Safari)\b/.exec(Pe))?(Pe&&!ke&&/[\/,]|^[^(]+?\)/.test(te.slice(te.indexOf(Ee+"/")+8))&&(Pe=null),(Ee=ke||Ne||Ae)&&(ke||Ne||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Ae))&&(Pe=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Ae)?Ae:Ee)+" Browser")):Pe=="Electron"&&(Ee=(/\bChrome\/([\d.]+)\b/.exec(te)||0)[1])&&fe.push("Chromium "+Ee),be||(be=$e(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",z(Pe),"(?:Firefox|Minefield|NetFront)"])),(Ee=Ve=="iCab"&&parseFloat(be)>3&&"WebKit"||/\bOpera\b/.test(Pe)&&(/\bOPR\b/.test(te)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(te)&&!/^(?:Trident|EdgeHTML)$/.test(Ve)&&"WebKit"||!Ve&&/\bMSIE\b/i.test(te)&&(Ae=="Mac OS"?"Tasman":"Trident")||Ve=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Pe)&&"NetFront")&&(Ve=[Ee]),Pe=="IE"&&(Ee=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(te)||0)[1])?(Pe+=" Mobile",Ae="Windows Phone "+(/\+$/.test(Ee)?Ee:Ee+".x"),fe.unshift("desktop mode")):/\bWPDesktop\b/i.test(te)?(Pe="IE Mobile",Ae="Windows Phone 8.x",fe.unshift("desktop mode"),be||(be=(/\brv:([\d.]+)/.exec(te)||0)[1])):Pe!="IE"&&Ve=="Trident"&&(Ee=/\brv:([\d.]+)/.exec(te))&&(Pe&&fe.push("identifying as "+Pe+(be?" "+be:"")),Pe="IE",be=Ee[1]),Se){if(Y(re,"global"))if(oe&&(Ee=oe.lang.System,De=Ee.getProperty("os.arch"),Ae=Ae||Ee.getProperty("os.name")+" "+Ee.getProperty("os.version")),de){try{be=re.require("ringo/engine").version.join("."),Pe="RingoJS"}catch(gt){(Ee=re.system)&&Ee.global.system==re.system&&(Pe="Narwhal",Ae||(Ae=Ee[0].os||null))}Pe||(Pe="Rhino")}else typeof re.process=="object"&&!re.process.browser&&(Ee=re.process)&&(typeof Ee.versions=="object"&&(typeof Ee.versions.electron=="string"?(fe.push("Node "+Ee.versions.node),Pe="Electron",be=Ee.versions.electron):typeof Ee.versions.nw=="string"&&(fe.push("Chromium "+be,"Node "+Ee.versions.node),Pe="NW.js",be=Ee.versions.nw)),Pe||(Pe="Node.js",De=Ee.arch,Ae=Ee.platform,be=/[\d.]+/.exec(Ee.version),be=be?be[0]:null));else X(Ee=re.runtime)==ue?(Pe="Adobe AIR",Ae=Ee.flash.system.Capabilities.os):X(Ee=re.phantom)==_e?(Pe="PhantomJS",be=(Ee=Ee.version||null)&&Ee.major+"."+Ee.minor+"."+Ee.patch):typeof ge.documentMode=="number"&&(Ee=/\bTrident\/(\d+)/i.exec(te))?(be=[be,ge.documentMode],(Ee=+Ee[1]+4)!=be[1]&&(fe.push("IE "+be[1]+" mode"),Ve&&(Ve[1]=""),be[1]=Ee),be=Pe=="IE"?String(be[1].toFixed(1)):be[0]):typeof ge.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Pe)&&(fe.push("masking as "+Pe+" "+be),Pe="IE",be="11.0",Ve=["Trident"],Ae="Windows");Ae=Ae&&H(Ae)}if(be&&(Ee=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(be)||/(?:alpha|beta)(?: ?\d)?/i.exec(te+";"+(Se&&ne.appMinorVersion))||/\bMinefield\b/i.test(te)&&"a")&&(Ce=/b/i.test(Ee)?"beta":"alpha",be=be.replace(RegExp(Ee+"\\+?$"),"")+(Ce=="beta"?ye:me)+(/\d+\+?/.exec(Ee)||"")),Pe=="Fennec"||Pe=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Ae))Pe="Firefox Mobile";else if(Pe=="Maxthon"&&be)be=be.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(ke))ke=="Xbox 360"&&(Ae=null),ke=="Xbox 360"&&/\bIEMobile\b/.test(te)&&fe.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(Pe)||Pe&&!ke&&!/Browser|Mobi/.test(Pe))&&(Ae=="Windows CE"||/Mobi/i.test(te)))Pe+=" Mobile";else if(Pe=="IE"&&Se)try{re.external===null&&fe.unshift("platform preview")}catch(gt){fe.unshift("embedded")}else(/\bBlackBerry\b/.test(ke)||/\bBB10\b/.test(te))&&(Ee=(RegExp(ke.replace(/ +/g," *")+"/([.\\d]+)","i").exec(te)||0)[1]||be)?(Ee=[Ee,/BB10/.test(te)],Ae=(Ee[1]?(ke=null,Ne="BlackBerry"):"Device Software")+" "+Ee[0],be=null):this!=U&&ke!="Wii"&&(Se&&we||/Opera/.test(Pe)&&/\b(?:MSIE|Firefox)\b/i.test(te)||Pe=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Ae)||Pe=="IE"&&(Ae&&!/^Win/.test(Ae)&&be>5.5||/\bWindows XP\b/.test(Ae)&&be>8||be==8&&!/\bTrident\b/.test(te)))&&!M.test(Ee=Q.call(U,te.replace(M,"")+";"))&&Ee.name&&(Ee="ing as "+Ee.name+((Ee=Ee.version)?" "+Ee:""),M.test(Pe)?(/\bIE\b/.test(Ee)&&Ae=="Mac OS"&&(Ae=null),Ee="identify"+Ee):(Ee="mask"+Ee,Te?Pe=H(Te.replace(/([a-z])([A-Z])/g,"$1 $2")):Pe="Opera",/\bIE\b/.test(Ee)&&(Ae=null),Se||(be=null)),Ve=["Presto"],fe.push(Ee));(Ee=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(te)||0)[1])&&(Ee=[parseFloat(Ee.replace(/\.(\d)$/,".0$1")),Ee],Pe=="Safari"&&Ee[1].slice(-1)=="+"?(Pe="WebKit Nightly",Ce="alpha",be=Ee[1].slice(0,-1)):(be==Ee[1]||be==(Ee[2]=(/\bSafari\/([\d.]+\+?)/i.exec(te)||0)[1]))&&(be=null),Ee[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(te)||0)[1],Ee[0]==537.36&&Ee[2]==537.36&&parseFloat(Ee[1])>=28&&Ve=="WebKit"&&(Ve=["Blink"]),!Se||!pe&&!Ee[1]?(Ve&&(Ve[1]="like Safari"),Ee=(Ee=Ee[0],Ee<400?1:Ee<500?2:Ee<526?3:Ee<533?4:Ee<534?"4+":Ee<535?5:Ee<537?6:Ee<538?7:Ee<601?8:Ee<602?9:Ee<604?10:Ee<606?11:Ee<608?12:"12")):(Ve&&(Ve[1]="like Chrome"),Ee=Ee[1]||(Ee=Ee[0],Ee<530?1:Ee<532?2:Ee<532.05?3:Ee<533?4:Ee<534.03?5:Ee<534.07?6:Ee<534.1?7:Ee<534.13?8:Ee<534.16?9:Ee<534.24?10:Ee<534.3?11:Ee<535.01?12:Ee<535.02?"13+":Ee<535.07?15:Ee<535.11?16:Ee<535.19?17:Ee<536.05?18:Ee<536.1?19:Ee<537.01?20:Ee<537.11?"21+":Ee<537.13?23:Ee<537.18?24:Ee<537.24?25:Ee<537.36?26:Ve!="Blink"?"27":"28")),Ve&&(Ve[1]+=" "+(Ee+=typeof Ee=="number"?".x":/[.+]/.test(Ee)?"":"+")),Pe=="Safari"&&(!be||parseInt(be)>45)?be=Ee:Pe=="Chrome"&&/\bHeadlessChrome/i.test(te)&&fe.unshift("headless")),Pe=="Opera"&&(Ee=/\bzbov|zvav$/.exec(Ae))?(Pe+=" ",fe.unshift("desktop mode"),Ee=="zvav"?(Pe+="Mini",be=null):Pe+="Mobile",Ae=Ae.replace(RegExp(" *"+Ee+"$"),"")):Pe=="Safari"&&/\bChrome\b/.exec(Ve&&Ve[1])?(fe.unshift("desktop mode"),Pe="Chrome Mobile",be=null,/\bOS X\b/.test(Ae)?(Ne="Apple",Ae="iOS 4.3+"):Ae=null):/\bSRWare Iron\b/.test(Pe)&&!be&&(be=$e("Chrome")),be&&be.indexOf(Ee=/[\d.]+$/.exec(Ae))==0&&te.indexOf("/"+Ee+"-")>-1&&(Ae=Z(Ae.replace(Ee,""))),Ae&&Ae.indexOf(Pe)!=-1&&!RegExp(Pe+" OS").test(Ae)&&(Ae=Ae.replace(RegExp(" *"+z(Pe)+" *"),"")),Ve&&!/\b(?:Avant|Nook)\b/.test(Pe)&&(/Browser|Lunascape|Maxthon/.test(Pe)||Pe!="Safari"&&/^iOS/.test(Ae)&&/\bSafari\b/.test(Ve[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Pe)&&Ve[1])&&(Ee=Ve[Ve.length-1])&&fe.push(Ee),fe.length&&(fe=["("+fe.join("; ")+")"]),Ne&&ke&&ke.indexOf(Ne)<0&&fe.push("on "+Ne),ke&&fe.push((/^on /.test(fe[fe.length-1])?"":"on ")+ke),Ae&&(Ee=/ ([\d.+]+)$/.exec(Ae),Re=Ee&&Ae.charAt(Ae.length-Ee[0].length-1)=="/",Ae={architecture:32,family:Ee&&!Re?Ae.replace(Ee[0],""):Ae,version:Ee?Ee[1]:null,toString:function(){var gt=this.version;return this.family+(gt&&!Re?" "+gt:"")+(this.architecture==64?" 64-bit":"")}}),(Ee=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(De))&&!/\bi686\b/i.test(De)?(Ae&&(Ae.architecture=64,Ae.family=Ae.family.replace(RegExp(" *"+Ee),"")),Pe&&(/\bWOW64\b/i.test(te)||Se&&/\w(?:86|32)$/.test(ne.cpuClass||ne.platform)&&!/\bWin64; x64\b/i.test(te))&&fe.unshift("32-bit")):Ae&&/^OS X/.test(Ae.family)&&Pe=="Chrome"&&parseFloat(be)>=39&&(Ae.architecture=64),te||(te=null);var ut={};return ut.description=te,ut.layout=Ve&&Ve[0],ut.manufacturer=Ne,ut.name=Pe,ut.prerelease=Ce,ut.product=ke,ut.ua=te,ut.version=Pe&&be,ut.os=Ae||{architecture:null,family:null,version:null,toString:function(){return"null"}},ut.parse=Q,ut.toString=ot,ut.version&&fe.unshift(be),ut.name&&fe.unshift(Pe),Ae&&Pe&&!(Ae==String(Ae).split(" ")[0]&&(Ae==Pe.split(" ")[0]||ke))&&fe.push(ke?"("+Ae+")":"on "+Ae),fe.length&&(ut.description=fe.join(" ")),ut}var ee=Q();P&&E?U(ee,function(te,re){P[re]=te}):R.platform=ee}).call(this)}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],441:[function(_,w,B){(function(A){(function(){typeof A>"u"||!A.version||A.version.indexOf("v0.")===0||A.version.indexOf("v1.")===0&&A.version.indexOf("v1.8.")!==0?w.exports={nextTick:O}:w.exports=A;function O(R,P,E,D){if(typeof R!="function")throw new TypeError('"callback" argument must be a function');var I=arguments.length,M,N;switch(I){case 0:case 1:return A.nextTick(R);case 2:return A.nextTick(function(){R.call(null,P)});case 3:return A.nextTick(function(){R.call(null,P,E)});case 4:return A.nextTick(function(){R.call(null,P,E,D)});default:for(M=new Array(I-1),N=0;N<M.length;)M[N++]=arguments[N];return A.nextTick(function(){R.apply(null,M)})}}}).call(this)}).call(this,_("_process"))},{_process:538}],442:[function(_,w,B){var A=w.exports={},O,R;function P(){throw new Error("setTimeout has not been defined")}function E(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?O=setTimeout:O=P}catch(U){O=P}try{typeof clearTimeout=="function"?R=clearTimeout:R=E}catch(U){R=E}})();function D(U){if(O===setTimeout)return setTimeout(U,0);if((O===P||!O)&&setTimeout)return O=setTimeout,setTimeout(U,0);try{return O(U,0)}catch(X){try{return O.call(null,U,0)}catch(Y){return O.call(this,U,0)}}}function I(U){if(R===clearTimeout)return clearTimeout(U);if((R===E||!R)&&clearTimeout)return R=clearTimeout,clearTimeout(U);try{return R(U)}catch(X){try{return R.call(null,U)}catch(Y){return R.call(this,U)}}}var M=[],N=!1,k,F=-1;function G(){!N||!k||(N=!1,k.length?M=k.concat(M):F=-1,M.length&&V())}function V(){if(!N){var U=D(G);N=!0;for(var X=M.length;X;){for(k=M,M=[];++F<X;)k&&k[F].run();F=-1,X=M.length}k=null,N=!1,I(U)}}A.nextTick=function(U){var X=new Array(arguments.length-1);if(arguments.length>1)for(var Y=1;Y<arguments.length;Y++)X[Y-1]=arguments[Y];M.push(new j(U,X)),M.length===1&&!N&&D(V)};function j(U,X){this.fun=U,this.array=X}j.prototype.run=function(){this.fun.apply(null,this.array)},A.title="browser",A.browser=!0,A.env={},A.argv=[],A.version="",A.versions={};function H(){}A.on=H,A.addListener=H,A.once=H,A.off=H,A.removeListener=H,A.removeAllListeners=H,A.emit=H,A.prependListener=H,A.prependOnceListener=H,A.listeners=function(U){return[]},A.binding=function(U){throw new Error("process.binding is not supported")},A.cwd=function(){return"/"},A.chdir=function(U){throw new Error("process.chdir is not supported")},A.umask=function(){return 0}},{}],443:[function(_,w,B){(function(A){(function(){(function(O){var R=typeof B=="object"&&B&&!B.nodeType&&B,P=typeof w=="object"&&w&&!w.nodeType&&w,E=typeof A=="object"&&A;(E.global===E||E.window===E||E.self===E)&&(O=E);var D,I=2147483647,M=36,N=1,k=26,F=38,G=700,V=72,j=128,H="-",U=/^xn--/,X=/[^\x20-\x7E]/,Y=/[\x2E\u3002\uFF0E\uFF61]/g,z={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},W=M-N,Z=Math.floor,Q=String.fromCharCode,ee;function te(de){throw new RangeError(z[de])}function re(de,me){for(var ye=de.length,ge=[];ye--;)ge[ye]=me(de[ye]);return ge}function ie(de,me){var ye=de.split("@"),ge="";ye.length>1&&(ge=ye[0]+"@",de=ye[1]),de=de.replace(Y,".");var we=de.split("."),Te=re(we,me).join(".");return ge+Te}function ne(de){for(var me=[],ye=0,ge=de.length,we,Te;ye<ge;)we=de.charCodeAt(ye++),we>=55296&&we<=56319&&ye<ge?(Te=de.charCodeAt(ye++),(Te&64512)==56320?me.push(((we&1023)<<10)+(Te&1023)+65536):(me.push(we),ye--)):me.push(we);return me}function he(de){return re(de,function(me){var ye="";return me>65535&&(me-=65536,ye+=Q(me>>>10&1023|55296),me=56320|me&1023),ye+=Q(me),ye}).join("")}function pe(de){return de-48<10?de-22:de-65<26?de-65:de-97<26?de-97:M}function K(de,me){return de+22+75*(de<26)-((me!=0)<<5)}function ue(de,me,ye){var ge=0;for(de=ye?Z(de/G):de>>1,de+=Z(de/me);de>W*k>>1;ge+=M)de=Z(de/W);return Z(ge+(W+1)*de/(de+F))}function le(de){var me=[],ye=de.length,ge,we=0,Te=j,Ee=V,De,fe,Ce,Se,be,Re,Ve,Pe,ke;for(De=de.lastIndexOf(H),De<0&&(De=0),fe=0;fe<De;++fe)de.charCodeAt(fe)>=128&&te("not-basic"),me.push(de.charCodeAt(fe));for(Ce=De>0?De+1:0;Ce<ye;){for(Se=we,be=1,Re=M;Ce>=ye&&te("invalid-input"),Ve=pe(de.charCodeAt(Ce++)),(Ve>=M||Ve>Z((I-we)/be))&&te("overflow"),we+=Ve*be,Pe=Re<=Ee?N:Re>=Ee+k?k:Re-Ee,!(Ve<Pe);Re+=M)ke=M-Pe,be>Z(I/ke)&&te("overflow"),be*=ke;ge=me.length+1,Ee=ue(we-Se,ge,Se==0),Z(we/ge)>I-Te&&te("overflow"),Te+=Z(we/ge),we%=ge,me.splice(we++,0,Te)}return he(me)}function ce(de){var me,ye,ge,we,Te,Ee,De,fe,Ce,Se,be,Re=[],Ve,Pe,ke,Ne;for(de=ne(de),Ve=de.length,me=j,ye=0,Te=V,Ee=0;Ee<Ve;++Ee)be=de[Ee],be<128&&Re.push(Q(be));for(ge=we=Re.length,we&&Re.push(H);ge<Ve;){for(De=I,Ee=0;Ee<Ve;++Ee)be=de[Ee],be>=me&&be<De&&(De=be);for(Pe=ge+1,De-me>Z((I-ye)/Pe)&&te("overflow"),ye+=(De-me)*Pe,me=De,Ee=0;Ee<Ve;++Ee)if(be=de[Ee],be<me&&++ye>I&&te("overflow"),be==me){for(fe=ye,Ce=M;Se=Ce<=Te?N:Ce>=Te+k?k:Ce-Te,!(fe<Se);Ce+=M)Ne=fe-Se,ke=M-Se,Re.push(Q(K(Se+Ne%ke,0))),fe=Z(Ne/ke);Re.push(Q(K(fe,0))),Te=ue(ye,Pe,ge==we),ye=0,++ge}++ye,++me}return Re.join("")}function _e(de){return ie(de,function(me){return U.test(me)?le(me.slice(4).toLowerCase()):me})}function oe(de){return ie(de,function(me){return X.test(me)?"xn--"+ce(me):me})}if(D={version:"1.4.1",ucs2:{decode:ne,encode:he},decode:le,encode:ce,toASCII:oe,toUnicode:_e},R&&P)if(w.exports==R)P.exports=D;else for(ee in D)D.hasOwnProperty(ee)&&(R[ee]=D[ee]);else O.punycode=D})(this)}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(_,w,B){var A=String.prototype.replace,O=/%20/g,R={RFC1738:"RFC1738",RFC3986:"RFC3986"};w.exports={default:R.RFC3986,formatters:{RFC1738:function(P){return A.call(P,O,"+")},RFC3986:function(P){return String(P)}},RFC1738:R.RFC1738,RFC3986:R.RFC3986}},{}],445:[function(_,w,B){var A=_("./stringify"),O=_("./parse"),R=_("./formats");w.exports={formats:R,parse:O,stringify:A}},{"./formats":444,"./parse":446,"./stringify":447}],446:[function(_,w,B){var A=_("./utils"),O=Object.prototype.hasOwnProperty,R=Array.isArray,P={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:A.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},E=function(V){return V.replace(/&#(\d+);/g,function(j,H){return String.fromCharCode(parseInt(H,10))})},D=function(V,j){return V&&typeof V=="string"&&j.comma&&V.indexOf(",")>-1?V.split(","):V},I="utf8=%26%2310003%3B",M="utf8=%E2%9C%93",N=function(j,H){var U={__proto__:null},X=H.ignoreQueryPrefix?j.replace(/^\?/,""):j,Y=H.parameterLimit===1/0?void 0:H.parameterLimit,z=X.split(H.delimiter,Y),W=-1,Z,Q=H.charset;if(H.charsetSentinel)for(Z=0;Z<z.length;++Z)z[Z].indexOf("utf8=")===0&&(z[Z]===M?Q="utf-8":z[Z]===I&&(Q="iso-8859-1"),W=Z,Z=z.length);for(Z=0;Z<z.length;++Z)if(Z!==W){var ee=z[Z],te=ee.indexOf("]="),re=te===-1?ee.indexOf("="):te+1,ie,ne;re===-1?(ie=H.decoder(ee,P.decoder,Q,"key"),ne=H.strictNullHandling?null:""):(ie=H.decoder(ee.slice(0,re),P.decoder,Q,"key"),ne=A.maybeMap(D(ee.slice(re+1),H),function(he){return H.decoder(he,P.decoder,Q,"value")})),ne&&H.interpretNumericEntities&&Q==="iso-8859-1"&&(ne=E(ne)),ee.indexOf("[]=")>-1&&(ne=R(ne)?[ne]:ne),O.call(U,ie)?U[ie]=A.combine(U[ie],ne):U[ie]=ne}return U},k=function(V,j,H,U){for(var X=U?j:D(j,H),Y=V.length-1;Y>=0;--Y){var z,W=V[Y];if(W==="[]"&&H.parseArrays)z=[].concat(X);else{z=H.plainObjects?Object.create(null):{};var Z=W.charAt(0)==="["&&W.charAt(W.length-1)==="]"?W.slice(1,-1):W,Q=parseInt(Z,10);!H.parseArrays&&Z===""?z={0:X}:!isNaN(Q)&&W!==Z&&String(Q)===Z&&Q>=0&&H.parseArrays&&Q<=H.arrayLimit?(z=[],z[Q]=X):Z!=="__proto__"&&(z[Z]=X)}X=z}return X},F=function(j,H,U,X){if(j){var Y=U.allowDots?j.replace(/\.([^.[]+)/g,"[$1]"):j,z=/(\[[^[\]]*])/,W=/(\[[^[\]]*])/g,Z=U.depth>0&&z.exec(Y),Q=Z?Y.slice(0,Z.index):Y,ee=[];if(Q){if(!U.plainObjects&&O.call(Object.prototype,Q)&&!U.allowPrototypes)return;ee.push(Q)}for(var te=0;U.depth>0&&(Z=W.exec(Y))!==null&&te<U.depth;){if(te+=1,!U.plainObjects&&O.call(Object.prototype,Z[1].slice(1,-1))&&!U.allowPrototypes)return;ee.push(Z[1])}return Z&&ee.push("["+Y.slice(Z.index)+"]"),k(ee,H,U,X)}},G=function(j){if(!j)return P;if(j.decoder!==null&&j.decoder!==void 0&&typeof j.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof j.charset<"u"&&j.charset!=="utf-8"&&j.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var H=typeof j.charset>"u"?P.charset:j.charset;return{allowDots:typeof j.allowDots>"u"?P.allowDots:!!j.allowDots,allowPrototypes:typeof j.allowPrototypes=="boolean"?j.allowPrototypes:P.allowPrototypes,allowSparse:typeof j.allowSparse=="boolean"?j.allowSparse:P.allowSparse,arrayLimit:typeof j.arrayLimit=="number"?j.arrayLimit:P.arrayLimit,charset:H,charsetSentinel:typeof j.charsetSentinel=="boolean"?j.charsetSentinel:P.charsetSentinel,comma:typeof j.comma=="boolean"?j.comma:P.comma,decoder:typeof j.decoder=="function"?j.decoder:P.decoder,delimiter:typeof j.delimiter=="string"||A.isRegExp(j.delimiter)?j.delimiter:P.delimiter,depth:typeof j.depth=="number"||j.depth===!1?+j.depth:P.depth,ignoreQueryPrefix:j.ignoreQueryPrefix===!0,interpretNumericEntities:typeof j.interpretNumericEntities=="boolean"?j.interpretNumericEntities:P.interpretNumericEntities,parameterLimit:typeof j.parameterLimit=="number"?j.parameterLimit:P.parameterLimit,parseArrays:j.parseArrays!==!1,plainObjects:typeof j.plainObjects=="boolean"?j.plainObjects:P.plainObjects,strictNullHandling:typeof j.strictNullHandling=="boolean"?j.strictNullHandling:P.strictNullHandling}};w.exports=function(V,j){var H=G(j);if(V===""||V===null||typeof V>"u")return H.plainObjects?Object.create(null):{};for(var U=typeof V=="string"?N(V,H):V,X=H.plainObjects?Object.create(null):{},Y=Object.keys(U),z=0;z<Y.length;++z){var W=Y[z],Z=F(W,U[W],H,typeof V=="string");X=A.merge(X,Z,H)}return H.allowSparse===!0?X:A.compact(X)}},{"./utils":448}],447:[function(_,w,B){var A=_("side-channel"),O=_("./utils"),R=_("./formats"),P=Object.prototype.hasOwnProperty,E={brackets:function(X){return X+"[]"},comma:"comma",indices:function(X,Y){return X+"["+Y+"]"},repeat:function(X){return X}},D=Array.isArray,I=Array.prototype.push,M=function(U,X){I.apply(U,D(X)?X:[X])},N=Date.prototype.toISOString,k=R.default,F={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:O.encode,encodeValuesOnly:!1,format:k,formatter:R.formatters[k],indices:!1,serializeDate:function(X){return N.call(X)},skipNulls:!1,strictNullHandling:!1},G=function(X){return typeof X=="string"||typeof X=="number"||typeof X=="boolean"||typeof X=="symbol"||typeof X=="bigint"},V={},j=function U(X,Y,z,W,Z,Q,ee,te,re,ie,ne,he,pe,K,ue,le){for(var ce=X,_e=le,oe=0,de=!1;(_e=_e.get(V))!==void 0&&!de;){var me=_e.get(X);if(oe+=1,typeof me<"u"){if(me===oe)throw new RangeError("Cyclic object value");de=!0}typeof _e.get(V)>"u"&&(oe=0)}if(typeof te=="function"?ce=te(Y,ce):ce instanceof Date?ce=ne(ce):z==="comma"&&D(ce)&&(ce=O.maybeMap(ce,function(Re){return Re instanceof Date?ne(Re):Re})),ce===null){if(Z)return ee&&!K?ee(Y,F.encoder,ue,"key",he):Y;ce=""}if(G(ce)||O.isBuffer(ce)){if(ee){var ye=K?Y:ee(Y,F.encoder,ue,"key",he);return[pe(ye)+"="+pe(ee(ce,F.encoder,ue,"value",he))]}return[pe(Y)+"="+pe(String(ce))]}var ge=[];if(typeof ce>"u")return ge;var we;if(z==="comma"&&D(ce))K&&ee&&(ce=O.maybeMap(ce,ee)),we=[{value:ce.length>0?ce.join(",")||null:void 0}];else if(D(te))we=te;else{var Te=Object.keys(ce);we=re?Te.sort(re):Te}for(var Ee=W&&D(ce)&&ce.length===1?Y+"[]":Y,De=0;De<we.length;++De){var fe=we[De],Ce=typeof fe=="object"&&typeof fe.value<"u"?fe.value:ce[fe];if(!(Q&&Ce===null)){var Se=D(ce)?typeof z=="function"?z(Ee,fe):Ee:Ee+(ie?"."+fe:"["+fe+"]");le.set(X,oe);var be=A();be.set(V,le),M(ge,U(Ce,Se,z,W,Z,Q,z==="comma"&&K&&D(ce)?null:ee,te,re,ie,ne,he,pe,K,ue,be))}}return ge},H=function(X){if(!X)return F;if(X.encoder!==null&&typeof X.encoder<"u"&&typeof X.encoder!="function")throw new TypeError("Encoder has to be a function.");var Y=X.charset||F.charset;if(typeof X.charset<"u"&&X.charset!=="utf-8"&&X.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var z=R.default;if(typeof X.format<"u"){if(!P.call(R.formatters,X.format))throw new TypeError("Unknown format option provided.");z=X.format}var W=R.formatters[z],Z=F.filter;return(typeof X.filter=="function"||D(X.filter))&&(Z=X.filter),{addQueryPrefix:typeof X.addQueryPrefix=="boolean"?X.addQueryPrefix:F.addQueryPrefix,allowDots:typeof X.allowDots>"u"?F.allowDots:!!X.allowDots,charset:Y,charsetSentinel:typeof X.charsetSentinel=="boolean"?X.charsetSentinel:F.charsetSentinel,delimiter:typeof X.delimiter>"u"?F.delimiter:X.delimiter,encode:typeof X.encode=="boolean"?X.encode:F.encode,encoder:typeof X.encoder=="function"?X.encoder:F.encoder,encodeValuesOnly:typeof X.encodeValuesOnly=="boolean"?X.encodeValuesOnly:F.encodeValuesOnly,filter:Z,format:z,formatter:W,serializeDate:typeof X.serializeDate=="function"?X.serializeDate:F.serializeDate,skipNulls:typeof X.skipNulls=="boolean"?X.skipNulls:F.skipNulls,sort:typeof X.sort=="function"?X.sort:null,strictNullHandling:typeof X.strictNullHandling=="boolean"?X.strictNullHandling:F.strictNullHandling}};w.exports=function(U,X){var Y=U,z=H(X),W,Z;typeof z.filter=="function"?(Z=z.filter,Y=Z("",Y)):D(z.filter)&&(Z=z.filter,W=Z);var Q=[];if(typeof Y!="object"||Y===null)return"";var ee;X&&X.arrayFormat in E?ee=X.arrayFormat:X&&"indices"in X?ee=X.indices?"indices":"repeat":ee="indices";var te=E[ee];if(X&&"commaRoundTrip"in X&&typeof X.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var re=te==="comma"&&X&&X.commaRoundTrip;W||(W=Object.keys(Y)),z.sort&&W.sort(z.sort);for(var ie=A(),ne=0;ne<W.length;++ne){var he=W[ne];z.skipNulls&&Y[he]===null||M(Q,j(Y[he],he,te,re,z.strictNullHandling,z.skipNulls,z.encode?z.encoder:null,z.filter,z.sort,z.allowDots,z.serializeDate,z.format,z.formatter,z.encodeValuesOnly,z.charset,ie))}var pe=Q.join(z.delimiter),K=z.addQueryPrefix===!0?"?":"";return z.charsetSentinel&&(z.charset==="iso-8859-1"?K+="utf8=%26%2310003%3B&":K+="utf8=%E2%9C%93&"),pe.length>0?K+pe:""}},{"./formats":444,"./utils":448,"side-channel":467}],448:[function(_,w,B){var A=_("./formats"),O=Object.prototype.hasOwnProperty,R=Array.isArray,P=function(){for(var U=[],X=0;X<256;++X)U.push("%"+((X<16?"0":"")+X.toString(16)).toUpperCase());return U}(),E=function(X){for(;X.length>1;){var Y=X.pop(),z=Y.obj[Y.prop];if(R(z)){for(var W=[],Z=0;Z<z.length;++Z)typeof z[Z]<"u"&&W.push(z[Z]);Y.obj[Y.prop]=W}}},D=function(X,Y){for(var z=Y&&Y.plainObjects?Object.create(null):{},W=0;W<X.length;++W)typeof X[W]<"u"&&(z[W]=X[W]);return z},I=function U(X,Y,z){if(!Y)return X;if(typeof Y!="object"){if(R(X))X.push(Y);else if(X&&typeof X=="object")(z&&(z.plainObjects||z.allowPrototypes)||!O.call(Object.prototype,Y))&&(X[Y]=!0);else return[X,Y];return X}if(!X||typeof X!="object")return[X].concat(Y);var W=X;return R(X)&&!R(Y)&&(W=D(X,z)),R(X)&&R(Y)?(Y.forEach(function(Z,Q){if(O.call(X,Q)){var ee=X[Q];ee&&typeof ee=="object"&&Z&&typeof Z=="object"?X[Q]=U(ee,Z,z):X.push(Z)}else X[Q]=Z}),X):Object.keys(Y).reduce(function(Z,Q){var ee=Y[Q];return O.call(Z,Q)?Z[Q]=U(Z[Q],ee,z):Z[Q]=ee,Z},W)},M=function(X,Y){return Object.keys(Y).reduce(function(z,W){return z[W]=Y[W],z},X)},N=function(U,X,Y){var z=U.replace(/\+/g," ");if(Y==="iso-8859-1")return z.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(z)}catch(W){return z}},k=function(X,Y,z,W,Z){if(X.length===0)return X;var Q=X;if(typeof X=="symbol"?Q=Symbol.prototype.toString.call(X):typeof X!="string"&&(Q=String(X)),z==="iso-8859-1")return escape(Q).replace(/%u[0-9a-f]{4}/gi,function(ie){return"%26%23"+parseInt(ie.slice(2),16)+"%3B"});for(var ee="",te=0;te<Q.length;++te){var re=Q.charCodeAt(te);if(re===45||re===46||re===95||re===126||re>=48&&re<=57||re>=65&&re<=90||re>=97&&re<=122||Z===A.RFC1738&&(re===40||re===41)){ee+=Q.charAt(te);continue}if(re<128){ee=ee+P[re];continue}if(re<2048){ee=ee+(P[192|re>>6]+P[128|re&63]);continue}if(re<55296||re>=57344){ee=ee+(P[224|re>>12]+P[128|re>>6&63]+P[128|re&63]);continue}te+=1,re=65536+((re&1023)<<10|Q.charCodeAt(te)&1023),ee+=P[240|re>>18]+P[128|re>>12&63]+P[128|re>>6&63]+P[128|re&63]}return ee},F=function(X){for(var Y=[{obj:{o:X},prop:"o"}],z=[],W=0;W<Y.length;++W)for(var Z=Y[W],Q=Z.obj[Z.prop],ee=Object.keys(Q),te=0;te<ee.length;++te){var re=ee[te],ie=Q[re];typeof ie=="object"&&ie!==null&&z.indexOf(ie)===-1&&(Y.push({obj:Q,prop:re}),z.push(ie))}return E(Y),X},G=function(X){return Object.prototype.toString.call(X)==="[object RegExp]"},V=function(X){return!X||typeof X!="object"?!1:!!(X.constructor&&X.constructor.isBuffer&&X.constructor.isBuffer(X))},j=function(X,Y){return[].concat(X,Y)},H=function(X,Y){if(R(X)){for(var z=[],W=0;W<X.length;W+=1)z.push(Y(X[W]));return z}return Y(X)};w.exports={arrayToObject:D,assign:M,combine:j,compact:F,decode:N,encode:k,isBuffer:V,isRegExp:G,maybeMap:H,merge:I}},{"./formats":444}],449:[function(_,w,B){function A(R,P){return Object.prototype.hasOwnProperty.call(R,P)}w.exports=function(R,P,E,D){P=P||"&",E=E||"=";var I={};if(typeof R!="string"||R.length===0)return I;var M=/\+/g;R=R.split(P);var N=1e3;D&&typeof D.maxKeys=="number"&&(N=D.maxKeys);var k=R.length;N>0&&k>N&&(k=N);for(var F=0;F<k;++F){var G=R[F].replace(M,"%20"),V=G.indexOf(E),j,H,U,X;V>=0?(j=G.substr(0,V),H=G.substr(V+1)):(j=G,H=""),U=decodeURIComponent(j),X=decodeURIComponent(H),A(I,U)?O(I[U])?I[U].push(X):I[U]=[I[U],X]:I[U]=X}return I};var O=Array.isArray||function(R){return Object.prototype.toString.call(R)==="[object Array]"}},{}],450:[function(_,w,B){var A=function(E){switch(typeof E){case"string":return E;case"boolean":return E?"true":"false";case"number":return isFinite(E)?E:"";default:return""}};w.exports=function(E,D,I,M){return D=D||"&",I=I||"=",E===null&&(E=void 0),typeof E=="object"?R(P(E),function(N){var k=encodeURIComponent(A(N))+I;return O(E[N])?R(E[N],function(F){return k+encodeURIComponent(A(F))}).join(D):k+encodeURIComponent(A(E[N]))}).join(D):M?encodeURIComponent(A(M))+I+encodeURIComponent(A(E)):""};var O=Array.isArray||function(E){return Object.prototype.toString.call(E)==="[object Array]"};function R(E,D){if(E.map)return E.map(D);for(var I=[],M=0;M<E.length;M++)I.push(D(E[M],M));return I}var P=Object.keys||function(E){var D=[];for(var I in E)Object.prototype.hasOwnProperty.call(E,I)&&D.push(I);return D}},{}],451:[function(_,w,B){B.decode=B.parse=_("./decode"),B.encode=B.stringify=_("./encode")},{"./decode":449,"./encode":450}],452:[function(_,w,B){var A=_("process-nextick-args"),O=Object.keys||function(G){var V=[];for(var j in G)V.push(j);return V};w.exports=N;var R=Object.create(_("core-util-is"));R.inherits=_("inherits");var P=_("./_stream_readable"),E=_("./_stream_writable");R.inherits(N,P);for(var D=O(E.prototype),I=0;I<D.length;I++){var M=D[I];N.prototype[M]||(N.prototype[M]=E.prototype[M])}function N(G){if(!(this instanceof N))return new N(G);P.call(this,G),E.call(this,G),G&&G.readable===!1&&(this.readable=!1),G&&G.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,G&&G.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",k)}Object.defineProperty(N.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function k(){this.allowHalfOpen||this._writableState.ended||A.nextTick(F,this)}function F(G){G.end()}Object.defineProperty(N.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(G){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=G,this._writableState.destroyed=G)}}),N.prototype._destroy=function(G,V){this.push(null),this.end(),A.nextTick(V,G)}},{"./_stream_readable":454,"./_stream_writable":456,"core-util-is":382,inherits:407,"process-nextick-args":441}],453:[function(_,w,B){w.exports=R;var A=_("./_stream_transform"),O=Object.create(_("core-util-is"));O.inherits=_("inherits"),O.inherits(R,A);function R(P){if(!(this instanceof R))return new R(P);A.call(this,P)}R.prototype._transform=function(P,E,D){D(null,P)}},{"./_stream_transform":455,"core-util-is":382,inherits:407}],454:[function(_,w,B){(function(A,O){(function(){var R=_("process-nextick-args");w.exports=Z;var P=_("isarray"),E;Z.ReadableState=W,_("events").EventEmitter;var D=function(Se,be){return Se.listeners(be).length},I=_("./internal/streams/stream"),M=_("safe-buffer").Buffer,N=(typeof O<"u"?O:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function k(Se){return M.from(Se)}function F(Se){return M.isBuffer(Se)||Se instanceof N}var G=Object.create(_("core-util-is"));G.inherits=_("inherits");var V=_("util"),j=void 0;V&&V.debuglog?j=V.debuglog("stream"):j=function(){};var H=_("./internal/streams/BufferList"),U=_("./internal/streams/destroy"),X;G.inherits(Z,I);var Y=["error","close","destroy","pause","resume"];function z(Se,be,Re){if(typeof Se.prependListener=="function")return Se.prependListener(be,Re);!Se._events||!Se._events[be]?Se.on(be,Re):P(Se._events[be])?Se._events[be].unshift(Re):Se._events[be]=[Re,Se._events[be]]}function W(Se,be){E=E||_("./_stream_duplex"),Se=Se||{};var Re=be instanceof E;this.objectMode=!!Se.objectMode,Re&&(this.objectMode=this.objectMode||!!Se.readableObjectMode);var Ve=Se.highWaterMark,Pe=Se.readableHighWaterMark,ke=this.objectMode?16:16*1024;Ve||Ve===0?this.highWaterMark=Ve:Re&&(Pe||Pe===0)?this.highWaterMark=Pe:this.highWaterMark=ke,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new H,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=Se.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Se.encoding&&(X||(X=_("string_decoder/").StringDecoder),this.decoder=new X(Se.encoding),this.encoding=Se.encoding)}function Z(Se){if(E=E||_("./_stream_duplex"),!(this instanceof Z))return new Z(Se);this._readableState=new W(Se,this),this.readable=!0,Se&&(typeof Se.read=="function"&&(this._read=Se.read),typeof Se.destroy=="function"&&(this._destroy=Se.destroy)),I.call(this)}Object.defineProperty(Z.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Se){this._readableState&&(this._readableState.destroyed=Se)}}),Z.prototype.destroy=U.destroy,Z.prototype._undestroy=U.undestroy,Z.prototype._destroy=function(Se,be){this.push(null),be(Se)},Z.prototype.push=function(Se,be){var Re=this._readableState,Ve;return Re.objectMode?Ve=!0:typeof Se=="string"&&(be=be||Re.defaultEncoding,be!==Re.encoding&&(Se=M.from(Se,be),be=""),Ve=!0),Q(this,Se,be,!1,Ve)},Z.prototype.unshift=function(Se){return Q(this,Se,null,!0,!1)};function Q(Se,be,Re,Ve,Pe){var ke=Se._readableState;if(be===null)ke.reading=!1,pe(Se,ke);else{var Ne;Pe||(Ne=te(ke,be)),Ne?Se.emit("error",Ne):ke.objectMode||be&&be.length>0?(typeof be!="string"&&!ke.objectMode&&Object.getPrototypeOf(be)!==M.prototype&&(be=k(be)),Ve?ke.endEmitted?Se.emit("error",new Error("stream.unshift() after end event")):ee(Se,ke,be,!0):ke.ended?Se.emit("error",new Error("stream.push() after EOF")):(ke.reading=!1,ke.decoder&&!Re?(be=ke.decoder.write(be),ke.objectMode||be.length!==0?ee(Se,ke,be,!1):le(Se,ke)):ee(Se,ke,be,!1))):Ve||(ke.reading=!1)}return re(ke)}function ee(Se,be,Re,Ve){be.flowing&&be.length===0&&!be.sync?(Se.emit("data",Re),Se.read(0)):(be.length+=be.objectMode?1:Re.length,Ve?be.buffer.unshift(Re):be.buffer.push(Re),be.needReadable&&K(Se)),le(Se,be)}function te(Se,be){var Re;return!F(be)&&typeof be!="string"&&be!==void 0&&!Se.objectMode&&(Re=new TypeError("Invalid non-string/buffer chunk")),Re}function re(Se){return!Se.ended&&(Se.needReadable||Se.length<Se.highWaterMark||Se.length===0)}Z.prototype.isPaused=function(){return this._readableState.flowing===!1},Z.prototype.setEncoding=function(Se){return X||(X=_("string_decoder/").StringDecoder),this._readableState.decoder=new X(Se),this._readableState.encoding=Se,this};var ie=8388608;function ne(Se){return Se>=ie?Se=ie:(Se--,Se|=Se>>>1,Se|=Se>>>2,Se|=Se>>>4,Se|=Se>>>8,Se|=Se>>>16,Se++),Se}function he(Se,be){return Se<=0||be.length===0&&be.ended?0:be.objectMode?1:Se!==Se?be.flowing&&be.length?be.buffer.head.data.length:be.length:(Se>be.highWaterMark&&(be.highWaterMark=ne(Se)),Se<=be.length?Se:be.ended?be.length:(be.needReadable=!0,0))}Z.prototype.read=function(Se){j("read",Se),Se=parseInt(Se,10);var be=this._readableState,Re=Se;if(Se!==0&&(be.emittedReadable=!1),Se===0&&be.needReadable&&(be.length>=be.highWaterMark||be.ended))return j("read: emitReadable",be.length,be.ended),be.length===0&&be.ended?De(this):K(this),null;if(Se=he(Se,be),Se===0&&be.ended)return be.length===0&&De(this),null;var Ve=be.needReadable;j("need readable",Ve),(be.length===0||be.length-Se<be.highWaterMark)&&(Ve=!0,j("length less than watermark",Ve)),be.ended||be.reading?(Ve=!1,j("reading or ended",Ve)):Ve&&(j("do read"),be.reading=!0,be.sync=!0,be.length===0&&(be.needReadable=!0),this._read(be.highWaterMark),be.sync=!1,be.reading||(Se=he(Re,be)));var Pe;return Se>0?Pe=ge(Se,be):Pe=null,Pe===null?(be.needReadable=!0,Se=0):be.length-=Se,be.length===0&&(be.ended||(be.needReadable=!0),Re!==Se&&be.ended&&De(this)),Pe!==null&&this.emit("data",Pe),Pe};function pe(Se,be){if(!be.ended){if(be.decoder){var Re=be.decoder.end();Re&&Re.length&&(be.buffer.push(Re),be.length+=be.objectMode?1:Re.length)}be.ended=!0,K(Se)}}function K(Se){var be=Se._readableState;be.needReadable=!1,be.emittedReadable||(j("emitReadable",be.flowing),be.emittedReadable=!0,be.sync?R.nextTick(ue,Se):ue(Se))}function ue(Se){j("emit readable"),Se.emit("readable"),ye(Se)}function le(Se,be){be.readingMore||(be.readingMore=!0,R.nextTick(ce,Se,be))}function ce(Se,be){for(var Re=be.length;!be.reading&&!be.flowing&&!be.ended&&be.length<be.highWaterMark&&(j("maybeReadMore read 0"),Se.read(0),Re!==be.length);)Re=be.length;be.readingMore=!1}Z.prototype._read=function(Se){this.emit("error",new Error("_read() is not implemented"))},Z.prototype.pipe=function(Se,be){var Re=this,Ve=this._readableState;switch(Ve.pipesCount){case 0:Ve.pipes=Se;break;case 1:Ve.pipes=[Ve.pipes,Se];break;default:Ve.pipes.push(Se);break}Ve.pipesCount+=1,j("pipe count=%d opts=%j",Ve.pipesCount,be);var Pe=(!be||be.end!==!1)&&Se!==A.stdout&&Se!==A.stderr,ke=Pe?Ae:gt;Ve.endEmitted?R.nextTick(ke):Re.once("end",ke),Se.on("unpipe",Ne);function Ne(Ue,We){j("onunpipe"),Ue===Re&&We&&We.hasUnpiped===!1&&(We.hasUnpiped=!0,nt())}function Ae(){j("onend"),Se.end()}var Oe=_e(Re);Se.on("drain",Oe);var Fe=!1;function nt(){j("cleanup"),Se.removeListener("close",ot),Se.removeListener("finish",ut),Se.removeListener("drain",Oe),Se.removeListener("error",$e),Se.removeListener("unpipe",Ne),Re.removeListener("end",Ae),Re.removeListener("end",gt),Re.removeListener("data",Xe),Fe=!0,Ve.awaitDrain&&(!Se._writableState||Se._writableState.needDrain)&&Oe()}var Ze=!1;Re.on("data",Xe);function Xe(Ue){j("ondata"),Ze=!1;var We=Se.write(Ue);We===!1&&!Ze&&((Ve.pipesCount===1&&Ve.pipes===Se||Ve.pipesCount>1&&Ce(Ve.pipes,Se)!==-1)&&!Fe&&(j("false write response, pause",Ve.awaitDrain),Ve.awaitDrain++,Ze=!0),Re.pause())}function $e(Ue){j("onerror",Ue),gt(),Se.removeListener("error",$e),D(Se,"error")===0&&Se.emit("error",Ue)}z(Se,"error",$e);function ot(){Se.removeListener("finish",ut),gt()}Se.once("close",ot);function ut(){j("onfinish"),Se.removeListener("close",ot),gt()}Se.once("finish",ut);function gt(){j("unpipe"),Re.unpipe(Se)}return Se.emit("pipe",Re),Ve.flowing||(j("pipe resume"),Re.resume()),Se};function _e(Se){return function(){var be=Se._readableState;j("pipeOnDrain",be.awaitDrain),be.awaitDrain&&be.awaitDrain--,be.awaitDrain===0&&D(Se,"data")&&(be.flowing=!0,ye(Se))}}Z.prototype.unpipe=function(Se){var be=this._readableState,Re={hasUnpiped:!1};if(be.pipesCount===0)return this;if(be.pipesCount===1)return Se&&Se!==be.pipes?this:(Se||(Se=be.pipes),be.pipes=null,be.pipesCount=0,be.flowing=!1,Se&&Se.emit("unpipe",this,Re),this);if(!Se){var Ve=be.pipes,Pe=be.pipesCount;be.pipes=null,be.pipesCount=0,be.flowing=!1;for(var ke=0;ke<Pe;ke++)Ve[ke].emit("unpipe",this,{hasUnpiped:!1});return this}var Ne=Ce(be.pipes,Se);return Ne===-1?this:(be.pipes.splice(Ne,1),be.pipesCount-=1,be.pipesCount===1&&(be.pipes=be.pipes[0]),Se.emit("unpipe",this,Re),this)},Z.prototype.on=function(Se,be){var Re=I.prototype.on.call(this,Se,be);if(Se==="data")this._readableState.flowing!==!1&&this.resume();else if(Se==="readable"){var Ve=this._readableState;!Ve.endEmitted&&!Ve.readableListening&&(Ve.readableListening=Ve.needReadable=!0,Ve.emittedReadable=!1,Ve.reading?Ve.length&&K(this):R.nextTick(oe,this))}return Re},Z.prototype.addListener=Z.prototype.on;function oe(Se){j("readable nexttick read 0"),Se.read(0)}Z.prototype.resume=function(){var Se=this._readableState;return Se.flowing||(j("resume"),Se.flowing=!0,de(this,Se)),this};function de(Se,be){be.resumeScheduled||(be.resumeScheduled=!0,R.nextTick(me,Se,be))}function me(Se,be){be.reading||(j("resume read 0"),Se.read(0)),be.resumeScheduled=!1,be.awaitDrain=0,Se.emit("resume"),ye(Se),be.flowing&&!be.reading&&Se.read(0)}Z.prototype.pause=function(){return j("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(j("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function ye(Se){var be=Se._readableState;for(j("flow",be.flowing);be.flowing&&Se.read()!==null;);}Z.prototype.wrap=function(Se){var be=this,Re=this._readableState,Ve=!1;Se.on("end",function(){if(j("wrapped end"),Re.decoder&&!Re.ended){var Ne=Re.decoder.end();Ne&&Ne.length&&be.push(Ne)}be.push(null)}),Se.on("data",function(Ne){if(j("wrapped data"),Re.decoder&&(Ne=Re.decoder.write(Ne)),!(Re.objectMode&&Ne==null)&&!(!Re.objectMode&&(!Ne||!Ne.length))){var Ae=be.push(Ne);Ae||(Ve=!0,Se.pause())}});for(var Pe in Se)this[Pe]===void 0&&typeof Se[Pe]=="function"&&(this[Pe]=function(Ne){return function(){return Se[Ne].apply(Se,arguments)}}(Pe));for(var ke=0;ke<Y.length;ke++)Se.on(Y[ke],this.emit.bind(this,Y[ke]));return this._read=function(Ne){j("wrapped _read",Ne),Ve&&(Ve=!1,Se.resume())},this},Object.defineProperty(Z.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Z._fromList=ge;function ge(Se,be){if(be.length===0)return null;var Re;return be.objectMode?Re=be.buffer.shift():!Se||Se>=be.length?(be.decoder?Re=be.buffer.join(""):be.buffer.length===1?Re=be.buffer.head.data:Re=be.buffer.concat(be.length),be.buffer.clear()):Re=we(Se,be.buffer,be.decoder),Re}function we(Se,be,Re){var Ve;return Se<be.head.data.length?(Ve=be.head.data.slice(0,Se),be.head.data=be.head.data.slice(Se)):Se===be.head.data.length?Ve=be.shift():Ve=Re?Te(Se,be):Ee(Se,be),Ve}function Te(Se,be){var Re=be.head,Ve=1,Pe=Re.data;for(Se-=Pe.length;Re=Re.next;){var ke=Re.data,Ne=Se>ke.length?ke.length:Se;if(Ne===ke.length?Pe+=ke:Pe+=ke.slice(0,Se),Se-=Ne,Se===0){Ne===ke.length?(++Ve,Re.next?be.head=Re.next:be.head=be.tail=null):(be.head=Re,Re.data=ke.slice(Ne));break}++Ve}return be.length-=Ve,Pe}function Ee(Se,be){var Re=M.allocUnsafe(Se),Ve=be.head,Pe=1;for(Ve.data.copy(Re),Se-=Ve.data.length;Ve=Ve.next;){var ke=Ve.data,Ne=Se>ke.length?ke.length:Se;if(ke.copy(Re,Re.length-Se,0,Ne),Se-=Ne,Se===0){Ne===ke.length?(++Pe,Ve.next?be.head=Ve.next:be.head=be.tail=null):(be.head=Ve,Ve.data=ke.slice(Ne));break}++Pe}return be.length-=Pe,Re}function De(Se){var be=Se._readableState;if(be.length>0)throw new Error('"endReadable()" called on non-empty stream');be.endEmitted||(be.ended=!0,R.nextTick(fe,be,Se))}function fe(Se,be){!Se.endEmitted&&Se.length===0&&(Se.endEmitted=!0,be.readable=!1,be.emit("end"))}function Ce(Se,be){for(var Re=0,Ve=Se.length;Re<Ve;Re++)if(Se[Re]===be)return Re;return-1}}).call(this)}).call(this,_("_process"),typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":452,"./internal/streams/BufferList":457,"./internal/streams/destroy":458,"./internal/streams/stream":459,_process:538,"core-util-is":382,events:386,inherits:407,isarray:460,"process-nextick-args":441,"safe-buffer":461,"string_decoder/":462,util:102}],455:[function(_,w,B){w.exports=P;var A=_("./_stream_duplex"),O=Object.create(_("core-util-is"));O.inherits=_("inherits"),O.inherits(P,A);function R(I,M){var N=this._transformState;N.transforming=!1;var k=N.writecb;if(!k)return this.emit("error",new Error("write callback called multiple times"));N.writechunk=null,N.writecb=null,M!=null&&this.push(M),k(I);var F=this._readableState;F.reading=!1,(F.needReadable||F.length<F.highWaterMark)&&this._read(F.highWaterMark)}function P(I){if(!(this instanceof P))return new P(I);A.call(this,I),this._transformState={afterTransform:R.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,I&&(typeof I.transform=="function"&&(this._transform=I.transform),typeof I.flush=="function"&&(this._flush=I.flush)),this.on("prefinish",E)}function E(){var I=this;typeof this._flush=="function"?this._flush(function(M,N){D(I,M,N)}):D(this,null,null)}P.prototype.push=function(I,M){return this._transformState.needTransform=!1,A.prototype.push.call(this,I,M)},P.prototype._transform=function(I,M,N){throw new Error("_transform() is not implemented")},P.prototype._write=function(I,M,N){var k=this._transformState;if(k.writecb=N,k.writechunk=I,k.writeencoding=M,!k.transforming){var F=this._readableState;(k.needTransform||F.needReadable||F.length<F.highWaterMark)&&this._read(F.highWaterMark)}},P.prototype._read=function(I){var M=this._transformState;M.writechunk!==null&&M.writecb&&!M.transforming?(M.transforming=!0,this._transform(M.writechunk,M.writeencoding,M.afterTransform)):M.needTransform=!0},P.prototype._destroy=function(I,M){var N=this;A.prototype._destroy.call(this,I,function(k){M(k),N.emit("close")})};function D(I,M,N){if(M)return I.emit("error",M);if(N!=null&&I.push(N),I._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(I._transformState.transforming)throw new Error("Calling transform done when still transforming");return I.push(null)}},{"./_stream_duplex":452,"core-util-is":382,inherits:407}],456:[function(_,w,B){(function(A,O,R){(function(){var P=_("process-nextick-args");w.exports=z;function E(me){var ye=this;this.next=null,this.entry=null,this.finish=function(){de(ye,me)}}var D=!A.browser&&["v0.10","v0.9."].indexOf(A.version.slice(0,5))>-1?R:P.nextTick,I;z.WritableState=X;var M=Object.create(_("core-util-is"));M.inherits=_("inherits");var N={deprecate:_("util-deprecate")},k=_("./internal/streams/stream"),F=_("safe-buffer").Buffer,G=(typeof O<"u"?O:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function V(me){return F.from(me)}function j(me){return F.isBuffer(me)||me instanceof G}var H=_("./internal/streams/destroy");M.inherits(z,k);function U(){}function X(me,ye){I=I||_("./_stream_duplex"),me=me||{};var ge=ye instanceof I;this.objectMode=!!me.objectMode,ge&&(this.objectMode=this.objectMode||!!me.writableObjectMode);var we=me.highWaterMark,Te=me.writableHighWaterMark,Ee=this.objectMode?16:16*1024;we||we===0?this.highWaterMark=we:ge&&(Te||Te===0)?this.highWaterMark=Te:this.highWaterMark=Ee,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var De=me.decodeStrings===!1;this.decodeStrings=!De,this.defaultEncoding=me.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(fe){ne(ye,fe)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new E(this)}X.prototype.getBuffer=function(){for(var ye=this.bufferedRequest,ge=[];ye;)ge.push(ye),ye=ye.next;return ge},function(){try{Object.defineProperty(X.prototype,"buffer",{get:N.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(me){}}();var Y;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Y=Function.prototype[Symbol.hasInstance],Object.defineProperty(z,Symbol.hasInstance,{value:function(me){return Y.call(this,me)?!0:this!==z?!1:me&&me._writableState instanceof X}})):Y=function(me){return me instanceof this};function z(me){if(I=I||_("./_stream_duplex"),!Y.call(z,this)&&!(this instanceof I))return new z(me);this._writableState=new X(me,this),this.writable=!0,me&&(typeof me.write=="function"&&(this._write=me.write),typeof me.writev=="function"&&(this._writev=me.writev),typeof me.destroy=="function"&&(this._destroy=me.destroy),typeof me.final=="function"&&(this._final=me.final)),k.call(this)}z.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function W(me,ye){var ge=new Error("write after end");me.emit("error",ge),P.nextTick(ye,ge)}function Z(me,ye,ge,we){var Te=!0,Ee=!1;return ge===null?Ee=new TypeError("May not write null values to stream"):typeof ge!="string"&&ge!==void 0&&!ye.objectMode&&(Ee=new TypeError("Invalid non-string/buffer chunk")),Ee&&(me.emit("error",Ee),P.nextTick(we,Ee),Te=!1),Te}z.prototype.write=function(me,ye,ge){var we=this._writableState,Te=!1,Ee=!we.objectMode&&j(me);return Ee&&!F.isBuffer(me)&&(me=V(me)),typeof ye=="function"&&(ge=ye,ye=null),Ee?ye="buffer":ye||(ye=we.defaultEncoding),typeof ge!="function"&&(ge=U),we.ended?W(this,ge):(Ee||Z(this,we,me,ge))&&(we.pendingcb++,Te=ee(this,we,Ee,me,ye,ge)),Te},z.prototype.cork=function(){var me=this._writableState;me.corked++},z.prototype.uncork=function(){var me=this._writableState;me.corked&&(me.corked--,!me.writing&&!me.corked&&!me.bufferProcessing&&me.bufferedRequest&&K(this,me))},z.prototype.setDefaultEncoding=function(ye){if(typeof ye=="string"&&(ye=ye.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ye+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+ye);return this._writableState.defaultEncoding=ye,this};function Q(me,ye,ge){return!me.objectMode&&me.decodeStrings!==!1&&typeof ye=="string"&&(ye=F.from(ye,ge)),ye}Object.defineProperty(z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ee(me,ye,ge,we,Te,Ee){if(!ge){var De=Q(ye,we,Te);we!==De&&(ge=!0,Te="buffer",we=De)}var fe=ye.objectMode?1:we.length;ye.length+=fe;var Ce=ye.length<ye.highWaterMark;if(Ce||(ye.needDrain=!0),ye.writing||ye.corked){var Se=ye.lastBufferedRequest;ye.lastBufferedRequest={chunk:we,encoding:Te,isBuf:ge,callback:Ee,next:null},Se?Se.next=ye.lastBufferedRequest:ye.bufferedRequest=ye.lastBufferedRequest,ye.bufferedRequestCount+=1}else te(me,ye,!1,fe,we,Te,Ee);return Ce}function te(me,ye,ge,we,Te,Ee,De){ye.writelen=we,ye.writecb=De,ye.writing=!0,ye.sync=!0,ge?me._writev(Te,ye.onwrite):me._write(Te,Ee,ye.onwrite),ye.sync=!1}function re(me,ye,ge,we,Te){--ye.pendingcb,ge?(P.nextTick(Te,we),P.nextTick(_e,me,ye),me._writableState.errorEmitted=!0,me.emit("error",we)):(Te(we),me._writableState.errorEmitted=!0,me.emit("error",we),_e(me,ye))}function ie(me){me.writing=!1,me.writecb=null,me.length-=me.writelen,me.writelen=0}function ne(me,ye){var ge=me._writableState,we=ge.sync,Te=ge.writecb;if(ie(ge),ye)re(me,ge,we,ye,Te);else{var Ee=ue(ge);!Ee&&!ge.corked&&!ge.bufferProcessing&&ge.bufferedRequest&&K(me,ge),we?D(he,me,ge,Ee,Te):he(me,ge,Ee,Te)}}function he(me,ye,ge,we){ge||pe(me,ye),ye.pendingcb--,we(),_e(me,ye)}function pe(me,ye){ye.length===0&&ye.needDrain&&(ye.needDrain=!1,me.emit("drain"))}function K(me,ye){ye.bufferProcessing=!0;var ge=ye.bufferedRequest;if(me._writev&&ge&&ge.next){var we=ye.bufferedRequestCount,Te=new Array(we),Ee=ye.corkedRequestsFree;Ee.entry=ge;for(var De=0,fe=!0;ge;)Te[De]=ge,ge.isBuf||(fe=!1),ge=ge.next,De+=1;Te.allBuffers=fe,te(me,ye,!0,ye.length,Te,"",Ee.finish),ye.pendingcb++,ye.lastBufferedRequest=null,Ee.next?(ye.corkedRequestsFree=Ee.next,Ee.next=null):ye.corkedRequestsFree=new E(ye),ye.bufferedRequestCount=0}else{for(;ge;){var Ce=ge.chunk,Se=ge.encoding,be=ge.callback,Re=ye.objectMode?1:Ce.length;if(te(me,ye,!1,Re,Ce,Se,be),ge=ge.next,ye.bufferedRequestCount--,ye.writing)break}ge===null&&(ye.lastBufferedRequest=null)}ye.bufferedRequest=ge,ye.bufferProcessing=!1}z.prototype._write=function(me,ye,ge){ge(new Error("_write() is not implemented"))},z.prototype._writev=null,z.prototype.end=function(me,ye,ge){var we=this._writableState;typeof me=="function"?(ge=me,me=null,ye=null):typeof ye=="function"&&(ge=ye,ye=null),me!=null&&this.write(me,ye),we.corked&&(we.corked=1,this.uncork()),we.ending||oe(this,we,ge)};function ue(me){return me.ending&&me.length===0&&me.bufferedRequest===null&&!me.finished&&!me.writing}function le(me,ye){me._final(function(ge){ye.pendingcb--,ge&&me.emit("error",ge),ye.prefinished=!0,me.emit("prefinish"),_e(me,ye)})}function ce(me,ye){!ye.prefinished&&!ye.finalCalled&&(typeof me._final=="function"?(ye.pendingcb++,ye.finalCalled=!0,P.nextTick(le,me,ye)):(ye.prefinished=!0,me.emit("prefinish")))}function _e(me,ye){var ge=ue(ye);return ge&&(ce(me,ye),ye.pendingcb===0&&(ye.finished=!0,me.emit("finish"))),ge}function oe(me,ye,ge){ye.ending=!0,_e(me,ye),ge&&(ye.finished?P.nextTick(ge):me.once("finish",ge)),ye.ended=!0,me.writable=!1}function de(me,ye,ge){var we=me.entry;for(me.entry=null;we;){var Te=we.callback;ye.pendingcb--,Te(ge),we=we.next}ye.corkedRequestsFree.next=me}Object.defineProperty(z.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(me){this._writableState&&(this._writableState.destroyed=me)}}),z.prototype.destroy=H.destroy,z.prototype._undestroy=H.undestroy,z.prototype._destroy=function(me,ye){this.end(),ye(me)}}).call(this)}).call(this,_("_process"),typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{},_("timers").setImmediate)},{"./_stream_duplex":452,"./internal/streams/destroy":458,"./internal/streams/stream":459,_process:538,"core-util-is":382,inherits:407,"process-nextick-args":441,"safe-buffer":461,timers:484,"util-deprecate":486}],457:[function(_,w,B){function A(E,D){if(!(E instanceof D))throw new TypeError("Cannot call a class as a function")}var O=_("safe-buffer").Buffer,R=_("util");function P(E,D,I){E.copy(D,I)}w.exports=function(){function E(){A(this,E),this.head=null,this.tail=null,this.length=0}return E.prototype.push=function(I){var M={data:I,next:null};this.length>0?this.tail.next=M:this.head=M,this.tail=M,++this.length},E.prototype.unshift=function(I){var M={data:I,next:this.head};this.length===0&&(this.tail=M),this.head=M,++this.length},E.prototype.shift=function(){if(this.length!==0){var I=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,I}},E.prototype.clear=function(){this.head=this.tail=null,this.length=0},E.prototype.join=function(I){if(this.length===0)return"";for(var M=this.head,N=""+M.data;M=M.next;)N+=I+M.data;return N},E.prototype.concat=function(I){if(this.length===0)return O.alloc(0);for(var M=O.allocUnsafe(I>>>0),N=this.head,k=0;N;)P(N.data,M,k),k+=N.data.length,N=N.next;return M},E}(),R&&R.inspect&&R.inspect.custom&&(w.exports.prototype[R.inspect.custom]=function(){var E=R.inspect({length:this.length});return this.constructor.name+" "+E})},{"safe-buffer":461,util:102}],458:[function(_,w,B){var A=_("process-nextick-args");function O(E,D){var I=this,M=this._readableState&&this._readableState.destroyed,N=this._writableState&&this._writableState.destroyed;return M||N?(D?D(E):E&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,A.nextTick(P,this,E)):A.nextTick(P,this,E)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(E||null,function(k){!D&&k?I._writableState?I._writableState.errorEmitted||(I._writableState.errorEmitted=!0,A.nextTick(P,I,k)):A.nextTick(P,I,k):D&&D(k)}),this)}function R(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function P(E,D){E.emit("error",D)}w.exports={destroy:O,undestroy:R}},{"process-nextick-args":441}],459:[function(_,w,B){w.exports=_("events").EventEmitter},{events:386}],460:[function(_,w,B){var A={}.toString;w.exports=Array.isArray||function(O){return A.call(O)=="[object Array]"}},{}],461:[function(_,w,B){var A=_("buffer"),O=A.Buffer;function R(E,D){for(var I in E)D[I]=E[I]}O.from&&O.alloc&&O.allocUnsafe&&O.allocUnsafeSlow?w.exports=A:(R(A,B),B.Buffer=P);function P(E,D,I){return O(E,D,I)}R(O,P),P.from=function(E,D,I){if(typeof E=="number")throw new TypeError("Argument must not be a number");return O(E,D,I)},P.alloc=function(E,D,I){if(typeof E!="number")throw new TypeError("Argument must be a number");var M=O(E);return D!==void 0?typeof I=="string"?M.fill(D,I):M.fill(D):M.fill(0),M},P.allocUnsafe=function(E){if(typeof E!="number")throw new TypeError("Argument must be a number");return O(E)},P.allocUnsafeSlow=function(E){if(typeof E!="number")throw new TypeError("Argument must be a number");return A.SlowBuffer(E)}},{buffer:103}],462:[function(_,w,B){var A=_("safe-buffer").Buffer,O=A.isEncoding||function(Y){switch(Y=""+Y,Y&&Y.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function R(Y){if(!Y)return"utf8";for(var z;;)switch(Y){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return Y;default:if(z)return;Y=(""+Y).toLowerCase(),z=!0}}function P(Y){var z=R(Y);if(typeof z!="string"&&(A.isEncoding===O||!O(Y)))throw new Error("Unknown encoding: "+Y);return z||Y}B.StringDecoder=E;function E(Y){this.encoding=P(Y);var z;switch(this.encoding){case"utf16le":this.text=G,this.end=V,z=4;break;case"utf8":this.fillLast=N,z=4;break;case"base64":this.text=j,this.end=H,z=3;break;default:this.write=U,this.end=X;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=A.allocUnsafe(z)}E.prototype.write=function(Y){if(Y.length===0)return"";var z,W;if(this.lastNeed){if(z=this.fillLast(Y),z===void 0)return"";W=this.lastNeed,this.lastNeed=0}else W=0;return W<Y.length?z?z+this.text(Y,W):this.text(Y,W):z||""},E.prototype.end=F,E.prototype.text=k,E.prototype.fillLast=function(Y){if(this.lastNeed<=Y.length)return Y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);Y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,Y.length),this.lastNeed-=Y.length};function D(Y){return Y<=127?0:Y>>5===6?2:Y>>4===14?3:Y>>3===30?4:Y>>6===2?-1:-2}function I(Y,z,W){var Z=z.length-1;if(Z<W)return 0;var Q=D(z[Z]);return Q>=0?(Q>0&&(Y.lastNeed=Q-1),Q):--Z<W||Q===-2?0:(Q=D(z[Z]),Q>=0?(Q>0&&(Y.lastNeed=Q-2),Q):--Z<W||Q===-2?0:(Q=D(z[Z]),Q>=0?(Q>0&&(Q===2?Q=0:Y.lastNeed=Q-3),Q):0))}function M(Y,z,W){if((z[0]&192)!==128)return Y.lastNeed=0,"�";if(Y.lastNeed>1&&z.length>1){if((z[1]&192)!==128)return Y.lastNeed=1,"�";if(Y.lastNeed>2&&z.length>2&&(z[2]&192)!==128)return Y.lastNeed=2,"�"}}function N(Y){var z=this.lastTotal-this.lastNeed,W=M(this,Y);if(W!==void 0)return W;if(this.lastNeed<=Y.length)return Y.copy(this.lastChar,z,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);Y.copy(this.lastChar,z,0,Y.length),this.lastNeed-=Y.length}function k(Y,z){var W=I(this,Y,z);if(!this.lastNeed)return Y.toString("utf8",z);this.lastTotal=W;var Z=Y.length-(W-this.lastNeed);return Y.copy(this.lastChar,0,Z),Y.toString("utf8",z,Z)}function F(Y){var z=Y&&Y.length?this.write(Y):"";return this.lastNeed?z+"�":z}function G(Y,z){if((Y.length-z)%2===0){var W=Y.toString("utf16le",z);if(W){var Z=W.charCodeAt(W.length-1);if(Z>=55296&&Z<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=Y[Y.length-2],this.lastChar[1]=Y[Y.length-1],W.slice(0,-1)}return W}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=Y[Y.length-1],Y.toString("utf16le",z,Y.length-1)}function V(Y){var z=Y&&Y.length?this.write(Y):"";if(this.lastNeed){var W=this.lastTotal-this.lastNeed;return z+this.lastChar.toString("utf16le",0,W)}return z}function j(Y,z){var W=(Y.length-z)%3;return W===0?Y.toString("base64",z):(this.lastNeed=3-W,this.lastTotal=3,W===1?this.lastChar[0]=Y[Y.length-1]:(this.lastChar[0]=Y[Y.length-2],this.lastChar[1]=Y[Y.length-1]),Y.toString("base64",z,Y.length-W))}function H(Y){var z=Y&&Y.length?this.write(Y):"";return this.lastNeed?z+this.lastChar.toString("base64",0,3-this.lastNeed):z}function U(Y){return Y.toString(this.encoding)}function X(Y){return Y&&Y.length?this.write(Y):""}},{"safe-buffer":461}],463:[function(_,w,B){B=w.exports=_("./lib/_stream_readable.js"),B.Stream=B,B.Readable=B,B.Writable=_("./lib/_stream_writable.js"),B.Duplex=_("./lib/_stream_duplex.js"),B.Transform=_("./lib/_stream_transform.js"),B.PassThrough=_("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":452,"./lib/_stream_passthrough.js":453,"./lib/_stream_readable.js":454,"./lib/_stream_transform.js":455,"./lib/_stream_writable.js":456}],464:[function(_,w,B){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var A=_("buffer"),O=A.Buffer;function R(E,D){for(var I in E)D[I]=E[I]}O.from&&O.alloc&&O.allocUnsafe&&O.allocUnsafeSlow?w.exports=A:(R(A,B),B.Buffer=P);function P(E,D,I){return O(E,D,I)}P.prototype=Object.create(O.prototype),R(O,P),P.from=function(E,D,I){if(typeof E=="number")throw new TypeError("Argument must not be a number");return O(E,D,I)},P.alloc=function(E,D,I){if(typeof E!="number")throw new TypeError("Argument must be a number");var M=O(E);return D!==void 0?typeof I=="string"?M.fill(D,I):M.fill(D):M.fill(0),M},P.allocUnsafe=function(E){if(typeof E!="number")throw new TypeError("Argument must be a number");return O(E)},P.allocUnsafeSlow=function(E){if(typeof E!="number")throw new TypeError("Argument must be a number");return A.SlowBuffer(E)}},{buffer:103}],465:[function(_,w,B){(function(A){(function(){(function(O){O.parser=function(fe,Ce){return new P(fe,Ce)},O.SAXParser=P,O.SAXStream=F,O.createStream=k,O.MAX_BUFFER_LENGTH=64*1024;var R=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];O.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function P(fe,Ce){if(!(this instanceof P))return new P(fe,Ce);var Se=this;D(Se),Se.q=Se.c="",Se.bufferCheckPosition=O.MAX_BUFFER_LENGTH,Se.opt=Ce||{},Se.opt.lowercase=Se.opt.lowercase||Se.opt.lowercasetags,Se.looseCase=Se.opt.lowercase?"toLowerCase":"toUpperCase",Se.tags=[],Se.closed=Se.closedRoot=Se.sawRoot=!1,Se.tag=Se.error=null,Se.strict=!!fe,Se.noscript=!!(fe||Se.opt.noscript),Se.state=ie.BEGIN,Se.strictEntities=Se.opt.strictEntities,Se.ENTITIES=Se.strictEntities?Object.create(O.XML_ENTITIES):Object.create(O.ENTITIES),Se.attribList=[],Se.opt.xmlns&&(Se.ns=Object.create(U)),Se.trackPosition=Se.opt.position!==!1,Se.trackPosition&&(Se.position=Se.line=Se.column=0),he(Se,"onready")}Object.create||(Object.create=function(fe){function Ce(){}Ce.prototype=fe;var Se=new Ce;return Se}),Object.keys||(Object.keys=function(fe){var Ce=[];for(var Se in fe)fe.hasOwnProperty(Se)&&Ce.push(Se);return Ce});function E(fe){for(var Ce=Math.max(O.MAX_BUFFER_LENGTH,10),Se=0,be=0,Re=R.length;be<Re;be++){var Ve=fe[R[be]].length;if(Ve>Ce)switch(R[be]){case"textNode":K(fe);break;case"cdata":pe(fe,"oncdata",fe.cdata),fe.cdata="";break;case"script":pe(fe,"onscript",fe.script),fe.script="";break;default:le(fe,"Max buffer length exceeded: "+R[be])}Se=Math.max(Se,Ve)}var Pe=O.MAX_BUFFER_LENGTH-Se;fe.bufferCheckPosition=Pe+fe.position}function D(fe){for(var Ce=0,Se=R.length;Ce<Se;Ce++)fe[R[Ce]]=""}function I(fe){K(fe),fe.cdata!==""&&(pe(fe,"oncdata",fe.cdata),fe.cdata=""),fe.script!==""&&(pe(fe,"onscript",fe.script),fe.script="")}P.prototype={end:function(){ce(this)},write:De,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){I(this)}};var M;try{M=_("stream").Stream}catch(fe){M=function(){}}M||(M=function(){});var N=O.EVENTS.filter(function(fe){return fe!=="error"&&fe!=="end"});function k(fe,Ce){return new F(fe,Ce)}function F(fe,Ce){if(!(this instanceof F))return new F(fe,Ce);M.apply(this),this._parser=new P(fe,Ce),this.writable=!0,this.readable=!0;var Se=this;this._parser.onend=function(){Se.emit("end")},this._parser.onerror=function(be){Se.emit("error",be),Se._parser.error=null},this._decoder=null,N.forEach(function(be){Object.defineProperty(Se,"on"+be,{get:function(){return Se._parser["on"+be]},set:function(Re){if(!Re)return Se.removeAllListeners(be),Se._parser["on"+be]=Re,Re;Se.on(be,Re)},enumerable:!0,configurable:!1})})}F.prototype=Object.create(M.prototype,{constructor:{value:F}}),F.prototype.write=function(fe){if(typeof A=="function"&&typeof A.isBuffer=="function"&&A.isBuffer(fe)){if(!this._decoder){var Ce=_("string_decoder").StringDecoder;this._decoder=new Ce("utf8")}fe=this._decoder.write(fe)}return this._parser.write(fe.toString()),this.emit("data",fe),!0},F.prototype.end=function(fe){return fe&&fe.length&&this.write(fe),this._parser.end(),!0},F.prototype.on=function(fe,Ce){var Se=this;return!Se._parser["on"+fe]&&N.indexOf(fe)!==-1&&(Se._parser["on"+fe]=function(){var be=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);be.splice(0,0,fe),Se.emit.apply(Se,be)}),M.prototype.on.call(Se,fe,Ce)};var G="[CDATA[",V="DOCTYPE",j="http://www.w3.org/XML/1998/namespace",H="http://www.w3.org/2000/xmlns/",U={xml:j,xmlns:H},X=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Y=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,z=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,W=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function Z(fe){return fe===" "||fe==="\n"||fe==="\r"||fe==="	"}function Q(fe){return fe==='"'||fe==="'"}function ee(fe){return fe===">"||Z(fe)}function te(fe,Ce){return fe.test(Ce)}function re(fe,Ce){return!te(fe,Ce)}var ie=0;O.STATE={BEGIN:ie++,BEGIN_WHITESPACE:ie++,TEXT:ie++,TEXT_ENTITY:ie++,OPEN_WAKA:ie++,SGML_DECL:ie++,SGML_DECL_QUOTED:ie++,DOCTYPE:ie++,DOCTYPE_QUOTED:ie++,DOCTYPE_DTD:ie++,DOCTYPE_DTD_QUOTED:ie++,COMMENT_STARTING:ie++,COMMENT:ie++,COMMENT_ENDING:ie++,COMMENT_ENDED:ie++,CDATA:ie++,CDATA_ENDING:ie++,CDATA_ENDING_2:ie++,PROC_INST:ie++,PROC_INST_BODY:ie++,PROC_INST_ENDING:ie++,OPEN_TAG:ie++,OPEN_TAG_SLASH:ie++,ATTRIB:ie++,ATTRIB_NAME:ie++,ATTRIB_NAME_SAW_WHITE:ie++,ATTRIB_VALUE:ie++,ATTRIB_VALUE_QUOTED:ie++,ATTRIB_VALUE_CLOSED:ie++,ATTRIB_VALUE_UNQUOTED:ie++,ATTRIB_VALUE_ENTITY_Q:ie++,ATTRIB_VALUE_ENTITY_U:ie++,CLOSE_TAG:ie++,CLOSE_TAG_SAW_WHITE:ie++,SCRIPT:ie++,SCRIPT_ENDING:ie++},O.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},O.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(O.ENTITIES).forEach(function(fe){var Ce=O.ENTITIES[fe],Se=typeof Ce=="number"?String.fromCharCode(Ce):Ce;O.ENTITIES[fe]=Se});for(var ne in O.STATE)O.STATE[O.STATE[ne]]=ne;ie=O.STATE;function he(fe,Ce,Se){fe[Ce]&&fe[Ce](Se)}function pe(fe,Ce,Se){fe.textNode&&K(fe),he(fe,Ce,Se)}function K(fe){fe.textNode=ue(fe.opt,fe.textNode),fe.textNode&&he(fe,"ontext",fe.textNode),fe.textNode=""}function ue(fe,Ce){return fe.trim&&(Ce=Ce.trim()),fe.normalize&&(Ce=Ce.replace(/\s+/g," ")),Ce}function le(fe,Ce){return K(fe),fe.trackPosition&&(Ce+="\nLine: "+fe.line+"\nColumn: "+fe.column+"\nChar: "+fe.c),Ce=new Error(Ce),fe.error=Ce,he(fe,"onerror",Ce),fe}function ce(fe){return fe.sawRoot&&!fe.closedRoot&&_e(fe,"Unclosed root tag"),fe.state!==ie.BEGIN&&fe.state!==ie.BEGIN_WHITESPACE&&fe.state!==ie.TEXT&&le(fe,"Unexpected end"),K(fe),fe.c="",fe.closed=!0,he(fe,"onend"),P.call(fe,fe.strict,fe.opt),fe}function _e(fe,Ce){if(typeof fe!="object"||!(fe instanceof P))throw new Error("bad call to strictFail");fe.strict&&le(fe,Ce)}function oe(fe){fe.strict||(fe.tagName=fe.tagName[fe.looseCase]());var Ce=fe.tags[fe.tags.length-1]||fe,Se=fe.tag={name:fe.tagName,attributes:{}};fe.opt.xmlns&&(Se.ns=Ce.ns),fe.attribList.length=0,pe(fe,"onopentagstart",Se)}function de(fe,Ce){var Se=fe.indexOf(":"),be=Se<0?["",fe]:fe.split(":"),Re=be[0],Ve=be[1];return Ce&&fe==="xmlns"&&(Re="xmlns",Ve=""),{prefix:Re,local:Ve}}function me(fe){if(fe.strict||(fe.attribName=fe.attribName[fe.looseCase]()),fe.attribList.indexOf(fe.attribName)!==-1||fe.tag.attributes.hasOwnProperty(fe.attribName)){fe.attribName=fe.attribValue="";return}if(fe.opt.xmlns){var Ce=de(fe.attribName,!0),Se=Ce.prefix,be=Ce.local;if(Se==="xmlns")if(be==="xml"&&fe.attribValue!==j)_e(fe,"xml: prefix must be bound to "+j+"\nActual: "+fe.attribValue);else if(be==="xmlns"&&fe.attribValue!==H)_e(fe,"xmlns: prefix must be bound to "+H+"\nActual: "+fe.attribValue);else{var Re=fe.tag,Ve=fe.tags[fe.tags.length-1]||fe;Re.ns===Ve.ns&&(Re.ns=Object.create(Ve.ns)),Re.ns[be]=fe.attribValue}fe.attribList.push([fe.attribName,fe.attribValue])}else fe.tag.attributes[fe.attribName]=fe.attribValue,pe(fe,"onattribute",{name:fe.attribName,value:fe.attribValue});fe.attribName=fe.attribValue=""}function ye(fe,Ce){if(fe.opt.xmlns){var Se=fe.tag,be=de(fe.tagName);Se.prefix=be.prefix,Se.local=be.local,Se.uri=Se.ns[be.prefix]||"",Se.prefix&&!Se.uri&&(_e(fe,"Unbound namespace prefix: "+JSON.stringify(fe.tagName)),Se.uri=be.prefix);var Re=fe.tags[fe.tags.length-1]||fe;Se.ns&&Re.ns!==Se.ns&&Object.keys(Se.ns).forEach(function($e){pe(fe,"onopennamespace",{prefix:$e,uri:Se.ns[$e]})});for(var Ve=0,Pe=fe.attribList.length;Ve<Pe;Ve++){var ke=fe.attribList[Ve],Ne=ke[0],Ae=ke[1],Oe=de(Ne,!0),Fe=Oe.prefix,nt=Oe.local,Ze=Fe===""?"":Se.ns[Fe]||"",Xe={name:Ne,value:Ae,prefix:Fe,local:nt,uri:Ze};Fe&&Fe!=="xmlns"&&!Ze&&(_e(fe,"Unbound namespace prefix: "+JSON.stringify(Fe)),Xe.uri=Fe),fe.tag.attributes[Ne]=Xe,pe(fe,"onattribute",Xe)}fe.attribList.length=0}fe.tag.isSelfClosing=!!Ce,fe.sawRoot=!0,fe.tags.push(fe.tag),pe(fe,"onopentag",fe.tag),Ce||(!fe.noscript&&fe.tagName.toLowerCase()==="script"?fe.state=ie.SCRIPT:fe.state=ie.TEXT,fe.tag=null,fe.tagName=""),fe.attribName=fe.attribValue="",fe.attribList.length=0}function ge(fe){if(!fe.tagName){_e(fe,"Weird empty close tag."),fe.textNode+="</>",fe.state=ie.TEXT;return}if(fe.script){if(fe.tagName!=="script"){fe.script+="</"+fe.tagName+">",fe.tagName="",fe.state=ie.SCRIPT;return}pe(fe,"onscript",fe.script),fe.script=""}var Ce=fe.tags.length,Se=fe.tagName;fe.strict||(Se=Se[fe.looseCase]());for(var be=Se;Ce--;){var Re=fe.tags[Ce];if(Re.name!==be)_e(fe,"Unexpected close tag");else break}if(Ce<0){_e(fe,"Unmatched closing tag: "+fe.tagName),fe.textNode+="</"+fe.tagName+">",fe.state=ie.TEXT;return}fe.tagName=Se;for(var Ve=fe.tags.length;Ve-- >Ce;){var Pe=fe.tag=fe.tags.pop();fe.tagName=fe.tag.name,pe(fe,"onclosetag",fe.tagName);var ke={};for(var Ne in Pe.ns)ke[Ne]=Pe.ns[Ne];var Ae=fe.tags[fe.tags.length-1]||fe;fe.opt.xmlns&&Pe.ns!==Ae.ns&&Object.keys(Pe.ns).forEach(function(Oe){var Fe=Pe.ns[Oe];pe(fe,"onclosenamespace",{prefix:Oe,uri:Fe})})}Ce===0&&(fe.closedRoot=!0),fe.tagName=fe.attribValue=fe.attribName="",fe.attribList.length=0,fe.state=ie.TEXT}function we(fe){var Ce=fe.entity,Se=Ce.toLowerCase(),be,Re="";return fe.ENTITIES[Ce]?fe.ENTITIES[Ce]:fe.ENTITIES[Se]?fe.ENTITIES[Se]:(Ce=Se,Ce.charAt(0)==="#"&&(Ce.charAt(1)==="x"?(Ce=Ce.slice(2),be=parseInt(Ce,16),Re=be.toString(16)):(Ce=Ce.slice(1),be=parseInt(Ce,10),Re=be.toString(10))),Ce=Ce.replace(/^0+/,""),isNaN(be)||Re.toLowerCase()!==Ce?(_e(fe,"Invalid character entity"),"&"+fe.entity+";"):String.fromCodePoint(be))}function Te(fe,Ce){Ce==="<"?(fe.state=ie.OPEN_WAKA,fe.startTagPosition=fe.position):Z(Ce)||(_e(fe,"Non-whitespace before first tag."),fe.textNode=Ce,fe.state=ie.TEXT)}function Ee(fe,Ce){var Se="";return Ce<fe.length&&(Se=fe.charAt(Ce)),Se}function De(fe){var Ce=this;if(this.error)throw this.error;if(Ce.closed)return le(Ce,"Cannot write after close. Assign an onready handler.");if(fe===null)return ce(Ce);typeof fe=="object"&&(fe=fe.toString());for(var Se=0,be="";be=Ee(fe,Se++),Ce.c=be,!!be;)switch(Ce.trackPosition&&(Ce.position++,be==="\n"?(Ce.line++,Ce.column=0):Ce.column++),Ce.state){case ie.BEGIN:if(Ce.state=ie.BEGIN_WHITESPACE,be==="\uFEFF")continue;Te(Ce,be);continue;case ie.BEGIN_WHITESPACE:Te(Ce,be);continue;case ie.TEXT:if(Ce.sawRoot&&!Ce.closedRoot){for(var Re=Se-1;be&&be!=="<"&&be!=="&";)be=Ee(fe,Se++),be&&Ce.trackPosition&&(Ce.position++,be==="\n"?(Ce.line++,Ce.column=0):Ce.column++);Ce.textNode+=fe.substring(Re,Se-1)}be==="<"&&!(Ce.sawRoot&&Ce.closedRoot&&!Ce.strict)?(Ce.state=ie.OPEN_WAKA,Ce.startTagPosition=Ce.position):(!Z(be)&&(!Ce.sawRoot||Ce.closedRoot)&&_e(Ce,"Text data outside of root node."),be==="&"?Ce.state=ie.TEXT_ENTITY:Ce.textNode+=be);continue;case ie.SCRIPT:be==="<"?Ce.state=ie.SCRIPT_ENDING:Ce.script+=be;continue;case ie.SCRIPT_ENDING:be==="/"?Ce.state=ie.CLOSE_TAG:(Ce.script+="<"+be,Ce.state=ie.SCRIPT);continue;case ie.OPEN_WAKA:if(be==="!")Ce.state=ie.SGML_DECL,Ce.sgmlDecl="";else if(!Z(be))if(te(X,be))Ce.state=ie.OPEN_TAG,Ce.tagName=be;else if(be==="/")Ce.state=ie.CLOSE_TAG,Ce.tagName="";else if(be==="?")Ce.state=ie.PROC_INST,Ce.procInstName=Ce.procInstBody="";else{if(_e(Ce,"Unencoded <"),Ce.startTagPosition+1<Ce.position){var Ve=Ce.position-Ce.startTagPosition;be=new Array(Ve).join(" ")+be}Ce.textNode+="<"+be,Ce.state=ie.TEXT}continue;case ie.SGML_DECL:(Ce.sgmlDecl+be).toUpperCase()===G?(pe(Ce,"onopencdata"),Ce.state=ie.CDATA,Ce.sgmlDecl="",Ce.cdata=""):Ce.sgmlDecl+be==="--"?(Ce.state=ie.COMMENT,Ce.comment="",Ce.sgmlDecl=""):(Ce.sgmlDecl+be).toUpperCase()===V?(Ce.state=ie.DOCTYPE,(Ce.doctype||Ce.sawRoot)&&_e(Ce,"Inappropriately located doctype declaration"),Ce.doctype="",Ce.sgmlDecl=""):be===">"?(pe(Ce,"onsgmldeclaration",Ce.sgmlDecl),Ce.sgmlDecl="",Ce.state=ie.TEXT):(Q(be)&&(Ce.state=ie.SGML_DECL_QUOTED),Ce.sgmlDecl+=be);continue;case ie.SGML_DECL_QUOTED:be===Ce.q&&(Ce.state=ie.SGML_DECL,Ce.q=""),Ce.sgmlDecl+=be;continue;case ie.DOCTYPE:be===">"?(Ce.state=ie.TEXT,pe(Ce,"ondoctype",Ce.doctype),Ce.doctype=!0):(Ce.doctype+=be,be==="["?Ce.state=ie.DOCTYPE_DTD:Q(be)&&(Ce.state=ie.DOCTYPE_QUOTED,Ce.q=be));continue;case ie.DOCTYPE_QUOTED:Ce.doctype+=be,be===Ce.q&&(Ce.q="",Ce.state=ie.DOCTYPE);continue;case ie.DOCTYPE_DTD:Ce.doctype+=be,be==="]"?Ce.state=ie.DOCTYPE:Q(be)&&(Ce.state=ie.DOCTYPE_DTD_QUOTED,Ce.q=be);continue;case ie.DOCTYPE_DTD_QUOTED:Ce.doctype+=be,be===Ce.q&&(Ce.state=ie.DOCTYPE_DTD,Ce.q="");continue;case ie.COMMENT:be==="-"?Ce.state=ie.COMMENT_ENDING:Ce.comment+=be;continue;case ie.COMMENT_ENDING:be==="-"?(Ce.state=ie.COMMENT_ENDED,Ce.comment=ue(Ce.opt,Ce.comment),Ce.comment&&pe(Ce,"oncomment",Ce.comment),Ce.comment=""):(Ce.comment+="-"+be,Ce.state=ie.COMMENT);continue;case ie.COMMENT_ENDED:be!==">"?(_e(Ce,"Malformed comment"),Ce.comment+="--"+be,Ce.state=ie.COMMENT):Ce.state=ie.TEXT;continue;case ie.CDATA:be==="]"?Ce.state=ie.CDATA_ENDING:Ce.cdata+=be;continue;case ie.CDATA_ENDING:be==="]"?Ce.state=ie.CDATA_ENDING_2:(Ce.cdata+="]"+be,Ce.state=ie.CDATA);continue;case ie.CDATA_ENDING_2:be===">"?(Ce.cdata&&pe(Ce,"oncdata",Ce.cdata),pe(Ce,"onclosecdata"),Ce.cdata="",Ce.state=ie.TEXT):be==="]"?Ce.cdata+="]":(Ce.cdata+="]]"+be,Ce.state=ie.CDATA);continue;case ie.PROC_INST:be==="?"?Ce.state=ie.PROC_INST_ENDING:Z(be)?Ce.state=ie.PROC_INST_BODY:Ce.procInstName+=be;continue;case ie.PROC_INST_BODY:if(!Ce.procInstBody&&Z(be))continue;be==="?"?Ce.state=ie.PROC_INST_ENDING:Ce.procInstBody+=be;continue;case ie.PROC_INST_ENDING:be===">"?(pe(Ce,"onprocessinginstruction",{name:Ce.procInstName,body:Ce.procInstBody}),Ce.procInstName=Ce.procInstBody="",Ce.state=ie.TEXT):(Ce.procInstBody+="?"+be,Ce.state=ie.PROC_INST_BODY);continue;case ie.OPEN_TAG:te(Y,be)?Ce.tagName+=be:(oe(Ce),be===">"?ye(Ce):be==="/"?Ce.state=ie.OPEN_TAG_SLASH:(Z(be)||_e(Ce,"Invalid character in tag name"),Ce.state=ie.ATTRIB));continue;case ie.OPEN_TAG_SLASH:be===">"?(ye(Ce,!0),ge(Ce)):(_e(Ce,"Forward-slash in opening tag not followed by >"),Ce.state=ie.ATTRIB);continue;case ie.ATTRIB:if(Z(be))continue;be===">"?ye(Ce):be==="/"?Ce.state=ie.OPEN_TAG_SLASH:te(X,be)?(Ce.attribName=be,Ce.attribValue="",Ce.state=ie.ATTRIB_NAME):_e(Ce,"Invalid attribute name");continue;case ie.ATTRIB_NAME:be==="="?Ce.state=ie.ATTRIB_VALUE:be===">"?(_e(Ce,"Attribute without value"),Ce.attribValue=Ce.attribName,me(Ce),ye(Ce)):Z(be)?Ce.state=ie.ATTRIB_NAME_SAW_WHITE:te(Y,be)?Ce.attribName+=be:_e(Ce,"Invalid attribute name");continue;case ie.ATTRIB_NAME_SAW_WHITE:if(be==="=")Ce.state=ie.ATTRIB_VALUE;else{if(Z(be))continue;_e(Ce,"Attribute without value"),Ce.tag.attributes[Ce.attribName]="",Ce.attribValue="",pe(Ce,"onattribute",{name:Ce.attribName,value:""}),Ce.attribName="",be===">"?ye(Ce):te(X,be)?(Ce.attribName=be,Ce.state=ie.ATTRIB_NAME):(_e(Ce,"Invalid attribute name"),Ce.state=ie.ATTRIB)}continue;case ie.ATTRIB_VALUE:if(Z(be))continue;Q(be)?(Ce.q=be,Ce.state=ie.ATTRIB_VALUE_QUOTED):(_e(Ce,"Unquoted attribute value"),Ce.state=ie.ATTRIB_VALUE_UNQUOTED,Ce.attribValue=be);continue;case ie.ATTRIB_VALUE_QUOTED:if(be!==Ce.q){be==="&"?Ce.state=ie.ATTRIB_VALUE_ENTITY_Q:Ce.attribValue+=be;continue}me(Ce),Ce.q="",Ce.state=ie.ATTRIB_VALUE_CLOSED;continue;case ie.ATTRIB_VALUE_CLOSED:Z(be)?Ce.state=ie.ATTRIB:be===">"?ye(Ce):be==="/"?Ce.state=ie.OPEN_TAG_SLASH:te(X,be)?(_e(Ce,"No whitespace between attributes"),Ce.attribName=be,Ce.attribValue="",Ce.state=ie.ATTRIB_NAME):_e(Ce,"Invalid attribute name");continue;case ie.ATTRIB_VALUE_UNQUOTED:if(!ee(be)){be==="&"?Ce.state=ie.ATTRIB_VALUE_ENTITY_U:Ce.attribValue+=be;continue}me(Ce),be===">"?ye(Ce):Ce.state=ie.ATTRIB;continue;case ie.CLOSE_TAG:if(Ce.tagName)be===">"?ge(Ce):te(Y,be)?Ce.tagName+=be:Ce.script?(Ce.script+="</"+Ce.tagName,Ce.tagName="",Ce.state=ie.SCRIPT):(Z(be)||_e(Ce,"Invalid tagname in closing tag"),Ce.state=ie.CLOSE_TAG_SAW_WHITE);else{if(Z(be))continue;re(X,be)?Ce.script?(Ce.script+="</"+be,Ce.state=ie.SCRIPT):_e(Ce,"Invalid tagname in closing tag."):Ce.tagName=be}continue;case ie.CLOSE_TAG_SAW_WHITE:if(Z(be))continue;be===">"?ge(Ce):_e(Ce,"Invalid characters in closing tag");continue;case ie.TEXT_ENTITY:case ie.ATTRIB_VALUE_ENTITY_Q:case ie.ATTRIB_VALUE_ENTITY_U:var Pe,ke;switch(Ce.state){case ie.TEXT_ENTITY:Pe=ie.TEXT,ke="textNode";break;case ie.ATTRIB_VALUE_ENTITY_Q:Pe=ie.ATTRIB_VALUE_QUOTED,ke="attribValue";break;case ie.ATTRIB_VALUE_ENTITY_U:Pe=ie.ATTRIB_VALUE_UNQUOTED,ke="attribValue";break}if(be===";")if(Ce.opt.unparsedEntities){var Ne=we(Ce);Ce.entity="",Ce.state=Pe,Ce.write(Ne)}else Ce[ke]+=we(Ce),Ce.entity="",Ce.state=Pe;else te(Ce.entity.length?W:z,be)?Ce.entity+=be:(_e(Ce,"Invalid character in entity name"),Ce[ke]+="&"+Ce.entity+be,Ce.entity="",Ce.state=Pe);continue;default:throw new Error(Ce,"Unknown state: "+Ce.state)}return Ce.position>=Ce.bufferCheckPosition&&E(Ce),Ce}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var fe=String.fromCharCode,Ce=Math.floor,Se=function(){var be=16384,Re=[],Ve,Pe,ke=-1,Ne=arguments.length;if(!Ne)return"";for(var Ae="";++ke<Ne;){var Oe=Number(arguments[ke]);if(!isFinite(Oe)||Oe<0||Oe>1114111||Ce(Oe)!==Oe)throw RangeError("Invalid code point: "+Oe);Oe<=65535?Re.push(Oe):(Oe-=65536,Ve=(Oe>>10)+55296,Pe=Oe%1024+56320,Re.push(Ve,Pe)),(ke+1===Ne||Re.length>be)&&(Ae+=fe.apply(null,Re),Re.length=0)}return Ae};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Se,configurable:!0,writable:!0}):String.fromCodePoint=Se}()})(typeof B>"u"?this.sax={}:B)}).call(this)}).call(this,_("buffer").Buffer)},{buffer:103,stream:468,string_decoder:483}],466:[function(_,w,B){var A=_("get-intrinsic"),O=_("define-data-property"),R=_("has-property-descriptors")(),P=_("gopd"),E=A("%TypeError%"),D=A("%Math.floor%");w.exports=function(M,N){if(typeof M!="function")throw new E("`fn` is not a function");if(typeof N!="number"||N<0||N>4294967295||D(N)!==N)throw new E("`length` must be a positive 32-bit integer");var k=arguments.length>2&&!!arguments[2],F=!0,G=!0;if("length"in M&&P){var V=P(M,"length");V&&!V.configurable&&(F=!1),V&&!V.writable&&(G=!1)}return(F||G||!k)&&(R?O(M,"length",N,!0,!0):O(M,"length",N)),M}},{"define-data-property":384,"get-intrinsic":390,gopd:391,"has-property-descriptors":392}],467:[function(_,w,B){var A=_("get-intrinsic"),O=_("call-bind/callBound"),R=_("object-inspect"),P=A("%TypeError%"),E=A("%WeakMap%",!0),D=A("%Map%",!0),I=O("WeakMap.prototype.get",!0),M=O("WeakMap.prototype.set",!0),N=O("WeakMap.prototype.has",!0),k=O("Map.prototype.get",!0),F=O("Map.prototype.set",!0),G=O("Map.prototype.has",!0),V=function(X,Y){for(var z=X,W;(W=z.next)!==null;z=W)if(W.key===Y)return z.next=W.next,W.next=X.next,X.next=W,W},j=function(X,Y){var z=V(X,Y);return z&&z.value},H=function(X,Y,z){var W=V(X,Y);W?W.value=z:X.next={key:Y,next:X.next,value:z}},U=function(X,Y){return!!V(X,Y)};w.exports=function(){var Y,z,W,Z={assert:function(Q){if(!Z.has(Q))throw new P("Side channel does not contain "+R(Q))},get:function(Q){if(E&&Q&&(typeof Q=="object"||typeof Q=="function")){if(Y)return I(Y,Q)}else if(D){if(z)return k(z,Q)}else if(W)return j(W,Q)},has:function(Q){if(E&&Q&&(typeof Q=="object"||typeof Q=="function")){if(Y)return N(Y,Q)}else if(D){if(z)return G(z,Q)}else if(W)return U(W,Q);return!1},set:function(Q,ee){E&&Q&&(typeof Q=="object"||typeof Q=="function")?(Y||(Y=new E),M(Y,Q,ee)):D?(z||(z=new D),F(z,Q,ee)):(W||(W={key:{},next:null}),H(W,Q,ee))}};return Z}},{"call-bind/callBound":105,"get-intrinsic":390,"object-inspect":433}],468:[function(_,w,B){w.exports=R;var A=_("events").EventEmitter,O=_("inherits");O(R,A),R.Readable=_("readable-stream/lib/_stream_readable.js"),R.Writable=_("readable-stream/lib/_stream_writable.js"),R.Duplex=_("readable-stream/lib/_stream_duplex.js"),R.Transform=_("readable-stream/lib/_stream_transform.js"),R.PassThrough=_("readable-stream/lib/_stream_passthrough.js"),R.finished=_("readable-stream/lib/internal/streams/end-of-stream.js"),R.pipeline=_("readable-stream/lib/internal/streams/pipeline.js"),R.Stream=R;function R(){A.call(this)}R.prototype.pipe=function(P,E){var D=this;function I(j){P.writable&&P.write(j)===!1&&D.pause&&D.pause()}D.on("data",I);function M(){D.readable&&D.resume&&D.resume()}P.on("drain",M),!P._isStdio&&(!E||E.end!==!1)&&(D.on("end",k),D.on("close",F));var N=!1;function k(){N||(N=!0,P.end())}function F(){N||(N=!0,typeof P.destroy=="function"&&P.destroy())}function G(j){if(V(),A.listenerCount(this,"error")===0)throw j}D.on("error",G),P.on("error",G);function V(){D.removeListener("data",I),P.removeListener("drain",M),D.removeListener("end",k),D.removeListener("close",F),D.removeListener("error",G),P.removeListener("error",G),D.removeListener("end",V),D.removeListener("close",V),P.removeListener("close",V)}return D.on("end",V),D.on("close",V),P.on("close",V),P.emit("pipe",D),P}},{events:386,inherits:407,"readable-stream/lib/_stream_duplex.js":470,"readable-stream/lib/_stream_passthrough.js":471,"readable-stream/lib/_stream_readable.js":472,"readable-stream/lib/_stream_transform.js":473,"readable-stream/lib/_stream_writable.js":474,"readable-stream/lib/internal/streams/end-of-stream.js":478,"readable-stream/lib/internal/streams/pipeline.js":480}],469:[function(_,w,B){function A(M,N){M.prototype=Object.create(N.prototype),M.prototype.constructor=M,M.__proto__=N}var O={};function R(M,N,k){k||(k=Error);function F(V,j,H){return typeof N=="string"?N:N(V,j,H)}var G=function(V){A(j,V);function j(H,U,X){return V.call(this,F(H,U,X))||this}return j}(k);G.prototype.name=k.name,G.prototype.code=M,O[M]=G}function P(M,N){if(Array.isArray(M)){var k=M.length;return M=M.map(function(F){return String(F)}),k>2?"one of ".concat(N," ").concat(M.slice(0,k-1).join(", "),", or ")+M[k-1]:k===2?"one of ".concat(N," ").concat(M[0]," or ").concat(M[1]):"of ".concat(N," ").concat(M[0])}else return"of ".concat(N," ").concat(String(M))}function E(M,N,k){return M.substr(0,N.length)===N}function D(M,N,k){return(k===void 0||k>M.length)&&(k=M.length),M.substring(k-N.length,k)===N}function I(M,N,k){return typeof k!="number"&&(k=0),k+N.length>M.length?!1:M.indexOf(N,k)!==-1}R("ERR_INVALID_OPT_VALUE",function(M,N){return'The value "'+N+'" is invalid for option "'+M+'"'},TypeError),R("ERR_INVALID_ARG_TYPE",function(M,N,k){var F;typeof N=="string"&&E(N,"not ")?(F="must not be",N=N.replace(/^not /,"")):F="must be";var G;if(D(M," argument"))G="The ".concat(M," ").concat(F," ").concat(P(N,"type"));else{var V=I(M,".")?"property":"argument";G='The "'.concat(M,'" ').concat(V," ").concat(F," ").concat(P(N,"type"))}return G+=". Received type ".concat(typeof k),G},TypeError),R("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),R("ERR_METHOD_NOT_IMPLEMENTED",function(M){return"The "+M+" method is not implemented"}),R("ERR_STREAM_PREMATURE_CLOSE","Premature close"),R("ERR_STREAM_DESTROYED",function(M){return"Cannot call "+M+" after a stream was destroyed"}),R("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),R("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),R("ERR_STREAM_WRITE_AFTER_END","write after end"),R("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),R("ERR_UNKNOWN_ENCODING",function(M){return"Unknown encoding: "+M},TypeError),R("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),w.exports.codes=O},{}],470:[function(_,w,B){(function(A){(function(){var O=Object.keys||function(F){var G=[];for(var V in F)G.push(V);return G};w.exports=M;var R=_("./_stream_readable"),P=_("./_stream_writable");_("inherits")(M,R);for(var E=O(P.prototype),D=0;D<E.length;D++){var I=E[D];M.prototype[I]||(M.prototype[I]=P.prototype[I])}function M(F){if(!(this instanceof M))return new M(F);R.call(this,F),P.call(this,F),this.allowHalfOpen=!0,F&&(F.readable===!1&&(this.readable=!1),F.writable===!1&&(this.writable=!1),F.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",N)))}Object.defineProperty(M.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(M.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(M.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function N(){this._writableState.ended||A.nextTick(k,this)}function k(F){F.end()}Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(G){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=G,this._writableState.destroyed=G)}})}).call(this)}).call(this,_("_process"))},{"./_stream_readable":472,"./_stream_writable":474,_process:538,inherits:407}],471:[function(_,w,B){w.exports=O;var A=_("./_stream_transform");_("inherits")(O,A);function O(R){if(!(this instanceof O))return new O(R);A.call(this,R)}O.prototype._transform=function(R,P,E){E(null,R)}},{"./_stream_transform":473,inherits:407}],472:[function(_,w,B){(function(A,O){(function(){w.exports=he;var R;he.ReadableState=ne,_("events").EventEmitter;var P=function(ke,Ne){return ke.listeners(Ne).length},E=_("./internal/streams/stream"),D=_("buffer").Buffer,I=(typeof O<"u"?O:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function M(Pe){return D.from(Pe)}function N(Pe){return D.isBuffer(Pe)||Pe instanceof I}var k=_("util"),F;k&&k.debuglog?F=k.debuglog("stream"):F=function(){};var G=_("./internal/streams/buffer_list"),V=_("./internal/streams/destroy"),j=_("./internal/streams/state"),H=j.getHighWaterMark,U=_("../errors").codes,X=U.ERR_INVALID_ARG_TYPE,Y=U.ERR_STREAM_PUSH_AFTER_EOF,z=U.ERR_METHOD_NOT_IMPLEMENTED,W=U.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Z,Q,ee;_("inherits")(he,E);var te=V.errorOrDestroy,re=["error","close","destroy","pause","resume"];function ie(Pe,ke,Ne){if(typeof Pe.prependListener=="function")return Pe.prependListener(ke,Ne);!Pe._events||!Pe._events[ke]?Pe.on(ke,Ne):Array.isArray(Pe._events[ke])?Pe._events[ke].unshift(Ne):Pe._events[ke]=[Ne,Pe._events[ke]]}function ne(Pe,ke,Ne){R=R||_("./_stream_duplex"),Pe=Pe||{},typeof Ne!="boolean"&&(Ne=ke instanceof R),this.objectMode=!!Pe.objectMode,Ne&&(this.objectMode=this.objectMode||!!Pe.readableObjectMode),this.highWaterMark=H(this,Pe,"readableHighWaterMark",Ne),this.buffer=new G,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Pe.emitClose!==!1,this.autoDestroy=!!Pe.autoDestroy,this.destroyed=!1,this.defaultEncoding=Pe.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Pe.encoding&&(Z||(Z=_("string_decoder/").StringDecoder),this.decoder=new Z(Pe.encoding),this.encoding=Pe.encoding)}function he(Pe){if(R=R||_("./_stream_duplex"),!(this instanceof he))return new he(Pe);var ke=this instanceof R;this._readableState=new ne(Pe,this,ke),this.readable=!0,Pe&&(typeof Pe.read=="function"&&(this._read=Pe.read),typeof Pe.destroy=="function"&&(this._destroy=Pe.destroy)),E.call(this)}Object.defineProperty(he.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ke){this._readableState&&(this._readableState.destroyed=ke)}}),he.prototype.destroy=V.destroy,he.prototype._undestroy=V.undestroy,he.prototype._destroy=function(Pe,ke){ke(Pe)},he.prototype.push=function(Pe,ke){var Ne=this._readableState,Ae;return Ne.objectMode?Ae=!0:typeof Pe=="string"&&(ke=ke||Ne.defaultEncoding,ke!==Ne.encoding&&(Pe=D.from(Pe,ke),ke=""),Ae=!0),pe(this,Pe,ke,!1,Ae)},he.prototype.unshift=function(Pe){return pe(this,Pe,null,!0,!1)};function pe(Pe,ke,Ne,Ae,Oe){F("readableAddChunk",ke);var Fe=Pe._readableState;if(ke===null)Fe.reading=!1,oe(Pe,Fe);else{var nt;if(Oe||(nt=ue(Fe,ke)),nt)te(Pe,nt);else if(Fe.objectMode||ke&&ke.length>0)if(typeof ke!="string"&&!Fe.objectMode&&Object.getPrototypeOf(ke)!==D.prototype&&(ke=M(ke)),Ae)Fe.endEmitted?te(Pe,new W):K(Pe,Fe,ke,!0);else if(Fe.ended)te(Pe,new Y);else{if(Fe.destroyed)return!1;Fe.reading=!1,Fe.decoder&&!Ne?(ke=Fe.decoder.write(ke),Fe.objectMode||ke.length!==0?K(Pe,Fe,ke,!1):ye(Pe,Fe)):K(Pe,Fe,ke,!1)}else Ae||(Fe.reading=!1,ye(Pe,Fe))}return!Fe.ended&&(Fe.length<Fe.highWaterMark||Fe.length===0)}function K(Pe,ke,Ne,Ae){ke.flowing&&ke.length===0&&!ke.sync?(ke.awaitDrain=0,Pe.emit("data",Ne)):(ke.length+=ke.objectMode?1:Ne.length,Ae?ke.buffer.unshift(Ne):ke.buffer.push(Ne),ke.needReadable&&de(Pe)),ye(Pe,ke)}function ue(Pe,ke){var Ne;return!N(ke)&&typeof ke!="string"&&ke!==void 0&&!Pe.objectMode&&(Ne=new X("chunk",["string","Buffer","Uint8Array"],ke)),Ne}he.prototype.isPaused=function(){return this._readableState.flowing===!1},he.prototype.setEncoding=function(Pe){Z||(Z=_("string_decoder/").StringDecoder);var ke=new Z(Pe);this._readableState.decoder=ke,this._readableState.encoding=this._readableState.decoder.encoding;for(var Ne=this._readableState.buffer.head,Ae="";Ne!==null;)Ae+=ke.write(Ne.data),Ne=Ne.next;return this._readableState.buffer.clear(),Ae!==""&&this._readableState.buffer.push(Ae),this._readableState.length=Ae.length,this};var le=1073741824;function ce(Pe){return Pe>=le?Pe=le:(Pe--,Pe|=Pe>>>1,Pe|=Pe>>>2,Pe|=Pe>>>4,Pe|=Pe>>>8,Pe|=Pe>>>16,Pe++),Pe}function _e(Pe,ke){return Pe<=0||ke.length===0&&ke.ended?0:ke.objectMode?1:Pe!==Pe?ke.flowing&&ke.length?ke.buffer.head.data.length:ke.length:(Pe>ke.highWaterMark&&(ke.highWaterMark=ce(Pe)),Pe<=ke.length?Pe:ke.ended?ke.length:(ke.needReadable=!0,0))}he.prototype.read=function(Pe){F("read",Pe),Pe=parseInt(Pe,10);var ke=this._readableState,Ne=Pe;if(Pe!==0&&(ke.emittedReadable=!1),Pe===0&&ke.needReadable&&((ke.highWaterMark!==0?ke.length>=ke.highWaterMark:ke.length>0)||ke.ended))return F("read: emitReadable",ke.length,ke.ended),ke.length===0&&ke.ended?be(this):de(this),null;if(Pe=_e(Pe,ke),Pe===0&&ke.ended)return ke.length===0&&be(this),null;var Ae=ke.needReadable;F("need readable",Ae),(ke.length===0||ke.length-Pe<ke.highWaterMark)&&(Ae=!0,F("length less than watermark",Ae)),ke.ended||ke.reading?(Ae=!1,F("reading or ended",Ae)):Ae&&(F("do read"),ke.reading=!0,ke.sync=!0,ke.length===0&&(ke.needReadable=!0),this._read(ke.highWaterMark),ke.sync=!1,ke.reading||(Pe=_e(Ne,ke)));var Oe;return Pe>0?Oe=Se(Pe,ke):Oe=null,Oe===null?(ke.needReadable=ke.length<=ke.highWaterMark,Pe=0):(ke.length-=Pe,ke.awaitDrain=0),ke.length===0&&(ke.ended||(ke.needReadable=!0),Ne!==Pe&&ke.ended&&be(this)),Oe!==null&&this.emit("data",Oe),Oe};function oe(Pe,ke){if(F("onEofChunk"),!ke.ended){if(ke.decoder){var Ne=ke.decoder.end();Ne&&Ne.length&&(ke.buffer.push(Ne),ke.length+=ke.objectMode?1:Ne.length)}ke.ended=!0,ke.sync?de(Pe):(ke.needReadable=!1,ke.emittedReadable||(ke.emittedReadable=!0,me(Pe)))}}function de(Pe){var ke=Pe._readableState;F("emitReadable",ke.needReadable,ke.emittedReadable),ke.needReadable=!1,ke.emittedReadable||(F("emitReadable",ke.flowing),ke.emittedReadable=!0,A.nextTick(me,Pe))}function me(Pe){var ke=Pe._readableState;F("emitReadable_",ke.destroyed,ke.length,ke.ended),!ke.destroyed&&(ke.length||ke.ended)&&(Pe.emit("readable"),ke.emittedReadable=!1),ke.needReadable=!ke.flowing&&!ke.ended&&ke.length<=ke.highWaterMark,Ce(Pe)}function ye(Pe,ke){ke.readingMore||(ke.readingMore=!0,A.nextTick(ge,Pe,ke))}function ge(Pe,ke){for(;!ke.reading&&!ke.ended&&(ke.length<ke.highWaterMark||ke.flowing&&ke.length===0);){var Ne=ke.length;if(F("maybeReadMore read 0"),Pe.read(0),Ne===ke.length)break}ke.readingMore=!1}he.prototype._read=function(Pe){te(this,new z("_read()"))},he.prototype.pipe=function(Pe,ke){var Ne=this,Ae=this._readableState;switch(Ae.pipesCount){case 0:Ae.pipes=Pe;break;case 1:Ae.pipes=[Ae.pipes,Pe];break;default:Ae.pipes.push(Pe);break}Ae.pipesCount+=1,F("pipe count=%d opts=%j",Ae.pipesCount,ke);var Oe=(!ke||ke.end!==!1)&&Pe!==A.stdout&&Pe!==A.stderr,Fe=Oe?Ze:ht;Ae.endEmitted?A.nextTick(Fe):Ne.once("end",Fe),Pe.on("unpipe",nt);function nt(Be,je){F("onunpipe"),Be===Ne&&je&&je.hasUnpiped===!1&&(je.hasUnpiped=!0,ot())}function Ze(){F("onend"),Pe.end()}var Xe=we(Ne);Pe.on("drain",Xe);var $e=!1;function ot(){F("cleanup"),Pe.removeListener("close",Ue),Pe.removeListener("finish",We),Pe.removeListener("drain",Xe),Pe.removeListener("error",gt),Pe.removeListener("unpipe",nt),Ne.removeListener("end",Ze),Ne.removeListener("end",ht),Ne.removeListener("data",ut),$e=!0,Ae.awaitDrain&&(!Pe._writableState||Pe._writableState.needDrain)&&Xe()}Ne.on("data",ut);function ut(Be){F("ondata");var je=Pe.write(Be);F("dest.write",je),je===!1&&((Ae.pipesCount===1&&Ae.pipes===Pe||Ae.pipesCount>1&&Ve(Ae.pipes,Pe)!==-1)&&!$e&&(F("false write response, pause",Ae.awaitDrain),Ae.awaitDrain++),Ne.pause())}function gt(Be){F("onerror",Be),ht(),Pe.removeListener("error",gt),P(Pe,"error")===0&&te(Pe,Be)}ie(Pe,"error",gt);function Ue(){Pe.removeListener("finish",We),ht()}Pe.once("close",Ue);function We(){F("onfinish"),Pe.removeListener("close",Ue),ht()}Pe.once("finish",We);function ht(){F("unpipe"),Ne.unpipe(Pe)}return Pe.emit("pipe",Ne),Ae.flowing||(F("pipe resume"),Ne.resume()),Pe};function we(Pe){return function(){var Ne=Pe._readableState;F("pipeOnDrain",Ne.awaitDrain),Ne.awaitDrain&&Ne.awaitDrain--,Ne.awaitDrain===0&&P(Pe,"data")&&(Ne.flowing=!0,Ce(Pe))}}he.prototype.unpipe=function(Pe){var ke=this._readableState,Ne={hasUnpiped:!1};if(ke.pipesCount===0)return this;if(ke.pipesCount===1)return Pe&&Pe!==ke.pipes?this:(Pe||(Pe=ke.pipes),ke.pipes=null,ke.pipesCount=0,ke.flowing=!1,Pe&&Pe.emit("unpipe",this,Ne),this);if(!Pe){var Ae=ke.pipes,Oe=ke.pipesCount;ke.pipes=null,ke.pipesCount=0,ke.flowing=!1;for(var Fe=0;Fe<Oe;Fe++)Ae[Fe].emit("unpipe",this,{hasUnpiped:!1});return this}var nt=Ve(ke.pipes,Pe);return nt===-1?this:(ke.pipes.splice(nt,1),ke.pipesCount-=1,ke.pipesCount===1&&(ke.pipes=ke.pipes[0]),Pe.emit("unpipe",this,Ne),this)},he.prototype.on=function(Pe,ke){var Ne=E.prototype.on.call(this,Pe,ke),Ae=this._readableState;return Pe==="data"?(Ae.readableListening=this.listenerCount("readable")>0,Ae.flowing!==!1&&this.resume()):Pe==="readable"&&!Ae.endEmitted&&!Ae.readableListening&&(Ae.readableListening=Ae.needReadable=!0,Ae.flowing=!1,Ae.emittedReadable=!1,F("on readable",Ae.length,Ae.reading),Ae.length?de(this):Ae.reading||A.nextTick(Ee,this)),Ne},he.prototype.addListener=he.prototype.on,he.prototype.removeListener=function(Pe,ke){var Ne=E.prototype.removeListener.call(this,Pe,ke);return Pe==="readable"&&A.nextTick(Te,this),Ne},he.prototype.removeAllListeners=function(Pe){var ke=E.prototype.removeAllListeners.apply(this,arguments);return(Pe==="readable"||Pe===void 0)&&A.nextTick(Te,this),ke};function Te(Pe){var ke=Pe._readableState;ke.readableListening=Pe.listenerCount("readable")>0,ke.resumeScheduled&&!ke.paused?ke.flowing=!0:Pe.listenerCount("data")>0&&Pe.resume()}function Ee(Pe){F("readable nexttick read 0"),Pe.read(0)}he.prototype.resume=function(){var Pe=this._readableState;return Pe.flowing||(F("resume"),Pe.flowing=!Pe.readableListening,De(this,Pe)),Pe.paused=!1,this};function De(Pe,ke){ke.resumeScheduled||(ke.resumeScheduled=!0,A.nextTick(fe,Pe,ke))}function fe(Pe,ke){F("resume",ke.reading),ke.reading||Pe.read(0),ke.resumeScheduled=!1,Pe.emit("resume"),Ce(Pe),ke.flowing&&!ke.reading&&Pe.read(0)}he.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Ce(Pe){var ke=Pe._readableState;for(F("flow",ke.flowing);ke.flowing&&Pe.read()!==null;);}he.prototype.wrap=function(Pe){var ke=this,Ne=this._readableState,Ae=!1;Pe.on("end",function(){if(F("wrapped end"),Ne.decoder&&!Ne.ended){var nt=Ne.decoder.end();nt&&nt.length&&ke.push(nt)}ke.push(null)}),Pe.on("data",function(nt){if(F("wrapped data"),Ne.decoder&&(nt=Ne.decoder.write(nt)),!(Ne.objectMode&&nt==null)&&!(!Ne.objectMode&&(!nt||!nt.length))){var Ze=ke.push(nt);Ze||(Ae=!0,Pe.pause())}});for(var Oe in Pe)this[Oe]===void 0&&typeof Pe[Oe]=="function"&&(this[Oe]=function(Ze){return function(){return Pe[Ze].apply(Pe,arguments)}}(Oe));for(var Fe=0;Fe<re.length;Fe++)Pe.on(re[Fe],this.emit.bind(this,re[Fe]));return this._read=function(nt){F("wrapped _read",nt),Ae&&(Ae=!1,Pe.resume())},this},typeof Symbol=="function"&&(he.prototype[Symbol.asyncIterator]=function(){return Q===void 0&&(Q=_("./internal/streams/async_iterator")),Q(this)}),Object.defineProperty(he.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(he.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(he.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ke){this._readableState&&(this._readableState.flowing=ke)}}),he._fromList=Se,Object.defineProperty(he.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Se(Pe,ke){if(ke.length===0)return null;var Ne;return ke.objectMode?Ne=ke.buffer.shift():!Pe||Pe>=ke.length?(ke.decoder?Ne=ke.buffer.join(""):ke.buffer.length===1?Ne=ke.buffer.first():Ne=ke.buffer.concat(ke.length),ke.buffer.clear()):Ne=ke.buffer.consume(Pe,ke.decoder),Ne}function be(Pe){var ke=Pe._readableState;F("endReadable",ke.endEmitted),ke.endEmitted||(ke.ended=!0,A.nextTick(Re,ke,Pe))}function Re(Pe,ke){if(F("endReadableNT",Pe.endEmitted,Pe.length),!Pe.endEmitted&&Pe.length===0&&(Pe.endEmitted=!0,ke.readable=!1,ke.emit("end"),Pe.autoDestroy)){var Ne=ke._writableState;(!Ne||Ne.autoDestroy&&Ne.finished)&&ke.destroy()}}typeof Symbol=="function"&&(he.from=function(Pe,ke){return ee===void 0&&(ee=_("./internal/streams/from")),ee(he,Pe,ke)});function Ve(Pe,ke){for(var Ne=0,Ae=Pe.length;Ne<Ae;Ne++)if(Pe[Ne]===ke)return Ne;return-1}}).call(this)}).call(this,_("_process"),typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":469,"./_stream_duplex":470,"./internal/streams/async_iterator":475,"./internal/streams/buffer_list":476,"./internal/streams/destroy":477,"./internal/streams/from":479,"./internal/streams/state":481,"./internal/streams/stream":482,_process:538,buffer:103,events:386,inherits:407,"string_decoder/":483,util:102}],473:[function(_,w,B){w.exports=M;var A=_("../errors").codes,O=A.ERR_METHOD_NOT_IMPLEMENTED,R=A.ERR_MULTIPLE_CALLBACK,P=A.ERR_TRANSFORM_ALREADY_TRANSFORMING,E=A.ERR_TRANSFORM_WITH_LENGTH_0,D=_("./_stream_duplex");_("inherits")(M,D);function I(F,G){var V=this._transformState;V.transforming=!1;var j=V.writecb;if(j===null)return this.emit("error",new R);V.writechunk=null,V.writecb=null,G!=null&&this.push(G),j(F);var H=this._readableState;H.reading=!1,(H.needReadable||H.length<H.highWaterMark)&&this._read(H.highWaterMark)}function M(F){if(!(this instanceof M))return new M(F);D.call(this,F),this._transformState={afterTransform:I.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,F&&(typeof F.transform=="function"&&(this._transform=F.transform),typeof F.flush=="function"&&(this._flush=F.flush)),this.on("prefinish",N)}function N(){var F=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(G,V){k(F,G,V)}):k(this,null,null)}M.prototype.push=function(F,G){return this._transformState.needTransform=!1,D.prototype.push.call(this,F,G)},M.prototype._transform=function(F,G,V){V(new O("_transform()"))},M.prototype._write=function(F,G,V){var j=this._transformState;if(j.writecb=V,j.writechunk=F,j.writeencoding=G,!j.transforming){var H=this._readableState;(j.needTransform||H.needReadable||H.length<H.highWaterMark)&&this._read(H.highWaterMark)}},M.prototype._read=function(F){var G=this._transformState;G.writechunk!==null&&!G.transforming?(G.transforming=!0,this._transform(G.writechunk,G.writeencoding,G.afterTransform)):G.needTransform=!0},M.prototype._destroy=function(F,G){D.prototype._destroy.call(this,F,function(V){G(V)})};function k(F,G,V){if(G)return F.emit("error",G);if(V!=null&&F.push(V),F._writableState.length)throw new E;if(F._transformState.transforming)throw new P;return F.push(null)}},{"../errors":469,"./_stream_duplex":470,inherits:407}],474:[function(_,w,B){(function(A,O){(function(){w.exports=ne;function R(Ce){var Se=this;this.next=null,this.entry=null,this.finish=function(){fe(Se,Ce)}}var P;ne.WritableState=re;var E={deprecate:_("util-deprecate")},D=_("./internal/streams/stream"),I=_("buffer").Buffer,M=(typeof O<"u"?O:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function N(Ce){return I.from(Ce)}function k(Ce){return I.isBuffer(Ce)||Ce instanceof M}var F=_("./internal/streams/destroy"),G=_("./internal/streams/state"),V=G.getHighWaterMark,j=_("../errors").codes,H=j.ERR_INVALID_ARG_TYPE,U=j.ERR_METHOD_NOT_IMPLEMENTED,X=j.ERR_MULTIPLE_CALLBACK,Y=j.ERR_STREAM_CANNOT_PIPE,z=j.ERR_STREAM_DESTROYED,W=j.ERR_STREAM_NULL_VALUES,Z=j.ERR_STREAM_WRITE_AFTER_END,Q=j.ERR_UNKNOWN_ENCODING,ee=F.errorOrDestroy;_("inherits")(ne,D);function te(){}function re(Ce,Se,be){P=P||_("./_stream_duplex"),Ce=Ce||{},typeof be!="boolean"&&(be=Se instanceof P),this.objectMode=!!Ce.objectMode,be&&(this.objectMode=this.objectMode||!!Ce.writableObjectMode),this.highWaterMark=V(this,Ce,"writableHighWaterMark",be),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Re=Ce.decodeStrings===!1;this.decodeStrings=!Re,this.defaultEncoding=Ce.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Ve){oe(Se,Ve)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Ce.emitClose!==!1,this.autoDestroy=!!Ce.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new R(this)}re.prototype.getBuffer=function(){for(var Se=this.bufferedRequest,be=[];Se;)be.push(Se),Se=Se.next;return be},function(){try{Object.defineProperty(re.prototype,"buffer",{get:E.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(Ce){}}();var ie;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(ie=Function.prototype[Symbol.hasInstance],Object.defineProperty(ne,Symbol.hasInstance,{value:function(Se){return ie.call(this,Se)?!0:this!==ne?!1:Se&&Se._writableState instanceof re}})):ie=function(Se){return Se instanceof this};function ne(Ce){P=P||_("./_stream_duplex");var Se=this instanceof P;if(!Se&&!ie.call(ne,this))return new ne(Ce);this._writableState=new re(Ce,this,Se),this.writable=!0,Ce&&(typeof Ce.write=="function"&&(this._write=Ce.write),typeof Ce.writev=="function"&&(this._writev=Ce.writev),typeof Ce.destroy=="function"&&(this._destroy=Ce.destroy),typeof Ce.final=="function"&&(this._final=Ce.final)),D.call(this)}ne.prototype.pipe=function(){ee(this,new Y)};function he(Ce,Se){var be=new Z;ee(Ce,be),A.nextTick(Se,be)}function pe(Ce,Se,be,Re){var Ve;return be===null?Ve=new W:typeof be!="string"&&!Se.objectMode&&(Ve=new H("chunk",["string","Buffer"],be)),Ve?(ee(Ce,Ve),A.nextTick(Re,Ve),!1):!0}ne.prototype.write=function(Ce,Se,be){var Re=this._writableState,Ve=!1,Pe=!Re.objectMode&&k(Ce);return Pe&&!I.isBuffer(Ce)&&(Ce=N(Ce)),typeof Se=="function"&&(be=Se,Se=null),Pe?Se="buffer":Se||(Se=Re.defaultEncoding),typeof be!="function"&&(be=te),Re.ending?he(this,be):(Pe||pe(this,Re,Ce,be))&&(Re.pendingcb++,Ve=ue(this,Re,Pe,Ce,Se,be)),Ve},ne.prototype.cork=function(){this._writableState.corked++},ne.prototype.uncork=function(){var Ce=this._writableState;Ce.corked&&(Ce.corked--,!Ce.writing&&!Ce.corked&&!Ce.bufferProcessing&&Ce.bufferedRequest&&ye(this,Ce))},ne.prototype.setDefaultEncoding=function(Se){if(typeof Se=="string"&&(Se=Se.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Se+"").toLowerCase())>-1))throw new Q(Se);return this._writableState.defaultEncoding=Se,this},Object.defineProperty(ne.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function K(Ce,Se,be){return!Ce.objectMode&&Ce.decodeStrings!==!1&&typeof Se=="string"&&(Se=I.from(Se,be)),Se}Object.defineProperty(ne.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ue(Ce,Se,be,Re,Ve,Pe){if(!be){var ke=K(Se,Re,Ve);Re!==ke&&(be=!0,Ve="buffer",Re=ke)}var Ne=Se.objectMode?1:Re.length;Se.length+=Ne;var Ae=Se.length<Se.highWaterMark;if(Ae||(Se.needDrain=!0),Se.writing||Se.corked){var Oe=Se.lastBufferedRequest;Se.lastBufferedRequest={chunk:Re,encoding:Ve,isBuf:be,callback:Pe,next:null},Oe?Oe.next=Se.lastBufferedRequest:Se.bufferedRequest=Se.lastBufferedRequest,Se.bufferedRequestCount+=1}else le(Ce,Se,!1,Ne,Re,Ve,Pe);return Ae}function le(Ce,Se,be,Re,Ve,Pe,ke){Se.writelen=Re,Se.writecb=ke,Se.writing=!0,Se.sync=!0,Se.destroyed?Se.onwrite(new z("write")):be?Ce._writev(Ve,Se.onwrite):Ce._write(Ve,Pe,Se.onwrite),Se.sync=!1}function ce(Ce,Se,be,Re,Ve){--Se.pendingcb,be?(A.nextTick(Ve,Re),A.nextTick(Ee,Ce,Se),Ce._writableState.errorEmitted=!0,ee(Ce,Re)):(Ve(Re),Ce._writableState.errorEmitted=!0,ee(Ce,Re),Ee(Ce,Se))}function _e(Ce){Ce.writing=!1,Ce.writecb=null,Ce.length-=Ce.writelen,Ce.writelen=0}function oe(Ce,Se){var be=Ce._writableState,Re=be.sync,Ve=be.writecb;if(typeof Ve!="function")throw new X;if(_e(be),Se)ce(Ce,be,Re,Se,Ve);else{var Pe=ge(be)||Ce.destroyed;!Pe&&!be.corked&&!be.bufferProcessing&&be.bufferedRequest&&ye(Ce,be),Re?A.nextTick(de,Ce,be,Pe,Ve):de(Ce,be,Pe,Ve)}}function de(Ce,Se,be,Re){be||me(Ce,Se),Se.pendingcb--,Re(),Ee(Ce,Se)}function me(Ce,Se){Se.length===0&&Se.needDrain&&(Se.needDrain=!1,Ce.emit("drain"))}function ye(Ce,Se){Se.bufferProcessing=!0;var be=Se.bufferedRequest;if(Ce._writev&&be&&be.next){var Re=Se.bufferedRequestCount,Ve=new Array(Re),Pe=Se.corkedRequestsFree;Pe.entry=be;for(var ke=0,Ne=!0;be;)Ve[ke]=be,be.isBuf||(Ne=!1),be=be.next,ke+=1;Ve.allBuffers=Ne,le(Ce,Se,!0,Se.length,Ve,"",Pe.finish),Se.pendingcb++,Se.lastBufferedRequest=null,Pe.next?(Se.corkedRequestsFree=Pe.next,Pe.next=null):Se.corkedRequestsFree=new R(Se),Se.bufferedRequestCount=0}else{for(;be;){var Ae=be.chunk,Oe=be.encoding,Fe=be.callback,nt=Se.objectMode?1:Ae.length;if(le(Ce,Se,!1,nt,Ae,Oe,Fe),be=be.next,Se.bufferedRequestCount--,Se.writing)break}be===null&&(Se.lastBufferedRequest=null)}Se.bufferedRequest=be,Se.bufferProcessing=!1}ne.prototype._write=function(Ce,Se,be){be(new U("_write()"))},ne.prototype._writev=null,ne.prototype.end=function(Ce,Se,be){var Re=this._writableState;return typeof Ce=="function"?(be=Ce,Ce=null,Se=null):typeof Se=="function"&&(be=Se,Se=null),Ce!=null&&this.write(Ce,Se),Re.corked&&(Re.corked=1,this.uncork()),Re.ending||De(this,Re,be),this},Object.defineProperty(ne.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ge(Ce){return Ce.ending&&Ce.length===0&&Ce.bufferedRequest===null&&!Ce.finished&&!Ce.writing}function we(Ce,Se){Ce._final(function(be){Se.pendingcb--,be&&ee(Ce,be),Se.prefinished=!0,Ce.emit("prefinish"),Ee(Ce,Se)})}function Te(Ce,Se){!Se.prefinished&&!Se.finalCalled&&(typeof Ce._final=="function"&&!Se.destroyed?(Se.pendingcb++,Se.finalCalled=!0,A.nextTick(we,Ce,Se)):(Se.prefinished=!0,Ce.emit("prefinish")))}function Ee(Ce,Se){var be=ge(Se);if(be&&(Te(Ce,Se),Se.pendingcb===0&&(Se.finished=!0,Ce.emit("finish"),Se.autoDestroy))){var Re=Ce._readableState;(!Re||Re.autoDestroy&&Re.endEmitted)&&Ce.destroy()}return be}function De(Ce,Se,be){Se.ending=!0,Ee(Ce,Se),be&&(Se.finished?A.nextTick(be):Ce.once("finish",be)),Se.ended=!0,Ce.writable=!1}function fe(Ce,Se,be){var Re=Ce.entry;for(Ce.entry=null;Re;){var Ve=Re.callback;Se.pendingcb--,Ve(be),Re=Re.next}Se.corkedRequestsFree.next=Ce}Object.defineProperty(ne.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Se){this._writableState&&(this._writableState.destroyed=Se)}}),ne.prototype.destroy=F.destroy,ne.prototype._undestroy=F.undestroy,ne.prototype._destroy=function(Ce,Se){Se(Ce)}}).call(this)}).call(this,_("_process"),typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":469,"./_stream_duplex":470,"./internal/streams/destroy":477,"./internal/streams/state":481,"./internal/streams/stream":482,_process:538,buffer:103,inherits:407,"util-deprecate":486}],475:[function(_,w,B){(function(A){(function(){var O;function R(Z,Q,ee){return Q=P(Q),Q in Z?Object.defineProperty(Z,Q,{value:ee,enumerable:!0,configurable:!0,writable:!0}):Z[Q]=ee,Z}function P(Z){var Q=E(Z,"string");return typeof Q=="symbol"?Q:String(Q)}function E(Z,Q){if(typeof Z!="object"||Z===null)return Z;var ee=Z[Symbol.toPrimitive];if(ee!==void 0){var te=ee.call(Z,Q);if(typeof te!="object")return te;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Q==="string"?String:Number)(Z)}var D=_("./end-of-stream"),I=Symbol("lastResolve"),M=Symbol("lastReject"),N=Symbol("error"),k=Symbol("ended"),F=Symbol("lastPromise"),G=Symbol("handlePromise"),V=Symbol("stream");function j(Z,Q){return{value:Z,done:Q}}function H(Z){var Q=Z[I];if(Q!==null){var ee=Z[V].read();ee!==null&&(Z[F]=null,Z[I]=null,Z[M]=null,Q(j(ee,!1)))}}function U(Z){A.nextTick(H,Z)}function X(Z,Q){return function(ee,te){Z.then(function(){if(Q[k]){ee(j(void 0,!0));return}Q[G](ee,te)},te)}}var Y=Object.getPrototypeOf(function(){}),z=Object.setPrototypeOf((O={get stream(){return this[V]},next:function(){var Q=this,ee=this[N];if(ee!==null)return Promise.reject(ee);if(this[k])return Promise.resolve(j(void 0,!0));if(this[V].destroyed)return new Promise(function(ne,he){A.nextTick(function(){Q[N]?he(Q[N]):ne(j(void 0,!0))})});var te=this[F],re;if(te)re=new Promise(X(te,this));else{var ie=this[V].read();if(ie!==null)return Promise.resolve(j(ie,!1));re=new Promise(this[G])}return this[F]=re,re}},R(O,Symbol.asyncIterator,function(){return this}),R(O,"return",function(){var Q=this;return new Promise(function(ee,te){Q[V].destroy(null,function(re){if(re){te(re);return}ee(j(void 0,!0))})})}),O),Y),W=function(Q){var ee,te=Object.create(z,(ee={},R(ee,V,{value:Q,writable:!0}),R(ee,I,{value:null,writable:!0}),R(ee,M,{value:null,writable:!0}),R(ee,N,{value:null,writable:!0}),R(ee,k,{value:Q._readableState.endEmitted,writable:!0}),R(ee,G,{value:function(ie,ne){var he=te[V].read();he?(te[F]=null,te[I]=null,te[M]=null,ie(j(he,!1))):(te[I]=ie,te[M]=ne)},writable:!0}),ee));return te[F]=null,D(Q,function(re){if(re&&re.code!=="ERR_STREAM_PREMATURE_CLOSE"){var ie=te[M];ie!==null&&(te[F]=null,te[I]=null,te[M]=null,ie(re)),te[N]=re;return}var ne=te[I];ne!==null&&(te[F]=null,te[I]=null,te[M]=null,ne(j(void 0,!0))),te[k]=!0}),Q.on("readable",U.bind(null,te)),te};w.exports=W}).call(this)}).call(this,_("_process"))},{"./end-of-stream":478,_process:538}],476:[function(_,w,B){function A(H,U){var X=Object.keys(H);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(H);U&&(Y=Y.filter(function(z){return Object.getOwnPropertyDescriptor(H,z).enumerable})),X.push.apply(X,Y)}return X}function O(H){for(var U=1;U<arguments.length;U++){var X=arguments[U]!=null?arguments[U]:{};U%2?A(Object(X),!0).forEach(function(Y){R(H,Y,X[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(X)):A(Object(X)).forEach(function(Y){Object.defineProperty(H,Y,Object.getOwnPropertyDescriptor(X,Y))})}return H}function R(H,U,X){return U=I(U),U in H?Object.defineProperty(H,U,{value:X,enumerable:!0,configurable:!0,writable:!0}):H[U]=X,H}function P(H,U){if(!(H instanceof U))throw new TypeError("Cannot call a class as a function")}function E(H,U){for(var X=0;X<U.length;X++){var Y=U[X];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(H,I(Y.key),Y)}}function D(H,U,X){return U&&E(H.prototype,U),Object.defineProperty(H,"prototype",{writable:!1}),H}function I(H){var U=M(H,"string");return typeof U=="symbol"?U:String(U)}function M(H,U){if(typeof H!="object"||H===null)return H;var X=H[Symbol.toPrimitive];if(X!==void 0){var Y=X.call(H,U);if(typeof Y!="object")return Y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(H)}var N=_("buffer"),k=N.Buffer,F=_("util"),G=F.inspect,V=G&&G.custom||"inspect";function j(H,U,X){k.prototype.copy.call(H,U,X)}w.exports=function(){function H(){P(this,H),this.head=null,this.tail=null,this.length=0}return D(H,[{key:"push",value:function(X){var Y={data:X,next:null};this.length>0?this.tail.next=Y:this.head=Y,this.tail=Y,++this.length}},{key:"unshift",value:function(X){var Y={data:X,next:this.head};this.length===0&&(this.tail=Y),this.head=Y,++this.length}},{key:"shift",value:function(){if(this.length!==0){var X=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,X}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(X){if(this.length===0)return"";for(var Y=this.head,z=""+Y.data;Y=Y.next;)z+=X+Y.data;return z}},{key:"concat",value:function(X){if(this.length===0)return k.alloc(0);for(var Y=k.allocUnsafe(X>>>0),z=this.head,W=0;z;)j(z.data,Y,W),W+=z.data.length,z=z.next;return Y}},{key:"consume",value:function(X,Y){var z;return X<this.head.data.length?(z=this.head.data.slice(0,X),this.head.data=this.head.data.slice(X)):X===this.head.data.length?z=this.shift():z=Y?this._getString(X):this._getBuffer(X),z}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(X){var Y=this.head,z=1,W=Y.data;for(X-=W.length;Y=Y.next;){var Z=Y.data,Q=X>Z.length?Z.length:X;if(Q===Z.length?W+=Z:W+=Z.slice(0,X),X-=Q,X===0){Q===Z.length?(++z,Y.next?this.head=Y.next:this.head=this.tail=null):(this.head=Y,Y.data=Z.slice(Q));break}++z}return this.length-=z,W}},{key:"_getBuffer",value:function(X){var Y=k.allocUnsafe(X),z=this.head,W=1;for(z.data.copy(Y),X-=z.data.length;z=z.next;){var Z=z.data,Q=X>Z.length?Z.length:X;if(Z.copy(Y,Y.length-X,0,Q),X-=Q,X===0){Q===Z.length?(++W,z.next?this.head=z.next:this.head=this.tail=null):(this.head=z,z.data=Z.slice(Q));break}++W}return this.length-=W,Y}},{key:V,value:function(X,Y){return G(this,O(O({},Y),{},{depth:0,customInspect:!1}))}}]),H}()},{buffer:103,util:102}],477:[function(_,w,B){(function(A){(function(){function O(M,N){var k=this,F=this._readableState&&this._readableState.destroyed,G=this._writableState&&this._writableState.destroyed;return F||G?(N?N(M):M&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,A.nextTick(D,this,M)):A.nextTick(D,this,M)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(M||null,function(V){!N&&V?k._writableState?k._writableState.errorEmitted?A.nextTick(P,k):(k._writableState.errorEmitted=!0,A.nextTick(R,k,V)):A.nextTick(R,k,V):N?(A.nextTick(P,k),N(V)):A.nextTick(P,k)}),this)}function R(M,N){D(M,N),P(M)}function P(M){M._writableState&&!M._writableState.emitClose||M._readableState&&!M._readableState.emitClose||M.emit("close")}function E(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function D(M,N){M.emit("error",N)}function I(M,N){var k=M._readableState,F=M._writableState;k&&k.autoDestroy||F&&F.autoDestroy?M.destroy(N):M.emit("error",N)}w.exports={destroy:O,undestroy:E,errorOrDestroy:I}}).call(this)}).call(this,_("_process"))},{_process:538}],478:[function(_,w,B){var A=_("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function O(D){var I=!1;return function(){if(!I){I=!0;for(var M=arguments.length,N=new Array(M),k=0;k<M;k++)N[k]=arguments[k];D.apply(this,N)}}}function R(){}function P(D){return D.setHeader&&typeof D.abort=="function"}function E(D,I,M){if(typeof I=="function")return E(D,null,I);I||(I={}),M=O(M||R);var N=I.readable||I.readable!==!1&&D.readable,k=I.writable||I.writable!==!1&&D.writable,F=function(){D.writable||V()},G=D._writableState&&D._writableState.finished,V=function(){k=!1,G=!0,N||M.call(D)},j=D._readableState&&D._readableState.endEmitted,H=function(){N=!1,j=!0,k||M.call(D)},U=function(W){M.call(D,W)},X=function(){var W;if(N&&!j)return(!D._readableState||!D._readableState.ended)&&(W=new A),M.call(D,W);if(k&&!G)return(!D._writableState||!D._writableState.ended)&&(W=new A),M.call(D,W)},Y=function(){D.req.on("finish",V)};return P(D)?(D.on("complete",V),D.on("abort",X),D.req?Y():D.on("request",Y)):k&&!D._writableState&&(D.on("end",F),D.on("close",F)),D.on("end",H),D.on("finish",V),I.error!==!1&&D.on("error",U),D.on("close",X),function(){D.removeListener("complete",V),D.removeListener("abort",X),D.removeListener("request",Y),D.req&&D.req.removeListener("finish",V),D.removeListener("end",F),D.removeListener("close",F),D.removeListener("finish",V),D.removeListener("end",H),D.removeListener("error",U),D.removeListener("close",X)}}w.exports=E},{"../../../errors":469}],479:[function(_,w,B){w.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],480:[function(_,w,B){var A;function O(V){var j=!1;return function(){j||(j=!0,V.apply(void 0,arguments))}}var R=_("../../../errors").codes,P=R.ERR_MISSING_ARGS,E=R.ERR_STREAM_DESTROYED;function D(V){if(V)throw V}function I(V){return V.setHeader&&typeof V.abort=="function"}function M(V,j,H,U){U=O(U);var X=!1;V.on("close",function(){X=!0}),A===void 0&&(A=_("./end-of-stream")),A(V,{readable:j,writable:H},function(z){if(z)return U(z);X=!0,U()});var Y=!1;return function(z){if(!X&&!Y){if(Y=!0,I(V))return V.abort();if(typeof V.destroy=="function")return V.destroy();U(z||new E("pipe"))}}}function N(V){V()}function k(V,j){return V.pipe(j)}function F(V){return!V.length||typeof V[V.length-1]!="function"?D:V.pop()}function G(){for(var V=arguments.length,j=new Array(V),H=0;H<V;H++)j[H]=arguments[H];var U=F(j);if(Array.isArray(j[0])&&(j=j[0]),j.length<2)throw new P("streams");var X,Y=j.map(function(z,W){var Z=W<j.length-1,Q=W>0;return M(z,Z,Q,function(ee){X||(X=ee),ee&&Y.forEach(N),!Z&&(Y.forEach(N),U(X))})});return j.reduce(k)}w.exports=G},{"../../../errors":469,"./end-of-stream":478}],481:[function(_,w,B){var A=_("../../../errors").codes.ERR_INVALID_OPT_VALUE;function O(P,E,D){return P.highWaterMark!=null?P.highWaterMark:E?P[D]:null}function R(P,E,D,I){var M=O(E,I,D);if(M!=null){if(!(isFinite(M)&&Math.floor(M)===M)||M<0){var N=I?D:"highWaterMark";throw new A(N,M)}return Math.floor(M)}return P.objectMode?16:16*1024}w.exports={getHighWaterMark:R}},{"../../../errors":469}],482:[function(_,w,B){arguments[4][459][0].apply(B,arguments)},{dup:459,events:386}],483:[function(_,w,B){arguments[4][462][0].apply(B,arguments)},{dup:462,"safe-buffer":464}],484:[function(_,w,B){(function(A,O){(function(){var R=_("process/browser.js").nextTick,P=Function.prototype.apply,E=Array.prototype.slice,D={},I=0;B.setTimeout=function(){return new M(P.call(setTimeout,window,arguments),clearTimeout)},B.setInterval=function(){return new M(P.call(setInterval,window,arguments),clearInterval)},B.clearTimeout=B.clearInterval=function(N){N.close()};function M(N,k){this._id=N,this._clearFn=k}M.prototype.unref=M.prototype.ref=function(){},M.prototype.close=function(){this._clearFn.call(window,this._id)},B.enroll=function(N,k){clearTimeout(N._idleTimeoutId),N._idleTimeout=k},B.unenroll=function(N){clearTimeout(N._idleTimeoutId),N._idleTimeout=-1},B._unrefActive=B.active=function(N){clearTimeout(N._idleTimeoutId);var k=N._idleTimeout;k>=0&&(N._idleTimeoutId=setTimeout(function(){N._onTimeout&&N._onTimeout()},k))},B.setImmediate=typeof A=="function"?A:function(N){var k=I++,F=arguments.length<2?!1:E.call(arguments,1);return D[k]=!0,R(function(){D[k]&&(F?N.apply(null,F):N.call(null),B.clearImmediate(k))}),k},B.clearImmediate=typeof O=="function"?O:function(N){delete D[N]}}).call(this)}).call(this,_("timers").setImmediate,_("timers").clearImmediate)},{"process/browser.js":442,timers:484}],485:[function(_,w,B){var A=_("buffer").Buffer;w.exports=function(O){if(O instanceof Uint8Array){if(O.byteOffset===0&&O.byteLength===O.buffer.byteLength)return O.buffer;if(typeof O.buffer.slice=="function")return O.buffer.slice(O.byteOffset,O.byteOffset+O.byteLength)}if(A.isBuffer(O)){for(var R=new Uint8Array(O.length),P=O.length,E=0;E<P;E++)R[E]=O[E];return R.buffer}else throw new Error("Argument must be a Buffer")}},{buffer:103}],486:[function(_,w,B){(function(A){(function(){w.exports=O;function O(P,E){if(R("noDeprecation"))return P;var D=!1;function I(){if(!D){if(R("throwDeprecation"))throw new Error(E);R("traceDeprecation")?console.trace(E):console.warn(E),D=!0}return P.apply(this,arguments)}return I}function R(P){try{if(!A.localStorage)return!1}catch(D){return!1}var E=A.localStorage[P];return E==null?!1:String(E).toLowerCase()==="true"}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{}],487:[function(_,w,B){arguments[4][97][0].apply(B,arguments)},{dup:97}],488:[function(_,w,B){var A=_("is-arguments"),O=_("is-generator-function"),R=_("which-typed-array"),P=_("is-typed-array");function E(Fe){return Fe.call.bind(Fe)}var D=typeof BigInt<"u",I=typeof Symbol<"u",M=E(Object.prototype.toString),N=E(Number.prototype.valueOf),k=E(String.prototype.valueOf),F=E(Boolean.prototype.valueOf);if(D)var G=E(BigInt.prototype.valueOf);if(I)var V=E(Symbol.prototype.valueOf);function j(Fe,nt){if(typeof Fe!="object")return!1;try{return nt(Fe),!0}catch(Ze){return!1}}B.isArgumentsObject=A,B.isGeneratorFunction=O,B.isTypedArray=P;function H(Fe){return typeof Promise<"u"&&Fe instanceof Promise||Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"&&typeof Fe.catch=="function"}B.isPromise=H;function U(Fe){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(Fe):P(Fe)||ge(Fe)}B.isArrayBufferView=U;function X(Fe){return R(Fe)==="Uint8Array"}B.isUint8Array=X;function Y(Fe){return R(Fe)==="Uint8ClampedArray"}B.isUint8ClampedArray=Y;function z(Fe){return R(Fe)==="Uint16Array"}B.isUint16Array=z;function W(Fe){return R(Fe)==="Uint32Array"}B.isUint32Array=W;function Z(Fe){return R(Fe)==="Int8Array"}B.isInt8Array=Z;function Q(Fe){return R(Fe)==="Int16Array"}B.isInt16Array=Q;function ee(Fe){return R(Fe)==="Int32Array"}B.isInt32Array=ee;function te(Fe){return R(Fe)==="Float32Array"}B.isFloat32Array=te;function re(Fe){return R(Fe)==="Float64Array"}B.isFloat64Array=re;function ie(Fe){return R(Fe)==="BigInt64Array"}B.isBigInt64Array=ie;function ne(Fe){return R(Fe)==="BigUint64Array"}B.isBigUint64Array=ne;function he(Fe){return M(Fe)==="[object Map]"}he.working=typeof Map<"u"&&he(new Map);function pe(Fe){return typeof Map>"u"?!1:he.working?he(Fe):Fe instanceof Map}B.isMap=pe;function K(Fe){return M(Fe)==="[object Set]"}K.working=typeof Set<"u"&&K(new Set);function ue(Fe){return typeof Set>"u"?!1:K.working?K(Fe):Fe instanceof Set}B.isSet=ue;function le(Fe){return M(Fe)==="[object WeakMap]"}le.working=typeof WeakMap<"u"&&le(new WeakMap);function ce(Fe){return typeof WeakMap>"u"?!1:le.working?le(Fe):Fe instanceof WeakMap}B.isWeakMap=ce;function _e(Fe){return M(Fe)==="[object WeakSet]"}_e.working=typeof WeakSet<"u"&&_e(new WeakSet);function oe(Fe){return _e(Fe)}B.isWeakSet=oe;function de(Fe){return M(Fe)==="[object ArrayBuffer]"}de.working=typeof ArrayBuffer<"u"&&de(new ArrayBuffer);function me(Fe){return typeof ArrayBuffer>"u"?!1:de.working?de(Fe):Fe instanceof ArrayBuffer}B.isArrayBuffer=me;function ye(Fe){return M(Fe)==="[object DataView]"}ye.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&ye(new DataView(new ArrayBuffer(1),0,1));function ge(Fe){return typeof DataView>"u"?!1:ye.working?ye(Fe):Fe instanceof DataView}B.isDataView=ge;var we=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Te(Fe){return M(Fe)==="[object SharedArrayBuffer]"}function Ee(Fe){return typeof we>"u"?!1:(typeof Te.working>"u"&&(Te.working=Te(new we)),Te.working?Te(Fe):Fe instanceof we)}B.isSharedArrayBuffer=Ee;function De(Fe){return M(Fe)==="[object AsyncFunction]"}B.isAsyncFunction=De;function fe(Fe){return M(Fe)==="[object Map Iterator]"}B.isMapIterator=fe;function Ce(Fe){return M(Fe)==="[object Set Iterator]"}B.isSetIterator=Ce;function Se(Fe){return M(Fe)==="[object Generator]"}B.isGeneratorObject=Se;function be(Fe){return M(Fe)==="[object WebAssembly.Module]"}B.isWebAssemblyCompiledModule=be;function Re(Fe){return j(Fe,N)}B.isNumberObject=Re;function Ve(Fe){return j(Fe,k)}B.isStringObject=Ve;function Pe(Fe){return j(Fe,F)}B.isBooleanObject=Pe;function ke(Fe){return D&&j(Fe,G)}B.isBigIntObject=ke;function Ne(Fe){return I&&j(Fe,V)}B.isSymbolObject=Ne;function Ae(Fe){return Re(Fe)||Ve(Fe)||Pe(Fe)||ke(Fe)||Ne(Fe)}B.isBoxedPrimitive=Ae;function Oe(Fe){return typeof Uint8Array<"u"&&(me(Fe)||Ee(Fe))}B.isAnyArrayBuffer=Oe,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Fe){Object.defineProperty(B,Fe,{enumerable:!1,value:function(){throw new Error(Fe+" is not supported in userland")}})})},{"is-arguments":408,"is-generator-function":411,"is-typed-array":412,"which-typed-array":490}],489:[function(_,w,B){(function(A){(function(){var O=Object.getOwnPropertyDescriptors||function(we){for(var Te=Object.keys(we),Ee={},De=0;De<Te.length;De++)Ee[Te[De]]=Object.getOwnPropertyDescriptor(we,Te[De]);return Ee},R=/%[sdj%]/g;B.format=function(ge){if(!Q(ge)){for(var we=[],Te=0;Te<arguments.length;Te++)we.push(I(arguments[Te]));return we.join(" ")}for(var Te=1,Ee=arguments,De=Ee.length,fe=String(ge).replace(R,function(Se){if(Se==="%%")return"%";if(Te>=De)return Se;switch(Se){case"%s":return String(Ee[Te++]);case"%d":return Number(Ee[Te++]);case"%j":try{return JSON.stringify(Ee[Te++])}catch(be){return"[Circular]"}default:return Se}}),Ce=Ee[Te];Te<De;Ce=Ee[++Te])z(Ce)||!ie(Ce)?fe+=" "+Ce:fe+=" "+I(Ce);return fe},B.deprecate=function(ge,we){if(typeof A<"u"&&A.noDeprecation===!0)return ge;if(typeof A>"u")return function(){return B.deprecate(ge,we).apply(this,arguments)};var Te=!1;function Ee(){if(!Te){if(A.throwDeprecation)throw new Error(we);A.traceDeprecation?console.trace(we):console.error(we),Te=!0}return ge.apply(this,arguments)}return Ee};var P={},E=/^$/;if(A.env.NODE_DEBUG){var D=A.env.NODE_DEBUG;D=D.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),E=new RegExp("^"+D+"$","i")}B.debuglog=function(ge){if(ge=ge.toUpperCase(),!P[ge])if(E.test(ge)){var we=A.pid;P[ge]=function(){var Te=B.format.apply(B,arguments);console.error("%s %d: %s",ge,we,Te)}}else P[ge]=function(){};return P[ge]};function I(ge,we){var Te={seen:[],stylize:N};return arguments.length>=3&&(Te.depth=arguments[2]),arguments.length>=4&&(Te.colors=arguments[3]),Y(we)?Te.showHidden=we:we&&B._extend(Te,we),te(Te.showHidden)&&(Te.showHidden=!1),te(Te.depth)&&(Te.depth=2),te(Te.colors)&&(Te.colors=!1),te(Te.customInspect)&&(Te.customInspect=!0),Te.colors&&(Te.stylize=M),F(Te,ge,Te.depth)}B.inspect=I,I.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},I.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function M(ge,we){var Te=I.styles[we];return Te?"\x1B["+I.colors[Te][0]+"m"+ge+"\x1B["+I.colors[Te][1]+"m":ge}function N(ge,we){return ge}function k(ge){var we={};return ge.forEach(function(Te,Ee){we[Te]=!0}),we}function F(ge,we,Te){if(ge.customInspect&&we&&pe(we.inspect)&&we.inspect!==B.inspect&&!(we.constructor&&we.constructor.prototype===we)){var Ee=we.inspect(Te,ge);return Q(Ee)||(Ee=F(ge,Ee,Te)),Ee}var De=G(ge,we);if(De)return De;var fe=Object.keys(we),Ce=k(fe);if(ge.showHidden&&(fe=Object.getOwnPropertyNames(we)),he(we)&&(fe.indexOf("message")>=0||fe.indexOf("description")>=0))return V(we);if(fe.length===0){if(pe(we)){var Se=we.name?": "+we.name:"";return ge.stylize("[Function"+Se+"]","special")}if(re(we))return ge.stylize(RegExp.prototype.toString.call(we),"regexp");if(ne(we))return ge.stylize(Date.prototype.toString.call(we),"date");if(he(we))return V(we)}var be="",Re=!1,Ve=["{","}"];if(X(we)&&(Re=!0,Ve=["[","]"]),pe(we)){var Pe=we.name?": "+we.name:"";be=" [Function"+Pe+"]"}if(re(we)&&(be=" "+RegExp.prototype.toString.call(we)),ne(we)&&(be=" "+Date.prototype.toUTCString.call(we)),he(we)&&(be=" "+V(we)),fe.length===0&&(!Re||we.length==0))return Ve[0]+be+Ve[1];if(Te<0)return re(we)?ge.stylize(RegExp.prototype.toString.call(we),"regexp"):ge.stylize("[Object]","special");ge.seen.push(we);var ke;return Re?ke=j(ge,we,Te,Ce,fe):ke=fe.map(function(Ne){return H(ge,we,Te,Ce,Ne,Re)}),ge.seen.pop(),U(ke,be,Ve)}function G(ge,we){if(te(we))return ge.stylize("undefined","undefined");if(Q(we)){var Te="'"+JSON.stringify(we).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ge.stylize(Te,"string")}if(Z(we))return ge.stylize(""+we,"number");if(Y(we))return ge.stylize(""+we,"boolean");if(z(we))return ge.stylize("null","null")}function V(ge){return"["+Error.prototype.toString.call(ge)+"]"}function j(ge,we,Te,Ee,De){for(var fe=[],Ce=0,Se=we.length;Ce<Se;++Ce)oe(we,String(Ce))?fe.push(H(ge,we,Te,Ee,String(Ce),!0)):fe.push("");return De.forEach(function(be){be.match(/^\d+$/)||fe.push(H(ge,we,Te,Ee,be,!0))}),fe}function H(ge,we,Te,Ee,De,fe){var Ce,Se,be;if(be=Object.getOwnPropertyDescriptor(we,De)||{value:we[De]},be.get?be.set?Se=ge.stylize("[Getter/Setter]","special"):Se=ge.stylize("[Getter]","special"):be.set&&(Se=ge.stylize("[Setter]","special")),oe(Ee,De)||(Ce="["+De+"]"),Se||(ge.seen.indexOf(be.value)<0?(z(Te)?Se=F(ge,be.value,null):Se=F(ge,be.value,Te-1),Se.indexOf("\n")>-1&&(fe?Se=Se.split("\n").map(function(Re){return"  "+Re}).join("\n").slice(2):Se="\n"+Se.split("\n").map(function(Re){return"   "+Re}).join("\n"))):Se=ge.stylize("[Circular]","special")),te(Ce)){if(fe&&De.match(/^\d+$/))return Se;Ce=JSON.stringify(""+De),Ce.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Ce=Ce.slice(1,-1),Ce=ge.stylize(Ce,"name")):(Ce=Ce.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Ce=ge.stylize(Ce,"string"))}return Ce+": "+Se}function U(ge,we,Te){var Ee=ge.reduce(function(De,fe){return fe.indexOf("\n")>=0,De+fe.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Ee>60?Te[0]+(we===""?"":we+"\n ")+" "+ge.join(",\n  ")+" "+Te[1]:Te[0]+we+" "+ge.join(", ")+" "+Te[1]}B.types=_("./support/types");function X(ge){return Array.isArray(ge)}B.isArray=X;function Y(ge){return typeof ge=="boolean"}B.isBoolean=Y;function z(ge){return ge===null}B.isNull=z;function W(ge){return ge==null}B.isNullOrUndefined=W;function Z(ge){return typeof ge=="number"}B.isNumber=Z;function Q(ge){return typeof ge=="string"}B.isString=Q;function ee(ge){return typeof ge=="symbol"}B.isSymbol=ee;function te(ge){return ge===void 0}B.isUndefined=te;function re(ge){return ie(ge)&&ue(ge)==="[object RegExp]"}B.isRegExp=re,B.types.isRegExp=re;function ie(ge){return typeof ge=="object"&&ge!==null}B.isObject=ie;function ne(ge){return ie(ge)&&ue(ge)==="[object Date]"}B.isDate=ne,B.types.isDate=ne;function he(ge){return ie(ge)&&(ue(ge)==="[object Error]"||ge instanceof Error)}B.isError=he,B.types.isNativeError=he;function pe(ge){return typeof ge=="function"}B.isFunction=pe;function K(ge){return ge===null||typeof ge=="boolean"||typeof ge=="number"||typeof ge=="string"||typeof ge=="symbol"||typeof ge>"u"}B.isPrimitive=K,B.isBuffer=_("./support/isBuffer");function ue(ge){return Object.prototype.toString.call(ge)}function le(ge){return ge<10?"0"+ge.toString(10):ge.toString(10)}var ce=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _e(){var ge=new Date,we=[le(ge.getHours()),le(ge.getMinutes()),le(ge.getSeconds())].join(":");return[ge.getDate(),ce[ge.getMonth()],we].join(" ")}B.log=function(){console.log("%s - %s",_e(),B.format.apply(B,arguments))},B.inherits=_("inherits"),B._extend=function(ge,we){if(!we||!ie(we))return ge;for(var Te=Object.keys(we),Ee=Te.length;Ee--;)ge[Te[Ee]]=we[Te[Ee]];return ge};function oe(ge,we){return Object.prototype.hasOwnProperty.call(ge,we)}var de=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;B.promisify=function(we){if(typeof we!="function")throw new TypeError('The "original" argument must be of type Function');if(de&&we[de]){var Te=we[de];if(typeof Te!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(Te,de,{value:Te,enumerable:!1,writable:!1,configurable:!0}),Te}function Te(){for(var Ee,De,fe=new Promise(function(be,Re){Ee=be,De=Re}),Ce=[],Se=0;Se<arguments.length;Se++)Ce.push(arguments[Se]);Ce.push(function(be,Re){be?De(be):Ee(Re)});try{we.apply(this,Ce)}catch(be){De(be)}return fe}return Object.setPrototypeOf(Te,Object.getPrototypeOf(we)),de&&Object.defineProperty(Te,de,{value:Te,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(Te,O(we))},B.promisify.custom=de;function me(ge,we){if(!ge){var Te=new Error("Promise was rejected with a falsy value");Te.reason=ge,ge=Te}return we(ge)}function ye(ge){if(typeof ge!="function")throw new TypeError('The "original" argument must be of type Function');function we(){for(var Te=[],Ee=0;Ee<arguments.length;Ee++)Te.push(arguments[Ee]);var De=Te.pop();if(typeof De!="function")throw new TypeError("The last argument must be of type Function");var fe=this,Ce=function(){return De.apply(fe,arguments)};ge.apply(this,Te).then(function(Se){A.nextTick(Ce.bind(null,null,Se))},function(Se){A.nextTick(me.bind(null,Se,Ce))})}return Object.setPrototypeOf(we,Object.getPrototypeOf(ge)),Object.defineProperties(we,O(ge)),we}B.callbackify=ye}).call(this)}).call(this,_("_process"))},{"./support/isBuffer":487,"./support/types":488,_process:538,inherits:407}],490:[function(_,w,B){(function(A){(function(){var O=_("for-each"),R=_("available-typed-arrays"),P=_("call-bind"),E=_("call-bind/callBound"),D=_("gopd"),I=E("Object.prototype.toString"),M=_("has-tostringtag/shams")(),N=typeof globalThis>"u"?A:globalThis,k=R(),F=E("String.prototype.slice"),G=Object.getPrototypeOf,V=E("Array.prototype.indexOf",!0)||function(Y,z){for(var W=0;W<Y.length;W+=1)if(Y[W]===z)return W;return-1},j={__proto__:null};M&&D&&G?O(k,function(X){var Y=new N[X];if(Symbol.toStringTag in Y){var z=G(Y),W=D(z,Symbol.toStringTag);if(!W){var Z=G(z);W=D(Z,Symbol.toStringTag)}j["$"+X]=P(W.get)}}):O(k,function(X){var Y=new N[X],z=Y.slice||Y.set;z&&(j["$"+X]=P(z))});var H=function(Y){var z=!1;return O(j,function(W,Z){if(!z)try{"$"+W(Y)===Z&&(z=F(Z,1))}catch(Q){}}),z},U=function(Y){var z=!1;return O(j,function(W,Z){if(!z)try{W(Y),z=F(Z,1)}catch(Q){}}),z};w.exports=function(Y){if(!Y||typeof Y!="object")return!1;if(!M){var z=F(I(Y),8,-1);return V(k,z)>-1?z:z!=="Object"?!1:U(Y)}return D?H(Y):null}}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":99,"call-bind":106,"call-bind/callBound":105,"for-each":387,gopd:391,"has-tostringtag/shams":396}],491:[function(_,w,B){(function(){B.stripBOM=function(A){return A[0]==="\uFEFF"?A.substring(1):A}}).call(this)},{}],492:[function(_,w,B){(function(){var A,O,R,P,E,D={}.hasOwnProperty;A=_("xmlbuilder"),O=_("./defaults").defaults,P=function(I){return typeof I=="string"&&(I.indexOf("&")>=0||I.indexOf(">")>=0||I.indexOf("<")>=0)},E=function(I){return"<![CDATA["+R(I)+"]]>"},R=function(I){return I.replace("]]>","]]]]><![CDATA[>")},B.Builder=function(){function I(M){var N,k,F;this.options={},k=O["0.2"];for(N in k)D.call(k,N)&&(F=k[N],this.options[N]=F);for(N in M)D.call(M,N)&&(F=M[N],this.options[N]=F)}return I.prototype.buildObject=function(M){var N,k,F,G,V;return N=this.options.attrkey,k=this.options.charkey,Object.keys(M).length===1&&this.options.rootName===O["0.2"].rootName?(V=Object.keys(M)[0],M=M[V]):V=this.options.rootName,F=function(j){return function(H,U){var X,Y,z,W,Z,Q;if(typeof U!="object")j.options.cdata&&P(U)?H.raw(E(U)):H.txt(U);else if(Array.isArray(U)){for(W in U)if(D.call(U,W)){Y=U[W];for(Z in Y)z=Y[Z],H=F(H.ele(Z),z).up()}}else for(Z in U)if(D.call(U,Z))if(Y=U[Z],Z===N){if(typeof Y=="object")for(X in Y)Q=Y[X],H=H.att(X,Q)}else if(Z===k)j.options.cdata&&P(Y)?H=H.raw(E(Y)):H=H.txt(Y);else if(Array.isArray(Y))for(W in Y)D.call(Y,W)&&(z=Y[W],typeof z=="string"?j.options.cdata&&P(z)?H=H.ele(Z).raw(E(z)).up():H=H.ele(Z,z).up():H=F(H.ele(Z),z).up());else typeof Y=="object"?H=F(H.ele(Z),Y).up():typeof Y=="string"&&j.options.cdata&&P(Y)?H=H.ele(Z).raw(E(Y)).up():(Y==null&&(Y=""),H=H.ele(Z,Y.toString()).up());return H}}(this),G=A.create(V,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),F(G,M).end(this.options.renderOpts)},I}()}).call(this)},{"./defaults":493,xmlbuilder:529}],493:[function(_,w,B){(function(){B.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},{}],494:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M,N,k=function(V,j){return function(){return V.apply(j,arguments)}},F=function(V,j){for(var H in j)G.call(j,H)&&(V[H]=j[H]);function U(){this.constructor=V}return U.prototype=j.prototype,V.prototype=new U,V.__super__=j.prototype,V},G={}.hasOwnProperty;M=_("sax"),P=_("events"),A=_("./bom"),I=_("./processors"),N=_("timers").setImmediate,O=_("./defaults").defaults,E=function(V){return typeof V=="object"&&V!=null&&Object.keys(V).length===0},D=function(V,j,H){var U,X,Y;for(U=0,X=V.length;U<X;U++)Y=V[U],j=Y(j,H);return j},R=function(V,j,H){var U;return U=Object.create(null),U.value=H,U.writable=!0,U.enumerable=!0,U.configurable=!0,Object.defineProperty(V,j,U)},B.Parser=function(V){F(j,V);function j(H){this.parseStringPromise=k(this.parseStringPromise,this),this.parseString=k(this.parseString,this),this.reset=k(this.reset,this),this.assignOrPush=k(this.assignOrPush,this),this.processAsync=k(this.processAsync,this);var U,X,Y;if(!(this instanceof B.Parser))return new B.Parser(H);this.options={},X=O["0.2"];for(U in X)G.call(X,U)&&(Y=X[U],this.options[U]=Y);for(U in H)G.call(H,U)&&(Y=H[U],this.options[U]=Y);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(I.normalize)),this.reset()}return j.prototype.processAsync=function(){var H,U;try{return this.remaining.length<=this.options.chunkSize?(H=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(H),this.saxParser.close()):(H=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(H),N(this.processAsync))}catch(X){if(U=X,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(U)}},j.prototype.assignOrPush=function(H,U,X){return U in H?(H[U]instanceof Array||R(H,U,[H[U]]),H[U].push(X)):this.options.explicitArray?R(H,U,[X]):R(H,U,X)},j.prototype.reset=function(){var H,U,X,Y;return this.removeAllListeners(),this.saxParser=M.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(z){return function(W){if(z.saxParser.resume(),!z.saxParser.errThrown)return z.saxParser.errThrown=!0,z.emit("error",W)}}(this),this.saxParser.onend=function(z){return function(){if(!z.saxParser.ended)return z.saxParser.ended=!0,z.emit("end",z.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,Y=[],H=this.options.attrkey,U=this.options.charkey,this.saxParser.onopentag=function(z){return function(W){var Z,Q,ee,te,re;if(ee={},ee[U]="",!z.options.ignoreAttrs){re=W.attributes;for(Z in re)G.call(re,Z)&&(!(H in ee)&&!z.options.mergeAttrs&&(ee[H]={}),Q=z.options.attrValueProcessors?D(z.options.attrValueProcessors,W.attributes[Z],Z):W.attributes[Z],te=z.options.attrNameProcessors?D(z.options.attrNameProcessors,Z):Z,z.options.mergeAttrs?z.assignOrPush(ee,te,Q):R(ee[H],te,Q))}return ee["#name"]=z.options.tagNameProcessors?D(z.options.tagNameProcessors,W.name):W.name,z.options.xmlns&&(ee[z.options.xmlnskey]={uri:W.uri,local:W.local}),Y.push(ee)}}(this),this.saxParser.onclosetag=function(z){return function(){var W,Z,Q,ee,te,re,ie,ne,he,pe;if(re=Y.pop(),te=re["#name"],(!z.options.explicitChildren||!z.options.preserveChildrenOrder)&&delete re["#name"],re.cdata===!0&&(W=re.cdata,delete re.cdata),he=Y[Y.length-1],re[U].match(/^\s*$/)&&!W?(Z=re[U],delete re[U]):(z.options.trim&&(re[U]=re[U].trim()),z.options.normalize&&(re[U]=re[U].replace(/\s{2,}/g," ").trim()),re[U]=z.options.valueProcessors?D(z.options.valueProcessors,re[U],te):re[U],Object.keys(re).length===1&&U in re&&!z.EXPLICIT_CHARKEY&&(re=re[U])),E(re)&&(typeof z.options.emptyTag=="function"?re=z.options.emptyTag():re=z.options.emptyTag!==""?z.options.emptyTag:Z),z.options.validator!=null&&(pe="/"+function(){var K,ue,le;for(le=[],K=0,ue=Y.length;K<ue;K++)ee=Y[K],le.push(ee["#name"]);return le}().concat(te).join("/"),function(){var K;try{return re=z.options.validator(pe,he&&he[te],re)}catch(ue){return K=ue,z.emit("error",K)}}()),z.options.explicitChildren&&!z.options.mergeAttrs&&typeof re=="object"){if(!z.options.preserveChildrenOrder)ee={},z.options.attrkey in re&&(ee[z.options.attrkey]=re[z.options.attrkey],delete re[z.options.attrkey]),!z.options.charsAsChildren&&z.options.charkey in re&&(ee[z.options.charkey]=re[z.options.charkey],delete re[z.options.charkey]),Object.getOwnPropertyNames(re).length>0&&(ee[z.options.childkey]=re),re=ee;else if(he){he[z.options.childkey]=he[z.options.childkey]||[],ie={};for(Q in re)G.call(re,Q)&&R(ie,Q,re[Q]);he[z.options.childkey].push(ie),delete re["#name"],Object.keys(re).length===1&&U in re&&!z.EXPLICIT_CHARKEY&&(re=re[U])}}return Y.length>0?z.assignOrPush(he,te,re):(z.options.explicitRoot&&(ne=re,re={},R(re,te,ne)),z.resultObject=re,z.saxParser.ended=!0,z.emit("end",z.resultObject))}}(this),X=function(z){return function(W){var Z,Q;if(Q=Y[Y.length-1],Q)return Q[U]+=W,z.options.explicitChildren&&z.options.preserveChildrenOrder&&z.options.charsAsChildren&&(z.options.includeWhiteChars||W.replace(/\\n/g,"").trim()!=="")&&(Q[z.options.childkey]=Q[z.options.childkey]||[],Z={"#name":"__text__"},Z[U]=W,z.options.normalize&&(Z[U]=Z[U].replace(/\s{2,}/g," ").trim()),Q[z.options.childkey].push(Z)),Q}}(this),this.saxParser.ontext=X,this.saxParser.oncdata=function(z){return function(W){var Z;if(Z=X(W),Z)return Z.cdata=!0}}()},j.prototype.parseString=function(H,U){var X;U!=null&&typeof U=="function"&&(this.on("end",function(Y){return this.reset(),U(null,Y)}),this.on("error",function(Y){return this.reset(),U(Y)}));try{return H=H.toString(),H.trim()===""?(this.emit("end",null),!0):(H=A.stripBOM(H),this.options.async?(this.remaining=H,N(this.processAsync),this.saxParser):this.saxParser.write(H).close())}catch(Y){if(X=Y,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw X}else return this.emit("error",X),this.saxParser.errThrown=!0}},j.prototype.parseStringPromise=function(H){return new Promise(function(U){return function(X,Y){return U.parseString(H,function(z,W){return z?Y(z):X(W)})}}(this))},j}(P),B.parseString=function(V,j,H){var U,X,Y;return H!=null?(typeof H=="function"&&(U=H),typeof j=="object"&&(X=j)):(typeof j=="function"&&(U=j),X={}),Y=new B.Parser(X),Y.parseString(V,U)},B.parseStringPromise=function(V,j){var H,U;return typeof j=="object"&&(H=j),U=new B.Parser(H),U.parseStringPromise(V)}}).call(this)},{"./bom":491,"./defaults":493,"./processors":495,events:386,sax:465,timers:484}],495:[function(_,w,B){(function(){var A;A=new RegExp(/(?!xmlns)^.*:/),B.normalize=function(O){return O.toLowerCase()},B.firstCharLowerCase=function(O){return O.charAt(0).toLowerCase()+O.slice(1)},B.stripPrefix=function(O){return O.replace(A,"")},B.parseNumbers=function(O){return isNaN(O)||(O=O%1===0?parseInt(O,10):parseFloat(O)),O},B.parseBooleans=function(O){return/^(?:true|false)$/i.test(O)&&(O=O.toLowerCase()==="true"),O}}).call(this)},{}],496:[function(_,w,B){(function(){var A,O,R,P,E=function(I,M){for(var N in M)D.call(M,N)&&(I[N]=M[N]);function k(){this.constructor=I}return k.prototype=M.prototype,I.prototype=new k,I.__super__=M.prototype,I},D={}.hasOwnProperty;O=_("./defaults"),A=_("./builder"),R=_("./parser"),P=_("./processors"),B.defaults=O.defaults,B.processors=P,B.ValidationError=function(I){E(M,I);function M(N){this.message=N}return M}(Error),B.Builder=A.Builder,B.Parser=R.Parser,B.parseString=R.parseString,B.parseStringPromise=R.parseStringPromise}).call(this)},{"./builder":492,"./defaults":493,"./parser":494,"./processors":495}],497:[function(_,w,B){(function(){w.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},{}],498:[function(_,w,B){(function(){w.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},{}],499:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M=[].slice,N={}.hasOwnProperty;A=function(){var k,F,G,V,j,H;if(H=arguments[0],j=2<=arguments.length?M.call(arguments,1):[],E(Object.assign))Object.assign.apply(null,arguments);else for(k=0,G=j.length;k<G;k++)if(V=j[k],V!=null)for(F in V)N.call(V,F)&&(H[F]=V[F]);return H},E=function(k){return!!k&&Object.prototype.toString.call(k)==="[object Function]"},D=function(k){var F;return!!k&&((F=typeof k)=="function"||F==="object")},R=function(k){return E(Array.isArray)?Array.isArray(k):Object.prototype.toString.call(k)==="[object Array]"},P=function(k){var F;if(R(k))return!k.length;for(F in k)if(N.call(k,F))return!1;return!0},I=function(k){var F,G;return D(k)&&(G=Object.getPrototypeOf(k))&&(F=G.constructor)&&typeof F=="function"&&F instanceof F&&Function.prototype.toString.call(F)===Function.prototype.toString.call(Object)},O=function(k){return E(k.valueOf)?k.valueOf():k},w.exports.assign=A,w.exports.isFunction=E,w.exports.isObject=D,w.exports.isArray=R,w.exports.isEmpty=P,w.exports.isPlainObject=I,w.exports.getValue=O}).call(this)},{}],500:[function(_,w,B){(function(){w.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},{}],501:[function(_,w,B){(function(){var A;A=_("./NodeType"),_("./XMLNode"),w.exports=function(){function O(R,P,E){if(this.parent=R,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),P==null)throw new Error("Missing attribute name. "+this.debugInfo(P));this.name=this.stringify.name(P),this.value=this.stringify.attValue(E),this.type=A.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(O.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(O.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(O.prototype,"textContent",{get:function(){return this.value},set:function(R){return this.value=R||""}}),Object.defineProperty(O.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(O.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(O.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(O.prototype,"specified",{get:function(){return!0}}),O.prototype.clone=function(){return Object.create(this)},O.prototype.toString=function(R){return this.options.writer.attribute(this,this.options.writer.filterOptions(R))},O.prototype.debugInfo=function(R){return R=R||this.name,R==null?"parent: <"+this.parent.name+">":"attribute: {"+R+"}, parent: <"+this.parent.name+">"},O.prototype.isEqualNode=function(R){return!(R.namespaceURI!==this.namespaceURI||R.prefix!==this.prefix||R.localName!==this.localName||R.value!==this.value)},O}()}).call(this)},{"./NodeType":498,"./XMLNode":520}],502:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;A=_("./NodeType"),O=_("./XMLCharacterData"),w.exports=function(E){R(D,E);function D(I,M){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=A.CData,this.value=this.stringify.cdata(M)}return D.prototype.clone=function(){return Object.create(this)},D.prototype.toString=function(I){return this.options.writer.cdata(this,this.options.writer.filterOptions(I))},D}(O)}).call(this)},{"./NodeType":498,"./XMLCharacterData":503}],503:[function(_,w,B){(function(){var A,O=function(P,E){for(var D in E)R.call(E,D)&&(P[D]=E[D]);function I(){this.constructor=P}return I.prototype=E.prototype,P.prototype=new I,P.__super__=E.prototype,P},R={}.hasOwnProperty;A=_("./XMLNode"),w.exports=function(P){O(E,P);function E(D){E.__super__.constructor.call(this,D),this.value=""}return Object.defineProperty(E.prototype,"data",{get:function(){return this.value},set:function(D){return this.value=D||""}}),Object.defineProperty(E.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(E.prototype,"textContent",{get:function(){return this.value},set:function(D){return this.value=D||""}}),E.prototype.clone=function(){return Object.create(this)},E.prototype.substringData=function(D,I){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.appendData=function(D){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.insertData=function(D,I){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.deleteData=function(D,I){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.replaceData=function(D,I,M){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.isEqualNode=function(D){return!(!E.__super__.isEqualNode.apply(this,arguments).isEqualNode(D)||D.data!==this.data)},E}(A)}).call(this)},{"./XMLNode":520}],504:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;A=_("./NodeType"),O=_("./XMLCharacterData"),w.exports=function(E){R(D,E);function D(I,M){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=A.Comment,this.value=this.stringify.comment(M)}return D.prototype.clone=function(){return Object.create(this)},D.prototype.toString=function(I){return this.options.writer.comment(this,this.options.writer.filterOptions(I))},D}(O)}).call(this)},{"./NodeType":498,"./XMLCharacterData":503}],505:[function(_,w,B){(function(){var A,O;A=_("./XMLDOMErrorHandler"),O=_("./XMLDOMStringList"),w.exports=function(){function R(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new A,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(R.prototype,"parameterNames",{get:function(){return new O(Object.keys(this.defaultParams))}}),R.prototype.getParameter=function(P){return this.params.hasOwnProperty(P)?this.params[P]:null},R.prototype.canSetParameter=function(P,E){return!0},R.prototype.setParameter=function(P,E){return E!=null?this.params[P]=E:delete this.params[P]},R}()}).call(this)},{"./XMLDOMErrorHandler":506,"./XMLDOMStringList":508}],506:[function(_,w,B){(function(){w.exports=function(){function A(){}return A.prototype.handleError=function(O){throw new Error(O)},A}()}).call(this)},{}],507:[function(_,w,B){(function(){w.exports=function(){function A(){}return A.prototype.hasFeature=function(O,R){return!0},A.prototype.createDocumentType=function(O,R,P){throw new Error("This DOM method is not implemented.")},A.prototype.createDocument=function(O,R,P){throw new Error("This DOM method is not implemented.")},A.prototype.createHTMLDocument=function(O){throw new Error("This DOM method is not implemented.")},A.prototype.getFeature=function(O,R){throw new Error("This DOM method is not implemented.")},A}()}).call(this)},{}],508:[function(_,w,B){(function(){w.exports=function(){function A(O){this.arr=O||[]}return Object.defineProperty(A.prototype,"length",{get:function(){return this.arr.length}}),A.prototype.item=function(O){return this.arr[O]||null},A.prototype.contains=function(O){return this.arr.indexOf(O)!==-1},A}()}).call(this)},{}],509:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;O=_("./XMLNode"),A=_("./NodeType"),w.exports=function(E){R(D,E);function D(I,M,N,k,F,G){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(N==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(M));if(!k)throw new Error("Missing DTD attribute type. "+this.debugInfo(M));if(!F)throw new Error("Missing DTD attribute default. "+this.debugInfo(M));if(F.indexOf("#")!==0&&(F="#"+F),!F.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(M));if(G&&!F.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(M));this.elementName=this.stringify.name(M),this.type=A.AttributeDeclaration,this.attributeName=this.stringify.name(N),this.attributeType=this.stringify.dtdAttType(k),G&&(this.defaultValue=this.stringify.dtdAttDefault(G)),this.defaultValueType=F}return D.prototype.toString=function(I){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(I))},D}(O)}).call(this)},{"./NodeType":498,"./XMLNode":520}],510:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;O=_("./XMLNode"),A=_("./NodeType"),w.exports=function(E){R(D,E);function D(I,M,N){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing DTD element name. "+this.debugInfo());N||(N="(#PCDATA)"),Array.isArray(N)&&(N="("+N.join(",")+")"),this.name=this.stringify.name(M),this.type=A.ElementDeclaration,this.value=this.stringify.dtdElementValue(N)}return D.prototype.toString=function(I){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(I))},D}(O)}).call(this)},{"./NodeType":498,"./XMLNode":520}],511:[function(_,w,B){(function(){var A,O,R,P=function(D,I){for(var M in I)E.call(I,M)&&(D[M]=I[M]);function N(){this.constructor=D}return N.prototype=I.prototype,D.prototype=new N,D.__super__=I.prototype,D},E={}.hasOwnProperty;R=_("./Utility").isObject,O=_("./XMLNode"),A=_("./NodeType"),w.exports=function(D){P(I,D);function I(M,N,k,F){if(I.__super__.constructor.call(this,M),k==null)throw new Error("Missing DTD entity name. "+this.debugInfo(k));if(F==null)throw new Error("Missing DTD entity value. "+this.debugInfo(k));if(this.pe=!!N,this.name=this.stringify.name(k),this.type=A.EntityDeclaration,!R(F))this.value=this.stringify.dtdEntityValue(F),this.internal=!0;else{if(!F.pubID&&!F.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(k));if(F.pubID&&!F.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(k));if(this.internal=!1,F.pubID!=null&&(this.pubID=this.stringify.dtdPubID(F.pubID)),F.sysID!=null&&(this.sysID=this.stringify.dtdSysID(F.sysID)),F.nData!=null&&(this.nData=this.stringify.dtdNData(F.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(k))}}return Object.defineProperty(I.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(I.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(I.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(I.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(I.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(I.prototype,"xmlVersion",{get:function(){return null}}),I.prototype.toString=function(M){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(M))},I}(O)}).call(this)},{"./NodeType":498,"./Utility":499,"./XMLNode":520}],512:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;O=_("./XMLNode"),A=_("./NodeType"),w.exports=function(E){R(D,E);function D(I,M,N){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing DTD notation name. "+this.debugInfo(M));if(!N.pubID&&!N.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(M));this.name=this.stringify.name(M),this.type=A.NotationDeclaration,N.pubID!=null&&(this.pubID=this.stringify.dtdPubID(N.pubID)),N.sysID!=null&&(this.sysID=this.stringify.dtdSysID(N.sysID))}return Object.defineProperty(D.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(D.prototype,"systemId",{get:function(){return this.sysID}}),D.prototype.toString=function(I){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(I))},D}(O)}).call(this)},{"./NodeType":498,"./XMLNode":520}],513:[function(_,w,B){(function(){var A,O,R,P=function(D,I){for(var M in I)E.call(I,M)&&(D[M]=I[M]);function N(){this.constructor=D}return N.prototype=I.prototype,D.prototype=new N,D.__super__=I.prototype,D},E={}.hasOwnProperty;R=_("./Utility").isObject,O=_("./XMLNode"),A=_("./NodeType"),w.exports=function(D){P(I,D);function I(M,N,k,F){var G;I.__super__.constructor.call(this,M),R(N)&&(G=N,N=G.version,k=G.encoding,F=G.standalone),N||(N="1.0"),this.type=A.Declaration,this.version=this.stringify.xmlVersion(N),k!=null&&(this.encoding=this.stringify.xmlEncoding(k)),F!=null&&(this.standalone=this.stringify.xmlStandalone(F))}return I.prototype.toString=function(M){return this.options.writer.declaration(this,this.options.writer.filterOptions(M))},I}(O)}).call(this)},{"./NodeType":498,"./Utility":499,"./XMLNode":520}],514:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M,N=function(F,G){for(var V in G)k.call(G,V)&&(F[V]=G[V]);function j(){this.constructor=F}return j.prototype=G.prototype,F.prototype=new j,F.__super__=G.prototype,F},k={}.hasOwnProperty;M=_("./Utility").isObject,I=_("./XMLNode"),A=_("./NodeType"),O=_("./XMLDTDAttList"),P=_("./XMLDTDEntity"),R=_("./XMLDTDElement"),E=_("./XMLDTDNotation"),D=_("./XMLNamedNodeMap"),w.exports=function(F){N(G,F);function G(V,j,H){var U,X,Y,z,W,Z;if(G.__super__.constructor.call(this,V),this.type=A.DocType,V.children){for(z=V.children,X=0,Y=z.length;X<Y;X++)if(U=z[X],U.type===A.Element){this.name=U.name;break}}this.documentObject=V,M(j)&&(W=j,j=W.pubID,H=W.sysID),H==null&&(Z=[j,H],H=Z[0],j=Z[1]),j!=null&&(this.pubID=this.stringify.dtdPubID(j)),H!=null&&(this.sysID=this.stringify.dtdSysID(H))}return Object.defineProperty(G.prototype,"entities",{get:function(){var V,j,H,U,X;for(U={},X=this.children,j=0,H=X.length;j<H;j++)V=X[j],V.type===A.EntityDeclaration&&!V.pe&&(U[V.name]=V);return new D(U)}}),Object.defineProperty(G.prototype,"notations",{get:function(){var V,j,H,U,X;for(U={},X=this.children,j=0,H=X.length;j<H;j++)V=X[j],V.type===A.NotationDeclaration&&(U[V.name]=V);return new D(U)}}),Object.defineProperty(G.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(G.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(G.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),G.prototype.element=function(V,j){var H;return H=new R(this,V,j),this.children.push(H),this},G.prototype.attList=function(V,j,H,U,X){var Y;return Y=new O(this,V,j,H,U,X),this.children.push(Y),this},G.prototype.entity=function(V,j){var H;return H=new P(this,!1,V,j),this.children.push(H),this},G.prototype.pEntity=function(V,j){var H;return H=new P(this,!0,V,j),this.children.push(H),this},G.prototype.notation=function(V,j){var H;return H=new E(this,V,j),this.children.push(H),this},G.prototype.toString=function(V){return this.options.writer.docType(this,this.options.writer.filterOptions(V))},G.prototype.ele=function(V,j){return this.element(V,j)},G.prototype.att=function(V,j,H,U,X){return this.attList(V,j,H,U,X)},G.prototype.ent=function(V,j){return this.entity(V,j)},G.prototype.pent=function(V,j){return this.pEntity(V,j)},G.prototype.not=function(V,j){return this.notation(V,j)},G.prototype.up=function(){return this.root()||this.documentObject},G.prototype.isEqualNode=function(V){return!(!G.__super__.isEqualNode.apply(this,arguments).isEqualNode(V)||V.name!==this.name||V.publicId!==this.publicId||V.systemId!==this.systemId)},G}(I)}).call(this)},{"./NodeType":498,"./Utility":499,"./XMLDTDAttList":509,"./XMLDTDElement":510,"./XMLDTDEntity":511,"./XMLDTDNotation":512,"./XMLNamedNodeMap":519,"./XMLNode":520}],515:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M=function(k,F){for(var G in F)N.call(F,G)&&(k[G]=F[G]);function V(){this.constructor=k}return V.prototype=F.prototype,k.prototype=new V,k.__super__=F.prototype,k},N={}.hasOwnProperty;I=_("./Utility").isPlainObject,R=_("./XMLDOMImplementation"),O=_("./XMLDOMConfiguration"),P=_("./XMLNode"),A=_("./NodeType"),D=_("./XMLStringifier"),E=_("./XMLStringWriter"),w.exports=function(k){M(F,k);function F(G){F.__super__.constructor.call(this,null),this.name="#document",this.type=A.Document,this.documentURI=null,this.domConfig=new O,G||(G={}),G.writer||(G.writer=new E),this.options=G,this.stringify=new D(G)}return Object.defineProperty(F.prototype,"implementation",{value:new R}),Object.defineProperty(F.prototype,"doctype",{get:function(){var G,V,j,H;for(H=this.children,V=0,j=H.length;V<j;V++)if(G=H[V],G.type===A.DocType)return G;return null}}),Object.defineProperty(F.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(F.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(F.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(F.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===A.Declaration?this.children[0].encoding:null}}),Object.defineProperty(F.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===A.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(F.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===A.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(F.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(F.prototype,"origin",{get:function(){return null}}),Object.defineProperty(F.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(F.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(F.prototype,"contentType",{get:function(){return null}}),F.prototype.end=function(G){var V;return V={},G?I(G)&&(V=G,G=this.options.writer):G=this.options.writer,G.document(this,G.filterOptions(V))},F.prototype.toString=function(G){return this.options.writer.document(this,this.options.writer.filterOptions(G))},F.prototype.createElement=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createTextNode=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createComment=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createCDATASection=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createProcessingInstruction=function(G,V){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createAttribute=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createEntityReference=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.getElementsByTagName=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.importNode=function(G,V){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createElementNS=function(G,V){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createAttributeNS=function(G,V){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.getElementsByTagNameNS=function(G,V){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.getElementById=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.adoptNode=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.renameNode=function(G,V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.getElementsByClassName=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createEvent=function(G){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createNodeIterator=function(G,V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},F.prototype.createTreeWalker=function(G,V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},F}(P)}).call(this)},{"./NodeType":498,"./Utility":499,"./XMLDOMConfiguration":505,"./XMLDOMImplementation":507,"./XMLNode":520,"./XMLStringWriter":525,"./XMLStringifier":526}],516:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M,N,k,F,G,V,j,H,U,X,Y,z,W,Z,Q,ee,te={}.hasOwnProperty;ee=_("./Utility"),Z=ee.isObject,W=ee.isFunction,Q=ee.isPlainObject,z=ee.getValue,A=_("./NodeType"),G=_("./XMLDocument"),V=_("./XMLElement"),P=_("./XMLCData"),E=_("./XMLComment"),H=_("./XMLRaw"),Y=_("./XMLText"),j=_("./XMLProcessingInstruction"),k=_("./XMLDeclaration"),F=_("./XMLDocType"),D=_("./XMLDTDAttList"),M=_("./XMLDTDEntity"),I=_("./XMLDTDElement"),N=_("./XMLDTDNotation"),R=_("./XMLAttribute"),X=_("./XMLStringifier"),U=_("./XMLStringWriter"),O=_("./WriterState"),w.exports=function(){function re(ie,ne,he){var pe;this.name="?xml",this.type=A.Document,ie||(ie={}),pe={},ie.writer?Q(ie.writer)&&(pe=ie.writer,ie.writer=new U):ie.writer=new U,this.options=ie,this.writer=ie.writer,this.writerOptions=this.writer.filterOptions(pe),this.stringify=new X(ie),this.onDataCallback=ne||function(){},this.onEndCallback=he||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return re.prototype.createChildNode=function(ie){var ne,he,pe,K,ue,le,ce,_e;switch(ie.type){case A.CData:this.cdata(ie.value);break;case A.Comment:this.comment(ie.value);break;case A.Element:pe={},ce=ie.attribs;for(he in ce)te.call(ce,he)&&(ne=ce[he],pe[he]=ne.value);this.node(ie.name,pe);break;case A.Dummy:this.dummy();break;case A.Raw:this.raw(ie.value);break;case A.Text:this.text(ie.value);break;case A.ProcessingInstruction:this.instruction(ie.target,ie.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+ie.constructor.name)}for(_e=ie.children,ue=0,le=_e.length;ue<le;ue++)K=_e[ue],this.createChildNode(K),K.type===A.Element&&this.up();return this},re.prototype.dummy=function(){return this},re.prototype.node=function(ie,ne,he){var pe;if(ie==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(ie));return this.openCurrent(),ie=z(ie),ne==null&&(ne={}),ne=z(ne),Z(ne)||(pe=[ne,he],he=pe[0],ne=pe[1]),this.currentNode=new V(this,ie,ne),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,he!=null&&this.text(he),this},re.prototype.element=function(ie,ne,he){var pe,K,ue,le,ce,_e;if(this.currentNode&&this.currentNode.type===A.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(ie)||Z(ie)||W(ie))for(le=this.options.noValidation,this.options.noValidation=!0,_e=new G(this.options).element("TEMP_ROOT"),_e.element(ie),this.options.noValidation=le,ce=_e.children,K=0,ue=ce.length;K<ue;K++)pe=ce[K],this.createChildNode(pe),pe.type===A.Element&&this.up();else this.node(ie,ne,he);return this},re.prototype.attribute=function(ie,ne){var he,pe;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(ie));if(ie!=null&&(ie=z(ie)),Z(ie))for(he in ie)te.call(ie,he)&&(pe=ie[he],this.attribute(he,pe));else W(ne)&&(ne=ne.apply()),this.options.keepNullAttributes&&ne==null?this.currentNode.attribs[ie]=new R(this,ie,""):ne!=null&&(this.currentNode.attribs[ie]=new R(this,ie,ne));return this},re.prototype.text=function(ie){var ne;return this.openCurrent(),ne=new Y(this,ie),this.onData(this.writer.text(ne,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.cdata=function(ie){var ne;return this.openCurrent(),ne=new P(this,ie),this.onData(this.writer.cdata(ne,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.comment=function(ie){var ne;return this.openCurrent(),ne=new E(this,ie),this.onData(this.writer.comment(ne,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.raw=function(ie){var ne;return this.openCurrent(),ne=new H(this,ie),this.onData(this.writer.raw(ne,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.instruction=function(ie,ne){var he,pe,K,ue,le;if(this.openCurrent(),ie!=null&&(ie=z(ie)),ne!=null&&(ne=z(ne)),Array.isArray(ie))for(he=0,ue=ie.length;he<ue;he++)pe=ie[he],this.instruction(pe);else if(Z(ie))for(pe in ie)te.call(ie,pe)&&(K=ie[pe],this.instruction(pe,K));else W(ne)&&(ne=ne.apply()),le=new j(this,ie,ne),this.onData(this.writer.processingInstruction(le,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},re.prototype.declaration=function(ie,ne,he){var pe;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return pe=new k(this,ie,ne,he),this.onData(this.writer.declaration(pe,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.doctype=function(ie,ne,he){if(this.openCurrent(),ie==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new F(this,ne,he),this.currentNode.rootNodeName=ie,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},re.prototype.dtdElement=function(ie,ne){var he;return this.openCurrent(),he=new I(this,ie,ne),this.onData(this.writer.dtdElement(he,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.attList=function(ie,ne,he,pe,K){var ue;return this.openCurrent(),ue=new D(this,ie,ne,he,pe,K),this.onData(this.writer.dtdAttList(ue,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.entity=function(ie,ne){var he;return this.openCurrent(),he=new M(this,!1,ie,ne),this.onData(this.writer.dtdEntity(he,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.pEntity=function(ie,ne){var he;return this.openCurrent(),he=new M(this,!0,ie,ne),this.onData(this.writer.dtdEntity(he,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.notation=function(ie,ne){var he;return this.openCurrent(),he=new N(this,ie,ne),this.onData(this.writer.dtdNotation(he,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},re.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},re.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},re.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},re.prototype.openNode=function(ie){var ne,he,pe,K;if(!ie.isOpen){if(!this.root&&this.currentLevel===0&&ie.type===A.Element&&(this.root=ie),he="",ie.type===A.Element){this.writerOptions.state=O.OpenTag,he=this.writer.indent(ie,this.writerOptions,this.currentLevel)+"<"+ie.name,K=ie.attribs;for(pe in K)te.call(K,pe)&&(ne=K[pe],he+=this.writer.attribute(ne,this.writerOptions,this.currentLevel));he+=(ie.children?">":"/>")+this.writer.endline(ie,this.writerOptions,this.currentLevel),this.writerOptions.state=O.InsideTag}else this.writerOptions.state=O.OpenTag,he=this.writer.indent(ie,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+ie.rootNodeName,ie.pubID&&ie.sysID?he+=' PUBLIC "'+ie.pubID+'" "'+ie.sysID+'"':ie.sysID&&(he+=' SYSTEM "'+ie.sysID+'"'),ie.children?(he+=" [",this.writerOptions.state=O.InsideTag):(this.writerOptions.state=O.CloseTag,he+=">"),he+=this.writer.endline(ie,this.writerOptions,this.currentLevel);return this.onData(he,this.currentLevel),ie.isOpen=!0}},re.prototype.closeNode=function(ie){var ne;if(!ie.isClosed)return ne="",this.writerOptions.state=O.CloseTag,ie.type===A.Element?ne=this.writer.indent(ie,this.writerOptions,this.currentLevel)+"</"+ie.name+">"+this.writer.endline(ie,this.writerOptions,this.currentLevel):ne=this.writer.indent(ie,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(ie,this.writerOptions,this.currentLevel),this.writerOptions.state=O.None,this.onData(ne,this.currentLevel),ie.isClosed=!0},re.prototype.onData=function(ie,ne){return this.documentStarted=!0,this.onDataCallback(ie,ne+1)},re.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},re.prototype.debugInfo=function(ie){return ie==null?"":"node: <"+ie+">"},re.prototype.ele=function(){return this.element.apply(this,arguments)},re.prototype.nod=function(ie,ne,he){return this.node(ie,ne,he)},re.prototype.txt=function(ie){return this.text(ie)},re.prototype.dat=function(ie){return this.cdata(ie)},re.prototype.com=function(ie){return this.comment(ie)},re.prototype.ins=function(ie,ne){return this.instruction(ie,ne)},re.prototype.dec=function(ie,ne,he){return this.declaration(ie,ne,he)},re.prototype.dtd=function(ie,ne,he){return this.doctype(ie,ne,he)},re.prototype.e=function(ie,ne,he){return this.element(ie,ne,he)},re.prototype.n=function(ie,ne,he){return this.node(ie,ne,he)},re.prototype.t=function(ie){return this.text(ie)},re.prototype.d=function(ie){return this.cdata(ie)},re.prototype.c=function(ie){return this.comment(ie)},re.prototype.r=function(ie){return this.raw(ie)},re.prototype.i=function(ie,ne){return this.instruction(ie,ne)},re.prototype.att=function(){return this.currentNode&&this.currentNode.type===A.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},re.prototype.a=function(){return this.currentNode&&this.currentNode.type===A.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},re.prototype.ent=function(ie,ne){return this.entity(ie,ne)},re.prototype.pent=function(ie,ne){return this.pEntity(ie,ne)},re.prototype.not=function(ie,ne){return this.notation(ie,ne)},re}()}).call(this)},{"./NodeType":498,"./Utility":499,"./WriterState":500,"./XMLAttribute":501,"./XMLCData":502,"./XMLComment":504,"./XMLDTDAttList":509,"./XMLDTDElement":510,"./XMLDTDEntity":511,"./XMLDTDNotation":512,"./XMLDeclaration":513,"./XMLDocType":514,"./XMLDocument":515,"./XMLElement":518,"./XMLProcessingInstruction":522,"./XMLRaw":523,"./XMLStringWriter":525,"./XMLStringifier":526,"./XMLText":527}],517:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;O=_("./XMLNode"),A=_("./NodeType"),w.exports=function(E){R(D,E);function D(I){D.__super__.constructor.call(this,I),this.type=A.Dummy}return D.prototype.clone=function(){return Object.create(this)},D.prototype.toString=function(I){return""},D}(O)}).call(this)},{"./NodeType":498,"./XMLNode":520}],518:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M,N=function(F,G){for(var V in G)k.call(G,V)&&(F[V]=G[V]);function j(){this.constructor=F}return j.prototype=G.prototype,F.prototype=new j,F.__super__=G.prototype,F},k={}.hasOwnProperty;M=_("./Utility"),I=M.isObject,D=M.isFunction,E=M.getValue,P=_("./XMLNode"),A=_("./NodeType"),O=_("./XMLAttribute"),R=_("./XMLNamedNodeMap"),w.exports=function(F){N(G,F);function G(V,j,H){var U,X,Y,z;if(G.__super__.constructor.call(this,V),j==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(j),this.type=A.Element,this.attribs={},this.schemaTypeInfo=null,H!=null&&this.attribute(H),V.type===A.Document&&(this.isRoot=!0,this.documentObject=V,V.rootObject=this,V.children)){for(z=V.children,X=0,Y=z.length;X<Y;X++)if(U=z[X],U.type===A.DocType){U.name=this.name;break}}}return Object.defineProperty(G.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(G.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(G.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(G.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(G.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(G.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(G.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(G.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new R(this.attribs)),this.attributeMap}}),G.prototype.clone=function(){var V,j,H,U;H=Object.create(this),H.isRoot&&(H.documentObject=null),H.attribs={},U=this.attribs;for(j in U)k.call(U,j)&&(V=U[j],H.attribs[j]=V.clone());return H.children=[],this.children.forEach(function(X){var Y;return Y=X.clone(),Y.parent=H,H.children.push(Y)}),H},G.prototype.attribute=function(V,j){var H,U;if(V!=null&&(V=E(V)),I(V))for(H in V)k.call(V,H)&&(U=V[H],this.attribute(H,U));else D(j)&&(j=j.apply()),this.options.keepNullAttributes&&j==null?this.attribs[V]=new O(this,V,""):j!=null&&(this.attribs[V]=new O(this,V,j));return this},G.prototype.removeAttribute=function(V){var j,H,U;if(V==null)throw new Error("Missing attribute name. "+this.debugInfo());if(V=E(V),Array.isArray(V))for(H=0,U=V.length;H<U;H++)j=V[H],delete this.attribs[j];else delete this.attribs[V];return this},G.prototype.toString=function(V){return this.options.writer.element(this,this.options.writer.filterOptions(V))},G.prototype.att=function(V,j){return this.attribute(V,j)},G.prototype.a=function(V,j){return this.attribute(V,j)},G.prototype.getAttribute=function(V){return this.attribs.hasOwnProperty(V)?this.attribs[V].value:null},G.prototype.setAttribute=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getAttributeNode=function(V){return this.attribs.hasOwnProperty(V)?this.attribs[V]:null},G.prototype.setAttributeNode=function(V){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.removeAttributeNode=function(V){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getElementsByTagName=function(V){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getAttributeNS=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.setAttributeNS=function(V,j,H){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.removeAttributeNS=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getAttributeNodeNS=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.setAttributeNodeNS=function(V){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getElementsByTagNameNS=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.hasAttribute=function(V){return this.attribs.hasOwnProperty(V)},G.prototype.hasAttributeNS=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.setIdAttribute=function(V,j){return this.attribs.hasOwnProperty(V)?this.attribs[V].isId:j},G.prototype.setIdAttributeNS=function(V,j,H){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.setIdAttributeNode=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getElementsByTagName=function(V){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getElementsByTagNameNS=function(V,j){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.getElementsByClassName=function(V){throw new Error("This DOM method is not implemented."+this.debugInfo())},G.prototype.isEqualNode=function(V){var j,H,U;if(!G.__super__.isEqualNode.apply(this,arguments).isEqualNode(V)||V.namespaceURI!==this.namespaceURI||V.prefix!==this.prefix||V.localName!==this.localName||V.attribs.length!==this.attribs.length)return!1;for(j=H=0,U=this.attribs.length-1;0<=U?H<=U:H>=U;j=0<=U?++H:--H)if(!this.attribs[j].isEqualNode(V.attribs[j]))return!1;return!0},G}(P)}).call(this)},{"./NodeType":498,"./Utility":499,"./XMLAttribute":501,"./XMLNamedNodeMap":519,"./XMLNode":520}],519:[function(_,w,B){(function(){w.exports=function(){function A(O){this.nodes=O}return Object.defineProperty(A.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),A.prototype.clone=function(){return this.nodes=null},A.prototype.getNamedItem=function(O){return this.nodes[O]},A.prototype.setNamedItem=function(O){var R;return R=this.nodes[O.nodeName],this.nodes[O.nodeName]=O,R||null},A.prototype.removeNamedItem=function(O){var R;return R=this.nodes[O],delete this.nodes[O],R||null},A.prototype.item=function(O){return this.nodes[Object.keys(this.nodes)[O]]||null},A.prototype.getNamedItemNS=function(O,R){throw new Error("This DOM method is not implemented.")},A.prototype.setNamedItemNS=function(O){throw new Error("This DOM method is not implemented.")},A.prototype.removeNamedItemNS=function(O,R){throw new Error("This DOM method is not implemented.")},A}()}).call(this)},{}],520:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M,N,k,F,G,V,j,H,U,X,Y={}.hasOwnProperty;X=_("./Utility"),U=X.isObject,H=X.isFunction,j=X.isEmpty,V=X.getValue,M=null,R=null,P=null,E=null,D=null,F=null,G=null,k=null,I=null,O=null,N=null,A=null,w.exports=function(){function z(W){this.parent=W,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,M||(M=_("./XMLElement"),R=_("./XMLCData"),P=_("./XMLComment"),E=_("./XMLDeclaration"),D=_("./XMLDocType"),F=_("./XMLRaw"),G=_("./XMLText"),k=_("./XMLProcessingInstruction"),I=_("./XMLDummy"),O=_("./NodeType"),N=_("./XMLNodeList"),_("./XMLNamedNodeMap"),A=_("./DocumentPosition"))}return Object.defineProperty(z.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(z.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(z.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(z.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(z.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new N(this.children)),this.childNodeList}}),Object.defineProperty(z.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(z.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(z.prototype,"previousSibling",{get:function(){var W;return W=this.parent.children.indexOf(this),this.parent.children[W-1]||null}}),Object.defineProperty(z.prototype,"nextSibling",{get:function(){var W;return W=this.parent.children.indexOf(this),this.parent.children[W+1]||null}}),Object.defineProperty(z.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(z.prototype,"textContent",{get:function(){var W,Z,Q,ee,te;if(this.nodeType===O.Element||this.nodeType===O.DocumentFragment){for(te="",ee=this.children,Z=0,Q=ee.length;Z<Q;Z++)W=ee[Z],W.textContent&&(te+=W.textContent);return te}else return null},set:function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),z.prototype.setParent=function(W){var Z,Q,ee,te,re;for(this.parent=W,W&&(this.options=W.options,this.stringify=W.stringify),te=this.children,re=[],Q=0,ee=te.length;Q<ee;Q++)Z=te[Q],re.push(Z.setParent(this));return re},z.prototype.element=function(W,Z,Q){var ee,te,re,ie,ne,he,pe,K,ue,le,ce;if(he=null,Z===null&&Q==null&&(ue=[{},null],Z=ue[0],Q=ue[1]),Z==null&&(Z={}),Z=V(Z),U(Z)||(le=[Z,Q],Q=le[0],Z=le[1]),W!=null&&(W=V(W)),Array.isArray(W))for(re=0,pe=W.length;re<pe;re++)te=W[re],he=this.element(te);else if(H(W))he=this.element(W.apply());else if(U(W)){for(ne in W)if(Y.call(W,ne))if(ce=W[ne],H(ce)&&(ce=ce.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&ne.indexOf(this.stringify.convertAttKey)===0)he=this.attribute(ne.substr(this.stringify.convertAttKey.length),ce);else if(!this.options.separateArrayItems&&Array.isArray(ce)&&j(ce))he=this.dummy();else if(U(ce)&&j(ce))he=this.element(ne);else if(!this.options.keepNullNodes&&ce==null)he=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(ce))for(ie=0,K=ce.length;ie<K;ie++)te=ce[ie],ee={},ee[ne]=te,he=this.element(ee);else U(ce)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&ne.indexOf(this.stringify.convertTextKey)===0?he=this.element(ce):(he=this.element(ne),he.element(ce)):he=this.element(ne,ce)}else!this.options.keepNullNodes&&Q===null?he=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&W.indexOf(this.stringify.convertTextKey)===0?he=this.text(Q):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&W.indexOf(this.stringify.convertCDataKey)===0?he=this.cdata(Q):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&W.indexOf(this.stringify.convertCommentKey)===0?he=this.comment(Q):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&W.indexOf(this.stringify.convertRawKey)===0?he=this.raw(Q):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&W.indexOf(this.stringify.convertPIKey)===0?he=this.instruction(W.substr(this.stringify.convertPIKey.length),Q):he=this.node(W,Z,Q);if(he==null)throw new Error("Could not create any elements with: "+W+". "+this.debugInfo());return he},z.prototype.insertBefore=function(W,Z,Q){var ee,te,re,ie,ne;if(W!=null&&W.type)return re=W,ie=Z,re.setParent(this),ie?(te=children.indexOf(ie),ne=children.splice(te),children.push(re),Array.prototype.push.apply(children,ne)):children.push(re),re;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(W));return te=this.parent.children.indexOf(this),ne=this.parent.children.splice(te),ee=this.parent.element(W,Z,Q),Array.prototype.push.apply(this.parent.children,ne),ee},z.prototype.insertAfter=function(W,Z,Q){var ee,te,re;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(W));return te=this.parent.children.indexOf(this),re=this.parent.children.splice(te+1),ee=this.parent.element(W,Z,Q),Array.prototype.push.apply(this.parent.children,re),ee},z.prototype.remove=function(){var W;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return W=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[W,W-W+1].concat([])),this.parent},z.prototype.node=function(W,Z,Q){var ee,te;return W!=null&&(W=V(W)),Z||(Z={}),Z=V(Z),U(Z)||(te=[Z,Q],Q=te[0],Z=te[1]),ee=new M(this,W,Z),Q!=null&&ee.text(Q),this.children.push(ee),ee},z.prototype.text=function(W){var Z;return U(W)&&this.element(W),Z=new G(this,W),this.children.push(Z),this},z.prototype.cdata=function(W){var Z;return Z=new R(this,W),this.children.push(Z),this},z.prototype.comment=function(W){var Z;return Z=new P(this,W),this.children.push(Z),this},z.prototype.commentBefore=function(W){var Z,Q;return Z=this.parent.children.indexOf(this),Q=this.parent.children.splice(Z),this.parent.comment(W),Array.prototype.push.apply(this.parent.children,Q),this},z.prototype.commentAfter=function(W){var Z,Q;return Z=this.parent.children.indexOf(this),Q=this.parent.children.splice(Z+1),this.parent.comment(W),Array.prototype.push.apply(this.parent.children,Q),this},z.prototype.raw=function(W){var Z;return Z=new F(this,W),this.children.push(Z),this},z.prototype.dummy=function(){var W;return W=new I(this),W},z.prototype.instruction=function(W,Z){var Q,ee,te,re,ie;if(W!=null&&(W=V(W)),Z!=null&&(Z=V(Z)),Array.isArray(W))for(re=0,ie=W.length;re<ie;re++)Q=W[re],this.instruction(Q);else if(U(W))for(Q in W)Y.call(W,Q)&&(ee=W[Q],this.instruction(Q,ee));else H(Z)&&(Z=Z.apply()),te=new k(this,W,Z),this.children.push(te);return this},z.prototype.instructionBefore=function(W,Z){var Q,ee;return Q=this.parent.children.indexOf(this),ee=this.parent.children.splice(Q),this.parent.instruction(W,Z),Array.prototype.push.apply(this.parent.children,ee),this},z.prototype.instructionAfter=function(W,Z){var Q,ee;return Q=this.parent.children.indexOf(this),ee=this.parent.children.splice(Q+1),this.parent.instruction(W,Z),Array.prototype.push.apply(this.parent.children,ee),this},z.prototype.declaration=function(W,Z,Q){var ee,te;return ee=this.document(),te=new E(ee,W,Z,Q),ee.children.length===0?ee.children.unshift(te):ee.children[0].type===O.Declaration?ee.children[0]=te:ee.children.unshift(te),ee.root()||ee},z.prototype.dtd=function(W,Z){var Q,ee,te,re,ie,ne,he,pe,K,ue;for(ee=this.document(),te=new D(ee,W,Z),K=ee.children,re=ie=0,he=K.length;ie<he;re=++ie)if(Q=K[re],Q.type===O.DocType)return ee.children[re]=te,te;for(ue=ee.children,re=ne=0,pe=ue.length;ne<pe;re=++ne)if(Q=ue[re],Q.isRoot)return ee.children.splice(re,0,te),te;return ee.children.push(te),te},z.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},z.prototype.root=function(){var W;for(W=this;W;){if(W.type===O.Document)return W.rootObject;if(W.isRoot)return W;W=W.parent}},z.prototype.document=function(){var W;for(W=this;W;){if(W.type===O.Document)return W;W=W.parent}},z.prototype.end=function(W){return this.document().end(W)},z.prototype.prev=function(){var W;if(W=this.parent.children.indexOf(this),W<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[W-1]},z.prototype.next=function(){var W;if(W=this.parent.children.indexOf(this),W===-1||W===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[W+1]},z.prototype.importDocument=function(W){var Z;return Z=W.root().clone(),Z.parent=this,Z.isRoot=!1,this.children.push(Z),this},z.prototype.debugInfo=function(W){var Z,Q;return W=W||this.name,W==null&&!((Z=this.parent)!=null&&Z.name)?"":W==null?"parent: <"+this.parent.name+">":(Q=this.parent)!=null&&Q.name?"node: <"+W+">, parent: <"+this.parent.name+">":"node: <"+W+">"},z.prototype.ele=function(W,Z,Q){return this.element(W,Z,Q)},z.prototype.nod=function(W,Z,Q){return this.node(W,Z,Q)},z.prototype.txt=function(W){return this.text(W)},z.prototype.dat=function(W){return this.cdata(W)},z.prototype.com=function(W){return this.comment(W)},z.prototype.ins=function(W,Z){return this.instruction(W,Z)},z.prototype.doc=function(){return this.document()},z.prototype.dec=function(W,Z,Q){return this.declaration(W,Z,Q)},z.prototype.e=function(W,Z,Q){return this.element(W,Z,Q)},z.prototype.n=function(W,Z,Q){return this.node(W,Z,Q)},z.prototype.t=function(W){return this.text(W)},z.prototype.d=function(W){return this.cdata(W)},z.prototype.c=function(W){return this.comment(W)},z.prototype.r=function(W){return this.raw(W)},z.prototype.i=function(W,Z){return this.instruction(W,Z)},z.prototype.u=function(){return this.up()},z.prototype.importXMLBuilder=function(W){return this.importDocument(W)},z.prototype.replaceChild=function(W,Z){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.removeChild=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.appendChild=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.hasChildNodes=function(){return this.children.length!==0},z.prototype.cloneNode=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.isSupported=function(W,Z){return!0},z.prototype.hasAttributes=function(){return this.attribs.length!==0},z.prototype.compareDocumentPosition=function(W){var Z,Q;return Z=this,Z===W?0:this.document()!==W.document()?(Q=A.Disconnected|A.ImplementationSpecific,Math.random()<.5?Q|=A.Preceding:Q|=A.Following,Q):Z.isAncestor(W)?A.Contains|A.Preceding:Z.isDescendant(W)?A.Contains|A.Following:Z.isPreceding(W)?A.Preceding:A.Following},z.prototype.isSameNode=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.lookupPrefix=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.isDefaultNamespace=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.lookupNamespaceURI=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.isEqualNode=function(W){var Z,Q,ee;if(W.nodeType!==this.nodeType||W.children.length!==this.children.length)return!1;for(Z=Q=0,ee=this.children.length-1;0<=ee?Q<=ee:Q>=ee;Z=0<=ee?++Q:--Q)if(!this.children[Z].isEqualNode(W.children[Z]))return!1;return!0},z.prototype.getFeature=function(W,Z){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.setUserData=function(W,Z,Q){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.getUserData=function(W){throw new Error("This DOM method is not implemented."+this.debugInfo())},z.prototype.contains=function(W){return W?W===this||this.isDescendant(W):!1},z.prototype.isDescendant=function(W){var Z,Q,ee,te,re;for(re=this.children,ee=0,te=re.length;ee<te;ee++)if(Z=re[ee],W===Z||(Q=Z.isDescendant(W),Q))return!0;return!1},z.prototype.isAncestor=function(W){return W.isDescendant(this)},z.prototype.isPreceding=function(W){var Z,Q;return Z=this.treePosition(W),Q=this.treePosition(this),Z===-1||Q===-1?!1:Z<Q},z.prototype.isFollowing=function(W){var Z,Q;return Z=this.treePosition(W),Q=this.treePosition(this),Z===-1||Q===-1?!1:Z>Q},z.prototype.treePosition=function(W){var Z,Q;return Q=0,Z=!1,this.foreachTreeNode(this.document(),function(ee){if(Q++,!Z&&ee===W)return Z=!0}),Z?Q:-1},z.prototype.foreachTreeNode=function(W,Z){var Q,ee,te,re,ie;for(W||(W=this.document()),re=W.children,ee=0,te=re.length;ee<te;ee++){if(Q=re[ee],ie=Z(Q))return ie;if(ie=this.foreachTreeNode(Q,Z),ie)return ie}},z}()}).call(this)},{"./DocumentPosition":497,"./NodeType":498,"./Utility":499,"./XMLCData":502,"./XMLComment":504,"./XMLDeclaration":513,"./XMLDocType":514,"./XMLDummy":517,"./XMLElement":518,"./XMLNamedNodeMap":519,"./XMLNodeList":521,"./XMLProcessingInstruction":522,"./XMLRaw":523,"./XMLText":527}],521:[function(_,w,B){(function(){w.exports=function(){function A(O){this.nodes=O}return Object.defineProperty(A.prototype,"length",{get:function(){return this.nodes.length||0}}),A.prototype.clone=function(){return this.nodes=null},A.prototype.item=function(O){return this.nodes[O]||null},A}()}).call(this)},{}],522:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;A=_("./NodeType"),O=_("./XMLCharacterData"),w.exports=function(E){R(D,E);function D(I,M,N){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=A.ProcessingInstruction,this.target=this.stringify.insTarget(M),this.name=this.target,N&&(this.value=this.stringify.insValue(N))}return D.prototype.clone=function(){return Object.create(this)},D.prototype.toString=function(I){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(I))},D.prototype.isEqualNode=function(I){return!(!D.__super__.isEqualNode.apply(this,arguments).isEqualNode(I)||I.target!==this.target)},D}(O)}).call(this)},{"./NodeType":498,"./XMLCharacterData":503}],523:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;A=_("./NodeType"),O=_("./XMLNode"),w.exports=function(E){R(D,E);function D(I,M){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=A.Raw,this.value=this.stringify.raw(M)}return D.prototype.clone=function(){return Object.create(this)},D.prototype.toString=function(I){return this.options.writer.raw(this,this.options.writer.filterOptions(I))},D}(O)}).call(this)},{"./NodeType":498,"./XMLNode":520}],524:[function(_,w,B){(function(){var A,O,R,P=function(D,I){for(var M in I)E.call(I,M)&&(D[M]=I[M]);function N(){this.constructor=D}return N.prototype=I.prototype,D.prototype=new N,D.__super__=I.prototype,D},E={}.hasOwnProperty;A=_("./NodeType"),R=_("./XMLWriterBase"),O=_("./WriterState"),w.exports=function(D){P(I,D);function I(M,N){this.stream=M,I.__super__.constructor.call(this,N)}return I.prototype.endline=function(M,N,k){return M.isLastRootNode&&N.state===O.CloseTag?"":I.__super__.endline.call(this,M,N,k)},I.prototype.document=function(M,N){var k,F,G,V,j,H,U,X,Y;for(U=M.children,F=G=0,j=U.length;G<j;F=++G)k=U[F],k.isLastRootNode=F===M.children.length-1;for(N=this.filterOptions(N),X=M.children,Y=[],V=0,H=X.length;V<H;V++)k=X[V],Y.push(this.writeChildNode(k,N,0));return Y},I.prototype.attribute=function(M,N,k){return this.stream.write(I.__super__.attribute.call(this,M,N,k))},I.prototype.cdata=function(M,N,k){return this.stream.write(I.__super__.cdata.call(this,M,N,k))},I.prototype.comment=function(M,N,k){return this.stream.write(I.__super__.comment.call(this,M,N,k))},I.prototype.declaration=function(M,N,k){return this.stream.write(I.__super__.declaration.call(this,M,N,k))},I.prototype.docType=function(M,N,k){var F,G,V,j;if(k||(k=0),this.openNode(M,N,k),N.state=O.OpenTag,this.stream.write(this.indent(M,N,k)),this.stream.write("<!DOCTYPE "+M.root().name),M.pubID&&M.sysID?this.stream.write(' PUBLIC "'+M.pubID+'" "'+M.sysID+'"'):M.sysID&&this.stream.write(' SYSTEM "'+M.sysID+'"'),M.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(M,N,k)),N.state=O.InsideTag,j=M.children,G=0,V=j.length;G<V;G++)F=j[G],this.writeChildNode(F,N,k+1);N.state=O.CloseTag,this.stream.write("]")}return N.state=O.CloseTag,this.stream.write(N.spaceBeforeSlash+">"),this.stream.write(this.endline(M,N,k)),N.state=O.None,this.closeNode(M,N,k)},I.prototype.element=function(M,N,k){var F,G,V,j,H,U,X,Y,z;k||(k=0),this.openNode(M,N,k),N.state=O.OpenTag,this.stream.write(this.indent(M,N,k)+"<"+M.name),Y=M.attribs;for(X in Y)E.call(Y,X)&&(F=Y[X],this.attribute(F,N,k));if(V=M.children.length,j=V===0?null:M.children[0],V===0||M.children.every(function(W){return(W.type===A.Text||W.type===A.Raw)&&W.value===""}))N.allowEmpty?(this.stream.write(">"),N.state=O.CloseTag,this.stream.write("</"+M.name+">")):(N.state=O.CloseTag,this.stream.write(N.spaceBeforeSlash+"/>"));else if(N.pretty&&V===1&&(j.type===A.Text||j.type===A.Raw)&&j.value!=null)this.stream.write(">"),N.state=O.InsideTag,N.suppressPrettyCount++,this.writeChildNode(j,N,k+1),N.suppressPrettyCount--,N.state=O.CloseTag,this.stream.write("</"+M.name+">");else{for(this.stream.write(">"+this.endline(M,N,k)),N.state=O.InsideTag,z=M.children,H=0,U=z.length;H<U;H++)G=z[H],this.writeChildNode(G,N,k+1);N.state=O.CloseTag,this.stream.write(this.indent(M,N,k)+"</"+M.name+">")}return this.stream.write(this.endline(M,N,k)),N.state=O.None,this.closeNode(M,N,k)},I.prototype.processingInstruction=function(M,N,k){return this.stream.write(I.__super__.processingInstruction.call(this,M,N,k))},I.prototype.raw=function(M,N,k){return this.stream.write(I.__super__.raw.call(this,M,N,k))},I.prototype.text=function(M,N,k){return this.stream.write(I.__super__.text.call(this,M,N,k))},I.prototype.dtdAttList=function(M,N,k){return this.stream.write(I.__super__.dtdAttList.call(this,M,N,k))},I.prototype.dtdElement=function(M,N,k){return this.stream.write(I.__super__.dtdElement.call(this,M,N,k))},I.prototype.dtdEntity=function(M,N,k){return this.stream.write(I.__super__.dtdEntity.call(this,M,N,k))},I.prototype.dtdNotation=function(M,N,k){return this.stream.write(I.__super__.dtdNotation.call(this,M,N,k))},I}(R)}).call(this)},{"./NodeType":498,"./WriterState":500,"./XMLWriterBase":528}],525:[function(_,w,B){(function(){var A,O=function(P,E){for(var D in E)R.call(E,D)&&(P[D]=E[D]);function I(){this.constructor=P}return I.prototype=E.prototype,P.prototype=new I,P.__super__=E.prototype,P},R={}.hasOwnProperty;A=_("./XMLWriterBase"),w.exports=function(P){O(E,P);function E(D){E.__super__.constructor.call(this,D)}return E.prototype.document=function(D,I){var M,N,k,F,G;for(I=this.filterOptions(I),F="",G=D.children,N=0,k=G.length;N<k;N++)M=G[N],F+=this.writeChildNode(M,I,0);return I.pretty&&F.slice(-I.newline.length)===I.newline&&(F=F.slice(0,-I.newline.length)),F},E}(A)}).call(this)},{"./XMLWriterBase":528}],526:[function(_,w,B){(function(){var A=function(R,P){return function(){return R.apply(P,arguments)}},O={}.hasOwnProperty;w.exports=function(){function R(P){this.assertLegalName=A(this.assertLegalName,this),this.assertLegalChar=A(this.assertLegalChar,this);var E,D,I;P||(P={}),this.options=P,this.options.version||(this.options.version="1.0"),D=P.stringify||{};for(E in D)O.call(D,E)&&(I=D[E],this[E]=I)}return R.prototype.name=function(P){return this.options.noValidation?P:this.assertLegalName(""+P||"")},R.prototype.text=function(P){return this.options.noValidation?P:this.assertLegalChar(this.textEscape(""+P||""))},R.prototype.cdata=function(P){return this.options.noValidation?P:(P=""+P||"",P=P.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(P))},R.prototype.comment=function(P){if(this.options.noValidation)return P;if(P=""+P||"",P.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+P);return this.assertLegalChar(P)},R.prototype.raw=function(P){return this.options.noValidation?P:""+P||""},R.prototype.attValue=function(P){return this.options.noValidation?P:this.assertLegalChar(this.attEscape(P=""+P||""))},R.prototype.insTarget=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.insValue=function(P){if(this.options.noValidation)return P;if(P=""+P||"",P.match(/\?>/))throw new Error("Invalid processing instruction value: "+P);return this.assertLegalChar(P)},R.prototype.xmlVersion=function(P){if(this.options.noValidation)return P;if(P=""+P||"",!P.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+P);return P},R.prototype.xmlEncoding=function(P){if(this.options.noValidation)return P;if(P=""+P||"",!P.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+P);return this.assertLegalChar(P)},R.prototype.xmlStandalone=function(P){return this.options.noValidation?P:P?"yes":"no"},R.prototype.dtdPubID=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.dtdSysID=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.dtdElementValue=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.dtdAttType=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.dtdAttDefault=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.dtdEntityValue=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.dtdNData=function(P){return this.options.noValidation?P:this.assertLegalChar(""+P||"")},R.prototype.convertAttKey="@",R.prototype.convertPIKey="?",R.prototype.convertTextKey="#text",R.prototype.convertCDataKey="#cdata",R.prototype.convertCommentKey="#comment",R.prototype.convertRawKey="#raw",R.prototype.assertLegalChar=function(P){var E,D;if(this.options.noValidation)return P;if(E="",this.options.version==="1.0"){if(E=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,D=P.match(E))throw new Error("Invalid character in string: "+P+" at index "+D.index)}else if(this.options.version==="1.1"&&(E=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,D=P.match(E)))throw new Error("Invalid character in string: "+P+" at index "+D.index);return P},R.prototype.assertLegalName=function(P){var E;if(this.options.noValidation)return P;if(this.assertLegalChar(P),E=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!P.match(E))throw new Error("Invalid character in name");return P},R.prototype.textEscape=function(P){var E;return this.options.noValidation?P:(E=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,P.replace(E,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},R.prototype.attEscape=function(P){var E;return this.options.noValidation?P:(E=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,P.replace(E,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},R}()}).call(this)},{}],527:[function(_,w,B){(function(){var A,O,R=function(E,D){for(var I in D)P.call(D,I)&&(E[I]=D[I]);function M(){this.constructor=E}return M.prototype=D.prototype,E.prototype=new M,E.__super__=D.prototype,E},P={}.hasOwnProperty;A=_("./NodeType"),O=_("./XMLCharacterData"),w.exports=function(E){R(D,E);function D(I,M){if(D.__super__.constructor.call(this,I),M==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=A.Text,this.value=this.stringify.text(M)}return Object.defineProperty(D.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(D.prototype,"wholeText",{get:function(){var I,M,N;for(N="",M=this.previousSibling;M;)N=M.data+N,M=M.previousSibling;for(N+=this.data,I=this.nextSibling;I;)N=N+I.data,I=I.nextSibling;return N}}),D.prototype.clone=function(){return Object.create(this)},D.prototype.toString=function(I){return this.options.writer.text(this,this.options.writer.filterOptions(I))},D.prototype.splitText=function(I){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.replaceWholeText=function(I){throw new Error("This DOM method is not implemented."+this.debugInfo())},D}(O)}).call(this)},{"./NodeType":498,"./XMLCharacterData":503}],528:[function(_,w,B){(function(){var A,O,R,P={}.hasOwnProperty;R=_("./Utility").assign,A=_("./NodeType"),_("./XMLDeclaration"),_("./XMLDocType"),_("./XMLCData"),_("./XMLComment"),_("./XMLElement"),_("./XMLRaw"),_("./XMLText"),_("./XMLProcessingInstruction"),_("./XMLDummy"),_("./XMLDTDAttList"),_("./XMLDTDElement"),_("./XMLDTDEntity"),_("./XMLDTDNotation"),O=_("./WriterState"),w.exports=function(){function E(D){var I,M,N;D||(D={}),this.options=D,M=D.writer||{};for(I in M)P.call(M,I)&&(N=M[I],this["_"+I]=this[I],this[I]=N)}return E.prototype.filterOptions=function(D){var I,M,N,k,F,G,V,j;return D||(D={}),D=R({},this.options,D),I={writer:this},I.pretty=D.pretty||!1,I.allowEmpty=D.allowEmpty||!1,I.indent=(M=D.indent)!=null?M:"  ",I.newline=(N=D.newline)!=null?N:"\n",I.offset=(k=D.offset)!=null?k:0,I.dontPrettyTextNodes=(F=(G=D.dontPrettyTextNodes)!=null?G:D.dontprettytextnodes)!=null?F:0,I.spaceBeforeSlash=(V=(j=D.spaceBeforeSlash)!=null?j:D.spacebeforeslash)!=null?V:"",I.spaceBeforeSlash===!0&&(I.spaceBeforeSlash=" "),I.suppressPrettyCount=0,I.user={},I.state=O.None,I},E.prototype.indent=function(D,I,M){var N;return!I.pretty||I.suppressPrettyCount?"":I.pretty&&(N=(M||0)+I.offset+1,N>0)?new Array(N).join(I.indent):""},E.prototype.endline=function(D,I,M){return!I.pretty||I.suppressPrettyCount?"":I.newline},E.prototype.attribute=function(D,I,M){var N;return this.openAttribute(D,I,M),N=" "+D.name+'="'+D.value+'"',this.closeAttribute(D,I,M),N},E.prototype.cdata=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<![CDATA[",I.state=O.InsideTag,N+=D.value,I.state=O.CloseTag,N+="]]>"+this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.comment=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<!-- ",I.state=O.InsideTag,N+=D.value,I.state=O.CloseTag,N+=" -->"+this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.declaration=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<?xml",I.state=O.InsideTag,N+=' version="'+D.version+'"',D.encoding!=null&&(N+=' encoding="'+D.encoding+'"'),D.standalone!=null&&(N+=' standalone="'+D.standalone+'"'),I.state=O.CloseTag,N+=I.spaceBeforeSlash+"?>",N+=this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.docType=function(D,I,M){var N,k,F,G,V;if(M||(M=0),this.openNode(D,I,M),I.state=O.OpenTag,G=this.indent(D,I,M),G+="<!DOCTYPE "+D.root().name,D.pubID&&D.sysID?G+=' PUBLIC "'+D.pubID+'" "'+D.sysID+'"':D.sysID&&(G+=' SYSTEM "'+D.sysID+'"'),D.children.length>0){for(G+=" [",G+=this.endline(D,I,M),I.state=O.InsideTag,V=D.children,k=0,F=V.length;k<F;k++)N=V[k],G+=this.writeChildNode(N,I,M+1);I.state=O.CloseTag,G+="]"}return I.state=O.CloseTag,G+=I.spaceBeforeSlash+">",G+=this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),G},E.prototype.element=function(D,I,M){var N,k,F,G,V,j,H,U,X,Y,z,W,Z,Q;M||(M=0),Y=!1,z="",this.openNode(D,I,M),I.state=O.OpenTag,z+=this.indent(D,I,M)+"<"+D.name,W=D.attribs;for(X in W)P.call(W,X)&&(N=W[X],z+=this.attribute(N,I,M));if(F=D.children.length,G=F===0?null:D.children[0],F===0||D.children.every(function(ee){return(ee.type===A.Text||ee.type===A.Raw)&&ee.value===""}))I.allowEmpty?(z+=">",I.state=O.CloseTag,z+="</"+D.name+">"+this.endline(D,I,M)):(I.state=O.CloseTag,z+=I.spaceBeforeSlash+"/>"+this.endline(D,I,M));else if(I.pretty&&F===1&&(G.type===A.Text||G.type===A.Raw)&&G.value!=null)z+=">",I.state=O.InsideTag,I.suppressPrettyCount++,Y=!0,z+=this.writeChildNode(G,I,M+1),I.suppressPrettyCount--,Y=!1,I.state=O.CloseTag,z+="</"+D.name+">"+this.endline(D,I,M);else{if(I.dontPrettyTextNodes){for(Z=D.children,V=0,H=Z.length;V<H;V++)if(k=Z[V],(k.type===A.Text||k.type===A.Raw)&&k.value!=null){I.suppressPrettyCount++,Y=!0;break}}for(z+=">"+this.endline(D,I,M),I.state=O.InsideTag,Q=D.children,j=0,U=Q.length;j<U;j++)k=Q[j],z+=this.writeChildNode(k,I,M+1);I.state=O.CloseTag,z+=this.indent(D,I,M)+"</"+D.name+">",Y&&I.suppressPrettyCount--,z+=this.endline(D,I,M),I.state=O.None}return this.closeNode(D,I,M),z},E.prototype.writeChildNode=function(D,I,M){switch(D.type){case A.CData:return this.cdata(D,I,M);case A.Comment:return this.comment(D,I,M);case A.Element:return this.element(D,I,M);case A.Raw:return this.raw(D,I,M);case A.Text:return this.text(D,I,M);case A.ProcessingInstruction:return this.processingInstruction(D,I,M);case A.Dummy:return"";case A.Declaration:return this.declaration(D,I,M);case A.DocType:return this.docType(D,I,M);case A.AttributeDeclaration:return this.dtdAttList(D,I,M);case A.ElementDeclaration:return this.dtdElement(D,I,M);case A.EntityDeclaration:return this.dtdEntity(D,I,M);case A.NotationDeclaration:return this.dtdNotation(D,I,M);default:throw new Error("Unknown XML node type: "+D.constructor.name)}},E.prototype.processingInstruction=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<?",I.state=O.InsideTag,N+=D.target,D.value&&(N+=" "+D.value),I.state=O.CloseTag,N+=I.spaceBeforeSlash+"?>",N+=this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.raw=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M),I.state=O.InsideTag,N+=D.value,I.state=O.CloseTag,N+=this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.text=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M),I.state=O.InsideTag,N+=D.value,I.state=O.CloseTag,N+=this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.dtdAttList=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<!ATTLIST",I.state=O.InsideTag,N+=" "+D.elementName+" "+D.attributeName+" "+D.attributeType,D.defaultValueType!=="#DEFAULT"&&(N+=" "+D.defaultValueType),D.defaultValue&&(N+=' "'+D.defaultValue+'"'),I.state=O.CloseTag,N+=I.spaceBeforeSlash+">"+this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.dtdElement=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<!ELEMENT",I.state=O.InsideTag,N+=" "+D.name+" "+D.value,I.state=O.CloseTag,N+=I.spaceBeforeSlash+">"+this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.dtdEntity=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<!ENTITY",I.state=O.InsideTag,D.pe&&(N+=" %"),N+=" "+D.name,D.value?N+=' "'+D.value+'"':(D.pubID&&D.sysID?N+=' PUBLIC "'+D.pubID+'" "'+D.sysID+'"':D.sysID&&(N+=' SYSTEM "'+D.sysID+'"'),D.nData&&(N+=" NDATA "+D.nData)),I.state=O.CloseTag,N+=I.spaceBeforeSlash+">"+this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.dtdNotation=function(D,I,M){var N;return this.openNode(D,I,M),I.state=O.OpenTag,N=this.indent(D,I,M)+"<!NOTATION",I.state=O.InsideTag,N+=" "+D.name,D.pubID&&D.sysID?N+=' PUBLIC "'+D.pubID+'" "'+D.sysID+'"':D.pubID?N+=' PUBLIC "'+D.pubID+'"':D.sysID&&(N+=' SYSTEM "'+D.sysID+'"'),I.state=O.CloseTag,N+=I.spaceBeforeSlash+">"+this.endline(D,I,M),I.state=O.None,this.closeNode(D,I,M),N},E.prototype.openNode=function(D,I,M){},E.prototype.closeNode=function(D,I,M){},E.prototype.openAttribute=function(D,I,M){},E.prototype.closeAttribute=function(D,I,M){},E}()}).call(this)},{"./NodeType":498,"./Utility":499,"./WriterState":500,"./XMLCData":502,"./XMLComment":504,"./XMLDTDAttList":509,"./XMLDTDElement":510,"./XMLDTDEntity":511,"./XMLDTDNotation":512,"./XMLDeclaration":513,"./XMLDocType":514,"./XMLDummy":517,"./XMLElement":518,"./XMLProcessingInstruction":522,"./XMLRaw":523,"./XMLText":527}],529:[function(_,w,B){(function(){var A,O,R,P,E,D,I,M,N,k;k=_("./Utility"),M=k.assign,N=k.isFunction,R=_("./XMLDOMImplementation"),P=_("./XMLDocument"),E=_("./XMLDocumentCB"),I=_("./XMLStringWriter"),D=_("./XMLStreamWriter"),A=_("./NodeType"),O=_("./WriterState"),w.exports.create=function(F,G,V,j){var H,U;if(F==null)throw new Error("Root element needs a name.");return j=M({},G,V,j),H=new P(j),U=H.element(F),j.headless||(H.declaration(j),(j.pubID!=null||j.sysID!=null)&&H.dtd(j)),U},w.exports.begin=function(F,G,V){var j;return N(F)&&(j=[F,G],G=j[0],V=j[1],F={}),G?new E(F,G,V):new P(F)},w.exports.stringWriter=function(F){return new I(F)},w.exports.streamWriter=function(F,G){return new D(F,G)},w.exports.implementation=new R,w.exports.nodeType=A,w.exports.writerState=O}).call(this)},{"./NodeType":498,"./Utility":499,"./WriterState":500,"./XMLDOMImplementation":507,"./XMLDocument":515,"./XMLDocumentCB":516,"./XMLStreamWriter":524,"./XMLStringWriter":525}],530:[function(_,w,B){w.exports=O;var A=Object.prototype.hasOwnProperty;function O(){for(var R={},P=0;P<arguments.length;P++){var E=arguments[P];for(var D in E)A.call(E,D)&&(R[D]=E[D])}return R}},{}],531:[function(_,w,B){_("core-js/modules/es.array.fill.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/es.array.join.js"),_("core-js/modules/es.array.slice.js");var A=_("buffer").Buffer,O=_("./sha"),R=_("./sha256"),P=_("./md5"),E={sha1:O,sha256:R,md5:P},D=64,I=A.alloc(D);I.fill(0);function M(F,G,V){A.isBuffer(G)||(G=A.from(G)),A.isBuffer(V)||(V=A.from(V)),G.length>D?G=F(G):G.length<D&&(G=A.concat([G,I],D));for(var j=A.alloc(D),H=A.alloc(D),U=0;U<D;U++)j[U]=G[U]^54,H[U]=G[U]^92;var X=F(A.concat([j,V]));return F(A.concat([H,X]))}function N(F,G){F=F||"sha1";var V=E[F],j=[],H=0;return V||k("algorithm:",F,"is not yet supported"),{update:function(X){return A.isBuffer(X)||(X=A.from(X)),j.push(X),H+=X.length,this},digest:function(X){var Y=A.concat(j),z=G?M(V,G,Y):V(Y);return j=null,X?z.toString(X):z}}}function k(){var F=[].slice.call(arguments).join(" ");throw new Error([F,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}B.createHash=function(F){return N(F)},B.createHmac=function(F,G){return N(F,G)},B.createCredentials=function(){k("sorry,createCredentials is not implemented yet")},B.createCipher=function(){k("sorry,createCipher is not implemented yet")},B.createCipheriv=function(){k("sorry,createCipheriv is not implemented yet")},B.createDecipher=function(){k("sorry,createDecipher is not implemented yet")},B.createDecipheriv=function(){k("sorry,createDecipheriv is not implemented yet")},B.createSign=function(){k("sorry,createSign is not implemented yet")},B.createVerify=function(){k("sorry,createVerify is not implemented yet")},B.createDiffieHellman=function(){k("sorry,createDiffieHellman is not implemented yet")},B.pbkdf2=function(){k("sorry,pbkdf2 is not implemented yet")}},{"./md5":533,"./sha":534,"./sha256":535,buffer:103,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.fill.js":311,"core-js/modules/es.array.join.js":317,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.regexp.to-string.js":339}],532:[function(_,w,B){_("core-js/modules/es.array.fill.js"),_("core-js/modules/es.array.concat.js");var A=_("buffer").Buffer,O=4,R=A.alloc(O);R.fill(0);var P=8;function E(M,N){if(M.length%O!==0){var k=M.length+(O-M.length%O);M=A.concat([M,R],k)}for(var F=[],G=N?M.readInt32BE:M.readInt32LE,V=0;V<M.length;V+=O)F.push(G.call(M,V));return F}function D(M,N,k){for(var F=A.alloc(N),G=k?F.writeInt32BE:F.writeInt32LE,V=0;V<M.length;V++)G.call(F,M[V],V*4,!0);return F}function I(M,N,k,F){A.isBuffer(M)||(M=A.from(M));var G=N(E(M,F),M.length*P);return D(G,k,F)}w.exports={hash:I}},{buffer:103,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.fill.js":311}],533:[function(_,w,B){var A=_("./helpers");function O(k,F){k[F>>5]|=128<<F%32,k[(F+64>>>9<<4)+14]=F;for(var G=1732584193,V=-271733879,j=-1732584194,H=271733878,U=0;U<k.length;U+=16){var X=G,Y=V,z=j,W=H;G=P(G,V,j,H,k[U+0],7,-680876936),H=P(H,G,V,j,k[U+1],12,-389564586),j=P(j,H,G,V,k[U+2],17,606105819),V=P(V,j,H,G,k[U+3],22,-1044525330),G=P(G,V,j,H,k[U+4],7,-176418897),H=P(H,G,V,j,k[U+5],12,1200080426),j=P(j,H,G,V,k[U+6],17,-1473231341),V=P(V,j,H,G,k[U+7],22,-45705983),G=P(G,V,j,H,k[U+8],7,1770035416),H=P(H,G,V,j,k[U+9],12,-1958414417),j=P(j,H,G,V,k[U+10],17,-42063),V=P(V,j,H,G,k[U+11],22,-1990404162),G=P(G,V,j,H,k[U+12],7,1804603682),H=P(H,G,V,j,k[U+13],12,-40341101),j=P(j,H,G,V,k[U+14],17,-1502002290),V=P(V,j,H,G,k[U+15],22,1236535329),G=E(G,V,j,H,k[U+1],5,-165796510),H=E(H,G,V,j,k[U+6],9,-1069501632),j=E(j,H,G,V,k[U+11],14,643717713),V=E(V,j,H,G,k[U+0],20,-373897302),G=E(G,V,j,H,k[U+5],5,-701558691),H=E(H,G,V,j,k[U+10],9,38016083),j=E(j,H,G,V,k[U+15],14,-660478335),V=E(V,j,H,G,k[U+4],20,-405537848),G=E(G,V,j,H,k[U+9],5,568446438),H=E(H,G,V,j,k[U+14],9,-1019803690),j=E(j,H,G,V,k[U+3],14,-187363961),V=E(V,j,H,G,k[U+8],20,1163531501),G=E(G,V,j,H,k[U+13],5,-1444681467),H=E(H,G,V,j,k[U+2],9,-51403784),j=E(j,H,G,V,k[U+7],14,1735328473),V=E(V,j,H,G,k[U+12],20,-1926607734),G=D(G,V,j,H,k[U+5],4,-378558),H=D(H,G,V,j,k[U+8],11,-2022574463),j=D(j,H,G,V,k[U+11],16,1839030562),V=D(V,j,H,G,k[U+14],23,-35309556),G=D(G,V,j,H,k[U+1],4,-1530992060),H=D(H,G,V,j,k[U+4],11,1272893353),j=D(j,H,G,V,k[U+7],16,-155497632),V=D(V,j,H,G,k[U+10],23,-1094730640),G=D(G,V,j,H,k[U+13],4,681279174),H=D(H,G,V,j,k[U+0],11,-358537222),j=D(j,H,G,V,k[U+3],16,-722521979),V=D(V,j,H,G,k[U+6],23,76029189),G=D(G,V,j,H,k[U+9],4,-640364487),H=D(H,G,V,j,k[U+12],11,-421815835),j=D(j,H,G,V,k[U+15],16,530742520),V=D(V,j,H,G,k[U+2],23,-995338651),G=I(G,V,j,H,k[U+0],6,-198630844),H=I(H,G,V,j,k[U+7],10,1126891415),j=I(j,H,G,V,k[U+14],15,-1416354905),V=I(V,j,H,G,k[U+5],21,-57434055),G=I(G,V,j,H,k[U+12],6,1700485571),H=I(H,G,V,j,k[U+3],10,-1894986606),j=I(j,H,G,V,k[U+10],15,-1051523),V=I(V,j,H,G,k[U+1],21,-2054922799),G=I(G,V,j,H,k[U+8],6,1873313359),H=I(H,G,V,j,k[U+15],10,-30611744),j=I(j,H,G,V,k[U+6],15,-1560198380),V=I(V,j,H,G,k[U+13],21,1309151649),G=I(G,V,j,H,k[U+4],6,-145523070),H=I(H,G,V,j,k[U+11],10,-1120210379),j=I(j,H,G,V,k[U+2],15,718787259),V=I(V,j,H,G,k[U+9],21,-343485551),G=M(G,X),V=M(V,Y),j=M(j,z),H=M(H,W)}return Array(G,V,j,H)}function R(k,F,G,V,j,H){return M(N(M(M(F,k),M(V,H)),j),G)}function P(k,F,G,V,j,H,U){return R(F&G|~F&V,k,F,j,H,U)}function E(k,F,G,V,j,H,U){return R(F&V|G&~V,k,F,j,H,U)}function D(k,F,G,V,j,H,U){return R(F^G^V,k,F,j,H,U)}function I(k,F,G,V,j,H,U){return R(G^(F|~V),k,F,j,H,U)}function M(k,F){var G=(k&65535)+(F&65535),V=(k>>16)+(F>>16)+(G>>16);return V<<16|G&65535}function N(k,F){return k<<F|k>>>32-F}w.exports=function(F){return A.hash(F,O,16)}},{"./helpers":532}],534:[function(_,w,B){var A=_("./helpers");function O(I,M){I[M>>5]|=128<<24-M%32,I[(M+64>>9<<4)+15]=M;for(var N=Array(80),k=1732584193,F=-271733879,G=-1732584194,V=271733878,j=-1009589776,H=0;H<I.length;H+=16){for(var U=k,X=F,Y=G,z=V,W=j,Z=0;Z<80;Z++){Z<16?N[Z]=I[H+Z]:N[Z]=D(N[Z-3]^N[Z-8]^N[Z-14]^N[Z-16],1);var Q=E(E(D(k,5),R(Z,F,G,V)),E(E(j,N[Z]),P(Z)));j=V,V=G,G=D(F,30),F=k,k=Q}k=E(k,U),F=E(F,X),G=E(G,Y),V=E(V,z),j=E(j,W)}return Array(k,F,G,V,j)}function R(I,M,N,k){return I<20?M&N|~M&k:I<40?M^N^k:I<60?M&N|M&k|N&k:M^N^k}function P(I){return I<20?1518500249:I<40?1859775393:I<60?-1894007588:-899497514}function E(I,M){var N=(I&65535)+(M&65535),k=(I>>16)+(M>>16)+(N>>16);return k<<16|N&65535}function D(I,M){return I<<M|I>>>32-M}w.exports=function(M){return A.hash(M,O,20,!0)}},{"./helpers":532}],535:[function(_,w,B){var A=_("./helpers"),O=function(V,j){var H=(V&65535)+(j&65535),U=(V>>16)+(j>>16)+(H>>16);return U<<16|H&65535},R=function(V,j){return V>>>j|V<<32-j},P=function(V,j){return V>>>j},E=function(V,j,H){return V&j^~V&H},D=function(V,j,H){return V&j^V&H^j&H},I=function(V){return R(V,2)^R(V,13)^R(V,22)},M=function(V){return R(V,6)^R(V,11)^R(V,25)},N=function(V){return R(V,7)^R(V,18)^P(V,3)},k=function(V){return R(V,17)^R(V,19)^P(V,10)},F=function(V,j){var H=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),U=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),X=new Array(64),Y,z,W,Z,Q,ee,te,re,ie,ne,he,pe;V[j>>5]|=128<<24-j%32,V[(j+64>>9<<4)+15]=j;for(var ie=0;ie<V.length;ie+=16){Y=U[0],z=U[1],W=U[2],Z=U[3],Q=U[4],ee=U[5],te=U[6],re=U[7];for(var ne=0;ne<64;ne++)ne<16?X[ne]=V[ne+ie]:X[ne]=O(O(O(k(X[ne-2]),X[ne-7]),N(X[ne-15])),X[ne-16]),he=O(O(O(O(re,M(Q)),E(Q,ee,te)),H[ne]),X[ne]),pe=O(I(Y),D(Y,z,W)),re=te,te=ee,ee=Q,Q=O(Z,he),Z=W,W=z,z=Y,Y=O(he,pe);U[0]=O(Y,U[0]),U[1]=O(z,U[1]),U[2]=O(W,U[2]),U[3]=O(Z,U[3]),U[4]=O(Q,U[4]),U[5]=O(ee,U[5]),U[6]=O(te,U[6]),U[7]=O(re,U[7])}return U};w.exports=function(V){return A.hash(V,F,32,!0)}},{"./helpers":532}],536:[function(_,w,B){w.exports=function(){return function(){}}},{}],537:[function(_,w,B){(function(A){(function(){var O=_("@babel/runtime/helpers/interopRequireDefault"),R=O(_("@babel/runtime/helpers/typeof")),P=_("stream"),E=P.Stream,D=_("../lib/common/utils/isArray"),I=D.isArray;w.exports.string=function(k){return typeof k=="string"},w.exports.array=I,w.exports.buffer=A.isBuffer;function M(N){return N instanceof E}w.exports.writableStream=function(k){return M(k)&&typeof k._write=="function"&&(0,R.default)(k._writableState)==="object"}}).call(this)}).call(this,{isBuffer:_("../node_modules/is-buffer/index.js")})},{"../lib/common/utils/isArray":67,"../node_modules/is-buffer/index.js":409,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/typeof":91,stream:468}],538:[function(_,w,B){var A=_("immediate"),O=w.exports={};O.nextTick=A,O.title="browser",O.browser=!0,O.env={},O.argv=[],O.version="",O.versions={};function R(){}O.on=R,O.addListener=R,O.once=R,O.off=R,O.removeListener=R,O.removeAllListeners=R,O.emit=R,O.prependListener=R,O.prependOnceListener=R,O.listeners=function(P){return[]},O.binding=function(P){throw new Error("process.binding is not supported")},O.cwd=function(){return"/"},O.chdir=function(P){throw new Error("process.chdir is not supported")},O.umask=function(){return 0}},{immediate:401}],539:[function(_,w,B){(function(A){(function(){_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.search.js");var O=_("./lib/request"),R=_("./lib/response"),P=_("xtend"),E=_("builtin-status-codes"),D=_("url"),I=B;I.request=function(M,N){typeof M=="string"?M=D.parse(M):M=P(M);var k=A.location.protocol.search(/^https?:$/)===-1?"http:":"",F=M.protocol||k,G=M.hostname||M.host,V=M.port,j=M.path||"/";G&&G.indexOf(":")!==-1&&(G="["+G+"]"),M.url=(G?F+"//"+G:"")+(V?":"+V:"")+j,M.method=(M.method||"GET").toUpperCase(),M.headers=M.headers||{};var H=new O(M);return N&&H.on("response",N),H},I.get=function(N,k){var F=I.request(N,k);return F.end(),F},I.ClientRequest=O,I.IncomingMessage=R.IncomingMessage,I.Agent=function(){},I.Agent.defaultMaxSockets=4,I.globalAgent=new I.Agent,I.STATUS_CODES=E,I.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"./lib/request":541,"./lib/response":542,"builtin-status-codes":104,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.search.js":346,url:543,xtend:530}],540:[function(_,w,B){(function(A){(function(){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.promise.js"),_("core-js/modules/es.array-buffer.constructor.js"),_("core-js/modules/es.array-buffer.slice.js"),_("core-js/modules/es.array.slice.js"),B.fetch=I(A.fetch)&&I(A.ReadableStream),B.writableStream=I(A.WritableStream),B.abortController=I(A.AbortController),B.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),B.blobConstructor=!0}catch(M){}var O;function R(){if(O!==void 0)return O;if(A.XMLHttpRequest){O=new A.XMLHttpRequest;try{O.open("GET",A.XDomainRequest?"/":"https://example.com")}catch(M){O=null}}else O=null;return O}function P(M){var N=R();if(!N)return!1;try{return N.responseType=M,N.responseType===M}catch(k){}return!1}var E=typeof A.ArrayBuffer<"u",D=E&&I(A.ArrayBuffer.prototype.slice);B.arraybuffer=B.fetch||E&&P("arraybuffer"),B.msstream=!B.fetch&&D&&P("ms-stream"),B.mozchunkedarraybuffer=!B.fetch&&E&&P("moz-chunked-arraybuffer"),B.overrideMimeType=B.fetch||(R()?I(R().overrideMimeType):!1),B.vbArray=I(A.VBArray);function I(M){return typeof M=="function"}O=null}).call(this)}).call(this,typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{})},{"core-js/modules/es.array-buffer.constructor.js":308,"core-js/modules/es.array-buffer.slice.js":309,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333}],541:[function(_,w,B){(function(A,O,R){(function(){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.regexp.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.array.map.js"),_("core-js/modules/es.function.name.js"),_("core-js/modules/es.promise.js");var P=_("./capability"),E=_("inherits"),D=_("./response"),I=_("readable-stream"),M=_("to-arraybuffer"),N=D.IncomingMessage,k=D.readyStates;function F(H,U){return P.fetch&&U?"fetch":P.mozchunkedarraybuffer?"moz-chunked-arraybuffer":P.msstream?"ms-stream":P.arraybuffer&&H?"arraybuffer":P.vbArray&&H?"text:vbarray":"text"}var G=w.exports=function(H){var U=this;I.Writable.call(U),U._opts=H,U._body=[],U._headers={},H.auth&&U.setHeader("Authorization","Basic "+new R(H.auth).toString("base64")),Object.keys(H.headers).forEach(function(z){U.setHeader(z,H.headers[z])});var X,Y=!0;if(H.mode==="disable-fetch"||"requestTimeout"in H&&!P.abortController)Y=!1,X=!0;else if(H.mode==="prefer-streaming")X=!1;else if(H.mode==="allow-wrong-content-type")X=!P.overrideMimeType;else if(!H.mode||H.mode==="default"||H.mode==="prefer-fast")X=!0;else throw new Error("Invalid value for opts.mode");U._mode=F(X,Y),U._fetchTimer=null,U.on("finish",function(){U._onFinish()})};E(G,I.Writable),G.prototype.setHeader=function(H,U){var X=this,Y=H.toLowerCase();j.indexOf(Y)===-1&&(X._headers[Y]={name:H,value:U})},G.prototype.getHeader=function(H){var U=this._headers[H.toLowerCase()];return U?U.value:null},G.prototype.removeHeader=function(H){var U=this;delete U._headers[H.toLowerCase()]},G.prototype._onFinish=function(){var H=this;if(!H._destroyed){var U=H._opts,X=H._headers,Y=null;U.method!=="GET"&&U.method!=="HEAD"&&(P.arraybuffer?Y=M(R.concat(H._body)):P.blobConstructor?Y=new O.Blob(H._body.map(function(ee){return M(ee)}),{type:(X["content-type"]||{}).value||""}):Y=R.concat(H._body).toString());var z=[];if(Object.keys(X).forEach(function(ee){var te=X[ee].name,re=X[ee].value;Array.isArray(re)?re.forEach(function(ie){z.push([te,ie])}):z.push([te,re])}),H._mode==="fetch"){var W=null;if(P.abortController){var Z=new AbortController;W=Z.signal,H._fetchAbortController=Z,"requestTimeout"in U&&U.requestTimeout!==0&&(H._fetchTimer=O.setTimeout(function(){H.emit("requestTimeout"),H._fetchAbortController&&H._fetchAbortController.abort()},U.requestTimeout))}O.fetch(H._opts.url,{method:H._opts.method,headers:z,body:Y||void 0,mode:"cors",credentials:U.withCredentials?"include":"same-origin",signal:W}).then(function(ee){H._fetchResponse=ee,H._connect()},function(ee){O.clearTimeout(H._fetchTimer),H._destroyed||H.emit("error",ee)})}else{var Q=H._xhr=new O.XMLHttpRequest;try{Q.open(H._opts.method,H._opts.url,!0)}catch(ee){A.nextTick(function(){H.emit("error",ee)});return}"responseType"in Q&&(Q.responseType=H._mode.split(":")[0]),"withCredentials"in Q&&(Q.withCredentials=!!U.withCredentials),H._mode==="text"&&"overrideMimeType"in Q&&Q.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in U&&(Q.timeout=U.requestTimeout,Q.ontimeout=function(){H.emit("requestTimeout")}),z.forEach(function(ee){Q.setRequestHeader(ee[0],ee[1])}),H._response=null,Q.onreadystatechange=function(){switch(Q.readyState){case k.LOADING:case k.DONE:H._onXHRProgress();break}},H._mode==="moz-chunked-arraybuffer"&&(Q.onprogress=function(){H._onXHRProgress()}),Q.onerror=function(){H._destroyed||H.emit("error",new Error("XHR error"))};try{Q.send(Y)}catch(ee){A.nextTick(function(){H.emit("error",ee)});return}}}};function V(H){try{var U=H.status;return U!==null&&U!==0}catch(X){return!1}}G.prototype._onXHRProgress=function(){var H=this;!V(H._xhr)||H._destroyed||(H._response||H._connect(),H._response._onXHRProgress())},G.prototype._connect=function(){var H=this;H._destroyed||(H._response=new N(H._xhr,H._fetchResponse,H._mode,H._fetchTimer),H._response.on("error",function(U){H.emit("error",U)}),H.emit("response",H._response))},G.prototype._write=function(H,U,X){var Y=this;Y._body.push(H),X()},G.prototype.abort=G.prototype.destroy=function(){var H=this;H._destroyed=!0,O.clearTimeout(H._fetchTimer),H._response&&(H._response._destroyed=!0),H._xhr?H._xhr.abort():H._fetchAbortController&&H._fetchAbortController.abort()},G.prototype.end=function(H,U,X){var Y=this;typeof H=="function"&&(X=H,H=void 0),I.Writable.prototype.end.call(Y,H,U,X)},G.prototype.flushHeaders=function(){},G.prototype.setTimeout=function(){},G.prototype.setNoDelay=function(){},G.prototype.setSocketKeepAlive=function(){};var j=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(this)}).call(this,_("_process"),typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{},_("buffer").Buffer)},{"./capability":540,"./response":542,_process:538,buffer:103,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.map.js":318,"core-js/modules/es.function.name.js":322,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.regexp.to-string.js":339,"core-js/modules/web.dom-collections.for-each.js":380,inherits:407,"readable-stream":463,"to-arraybuffer":485}],542:[function(_,w,B){(function(A,O,R){(function(){_("core-js/modules/es.object.to-string.js"),_("core-js/modules/web.dom-collections.for-each.js"),_("core-js/modules/es.promise.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.split.js"),_("core-js/modules/es.string.match.js"),_("core-js/modules/es.array.iterator.js"),_("core-js/modules/es.array-buffer.slice.js"),_("core-js/modules/es.typed-array.uint8-array.js"),_("core-js/modules/es.typed-array.copy-within.js"),_("core-js/modules/es.typed-array.every.js"),_("core-js/modules/es.typed-array.fill.js"),_("core-js/modules/es.typed-array.filter.js"),_("core-js/modules/es.typed-array.find.js"),_("core-js/modules/es.typed-array.find-index.js"),_("core-js/modules/es.typed-array.for-each.js"),_("core-js/modules/es.typed-array.includes.js"),_("core-js/modules/es.typed-array.index-of.js"),_("core-js/modules/es.typed-array.iterator.js"),_("core-js/modules/es.typed-array.join.js"),_("core-js/modules/es.typed-array.last-index-of.js"),_("core-js/modules/es.typed-array.map.js"),_("core-js/modules/es.typed-array.reduce.js"),_("core-js/modules/es.typed-array.reduce-right.js"),_("core-js/modules/es.typed-array.reverse.js"),_("core-js/modules/es.typed-array.set.js"),_("core-js/modules/es.typed-array.slice.js"),_("core-js/modules/es.typed-array.some.js"),_("core-js/modules/es.typed-array.sort.js"),_("core-js/modules/es.typed-array.subarray.js"),_("core-js/modules/es.typed-array.to-locale-string.js"),_("core-js/modules/es.typed-array.to-string.js"),_("core-js/modules/es.array.slice.js");var P=_("./capability"),E=_("inherits"),D=_("readable-stream"),I=B.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},M=B.IncomingMessage=function(N,k,F,G){var V=this;if(D.Readable.call(V),V._mode=F,V.headers={},V.rawHeaders=[],V.trailers={},V.rawTrailers=[],V.on("end",function(){A.nextTick(function(){V.emit("close")})}),F==="fetch"){var j=function W(){U.read().then(function(Z){if(!V._destroyed){if(Z.done){O.clearTimeout(G),V.push(null);return}V.push(new R(Z.value)),W()}}).catch(function(Z){O.clearTimeout(G),V._destroyed||V.emit("error",Z)})};if(V._fetchResponse=k,V.url=k.url,V.statusCode=k.status,V.statusMessage=k.statusText,k.headers.forEach(function(W,Z){V.headers[Z.toLowerCase()]=W,V.rawHeaders.push(Z,W)}),P.writableStream){var H=new WritableStream({write:function(Z){return new Promise(function(Q,ee){V._destroyed?ee():V.push(new R(Z))?Q():V._resumeFetch=Q})},close:function(){O.clearTimeout(G),V._destroyed||V.push(null)},abort:function(Z){V._destroyed||V.emit("error",Z)}});try{k.body.pipeTo(H).catch(function(W){O.clearTimeout(G),V._destroyed||V.emit("error",W)});return}catch(W){}}var U=k.body.getReader();j()}else{V._xhr=N,V._pos=0,V.url=N.responseURL,V.statusCode=N.status,V.statusMessage=N.statusText;var X=N.getAllResponseHeaders().split(/\r?\n/);if(X.forEach(function(W){var Z=W.match(/^([^:]+):\s*(.*)/);if(Z){var Q=Z[1].toLowerCase();Q==="set-cookie"?(V.headers[Q]===void 0&&(V.headers[Q]=[]),V.headers[Q].push(Z[2])):V.headers[Q]!==void 0?V.headers[Q]+=", "+Z[2]:V.headers[Q]=Z[2],V.rawHeaders.push(Z[1],Z[2])}}),V._charset="x-user-defined",!P.overrideMimeType){var Y=V.rawHeaders["mime-type"];if(Y){var z=Y.match(/;\s*charset=([^;])(;|$)/);z&&(V._charset=z[1].toLowerCase())}V._charset||(V._charset="utf-8")}}};E(M,D.Readable),M.prototype._read=function(){var N=this,k=N._resumeFetch;k&&(N._resumeFetch=null,k())},M.prototype._onXHRProgress=function(){var N=this,k=N._xhr,F=null;switch(N._mode){case"text:vbarray":if(k.readyState!==I.DONE)break;try{F=new O.VBArray(k.responseBody).toArray()}catch(U){}if(F!==null){N.push(new R(F));break}case"text":try{F=k.responseText}catch(U){N._mode="text:vbarray";break}if(F.length>N._pos){var G=F.substr(N._pos);if(N._charset==="x-user-defined"){for(var V=new R(G.length),j=0;j<G.length;j++)V[j]=G.charCodeAt(j)&255;N.push(V)}else N.push(G,N._charset);N._pos=F.length}break;case"arraybuffer":if(k.readyState!==I.DONE||!k.response)break;F=k.response,N.push(new R(new Uint8Array(F)));break;case"moz-chunked-arraybuffer":if(F=k.response,k.readyState!==I.LOADING||!F)break;N.push(new R(new Uint8Array(F)));break;case"ms-stream":if(F=k.response,k.readyState!==I.LOADING)break;var H=new O.MSStreamReader;H.onprogress=function(){H.result.byteLength>N._pos&&(N.push(new R(new Uint8Array(H.result.slice(N._pos)))),N._pos=H.result.byteLength)},H.onload=function(){N.push(null)},H.readAsArrayBuffer(F);break}N._xhr.readyState===I.DONE&&N._mode!=="ms-stream"&&N.push(null)}}).call(this)}).call(this,_("_process"),typeof T<"u"?T:typeof self<"u"?self:typeof window<"u"?window:{},_("buffer").Buffer)},{"./capability":540,_process:538,buffer:103,"core-js/modules/es.array-buffer.slice.js":309,"core-js/modules/es.array.iterator.js":316,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.match.js":344,"core-js/modules/es.string.split.js":347,"core-js/modules/es.typed-array.copy-within.js":356,"core-js/modules/es.typed-array.every.js":357,"core-js/modules/es.typed-array.fill.js":358,"core-js/modules/es.typed-array.filter.js":359,"core-js/modules/es.typed-array.find-index.js":360,"core-js/modules/es.typed-array.find.js":361,"core-js/modules/es.typed-array.for-each.js":362,"core-js/modules/es.typed-array.includes.js":363,"core-js/modules/es.typed-array.index-of.js":364,"core-js/modules/es.typed-array.iterator.js":365,"core-js/modules/es.typed-array.join.js":366,"core-js/modules/es.typed-array.last-index-of.js":367,"core-js/modules/es.typed-array.map.js":368,"core-js/modules/es.typed-array.reduce-right.js":369,"core-js/modules/es.typed-array.reduce.js":370,"core-js/modules/es.typed-array.reverse.js":371,"core-js/modules/es.typed-array.set.js":372,"core-js/modules/es.typed-array.slice.js":373,"core-js/modules/es.typed-array.some.js":374,"core-js/modules/es.typed-array.sort.js":375,"core-js/modules/es.typed-array.subarray.js":376,"core-js/modules/es.typed-array.to-locale-string.js":377,"core-js/modules/es.typed-array.to-string.js":378,"core-js/modules/es.typed-array.uint8-array.js":379,"core-js/modules/web.dom-collections.for-each.js":380,inherits:407,"readable-stream":463}],543:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/helpers/typeof"));_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.string.search.js"),_("core-js/modules/es.array.concat.js"),_("core-js/modules/es.string.split.js"),_("core-js/modules/es.string.replace.js"),_("core-js/modules/es.array.join.js"),_("core-js/modules/es.string.trim.js"),_("core-js/modules/es.string.match.js"),_("core-js/modules/es.array.slice.js"),_("core-js/modules/es.object.keys.js"),_("core-js/modules/es.array.splice.js");var R=_("punycode"),P=_("./util");B.parse=Z,B.resolve=ee,B.resolveObject=te,B.format=Q,B.Url=E;function E(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var D=/^([a-z0-9.+-]+:)/i,I=/:[0-9]*$/,M=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,N=["<",">",'"',"`"," ","\r","\n","	"],k=["{","}","|","\\","^","`"].concat(N),F=["'"].concat(k),G=["%","/","?",";","#"].concat(F),V=["/","?","#"],j=255,H=/^[+a-z0-9A-Z_-]{0,63}$/,U=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,X={javascript:!0,"javascript:":!0},Y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},W=_("querystring");function Z(re,ie,ne){if(re&&P.isObject(re)&&re instanceof E)return re;var he=new E;return he.parse(re,ie,ne),he}E.prototype.parse=function(re,ie,ne){if(!P.isString(re))throw new TypeError("Parameter 'url' must be a string, not "+(0,O.default)(re));var he=re.indexOf("?"),pe=he!==-1&&he<re.indexOf("#")?"?":"#",K=re.split(pe),ue=/\\/g;K[0]=K[0].replace(ue,"/"),re=K.join(pe);var le=re;if(le=le.trim(),!ne&&re.split("#").length===1){var ce=M.exec(le);if(ce)return this.path=le,this.href=le,this.pathname=ce[1],ce[2]?(this.search=ce[2],ie?this.query=W.parse(this.search.substr(1)):this.query=this.search.substr(1)):ie&&(this.search="",this.query={}),this}var _e=D.exec(le);if(_e){_e=_e[0];var oe=_e.toLowerCase();this.protocol=oe,le=le.substr(_e.length)}if(ne||_e||le.match(/^\/\/[^@\/]+@[^@\/]+/)){var de=le.substr(0,2)==="//";de&&!(_e&&Y[_e])&&(le=le.substr(2),this.slashes=!0)}if(!Y[_e]&&(de||_e&&!z[_e])){for(var me=-1,ye=0;ye<V.length;ye++){var ge=le.indexOf(V[ye]);ge!==-1&&(me===-1||ge<me)&&(me=ge)}var we,Te;me===-1?Te=le.lastIndexOf("@"):Te=le.lastIndexOf("@",me),Te!==-1&&(we=le.slice(0,Te),le=le.slice(Te+1),this.auth=decodeURIComponent(we)),me=-1;for(var ye=0;ye<G.length;ye++){var ge=le.indexOf(G[ye]);ge!==-1&&(me===-1||ge<me)&&(me=ge)}me===-1&&(me=le.length),this.host=le.slice(0,me),le=le.slice(me),this.parseHost(),this.hostname=this.hostname||"";var Ee=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Ee)for(var De=this.hostname.split("."),ye=0,fe=De.length;ye<fe;ye++){var Ce=De[ye];if(Ce&&!Ce.match(H)){for(var Se="",be=0,Re=Ce.length;be<Re;be++)Ce.charCodeAt(be)>127?Se+="x":Se+=Ce[be];if(!Se.match(H)){var Ve=De.slice(0,ye),Pe=De.slice(ye+1),ke=Ce.match(U);ke&&(Ve.push(ke[1]),Pe.unshift(ke[2])),Pe.length&&(le="/"+Pe.join(".")+le),this.hostname=Ve.join(".");break}}}this.hostname.length>j?this.hostname="":this.hostname=this.hostname.toLowerCase(),Ee||(this.hostname=R.toASCII(this.hostname));var Ne=this.port?":"+this.port:"",Ae=this.hostname||"";this.host=Ae+Ne,this.href+=this.host,Ee&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),le[0]!=="/"&&(le="/"+le))}if(!X[oe])for(var ye=0,fe=F.length;ye<fe;ye++){var Oe=F[ye];if(le.indexOf(Oe)!==-1){var Fe=encodeURIComponent(Oe);Fe===Oe&&(Fe=escape(Oe)),le=le.split(Oe).join(Fe)}}var nt=le.indexOf("#");nt!==-1&&(this.hash=le.substr(nt),le=le.slice(0,nt));var Ze=le.indexOf("?");if(Ze!==-1?(this.search=le.substr(Ze),this.query=le.substr(Ze+1),ie&&(this.query=W.parse(this.query)),le=le.slice(0,Ze)):ie&&(this.search="",this.query={}),le&&(this.pathname=le),z[oe]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Ne=this.pathname||"",Xe=this.search||"";this.path=Ne+Xe}return this.href=this.format(),this};function Q(re){return P.isString(re)&&(re=Z(re)),re instanceof E?re.format():E.prototype.format.call(re)}E.prototype.format=function(){var re=this.auth||"";re&&(re=encodeURIComponent(re),re=re.replace(/%3A/i,":"),re+="@");var ie=this.protocol||"",ne=this.pathname||"",he=this.hash||"",pe=!1,K="";this.host?pe=re+this.host:this.hostname&&(pe=re+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(pe+=":"+this.port)),this.query&&P.isObject(this.query)&&Object.keys(this.query).length&&(K=W.stringify(this.query));var ue=this.search||K&&"?"+K||"";return ie&&ie.substr(-1)!==":"&&(ie+=":"),this.slashes||(!ie||z[ie])&&pe!==!1?(pe="//"+(pe||""),ne&&ne.charAt(0)!=="/"&&(ne="/"+ne)):pe||(pe=""),he&&he.charAt(0)!=="#"&&(he="#"+he),ue&&ue.charAt(0)!=="?"&&(ue="?"+ue),ne=ne.replace(/[?#]/g,function(le){return encodeURIComponent(le)}),ue=ue.replace("#","%23"),ie+pe+ne+ue+he};function ee(re,ie){return Z(re,!1,!0).resolve(ie)}E.prototype.resolve=function(re){return this.resolveObject(Z(re,!1,!0)).format()};function te(re,ie){return re?Z(re,!1,!0).resolveObject(ie):ie}E.prototype.resolveObject=function(re){if(P.isString(re)){var ie=new E;ie.parse(re,!1,!0),re=ie}for(var ne=new E,he=Object.keys(this),pe=0;pe<he.length;pe++){var K=he[pe];ne[K]=this[K]}if(ne.hash=re.hash,re.href==="")return ne.href=ne.format(),ne;if(re.slashes&&!re.protocol){for(var ue=Object.keys(re),le=0;le<ue.length;le++){var ce=ue[le];ce!=="protocol"&&(ne[ce]=re[ce])}return z[ne.protocol]&&ne.hostname&&!ne.pathname&&(ne.path=ne.pathname="/"),ne.href=ne.format(),ne}if(re.protocol&&re.protocol!==ne.protocol){if(!z[re.protocol]){for(var _e=Object.keys(re),oe=0;oe<_e.length;oe++){var de=_e[oe];ne[de]=re[de]}return ne.href=ne.format(),ne}if(ne.protocol=re.protocol,!re.host&&!Y[re.protocol]){for(var fe=(re.pathname||"").split("/");fe.length&&!(re.host=fe.shift()););re.host||(re.host=""),re.hostname||(re.hostname=""),fe[0]!==""&&fe.unshift(""),fe.length<2&&fe.unshift(""),ne.pathname=fe.join("/")}else ne.pathname=re.pathname;if(ne.search=re.search,ne.query=re.query,ne.host=re.host||"",ne.auth=re.auth,ne.hostname=re.hostname||re.host,ne.port=re.port,ne.pathname||ne.search){var me=ne.pathname||"",ye=ne.search||"";ne.path=me+ye}return ne.slashes=ne.slashes||re.slashes,ne.href=ne.format(),ne}var ge=ne.pathname&&ne.pathname.charAt(0)==="/",we=re.host||re.pathname&&re.pathname.charAt(0)==="/",Te=we||ge||ne.host&&re.pathname,Ee=Te,De=ne.pathname&&ne.pathname.split("/")||[],fe=re.pathname&&re.pathname.split("/")||[],Ce=ne.protocol&&!z[ne.protocol];if(Ce&&(ne.hostname="",ne.port=null,ne.host&&(De[0]===""?De[0]=ne.host:De.unshift(ne.host)),ne.host="",re.protocol&&(re.hostname=null,re.port=null,re.host&&(fe[0]===""?fe[0]=re.host:fe.unshift(re.host)),re.host=null),Te=Te&&(fe[0]===""||De[0]==="")),we)ne.host=re.host||re.host===""?re.host:ne.host,ne.hostname=re.hostname||re.hostname===""?re.hostname:ne.hostname,ne.search=re.search,ne.query=re.query,De=fe;else if(fe.length)De||(De=[]),De.pop(),De=De.concat(fe),ne.search=re.search,ne.query=re.query;else if(!P.isNullOrUndefined(re.search)){if(Ce){ne.hostname=ne.host=De.shift();var Se=ne.host&&ne.host.indexOf("@")>0?ne.host.split("@"):!1;Se&&(ne.auth=Se.shift(),ne.host=ne.hostname=Se.shift())}return ne.search=re.search,ne.query=re.query,(!P.isNull(ne.pathname)||!P.isNull(ne.search))&&(ne.path=(ne.pathname?ne.pathname:"")+(ne.search?ne.search:"")),ne.href=ne.format(),ne}if(!De.length)return ne.pathname=null,ne.search?ne.path="/"+ne.search:ne.path=null,ne.href=ne.format(),ne;for(var be=De.slice(-1)[0],Re=(ne.host||re.host||De.length>1)&&(be==="."||be==="..")||be==="",Ve=0,Pe=De.length;Pe>=0;Pe--)be=De[Pe],be==="."?De.splice(Pe,1):be===".."?(De.splice(Pe,1),Ve++):Ve&&(De.splice(Pe,1),Ve--);if(!Te&&!Ee)for(;Ve--;Ve)De.unshift("..");Te&&De[0]!==""&&(!De[0]||De[0].charAt(0)!=="/")&&De.unshift(""),Re&&De.join("/").substr(-1)!=="/"&&De.push("");var ke=De[0]===""||De[0]&&De[0].charAt(0)==="/";if(Ce){ne.hostname=ne.host=ke?"":De.length?De.shift():"";var Se=ne.host&&ne.host.indexOf("@")>0?ne.host.split("@"):!1;Se&&(ne.auth=Se.shift(),ne.host=ne.hostname=Se.shift())}return Te=Te||ne.host&&De.length,Te&&!ke&&De.unshift(""),De.length?ne.pathname=De.join("/"):(ne.pathname=null,ne.path=null),(!P.isNull(ne.pathname)||!P.isNull(ne.search))&&(ne.path=(ne.pathname?ne.pathname:"")+(ne.search?ne.search:"")),ne.auth=re.auth||ne.auth,ne.slashes=ne.slashes||re.slashes,ne.href=ne.format(),ne},E.prototype.parseHost=function(){var re=this.host,ie=I.exec(re);ie&&(ie=ie[0],ie!==":"&&(this.port=ie.substr(1)),re=re.substr(0,re.length-ie.length)),re&&(this.hostname=re)}},{"./util":544,"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/typeof":91,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.array.join.js":317,"core-js/modules/es.array.slice.js":319,"core-js/modules/es.array.splice.js":321,"core-js/modules/es.object.keys.js":328,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.match.js":344,"core-js/modules/es.string.replace.js":345,"core-js/modules/es.string.search.js":346,"core-js/modules/es.string.split.js":347,"core-js/modules/es.string.trim.js":349,punycode:443,querystring:451}],544:[function(_,w,B){var A=_("@babel/runtime/helpers/interopRequireDefault"),O=A(_("@babel/runtime/helpers/typeof"));w.exports={isString:function(P){return typeof P=="string"},isObject:function(P){return(0,O.default)(P)==="object"&&P!==null},isNull:function(P){return P===null},isNullOrUndefined:function(P){return P==null}}},{"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/typeof":91}],545:[function(_,w,B){_("core-js/modules/es.number.constructor.js"),B.encodeURIComponent=function(A){try{return encodeURIComponent(A)}catch(O){return A}},B.escape=_("escape-html"),B.timestamp=function(O){if(O){var R=O;return typeof R=="string"&&(R=Number(R)),String(O).length===10&&(R*=1e3),new Date(R)}return Math.round(Date.now()/1e3)}},{"core-js/modules/es.number.constructor.js":324,"escape-html":385}],546:[function(_,w,B){(function(A,O){(function(){var R=_("@babel/runtime/helpers/interopRequireDefault"),P=R(_("@babel/runtime/helpers/typeof"));_("core-js/modules/es.string.trim.js"),_("core-js/modules/es.object.to-string.js"),_("core-js/modules/es.promise.js"),_("core-js/modules/es.regexp.exec.js"),_("core-js/modules/es.function.name.js"),_("core-js/modules/es.array.concat.js");var E=_("util"),D=_("url"),I=_("http"),M=_("https"),N=_("debug")("urllib"),k=_("humanize-ms"),F=0,G=Math.pow(2,31)-10,V=/^https?:\/\//i;function j(Y,z){return Y===void 0?z:Y}function H(Y){return Y?Y.split(";")[0].trim().toLowerCase():""}function U(Y,z){return function(W,Z,Q){if(W)return z(W);Y({data:Z,status:Q.statusCode,headers:Q.headers,res:Q})}}B.TIMEOUTS=[k("300s"),k("300s")];var X=["json","text"];B.request=function(z,W,Z){return arguments.length===2&&typeof W=="function"&&(Z=W,W=null),typeof Z=="function"?B.requestWithCallback(z,W,Z):new Promise(function(Q,ee){B.requestWithCallback(z,W,U(Q,ee))})},B.requestWithCallback=function(z,W,Z){if(!z||typeof z!="string"&&(0,P.default)(z)!=="object"){var Q=E.format("expect request url to be a string or a http request options, but got %j",z);throw new Error(Q)}arguments.length===2&&typeof W=="function"&&(Z=W,W=null),W=W||{},F>=G&&(F=0);var ee=++F;W.requestUrls=W.requestUrls||[];var te={requestId:ee,url:z,args:W,ctx:W.ctx};W.emitter&&W.emitter.emit("request",te),W.timeout=W.timeout||B.TIMEOUTS,W.maxRedirects=W.maxRedirects||10,W.streaming=W.streaming||W.customResponse;var re=Date.now(),ie;typeof z=="string"?(V.test(z)||(z="https://"+z),ie=D.parse(z)):ie=z;var ne=(W.type||W.method||ie.method||"GET").toUpperCase(),he=ie.port||80,pe=I,K=j(W.agent,B.agent),ue=W.fixJSONCtlChars;ie.protocol==="https:"&&(pe=M,K=j(W.httpsAgent,B.httpsAgent),ie.port||(he=443));var le={host:ie.hostname||ie.host||"localhost",path:ie.path||"/",method:ne,port:he,agent:K,headers:W.headers||{},lookup:W.lookup};Array.isArray(W.timeout)?le.requestTimeout=W.timeout[W.timeout.length-1]:typeof W.timeout<"u"&&(le.requestTimeout=W.timeout);var ce=W.auth||ie.auth;ce&&(le.auth=ce);var _e=W.content||W.data,oe=ne==="GET"||ne==="HEAD"||W.dataAsQueryString;if(!W.content&&_e&&!(typeof _e=="string"||O.isBuffer(_e)))if(oe)_e=W.nestedQuerystring?qs.stringify(_e):querystring.stringify(_e);else{var de=le.headers["Content-Type"]||le.headers["content-type"];de||(W.contentType==="json"?de="application/json":de="application/x-www-form-urlencoded",le.headers["Content-Type"]=de),H(de)==="application/json"?_e=JSON.stringify(_e):_e=W.nestedQuerystring?qs.stringify(_e):querystring.stringify(_e)}oe&&_e&&(le.path+=(ie.query?"&":"?")+_e,_e=null);var me=0;if(_e){var ye=_e.length;O.isBuffer(_e)||(ye=O.byteLength(_e)),me=le.headers["Content-Length"]=ye}W.dataType==="json"&&(le.headers.Accept="application/json"),typeof W.beforeRequest=="function"&&W.beforeRequest(le);var ge=null,we=null,Te=null,Ee=!1,De=!1,fe=0,Ce=-1,Se=!1,be="",Re="",Ve=null;W.timing&&(Ve={queuing:0,dnslookup:0,connected:0,requestSent:0,waiting:0,contentDownload:0});function Pe(){ge&&(clearTimeout(ge),ge=null)}function ke(){we&&(clearTimeout(we),we=null)}function Ne(Ue,We,ht){if(ke(),!Z){console.warn("[urllib:warn] [%s] [%s] [worker:%s] %s %s callback twice!!!",Date(),ee,A.pid,le.method,z),Ue&&console.warn("[urllib:warn] [%s] [%s] [worker:%s] %s: %s\nstack: %s",Date(),ee,A.pid,Ue.name,Ue.message,Ue.stack);return}var Be=Z;Z=null;var je={};ht&&(Ce=ht.statusCode,je=ht.headers);var Qe=Date.now()-re;Ve&&(Ve.contentDownload=Qe),N("[%sms] done, %s bytes HTTP %s %s %s %s, keepAliveSocket: %s, timing: %j",Qe,fe,Ce,le.method,le.host,le.path,De,Ve);var st={status:Ce,statusCode:Ce,headers:je,size:fe,aborted:Se,rt:Qe,keepAliveSocket:De,data:We,requestUrls:W.requestUrls,timing:Ve,remoteAddress:be,remotePort:Re};if(Ue){var pt="";K&&typeof K.getCurrentStatus=="function"&&(pt=", agent status: "+JSON.stringify(K.getCurrentStatus())),Ue.message+=", "+le.method+" "+z+" "+Ce+" (connected: "+Ee+", keepalive socket: "+De+pt+")\nheaders: "+JSON.stringify(je),Ue.data=We,Ue.path=le.path,Ue.status=Ce,Ue.headers=je,Ue.res=st}Be(Ue,We,W.streaming?ht:st),W.emitter&&(te.url=z,te.socket=ut&&ut.connection,te.options=le,te.size=me,W.emitter.emit("response",{requestId:ee,error:Ue,ctx:W.ctx,req:te,res:st}))}function Ae(Ue){var We=null;if(W.followRedirect&&statuses.redirect[Ue.statusCode]){W._followRedirectCount=(W._followRedirectCount||0)+1;var ht=Ue.headers.location;if(!ht)We=new Error("Got statusCode "+Ue.statusCode+" but cannot resolve next location from headers"),We.name="FollowRedirectError";else if(W._followRedirectCount>W.maxRedirects)We=new Error("Exceeded maxRedirects. Probably stuck in a redirect loop "+z),We.name="MaxRedirectError";else{var Be=W.formatRedirectUrl?W.formatRedirectUrl(z,ht):D.resolve(z,ht);N("Request#%d %s: `redirected` from %s to %s",ee,le.path,z,Be),ke(),W.headers&&W.headers.Host&&V.test(ht)&&(W.headers.Host=null);var je=Z;return Z=null,B.requestWithCallback(Be,W,je),{redirect:!0,error:null}}}return{redirect:!1,error:We}}W.gzip&&!le.headers["Accept-Encoding"]&&!le.headers["accept-encoding"]&&(le.headers["Accept-Encoding"]="gzip");function Oe(Ue,We,ht){var Be=Ue.headers["content-encoding"];return ht(null,We,Be)}var Fe=W.writeStream;N("Request#%d %s %s with headers %j, options.path: %s",ee,ne,z,le.headers,le.path),W.requestUrls.push(z);function nt(Ue){if(Ve&&(Ve.waiting=Date.now()-re),N("Request#%d %s `req response` event emit: status %d, headers: %j",ee,z,Ue.statusCode,Ue.headers),W.streaming){var We=Ae(Ue);if(We.redirect){Ue.resume();return}return We.error?(Ue.resume(),Ne(We.error,null,Ue)):Ne(null,null,Ue)}if(Ue.on("close",function(){N("Request#%d %s: `res close` event emit, total size %d",ee,z,fe)}),Ue.on("error",function(){N("Request#%d %s: `res error` event emit, total size %d",ee,z,fe)}),Ue.on("aborted",function(){Se=!0,N("Request#%d %s: `res aborted` event emit, total size %d",ee,z,fe)}),Fe){var ht=Ae(Ue);if(ht.redirect){Ue.resume();return}return ht.error?(Ue.resume(),Fe.end(),Ne(ht.error,null,Ue)):(W.consumeWriteStream===!1?Ue.on("end",Ne.bind(null,null,null,Ue)):Fe.on("close",function(){N("Request#%d %s: writeStream close event emitted",ee,z),Ne(Te||null,null,Ue)}),Ue.pipe(Fe))}var Be=[];Ue.on("data",function(je){N("Request#%d %s: `res data` event emit, size %d",ee,z,je.length),fe+=je.length,Be.push(je)}),Ue.on("end",function(){var je=O.concat(Be,fe);if(N("Request#%d %s: `res end` event emit, total size %d, _dumped: %s",ee,z,fe,Ue._dumped),Te)return Ne(Te,je,Ue);var Qe=Ae(Ue);if(Qe.error)return Ne(Qe.error,je,Ue);Qe.redirect||Oe(Ue,je,function(st,pt,qe){if(st)return Ne(st,je,Ue);if(!qe&&X.indexOf(W.dataType)>=0){try{pt=decodeBodyByCharset(pt,Ue)}catch(bt){return N("decodeBodyByCharset error: %s",bt),Ne(null,pt,Ue)}if(W.dataType==="json")if(fe===0)pt=null;else{var rt=parseJSON(pt,ue);rt.error?st=rt.error:pt=rt.data}}Se&&N("Request#%d %s: Remote socket was terminated before `response.end()` was called",ee,z),Ne(st,pt,Ue)})})}var Ze,Xe;Array.isArray(W.timeout)?(Ze=k(W.timeout[0]),Xe=k(W.timeout[1])):Ze=Xe=k(W.timeout),N("ConnectTimeout: %d, ResponseTimeout: %d",Ze,Xe);function $e(){N("Connect timer ticking, timeout: %d",Ze),ge=setTimeout(function(){ge=null,Ce===-1&&(Ce=-2);var Ue="Connect timeout for "+Ze+"ms",We="ConnectionTimeoutError";ut.socket||(We="SocketAssignTimeoutError",Ue+=", working sockets is full"),Te=new Error(Ue),Te.name=We,Te.requestId=ee,N("ConnectTimeout: Request#%d %s %s: %s, connected: %s",ee,z,Te.name,Ue,Ee),gt()},Ze)}function ot(){N("Response timer ticking, timeout: %d",Xe),we=setTimeout(function(){we=null;var Ue="Response timeout for "+Xe+"ms",We="ResponseTimeoutError";Te=new Error(Ue),Te.name=We,Te.requestId=ee,N("ResponseTimeout: Request#%d %s %s: %s, connected: %s",ee,z,Te.name,Ue,Ee),gt()},Xe)}var ut;le.mode=W.mode?W.mode:"";try{ut=pe.request(le,nt)}catch(Ue){return Ne(Ue)}typeof window>"u"?$e():ut.on("requestTimeout",function(){Ce===-1&&(Ce=-2);var Ue="Connect timeout for "+Ze+"ms",We="ConnectionTimeoutError";Te=new Error(Ue),Te.name=We,Te.requestId=ee,gt()});function gt(){N("Request#%d %s abort, connected: %s",ee,z,Ee),ut.socket||(Te.noSocket=!0,Ne(Te)),ut.abort()}return Ve&&ut.on("finish",function(){Ve.requestSent=Date.now()-re}),ut.once("socket",function(Ue){Ve&&(Ve.queuing=Date.now()-re);var We=Ue.readyState;if(We==="opening"){Ue.once("lookup",function(ht,Be,je){N("Request#%d %s lookup: %s, %s, %s",ee,z,ht,Be,je),Ve&&(Ve.dnslookup=Date.now()-re),Be&&(be=Be)}),Ue.once("connect",function(){Ve&&(Ve.connected=Date.now()-re),Pe(),ot(),N("Request#%d %s new socket connected",ee,z),Ee=!0,be||(be=Ue.remoteAddress),Re=Ue.remotePort});return}N("Request#%d %s reuse socket connected, readyState: %s",ee,z,We),Ee=!0,De=!0,be||(be=Ue.remoteAddress),Re=Ue.remotePort,Pe(),ot()}),ut.on("error",function(Ue){(Ue.name==="Error"||Ue.name==="TypeError")&&(Ue.name=Ee?"ResponseError":"RequestError"),Ue.message+=' (req "error")',N("Request#%d %s `req error` event emit, %s: %s",ee,z,Ue.name,Ue.message),Ne(Te||Ue)}),Fe&&Fe.once("error",function(Ue){Ue.message+=' (writeStream "error")',Te=Ue,N("Request#%d %s `writeStream error` event emit, %s: %s",ee,z,Ue.name,Ue.message),gt()}),W.stream?(W.stream.pipe(ut),W.stream.once("error",function(Ue){Ue.message+=' (stream "error")',Te=Ue,N("Request#%d %s `readStream error` event emit, %s: %s",ee,z,Ue.name,Ue.message),gt()})):ut.end(_e),ut.requestId=ee,ut}}).call(this)}).call(this,_("_process"),_("buffer").Buffer)},{"@babel/runtime/helpers/interopRequireDefault":86,"@babel/runtime/helpers/typeof":91,_process:538,buffer:103,"core-js/modules/es.array.concat.js":310,"core-js/modules/es.function.name.js":322,"core-js/modules/es.object.to-string.js":329,"core-js/modules/es.promise.js":333,"core-js/modules/es.regexp.exec.js":338,"core-js/modules/es.string.trim.js":349,debug:536,http:539,https:398,"humanize-ms":399,url:543,util:489}]},{},[1])(1)})})(window)}(aliyunOssSdk$1)),aliyunOssSdk$1.exports}var aliyunOssSdkExports=requireAliyunOssSdk();const aliyunOssSdk=getDefaultExportFromCjs(aliyunOssSdkExports);var strChineseFirstPY="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY",oMultiDiff={19969:"DZ",19975:"WM",19988:"QJ",20048:"YL",20056:"SC",20060:"NM",20094:"QG",20127:"QJ",20167:"QC",20193:"YG",20250:"KH",20256:"ZC",20282:"SC",20285:"QJG",20291:"TD",20314:"YD",20340:"NE",20375:"TD",20389:"YJ",20391:"CZ",20415:"PB",20446:"YS",20447:"SQ",20504:"TC",20608:"KG",20854:"QJ",20857:"ZC",20911:"PF",20504:"TC",20608:"KG",20854:"QJ",20857:"ZC",20911:"PF",20985:"AW",21032:"PB",21048:"XQ",21049:"SC",21089:"YS",21119:"JC",21242:"SB",21273:"SC",21305:"YP",21306:"QO",21330:"ZC",21333:"SDC",21345:"QK",21378:"CA",21397:"SC",21414:"XS",21442:"SC",21477:"JG",21480:"TD",21484:"ZS",21494:"YX",21505:"YX",21512:"HG",21523:"XH",21537:"PB",21542:"PF",21549:"KH",21571:"E",21574:"DA",21588:"TD",21589:"O",21618:"ZC",21621:"KHA",21632:"ZJ",21654:"KG",21679:"LKG",21683:"KH",21710:"A",21719:"YH",21734:"WOE",21769:"A",21780:"WN",21804:"XH",21834:"A",21899:"ZD",21903:"RN",21908:"WO",21939:"ZC",21956:"SA",21964:"YA",21970:"TD",22003:"A",22031:"JG",22040:"XS",22060:"ZC",22066:"ZC",22079:"MH",22129:"XJ",22179:"XA",22237:"NJ",22244:"TD",22280:"JQ",22300:"YH",22313:"XW",22331:"YQ",22343:"YJ",22351:"PH",22395:"DC",22412:"TD",22484:"PB",22500:"PB",22534:"ZD",22549:"DH",22561:"PB",22612:"TD",22771:"KQ",22831:"HB",22841:"JG",22855:"QJ",22865:"XQ",23013:"ML",23081:"WM",23487:"SX",23558:"QJ",23561:"YW",23586:"YW",23614:"YW",23615:"SN",23631:"PB",23646:"ZS",23663:"ZT",23673:"YG",23762:"TD",23769:"ZS",23780:"QJ",23884:"QK",24055:"XH",24113:"DC",24162:"ZC",24191:"GA",24273:"QJ",24324:"NL",24377:"TD",24378:"QJ",24439:"PF",24554:"ZS",24683:"TD",24694:"WE",24733:"LK",24925:"TN",25094:"ZG",25100:"XQ",25103:"XH",25153:"PB",25170:"PB",25179:"KG",25203:"PB",25240:"ZS",25282:"FB",25303:"NA",25324:"KG",25341:"ZY",25373:"WZ",25375:"XJ",25384:"A",25457:"A",25528:"SD",25530:"SC",25552:"TD",25774:"ZC",25874:"ZC",26044:"YW",26080:"WM",26292:"PB",26333:"PB",26355:"ZY",26366:"CZ",26397:"ZC",26399:"QJ",26415:"ZS",26451:"SB",26526:"ZC",26552:"JG",26561:"TD",26588:"JG",26597:"CZ",26629:"ZS",26638:"YL",26646:"XQ",26653:"KG",26657:"XJ",26727:"HG",26894:"ZC",26937:"ZS",26946:"ZC",26999:"KJ",27099:"KJ",27449:"YQ",27481:"XS",27542:"ZS",27663:"ZS",27748:"TS",27784:"SC",27788:"ZD",27795:"TD",27812:"O",27850:"PB",27852:"MB",27895:"SL",27898:"PL",27973:"QJ",27981:"KH",27986:"HX",27994:"XJ",28044:"YC",28065:"WG",28177:"SM",28267:"QJ",28291:"KH",28337:"ZQ",28463:"TL",28548:"DC",28601:"TD",28689:"PB",28805:"JG",28820:"QG",28846:"PB",28952:"TD",28975:"ZC",29100:"A",29325:"QJ",29575:"SL",29602:"FB",30010:"TD",30044:"CX",30058:"PF",30091:"YSP",30111:"YN",30229:"XJ",30427:"SC",30465:"SX",30631:"YQ",30655:"QJ",30684:"QJG",30707:"SD",30729:"XH",30796:"LG",30917:"PB",31074:"NM",31085:"JZ",31109:"SC",31181:"ZC",31192:"MLB",31293:"JQ",31400:"YX",31584:"YJ",31896:"ZN",31909:"ZY",31995:"XJ",32321:"PF",32327:"ZY",32418:"HG",32420:"XQ",32421:"HG",32438:"LG",32473:"GJ",32488:"TD",32521:"QJ",32527:"PB",32562:"ZSQ",32564:"JZ",32735:"ZD",32793:"PB",33071:"PF",33098:"XL",33100:"YA",33152:"PB",33261:"CX",33324:"BP",33333:"TD",33406:"YA",33426:"WM",33432:"PB",33445:"JG",33486:"ZN",33493:"TS",33507:"QJ",33540:"QJ",33544:"ZC",33564:"XQ",33617:"YT",33632:"QJ",33636:"XH",33637:"YX",33694:"WG",33705:"PF",33728:"YW",33882:"SR",34067:"WM",34074:"YW",34121:"QJ",34255:"ZC",34259:"XL",34425:"JH",34430:"XH",34485:"KH",34503:"YS",34532:"HG",34552:"XS",34558:"YE",34593:"ZL",34660:"YQ",34892:"XH",34928:"SC",34999:"QJ",35048:"PB",35059:"SC",35098:"ZC",35203:"TQ",35265:"JX",35299:"JX",35782:"SZ",35828:"YS",35830:"E",35843:"TD",35895:"YG",35977:"MH",36158:"JG",36228:"QJ",36426:"XQ",36466:"DC",36710:"JC",36711:"ZYG",36767:"PB",36866:"SK",36951:"YW",37034:"YX",37063:"XH",37218:"ZC",37325:"ZC",38063:"PB",38079:"TD",38085:"QY",38107:"DC",38116:"TD",38123:"YD",38224:"HG",38241:"XTC",38271:"ZC",38415:"YE",38426:"KH",38461:"YD",38463:"AE",38466:"PB",38477:"XJ",38518:"YT",38551:"WK",38585:"ZC",38704:"XS",38739:"LJ",38761:"GJ",38808:"SQ",39048:"JG",39049:"XJ",39052:"HG",39076:"CZ",39271:"XT",39534:"TD",39552:"TD",39584:"PB",39647:"SB",39730:"LG",39748:"TPB",40109:"ZQ",40479:"ND",40516:"HG",40536:"HG",40583:"QJ",40765:"YQ",40784:"QJ",40840:"YK",40863:"QJG"};function isAllChinese(L){return/^[\u4E00-\u9FA5]+$/.test(L)}function isChinese(L){return/^[\u4E00-\u9FA5]$/.test(L)}function checkCh(L){var S=L.charCodeAt(0);return S>40869||S<19968?L:oMultiDiff[S]?oMultiDiff[S]:strChineseFirstPY.charAt(S-19968)}function mkRslt(L){for(var S=[""],T=0,_=L.length;T<_;T++){var w=L[T],B=w.length;if(B==1)for(var A=0;A<S.length;A++)S[A]+=w;else{var O=S.slice(0);for(S=[],A=0;A<B;A++){for(var R=O.slice(0),P=0;P<R.length;P++)R[P]+=w.charAt(A);S=S.concat(R)}}}return S}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};function getFirstLetterList(L){if(typeof L!="string")throw new Error(-1,"请传入字符串类型的参数!");for(var S=new Array,T=0,_=L.length;T<_;T++){var w=L.charAt(T);S.push(checkCh(w))}return mkRslt(S)}function sort(L,S){if(typeof L=="number"&&typeof S=="string")return-1;if(typeof L=="string"&&typeof S=="number")return 1;if(isNaN(L)||isNaN(S)){if(isAllChinese(L)&&!isAllChinese(S))return 1;if(!isAllChinese(L)&&isAllChinese(S))return-1;L=L.toString(),S=S.toString();let T=0;for(let _=0;_<(L.length-S.length?S.length:L.length);_++){if(!isChinese(L[_])&&isChinese(S[_])&&(T=-1),isChinese(L[_])&&!isChinese(S[_])&&(T=1),isChinese(L[_])&&isChinese(S[_])){let w=getFirstLetterList(L[_]).toString(),B=getFirstLetterList(S[_]).toString();T=w.localeCompare(B,"zh-Hans-CN",{sensitivity:"accent"})}if(T!==0)break}return T||L.toString().localeCompare(S.toString(),"zh-Hans-CN",{sensitivity:"accent"})}else return Number(L)-Number(S)}const totpSecret="LNKFKRGPNZNUYSLX2VSDSQKJKZDTSRLD";var ossClient=null;function isEmptyString(L){return/^\s*$/.test(L)}function fakeClick(L){var S=document.createEvent("MouseEvents");S.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),L.dispatchEvent(S)}function exportRaw(L,S){var T=window.URL||window.webkitURL||window,_=new Blob([S]),w=document.createElementNS("http://www.w3.org/1999/xhtml","a");w.href=T.createObjectURL(_),w.download=L,fakeClick(w)}const TableDataSaveKey="celueTableBooks",POLICYKEY="",menuItems=ref([{key:"0",label:"绘本列表",title:"绘本列表",closable:!1}]),list2=ref([]),graphDit={};let recordTouch=[];const bookGroup=[{value:"-1",label:"已下架"},{value:"101",label:"主页推荐"},{value:"0",label:"动物世界"},{value:"1",label:"节日里的中国"},{value:"3",label:"魔法拼音国"},{value:"4",label:"原来如此的故事"},{value:"5",label:"塔塔启蒙"}],bookGroupBySearch=[{value:"已下架",label:"已下架"},{value:"主页推荐",label:"主页推荐"},{value:"动物世界",label:"动物世界"},{value:"节日里的中国",label:"节日里的中国"},{value:"魔法拼音国",label:"魔法拼音国"},{value:"原来如此的故事",label:"原来如此的故事"},{value:"塔塔启蒙",label:"塔塔启蒙"}],_sfc_main={name:"App",components:{TreeCom:_sfc_main$4,DescCom:_sfc_main$3,UseElementSize,MarkEdit,SoundTextEdit},setup(){return{}},data(){return{locale:localeValues,isOpenDark:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,screenHeight:document.body.clientHeight,screenWidth:document.body.clientWidth,fnData,curFnInfo:ref(null),symbolData:null,showDataSetIndex:0,showDataSetResult:0,menuItems,freshState:!1,currentSelectMenu:ref(["1"]),bookGroup,bookGroupBySearch,modelTableColumns:[{title:"绘本编号",dataIndex:"name",key:"name",ellipsis:!0,width:"9%"},{title:"名称",dataIndex:"showName",key:"showName",ellipsis:!0,width:"11%",customFilterDropdown:!0,onFilter:(L,S)=>{let T=bookGroup.find(_=>_.label==L);return T!=null&&S.config.group.indexOf!=null&&S.config.group.indexOf(T.value)!=-1?!0:S.name.toString().toLowerCase().includes(L.toLowerCase())||S.config.name.toLowerCase().includes(L.toLowerCase())}},{title:"备注（不会出现在App中）",dataIndex:"des",key:"des",ellipsis:!0,width:"18%"},{title:"创建时间",dataIndex:"createTime",key:"createTime",ellipsis:!0,width:"9%"},{title:"发布时间",dataIndex:"publishTime",ellipsis:!0,key:"publishTime",width:"9%"},{title:"操作",dataIndex:"action",key:"action",ellipsis:!0,width:"15%"}],graphTableColumns:[{title:"预览",dataIndex:"img",key:"img",fixed:"left",width:"130px"},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:80}],filteredInfo:ref({}),sortedInfo:ref({}),soundBoxColumns:[{title:"资源名称",dataIndex:"name",key:"name",sorter:(L,S)=>sort(L.name,S.name),sortOrder:"ascend"},{title:"版本",dataIndex:"md5",key:"md5"},{title:"分镜使用",dataIndex:"graphUse",key:"graphUse",ellipsis:!0},{title:"操作",dataIndex:"action",key:"action"}],curEditLgraphTable:ref([]),graphTableSelectRows:ref([]),modelTableDatas:ref([]),soundBoxDatas:ref([]),inputModelDes:"",tabActiveKey:ref(menuItems.value[0].key),list2,curEditTabDit:ref({}),curOpenLayout:ref([0,1,1,1,1]),searchConfig:ref([{key:"name",type:"input",value:"",title:"过滤名称"},{key:"group",type:"select",value:[],title:"过滤分组",mode:"tags",width:"200px",maxTagCount:3,options:bookGroup}]),huiceConfig:ref([{key:"name",type:"input",value:"",title:"名称",inBottom:!0},{key:"splitName",type:"input",value:"",title:"简称",inBottom:!0},{key:"author",type:"input",value:"塔塔工作室/文",title:"作者",inBottom:!0},{key:"draw",type:"input",value:"塔塔工作室/绘",title:"绘制",inBottom:!0},{key:"press",type:"input",value:"",title:"出版社",inBottom:!0},{key:"labels",type:"select",value:[],title:"标签",mode:"tags",width:"100%",maxTagCount:3,inBottom:!0},{key:"group",type:"select",value:[],title:"分组",mode:"tags",width:"100%",maxTagCount:3,options:bookGroup,inBottom:!0},{key:"desc",type:"inputArea",value:"",title:"简介",inBottom:!0,placeholder:"请输入绘本简介"},{key:"price",type:"number",value:0,step:1,width:"100%",formatter:L=>"".concat(L,"元"),parser:L=>Number(L.replace("元","")),title:"价格",inBottom:!0},{key:"freepage",type:"number",value:0,step:1,width:"100%",formatter:L=>"".concat(L,"页"),parser:L=>Number(L.replace("页","")),title:"免费页数",inBottom:!0},{key:"show",type:"bool",value:!0,title:"是否上架",inBottom:!0},{key:"record",type:"bool",value:!1,title:"是否录音",inBottom:!0},{key:"justOld",type:"bool",value:!1,title:"仍然使用旧版绘本",inBottom:!0},{key:"emptyClickEffect",type:"select",value:"",title:"空白处点击效果",width:"100%",inBottom:!0,options:[{value:"",label:"无"},{value:"story/prefab/P12_FJ0_AN",label:"气泡"},{value:"story/prefab/P08_FJ0_AN",label:"萤火虫光"}]}]),ruleChooseTabOption:"蓝图",checkAllRule:!1,checkIndeterminate:!0,newPolicyName:"",copyToProject:"",newProjectName:"",celueLiebiaoCardHeight:0,celueLiebiaoBodyHeight:0,canvasHeight:0,canvasWidth:0,gameCanvasWidth:320,gameCanvasHeight:180,gameCanvasCardWidth:0,gameCanvasCardHeight:180,previewCardMinWidth:332,previewCardMinHeight:229,width:320,height:180,workSpaceHeight:200,celueEditBodyHeight:0,expandPolicyList:!1,policyShowKey:"none",policySortKey:"none",policySortKeyIsDown:!1,freshCheckBool:!0,freshResultList:!0,items:[],showByKeyOptions:[{value:"none",label:"无"},{value:"xiapuPresent",label:"夏普比率"},{value:"suotinuoPresent",label:"索提诺比率"},{value:"yearPresent",label:"年化收益"},{value:"jiaoyiWinPresent",label:"胜率"},{value:"jiaoyiCount",label:"交易次数"},{value:"maxHuice",label:"最大回撤"}],importModelOpen:!1,importOldVersionConfig:ref([{key:"bookFolder",type:"input",value:"/Users/yaowei/Documents/work/tataread2026/assets/bundleStory/880012",width:"400px",title:"绘本目录",des:"选择Cocos AssestBundle下的书本目录",isPath:!0,inBottom:!0},{key:"bookId",type:"input",value:"",title:"绘本编号",inBottom:!0}]),createMotionTextConfig:ref([{key:"content",type:"input",value:"",title:"内容",inBottom:!0}]),importCheckedIndeterminate:!1,importCheckedPageList:ref([]),importPageOptions:ref([]),importCheckAll:!1,editColiderOpen:!1,editSoundTextOpen:!1,editSoundTextParams:{},editColiderImg:"",pointArr:[],editColiderScale:1,importProgress:0,importInfo:"0/0",waitImportProject:null,ruleMenu:[],moreActionMenu:[],isShowMenu:!1,cocosPreviewTreeWidth:0,cocosPreviewTreeData:[],expandedKeys:[],fileList:[],highlightNodeDit:{},outputLinkMenu:ref([]),inputLinkMenu:ref([]),waitLink:{},cocosConfig:{cocosPreviewIsShowTree:!1,cocosPreviewIsShowState:!1,cocosPreviewIsShowGird:!1,cocosPreviewCanDrag:!1,isPreviewMode:!0,cocosPreviewIsShowColiderBox:!1,mute:!1,radioLock:!1,radio:"2560:1500",aspectRadio:1500/2560,radioOptions:[{value:"无比例",label:"无比例"},{value:"16:9",label:"常规显示器"},{value:"4:3",label:"ipad"},{value:"19.5:9",label:"iPhone全面屏"},{value:"2560:1500",label:"绘本设计分辨率"}]},systemSetting:ref([{key:"accessKeyId",type:"input",value:"",width:"400px",title:"accessKeyId",inBottom:!0},{key:"accessKeySecret",type:"input",value:"",title:"accessKeySecret",inBottom:!0},{key:"bucket",type:"input",value:"",title:"bucket",inBottom:!0},{key:"cloudHost",type:"input",value:"",title:"cloudHost",inBottom:!0},{key:"xunfeiAppid",type:"input",value:"",width:"400px",title:"xunfeiAppid",inBottom:!0},{key:"xunfeiApiSecret",type:"input",value:"",width:"400px",title:"xunfeiApiSecret",inBottom:!0},{key:"xunfeiApiKey",type:"input",value:"",width:"400px",title:"xunfeiApiKey",inBottom:!0}]),copyedNode:{},configs:{showNameColumn:!1,uploadReplaceAssestByName:!0,recordType:"none"},showCreateMotionTextModal:!1,showSoundBoxModal:!1,verificationCode:"",showKeyboard:!0,justCurrentPage:!0,curShowAssestBoxType:""}},watch:{policySortKey(L,S){this.sortPolicyList()},policySortKeyIsDown(L,S){this.sortPolicyList()},currentSelectMenu(L,S){console.log("newValue",L[0],S[0])},ruleChooseTabOption(L,S){this.waitLink.nodeObj!=null&&(this.$message.info({content:"绑定取消",key:this.waitLink.nodeObj.id,duration:1}),this.waitLink={}),L=="表格"&&this.getCurEditLgraphTable()},tabActiveKey(L,S){console.log("tabActiveKey",L,S),S!=0&&this.onClickSaveBtn(S),L!=0&&(this.freshCurEdit(),this.$nextTick(()=>{this.calculateHeight()}),this.copyToProject=L),L==0?(this.clearCurEditLgragh(S),this.lgcanvas!=null&&(this.lgcanvas.clear(),this.lgcanvas=null)):(L!=S&&this.clearCurEditLgragh(S),this.$nextTick(()=>{this.updateCurShowLGraph()}))}},async mounted(){let L=localStorage.getItem("BookEdit_curOpenLayout");L!=null&&(this.curOpenLayout=JSON.parse(L)),this.previewCardMinHeight=(this.previewCardMinWidth-10)*(designViewHeight/designViewWidth)+10+38,window.channel=new BroadcastChannel("BookEditFM"),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",w=>{this.isOpenDark=w.matches});let S=localStorage.getItem("bookEditConfig");if(S!=null)try{S=JSON.parse(S);for(var T=0;T<this.systemSetting.length;T++)S[this.systemSetting[T].key]!=null&&(this.systemSetting[T].value=S[this.systemSetting[T].key]);setRootHost(S.cloudHost),ossClient=new aliyunOssSdk({region:"oss-cn-shanghai",accessKeyId:S.accessKeyId,accessKeySecret:S.accessKeySecret,bucket:S.bucket});const w=await ossClient.listV2({prefix:"bookEditProject/",delimiter:"/"});VoiceCheck$1.setConfig(S.xunfeiAppid,S.xunfeiApiSecret,S.xunfeiApiKey),console.log("云端文件列表",w.objects)}catch(w){console.log("初始化云储存失败",w),this.$message.error("初始化云储存失败:"+w,0)}else this.$message.warn("使用前请先进行系统设置",0);document.title="绘本编辑器",window.onresize=()=>(()=>{this.screenHeight=document.body.clientHeight,this.screenWidth=document.body.clientWidth,this.calculateHeight()})(),window.onChangeGraph=this.onChangeGraph,window.onGraphMenuClick=this.onGraphMenuClick,window.onGraphNodeClick=this.onGraphNodeClick,window.uploadGroupFile=this.uploadGroupFile,window.setDropXY=(w,B)=>{this.dropedX=w,this.dropedY=B},window.antAleart=w=>{this.$message.warn(w)};var _=await this.getFromLocalOrCloud(TableDataSaveKey);_!=null&&_.forEach(w=>{this.modelTableDatas.push(w)}),this.calculateHeight(),this.ruleMenu=this.getMenu(""),this.ruleMenu.push({key:"onestep/",label:"快捷操作",has_submenu:!0,icon:h$1(ToolOutlined),children:[{key:"viewToCenter",label:"重置界面中心点",has_submenu:!1},{key:"autoSetAni",label:"自动设置动画",has_submenu:!1},{key:"layoutNodes",label:"扩散节点",has_submenu:!1},{key:"layoutNodesJustX",label:"向右扩散节点",has_submenu:!1},{key:"girdNodes",label:"优化节点排列",has_submenu:!1},{key:"collase",label:"折叠节点",has_submenu:!0,children:[{key:"collapseAll_objects/createObject",label:"折叠所有物体节点",has_submenu:!1},{key:"collapseAll_objects/animates/animate",label:"折叠所有骨骼动画节点",has_submenu:!1},{key:"collapseAll",label:"折叠所有节点",has_submenu:!1}]},{key:"expand",label:"展开节点",has_submenu:!0,children:[{key:"expandAll_objects/createObject",label:"展开所有物体节点",has_submenu:!1},{key:"expandAll_objects/animates/animate",label:"展开所有骨骼动画节点",has_submenu:!1},{key:"expandAll_middle/change/timeDown",label:"展开所有延迟触发节点",has_submenu:!1},{key:"expandAll_middle/tool/acceptData",label:"展开无线传送接收",has_submenu:!1},{key:"expandAll_middle/tool/sendData",label:"展开无线传送发送",has_submenu:!1},{key:"expandAll",label:"展开所有节点",has_submenu:!1}]},{key:"soundBox",label:"音频库",has_submenu:!1},{key:"spineBox",label:"动画库",has_submenu:!1}]}),this.moreActionMenu=[{key:"deleteNode",label:"删除指令",has_submenu:!1},{key:"addMenus",label:"添加指令",has_submenu:!0,children:this.ruleMenu},{key:"copyNode",label:"复制",has_submenu:!1},{key:"pasteNode",label:"粘贴",has_submenu:!1},{key:"toggleToGraph",label:"定位到蓝图",has_submenu:!1}],console.log("最终的menu",this.ruleMenu)},methods:{onUpdate(L){console.log("onUpdate",L)},onEnd(){console.log("onEnd",this.modelTableDatas)},pushTo(L){this.$router.push(L)},jumpTo(L){this.$router.replace(L)},formatTime(L){return L==null?"":hooks(L).format("YYYY/MM/DD HH:mm:ss")},async getFromLocalOrCloud(L){let T=arrToDit(this.systemSetting,"key","value").cloudHost;try{var _=await axios.get(T+"/bookEditProject/"+L+".json?timestamp="+new Date().getTime());if(typeof _.data=="object")return _.data;this.$message.error("不存在Json文件:/bookEditProject/"+L+".json",3)}catch(w){this.$message.error("网络出错，获取云端数据失败:"+w,3)}},async setToLocalOrCloud(L,S){if(ossClient==null){this.$message.error("当前没有访问远程资源权限！请先设置AccessKey");return}try{let T=new Blob([JSON.stringify(S)],{type:"text/plain"});return await ossClient.put("bookEditProject/"+L+".json",T),!0}catch(T){this.$message.error("保存"+L+"失败:"+T,3)}},async delToLocalOrCloud(L){if(ossClient==null){this.$message.error("当前没有访问远程资源权限！请先设置AccessKey");return}await ossClient.delete("bookEditProject/"+L+".json")},getMenu(L){var S={"middle/":h$1(ApiOutlined),"input/":h$1(LogoutOutlined),"output/":h$1(LoginOutlined),"objects/":h$1(BuildOutlined),"onestep/":h$1(ToolOutlined)},T=LiteGraph.getNodeTypesCategories().filter(A=>A.startsWith(L)),_=[];for(const A of T){if(!A)continue;const O=new RegExp("^(".concat(L,")")),R=A.replace(O,"").split("/",1)[0],P=L===""?"".concat(R,"/"):"".concat(L).concat(R,"/");let E=R;if(E.includes("::")&&(E=E.split("::",2)[1]),_.findIndex(I=>I.key===P)===-1){var w={key:P,label:zhString[E]?zhString[E]:E,has_submenu:!0,children:this.getMenu(P)};S[P]!=null&&(w.icon=S[P]),_.push(w)}}const B=LiteGraph.getNodeTypesInCategory(L.slice(0,-1));for(const A of B){if(A.skip_list)continue;const O={key:A.type,label:zhString[A.title]?zhString[A.title]:A.title,has_submenu:!1};_.push(O)}return _},getResArr(L,S,T){let _=this.curEditTabDit[this.tabActiveKey].policyList;if(T==!0){let P=this.curEditTabDit[this.tabActiveKey].curSelectPolicy;_=_.filter(E=>E.name==P)}let w={},B=[];for(var A=0;A<_.length;A++){let P=_[A].graphJson;if(P!=null)for(var O=0;O<P.nodes.length;O++){let E=P.nodes[O];if(E.properties.customeName!=null){let D={graphUse:[_[A].name],nodeId:E.id,customeName:E.properties.customeName},I=!1;E.type=="output/sound"?L.indexOf("sound")!=-1&&(D.md5=E.properties.customeName.split(".")[1],D.name=E.properties.customeName.split(".")[0],D.type="sound",I=!0):E.type=="objects/createObject"&&(E.properties.modal==ObjectTypeEnum.spine?L.indexOf("spine")!=-1&&(D.md5=E.properties.customeName.split("/")[0],D.name=E.properties.customeName.split("/")[1],D.type="spine",D.name==null&&(D.name=D.md5),I=!0):E.properties.modal==ObjectTypeEnum.sprite&&L.indexOf("sprite")!=-1&&(D.md5=E.properties.customeName.split(".")[1],D.name=E.properties.customeName.split(".")[0],D.type="image",I=!0)),I&&(w[D.customeName]!=null?w[D.customeName].graphUse.push(_[A].name):w[D.customeName]=D)}}}if(S==!0)return w;for(var R in w)B.push(w[R]);return B},replaceFileGrpup(L){let S=this.getCurEditLGraph();if(S==null)return;let T=!1,_=getFileType(L.type);if(_=="音频"){let B=S.findNodesByType("output/sound");for(var w=0;w<B.length;w++){let A=B[w];A.properties.customeName.split(".")[0]==L.name&&(A.setProperty("customeName",L.customeName),T=!0)}}else if(_=="图片"){let B=S.findNodesByType("objects/createObject");for(var w=0;w<B.length;w++){let O=B[w];O.properties.modal==ObjectTypeEnum.sprite&&O.properties.customeName.split(".")[0]==L.name&&(O.setProperty("customeName",L.customeName),O.onWidgetChanged("资源"),T=!0)}}else if(_=="spine"){let B=S.findNodesByType("objects/createObject");for(var w=0;w<B.length;w++){let O=B[w];O.properties.modal==ObjectTypeEnum.spine&&O.properties.customeName.split("/")[1]==L.name&&(O.setProperty("customeName",L.customeName),O.onWidgetChanged("资源"),T=!0)}}return T},replaceFileGroupByBook(L){let S=this.curEditTabDit[this.tabActiveKey].policyList;for(var T=0;T<S.length;T++){let w=S[T].graphJson;if(w!=null)for(var _=0;_<w.nodes.length;_++){let B=w.nodes[_];B.properties.customeName!=null&&(B.type=="output/sound"?B.properties.customeName.split(".")[0]==L.name&&(B.properties.customeName=L.customeName):B.type=="objects/createObject"&&(B.properties.modal==ObjectTypeEnum.spine?B.properties.customeName.split("/")[1]==L.name&&(B.properties.customeName=L.customeName):B.properties.modal==ObjectTypeEnum.sprite&&B.properties.customeName.split(".")[0]==L.name&&(B.properties.customeName=L.customeName)))}}},onClickMenuItem(L,S,T,_){if(this.waitLink.nodeObj!=null&&(this.$message.info({content:"绑定取消",key:this.waitLink.nodeObj.id,duration:1}),this.waitLink={}),L.key=="viewToCenter"){var w=this.getCurEditLGraph();if(w.nodes.length!=0){const M=createBounds(w.nodes);this.lgcanvas.animateToBounds(M,{zoom:1})}}else if(L.key=="autoSetAni")for(var w=this.getCurEditLGraph(),B=w.findNodesByType("objects/animates/animate"),A=0;A<B.length;A++){let N=B[A];N.getEnums(!0);let k=N.getInputNode(1);if(k!=null&&k.type=="objects/animates/animate"){let F=k.getRealLinkNode(),G=N.getRealLinkNode();F!=null&&G!=null&&F.id==G.id&&N.setProperty("softChange",!1)}k==null&&N.setProperty("softChange",!1)}else if(L.key=="autoSetOldData"){for(var w=this.getCurEditLGraph(),B=w.findNodesByType("objects/animates/animate"),A=0;A<B.length;A++){let G=B[A];G.getEnums(!0);let V=G.getInputNode(1);if(V!=null&&V.type=="objects/animates/animate"){let j=V.getRealLinkNode(),H=G.getRealLinkNode();j!=null&&H!=null&&j.id==H.id&&G.setProperty("softChange",!1)}V==null&&G.setProperty("softChange",!1)}let k=w.findNodesByType("objects/animates/tween");for(let F=0;F<k.length;F++){let G=k[F];if(G.properties.tweenMode=="变化目标值"){let V=G.getInputData(0,!0);V!=null&&(G.setProperty("anchorX",V.anchorX),G.setProperty("anchorY",V.anchorY),G.setProperty("width",V.width),G.setProperty("height",V.height),G.setProperty("color","#"+V.color))}else G.properties.tweenMode=="变化多少值"&&(G.setProperty("anchorX",0),G.setProperty("anchorY",0),G.setProperty("width",0),G.setProperty("height",0),G.setProperty("color","#000000"))}}else if(L.key=="layoutNodes"){var w=this.getCurEditLGraph();let N=()=>{let k=!1;for(let F=0;F<w.nodes.length;F++){let G=w.nodes[F];for(let V=0;V<w.nodes.length;V++){let j=w.nodes[V];j.id!=G.id&&overlapBounding(G.boundingRect,j.boundingRect)&&(G.pos[0]<=j.pos[0]?j.pos=[j.pos[0]+11,j.pos[1]]:G.pos=[G.pos[0]+11,G.pos[1]],G.pos[1]<=j.pos[1]?j.pos=[j.pos[0],j.pos[1]+10]:G.pos=[G.pos[0],G.pos[1]+10],k=!0)}}w.setDirtyCanvas(!0,!0),k==!0&&setTimeout(()=>{N()},10)};N()}else if(L.key=="layoutNodesJustX"){var w=this.getCurEditLGraph();let N=()=>{let k=!1;for(let F=0;F<w.nodes.length;F++){let G=w.nodes[F];for(let V=0;V<w.nodes.length;V++){let j=w.nodes[V];j.id!=G.id&&overlapBounding(G.boundingRect,j.boundingRect)&&(G.pos[0]<=j.pos[0]?j.pos=[j.pos[0]+3,j.pos[1]]:G.pos=[G.pos[0]+3,G.pos[1]],k=!0)}}w.setDirtyCanvas(!0,!0),k==!0&&setTimeout(()=>{N()},10)};N()}else if(L.key=="girdNodes"){var w=this.getCurEditLGraph();if(w.nodes.length==0)return;let N=0;const k=createBounds(w.nodes);let F=0,G=k[1]+k[3]+50;var O=w.findNodesByType("objects/createObject");O.sort((j,H)=>j.properties.zIndex-H.properties.zIndex);for(var A=0;A<O.length;A++){let H=O[A],U=H.getOutputNodes(0)||[],X=!0;for(let Y=0;Y<U.length;Y++){let z=U[Y];if(z.isAnyOutputConnected()){X=!1;break}for(var R=1;R<z.inputs.length;R++)if(z.getInputLink(R)!=null){X=!1;break}}if(X==!0){H.pos=[F,G];let Y=0;F+=H.width+3;let z=G;for(let W=0;W<U.length;W++){let Z=U[W];Z.pos=[F,G],G+=Z.height+3,Y<Z.width&&(Y=Z.width),N<G&&(N=G)}F+=Y+3,G=z,N<G+H.height&&(N=G+H.height)}}let V=w.findNodesByType("output/sound");F=0,G=N+100;for(var A=0;A<V.length;A++){let H=V[A];H.isAnyOutputConnected()==!1&&H.isAnyInputConnected()==!1&&(H.pos=[F,G],F+=H.width+5)}}else if(L.key.indexOf("expandAll")!=-1||L.key.indexOf("collapseAll")!=-1){var P=L.key.split("_"),E=P[0]=="expandAll",D=P[1],w=this.getCurEditLGraph();let N=w.nodes;D!=null&&(N=w.findNodesByType(D));for(var A=0;A<N.length;A++){let F=N[A];F.collapsed==E&&F.collapse()}}else if(L.key=="deleteNode"){let M=S[T][_];if(M!=null){var w=this.getCurEditLGraph();let k=w.getNodeById(M.id);w.remove(k),S[T].splice(_,1)}}else if(L.key=="copyNode"){let M=S[T][_];M!=null?this.copyedNode={type:M.type}:this.$message.info("没有可复制的指令")}else if(L.key=="pasteNode")this.copyedNode.type!=null?this.onClickMenuItem({key:this.copyedNode.type},S,T,_):this.$message.info("没有可粘贴的指令");else if(L.key!="topMenus")if(L.key=="toggleToGraph"){let M=S[T][_];M!=null&&this.toggleNodeIdToGraph(M.id)}else if(L.key=="createMotionText")this.showCreateMotionTextModal=!0;else if(L.key=="soundBox"||L.key=="spineBox"||L.key=="imageBox")this.curShowAssestBoxType=L.key,this.freshAssestBoxData(),this.showSoundBoxModal=!0;else{var w=this.getCurEditLGraph();let N=null;S!=null&&(N=w.getNodeById(S.id));let k=this.addNodeToGraph(L.key,N);if(k==null)return;if(L.initProp!=null){for(var I in L.initProp)k.setProperty(I,L.initProp[I]);k.onWidgetChanged!=null&&k.onWidgetChanged("物体类型")}if(N!=null){let F=k.findSlotByType(!0,"codeNode");F!=-1&&N.connect(0,k,F)}if(S!=null){let F=this.genOneNodeToTableCell(k);S[T].push(F)}this.ruleChooseTabOption=="表格"&&(S==null?this.getCurEditLgraphTable():L.key=="objects/createObject"?this.getCurEditLgraphTable():L.key=="output/tips/showHandTip"?this.getCurEditLgraphTable():L.key=="objects/camera"&&this.getCurEditLgraphTable())}},freshAssestBoxData(){let L=this.justCurrentPage;this.curShowAssestBoxType=="soundBox"?this.soundBoxDatas=this.getResArr(["sound"],!1,L):this.curShowAssestBoxType=="spineBox"?this.soundBoxDatas=this.getResArr(["spine"],!1,L):this.curShowAssestBoxType=="imageBox"&&(this.soundBoxDatas=this.getResArr(["sprite"],!1,L))},onBtnDeleteTableRow(L,S){console.log("点击删除row",L,S);var T=this.getCurEditLGraph();for(var _ in S)if(_.indexOf("linkNode")!=-1)for(var w=0;w<S[_].length;w++){let A=S[_][w],O=T.getNodeById(A.id);if(O!=null&&O.getInputDataType(0)=="codeNode"){let R=O.getInputNode(0);R!=null&&R.id==S.id&&T.remove(O)}}let B=T.getNodeById(S.id);B!=null&&T.remove(B),this.getCurEditLgraphTable()},toggleNodeIdToGraph(L){var S=this.getCurEditLGraph();let T=S.getNodeById(L);if(T!=null){this.ruleChooseTabOption="蓝图",T.selected=!0,T.onSelected&&T.onSelected(),T.collapsed&&T.collapse();let _=createBounds([T]);this.lgcanvas.animateToBounds(_,{zoom:1})}},onMenuOpenChange(L){L.length==0?this.isShowMenu=!1:this.isShowMenu=!0},onClickChangeShowView(L){this.curOpenLayout[L]=!this.curOpenLayout[L],localStorage.setItem("BookEdit_curOpenLayout",JSON.stringify(this.curOpenLayout)),this.$nextTick(()=>{this.calculateHeight()})},getProjectOptions(){return this.modelTableDatas.map(L=>({value:L.name,label:L.name}))},addItems(L=1){for(let S=0;S<L;S++)this.items.push({text:Math.random()*1e3+"随机数字",id:this.items.length+1});this.scrollToBottom()},scrollToBottom(){},onSymbolInput(L){console.log("onInputSymbol",L),this.inputSymbol=L},onChangeDataPicker(L){console.log("onChangeDataPicker",L);var S=L[0].format("YYYY/MM/DD"),T=L[1].format("YYYY/MM/DD");this.inputSymbolDate=S+"-"+T},calculateHeight(){var L=document.getElementById("tabHtml"),S=L.getElementsByClassName("ant-tabs-nav")[0],T=10,_=5,w=38;if(S!=null){var B=S.getBoundingClientRect().height;this.workSpaceHeight=this.screenHeight-B;var A=document.getElementById("canvasCard"),O=document.getElementById("leftFlexView");let I=document.getElementById("huiceConfigCard").getBoundingClientRect();if(this.celueEditBodyHeight=this.workSpaceHeight-T*2-w,this.canvasWidth=this.screenWidth-T*2-2,O!=null){var R=O.getBoundingClientRect();this.canvasWidth=this.screenWidth-R.width-T*3}if(A!=null){A.getBoundingClientRect();var P=A.getElementsByClassName("ant-card-head")[0];if(P!=null){var E=P.getBoundingClientRect();this.celueLiebiaoBodyHeight=this.workSpaceHeight-I.height-_-E.height-T*2-1,this.canvasHeight=this.workSpaceHeight-E.height-T*2-1}}}else console.warn("navObj == null")},getCardBodyHeight(L){var S=document.getElementById(L),T=0;if(S!=null){var _=S.getElementsByClassName("ant-card-head")[0];if(_!=null){var w=S.getBoundingClientRect(),B=_.getBoundingClientRect();this[L+"Height"]=w.height-B.height-10,console.log("getCardBodyHeight",this[L+"Height"])}}else this.$nextTick(()=>{var A=document.getElementById(L);if(A!=null){var O=A.getElementsByClassName("ant-card-body")[0];if(O!=null){var R=A.getBoundingClientRect(),P=O.getBoundingClientRect();this[L+"Height"]=R.height-P.height-10,console.log("getCardBodyHeight",this[L+"Height"])}}else console.log("等待了1秒还是没有找到height")});return T},handleSortTagChange(L){console.log("handleSortTagChange",L,this.sortTableDatas)},handleYkeyChoose(L,S){var T=L.key,_=S;this.girdMap["y_"+_]=T,console.log("y_"+_,T)},onRuleEditFocus(L){console.log("onRuleEditFocus",L),this.curEditSortRule=L},insertRuleText(L,S){if(this.curEditSortRule!=null){var T=this.sortTableDatas.findIndex(_=>_.name==this.curEditSortRule);T>-1&&this.sortTableDatas[T].codeMirror!=null&&this.sortTableDatas[T].codeMirror.insertText(L,S)}},hoverFn(L){this.curFnInfo=functionDescription[L],console.log("hoverFn",this.curFnInfo)},insertFn(L){L.children||this.insertRuleText("".concat(L.title),"fn")},async run(){},async onBtnCreateModel(L,S){S+="";var T=S.replace(/\s/g,"");if(T==TableDataSaveKey)return this.$message.error("绘本编号不能为预置字符串"),!1;if(T=="")return this.$message.error("绘本编号为空"),!1;var _=this.modelTableDatas.findIndex(B=>B.name==S);if(_>=0)return this.$message.error("当前已存在绘本："+S),!1;var w={key:S,name:S,des:this.inputModelDes!=""?this.inputModelDes:"创建时间："+hooks().format("YYYY/MM/DD HH:mm:ss"),createTime:hooks().format("YYYY/MM/DD HH:mm:ss"),policyList:[],config:{}};return L!=null&&(w.config=L.config,w.policyList=L.policyList),await this.setToLocalOrCloud(POLICYKEY+w.name,JSON.parse(JSON.stringify(w))),this.modelTableDatas.push(w),await this.saveTableData(),!0},async onBtnCopyModel(L){let S=this.modelTableDatas.findIndex(w=>w.name==L);if(S!=-1){var T=this.modelTableDatas[S];if(T!=null&&T.name!=null)var _=await this.getFromLocalOrCloud(POLICYKEY+T.name);this.onBtnCreateModel(_,this.newProjectName)}},async onBtnRenameProject(L){var S=this.modelTableDatas.findIndex(w=>w.name==this.newProjectName);if(S!=-1){api.error("重命名失败，已存在绘本："+this.newProjectName);return}var T=this.modelTableDatas.findIndex(w=>w.name==L);if(T!=-1){try{var _=await this.getFromLocalOrCloud(POLICYKEY+this.modelTableDatas[T].name);await this.delToLocalOrCloud(POLICYKEY+this.modelTableDatas[T].name),_.name=this.newProjectName,_.key=this.newProjectName,await this.setToLocalOrCloud(POLICYKEY+this.newProjectName,_)}catch(w){api.error("重命名失败："+w);return}this.modelTableDatas[T].name=this.newProjectName,this.saveTableData()}},getCoverUrl(L){return L.cover==null||L.cover==""?"https://cdn.goowee.cn/appres/bookcover/"+L.name+".png":rootHost+"/"+L.cover},handleChangeCover(L){console.log("handleChangeCover",L)},handleDropCover(L){console.log("handleDropCover",L)},handleUploadCover(L){return console.log("handleUploadCover",L),!0},async onConfigChangeSave(L){L.config=arrToDit(this.huiceConfig,"key","value");var S=await this.getFromLocalOrCloud(POLICYKEY+L.name);S.config=L.config,await this.setToLocalOrCloud(POLICYKEY+L.name,S),this.saveTableData();var T=menuItems.value.findIndex(_=>_.key==L.name);T!=-1&&(menuItems.value[T].modeJson.config=L.config)},onClickTableConfig(L){if(console.log("onClickTableConfig",L.config),L.config!=null)for(var S=0;S<this.huiceConfig.length;S++){var T=this.huiceConfig[S].key;L.config[T]!=null&&(this.huiceConfig[S].value=L.config[T])}},async onBtnEditProjectDes(L){var S=this.modelTableDatas.findIndex(T=>T.name==L);S!=-1&&(this.modelTableDatas[S].des=this.inputModelDes,this.saveTableData())},robotToGraphNode(L){if(robotNodeEnum[L.config.key]!=null){let T=LiteGraph.createNode(robotNodeEnum[L.config.key]);for(var S in L.config.otherConfig){let _=L.config.otherConfig[S];if(T.properties[S]!=null){let w=T.widgets.find(B=>B.options.property==S);w!=null&&w.type=="combo"&&Array.isArray(w.options.values)&&(w.options.values[_]!=null?_=w.options.values[_]:console.warn("widget没有对应的值",S,_)),L.config.key=="sound"&&(S=="loop"?_=!_:S=="volume"&&(_=_*.1)),L.config.key=="createObject"&&((S=="scaleX"||S=="scaleY"||S=="anchorX"||S=="anchorY")&&(_=_*.1),(S=="color"||S=="outLineColor")&&(_="#"+_)),L.config.key=="camera"&&S=="zoomRatio"&&(_=_*.1),L.config.key=="animate"&&(S=="timeScale"&&(_=_*.1),(S=="loop"||S=="cancelEvent"||S=="aniEndCanClick")&&(_=!_)),L.config.key=="touchEnd"&&S=="listernTouchCancel"&&(_=!_),L.config.key=="tween"&&(S=="cancelEvent"&&(_=!_),(S=="delay"||S=="duration"||S=="scaleX"||S=="scaleY"||S=="zoomRatio")&&(_=_*.1)),L.config.key=="bezierCurve"&&(S=="duration"&&(_=_*.1),S=="startResetT"&&(_=!_)),L.config.key=="showHandTip"&&S=="scale"&&(_=_*.1),T.setProperty(S,_)}else console.warn("node没有对应配置",S,L.config.key,L.config.otherConfig[S])}return L.config.key=="tween"&&L.config.otherConfig.tweenMode==1&&(T.setProperty("anchorX",0),T.setProperty("anchorY",0),T.setProperty("width",0),T.setProperty("height",0)),T}else console.warn("没有对应的graphNode",L.config.key);return null},filterPageList(L){return L.filter(S=>{let T=S.split(".");return!(T[T.length-1]!="json"||S.indexOf("_std")!=-1||S.indexOf("_")==-1||S.indexOf("_kepu")!=-1)}).sort((S,T)=>{let _=S.indexOf("p")+1,w=S.indexOf("."),B=S.substring(_,w),A=T.indexOf("p")+1,O=T.indexOf("."),R=T.substring(A,O);return Number(B)-Number(R)})},onFreshCanImportPage(){if(window.require==null){this.$message.warn("此功能仅在桌面版可用，网页版无法使用");return}let L=window.require("fs"),S=arrToDit(this.importOldVersionConfig,"key","value"),T=[];L.existsSync(S.bookFolder+"/json")==!0&&(T=L.readdirSync(S.bookFolder+"/json"),T=this.filterPageList(T)),this.importPageOptions=T,this.importCheckedPageList=T,this.importCheckAll=!0,this.importCheckedIndeterminate=!1},onImportOldVersionConfigChange(L){L=="bookFolder"&&this.onFreshCanImportPage()},onImportPageCheck(){this.importCheckedIndeterminate=!!this.importCheckedPageList.length&&this.importCheckedPageList.length<this.importPageOptions.length,this.importCheckAll=this.importCheckedPageList.length===this.importPageOptions.length},onCheckAllChange(L){this.importCheckedPageList=L.target.checked?this.importPageOptions:[],this.importCheckedIndeterminate=!1,this.importCheckAll=L.target.checked,console.log(this.importCheckedPageList)},async handleOkImport(){if(window.require==null){this.$message.warn("此功能仅在桌面版可用，网页版无法使用");return}let L=window.require("fs"),S=arrToDit(this.importOldVersionConfig,"key","value"),T=["image","sound","spine"];if(L.existsSync(S.bookFolder+"/json")==!1){this.$message.error("所选目录下json文件夹不存在");return}for(var _=0;_<T.length;_++){let N=S.bookFolder+"/"+T[_];if(L.existsSync(N)==!1){this.$message.error("所选目录下"+T[_]+"文件夹不存在");return}}let w=[],B={};for(var _=0;_<T.length;_++){let k=S.bookFolder+"/"+T[_],F=L.readdirSync(k);if(F=F.filter(G=>G.indexOf(".meta")==-1).map(G=>({name:getName(G),path:S.bookFolder+"/"+T[_]+"/"+G})),T[_]=="spine"){for(var A=0;A<F.length;A++)if(F[A].path.indexOf(".json")!=-1){let G=JSON.parse(L.readFileSync(F[A].path,"utf-8"));if(G.events!=null)for(var O in G.events)B[getBaseName(F[A].name)]==null&&(B[getBaseName(F[A].name)]=[]),B[getBaseName(F[A].name)].push(O)}}w=w.concat(F)}let R=await this.prepareDealFiles(w),P={};for(let N=0;N<R.length;N++)P[R[N].name]=R[N].path;console.log("filesDit",P),console.log("spineEventSound",B);let E=[];changeRunInmportState(!0);let D=this.importCheckedPageList;for(var _=0;_<D.length;_++){let k=D[_],F=JSON.parse(L.readFileSync(S.bookFolder+"/json/"+k,"utf-8")),G=new LGraph,V={},j={};for(let H=0;H<F.length;H++){let U=F[H];j[U.id]=U;let X=this.robotToGraphNode(U);if(X!=null){if(U.config.key=="createObject"){let Y=U.config.otherConfig.customeName,z=U.config.otherConfig.modal;if(z==1)P[Y]!=null?X.setProperty("customeName",P[Y]):Y.indexOf(".")==-1&&(Y=Y+".png",X.setProperty("customeName",Y));else if(z==3&&(P[Y]!=null?X.setProperty("customeName",P[Y]):Y=="P0_Common_Finger"&&X.setProperty("premulAlpha",!1),B[Y]!=null))for(var I=0;I<B[Y].length;I++){let W=B[Y][I];if(P[W]!=null){let Z=LiteGraph.createNode("output/sound");Z.setProperty("customeName",P[W]),G.add(Z),console.log("添加了声音节点",P[W])}}}else if(U.config.key=="sound"){let Y=U.config.otherConfig.customeName;P[Y]!=null&&X.setProperty("customeName",P[Y])}X.pos=[U.nodeValue.x,-U.nodeValue.y],G.add(X),V[U.id]=X.id}}for(let H=0;H<F.length;H++){let U=F[H];if(V[U.id]!=null){let X=G.getNodeById(V[U.id]),Y=Object.keys(U.linkDatas.outputSolt);for(let W=0;W<Y.length;W++){let Z=Y[W];for(let Q=0;Q<U.linkDatas.outputSolt[Z].length;Q++){let ee=U.linkDatas.outputSolt[Z][Q],te=j[ee.robot],ie=Object.keys(te.linkDatas.inputSolt).indexOf(ee.otherSolt),ne=V[ee.robot];if(ne!=null){let he=G.getNodeById(ne);ee.otherSolt=="cardTopSolt"?(he.addOutput("被引用","lgraphNode"),he.connect(he.outputs.length-1,X,W)):(he.inputs[0]!=null&&he.inputs[0].type=="codeNode"&&(ie+=1),console.log(U.config.key,"准备连接节点",Q,U,he,W,ie,he.getInputDataType(0)),ie!=-1&&X.connect(W,he,ie))}}}for(let W=0;W<U.linkDatas.cardacSolt.length;W++){let Z=U.linkDatas.cardacSolt[W],Q=V[Z.robot];if(Q!=null){let ee=G.getNodeById(Q),te=X.findOutputByType("codeNode"),re=ee.findInputByType("codeNode");re!=null&&te!=null&&re.index!=-1&&te.index!=-1&&X.connect(te.index,ee,re.index)}}if(["connection"].indexOf(U.config.key)!=-1){console.log("needConnectExSoltNode",U);for(let W=0;W<U.linkDatas.cardacSolt.length;W++){let Z=U.linkDatas.cardacSolt[W],Q=V[Z.robot];if(Q!=null){let ee=G.getNodeById(Q),te=ee.findOutputByType("codeNode"),re=X.inputs.findIndex(ie=>ie.type=="codeNode"&&ie.link==null);if(re==-1&&X.onGetInputs!=null){let ie=X.onGetInputs(),ne=ie.findIndex(he=>he[1]=="codeNode");ne!=-1&&(X.addInput(ie[ne][0],ie[ne][1]),re=X.inputs.length-1)}re!=-1&&te!=null&&te.index!=-1&&ee.connect(te.index,X,re)}}}}}E.push(G)}console.log("newGraphList",E);var M=await this.onBtnCreateModel(null,S.bookId);if(M==!0){let N=await this.getFromLocalOrCloud(POLICYKEY+S.bookId);if(N!=null){N.policyList=E.map((k,F)=>({name:D[F]!=null?getBaseName(D[F]):"页面"+F,graphJson:k.asSerialisable()}));for(var _=0;_<E.length;_++)E[_].clear();changeRunInmportState(!1),await this.setToLocalOrCloud(POLICYKEY+S.bookId,N),this.importModelOpen=!1}else changeRunInmportState(!1)}else changeRunInmportState(!1)},async onBtnLoadModel(L){var S=menuItems.value.findIndex(w=>w.key==L);if(S!=-1){this.tabActiveKey=L;return}var T=this.modelTableDatas.findIndex(w=>w.name==L);if(T==-1){this.$message.info("列表中不存在绘本："+L);return}var _=await this.getFromLocalOrCloud(POLICYKEY+L);_!=null?(console.log("当前打开的modeljson",_),_.policyList!=null&&_.policyList.forEach(w=>{w.active==null&&(w.active=!0)}),menuItems.value.push({title:_.name,label:"Content of new Tab "+_.name,key:_.name,modeJson:_}),this.tabActiveKey=_.name):this.$message.error("打开失败，绘本缺失："+L)},getPolicyState(L,S){L==null&&(L=this.tabActiveKey);var T=this.curEditTabDit[L];if(T==null||T.curSelectPolicy=="")return null;if(T.policyState[T.curSelectPolicy]==null&&(T.policyState[T.curSelectPolicy]={resultSymbolList:[],curSelectSymbolItem:{},progress:0}),S!=null){var _=T.policyState[T.curSelectPolicy][S];return _}else return T.policyState[T.curSelectPolicy]},getPolicyStateByName(L,S,T){L==null&&(L=this.tabActiveKey);var _=this.curEditTabDit[L];return _==null?null:(_.policyState[S]==null&&(_.policyState[S]={resultSymbolList:[],curSelectSymbolItem:{},progress:0}),T!=null?_.policyState[S][T]:_.policyState[S])},setPolicyState(L,S,T){L==null&&(L=this.tabActiveKey);var _=this.getPolicyState(L);_!=null&&(_[S]=T)},setPolicyStateByName(L,S,T,_){L==null&&(L=this.tabActiveKey);var w=this.getPolicyStateByName(L,S);w!=null&&(w[T]=_)},freshCurEdit(){this.curEditTabDit[this.tabActiveKey]==null&&(this.curEditTabDit[this.tabActiveKey]={policyList:[],curSelectPolicy:"",curEditRulesDit:{ruleOfSelect:[],ruleOfBuy:[],ruleOfSale:[]},resultSymbolList:[],curSelectSymbolItem:{},policyState:[]});var L=menuItems.value.find(_=>_.key==this.tabActiveKey).modeJson;if(L!=null&&(L.policyList!=null&&(this.curEditTabDit[this.tabActiveKey].policyList=L.policyList,L.policyList.length>0&&this.curEditTabDit[this.tabActiveKey].curSelectPolicy==""&&this.onClickOnePolicy(L.policyList[0])),L.config!=null))for(var S=0;S<this.huiceConfig.length;S++){var T=this.huiceConfig[S].key;L.config[T]!=null&&(this.huiceConfig[S].value=L.config[T])}},saveCurEditRule(L){if(L==null&&(L=this.tabActiveKey),this.curEditTabDit[L]==null){console.warn("this.curEditTabDit[tabActiveKey] == null",L);return}if(this.curEditTabDit[L].curSelectPolicy!=""){var S=this.curEditTabDit[L].policyList,T=S.findIndex(w=>w.name==this.curEditTabDit[L].curSelectPolicy);if(T!=-1&&graphDit[L]!=null&&graphDit[L][this.curEditTabDit[L].curSelectPolicy]!=null){var _=graphDit[L][this.curEditTabDit[L].curSelectPolicy];if(recordTouch.length!=0){if(this.configs.recordType=="autoRecordTouch"){let B=_.findNodesByType("output/autoRunRecordTouch")[0];B==null&&(B=LiteGraph.createNode("output/autoRunRecordTouch"),_.add(B)),B.setProperty("recordTouch",JSON.parse(JSON.stringify(recordTouch)))}recordTouch=[]}S[T].graphJson=_.asSerialisable()}}},onChangeGraph(L,S,T){console.log("onChangeGraph ",L,S);let _=this.curEditTabDit[this.tabActiveKey].policyList;console.log("policyList",_);let w=!1;if(S>=0&&_[S]!=null)w=!0,this.onClickOnePolicy(_[S]);else{let B=_.findIndex(A=>A.name==L);B!=-1&&(w=!0,this.onClickOnePolicy(_[B]))}w==!0&&T&&(this.autoRunPolicy=!0)},onGraphMenuClick(L,S){console.log("点击了菜单",L),L=="editColider"?(this.editColiderOpen=!0,this.editColiderImg=S.img,this.pointArr=S.pointArr,this.onMarkEditOk=S.onValueChange,this.editColiderScale=S.scale):L=="editSoundText"?(this.editSoundTextOpen=!0,this.editSoundTextParams=S,this.editSoundTextParams.url=rootHost+"/"+S.customeName):L=="layoutNodesJustX"&&this.onClickMenuItem({key:"layoutNodesJustX"})},onSoundTextEditOk(L){this.editSoundTextOpen=!1,this.editSoundTextParams.onValueChange!=null&&this.editSoundTextParams.onValueChange(L)},onGraphNodeClick(L){this.configs.recordType=="autoRecordTouch"&&(console.log("我收到点击事件",L),recordTouch.push(L))},handleOkCreateMotionText(){let L=this.addNodeToGraph("objects/createObject"),S=this.addNodeToGraph("output/customComponent/MotionText",L),T=arrToDit(this.createMotionTextConfig,"key","value"),w=this.getCurEditLGraph().findNodesByType("objects/createObject"),B=99;w!=null&&(B=w.length),L.setProperty("modal","文本"),L.setProperty("x",0),L.setProperty("y",0),L.setProperty("zIndex",B),L.setProperty("color","#000000"),L.setProperty("anchorX",0),L.setProperty("outLineWidth",4),L.setProperty("string",T.content),L.onWidgetChanged("物体类型"),L.connect(0,S,0),this.showCreateMotionTextModal=!1},handleOkSoundMotionText(){this.templeteAudio!=null&&(this.templeteAudio.pause(),this.templeteAudio.src=""),this.showSoundBoxModal=!1},onClickOnePolicy(L){if(this.saveCurEditRule(),this.clearCurEditLgragh(),L==null){this.curEditTabDit[this.tabActiveKey].curSelectPolicy="";return}this.curEditTabDit[this.tabActiveKey].curSelectPolicy=L.name,this.$nextTick(()=>{this.updateCurShowLGraph()})},onClickAddPolicy(){var L=this.curEditTabDit[this.tabActiveKey].policyList;if(isEmptyString(this.newPolicyName)){this.$message.error("分镜名称不能为空");return}var S=L.findIndex(_=>_.name==this.newPolicyName);if(S!=-1){this.$message.error("当前列表已经存在分镜名称："+this.newPolicyName);return}var T={name:this.newPolicyName};this.curEditTabDit[this.tabActiveKey].policyList.push(T)},async onClickCopyPolicy(){if(isEmptyString(this.newPolicyName)){this.$message.error("分镜名称不能为空");return}var L={name:this.newPolicyName},S=this.curEditTabDit[this.tabActiveKey].policyList,T=S.findIndex(A=>A.name==this.curEditTabDit[this.tabActiveKey].curSelectPolicy);if(T!=-1&&(L=clone(S[T]),L.name=this.newPolicyName),this.curEditTabDit[this.copyToProject]!=null){var _=this.curEditTabDit[this.copyToProject].policyList,w=_.findIndex(A=>A.name==this.newPolicyName);if(w!=-1){this.$message.error(this.copyToProject+"已经存在分镜："+this.newPolicyName);return}this.curEditTabDit[this.copyToProject].policyList.push(L)}else{var B=await this.getFromLocalOrCloud(POLICYKEY+this.copyToProject);if(B!=null){var w=B.policyList.findIndex(O=>O.name==this.newPolicyName);if(w!=-1){this.$message.error(B.name+"已经存在分镜："+this.newPolicyName);return}B.policyList.push(L),await this.setToLocalOrCloud(POLICYKEY+this.copyToProject,B)}}},onClickDeletePolicy(){if(window.otplib.authenticator.check(this.verificationCode,totpSecret)==!1){this.$message.error("权限验证码错误！");return}if(this.curEditTabDit[this.tabActiveKey]!=null){var S=this.curEditTabDit[this.tabActiveKey].policyList;if(S.length<=1){this.$message.error("绘本中至少要有一个分镜");return}console.log("确认删除分镜",this.curEditTabDit[this.tabActiveKey].curSelectPolicy);var T=S.findIndex(_=>_.name==this.curEditTabDit[this.tabActiveKey].curSelectPolicy);T!=-1&&(S.splice(T,1),this.onClickOnePolicy(S[0]))}},async onBtnExportModel(L){console.log("准备导出绘本",L);var S=await this.getFromLocalOrCloud(POLICYKEY+L);S!=null&&exportRaw(S.name+".json",JSON.stringify(S))},onBtnImportModel(L){var S=null;this.$refs.modelImport.files==null?S=this.$refs.modelImport[0].files[0]:S=this.$refs.modelImport.files[0];const T=new FileReader;T.onload=async _=>{try{var w=JSON.parse(T.result);this.importModelOpen=!0,this.newProjectName=w.name,this.inputModelDes=w.des,this.waitImportProject=w}catch(B){console.error("error",B)}S=null},T.readAsText(S),L.target.value=""},onBtnImportOldVersion(L){if(window.require==null){this.$message.warn("此功能仅在桌面版可用，网页版无法使用");return}this.importModelOpen=!0,this.onFreshCanImportPage()},async parseExcelConfig(L){let S=L[0],T=[];for(var _=2;_<L.length;_++){let A=L[_],O={};for(var w in S)w!="__rowNum__"&&(A[w]==null&&(A[w]=""),S[w]=="grpup"||S[w]=="labels"?O[S[w]]=A[w].split(","):O[S[w]]=A[w]);T.push(O);let R=this.modelTableDatas.findIndex(E=>E.name==O.bookId);if(R==-1&&await this.onBtnCreateModel(null,O.bookId),R=this.modelTableDatas.findIndex(E=>E.name==O.bookId),R==-1){console.warn("创建失败了",O.bookId);continue}let P=arrToDit(this.huiceConfig,"key","value");for(var B in P)O[B]!=null&&(this.modelTableDatas[R].config[B]=O[B])}this.saveTableData(),console.log("configArr",T,this.modelTableDatas)},onBtnImportExcelConfig(L){const S=L.target.files[0],T=new FileReader;T.onload=_=>{const w=new Uint8Array(_.target.result),B=readSync(w,{type:"array"}),A=B.SheetNames[0],O=B.Sheets[A],R=utils$1.sheet_to_json(O);console.log("读取到的json数据",R),this.parseExcelConfig(R)},T.readAsArrayBuffer(S)},onFinishVerificationCode(L){},async onBtnDeleteModel(L){if(window.otplib.authenticator.check(this.verificationCode,totpSecret)==!1){this.$message.error("权限验证码错误！");return}var T=this.modelTableDatas.findIndex(_=>_.name==L);T!=-1&&(this.modelTableDatas.splice(T,1),this.delToLocalOrCloud(POLICYKEY+L),this.saveTableData())},openTab(){this.activeKey=new Date().getTime(),menuItems.value.push({title:"New Tab",label:"Content of new Tab "+this.activeKey,key:this.activeKey})},closeModelTab(L){console.log("closeTab",L),this.onClickSaveBtn(L);let S=0;menuItems.value.forEach((T,_)=>{T.key===L&&(S=_-1)}),menuItems.value=menuItems.value.filter(T=>T.key!==L),menuItems.value.length&&this.tabActiveKey===L&&(S>=0?this.tabActiveKey=menuItems.value[S].key:this.tabActiveKey=menuItems.value[0].key),this.$nextTick(()=>{var T=graphDit[L];console.log("关闭绘本的情况graphDit",T);for(var _ in T)T[_].clear();delete graphDit[L],delete this.curEditTabDit[L]})},async onClickSaveBtn(L){if(L==0){this.saveTableData();return}var S=menuItems.value.findIndex(O=>O.key==L);if(S==-1){console.log("menuItems find "+L+" == -1");return}var T=menuItems.value[S].modeJson;T.config=arrToDit(this.huiceConfig,"key","value");let _=this.modelTableDatas.findIndex(O=>O.key==L);_!=-1&&(this.modelTableDatas[_].config=T.config),this.saveCurEditRule(L),T.policyList=this.curEditTabDit[L].policyList;let w=await this.getFromLocalOrCloud(POLICYKEY+L);if(w==null){api.error(L+" 保存失败：拉取云端文件失败");return}if(w.lastChangedTime!=null&&w.lastChangedTime!=T.lastChangedTime){api$1.error({message:L+" 保存失败：与云端版本冲突",description:()=>h$1("div",{style:{"white-space":"pre-wrap"}},"云端保存时间："+hooks(w.lastChangedTime).format("YYYY-MM-DD HH:mm:ss")+"\n本地打开时间："+hooks(T.lastChangedTime).format("YYYY-MM-DD HH:mm:ss")),duration:0});return}let B=T.lastChangedTime;T.lastChangedTime=new Date().getTime();var A=await this.setToLocalOrCloud(POLICYKEY+L,JSON.parse(JSON.stringify(T)));await this.saveTableData(),A==!0?api.success(L+" 保存成功"):T.lastChangedTime=B},async onClickPublishBtn(L){if(L==0){this.publishTableData();return}var S=menuItems.value.findIndex(_=>_.key==L);if(S==-1){console.log("menuItems find "+L+" == -1");return}var T=menuItems.value[S].modeJson;if(T.config=arrToDit(this.huiceConfig,"key","value"),this.saveCurEditRule(L),T.policyList=this.curEditTabDit[L].policyList,T.lastChangedTime=new Date().getTime(),console.log("要发布的modelJson ",T),console.log("bookes列表",this.modelTableDatas.findIndex),ossClient==null){this.$message.error("当前没有访问远程资源权限！请先设置AccessKey");return}try{let _=new Blob([JSON.stringify(T)],{type:"text/plain"});await ossClient.put("bookEditRelease/"+T.name+"."+T.lastChangedTime+".json",_);let w=this.modelTableDatas.findIndex(A=>A.name==T.name);w!=-1&&(this.modelTableDatas[w].publishTime=T.lastChangedTime);let B=new Blob([JSON.stringify(this.modelTableDatas)],{type:"text/plain"});await ossClient.put("bookEditRelease/"+TableDataSaveKey+".json",B),await this.saveTableData(),this.$message.success("发布成功！🎉🎉🎉")}catch(_){this.$message.error("发布失败:"+_,3),console.log("error",_)}},async publishTableData(){await this.saveTableData();try{let L=new Blob([JSON.stringify(this.modelTableDatas)],{type:"text/plain"});await ossClient.put("bookEditRelease/"+TableDataSaveKey+".json",L),this.$message.success("发布成功！🎉🎉🎉")}catch(L){this.$message.error("发布失败:"+L,3)}},onEdit(L,S){console.log("onEdit targetKey",L),S==="add"?(console.log("新建了文件"),this.openTab()):this.closeModelTab(L)},async saveTableData(){var L=this.modelTableDatas.map(S=>({createTime:S.createTime,publishTime:S.publishTime,key:S.key,name:S.name,des:S.des,config:S.config}));if(L.length==0){this.$message.error("要保存的列表不应该为空",3);return}try{await this.setToLocalOrCloud(TableDataSaveKey,JSON.parse(JSON.stringify(L)))}catch(S){this.$message.error("保存失败："+S,3)}},onhuiceConfigChange(L){console.log("哪一个绘本配置修改了",L)},onClone(L){console.log("onClone",L)},onConfigInputChange(L){console.log("onConfigInputChange",L)},ipcRunCall(L,S,T,_){if(window.require){var{ipcRenderer:w}=window.require("electron"),B={tabActiveKey:L,policyName:S,rulesDit:_,huiceConfig:T},A=w.sendSync("loopCheckRule",JSON.parse(JSON.stringify(B)));console.log("ipcRenderer 调用成功",A)}},sortPolicyList(){var L=this.curEditTabDit[this.tabActiveKey].policyList;L.sort((S,T)=>{var _=0,w=0,B=this.getPolicyStateByName(null,S.name,"huiceInfo");B!=null&&(_=B[this.policySortKey]);var A=this.getPolicyStateByName(null,T.name,"huiceInfo");return A!=null&&(w=A[this.policySortKey]),B=null,A=null,this.policySortKeyIsDown==!0?_-w:w-_})},initLgraphCanvas(L){if(this.lgcanvas!=null)return L!=null&&(this.lgcanvas.setGraph(L),this.lgcanvas.draw(!0,!0)),this.lgcanvas;if(document.getElementById("mycanvas")!=null){console.log("准备创建lgcanvas");var S=new LGraphCanvas("mycanvas",L);return this.lgcanvas=S,console.log("创建了lgcanvas"),S}},async updateCurShowLGraph(){var L=this.curEditTabDit[this.tabActiveKey].curSelectPolicy;if(L==""||L==null){console.warn("curSelectPolicy == null");return}console.log("开始刷Graph, updateCurShowLGraph"),graphDit[this.tabActiveKey]==null&&(graphDit[this.tabActiveKey]={});let S=hasInit;if(console.log("cocoMgr开始init"),init(),await waitCocosInit(),console.log("cocoMgr加载完成"),S!=!0){let B=localStorage.getItem("cocosConfig");if(B!=null)try{B=JSON.parse(B),B.cocosPreviewIsShowState==!0&&showOrHideFPS(),B.cocosPreviewIsShowColiderBox==!0&&showOrHideColiderBox(),B.isPreviewMode==!1&&changePreviewMode(),this.cocosConfig=B}catch(A){console.error(A)}}this.waitLink.nodeObj!=null&&(this.$message.info({content:"绑定取消",key:this.waitLink.nodeObj.id,duration:1}),this.waitLink={});var T=graphDit[this.tabActiveKey][L];if(T!=null){this.initLgraphCanvas(T),T.config.mute=this.cocosConfig.mute,this.autoRunPolicy==!0&&(this.autoRunPolicy=!1,this.onClickRunGraph()),this.getCurEditLgraphTable();return}T=new LGraph,LiteGraph.debug=!0,LiteGraph.node_box_coloured_by_mode=!0,this.initLgraphCanvas(T);var _=this.curEditTabDit[this.tabActiveKey].policyList.findIndex(B=>B.name==L);if(_!=-1){var w=this.curEditTabDit[this.tabActiveKey].policyList[_];w.graphJson!=null&&(T.configure(w.graphJson),window.channel!=null&&(console.log("asSerialisable",T.asSerialisable()),window.channel.postMessage({type:"initLgraphCanvas",graph:JSON.parse(JSON.stringify(T.asSerialisable()))})))}T.config.mute=this.cocosConfig.mute,graphDit[this.tabActiveKey][L]=T,this.autoRunPolicy==!0&&(this.autoRunPolicy=!1,this.onClickRunGraph()),this.getCurEditLgraphTable()},getCurEditLGraph(){if(this.curEditTabDit[this.tabActiveKey]!=null){var L=this.curEditTabDit[this.tabActiveKey].curSelectPolicy;if(L==""||L==null){console.warn("curSelectPolicy == null");return}if(graphDit[this.tabActiveKey]!=null)return graphDit[this.tabActiveKey][L]}},clearCurEditLgragh(L,S){if(L==null&&(L=this.tabActiveKey),this.setPolicyState(L,"isRuning",!1),this.curEditTabDit[L]==null)return;if(S==null&&(S=this.curEditTabDit[L].curSelectPolicy),S==""||S==null){console.warn("curSelectPolicy == null");return}if(graphDit[L]==null)return;let T=graphDit[L][S];T!=null&&T.clear!=null&&T.clear(),delete graphDit[L][S]},getCellInputLinks(L,S){let T=this.getCurEditLGraph();if(T==null)return[];let _=T.getNodeById(L.id),w=[];for(var B=0;B<_.inputs.length;B++){let A=_.inputs[B];if(A.type==LiteGraph.ACTION){let O=_.getInputNode(B);if(O!=null)if(O.type!="middle/logic/orToggle")w.push({slotName:A.name,node:O});else for(let R=0;R<O.inputs.length;R++){let P=O.getInputNode(R);(P!=null||S==!0)&&w.push({slotName:A.name,node:P})}else S==!0&&w.push({slotName:A.name,node:null})}}return w},getCellInputLinkMenu(L,S,T,_){if(L!=!0){this.highlightNodeDit={};return}if(this.getCurEditLGraph()==null)return;let B=S[T][_],A=this.getCellInputLinks(B,!0);this.highlightNodeDit={},this.inputLinkMenu=[];let O={};for(var R=0;R<A.length;R++){let P=A[R].node,E=A[R].slotName;P!=null&&(this.highlightNodeDit[P.id]=1,O[E]=1,this.inputLinkMenu.push({key:"unLinkInput_"+P.id,label:"解绑："+P.title+P.id+"-"+E,has_submenu:!1}))}if(this.waitLink.nodeObj!=null){this.inputLinkMenu.push({type:"divider"});for(var R=0;R<A.length;R++){let E=A[R].slotName;if(this.inputLinkMenu.findIndex(I=>I.slotName==E)==-1){let I={key:"linkInput_"+E,label:"绑定："+E,slotName:E,has_submenu:!1};O[E]==1&&(I.icon=h$1(ApiFilled,{style:{color:"#219021"}})),this.inputLinkMenu.push(I)}}}},loopGetAllOutputNodes(L,S,T){let _=L.getOutputNodes(S)||[];for(var w=0;w<_.length;w++){let B=_[w];B.type=="middle/logic/orToggle"?this.loopGetAllOutputNodes(B,0,T):T.push(B)}},getCellOutputLinks(L){let S=this.getCurEditLGraph();if(S==null)return[];L.config!=null&&arrToDit(L.config,"key","value");let T=S.getNodeById(L.id),_={};for(var w=0;w<T.outputs.length;w++){let B=T.outputs[w];if(B.type==LiteGraph.EVENT){let A=[];this.loopGetAllOutputNodes(T,w,A),_[B.name]=A}}return _},getCellOutputLinkMenu(L,S,T,_){if(L!=!0){this.highlightNodeDit={};return}if(this.getCurEditLGraph()==null)return;let B=S[T][_],A=this.getCellOutputLinks(B),O=[];this.highlightNodeDit={};for(var R in A){let E=[];for(var P=0;P<A[R].length;P++){let D=A[R][P];this.highlightNodeDit[D.id]=1,E.push({key:"linked_"+D.id,label:D.title+D.id,has_submenu:!1})}A[R].length>0&&E.push({type:"divider"}),E.push({key:"connect_"+R,label:"绑定其它",slotName:R,has_submenu:!1}),O.push({key:R,label:R+"("+A[R].length+")",children:E})}this.outputLinkMenu=O},onClickCellInputMenuItem(L,S,T,_){let w=L.key,B=this.getCurEditLGraph();if(B==null)return;let A=S[T][_],O=B.getNodeById(A.id);if(w.indexOf("unLinkInput")!=-1){let P=w.split("_")[1];console.log("准备解除绑定--",O,A,w,P);for(var R=0;R<A.inputs.length;R++)if(A.inputs[R]==P){A.inputs.splice(R,1);break}for(var R=0;R<O.inputs.length;R++){let D=O.getInputNode(R);if(D!=null){if(D.type=="middle/logic/orToggle"){let I=D.findConnectSoltIndex(P);if(I!=-1){D.disconnectInput(I);break}}else if(D.id==P){O.disconnectInput(R);break}}}}else if(w.indexOf("linkInput")!=-1&&(console.log("点击了绑定操作",w,this.waitLink),this.waitLink.nodeObj!=null)){let P=this.waitLink.slotName,E=B.getNodeById(this.waitLink.nodeObj.id);if(E.id==O.id){this.$message.error({content:"绑定失败，不能绑定指令自身的输入节点",key:this.waitLink.nodeObj.id,duration:3}),this.waitLink={};return}let D=E.findOutputSlot(P),I=L.item.originItemValue.slotName,M=O.findInputSlot(I);if(D!=-1&&M!=-1){if(O.inputs[M].link==null)E.connect(D,O,M);else{let N="middle/logic/orToggle",k=O.getInputNode(M);if(k!=null)if(k.type==N)if(k.checkHasConnectMyInput(E)==!1)E.connect(D,k,k.getFreeSoltIndex());else{this.$message.error({content:"请勿重复绑定",key:this.waitLink.nodeObj.id,duration:1}),this.waitLink={};return}else{let F=O.getInputLink(M).origin_slot,G=LiteGraph.createNode(N);B.add(G),k.connect(F,G,G.getFreeSoltIndex()),E.connect(D,G,G.getFreeSoltIndex()),G.connect(0,O,M)}}this.$message.success({content:"绑定成功",key:this.waitLink.nodeObj.id,duration:1}),this.waitLink={},this.getCurEditLgraphTable()}}},onClickCellOutputMenuItem(L,S,T,_){let w=L.key;console.log("menuKey",L.key,S,T,_);let B=S[T][_];if(w.indexOf("connect")!=-1){let A=L.item.originItemValue.slotName;this.waitLink.nodeObj!=null&&(this.$message.info({content:"绑定取消",key:this.waitLink.nodeObj.id,duration:1}),this.waitLink={}),this.waitLink={nodeObj:B,slotName:A};let O="【"+A+"】绑定:等待选择一个指令",R=h$1(Tag,{style:{"margin-right":"0px"}},B.title+B.id),P=h$1("span",{style:{color:"#1668dc","margin-right":"20px"}},O),E=h$1(CloseOutlined,{style:{color:"red",cursor:"pointer","margin-right":"-2px"},onClick:()=>{console.log("点击了关闭"),this.waitLink.nodeObj!=null&&(this.$message.info({content:"绑定取消",key:this.waitLink.nodeObj.id,duration:1}),this.waitLink={})}}),D=h$1("span",{},[R,P,E]);this.$message.loading({content:D,key:B.id,duration:0})}},genOneNodeToTableCell(L){let S={id:L.id,type:L.type,title:L.title,nodeList:[L.id],noInput:!1,noOutput:!1,bgColor:"#6AFF92",inputs:[],outputs:[]},T=L.type.split("/")[0];typeColorEnum[T]!=null&&(S.tagColor=typeColorEnum[T]),L.type=="objects/animates/animate"?(L.getEnums(),L.isOutputConnected(0)&&L.isOutputConnected(1)||L.isOutputConnected(0)||L.isOutputConnected(1),L.outputs.map((R,P)=>({value:P,label:R.name})).push({value:"无",label:"无"}),S.config=[{key:"playAniName",value:L.properties.playAniName,type:"select",width:"70px",options:L._animations.map(R=>({value:R,label:R}))}]):L.type=="middle/logic/allToggle"?S.config=[{key:"inputCount",value:L.inputs.length,des:"全部触发有多少个可输入节点，要所有可输入节点都满足才会触发下一步",type:"number",min:2}]:L.type=="middle/change/timeDown"?S.config=[{key:"time_in_ms",value:L.properties.time_in_ms,des:"延迟时间（毫秒）",type:"number",width:"70px",min:0}]:L.type=="middle/change/timeDownCycle"?S.config=[{key:"interval",value:L.properties.interval,des:"延迟时间（毫秒）",type:"number",width:"70px",min:0}]:L.type=="input/value"?S.config=[{key:"value",value:L.properties.value,des:"数值",type:"number",width:"70px"}]:L.type=="middle/tool/sendData"?S.config=[{key:"customeName",value:L.properties.customeName,des:"发送事件",type:"input",width:"70px"}]:L.type=="middle/tool/acceptData"?S.config=[{key:"customeName",value:L.properties.customeName,des:"接收事件",type:"input",width:"70px"}]:L.type=="output/sound"&&(S.config=[{key:"customeName",value:L.properties.customeName,des:L.properties.customeName,type:"input",width:"70px"}]),L.findOutputByType(LiteGraph.EVENT)==null&&(S.noOutput=!0),L.findInputByType(LiteGraph.ACTION)==null&&(S.noInput=!0);let _=this.getCellInputLinks(S);for(var w=0;w<_.length;w++)S.inputs.push(_[w].node.id);let B=this.getCellOutputLinks(S);for(var A in B){let O=B[A];for(var w=0;w<O.length;w++)S.outputs.push(A+"_"+O[w].id)}return S},genLinkNodes(L,S,T){let _=L.outputs;S[T]==null&&(S[T]=[]);for(var w=0;w<_.length;w++)if(_[w].type=="codeNode"||_[w].type==LiteGraph.EVENT){let A=L.getOutputNodes(w);if(A!=null)for(var B=0;B<A.length;B++){let O=A[B],R=S.findIndex(P=>P.findIndex(E=>E.id==O.id)!=-1);if(R!=-1&&R==T-1){let P=S[R].findIndex(E=>E.id==O.id);S[R].splice(P,1),R=-1}R==-1&&(O.type!="middle/logic/orToggle"&&S[T].push(O),this.genLinkNodes(O,S,T+1))}}},checkNotInTableNodes(L,S){let T={},_=this.getCurEditLGraph();for(var w=0;w<L.length;w++)for(var B in L[w])if(T[L[w].id]=1,B.indexOf("linkNode")!=-1){let P=L[w][B];for(var A=0;A<P.length;A++)T[P[A].id]=1}for(var w=0;w<L.length;w++){let E=[],D="linkNode_0";for(var B in L[w])if(B.indexOf("linkNode")!=-1){let M=L[w][B];for(var A=0;A<M.length;A++){let k=M[A],F=_.getNodeById(k.id);for(var O=0;O<F.inputs.length;O++)if(F.inputs[O].type==LiteGraph.ACTION){let G=F.getInputNode(O);G!=null&&T[G.id]==null&&G.type!="middle/logic/orToggle"&&(E.push(this.genOneNodeToTableCell(G)),T[G.id]=1)}}}E.length!=0&&(L[w][D].length==0?L[w][D]=E:L[w][D]=L[w][D].concat(E))}let R=[];for(var A=0;A<_.nodes.length;A++){let E=_.nodes[A];T[E.id]==null&&E.type!="middle/logic/orToggle"&&R.push(this.genOneNodeToTableCell(E))}if(R.length!=0){let P={id:R[0].id,modal:"无物体"};for(var A=0;A<R.length;A++){let I=R[A];P["linkNode_"+A]=[I],S["linkNode_"+A]=1}for(var B in P)if(B.indexOf("linkNode")!=-1)for(var O=0;O<P[B].length;O++){let M=P[B][O],N=this.findSameRowUpNode(M,P);if(N!=-1){let k="linkNode_"+(N+1);P[k]==null&&(P[k]=[],S[k]=1),k!=B&&(P[k].push(M),P[B].splice(O,1),O--)}}let E=function(D){let I="linkNode_"+(D+1);return P[I]!=null?P[I].length>0?I:E(D+1):null};for(var B in P)if(B.indexOf("linkNode")!=-1&&P[B].length==0){let I=E(Number(B.split("_")[1]));I!=null&&(P[B]=P[I],P[I]=[])}L.push(P)}console.log("noLinkAnyNodes",R)},getNodeInRow(L){let S=null;for(var T=0;T<this.curEditLgraphTable.length;T++)if(this.curEditLgraphTable[T].id==L.id){S=this.curEditLgraphTable[T];break}return S},checkNodeIsSameRowWithUpNode(L,S){let _=this.getCurEditLGraph().getNodeById(L.id);if(_.getInputDataType(0)=="codeNode"){let B=_.getInputNode(0);return!(B!=null&&B.id!=S.id)}else{let B=this.getCellInputLinks(L),A=!1;for(var w=0;w<B.length;w++){let O=B[w].node,R=this.getNodeInRow(O);R!=null&&R.id==S.id&&(A=!0)}return A}},findSameRowUpNode(L,S){let T=-1;for(var _ in S)if(_.indexOf("linkNode")!=-1){if(S[_]==null){console.warn("row[key] == null",_);continue}for(var w=0;w<S[_].length;w++)if(S[_][w].outputs.findIndex(O=>{let R=O.split("_");return R[R.length-1]==L.id})!=-1){T=Number(_.split("_")[1]);break}}return T},sortTable(L,S){let T=this.getCurEditLGraph();for(var _=0;_<L.length;_++){let O=L[_];for(var w in O)if(w.indexOf("linkNode")!=-1)for(var B=0;B<O[w].length;B++){let R=O[w][B],P=T.getNodeById(R.id);if(this.checkNodeIsSameRowWithUpNode(R,O)==!1){console.log("不在同一行",R.title+R.id,O.customeName);let E=P.getInputNode(0);if(E!=null&&E.id!=O.id){let D=L.find(I=>{let M=!1;if(I.id==E.id){for(var N in I)if(N.indexOf("linkNode")!=-1&&I[N].findIndex(F=>F.id==R.id)!=-1){M=!0;break}}return M});if(D!=null){let I=-1;for(var A in D)if(A.indexOf("linkNode")!=-1&&(I=D[A].findIndex(M=>M.id==R.id)),I!=-1){D[w]==null&&(D[w]=[]),D[w].push(R),D[A].splice(I,1),O[w].splice(B,1),B--;break}}else{let I=this.findSameRowUpNode(R,O);if(console.log("虽然不在同一行，但也没有找到另一行",R.title+R.id,O.customeName,I),I!=-1){let M="linkNode_"+(I+1);console.log("找到了同一行的哪一列是连接的",M),O[M]==null&&(O[M]=[],S[M]=1),M!=w&&(O[M].push(R),O[w].splice(B,1),B--)}}}}}}},getCurEditLgraphTable(){let L=this.getCurEditLGraph();if(L==null)return;let S=[],T={};S=L.findNodesByType("objects/camera").concat(L.findNodesByType("objects/createObject").sort((B,A)=>B.properties.zIndex-A.properties.zIndex)).map(B=>{let A={id:B.id,modal:B.properties.modal,customeName:B.properties.customeName};B.getPreviewImg!=null&&(A.img=B.getPreviewImg()),B.type=="objects/camera"&&(A.modal="镜头"),A.modal=="文本"&&(A.customeName=B.properties.string);let O=[];this.genLinkNodes(B,O,0),O=O.map(P=>P.map(this.genOneNodeToTableCell)),A.linkNode_0=[],T.linkNode_0=1;for(var R=1;R<=O.length;R++)A["linkNode_"+R]=O[R-1],T["linkNode_"+R]=1;return A}),this.sortTable(S,T),this.checkNotInTableNodes(S,T);let _=this.graphTableColumns.findIndex(B=>B.key=="linkNode_0");console.log("linkNode_1:",_,this.graphTableColumns.length-1-_),_!=-1&&this.graphTableColumns.splice(_,this.graphTableColumns.length-1-_);for(let B in T){for(var w=0;w<S.length;w++)S[w][B]==null&&(S[w][B]=[]);this.graphTableColumns.splice(this.graphTableColumns.length-1,0,{title:B=="linkNode_1"?"初始关联指令":"关联指令",dataIndex:B,key:B,ellipsis:!0,resizable:!0,width:220,minWidth:75})}console.log("table",S),this.curEditLgraphTable=S},addOneColumnToTable(){let L=0;for(var S=0;S<this.graphTableColumns.length;S++)if(this.graphTableColumns[S].key.indexOf("linkNode_")!=-1){let _=Number(this.graphTableColumns[S].key.split("_")[1]);_>L&&(L=_)}L+=1;let T="linkNode_"+L;this.graphTableColumns.splice(this.graphTableColumns.length-1,0,{title:"关联指令",dataIndex:T,key:T,ellipsis:!0,resizable:!0,width:220,minWidth:75});for(var S=0;S<this.curEditLgraphTable.length;S++)this.curEditLgraphTable[S][T]==null&&(this.curEditLgraphTable[S][T]=[]);return T},addNameColumnToTable(){if(this.configs.showNameColumn==!0){let S={title:"资源",dataIndex:"customeName",key:"customeName",ellipsis:!0,resizable:!0,width:200};this.graphTableColumns.findIndex(_=>_.key=="customeName")==-1&&this.graphTableColumns.splice(1,0,S)}else{let S=this.graphTableColumns.findIndex(T=>T.key=="customeName");S!=-1&&this.graphTableColumns.splice(S,1)}},onGraphTableConfigChange(L,S,T,_){console.log("value修改了",L,S,T);let w=this.getCurEditLGraph();if(w==null)return;let B=S[T][_];if(B!=null){let O=w.getNodeById(B.id),R=arrToDit(B.config,"key","value");if(L=="playAniName"&&O.setProperty("loop",R[L].indexOf("std")!=-1),L!="spe_output")if(L=="inputCount"){let P=R[L]-O.inputs.length;if(console.log("增加还是减少inputslot数量",P,O.onGetInputs()),P>0){if(O.onGetInputs!=null)for(var A=0;A<P;A++){let E=O.onGetInputs();E[0]!=null&&O.addInput(E[0][0],E[0][1])}}else for(var A=0;A<Math.abs(P);A++)O.removeInput(O.inputs.length-1)}else O.setProperty(L,R[L])}},onLgraphTableDragEnd(){let L=this.getCurEditLGraph();for(var S=0;S<this.curEditLgraphTable.length;S++){let T=this.curEditLgraphTable[S],_=L.getNodeById(T.id);_!=null&&_.setProperty("zIndex",S)}},handleResizeTableColumn(L,S){S.width=L},onSelectChange(L){this.graphTableSelectRows=L},onGraphTableEnd(L,S,T){let _=L.to.dataset,w=L.target.dataset,B=this.curEditLgraphTable[Number(w.row)][w.col],A=this.curEditLgraphTable[Number(_.row)][_.col],O=this.getCurEditLGraph(),R=O.getNodeById(B.id),P=O.getNodeById(A.id),E=this.curEditLgraphTable[Number(w.row)].id,D=O.getNodeById(E),I=this.curEditLgraphTable[Number(_.row)].id,M=O.getNodeById(I);if(console.log("targetLinkObject",D,"toLinkObject",M),E==I){let k=D.outputs[0].links.findIndex(V=>{let j=O.links.get(V);return console.log("link",j.target_id,B.id),j.target_id==B.id}),F=D.outputs[0].links.findIndex(V=>O.links.get(V).target_id==A.id),G=D.outputs[0].links[k];D.outputs[0].links[k]=D.outputs[0].links[F],D.outputs[0].links[F]=G}else D.connect(0,P,0),M.connect(0,R,0);A.nodeList.splice(0,A.nodeList.length),A.nodeList.push(A.id),B.nodeList.push(B.id);let N=A;this.curEditLgraphTable[Number(_.row)][_.col]=B,this.curEditLgraphTable[Number(w.row)][w.col]=N},onGraphTableCellDragEnd(L,S,T){let _=L.to.dataset;L.target.dataset;let w=this.getCurEditLGraph();if(w==null)return;let B=L.clonedData,A=w.getNodeById(B.id),O=A.findInputByType("codeNode");if(console.log("是否需要重新关联",O,A),O!=-1){let R=this.curEditLgraphTable[Number(_.row)].id,P=w.getNodeById(R);P!=null&&(P.type=="objects/createObject"||P.type=="objects/camera")&&P.connect(0,A,O)}},onClickRunGraphStep(){var L=this.curEditTabDit[this.tabActiveKey].curSelectPolicy;if(L==""||L==null){console.warn("curSelectPolicy == null");return}var S=graphDit[this.tabActiveKey][L];S.runStep()},async onClickRunGraph(){var L=this.curEditTabDit[this.tabActiveKey].curSelectPolicy;if(L==""||L==null){console.warn("curSelectPolicy == null");return}if(graphDit[this.tabActiveKey]==null){console.warn("graphDit[this.tabActiveKey] == null");return}var S=graphDit[this.tabActiveKey][L];if(S==null){console.warn("graph == null",this.tabActiveKey,L);return}if(this.setPolicyState(this.tabActiveKey,"isStartLoading",!0),window.channel&&window.channel.postMessage({type:"graphStart",graph:JSON.parse(JSON.stringify(S.asSerialisable()))}),recordTouch=[],this.configs.recordType=="autoRunRecordTouch"){let _=S.findNodesByType("output/autoRunRecordTouch")[0];_!=null&&_.setProperty("active",!0)}else{let _=S.findNodesByType("output/autoRunRecordTouch")[0];_!=null&&_.setProperty("active",!1)}this.curOpenLayout[1]==1&&await S.start(),this.setPolicyState(this.tabActiveKey,"isRuning",!0),this.setPolicyState(this.tabActiveKey,"isStartLoading",!1),this.freshState=!this.freshState},onClickStopGraph(){var L=this.curEditTabDit[this.tabActiveKey].curSelectPolicy;if(L==""||L==null){console.warn("curSelectPolicy == null");return}if(graphDit[this.tabActiveKey]!=null){var S=graphDit[this.tabActiveKey][L];this.curOpenLayout[1]==1&&S.stop(),window.channel&&window.channel.postMessage({type:"graphStop"}),this.setPolicyState(this.tabActiveKey,"isRuning",!1),this.freshState=!this.freshState,this.configs.recordType=="autoRecordTouch"&&this.saveCurEditRule()}},addNodeToGraph(L,S){if(this.lgcanvas==null)return;let T=this.lgcanvas.graph;if(T!=null){if(L=="objects/camera"&&T.findNodesByType(L).length>0){this.$message.warn("只能添加一个镜头节点");return}var _=LiteGraph.createNode(L);if(_.pos=[200,200],T.list_of_graphcanvas[0]!=null){var w=T.list_of_graphcanvas[0].visible_area;if(S!=null){let B=S.getOutputNodes(0),A=S.pos[0]+S.width+3,O=S.pos[1];if(B!=null)for(let R=0;R<B.length;R++){let P=B[R];P.pos[1]>O&&(O=P.pos[1]+P.height+3)}_.pos=[A,O]}else _.pos=[w[2]*.5+w[0],w[3]*.5+w[1]];console.log("viewport",w)}return T.add(_),_.createLinkNode!=null&&_.createLinkNode(),_}},getEditViewCenterPos(L){if(this.lgcanvas==null)return[0,0];let S=this.lgcanvas.visible_area;return L==!0?[S[2]*.5,S[3]*.5]:[S[2]*.5+S[0],S[3]*.5+S[1]]},getCurGraphIsRuning(){if(this.curEditTabDit[this.tabActiveKey]==null)return!1;var L=this.curEditTabDit[this.tabActiveKey].curSelectPolicy;if(L==""||L==null)return console.warn("curSelectPolicy == null"),!1;if(graphDit[this.tabActiveKey]==null)return!1;var S=graphDit[this.tabActiveKey][L];return S!=null?(console.log("获取到了蓝图的状态",S.status,LGraph.STATUS_RUNNING),S.status==LGraph.STATUS_RUNNING):!1},onClickExpandPreview(){this.cocosPreviewCanDrag=!this.cocosPreviewCanDrag},onClickFreshPreview(){refreshTree(),console.log("TreeData",treeData),this.cocosPreviewTreeData=treeData},onClickConsoleSelect(){this.$message.info("对象已打印至控制台"),console.log(selectedNode)},onClickTreeExport(){console.log(this.expandedKeys),this.expandedKeys=getHasChildrenNodeId()},onClickFpsPreview(){this.cocosPreviewIsShowState=showOrHideFPS()},onClickTreePreview(L){if(L=="cocosPreviewIsShowState"){this.cocosConfig[L]=showOrHideFPS(),localStorage.setItem("cocosConfig",JSON.stringify(this.cocosConfig));return}if(L=="cocosPreviewIsShowColiderBox"){this.cocosConfig[L]=showOrHideColiderBox(),localStorage.setItem("cocosConfig",JSON.stringify(this.cocosConfig));return}if(this.cocosConfig[L]=!this.cocosConfig[L],L=="cocosPreviewIsShowTree")refreshTree(),this.cocosPreviewTreeData=treeData;else if(L=="cocosPreviewCanDrag")this.cocosConfig.cocosPreviewIsShowGird&&(this.cocosConfig.cocosPreviewIsShowGird=!1,setTimeout(()=>{this.cocosConfig.cocosPreviewIsShowGird=!0},700));else if(L=="isPreviewMode")changePreviewMode(),this.cocosConfig[L]=isPreviewMode,console.log("CocosMgr.isPreviewMode",isPreviewMode);else if(L=="mute"){let S=this.getCurEditLGraph();S!=null&&(S.config.mute=this.cocosConfig.mute)}localStorage.setItem("cocosConfig",JSON.stringify(this.cocosConfig))},onClickNewPreview(){let L=window.location.origin+window.location.pathname+"#/BookPreview";console.log("打开的url",L,window.location),window.open(L,"_blank","height=1028,width=1634"),setTimeout(()=>{let S=this.getCurEditLGraph();window.channel!=null&&S!=null&&window.channel.postMessage({type:"initLgraphCanvas",graph:JSON.parse(JSON.stringify(S.asSerialisable()))})},1e3)},onChangeRadionPicker(L){if(console.log("onChangeRadionPicker",L),L!="无比例"){var S=L.split(":"),T=Number(S[1]),_=Number(S[0]);this.cocosConfig.aspectRadio=T/_}else this.cocosConfig.aspectRadio=0;localStorage.setItem("cocosConfig",JSON.stringify(this.cocosConfig))},onClickClearScene(){clearScene(),this.$message.info("已清空场景")},onPreviewSizeChange(L){setTimeout(()=>{updateCanvasSize(L.width,L.height)},100);for(var S={width:designViewWidth,height:designViewHeight},T={width:1920,height:1500},_={width:2560,height:1080},w=[T,_],B=[],A=0;A<w.length;A++){var O=w[A],R=(S.height-O.height)*.5,P=R/S.height,E=(O.height+R)/S.height;P!=0&&B.push({top:P*L.height,left:0,width:"100%",height:"2px"}),E!=1&&B.push({top:E*L.height,left:0,width:"100%",height:"2px"});var D=(S.width-O.width)*.5,I=D/S.width,M=(O.width+D)/S.width;I!=0&&B.push({top:0,left:I*L.width,width:"2px",height:"100%"}),M!=1&&B.push({top:0,left:M*L.width,width:"2px",height:"100%"})}this.saveAreaLines=B},onPreviewTreeSizeChange(L){this.cocosPreviewTreeWidth=L.width},onSelectCocosNode(L){var S=L[0],T=getNodeById(S);T!=null&&drawNodeRect(T)},onHandDarkMode(L){window.onChangeDarkMode!=null&&window.onChangeDarkMode(L)},handleSoundBoxTableChange(L,S,T){if(this.filteredInfo=S,this.sortedInfo=T,T.columnKey!=null){let _=this.soundBoxColumns.findIndex(w=>w.key==T.columnKey);this.soundBoxColumns[_].sortOrder=T.order}},onBtnUseBoxOneRow(L){console.log("onBtnUseBoxOneRow",L),L.type=="sound"?this.onClickMenuItem({key:"output/sound",initProp:{customeName:L.customeName}}):L.type=="spine"?this.onClickMenuItem({key:"objects/createObject",initProp:{modal:ObjectTypeEnum.spine,customeName:L.customeName}}):L.type=="image"&&this.onClickMenuItem({key:"objects/createObject",initProp:{modal:ObjectTypeEnum.sprite,customeName:L.customeName}}),this.$message.success("已添加："+L.customeName)},donwLoadUrl(L,S){let T=document.createElement("a");T.href=L,T.download=S,T.click()},onBtnDownLoadBoxOneRow(L){let S=rootHost+"/"+L.customeName;L.type=="spine"?(this.donwLoadUrl(S+".json",L.name+".json"),setTimeout(()=>{this.donwLoadUrl(S+".atlas",L.name+".atlas")},100),setTimeout(()=>{this.donwLoadUrl(S+".png",L.name+".png")},200)):this.donwLoadUrl(S,L.name+getExName(L.customeName,!0))},onBtnPlayBoxOneRow(L){let S=rootHost+"/"+L.customeName;console.log("record",L,S),L.type=="spine"||L.type=="sound"&&(this.templeteAudio!=null?(this.templeteAudio.pause(),this.templeteAudio.src=S):this.templeteAudio=new Audio(S),this.templeteAudio.play())},onFileChange(L){console.log("handleChange",L)},handleDragOver(L){L.dataTransfer.dropEffect="copy"},async uploadOneFile(L,S){return new Promise((T,_)=>{const w=new FileReader,B=new SparkMD5.ArrayBuffer;w.onload=async A=>{try{B.append(w.result);var O=B.end(),R=L.name,P;if(R.indexOf(".")!=-1&&(R=L.name.split("."),P=R[R.length-1],R.splice(R.length-1,0,O.substring(0,8))),R=R.join("."),ossClient==null){this.$message.error("当前没有访问远程资源权限！请先设置AccessKey");return}await ossClient.put("bookEdit/"+R,L);var E=this.getCurEditLGraph();if(E!=null){var D=[200,200];if(E.list_of_graphcanvas[0]!=null){var I=E.list_of_graphcanvas[0].visible_area;D=[this.dropedX+I[0],this.dropedY+I[1]],this.dropedX+=40,this.dropedY+=40}let M=getFileType(P);if(M!="音频"){let N=LiteGraph.createNode("objects/createObject");E.add(N),N.pos=D,N.setProperty("modal",M),console.log("fileType",M),M=="spine"&&(console.log("直接设置了premulAlpha"),N.setProperty("premulAlpha",!0)),N.setProperty("customeName",R)}else{let N=LiteGraph.createNode("output/sound");E.add(N),N.pos=D,N.setProperty("customeName",R)}}T()}catch(M){console.error("资源上传失败：",M),this.$message.error("资源上传失败："+L.name),T()}},w.readAsArrayBuffer(L)})},async uploadFiles(L){console.log("上传了文件",L);for(var S=0;S<L.length;S++){var T=L[S];await this.uploadOneFile(T,!0)}console.log("上传文件结束")},async genMd5(L){const S=new SparkMD5.ArrayBuffer;for(var T=0;T<L.files.length;T++){var _=await this.readArrayBufferFile(L.files[T]);S.append(_)}var w=S.end();return w.substring(0,8)},addGroupFileToGraph(L){var S=this.getCurEditLGraph();if(S!=null){var T=[200,200];if(S.list_of_graphcanvas[0]!=null){var _=S.list_of_graphcanvas[0].visible_area;T=[this.dropedX+_[0],this.dropedY+_[1]]}L.x!=null&&(T[0]=L.x),L.y!=null&&(T[1]=L.y);let A=getFileType(L.type);var w=["空物体","图片","绘制","spine","文本"];if(w.indexOf(A)!=-1){let O=LiteGraph.createNode("objects/createObject");O.pos=T,this.dropedX+=O.width+3,O.setProperty("modal",A);var B=S.findNodesByType("objects/createObject").length;if(console.log("当前页面object数量",B),O.setProperty("zIndex",B),O.setProperty("customeName",L.path),A=="spine"){O.setProperty("premulAlpha",!0),S.add(O);let R=LiteGraph.createNode("objects/animates/animate");R.setProperty("autoRun",!0),R.pos=[O.pos[0]+O.width+3,O.pos[1]],this.dropedX+=O.width+3,S.add(R),O.connect(0,R,0)}else S.add(O)}else if(A=="音频"){let O=LiteGraph.createNode("output/sound");O.pos=T,this.dropedX+=O.width+3,O.setProperty("customeName",L.path),S.add(O)}}},async uploadGroupFile(L){if(ossClient==null){this.$message.error("当前没有访问远程资源权限！请先设置AccessKey");return}this.importProgress=0,this.importInfo="0/"+L.length;let S=null;window.require!=null&&(S=window.require("fs"));for(var T=0;T<L.length;T++){var _=L[T];_.md5=await this.genMd5(_);try{if(_.files.length==1){var w=_.name+"."+_.md5+"."+_.type;if(_.path=w,_.customeName=w,typeof _.files[0].path=="string")if(S!=null){let A=S.readFileSync(_.files[0].path);await ossClient.put("bookEdit/"+w,A)}else console.warn("文件路径上传需要当前有fs环境");else await ossClient.put("bookEdit/"+w,_.files[0])}else{_.modal="spine",_.path=_.md5+"/"+_.name,_.customeName=_.path;for(var B=0;B<_.files.length;B++)if(typeof _.files[B].path=="string")if(S!=null){let A=S.readFileSync(_.files[B].path);await ossClient.put("bookEdit/"+_.md5+"/"+_.files[B].name,A)}else console.warn("文件路径上传需要当前有fs环境");else await ossClient.put("bookEdit/"+_.md5+"/"+_.files[B].name,_.files[B])}}catch(A){this.$message.error("上传文件失败:"+A,3),console.log("error",A)}this.tabActiveKey!=0&&(this.showSoundBoxModal==!1?this.configs.uploadReplaceAssestByName==!0?this.replaceFileGrpup(_)==!1&&this.addGroupFileToGraph(_):this.addGroupFileToGraph(_):this.replaceFileGroupByBook(_)),this.importProgress=Math.ceil((T+1)/L.length*100),this.importInfo=T+1+"/"+L.length,this.showSoundBoxModal==!0&&this.freshAssestBoxData()}this.ruleChooseTabOption=="表格"&&this.getCurEditLgraphTable(),console.log("uploadGroupFile",L)},async readJsonFile(L){if(typeof L.path=="string"&&window.require!=null){let T=window.require("fs").readFileSync(L.path,"utf-8");return JSON.parse(T)}return new Promise((S,T)=>{const _=new FileReader;_.onload=async w=>{S(JSON.parse(_.result))},_.readAsText(L)})},async readArrayBufferFile(L){if(typeof L.path=="string"&&window.require!=null){let T=window.require("fs").readFileSync(L.path);return T.buffer.slice(T.byteOffset,T.byteOffset+T.byteLength)}return new Promise((S,T)=>{const _=new FileReader;_.onload=async w=>{S(_.result)},_.readAsArrayBuffer(L)})},getSpineOtherFiles(L,S){var T=[];for(var _ in L){var w=_.split(".")[0];w==S&&(T.push(L[_]),delete L[_])}return T},async prepareDealFiles(L){for(var S=[],T={},_=0;_<L.length;_++)T[L[_].name]=L[_];for(var w in T){var B=T[w],A=getExName(w);if(A=="json"){var O=await this.readJsonFile(B);if(O.skeleton!=null&&O.skeleton.spine!=null){var R=B.name.split(".")[0],P=this.getSpineOtherFiles(T,R);S.push({files:P,type:"spine",name:R})}}}for(var w in T)S.push({files:[T[w]],type:getExName(w),name:getBaseName(w)});return await this.uploadGroupFile(S),S},handleDrop(L){const S=L.dataTransfer.files;console.log("最终drop的位置",L.offsetX,L.offsetY),this.dropedX=L.offsetX,this.dropedY=L.offsetY,S.length&&this.prepareDealFiles(S)},onBtnImportAssest(L){var S=null;this.$refs.modelImport2.files==null?S=this.$refs.modelImport2[0].files:S=this.$refs.modelImport2.files;let T=this.getEditViewCenterPos(!0);this.dropedX=T[0],this.dropedY=T[1],S!=null&&S.length&&this.prepareDealFiles(S),L.target.value=""},onSaveSetting(){let L=arrToDit(this.systemSetting,"key","value");ossClient=new aliyunOssSdk({region:"oss-cn-shanghai",accessKeyId:L.accessKeyId,accessKeySecret:L.accessKeySecret,bucket:L.bucket}),localStorage.setItem("bookEditConfig",JSON.stringify(L))},onStopClick(L,S){L!=null&&L.stopPropagation&&L.stopPropagation(),S!=null&&S.stopPropagation&&S.stopPropagation()},handleSearch(L,S,T){S()},handleReset(L){L({confirm:!0})}}},_hoisted_1={class:"about"},_hoisted_2={key:0},_hoisted_3={style:{width:"200px"}},_hoisted_4={key:0,style:{width:"200px"}},_hoisted_5={style:{width:"100px",height:"130px","border-radius":"12%",position:"relative"}},_hoisted_6=["src"],_hoisted_7={id:"leftFlexView",style:{display:"flex","flex-direction":"column",gap:"5px"}},_hoisted_8={id:"huiceConfigCard",style:{display:"flex","flex-direction":"column",gap:"5px"}},_hoisted_9=["width","height"],_hoisted_10={style:{display:"flex",height:"37px","user-select":"none",overflow:"hidden","margin-top":"-8px","justify-content":"left",width:"100%"}},_hoisted_11=["width","height"],_hoisted_12=["src"],_hoisted_13={style:{position:"absolute",width:"100%",height:"100%",top:"0%",left:"0%",display:"flex","justify-content":"center","align-items":"center"}},_hoisted_14={key:0,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden"}},_hoisted_15=["src"],_hoisted_16={style:{width:"200px"}},_hoisted_17={style:{"margin-top":"10px"}},_hoisted_18={key:0,style:{"font-size":"large"}},_hoisted_19={key:1,style:{"font-size":"large"}},_hoisted_20={key:2,style:{"font-size":"large"}};function _sfc_render(L,S,T,_,w,B){const A=resolveComponent("CloudUploadOutlined"),O=resolveComponent("a-button"),R=resolveComponent("SaveOutlined"),P=resolveComponent("SettingOutlined"),E=resolveComponent("PictureOutlined"),D=resolveComponent("UnorderedListOutlined"),I=resolveComponent("NodeIndexOutlined"),M=resolveComponent("UpCircleOutlined"),N=resolveComponent("a-button-group"),k=resolveComponent("a-switch"),F=resolveComponent("a-flex"),G=resolveComponent("a-tab-pane"),V=resolveComponent("a-tabs"),j=resolveComponent("a-input"),H=resolveComponent("a-popconfirm"),U=resolveComponent("ConfigInput"),X=resolveComponent("a-select"),Y=resolveComponent("SearchOutlined"),z=resolveComponent("search-outlined"),W=resolveComponent("EditOutlined"),Z=resolveComponent("DownloadOutlined"),Q=resolveComponent("CopyOutlined"),ee=resolveComponent("arco-verification-code"),te=resolveComponent("DeleteOutlined"),re=resolveComponent("a-upload-dragger"),ie=resolveComponent("a-table"),ne=resolveComponent("VueDraggable"),he=resolveComponent("a-card"),pe=resolveComponent("ClearOutlined"),K=resolveComponent("a-tooltip"),ue=resolveComponent("VideoCameraOutlined"),le=resolveComponent("NumberOutlined"),ce=resolveComponent("DeploymentUnitOutlined"),_e=resolveComponent("DashboardOutlined"),oe=resolveComponent("GatewayOutlined"),de=resolveComponent("SoundFilled"),me=resolveComponent("SoundOutlined"),ye=resolveComponent("FullscreenOutlined"),ge=resolveComponent("FullscreenExitOutlined"),we=resolveComponent("BlockOutlined"),Te=resolveComponent("ExpandAltOutlined"),Ee=resolveComponent("CodeOutlined"),De=resolveComponent("SyncOutlined"),fe=resolveComponent("a-tree"),Ce=resolveComponent("UseElementSize"),Se=resolveComponent("TopFreeDrag"),be=resolveComponent("PlusOutlined"),Re=resolveComponent("MenuOutlined"),Ve=resolveComponent("LineOutlined"),Pe=resolveComponent("a-segmented"),ke=resolveComponent("a-menu"),Ne=resolveComponent("a-progress"),Ae=resolveComponent("a-radio-button"),Oe=resolveComponent("a-radio-group"),Fe=resolveComponent("DownCircleOutlined"),nt=resolveComponent("AppstoreAddOutlined"),Ze=resolveComponent("a-tag"),Xe=resolveComponent("a-popover"),$e=resolveComponent("MoreOutlined"),ot=resolveComponent("a-dropdown"),ut=resolveComponent("LoginOutlined"),gt=resolveComponent("LogoutOutlined"),Ue=resolveComponent("AimOutlined"),We=resolveComponent("a-checkbox"),ht=resolveComponent("a-divider"),Be=resolveComponent("a-checkbox-group"),je=resolveComponent("a-modal"),Qe=resolveComponent("MarkEdit"),st=resolveComponent("SoundTextEdit"),pt=resolveComponent("a-config-provider"),qe=resolveDirective("element-size");return openBlock(),createBlock(pt,{locale:w.locale,"component-size":"small"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[withDirectives(createVNode(V,{id:"tabHtml",tabBarStyle:{"margin-bottom":"0px"},style:{"user-select":"none"},activeKey:w.tabActiveKey,"onUpdate:activeKey":S[7]||(S[7]=rt=>w.tabActiveKey=rt),type:"editable-card",onEdit:B.onEdit,size:"small",hideAdd:!0},{rightExtra:withCtx(()=>[createVNode(F,{gap:"small",align:"center",style:{"margin-right":"10px"}},{default:withCtx(()=>[createVNode(O,{type:"primary",onClick:S[0]||(S[0]=rt=>B.onClickPublishBtn(w.tabActiveKey))},{icon:withCtx(()=>[createVNode(A)]),default:withCtx(()=>[S[55]||(S[55]=createTextVNode(" 发布 ",-1))]),_:1}),createVNode(O,{type:"primary",onClick:S[1]||(S[1]=rt=>B.onClickSaveBtn(w.tabActiveKey))},{icon:withCtx(()=>[createVNode(R)]),default:withCtx(()=>[S[56]||(S[56]=createTextVNode(" 保存 ",-1))]),_:1}),w.tabActiveKey!=0?(openBlock(),createBlock(N,{key:0,compact:""},{default:withCtx(()=>[createVNode(O,{type:w.curOpenLayout[0]?"primary":"default",onClick:S[2]||(S[2]=rt=>B.onClickChangeShowView(0))},{icon:withCtx(()=>[createVNode(P)]),_:1},8,["type"]),createVNode(O,{type:w.curOpenLayout[1]?"primary":"default",onClick:S[3]||(S[3]=rt=>B.onClickChangeShowView(1))},{icon:withCtx(()=>[createVNode(E)]),_:1},8,["type"]),createVNode(O,{type:w.curOpenLayout[2]?"primary":"default",onClick:S[4]||(S[4]=rt=>B.onClickChangeShowView(2))},{icon:withCtx(()=>[createVNode(D)]),_:1},8,["type"]),createVNode(O,{type:w.curOpenLayout[3]?"primary":"default"},{icon:withCtx(()=>[createVNode(I)]),_:1},8,["type"]),createVNode(O,{type:w.curOpenLayout[4]?"primary":"default",onClick:S[5]||(S[5]=rt=>B.onClickChangeShowView(4))},{icon:withCtx(()=>[createVNode(M)]),_:1},8,["type"])]),_:1})):createCommentVNode("",!0),createVNode(k,{size:"default",style:{height:"100%"},checked:w.isOpenDark,"onUpdate:checked":S[6]||(S[6]=rt=>w.isOpenDark=rt),onChange:B.onHandDarkMode},{checkedChildren:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent("BulbFilled")))]),unCheckedChildren:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent("BulbOutlined")))]),_:1},8,["checked","onChange"])]),_:1})]),default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(w.menuItems,rt=>(openBlock(),createBlock(G,{key:rt.key,tab:rt.title,closable:rt.closable},null,8,["tab","closable"]))),128))]),_:1},8,["activeKey","onEdit"]),[[vShow,w.curOpenLayout[4]==1]]),S[95]||(S[95]=createBaseVNode("div",null,null,-1)),w.tabActiveKey==0?(openBlock(),createElementBlock("div",_hoisted_2,[createVNode(F,{gap:"5",style:{padding:"5px"}},{default:withCtx(()=>[w.currentSelectMenu[0]==1?(openBlock(),createBlock(H,{key:0,title:"新建一个绘本",onConfirm:S[10]||(S[10]=rt=>B.onBtnCreateModel(null,this.newProjectName))},{description:withCtx(()=>[createVNode(j,{value:w.newProjectName,"onUpdate:value":S[8]||(S[8]=rt=>w.newProjectName=rt),"addon-before":"绘本编号",placeholder:"请输入新绘本编号",style:{"margin-bottom":"5px"}},null,8,["value"]),createVNode(j,{value:w.inputModelDes,"onUpdate:value":S[9]||(S[9]=rt=>w.inputModelDes=rt),"addon-before":"绘本备注",placeholder:"输入绘本备注"},null,8,["value"])]),default:withCtx(()=>[createVNode(O,{type:"primary"},{default:withCtx(()=>[...S[57]||(S[57]=[createTextVNode("新建绘本",-1)])]),_:1})]),_:1})):createCommentVNode("",!0),S[59]||(S[59]=createBaseVNode("div",{style:{"flex-grow":"1"}},null,-1)),w.currentSelectMenu[0]==1?(openBlock(),createBlock(H,{key:1,title:"系统设置",placement:"bottomRight",onConfirm:B.onSaveSetting},{description:withCtx(()=>[createVNode(U,{values:w.systemSetting,vertical:!0,marginLeft:"0px"},null,8,["values"])]),default:withCtx(()=>[createVNode(O,{type:"primary"},{default:withCtx(()=>[...S[58]||(S[58]=[createTextVNode("系统设置",-1)])]),_:1})]),_:1},8,["onConfirm"])):createCommentVNode("",!0)]),_:1}),w.currentSelectMenu[0]==1?(openBlock(),createBlock(ne,{key:0,modelValue:w.modelTableDatas,"onUpdate:modelValue":S[15]||(S[15]=rt=>w.modelTableDatas=rt),target:".ant-table-tbody",draggable:".ant-table-row",sort:!0,animation:150,onOnUpdate:B.onUpdate,onEnd:B.onEnd},{default:withCtx(()=>[createVNode(ie,{columns:w.modelTableColumns,"data-source":w.modelTableDatas,size:"small",bordered:"",pagination:!1,rowKey:"name",scroll:{y:w.screenHeight-88}},{customFilterDropdown:withCtx(({setSelectedKeys:rt,selectedKeys:bt,confirm:Dt,clearFilters:Et,column:Lt})=>[createVNode(F,{vertical:"",style:{padding:"8px"},gap:"small"},{default:withCtx(()=>[createVNode(j,{ref:"searchInput",placeholder:"搜索名称或编号",value:bt[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:Ot=>rt(Ot.target.value?[Ot.target.value]:[]),onPressEnter:Ot=>B.handleSearch(bt,Dt,Lt.dataIndex)},null,8,["value","onChange","onPressEnter"]),createVNode(X,{size:"small",value:bt,placeholder:"筛选分组",style:{width:"100%"},mode:"tags",maxTagCount:1,options:w.bookGroupBySearch,onChange:Ot=>rt(Ot)},null,8,["value","options","onChange"]),createBaseVNode("div",null,[createVNode(O,{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:Ot=>B.handleSearch(bt,Dt,Lt.dataIndex)},{icon:withCtx(()=>[createVNode(Y)]),default:withCtx(()=>[S[60]||(S[60]=createTextVNode(" 搜索 ",-1))]),_:1},8,["onClick"]),createVNode(O,{size:"small",style:{width:"90px"},onClick:Ot=>B.handleReset(Et)},{default:withCtx(()=>[...S[61]||(S[61]=[createTextVNode(" 重置 ",-1)])]),_:1},8,["onClick"])])]),_:2},1024)]),customFilterIcon:withCtx(({filtered:rt})=>[createVNode(z,{style:normalizeStyle({color:rt?"#108ee9":void 0})},null,8,["style"])]),bodyCell:withCtx(({column:rt,record:bt})=>[rt.key==="des"?(openBlock(),createBlock(F,{key:0,gap:"small"},{default:withCtx(()=>[createBaseVNode("div",null,toDisplayString(bt.des),1),S[62]||(S[62]=createBaseVNode("div",{style:{"flex-grow":"1"}},null,-1)),w.currentSelectMenu[0]==1?(openBlock(),createBlock(H,{key:0,title:"修改绘本备注",onConfirm:Dt=>B.onBtnEditProjectDes(bt.name)},{description:withCtx(()=>[createVNode(j,{value:w.inputModelDes,"onUpdate:value":S[11]||(S[11]=Dt=>w.inputModelDes=Dt),"addon-before":"绘本备注",placeholder:"请输入绘本备注",style:{width:"500px"}},null,8,["value"])]),default:withCtx(()=>[createVNode(O,{type:"text"},{default:withCtx(()=>[createVNode(W)]),_:1})]),_:1},8,["onConfirm"])):createCommentVNode("",!0)]),_:2},1024)):createCommentVNode("",!0),rt.key==="action"?(openBlock(),createBlock(F,{key:1,gap:"small",align:"center",justify:"center",style:{overflow:"scroll"}},{default:withCtx(()=>[createVNode(O,{size:"small",type:"primary",onClick:Dt=>B.onBtnLoadModel(bt.name)},{default:withCtx(()=>[...S[63]||(S[63]=[createTextVNode("编辑",-1)])]),_:1},8,["onClick"]),createVNode(O,{size:"small",type:"default",onClick:Dt=>B.onBtnExportModel(bt.name)},{default:withCtx(()=>[createVNode(Z)]),_:1},8,["onClick"]),createVNode(H,{title:"复制绘本",placement:"bottomRight",onConfirm:Dt=>B.onBtnCopyModel(bt.name)},{description:withCtx(()=>[createVNode(j,{value:w.newProjectName,"onUpdate:value":S[12]||(S[12]=Dt=>w.newProjectName=Dt),placeholder:"请输入新绘本编号"},null,8,["value"])]),default:withCtx(()=>[createVNode(O,null,{default:withCtx(()=>[createVNode(Q)]),_:1})]),_:1},8,["onConfirm"]),createVNode(H,{title:"删除警告",placement:"bottomRight"},{description:withCtx(()=>[createBaseVNode("div",_hoisted_3,"确定要删除绘本："+toDisplayString(bt.name)+"?",1),bt.config!=null?(openBlock(),createElementBlock("div",_hoisted_4,"《"+toDisplayString(bt.config.name)+"》",1)):createCommentVNode("",!0),S[64]||(S[64]=createBaseVNode("div",{style:{position:"relative",right:"0px",color:"#FF4D50"}},"此操作不可撤销，需校验权限",-1)),createVNode(ee,{modelValue:w.verificationCode,"onUpdate:modelValue":S[13]||(S[13]=Dt=>w.verificationCode=Dt),formatter:Dt=>/^\d*$/.test(Dt)?Dt:!1},null,8,["modelValue","formatter"])]),okButton:withCtx(()=>[createVNode(O,{danger:"",onClick:Dt=>B.onBtnDeleteModel(bt.name)},{default:withCtx(()=>[...S[65]||(S[65]=[createTextVNode(" 确定 ",-1)])]),_:1},8,["onClick"])]),default:withCtx(()=>[createVNode(O,{type:"text",danger:"",shape:"circle"},{default:withCtx(()=>[createVNode(te)]),_:1})]),_:2},1024)]),_:2},1024)):createCommentVNode("",!0),rt.key==="publishTime"?(openBlock(),createElementBlock(Fragment,{key:2},[createTextVNode(toDisplayString(B.formatTime(bt.publishTime)),1)],64)):createCommentVNode("",!0),rt.key==="name"?(openBlock(),createBlock(F,{key:3,gap:"small"},{default:withCtx(()=>[createVNode(O,{type:"link",onClick:Dt=>B.onBtnLoadModel(bt.name)},{default:withCtx(()=>[createTextVNode(toDisplayString(bt.name),1)]),_:2},1032,["onClick"]),S[66]||(S[66]=createBaseVNode("div",{style:{"flex-grow":"1"}},null,-1)),createVNode(H,{title:"重命名绘本编号",onConfirm:Dt=>B.onBtnRenameProject(bt.name)},{description:withCtx(()=>[createVNode(j,{value:w.newProjectName,"onUpdate:value":S[14]||(S[14]=Dt=>w.newProjectName=Dt),placeholder:"请输入新绘本编号"},null,8,["value"])]),default:withCtx(()=>[createVNode(O,{type:"text"},{default:withCtx(()=>[createVNode(W)]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):createCommentVNode("",!0),rt.key==="showName"?(openBlock(),createBlock(F,{key:4,gap:"small"},{default:withCtx(()=>[createBaseVNode("div",null,toDisplayString(bt.config&&bt.config.name?bt.config.name:""),1),S[67]||(S[67]=createBaseVNode("div",{style:{"flex-grow":"1"}},null,-1)),createVNode(H,{title:"修改绘本配置",placement:"right",onConfirm:Dt=>B.onConfigChangeSave(bt)},{description:withCtx(()=>[createVNode(F,{align:"center",justify:"center",style:{width:"100%"}},{default:withCtx(()=>[createVNode(re,{name:"file",style:{padding:"0px","margin-bottom":"5px"},multiple:!1,onChange:B.handleChangeCover,customRequest:B.handleUploadCover,onDrop:B.handleDropCover},{default:withCtx(()=>[createBaseVNode("div",_hoisted_5,[createBaseVNode("img",{style:{width:"100%",height:"100%","object-fit":"cover",position:"absolute",top:"0",left:"0"},src:B.getCoverUrl(bt)},null,8,_hoisted_6)])]),_:2},1032,["onChange","customRequest","onDrop"])]),_:2},1024),createVNode(U,{values:w.huiceConfig,vertical:!0,marginLeft:"0px"},null,8,["values"])]),default:withCtx(()=>[createVNode(O,{onClick:Dt=>B.onClickTableConfig(bt)},{default:withCtx(()=>[createVNode(P)]),_:1},8,["onClick"])]),_:2},1032,["onConfirm"])]),_:2},1024)):createCommentVNode("",!0)]),_:1},8,["columns","data-source","scroll"])]),_:1},8,["modelValue","onOnUpdate","onEnd"])):createCommentVNode("",!0)])):createCommentVNode("",!0),withDirectives(createVNode(F,{gap:"small",style:normalizeStyle([{padding:"5px",overflow:"auto"},{height:w.workSpaceHeight}])},{default:withCtx(()=>[withDirectives(createBaseVNode("div",_hoisted_7,[createBaseVNode("div",_hoisted_8,[w.curOpenLayout[0]?(openBlock(),createBlock(he,{key:0,size:"small",title:"绘本配置",style:{"min-width":"332px","user-select":"none"}},{default:withCtx(()=>[createVNode(U,{values:w.huiceConfig,vertical:!0,marginLeft:"0px",onOnChange:B.onhuiceConfigChange},null,8,["values","onOnChange"])]),_:1})):createCommentVNode("",!0),withDirectives(createVNode(Se,{ref:"previewParent",drageHandId:"dragTitle",enableDrag:w.cocosConfig.cocosPreviewCanDrag,aspectRadio:w.cocosConfig.aspectRadio,oriHeight:w.previewCardMinHeight,localStorageDrag:!0},{default:withCtx(()=>[createVNode(Ce,{style:normalizeStyle([{width:"100%",height:"100%"},{"min-width":w.previewCardMinWidth+"px","min-height":w.previewCardMinHeight+"px"}])},{default:withCtx(({width:rt,height:bt})=>[createVNode(he,{style:normalizeStyle([{height:"100%"},{"min-width":w.previewCardMinWidth+"px","min-height":w.previewCardMinHeight+"px"}]),onClick:withModifiers(()=>{},["stop"]),onMousemove:withModifiers(()=>{},["stop"])},{title:withCtx(()=>[...S[68]||(S[68]=[createBaseVNode("div",{id:"dragTitle",style:{cursor:"move"}},"分镜预览",-1)])]),extra:withCtx(()=>[createVNode(F,{gap:"small"},{default:withCtx(()=>[w.cocosConfig.cocosPreviewCanDrag?(openBlock(),createBlock(X,{key:0,size:"small",optionLabelProp:"value",dropdownMatchSelectWidth:150,value:w.cocosConfig.radio,"onUpdate:value":S[16]||(S[16]=Dt=>w.cocosConfig.radio=Dt),options:w.cocosConfig.radioOptions,onChange:S[17]||(S[17]=Dt=>B.onChangeRadionPicker(w.cocosConfig.radio))},null,8,["value","options"])):createCommentVNode("",!0),createVNode(K,null,{title:withCtx(()=>[...S[69]||(S[69]=[createTextVNode("清空场景",-1)])]),default:withCtx(()=>[createVNode(pe,{style:{"font-size":"larger",color:"#FF4D50"},onClick:B.onClickClearScene},null,8,["onClick"])]),_:1}),createVNode(K,null,{title:withCtx(()=>[...S[70]||(S[70]=[createTextVNode("激活摄像机预览",-1)])]),default:withCtx(()=>[createVNode(ue,{style:normalizeStyle([{color:w.cocosConfig.isPreviewMode?"":"#1568DD"},{"font-size":"larger"}]),onClick:S[18]||(S[18]=Dt=>B.onClickTreePreview("isPreviewMode"))},null,8,["style"])]),_:1}),createVNode(K,null,{title:withCtx(()=>[...S[71]||(S[71]=[createTextVNode("显示安全框",-1)])]),default:withCtx(()=>[createVNode(le,{style:normalizeStyle([{color:w.cocosConfig.cocosPreviewIsShowGird?"#1568DD":""},{"font-size":"larger"}]),onClick:S[19]||(S[19]=Dt=>B.onClickTreePreview("cocosPreviewIsShowGird"))},null,8,["style"])]),_:1}),createVNode(K,null,{title:withCtx(()=>[...S[72]||(S[72]=[createTextVNode("显示节点树",-1)])]),default:withCtx(()=>[createVNode(ce,{style:normalizeStyle([{color:w.cocosConfig.cocosPreviewIsShowTree?"#1568DD":""},{"font-size":"large"}]),onClick:S[20]||(S[20]=Dt=>B.onClickTreePreview("cocosPreviewIsShowTree"))},null,8,["style"])]),_:1}),createVNode(K,null,{title:withCtx(()=>[...S[73]||(S[73]=[createTextVNode("显示帧率信息",-1)])]),default:withCtx(()=>[createVNode(_e,{style:normalizeStyle([{"font-size":"large"},{color:w.cocosConfig.cocosPreviewIsShowState?"#1568DD":""}]),onClick:S[21]||(S[21]=Dt=>B.onClickTreePreview("cocosPreviewIsShowState"))},null,8,["style"])]),_:1}),createVNode(K,null,{title:withCtx(()=>[...S[74]||(S[74]=[createTextVNode("显示碰撞框",-1)])]),default:withCtx(()=>[createVNode(oe,{style:normalizeStyle([{"font-size":"large"},{color:w.cocosConfig.cocosPreviewIsShowColiderBox?"#1568DD":""}]),onClick:S[22]||(S[22]=Dt=>B.onClickTreePreview("cocosPreviewIsShowColiderBox"))},null,8,["style"])]),_:1}),w.cocosConfig.mute==!1?(openBlock(),createBlock(de,{key:1,style:{"font-size":"large",color:"#1677FF"},onClick:S[23]||(S[23]=Dt=>B.onClickTreePreview("mute"))})):(openBlock(),createBlock(me,{key:2,style:{"font-size":"large"},onClick:S[24]||(S[24]=Dt=>B.onClickTreePreview("mute"))})),w.cocosConfig.cocosPreviewCanDrag==!1?(openBlock(),createBlock(ye,{key:3,style:{"font-size":"large"},onClick:S[25]||(S[25]=Dt=>B.onClickTreePreview("cocosPreviewCanDrag"))})):(openBlock(),createBlock(ge,{key:4,style:{"font-size":"large"},onClick:S[26]||(S[26]=Dt=>B.onClickTreePreview("cocosPreviewCanDrag"))})),createVNode(K,null,{title:withCtx(()=>[...S[75]||(S[75]=[createTextVNode("在新窗口中预览",-1)])]),default:withCtx(()=>[createVNode(we,{style:{"font-size":"large"},onClick:B.onClickNewPreview},null,8,["onClick"])]),_:1})]),_:1})]),default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("div",{id:"GameDiv",style:normalizeStyle([{position:"absolute","user-select":"none"},{width:rt-12+"px",height:bt-50+"px"}])},[createBaseVNode("canvas",{id:"GameCanvas",style:{"user-select":"none"},width:rt-12,height:bt-50},null,8,_hoisted_9),w.cocosConfig.cocosPreviewIsShowGird?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(L.saveAreaLines,Dt=>(openBlock(),createElementBlock("div",{style:normalizeStyle([{position:"absolute","background-color":"#FF4D50"},{top:Dt.top+"px",left:Dt.left+"px",width:Dt.width,height:Dt.height}])},null,4))),256)):createCommentVNode("",!0)],4)),[[qe,B.onPreviewSizeChange]]),w.cocosConfig.cocosPreviewIsShowTree?(openBlock(),createBlock(Se,{key:0,enableDrag:!0,oriWidth:229,disableWidth:"",handPosOnLeft:"",style:normalizeStyle([{position:"absolute",top:"0"},{left:-w.cocosPreviewTreeWidth-4+"px"}])},{default:withCtx(()=>[createVNode(Ce,{style:normalizeStyle([{"min-height":w.previewCardMinHeight+"px"},{width:"100%",height:"100%"}])},{default:withCtx(({width:Dt,height:Et})=>[withDirectives((openBlock(),createBlock(he,{title:"节点层级"},{extra:withCtx(()=>[createVNode(F,{gap:"middle"},{default:withCtx(()=>[createVNode(Te,{style:{"font-size":"larger"},onClick:B.onClickTreeExport},null,8,["onClick"]),createVNode(Ee,{style:{"font-size":"larger"},onClick:B.onClickConsoleSelect},null,8,["onClick"]),createVNode(De,{style:{"font-size":"larger"},onClick:B.onClickFreshPreview},null,8,["onClick"])]),_:1})]),default:withCtx(()=>[createBaseVNode("div",{style:normalizeStyle([{overflow:"scroll"},{height:Et-50+"px"}])},[createVNode(fe,{"tree-data":w.cocosPreviewTreeData,expandedKeys:w.expandedKeys,"onUpdate:expandedKeys":S[27]||(S[27]=Lt=>w.expandedKeys=Lt),fieldNames:{title:"name",key:"id"},onSelect:B.onSelectCocosNode},null,8,["tree-data","expandedKeys","onSelect"])],4)]),_:2},1024)),[[qe,B.onPreviewTreeSizeChange]])]),_:2},1032,["style"])]),_:2},1032,["style"])):createCommentVNode("",!0)]),_:2},1032,["style"])]),_:1},8,["style"])]),_:1},8,["enableDrag","aspectRadio","oriHeight"]),[[vShow,w.curOpenLayout[1]]])]),w.curOpenLayout[2]?(openBlock(),createBlock(he,{key:0,id:"celueLiebiaoCard",class:"widthAni",style:normalizeStyle([{width:w.expandPolicyList?"700px":"332px"},{"min-width":"332px","flex-grow":"1","flex-shrink":"0","user-select":"none"}]),size:"small",title:"分镜列表"},{extra:withCtx(()=>[createVNode(F,{gap:"small",align:"center",justify:"center"},{default:withCtx(()=>[createVNode(H,{title:"新建分镜",onConfirm:B.onClickAddPolicy},{description:withCtx(()=>[createVNode(j,{value:w.newPolicyName,"onUpdate:value":S[28]||(S[28]=rt=>w.newPolicyName=rt),placeholder:"请输入分镜名称"},null,8,["value"])]),default:withCtx(()=>[createVNode(O,{type:"primary",shape:"circle"},{default:withCtx(()=>[createVNode(be)]),_:1})]),_:1},8,["onConfirm"]),createVNode(H,{title:"复制当前选中分镜",onConfirm:B.onClickCopyPolicy},{description:withCtx(()=>[S[76]||(S[76]=createBaseVNode("div",null,"复制到哪个绘本下：",-1)),createVNode(X,{size:"small",style:{width:"100%","margin-bottom":"7px"},value:w.copyToProject,"onUpdate:value":S[29]||(S[29]=rt=>w.copyToProject=rt),options:B.getProjectOptions()},null,8,["value","options"]),S[77]||(S[77]=createBaseVNode("div",null,"新的分镜名称：",-1)),createVNode(j,{value:w.newPolicyName,"onUpdate:value":S[30]||(S[30]=rt=>w.newPolicyName=rt),placeholder:"请输入新分镜名称"},null,8,["value"])]),default:withCtx(()=>[createVNode(O,{type:"primary",ghost:"",shape:"circle"},{default:withCtx(()=>[createVNode(Q)]),_:1})]),_:1},8,["onConfirm"]),createVNode(H,{title:"确认删除当前选中的分镜吗？",onConfirm:B.onClickDeletePolicy},{description:withCtx(()=>[S[78]||(S[78]=createBaseVNode("div",{style:{position:"relative",right:"0px",color:"#FF4D50"}},"此操作不可撤销，需校验权限",-1)),createVNode(ee,{modelValue:w.verificationCode,"onUpdate:modelValue":S[31]||(S[31]=rt=>w.verificationCode=rt),formatter:rt=>/^\d*$/.test(rt)?rt:!1},null,8,["modelValue","formatter"])]),default:withCtx(()=>[createVNode(O,{type:"primary",danger:"",shape:"circle"},{default:withCtx(()=>[createVNode(te)]),_:1})]),_:1},8,["onConfirm"]),createVNode(k,{size:"default",checked:w.expandPolicyList,"onUpdate:checked":S[32]||(S[32]=rt=>w.expandPolicyList=rt)},{checkedChildren:withCtx(()=>[createVNode(Re)]),unCheckedChildren:withCtx(()=>[createVNode(Ve,{rotate:90})]),_:1},8,["checked"])]),_:1})]),default:withCtx(()=>[w.curEditTabDit[w.tabActiveKey]!=null?(openBlock(),createBlock(ne,{key:0,animation:150,modelValue:w.curEditTabDit[w.tabActiveKey].policyList,"onUpdate:modelValue":S[33]||(S[33]=rt=>w.curEditTabDit[w.tabActiveKey].policyList=rt),sort:!0,style:normalizeStyle([{height:w.celueLiebiaoBodyHeight+"px"},{display:"flex","flex-direction":"column",gap:"5px",overflow:"scroll"}])},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(w.curEditTabDit[w.tabActiveKey].policyList,(rt,bt)=>(openBlock(),createBlock(he,{key:rt.name,size:"small",onClick:Dt=>B.onClickOnePolicy(rt)},{title:withCtx(()=>[createVNode(F,{gap:"0px",align:"center"},{default:withCtx(()=>[createBaseVNode("div",{style:normalizeStyle([{"flex-shrink":"0","max-width":"150px"},{color:w.curEditTabDit[w.tabActiveKey]!=null&&w.curEditTabDit[w.tabActiveKey].curSelectPolicy==rt.name?"#3c89e8":""}])},toDisplayString(bt+1+"."+rt.name),5),S[79]||(S[79]=createBaseVNode("div",{style:{height:"10px",width:"10px","flex-grow":"1"}},null,-1))]),_:2},1024)]),extra:withCtx(()=>[createVNode(F,{gap:"small",align:"center"},{default:withCtx(()=>[createVNode(k,{checked:rt.active,"onUpdate:checked":Dt=>rt.active=Dt,onClick:B.onStopClick},null,8,["checked","onUpdate:checked","onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1},8,["modelValue","style"])):createCommentVNode("",!0)]),_:1},8,["style"])):createCommentVNode("",!0)],512),[[vShow,w.curOpenLayout[0]||w.curOpenLayout[1]||w.curOpenLayout[2]]]),createVNode(he,{id:"canvasCard",size:"small",style:{"user-select":"none"}},{title:withCtx(()=>[createVNode(F,{gap:"small",align:"center"},{default:withCtx(()=>[createVNode(Pe,{value:w.ruleChooseTabOption,"onUpdate:value":S[34]||(S[34]=rt=>w.ruleChooseTabOption=rt),block:"",options:["蓝图","表格"]},null,8,["value"]),createBaseVNode("div",_hoisted_10,[createVNode(ke,{mode:"horizontal",triggerSubMenuAction:"click",items:w.ruleMenu,selectable:!1,onOpenChange:B.onMenuOpenChange,onClick:B.onClickMenuItem,style:{"user-select":"none",width:"450px"}},null,8,["items","onOpenChange","onClick"])]),w.importProgress!=0&&w.importProgress!=100?(openBlock(),createBlock(F,{key:0,gap:"small",align:"center"},{default:withCtx(()=>[createBaseVNode("div",null,"资源导入中"+toDisplayString(w.importInfo),1),createVNode(Ne,{percent:w.importProgress||0,type:"circle",size:20,"stroke-width":20,format:rt=>"导入资源中，已完成".concat(rt,"%"),style:{"flex-shrink":"0"}},null,8,["percent","format"])]),_:1})):createCommentVNode("",!0),S[88]||(S[88]=createBaseVNode("div",null,"自动替换",-1)),createVNode(K,null,{title:withCtx(()=>[...S[80]||(S[80]=[createTextVNode("开启后上传资源将自动替换所有分镜中已使用的同名称资源",-1)])]),default:withCtx(()=>[createVNode(k,{checked:w.configs.uploadReplaceAssestByName,"onUpdate:checked":S[35]||(S[35]=rt=>w.configs.uploadReplaceAssestByName=rt)},null,8,["checked"])]),_:1}),createVNode(O,null,{default:withCtx(()=>[S[81]||(S[81]=createTextVNode(" 上传资源 ",-1)),createBaseVNode("input",{type:"file",onChange:S[36]||(S[36]=(...rt)=>B.onBtnImportAssest&&B.onBtnImportAssest(...rt)),ref:"modelImport2",multiple:"",accept:".png,.jpg,.jepg,.json,.atlas,.mp3,.wav",style:{opacity:"0","font-size":"30px",width:"100%",position:"absolute",top:"0",left:"0"}},null,544)]),_:1}),createVNode(K,null,{title:withCtx(()=>[...S[82]||(S[82]=[createBaseVNode("div",null,"录制操作：运行后将录制点击事件，停止后结束录制并记录到当前分镜",-1),createBaseVNode("div",null,"自动点击：运行后如果当前有录制好的操作，将自动点击需要触发的操作",-1)])]),default:withCtx(()=>[createVNode(Oe,{value:w.configs.recordType,"onUpdate:value":S[37]||(S[37]=rt=>w.configs.recordType=rt),"button-style":"solid"},{default:withCtx(()=>[createVNode(Ae,{value:"none"},{default:withCtx(()=>[...S[83]||(S[83]=[createTextVNode("关闭",-1)])]),_:1}),createVNode(Ae,{value:"autoRecordTouch"},{default:withCtx(()=>[...S[84]||(S[84]=[createTextVNode("录制操作",-1)])]),_:1}),createVNode(Ae,{value:"autoRunRecordTouch"},{default:withCtx(()=>[...S[85]||(S[85]=[createTextVNode("自动点击",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),w.freshState!=null&&B.getPolicyState(w.tabActiveKey,"isRuning")!=!0?(openBlock(),createBlock(O,{key:1,onClick:B.onClickRunGraph},{default:withCtx(()=>[...S[86]||(S[86]=[createTextVNode("运行",-1)])]),_:1},8,["onClick"])):(openBlock(),createBlock(O,{key:2,danger:"",onClick:B.onClickStopGraph},{default:withCtx(()=>[...S[87]||(S[87]=[createTextVNode("停止",-1)])]),_:1},8,["onClick"])),w.curOpenLayout[4]==0?(openBlock(),createBlock(Fe,{key:3,style:{"font-size":"larger",color:"#1568DD"},onClick:S[38]||(S[38]=rt=>B.onClickChangeShowView(4))})):createCommentVNode("",!0)]),_:1})]),default:withCtx(()=>[createBaseVNode("div",{style:normalizeStyle([{width:w.canvasWidth+"px",height:w.canvasHeight+"px"},{position:"relative"}]),onDrop:S[45]||(S[45]=withModifiers((...rt)=>B.handleDrop&&B.handleDrop(...rt),["prevent"]))},[withDirectives(createBaseVNode("canvas",{id:"mycanvas",width:w.canvasWidth,height:w.canvasHeight},null,8,_hoisted_11),[[vShow,w.ruleChooseTabOption=="蓝图"]]),withDirectives(createVNode(ne,{modelValue:w.curEditLgraphTable,"onUpdate:modelValue":S[44]||(S[44]=rt=>w.curEditLgraphTable=rt),target:".ant-table-tbody",draggable:".ant-table-row",sort:!0,animation:150,onEnd:B.onLgraphTableDragEnd},{default:withCtx(()=>[createVNode(ie,{columns:w.graphTableColumns,"data-source":w.curEditLgraphTable,size:"small",bordered:!0,pagination:!1,rowKey:"id",scroll:{x:w.canvasWidth-80,y:w.canvasHeight-40},onResizeColumn:B.handleResizeTableColumn},{headerCell:withCtx(({column:rt})=>[rt.key=="linkNode_1"?(openBlock(),createBlock(K,{key:0},{title:withCtx(()=>[...S[89]||(S[89]=[createTextVNode("此列下的动画指令将在进入页面时自动播放，注意：如果两个spine动画同时播放，第二个将覆盖前一个，如果两个数值动画同时播放，可能相互影响",-1)])]),default:withCtx(()=>[createTextVNode(" "+toDisplayString(rt.title),1)]),_:2},1024)):createCommentVNode("",!0),rt.key=="action"?(openBlock(),createBlock(F,{key:1,align:"center",gap:"4"},{default:withCtx(()=>[S[92]||(S[92]=createBaseVNode("div",null,"操作",-1)),S[93]||(S[93]=createBaseVNode("div",{style:{"flex-grow":"1"}},null,-1)),createVNode(K,{placement:"bottomRight"},{title:withCtx(()=>[...S[90]||(S[90]=[createTextVNode("添加关联指令列",-1)])]),default:withCtx(()=>[createVNode(nt,{onClick:B.addOneColumnToTable},null,8,["onClick"])]),_:1}),createVNode(K,{placement:"bottomRight"},{title:withCtx(()=>[...S[91]||(S[91]=[createTextVNode("显示资源名称列",-1)])]),default:withCtx(()=>[createVNode(k,{checked:w.configs.showNameColumn,"onUpdate:checked":S[39]||(S[39]=bt=>w.configs.showNameColumn=bt),onChange:B.addNameColumnToTable},null,8,["checked","onChange"])]),_:1})]),_:1})):createCommentVNode("",!0)]),bodyCell:withCtx(({column:rt,record:bt,index:Dt})=>[rt.key=="modal"?(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(bt.modal),1)],64)):createCommentVNode("",!0),rt.key=="img"?(openBlock(),createBlock(Xe,{key:1,title:"预览",placement:"left",trigger:"click"},{content:withCtx(()=>[createBaseVNode("img",{src:bt.img,style:{"max-width":"300px","max-height":"300px"}},null,8,_hoisted_12),createBaseVNode("div",null,"物体类型："+toDisplayString(bt.modal),1),createBaseVNode("div",null,"资源："+toDisplayString(bt.customeName),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_13,[bt.img!=null?(openBlock(),createElementBlock("div",_hoisted_14,[createBaseVNode("img",{style:{width:"100%",height:"100%","object-fit":"contain",position:"absolute",top:"0",left:"0"},src:bt.img},null,8,_hoisted_15)])):(openBlock(),createBlock(Ze,{key:1,style:{"margin-right":"0px"},color:bt.modal=="文本"?"purple":"blue"},{default:withCtx(()=>[createTextVNode(toDisplayString(bt.modal=="文本"?bt.customeName.length>8?bt.customeName.substring(0,8)+"...":bt.customeName:bt.modal),1)]),_:2},1032,["color"]))])]),_:2},1024)):createCommentVNode("",!0),rt.key.indexOf("linkNode")!=-1?(openBlock(),createElementBlock(Fragment,{key:2},[bt[rt.key]!=null?(openBlock(),createBlock(ne,{key:0,class:"我是拖拽parent",modelValue:bt[rt.key],"onUpdate:modelValue":Et=>bt[rt.key]=Et,"data-row":Dt,"data-col":rt.key,group:"tableCell",animation:150,onEnd:Et=>B.onGraphTableCellDragEnd(Et,bt,rt.key)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(bt[rt.key],(Et,Lt)=>(openBlock(),createBlock(F,{gap:"3",style:normalizeStyle({"margin-top":Lt==0?"0px":"8px"})},{default:withCtx(()=>[createVNode(ot,null,{overlay:withCtx(()=>[createVNode(ke,{items:w.moreActionMenu,selectable:!1,onOpenChange:B.onMenuOpenChange,onClick:Ot=>B.onClickMenuItem(Ot,bt,rt.key,Lt)},null,8,["items","onOpenChange","onClick"])]),default:withCtx(()=>[createVNode($e,{onClick:S[40]||(S[40]=withModifiers(()=>{},["prevent"]))})]),_:2},1024),Et.noInput==!1?(openBlock(),createBlock(ot,{key:0,onOpenChange:Ot=>B.getCellInputLinkMenu(Ot,bt,rt.key,Lt)},{overlay:withCtx(()=>[createBaseVNode("div",null,[createVNode(ke,{items:w.inputLinkMenu,selectable:!1,onOpenChange:B.onMenuOpenChange,onClick:Ot=>B.onClickCellInputMenuItem(Ot,bt,rt.key,Lt)},null,8,["items","onOpenChange","onClick"])])]),default:withCtx(()=>[createVNode(ut,{onClick:S[41]||(S[41]=withModifiers(()=>{},["prevent"])),style:normalizeStyle({color:Et.inputs.length==0?"red":"green"})},null,8,["style"])]),_:2},1032,["onOpenChange"])):createCommentVNode("",!0),createVNode(Ze,{style:{"margin-right":"0px"},color:w.highlightNodeDit[Et.id]==1?"#87d068":Et.tagColor?Et.tagColor:""},{default:withCtx(()=>[createTextVNode(toDisplayString(Et.title+Et.id),1)]),_:2},1032,["color"]),Et.config!=null?(openBlock(),createBlock(U,{key:1,gap:"3",values:Et.config,marginLeft:"0px",onOnChange:Ot=>B.onGraphTableConfigChange(Ot,bt,rt.key,Lt)},null,8,["values","onOnChange"])):createCommentVNode("",!0),Et.noOutput==!1?(openBlock(),createBlock(ot,{key:2,onOpenChange:Ot=>B.getCellOutputLinkMenu(Ot,bt,rt.key,Lt)},{overlay:withCtx(()=>[createVNode(ke,{items:w.outputLinkMenu,selectable:!1,onOpenChange:B.onMenuOpenChange,onClick:Ot=>B.onClickCellOutputMenuItem(Ot,bt,rt.key,Lt)},null,8,["items","onOpenChange","onClick"])]),default:withCtx(()=>[createVNode(gt,{onClick:S[42]||(S[42]=withModifiers(()=>{},["prevent"])),style:normalizeStyle({color:Et.outputs.length==0?"red":"green"})},null,8,["style"])]),_:2},1032,["onOpenChange"])):createCommentVNode("",!0)]),_:2},1032,["style"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","data-row","data-col","onEnd"])):createCommentVNode("",!0),bt[rt.key]!=null&&bt[rt.key].length==0?(openBlock(),createBlock(ot,{key:1},{overlay:withCtx(()=>[createVNode(ke,{items:w.moreActionMenu,selectable:!1,onOpenChange:B.onMenuOpenChange,onClick:Et=>B.onClickMenuItem(Et,bt,rt.key,-1)},null,8,["items","onOpenChange","onClick"])]),default:withCtx(()=>[createVNode($e,{onClick:S[43]||(S[43]=withModifiers(()=>{},["prevent"]))})]),_:2},1024)):createCommentVNode("",!0)],64)):createCommentVNode("",!0),rt.key=="action"?(openBlock(),createBlock(F,{key:3,gap:"small",align:"center",justify:"center",style:{overflow:"scroll"}},{default:withCtx(()=>[createVNode(H,{title:"删除警告",placement:"rightTop"},{description:withCtx(()=>[createBaseVNode("div",_hoisted_16,"确定要删除id"+toDisplayString(bt.id)+"物体?",1)]),okButton:withCtx(()=>[createVNode(O,{danger:"",onClick:Et=>B.onBtnDeleteTableRow(Dt,bt)},{default:withCtx(()=>[...S[94]||(S[94]=[createTextVNode(" 确定 ",-1)])]),_:1},8,["onClick"])]),default:withCtx(()=>[createVNode(O,{type:"text",danger:"",shape:"circle"},{default:withCtx(()=>[createVNode(te)]),_:1})]),_:2},1024),createVNode(O,{type:"text",shape:"circle",onClick:Et=>B.toggleNodeIdToGraph(bt.id)},{default:withCtx(()=>[createVNode(Ue)]),_:1},8,["onClick"])]),_:2},1024)):createCommentVNode("",!0)]),_:1},8,["columns","data-source","scroll","onResizeColumn"])]),_:1},8,["modelValue","onEnd"]),[[vShow,w.ruleChooseTabOption=="表格"]]),w.isShowMenu==!0?(openBlock(),createElementBlock("div",{key:0,style:normalizeStyle([{width:w.canvasWidth+"px",height:w.canvasHeight+"px"},{position:"absolute",opacity:"0.4",top:"0"}])},null,4)):createCommentVNode("",!0)],36)]),_:1})]),_:1},8,["style"]),[[vShow,w.tabActiveKey!=0]])]),createVNode(je,{open:w.importModelOpen,"onUpdate:open":S[48]||(S[48]=rt=>w.importModelOpen=rt),title:"导入旧版绘本",onOk:B.handleOkImport},{default:withCtx(()=>[createVNode(U,{vertical:!0,gap:"3",values:w.importOldVersionConfig,marginLeft:"0px",onOnChange:B.onImportOldVersionConfigChange},null,8,["values","onOnChange"]),createBaseVNode("div",_hoisted_17,[createVNode(We,{style:{},indeterminate:w.importCheckedIndeterminate,checked:w.importCheckAll,"onUpdate:checked":S[46]||(S[46]=rt=>w.importCheckAll=rt),onChange:B.onCheckAllChange},{default:withCtx(()=>[...S[96]||(S[96]=[createTextVNode(" 全选 ",-1)])]),_:1},8,["indeterminate","checked","onChange"])]),createVNode(ht,{style:{"margin-bottom":"5px","margin-top":"5px"}}),createVNode(Be,{value:w.importCheckedPageList,"onUpdate:value":S[47]||(S[47]=rt=>w.importCheckedPageList=rt),options:w.importPageOptions,onChange:B.onImportPageCheck},null,8,["value","options","onChange"]),w.importProgress!=null&&w.importProgress!=0&&w.importProgress!=100?(openBlock(),createBlock(F,{key:0,gap:"small",align:"center",justify:"flex-end",style:{"margin-top":"10px"}},{default:withCtx(()=>[createBaseVNode("div",null,"资源导入中"+toDisplayString(w.importInfo),1),createVNode(Ne,{percent:w.importProgress||0,type:"circle",size:20,"stroke-width":20,format:rt=>"导入资源中，已完成".concat(rt,"%"),style:{"flex-shrink":"0"}},null,8,["percent","format"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["open","onOk"]),createVNode(je,{open:w.editColiderOpen,"onUpdate:open":S[49]||(S[49]=rt=>w.editColiderOpen=rt),width:800,footer:null,destroyOnClose:!0,title:"编辑碰撞框"},{default:withCtx(()=>[createVNode(Qe,{img:w.editColiderImg,pointArr:w.pointArr,imgScale:w.editColiderScale,onOnChange:L.onMarkEditOk},null,8,["img","pointArr","imgScale","onOnChange"])]),_:1},8,["open"]),createVNode(je,{open:w.editSoundTextOpen,"onUpdate:open":S[50]||(S[50]=rt=>w.editSoundTextOpen=rt),width:1200,footer:null,destroyOnClose:!0,maskClosable:!1,title:"编辑音频字幕"},{default:withCtx(()=>[createVNode(st,{audioUrl:w.editSoundTextParams.url,config:w.editSoundTextParams.motionTextData,onOnChange:B.onSoundTextEditOk},null,8,["audioUrl","config","onOnChange"])]),_:1},8,["open"]),createVNode(je,{open:w.showCreateMotionTextModal,"onUpdate:open":S[51]||(S[51]=rt=>w.showCreateMotionTextModal=rt),width:600,destroyOnClose:!0,title:"创建字幕",onOk:B.handleOkCreateMotionText},{default:withCtx(()=>[createVNode(U,{vertical:!0,gap:"3",values:w.createMotionTextConfig,marginLeft:"0px"},null,8,["values"])]),_:1},8,["open","onOk"]),createVNode(je,{open:w.showSoundBoxModal,"onUpdate:open":S[54]||(S[54]=rt=>w.showSoundBoxModal=rt),width:1e3,footer:null,maskClosable:!1,destroyOnClose:!0,onOk:B.handleOkSoundMotionText},{title:withCtx(()=>[createVNode(F,{gap:"small",align:"center"},{default:withCtx(()=>[w.curShowAssestBoxType=="soundBox"?(openBlock(),createElementBlock("div",_hoisted_18,"音频资源库")):createCommentVNode("",!0),w.curShowAssestBoxType=="spineBox"?(openBlock(),createElementBlock("div",_hoisted_19,"动画资源库")):createCommentVNode("",!0),w.curShowAssestBoxType=="imageBox"?(openBlock(),createElementBlock("div",_hoisted_20,"图片资源库")):createCommentVNode("",!0),S[98]||(S[98]=createBaseVNode("div",{style:{"margin-left":"30px"}},"仅显示当前分镜资源",-1)),createVNode(k,{style:{"margin-right":"30px"},checked:w.justCurrentPage,"onUpdate:checked":S[52]||(S[52]=rt=>w.justCurrentPage=rt),onChange:B.freshAssestBoxData},null,8,["checked","onChange"]),w.importProgress!=0&&w.importProgress!=100?(openBlock(),createBlock(F,{key:3,gap:"small",align:"center"},{default:withCtx(()=>[createBaseVNode("div",null,"资源导入中"+toDisplayString(w.importInfo),1),createVNode(Ne,{percent:w.importProgress||0,type:"circle",size:20,"stroke-width":20,format:rt=>"导入资源中，已完成".concat(rt,"%"),style:{"flex-shrink":"0"}},null,8,["percent","format"])]),_:1})):createCommentVNode("",!0),createVNode(O,null,{default:withCtx(()=>[S[97]||(S[97]=createTextVNode(" 全局替换资源 ",-1)),createBaseVNode("input",{type:"file",onChange:S[53]||(S[53]=(...rt)=>B.onBtnImportAssest&&B.onBtnImportAssest(...rt)),ref:"modelImport2",multiple:"",accept:".png,.jpg,.jepg,.json,.atlas,.mp3,.wav",style:{opacity:"0","font-size":"30px",width:"100%",position:"absolute",top:"0",left:"0"}},null,544)]),_:1})]),_:1})]),default:withCtx(()=>[createVNode(ie,{columns:w.soundBoxColumns,"data-source":w.soundBoxDatas,size:"small",onChange:B.handleSoundBoxTableChange,bordered:"",pagination:!1,rowKey:"customeName"},{bodyCell:withCtx(({column:rt,record:bt})=>[rt.key==="action"?(openBlock(),createBlock(F,{key:0,gap:"small",align:"center",justify:"center",style:{overflow:"scroll"}},{default:withCtx(()=>[createVNode(K,{placement:"bottomRight"},{title:withCtx(()=>[...S[99]||(S[99]=[createTextVNode("将此音频添加到当前编辑的分镜",-1)])]),default:withCtx(()=>[createVNode(O,{onClick:Dt=>B.onBtnUseBoxOneRow(bt)},{default:withCtx(()=>[...S[100]||(S[100]=[createTextVNode("使用",-1)])]),_:1},8,["onClick"])]),_:2},1024),createVNode(O,{onClick:Dt=>B.onBtnDownLoadBoxOneRow(bt)},{default:withCtx(()=>[...S[101]||(S[101]=[createTextVNode("下载",-1)])]),_:1},8,["onClick"]),createVNode(O,{onClick:Dt=>B.onBtnPlayBoxOneRow(bt)},{default:withCtx(()=>[...S[102]||(S[102]=[createTextVNode("播放",-1)])]),_:1},8,["onClick"])]),_:2},1024)):createCommentVNode("",!0),rt.key==="graphUse"?(openBlock(),createBlock(F,{key:1,style:{overflow:"scroll"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(bt.graphUse,Dt=>(openBlock(),createBlock(Ze,null,{default:withCtx(()=>[createTextVNode(toDisplayString(Dt),1)]),_:2},1024))),256))]),_:2},1024)):createCommentVNode("",!0)]),_:1},8,["columns","data-source","onChange"])]),_:1},8,["open","onOk"])]),_:1},8,["locale"])}const BookEdit=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-52828108"]]);export{BookEdit as default};
